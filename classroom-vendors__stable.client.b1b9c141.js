(("undefined"!=typeof self?self:this).wpJsonpChessCom_classroom=("undefined"!=typeof self?self:this).wpJsonpChessCom_classroom||[]).push([[216],{7757:function(e,t,n){e.exports=n(5666)},2805:function(e,t,n){"use strict";n.d(t,{KW:function(){return a.bZ}});n(5746);var a=n(2738);Object.defineProperty,Object.defineProperties,Object.getOwnPropertyDescriptors,Object.getOwnPropertySymbols,Object.prototype.hasOwnProperty,Object.prototype.propertyIsEnumerable;var l=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",highlights:{"8_bit":"#ffff00",bases:"#f5cc2a",blackwhite:"#5b91b3",blue:"#00a5ff",brown:"#ffff00",bubblegum:"#de5d6f",burled_wood:"#ee9016",dark_wood:"#cc9122",dash:"#eca722",default:"#ffff00",glass:"#5b91b3",graffiti:"#f39011",green:"#ffff00",grey:"#a4b8c4",icy_sea:"#5ed7f1",light:"#a4b8c4",lolz:"#a3becd",marble:"#f0db86",marbleblue:"#65daf7",marblebrown:"#f39011",marblegreen:"#f0db86",metal:"#a3becd",natural:"#f0e464",nature:"#eef396",neon:"#6d90a6",newspaper:"#99976e",orange:"#ffff00",overlay:"#0d9acf",parchment:"#d8cc66",pink:"#de5d6f",purple:"#7dacc9",red:"#f8f893",sand:"#e2bc87",sky:"#65daf7",stone:"#36525f",tan:"#f7d84a",tournament:"#a4c25b",translucent:"#5b91b3",walnut:"#d1a52d",winboard:"#a4c25b",wood:"#cc9122",wooddark:"#ee9016",woodlight:"#d8cc66",woodmid:"#cc9122",woodolive:"#a3becd"}});Symbol.toStringTag,a.aU,a.aV,a.aT,a.aW,a.r;a.b2.Plugin.Name,a.b3.Plugin.Name},2738:function(e,t,n){"use strict";n.d(t,{$:function(){return getPieceBaseURL},A:function(){return Et},B:function(){return ht},C:function(){return ChessError},D:function(){return Un},E:function(){return uo},F:function(){return Zs},G:function(){return qn},H:function(){return Ka},I:function(){return ks},J:function(){return al},K:function(){return calculateArrowLength},L:function(){return calculateArrowSlope},M:function(){return getKnightArrowRotation},N:function(){return calculateArrowRotation},O:function(){return Ya},P:function(){return Er},Q:function(){return string2hex},R:function(){return hs},S:function(){return Ti},T:function(){return Bt},U:function(){return ki},V:function(){return Ns},W:function(){return qt},X:function(){return fe},Y:function(){return getTuckPosition},Z:function(){return getColorAsLetter},_:function(){return getBoardURL},a:function(){return easeInOutQuadratic},a0:function(){return bs},a1:function(){return Hi},a2:function(){return removeItems},a3:function(){return Ts},a4:function(){return Cs},a5:function(){return Gi},a6:function(){return autoDetectRenderer},a7:function(){return Qs},a8:function(){return Za},a9:function(){return correctBlendMode},aA:function(){return pl},aB:function(){return sign},aC:function(){return Ja},aD:function(){return Vi},aE:function(){return hex2string},aF:function(){return trimCanvas},aG:function(){return getResolutionOfUrl},aH:function(){return zi},aI:function(){return premultiplyTintToRgba},aJ:function(){return sc},aK:function(){return uid},aL:function(){return Ic},aM:function(){return Hc},aN:function(){return yl},aO:function(){return Ps},aP:function(){return jc},aQ:function(){return ns},aR:function(){return rgb2hex},aS:function(){return Tt},aT:function(){return getPieceShortStringFromUrl},aU:function(){return getElementBackgroundImage},aV:function(){return getFileRankFromSan},aW:function(){return getSanFromFileRank$1},aa:function(){return premultiplyRgba},ab:function(){return premultiplyTint},ac:function(){return fc},ad:function(){return ic},ae:function(){return da},af:function(){return ec},ag:function(){return createIndicesForQuads},ah:function(){return rs},ai:function(){return Nc},aj:function(){return Bc},ak:function(){return Qa},al:function(){return Wi},am:function(){return deprecation},an:function(){return vs},ao:function(){return es},ap:function(){return ys},aq:function(){return ms},ar:function(){return gs},as:function(){return hex2rgb},at:function(){return lc},au:function(){return _s},av:function(){return ra},aw:function(){return ma},ax:function(){return sl},ay:function(){return cl},az:function(){return ia},b:function(){return easeOutQuadratic},b2:function(){return F},b3:function(){return Ke},bZ:function(){return createRecorderPlugin},bv:function(){return Mt},c:function(){return gi},c2:function(){return ar},c3:function(){return sr},c5:function(){return getDefaultOptions},cd:function(){return easeOutSinusoidal},ce:function(){return cr},cf:function(){return easeOutElastic},cg:function(){return easeLinear},ch:function(){return easeOutCircular},ci:function(){return easeOutCubic},cj:function(){return Pi},ck:function(){return wi},cl:function(){return Nt},cm:function(){return ir},cn:function(){return createExternallyResolvablePromise},co:function(){return Te},cp:function(){return isEdgeSquare},cq:function(){return tuckMarking},cr:function(){return setPositionBySquare},cs:function(){return B},ct:function(){return createCollection},cu:function(){return getColorAsNumber},d:function(){return getSanFromFileRank},e:function(){return easeInOutQuartic},f:function(){return On},g:function(){return getFileRankFromSan$1},h:function(){return getColorAsWord},i:function(){return jt},j:function(){return createAnimator},k:function(){return isCastle},l:function(){return limitNumberWithinRange},m:function(){return makeSvgIcon},n:function(){return isCapture},o:function(){return getUndoMoveDetails},p:function(){return getArrowColor},q:function(){return rgbaToOpacity},r:function(){return rgbToHex},s:function(){return setTestData},t:function(){return createCoreEvent},u:function(){return f},v:function(){return getXYFromEvent},w:function(){return isTouchEvent},x:function(){return isRightButton},y:function(){return Ar},z:function(){return Mr}});var a,l,f,p,h,m,g,v,y,_,b,C,S,k,w,T,P,A,M,x=n(5746),O=Object.defineProperty,R=Object.defineProperties,I=Object.getOwnPropertyDescriptors,L=Object.getOwnPropertySymbols,N=Object.prototype.hasOwnProperty,D=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,n)=>t in e?O(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,__spreadValues=(e,t)=>{for(var n in t||(t={}))N.call(t,n)&&__defNormalProp(e,n,t[n]);if(L)for(var n of L(t))D.call(t,n)&&__defNormalProp(e,n,t[n]);return e},__spreadProps=(e,t)=>R(e,I(t));function is(e){return function isType2(t){return e===t.type}}function createAccessibilityPlugin(e=a.DefaultRightClickModifierKey){return{beforeState:[{condition:is(f.UserEvents.PointerdownLeft),handler:function convertToPointerdownRightIfModifierKeyPressed(t,n){const{api:a,queue:l,run:p}=n;if(a.keys.isPressed(e))return l.add(p,__spreadProps(__spreadValues({},t),{type:f.UserEvents.PointerdownRight})),!1;return!0}}],name:a.Plugin.Name,requires:["keys"]}}function isOneOf(e){const t=new Set(Array.isArray(e)?e:Object.values(e));return function isType2(e){return t.has(e.type)}}function createAnalysisOverlayPlugin(){let e;return{destroy:function destroy10(){null==e||e.removeAnalysisOverlay()},match:[{condition:isOneOf([f.APIEvents.Load,f.OptionsEvents.Update,f.InstanceEvents.ModeChanged,f.InstanceEvents.RendererSet]),handler:function updateAnalysisOverlay(t,n){const{options:a,renderer:l}=n;!e&&l&&(e=l);a.overlayInAnalysisMode?null==e||e.addAnalysisOverlay():null==e||e.removeAnalysisOverlay()}}],name:b.Plugin.Name}}(l=a||(a={})).DefaultRightClickModifierKey="a",(l.Plugin||(l.Plugin={})).Name="accessibility",p=f||(f={}),(h=p.LogCodes||(p.LogCodes={})).Event="Event",h.State="State",(m=p.State||(p.State={})).DraggingPiece="draggingPiece",m.HideHoverSquare="hideHoverSquare",m.MachineState="machineState",m.PromotionMove="promotionMove",m.SoundPlayed="soundPlayed",m.SelectedPiece="selectedPiece",(g=p.APIEvents||(p.APIEvents={})).AddMove="AddMove",g.BlinkHighlight="BlinkHighlight",g.ClearMarkings="ClearMarkings",g.CreateContinuation="CreateContinuation",g.CreateGame="CreateGame",g.DeletePosition="DeletePosition",g.DrawAgreed="DrawAgreed",g.DrawClaimed="DrawClaimed",g.GameResigned="GameResigned",g.IllegalMove="IllegalMove",g.LineCommentUpdated="LineCommentUpdated",g.LineUpdated="LineUpdated",g.Load="Load",g.Mark="Mark",g.Move="Move",g.MoveBackward="MoveBackward",g.MoveForward="MoveForward",g.MoveVariation="MoveVariation",g.NodeUpdated="NodeUpdated",g.OutOfTime="OutOfTime",g.PromoteVariation="PromoteVariation",g.Reload="Reload",g.ResetGame="ResetGame",g.ResetToMainLine="ResetToMainLine",g.SelectLineEnd="SelectLineEnd",g.SelectNode="SelectNode",g.SelectLineStart="SelectLineStart",g.SetBoardPosition="SetBoardPosition",g.SetPlayingAs="SetPlayingAs",g.TurnSet="TurnSet",g.Undo="Undo",g.Unmark="Unmark",g.UpdatePGNHeaders="UpdatePGNHeaders",(v=p.BoardEvents||(p.BoardEvents={})).PromotionAreaClosePointerdown="PromotionAreaClosePointerdown",v.PromotionPiecePointerdown="PromotionPiecePointerdown",(y=p.InstanceEvents||(p.InstanceEvents={})).Create="Create",y.Destroy="Destroy",y.ModeChanged="ModeChanged",y.RendererSet="RendererSet",(p.OptionsEvents||(p.OptionsEvents={})).Update="UpdateOptions",(p.SoundEvents||(p.SoundEvents={})).Play="PlaySound",(p.UIEvents||(p.UIEvents={})).Resize="Resize",(_=p.UserEvents||(p.UserEvents={})).MousedownLeft="MousedownLeft",_.MousedownRight="MousedownRight",_.PointerdownLeft="PointerdownLeft",_.PointerdownRight="PointerdownRight",_.Pointermove="Pointermove",_.Pointerup="Pointerup",_.Wheel="Wheel",((C=b||(b={})).Plugin||(C.Plugin={})).Name="analysis-overlay",((k=S||(S={})).Plugin||(k.Plugin={})).Name="cheatDetection",T=w||(w={}),(P=T.Units||(T.Units={})).Milliseconds="Milliseconds",P.Deciseconds="Deciseconds",P.Seconds="Seconds",((M=A||(A={})).Plugin||(M.Plugin={})).Name="highlights";const B="highlight";var F,j,$,H,V;((j=F||(F={})).Plugin||(j.Plugin={})).Name="arrowKeys",($=j.Arrow||(j.Arrow={})).Left="arrowleft",$.Up="arrowup",$.Right="arrowright",$.Down="arrowdown",((V=H||(H={})).Plugin||(V.Plugin={})).Name="arrows";const U="arrow";var G,q,W,z,K,Z,Q,X,Y,J,ee,te,ne,re,oe,ie,ae,se,ce,le,ue;((q=G||(G={})).Plugin||(q.Plugin={})).Name="assets",((z=W||(W={})).Plugin||(z.Plugin={})).Name="blinking-highlight",((Z=K||(K={})).Plugin||(Z.Plugin={})).Name="blinking-highlight",((X=Q||(Q={})).Plugin||(X.Plugin={})).Name="board-size",(J=Y||(Y={})).DefaultKeyToOpenWindow="e",(J.Plugin||(J.Plugin={})).Name="boardImages",((te=ee||(ee={})).Plugin||(te.Plugin={})).Name="bughouse-api",((re=ne||(ne={})).Plugin||(re.Plugin={})).Name="bughouse-sibling-board",((ie=oe||(oe={})).Plugin||(ie.Plugin={})).Name="clocks",(ae=ie.TimeControlTypes||(ie.TimeControlTypes={})).Blitz="blitz",ae.Bullet="bullet",ae.Rapid="rapid",((ce=se||(se={})).Plugin||(ce.Plugin={})).Name="coordinates",((ue=le||(le={})).Plugin||(ue.Plugin={})).Name="custom-items",(ue.Classes||(ue.Classes={})).Root="custom-item";const de="customItem";var fe,pe,he,me,ge,ve,ye,_e,be,Ce,Se,ke,we;pe=fe||(fe={}),(he=pe.Targets||(pe.Targets={})).Arrows="arrows",he.Effects="effects",he.Pieces="pieces",(me=pe.Positions||(pe.Positions={})).Above="above",me.Below="below",(ve=ge||(ge={})).Image="Image",ve.Star="Star",ve.TextBox="TextBox",((_e=ye||(ye={})).Plugin||(_e.Plugin={})).Name="debug",(Ce=be||(be={})).Name="eco",(Ce.Events||(Ce.Events={})).Update="UpdateECO",((Se=Ce.Config||(Ce.Config={})).Codes||(Se.Codes={})).StartingPosition="A00",Se.InitialFen="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",((we=ke||(ke={})).Plugin||(we.Plugin={})).Name="effects";const Te="effect";var Pe,Ee,Ae,Me,xe,Oe,Re,Ie,Le,Ne,De,Be,Fe,je,$e,He,Ve,Ue,Ge,qe,We,ze,Ke,Ze,Qe,Xe,Ye,Je,et,tt,nt,rt,ot,it,at,st,ct,lt;(Ee=Pe||(Pe={})).Alternative="Alternative",Ee.BestMove="BestMove",Ee.Blunder="Blunder",Ee.Book="Book",Ee.Brilliant="Brilliant",Ee.CheckmateBlack="CheckmateBlack",Ee.CheckmateWhite="CheckmateWhite",Ee.Correct="Correct",Ee.Critical="Critical",Ee.DrawBlack="DrawBlack",Ee.DrawWhite="DrawWhite",Ee.Excellent="Excellent",Ee.FastWin="FastWin",Ee.Forced="Forced",Ee.FreePiece="FreePiece",Ee.Gamechanger="Gamechanger",Ee.Good="Good",Ee.GreatFind="GreatFind",Ee.Inaccuracy="Inaccuracy",Ee.Incorrect="Incorrect",Ee.Mate="Mate",Ee.MissedWin="MissedWin",Ee.Mistake="Mistake",Ee.ResignBlack="ResignBlack",Ee.ResignWhite="ResignWhite",Ee.Sharp="Sharp",Ee.Takeback="Takeback",Ee.Threat="Threat",Ee.TimeoutBlack="TimeoutBlack",Ee.TimeoutWhite="TimeoutWhite",Ee.Undo="Undo",Ee.Winner="Winner",Ee.WinnerWhite="WinnerWhite",Ee.Interesting="Interesting",Ee.Warning="Warning",Ee.Equal="Equal",((Me=Ae||(Ae={})).Plugin||(Me.Plugin={})).Name="fade-setup",((Oe=xe||(xe={})).Plugin||(Oe.Plugin={})).Name="handPieces",(Oe.Events||(Oe.Events={})).SetHand="SetHand",((Ie=Re||(Re={})).Plugin||(Ie.Plugin={})).Name="hml",((Ne=Le||(Le={})).Plugin||(Ne.Plugin={})).Name="hover-square",((Be=De||(De={})).Plugin||(Be.Plugin={})).Name="move-hints",((je=Fe||(Fe={})).Plugin||(je.Plugin={})).Name="pieces",((He=$e||($e={})).Plugin||(He.Plugin={})).Name="pregame",((Ue=Ve||(Ve={})).Events||(Ue.Events={})).Premove="Premove",(Ue.Plugin||(Ue.Plugin={})).Name="premoves",((qe=Ge||(Ge={})).Plugin||(qe.Plugin={})).Name="reporting",((ze=We||(We={})).Plugin||(ze.Plugin={})).Name="scroll-through-moves",((Ze=Ke||(Ke={})).Plugin||(Ze.Plugin={})).Name="sounds",(Qe=Ze.BoardSounds||(Ze.BoardSounds={})).GameStart="game-start",Qe.GameEnd="game-end",Qe.Capture="capture",Qe.Castle="castle",Qe.Premove="premove",Qe.MoveSelf="move-self",Qe.MoveCheck="move-check",Qe.MoveOpponent="move-opponent",Qe.Promote="promote",Qe.Notify="notify",Qe.TenSeconds="tenseconds",Qe.Illegal="illegal",Ze.maxTagsPerSound=5,((Ye=Xe||(Xe={})).Events||(Ye.Events={})).Updated="ThreatsUpdated",(Ye.Plugin||(Ye.Plugin={})).Name="threats",((et=Je||(Je={})).Plugin||(et.Plugin={})).Name="timeControl",function(e){e.Blitz="blitz",e.Bullet="bullet",e.Rapid="rapid"}(et.Types||(et.Types={})),(tt=et.Header||(et.Header={})).Null="-",tt.Separator="+",tt.TimePerMove="/",tt.Unset="?",rt=nt||(nt={}),(ot=rt.Actions||(rt.Actions={})).Reset="Reset",ot.Start="Start",ot.Stop="Stop",ot.Tick="Tick",(it=rt.Events||(rt.Events={})).End="End",it.Reset="Reset",it.Start="Start",it.Stop="Stop",it.Tick="Tick",it.TimeAdded="TimeAdded",(at=rt.States||(rt.States={})).Ended="Ended",at.Going="Going",at.Initial="Initial",at.Stopped="Stopped",function(e){let t;(e.Plugin||(e.Plugin={})).Name="validate",(t=e.ErrorCodes||(e.ErrorCodes={})).InvalidPosition="InvalidPosition",e.ErrorMessages={[t.InvalidPosition]:"Board position does not match the FEN from JCE"}}(st||(st={})),function(e){e.Ready="Ready",e.ResultNodeSelected="ResultNodeSelected",e.Updated="Updated"}((lt=ct||(ct={})).Events||(lt.Events={})),(lt.Plugin||(lt.Plugin={})).Name="vml";var ut,dt;Symbol.toStringTag;function createArrowKeysPlugin(e){let t;return{api:()=>({setKeys:setKeys,resetKeys:resetKeys}),create:function create3(n){t=n,setKeys(e)},destroy:function destroy10(){t.api.keys.removeCallbacks([{key:F.Arrow.Up},{key:F.Arrow.Down},{key:F.Arrow.Left},{key:F.Arrow.Right}])},name:F.Plugin.Name};function setKeys(e){const n=getCallbacks(e);t.api.keys.setCallbacks(n)}function resetKeys(){const e=getCallbacks();t.api.keys.setCallbacks(e)}function getCallbacks(e={}){return[{key:F.Arrow.Up,callback:t=>{var n;return null!=(n=e[F.Arrow.Up])?n:t.selectLineStart}},{key:F.Arrow.Down,callback:t=>{var n;return null!=(n=e[F.Arrow.Down])?n:t.selectLineEnd}},{key:F.Arrow.Left,callback:t=>{var n;return null!=(n=e[F.Arrow.Left])?n:t.moveBackward}},{key:F.Arrow.Right,callback:t=>{var n;return null!=(n=e[F.Arrow.Right])?n:t.moveForward}}]}}function createKeyedArrow({options:e,rawArrow:t}){var n,a;const{data:{color:l,keyPressed:f,from:p,opacity:h,to:m},key:g,type:v}=t;return{data:{color:null!=(a=null!=(n=getArrowColor$1(f,e))?n:l)?a:e.arrowColors.default,from:p,opacity:null!=h?h:e.analysisHighlightOpacity,to:m},key:g,type:v}}function getArrowColor$1(e,t){const{arrowColors:n}=t;switch(e){case ut.Alt:return n.alt;case ut.Ctrl:return n.ctrl;case ut.Shift:return n.shift;case ut.None:return n.default;default:return}}function isMark(e){return function isMarkingOfType(t){var n,a;return is(f.APIEvents.Mark)(t)&&(null==(a=(n=t.data).find)?void 0:a.call(n,(t=>t.type===e)))}}function isType(e){return function markingIsType(t){return t.type===e}}function isUnmark(e){return function isMarkingOfType(t){var n,a;return is(f.APIEvents.Unmark)(t)&&(null==(a=(n=t.data).find)?void 0:a.call(n,(t=>t.type===e)))}}function createArrowsPlugin(){return{match:[{condition:isMark(U),handler:function markArrow(e,t){const{options:n,renderer:a}=t,{data:l}=e,f=l.filter(isType(U)).map((e=>createKeyedArrow({rawArrow:e,options:n})));null==a||a.addArrows(f,t)}},{condition:isUnmark(U),handler:function unmarkArrow(e,t){const{options:n,renderer:a}=t,{data:l}=e,f=l.filter(isType(U)).map((e=>createKeyedArrow({rawArrow:e,options:n})));null==a||a.removeArrows(f,t)}},{condition:is(f.InstanceEvents.RendererSet),handler:function init2(e,t){const{api:n,options:a,renderer:l}=t,f=n.markings,p=(a.allowMarkings?f.getAllWhere({types:[U]}):[]).map((e=>createKeyedArrow({rawArrow:e,options:a})));null==l||l.addArrows(p,t)}}],name:H.Plugin.Name}}function createAssetsPlugin(){let e,t;return{match:[{condition:isOneOf([f.InstanceEvents.RendererSet,f.OptionsEvents.Update]),handler:function updateAssets(n,a){const{options:l,renderer:f}=a;if(!f)return;l.boardStyle!==e&&(e=l.boardStyle,f.updateBoardImage(a));l.pieceStyle!==t&&(t=l.pieceStyle,f.updatePieceBaseImage(a))}}],name:G.Plugin.Name}}function createBlinkingHighlightPlugin(){return{match:[{condition:is(f.APIEvents.BlinkHighlight),handler:function blinkHighlight(e,t){const{renderer:n}=t;null==n||n.blinkHighlights(e.data,t)}}],name:W.Plugin.Name}}(dt=ut||(ut={})).Alt="alt",dt.Ctrl="ctrl",dt.None="none",dt.Shift="shift";var ft,pt,ht,mt,gt,vt,yt,_t,bt,Ct,St,kt,wt,Tt,Pt,Et,At,Mt,xt;function createBoardDisabledPlugin(){return{create:function create3(e){e.el.classList.toggle(Tt.Disabled,!e.options.enabled)},match:[{condition:is(f.OptionsEvents.Update),handler:function handleEnabledOption(e,t){const{data:n}=e,{el:a,renderer:l}=t;"enabled"in n&&(a.classList.toggle(Tt.Disabled,!n.enabled),null==l||l.setBoardEnabled(n.enabled))}}],name:ft.Plugin.Name}}function createBoardSizePlugin(){return{match:[{condition:isOneOf([f.UIEvents.Resize,f.InstanceEvents.RendererSet]),handler:function resize3(e,t){const{renderer:n}=t;null==n||n.resize(t)}}],name:Q.Plugin.Name}}((pt=ft||(ft={})).Plugin||(pt.Plugin={})).Name="board-disabled",mt=ht||(ht={}),function(e){e.Arcade="arcade",e.Default="default",e.Fast="fast",e.Natural="natural",e.None="none",e.Slow="slow"}((gt=mt.Animation||(mt.Animation={})).Types||(gt.Types={})),(vt=gt.Speeds||(gt.Speeds={}))[vt.Default=180]="Default",vt[vt.Fast=100]="Fast",vt[vt.Slow=500]="Slow",(yt=mt.HighlightColors||(mt.HighlightColors={})).Selected="#ffff00",yt.Blue="#52b0dc",yt.Green="#acce59",yt.Orange="#ffaa00",yt.Red="#eb6150",(_t=mt.HighlightTypes||(mt.HighlightTypes={})).Analysis="analysis",_t.Move="move",_t.Selected="selected",(bt=mt.HighlightedArrowColors||(mt.HighlightedArrowColors={})).Blue="rgba(72, 193, 249, 0.8)",bt.Green="rgba(159, 207, 63, 0.8)",bt.Orange="rgba(255, 170, 0, 0.8)",bt.Red="rgba(248, 85, 63, 0.8)",(Ct=mt.CoordinatesPositions||(mt.CoordinatesPositions={})).Inside="inside",Ct.Off="off",Ct.Outside="outside",(St=mt.MoveMethods||(mt.MoveMethods={})).Click="click",St.Drag="drag",St.DragOnly="drag-only",(kt=mt.MoveListDisplayTypes||(mt.MoveListDisplayTypes={})).Figurine="figurine",kt.Text="text",(mt.BooleanOptions||(mt.BooleanOptions={})).HoverSquareOutline="hoverSquareOutline",(wt=mt.SaveableOptions||(mt.SaveableOptions={})).AnimationType="animationType",wt.BoardStyle="boardStyle",wt.Coordinates="coordinates",wt.DarkMode="darkMode",wt.EvaluationBarType="evaluationBarType",wt.HighlightLegalMoves="highlightLegalMoves",wt.HighlightMoves="highlightMoves",wt.MoveListDisplayType="moveListDisplayType",wt.PieceStyle="pieceStyle",wt.SoundTheme="soundTheme",wt.PlaySounds="playSounds",(Pt=Tt||(Tt={})).Pseudo3d="pseudo3d",Pt.Disabled="board-disabled",Pt.Flipped="flipped",(At=Et||(Et={})).All="All",At.Move="Move",function(e){e.Default="default",e.WebGL2D="webgl-2d",e.WebGL3D="webgl-3d"}((xt=Mt||(Mt={})).Types||(xt.Types={})),xt.TriggerOptions=[ht.SaveableOptions.AnimationType,ht.SaveableOptions.PieceStyle];const Ot=(0,x.c)({data:{chosenPiece:"",didChangePieces:!1,mouseCoords:[],moveHoldTimes:[],tentativeMouseCoords:{x:0,y:0}},initialState:"idle",states:{changedPiece:{load:load,move:()=>({data:{chosenPiece:void 0,didChangePieces:!0,mouseCoords:[...Ot.getData().mouseCoords,Ot.getData().tentativeMouseCoords],moveHoldTimes:[...Ot.getData().moveHoldTimes,Date.now()-Ot.getData().moveHoldTimeStart]},nextState:"idle"})},chosenPiece:{choosePiece:({tentativeMouseCoords:e,moveHoldTimeStart:t})=>({data:{moveHoldTimeStart:t,tentativeMouseCoords:e},nextState:"changedPiece"}),load:load,move:()=>({data:{chosenPiece:void 0,mouseCoords:[...Ot.getData().mouseCoords,Ot.getData().tentativeMouseCoords],moveHoldTimes:[...Ot.getData().moveHoldTimes,Date.now()-Ot.getData().moveHoldTimeStart]},nextState:"idle"})},idle:{choosePiece:({chosenPiece:e,moveHoldTimeStart:t,tentativeMouseCoords:n})=>({data:{chosenPiece:e,didChangePieces:!1,moveHoldTimeStart:t,tentativeMouseCoords:n},nextState:"chosenPiece"}),load:load}}});function load(){return{data:{chosenPiece:"",didChangePieces:!1,mouseCoords:[],moveHoldTimes:[],tentativeMouseCoords:{x:0,y:0}},nextState:"idle"}}var Rt,It,Lt;function didUseCheatMouse(e){const t={},n=e.mouseCoords.length/2;return e.mouseCoords.some((e=>{const a=`${e.x}-${e.y}`;return void 0===t[a]?t[a]=0:t[a]+=1,t[a]>=n}),{})}function createCheatDetectionPlugin(){return{api:()=>function createCheatDetectionAPI({machine:e}){return{get:function get2(){const t=e.getData();return{didChangePieces:t.didChangePieces,didUseCheatMouse:didUseCheatMouse(t),moveHoldTimes:t.moveHoldTimes}}}}({machine:Ot}),match:[{condition:isOneOf([f.UserEvents.PointerdownLeft,f.UserEvents.Pointerup]),handler:function choosePiece(e,t){const{mode:n,state:a}=t;if(a.get(f.State.MachineState)===Rt.States.PromotionAreaShowing||!e.data||!n.isAllowedToMove())return;const l=a.get(f.State.SelectedPiece)||a.get(f.State.DraggingPiece);l&&l!==Ot.getData().chosenPiece&&Ot.transition("choosePiece",{chosenPiece:l,moveHoldTimeStart:Date.now(),tentativeMouseCoords:e.data.coordsInsideSquare})}},{condition:is(f.APIEvents.Load),handler:function handleAPILoad(){Ot.transition("load")}},{condition:is(f.APIEvents.Move),handler:function handleAPIMove(){Ot.transition("move")}}],name:S.Plugin.Name}}function createCoordinatesPlugin(){let e,t=!1;return{match:[{condition:isOneOf([f.InstanceEvents.RendererSet,f.OptionsEvents.Update]),handler:function updateCoordinates(n,a){const{options:l,renderer:p}=a;if(!p)return;l.coordinates===e&&l.flipped===t&&n.type!==f.InstanceEvents.RendererSet||p.setCoordinates({flipped:l.flipped,position:l.coordinates},a);e=l.coordinates,t=l.flipped}}],name:se.Plugin.Name}}function createCustomItemsAPI(e){return function createAPI2(){return function createCustomItems(e){return{getDefaultStarColor:function getDefaultStarColor(){return e}}}(e)}}(function(e){e.AddingMarkings="AddingMarkings",e.Idle="Idle",e.PieceDragging="PieceDragging",e.PieceSelected="PieceSelected",e.PromotionAreaShowing="PomotionAreaShowing"})((It=Rt||(Rt={})).States||(It.States={})),(Lt||(Lt={})).Name="core";var Nt,Dt,Bt,Ft,jt,$t;function easeLinear(e){return e}function easeOutQuadratic(e){return e*(2-e)}function easeInOutQuadratic(e){return(e*=2)<1?.5*e*e:-.5*(--e*(e-2)-1)}function easeOutCubic(e){return--e*e*e+1}function easeInOutQuartic(e){return(e*=2)<1?.5*e*e*e*e:-.5*((e-=2)*e*e*e-2)}function easeOutSinusoidal(e){return Math.sin(e*Math.PI/2)}function easeOutCircular(e){return Math.sqrt(1- --e*e)}function easeOutElastic(e){return 0===e?0:1===e?1:Math.pow(2,-10*e)*Math.sin(5*(e-.1)*Math.PI)+1}function createAnimation(e){const{data:t,keyframes:n,repeat:a,target:l,onEnd:f}=e,p=function getAnimatedProps(e){if(!e)return{};if(!e[0])throw new Error("The animation keyframes must contain values at `0` percentage.");return __spreadValues({},e[0])}(n),h=function getAnimatedPropsKeyframes(e,t){if(!t)return{};const n=Object.keys(e),a={};return n.forEach((e=>a[e]=[])),Object.keys(t).sort(((e,t)=>parseInt(e,10)-parseInt(t,10))).forEach((e=>{n.forEach((n=>{void 0!==t[e][n]&&a[n].push(parseInt(e,10))}))})),a}(p,n),m={animatedProps:p,animatedPropsKeyframes:h,data:__spreadValues({},t),endCallbacks:[],ended:!1,endTime:0,forcedEnd:!1,frameInfo:{deltaTime:0,elapsedInterval:0,elapsedPercentage:0},isTargetHTMLElement:l instanceof HTMLElement,onEnd:e=>m.endCallbacks.push(e),params:e,repeatCount:a||1,started:!1,startTime:0,keptAlive:!1};return f&&m.endCallbacks.push(f),m}function createAnimator(e=!1){const t=[];let n=0,a=0;return{end:end,endAll:function endAll(){[...t].forEach(end)},play:function play(l){const f=createAnimation(l);t.push(f),n||e||function startAnimationLoop(){a=performance.now(),n=requestAnimationFrame(animationLoop)}();return f},playingAnimationsCount:()=>t.length,update:function update5(e){animationLoop(e)}};function animationLoop(l){const f=.001*(l-a);t.forEach((e=>{if(e.startTime>l)return;const t=e.frameInfo;t.deltaTime=f,(e.started||function onAnimationStart(e,t){const{duration:n,delay:a,onStart:l}=e.params;e.startTime||(e.startTime=t+(a||0),n&&n!==1/0&&(e.endTime=e.startTime+n));if(e.startTime>t)return!1;return e.started=!0,null==l||l(e),!0}(e,l))&&(e.endTime&&(t.elapsedInterval=(l-e.startTime)/(e.endTime-e.startTime),t.elapsedInterval>1&&(t.elapsedInterval=1),t.elapsedPercentage=Math.round(100*t.elapsedInterval)),onAnimationUpdate(e),e.endTime&&e.endTime<=l&&onAnimationEnd(e))})),a=l,t.length&&!e&&(n=requestAnimationFrame(animationLoop))}function end(e){e.ended||t.indexOf(e)<0||(e.frameInfo.elapsedInterval=1,e.frameInfo.elapsedPercentage=100,onAnimationUpdate(e),onAnimationEnd(e,!0))}function onAnimationEnd(a,l=!1){const{duration:f,keepAlive:p,repeatDelay:h}=a.params;if(a.repeatCount--,a.forcedEnd=l,!l&&a.repeatCount>0&&f&&f!==1/0)return a.startTime=a.endTime+(h||0),void(a.endTime=a.startTime+f);l||!p?(a.ended=!0,a.endCallbacks.forEach((e=>e(a))),function removeAnimation(a){const l=t.indexOf(a);l>=0&&t.splice(l,1);t.length||e||function stopAnimationLoop(){n&&cancelAnimationFrame(n);n=0}()}(a)):a.keptAlive=!0}function onAnimationUpdate(e){const{onUpdate:t}=e.params;!function updateAnimatedProperties(e){const{animatedProps:t,animatedPropsKeyframes:n,frameInfo:a,isTargetHTMLElement:l,params:f}=e,{keyframes:p,target:h}=f,{elapsedPercentage:m}=a,g=f.easing||easeLinear;if(!p)return;let v,y,_,b,C;Object.keys(t).forEach((e=>{for(let t=1;t<n[e].length;t++)if(_=n[e][t-1],b=n[e][t],m>=_&&m<=b){v=p[_][e],y=p[b][e];break}C=(m-_)/(b-_),C=g(C),t[e]=v+(y-v)*C,h&&!l&&(h[e]=t[e])}))}(e),null==t||t(e)}}function createCollection(e={}){const t=e;return{deleteItem:function deleteItem(e){delete t[e]},get:function get2(e){if(void 0===t[e])throw new Error(`Requested object at key ${e} is undefined.`);return t[e]},getCollection:function getCollection(){return t},isDefined:function isDefined(e){return void 0!==t[e]},keys:function keys(){return Object.keys(t)},set:function set3(e,n){t[e]=n}}}function getFileRankFromSan$1(e){return{file:e.toLowerCase().charCodeAt(0)-96,rank:Number(e.charAt(1))}}function setPositionBySquare({square:e,el:t}){const n=getFileRankFromSan$1(e);n&&(t.className=function removeClassNamesStartingWith(e,t){return e.split(" ").filter((e=>!e.startsWith(t))).join(" ").trim()}(t.className,"square-"),t.classList.add(`square-${n.file}${n.rank}`),t.style.transform="")}function setTestData(e,t){return!!e&&(Object.entries(t).forEach((([t,n])=>{const a=`${t.charAt(0).toUpperCase()}${t.slice(1)}`;void 0===n?delete e.dataset[`test${a}`]:e.dataset[`test${a}`]=n})),!0)}(Dt=Nt||(Nt={})).Arrows="arrows",Dt.BlinkingHighlights="blinking-highlights",Dt.CaptureHints="capture-hints",Dt.Coordinates="coordinates",Dt.Effects="effects",Dt.FadeSetup="fade-setup",Dt.HoverSquare="hover-square",Dt.MoveHints="move-hints",Dt.Pieces="pieces",Dt.PromotionWindow="promotion-window",Dt.Squares="squares",(Ft=Bt||(Bt={})).Anchor="anchor",Ft.Blinking="blinking",Ft.Color="color",Ft.Dragging="dragging",Ft.Editable="editable",Ft.Element="element",Ft.EnPassant="enPassant",Ft.File="file",Ft.Figurine="figurine",Ft.Flipped="flipped",Ft.Inside="inside",Ft.Interval="interval",Ft.LeadingFigurine="leadingFigurine",Ft.Opacity="opacity",Ft.Outside="outside",Ft.Position="position",Ft.Rank="rank",Ft.Selected="selected",Ft.ShortString="shortstring",Ft.Square="square",Ft.Star="star",Ft.TextColor="textColor",Ft.TextValue="textValue",Ft.Times="times",Ft.TrailingFigurine="trailingFigurine",Ft.Type="type",Ft.WholeMoveNumber="wholeMoveNumber",Ft.X="x",Ft.Y="y",($t=jt||(jt={})).Arrow="arrow",$t.BlinkingHighlight="blinking-highlight",$t.Board="board",$t.CommentLink="comment-link",$t.Coordinates="coordinates",$t.CustomItem="custom-item",$t.Effect="effect",$t.FadeInOverlay="fade-in-overlay",$t.GameResult="game-result",$t.HalfMove="half-move",$t.Highlight="highlight",$t.Hint="hint",$t.HoverSquare="hover-square",$t.Move="move",$t.Piece="piece",$t.PotentialCapture="capture-hint",$t.PromotionCloseButton="promotion-close-button",$t.PromotionPiece="promotion-piece",$t.PromotionWindow="promotion-window",$t.Square="square",$t.SiblingBoard="sibling-board";var Ht,Vt,Ut,Gt,qt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Image:'\n<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <image x="7.5" y="7.5" width="25" height="25" />\n</svg>\n',Star:'\n  <svg xmlns="http://www.w3.org/2000/svg" style="fill: #ffa704" viewBox="0 0 40 40">\n    <path\n      d="M23.12,17.84H16.4a1.11,1.11,0,0,1-1.06-1.43L18.7,5.21a1.11,1.11,0,0,1,2.13,0l3.36,11.2A1.11,1.11,0,0,1,23.12,17.84Z" />\n    <path\n      d="M27.21,34.11,4.35,16.88a1.11,1.11,0,0,1,.67-2l17.89,0a1.11,1.11,0,0,1,1.06.8l5,17.19A1.11,1.11,0,0,1,27.21,34.11Z" />\n    <path\n      d="M35.17,16.88,12.31,34.11a1.11,1.11,0,0,1-1.74-1.2l5-17.19a1.11,1.11,0,0,1,1.06-.8l17.89,0A1.11,1.11,0,0,1,35.17,16.88Z" />\n  </svg>\n',TextBox:'\n<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <rect x="5" y="12.5" width="30" height="15" rx="3" fill="inherit" />\n  <text fill="#676767" font-size="0.8rem" x="20.5" y="20.5" dominant-baseline="middle" text-anchor="middle"></text>\n</svg>\n'});function createCustomItemsMethods({board:e,el:t,options:n}){const a=createCollection(),l=createCollection(),f=createAnimator(),p=createCollection(),h=document.createComment("/Custom Items");return e.addToDom({el:h,insertAfter:!0,type:Nt.Pieces}),{addCustomItems:function addCustomItems(m){m.forEach((m=>{const{data:{color:g,image:v,opacity:y,text:_,type:b,visualOrder:C,frame:S,removalClass:k,square:w}}=m;l.isDefined(w)&&function flushAnimatingCustomItem(e,t="captured"){const n=a.get(e);n&&n.classList.contains(t)&&(removeCustomItemElement(n,e),clearTimeout(l.get(e)),l.deleteItem(e))}(w,k),p.isDefined(w)&&f.end(p.get(w));const T=document.createElement("div");if(T.classList.add(le.Classes.Root),S){T.classList.add("custom-item__frame"),S.imageAnimated&&T.classList.add("custom-item__frame--animated");const e=function createCustomItemFrame(e){if(!e)return;const t=document.createElement("div"),{imageURL:n,imageAnimated:a,positionRatioX:l,positionRatioY:f,widthRatio:p,heightRatio:h}=e,m=l/p/(1/p-1)*100,g=f/h/(1/h-1)*100,v=a?"auto 100%":`${1/p*100}% ${1/h*100}%`;return t.style.backgroundImage=`url(${n})`,t.style.backgroundSize=v,t.style.backgroundPositionX=`${m}%`,t.style.backgroundPositionY=`${g}%`,t}(S);e&&T.appendChild(e)}else T.innerHTML=qt[b],function assignSVGAttributes(){const e=T.querySelector("svg");if(!e)return;g&&(e.style.fill=g);y&&(e.style.opacity=String(y));if(v){const t=e.querySelector("image");if(!t)return;if(t.setAttribute("href",v.url),v.percentOfSquare){const{width:n}=e.viewBox.baseVal,a=n*v.percentOfSquare*.01,l=(n-a)/2;Object.assign(t.style,{height:a,width:a,x:l,y:l})}}if(_){const t=e.querySelector("text");if(!t)return;t.innerHTML=_.value,_.color&&(t.style.fill=_.color)}}();setPositionBySquare({el:T,square:w}),n.test&&setTestData(T,{[Bt.Color]:g,[Bt.Element]:jt.CustomItem,[Bt.Opacity]:y,[Bt.Square]:w,[Bt.Type]:b});const P=function getDOMTarget(e){if(!e)return null;const t=e.position===fe.Positions.Below;return e.target===fe.Targets.Arrows?{insertBefore:t,type:Nt.Arrows}:e.target===fe.Targets.Effects?{insertBefore:t,type:Nt.Effects}:e.target===fe.Targets.Pieces?{insertBefore:!t,type:t?Nt.Effects:Nt.Pieces}:null}(C);P?e.addToDom(__spreadValues({el:T},P)):t.insertBefore(T,h),a.set(w,T)}))},removeCustomItems:function removeCustomItems(e){e.forEach((e=>{const{data:t}=e,{frame:n,removalClass:h="captured",removalTimeout:m=250,square:g}=t,v=a.get(g);v&&((null==n?void 0:n.imageAnimated)?function animateCustomItemImage({customItemElement:e,imageURL:t,square:n,onAnimationEnd:a}){const l=e.querySelector("div");if(!l)return void a();const h=new Image;h.src=t,h.onload=()=>{const t=e.clientHeight,m=Math.ceil(h.naturalWidth/h.naturalHeight),g=1/m,v=f.play({duration:m/24*1e3,data:{currentFrame:1},onUpdate:()=>{const{data:e,frameInfo:n}=v;g*e.currentFrame<n.elapsedInterval&&(l.style.backgroundPositionX=`-${t*e.currentFrame}px`,e.currentFrame++)},onEnd:a});p.set(n,v)}}({customItemElement:v,imageURL:n.imageURL,square:g,onAnimationEnd:()=>{p.isDefined(g)&&p.deleteItem(g),removeCustomItemElement(v,g)}}):(v.classList.add(h),l.set(g,window.setTimeout((()=>{l.isDefined(g)&&l.deleteItem(g),v&&removeCustomItemElement(v,g)}),m))))}))}};function removeCustomItemElement(e,n){t.removeChild(e),a.deleteItem(n)}}function createCustomItemsEventHandlers(){return[{condition:isMark(de),handler:function markCustomItem(e,t){const{api:n,renderer:a}=t,l=n["custom-items"],f=e.data.filter(isType(de)).map((e=>e.data.color?e:function withDataProp(e,t,n){const a=__spreadValues({},e);return a.data[t]=n,a}(e,"color",l.getDefaultStarColor())));null==a||a.addCustomItems(f,t)}},{condition:isUnmark(de),handler:function unmarkCustomItem(e,t){const{api:n,queue:a,renderer:l}=t,f=e.data.filter(isType(de));f.forEach((e=>{const t=e.data.removalSound;t&&a.add(n.playSound,t)})),null==l||l.removeCustomItems(f,t)}},{condition:is(f.InstanceEvents.RendererSet),handler:function init2(e,t){const{api:n,options:a,renderer:l}=t,f=n.markings;null==l||l.extendRenderer(createCustomItemsMethods);const p=a.allowMarkings?f.getAllWhere({types:[de]}):[];null==l||l.addCustomItems(p,t)}}]}function createCustomItemsPlugin({defaultStarColor:e=Ht.DefaultSquareColor}={}){return{api:createCustomItemsAPI(e),match:createCustomItemsEventHandlers(),name:le.Plugin.Name}}function createDebugPlugin(){let e,t;return{create:function create3(e){const{api:{logger:t}}=e;t.on(Vt.Events.EntryAdded,logToConsole)},name:ye.Plugin.Name};function logToConsole(n){void 0===n.code||n.code===f.LogCodes.State&&JSON.stringify(n.data)===e||n.code===f.LogCodes.Event&&n.data.type===f.UserEvents.Pointermove&&t===f.UserEvents.Pointermove||n.code===f.LogCodes.Event&&n.data.type===f.UIEvents.Resize&&t===f.UIEvents.Resize||(n.code===f.LogCodes.State&&(e=JSON.stringify(n.data)),n.code===f.LogCodes.Event&&(t=n.data.type),console.group(n.code),n.level===Vt.Levels.Error?console.error(n.data):console.log(n.data),console.groupEnd())}}(Ht||(Ht={})).DefaultSquareColor="#ffa704",function(e){e.EntryAdded="EntryAdded"}((Ut=Vt||(Vt={})).Events||(Ut.Events={})),(Gt=Ut.Levels||(Ut.Levels={})).Debug="Debug",Gt.Error="Error",Gt.None="None";var Wt;function isEdgeSquare(e){if(!e)return!1;let t=!1;return["a","h","1","8"].forEach((n=>{e.includes(n)&&(t=!0)})),t}!function(e){var t;(t=e.ClassNames||(e.ClassNames={})).Background="icon-background",t.Component="icon-component",t.ComponentShadow="icon-component-shadow",t.Shadow="icon-shadow"}(Wt||(Wt={}));const zt=`<g id="alternative">\n    <g>\n      <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <path class="${Wt.ClassNames.Background}" fill="#96af8b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    </g>\n    <g>\n      <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.2">\n        <path d="M14.57,4.71l-4.42.2a.2.2,0,0,0-.11,0A.16.16,0,0,0,10,5a.21.21,0,0,0,0,.11.31.31,0,0,0,0,.1l1.4,1.4L8.92,9.13,6.5,6.71,8,5.24a.19.19,0,0,0,0-.1A.14.14,0,0,0,8,5,.15.15,0,0,0,8,4.94a.21.21,0,0,0-.11,0L3.42,4.71l-.08,0-.06,0a.18.18,0,0,0,0,.07.19.19,0,0,0,0,.08l.19,4.42a.15.15,0,0,0,0,.11.18.18,0,0,0,.08.07.25.25,0,0,0,.12,0,.18.18,0,0,0,.09-.06L5.21,8l2.55,2.56v4.49a.29.29,0,0,0,0,.09l0,.07.08,0,.09,0H9.85l.09,0a.18.18,0,0,0,.07,0l.05-.07a.29.29,0,0,0,0-.09V10.57l2.63-2.63,1.55,1.54a.16.16,0,0,0,.09,0,.17.17,0,0,0,.12,0,.18.18,0,0,0,.08-.07.13.13,0,0,0,0-.1l.19-4.43a.19.19,0,0,0,0-.08.18.18,0,0,0,0-.07l-.07,0Z"></path>\n      </g>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M14.57,4.21l-4.42.2a.2.2,0,0,0-.11,0,.16.16,0,0,0-.07.09.21.21,0,0,0,0,.11.31.31,0,0,0,0,.1l1.4,1.4L8.92,8.63,6.5,6.21,8,4.74a.19.19,0,0,0,0-.1.14.14,0,0,0,0-.11A.15.15,0,0,0,8,4.44a.21.21,0,0,0-.11,0L3.42,4.21l-.08,0-.06,0a.18.18,0,0,0,0,.07.19.19,0,0,0,0,.08l.19,4.42a.15.15,0,0,0,0,.11A.18.18,0,0,0,3.53,9a.25.25,0,0,0,.12,0A.18.18,0,0,0,3.74,9L5.21,7.51l2.55,2.56v4.49a.29.29,0,0,0,0,.09l0,.07.08,0,.09,0H9.85l.09,0a.18.18,0,0,0,.07,0l.05-.07a.29.29,0,0,0,0-.09V10.07l2.63-2.63L14.26,9a.16.16,0,0,0,.09,0,.17.17,0,0,0,.12,0A.18.18,0,0,0,14.55,9a.13.13,0,0,0,0-.1l.19-4.43a.19.19,0,0,0,0-.08.18.18,0,0,0,0-.07l-.07,0Z"></path>\n    </g>\n  </g>`,Kt=`<g id="best">\n    <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${Wt.ClassNames.Background}" fill="#96bc4b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <path class="${Wt.ClassNames.ComponentShadow}" opacity="0.2" d="M9,3.43a.5.5,0,0,0-.27.08.46.46,0,0,0-.17.22L7.24,7.17l-3.68.19a.52.52,0,0,0-.26.1.53.53,0,0,0-.16.23.45.45,0,0,0,0,.28.44.44,0,0,0,.15.23l2.86,2.32-1,3.56a.45.45,0,0,0,0,.28.46.46,0,0,0,.17.22.41.41,0,0,0,.26.09.43.43,0,0,0,.27-.08l3.09-2,3.09,2a.46.46,0,0,0,.53,0,.46.46,0,0,0,.17-.22.53.53,0,0,0,0-.28l-1-3.56L14.71,8.2A.44.44,0,0,0,14.86,8a.45.45,0,0,0,0-.28.53.53,0,0,0-.16-.23.52.52,0,0,0-.26-.1l-3.68-.2L9.44,3.73a.46.46,0,0,0-.17-.22A.5.5,0,0,0,9,3.43Z"></path>\n    <path class="${Wt.ClassNames.Component}" fill="#fff" d="M9,2.93A.5.5,0,0,0,8.73,3a.46.46,0,0,0-.17.22L7.24,6.67l-3.68.19A.52.52,0,0,0,3.3,7a.53.53,0,0,0-.16.23.45.45,0,0,0,0,.28.44.44,0,0,0,.15.23L6.15,10l-1,3.56a.45.45,0,0,0,0,.28.46.46,0,0,0,.17.22.41.41,0,0,0,.26.09.43.43,0,0,0,.27-.08l3.09-2,3.09,2a.46.46,0,0,0,.53,0,.46.46,0,0,0,.17-.22.53.53,0,0,0,0-.28l-1-3.56L14.71,7.7a.44.44,0,0,0,.15-.23.45.45,0,0,0,0-.28A.53.53,0,0,0,14.7,7a.52.52,0,0,0-.26-.1l-3.68-.2L9.44,3.23A.46.46,0,0,0,9.27,3,.5.5,0,0,0,9,2.93Z"></path>\n  </g>`,Zt=`<g id="blunder">\n    <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${Wt.ClassNames.Background}" fill="#ca3431" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M14.74,5.45A2.58,2.58,0,0,0,14,4.54,3.76,3.76,0,0,0,12.89,4a4.07,4.07,0,0,0-1.2-.19A3.92,3.92,0,0,0,10.51,4a5.87,5.87,0,0,0-.9.37,3,3,0,0,0-.32.2,3.46,3.46,0,0,1,.42.63,3.29,3.29,0,0,1,.36,1.47.31.31,0,0,0,.19-.06l.11-.08a2.9,2.9,0,0,1,.29-.19,3.89,3.89,0,0,1,.41-.17,1.55,1.55,0,0,1,.48-.07,1.1,1.1,0,0,1,.72.24.72.72,0,0,1,.23.26.8.8,0,0,1,.07.34,1,1,0,0,1-.25.67,7.71,7.71,0,0,1-.65.63,6.2,6.2,0,0,0-.48.43,2.93,2.93,0,0,0-.45.54,2.55,2.55,0,0,0-.33.66,2.62,2.62,0,0,0-.13.83V11a.24.24,0,0,0,0,.12.35.35,0,0,0,.17.17l.12,0h1.71l.12,0a.23.23,0,0,0,.1-.07.21.21,0,0,0,.06-.1.27.27,0,0,0,0-.12V10.8a1,1,0,0,1,.26-.7q.27-.28.66-.63A5.79,5.79,0,0,0,14.05,9a4.51,4.51,0,0,0,.48-.6,2.56,2.56,0,0,0,.36-.72,2.81,2.81,0,0,0,.14-1A2.66,2.66,0,0,0,14.74,5.45Z"></path>\n      <path d="M12.38,12.65H10.5l-.12,0a.34.34,0,0,0-.18.29v1.82a.36.36,0,0,0,.08.23.23.23,0,0,0,.1.07l.12,0h1.88a.24.24,0,0,0,.12,0,.26.26,0,0,0,.11-.07.36.36,0,0,0,.07-.1.28.28,0,0,0,0-.13V13a.27.27,0,0,0,0-.12.61.61,0,0,0-.07-.1A.32.32,0,0,0,12.38,12.65Z"></path>\n      <path d="M6.79,12.65H4.91l-.12,0a.34.34,0,0,0-.18.29v1.82a.36.36,0,0,0,.08.23.23.23,0,0,0,.1.07l.12,0H6.79a.24.24,0,0,0,.12,0A.26.26,0,0,0,7,15a.36.36,0,0,0,.07-.1.28.28,0,0,0,0-.13V13a.27.27,0,0,0,0-.12.61.61,0,0,0-.07-.1A.32.32,0,0,0,6.79,12.65Z"></path>\n      <path d="M8.39,4.54A3.76,3.76,0,0,0,7.3,4a4.07,4.07,0,0,0-1.2-.19A3.92,3.92,0,0,0,4.92,4a5.87,5.87,0,0,0-.9.37,3.37,3.37,0,0,0-.55.38l-.21.19a.32.32,0,0,0,0,.41l1,1.2a.26.26,0,0,0,.2.12.48.48,0,0,0,.24-.06l.11-.08a2.9,2.9,0,0,1,.29-.19l.4-.17A1.66,1.66,0,0,1,6,6.06a1.1,1.1,0,0,1,.72.24.72.72,0,0,1,.23.26A.77.77,0,0,1,7,6.9a1,1,0,0,1-.26.67,7.6,7.6,0,0,1-.64.63,6.28,6.28,0,0,0-.49.43,2.93,2.93,0,0,0-.45.54,2.72,2.72,0,0,0-.33.66,2.62,2.62,0,0,0-.13.83V11a.43.43,0,0,0,0,.12.39.39,0,0,0,.08.1.18.18,0,0,0,.1.07.21.21,0,0,0,.12,0H6.72l.12,0a.23.23,0,0,0,.1-.07.36.36,0,0,0,.07-.1A.5.5,0,0,0,7,11V10.8a1,1,0,0,1,.27-.7A8,8,0,0,1,8,9.47c.18-.15.35-.31.52-.48A7,7,0,0,0,9,8.39a3.23,3.23,0,0,0,.36-.72,3.07,3.07,0,0,0,.13-1,2.66,2.66,0,0,0-.29-1.27A2.58,2.58,0,0,0,8.39,4.54Z"></path>\n    </g>\n    <g>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M14.74,5A2.58,2.58,0,0,0,14,4a3.76,3.76,0,0,0-1.09-.56,4.07,4.07,0,0,0-1.2-.19,3.92,3.92,0,0,0-1.18.17,5.87,5.87,0,0,0-.9.37,3,3,0,0,0-.32.2,3.46,3.46,0,0,1,.42.63,3.29,3.29,0,0,1,.36,1.47.31.31,0,0,0,.19-.06L10.37,6a2.9,2.9,0,0,1,.29-.19,3.89,3.89,0,0,1,.41-.17,1.55,1.55,0,0,1,.48-.07,1.1,1.1,0,0,1,.72.24.72.72,0,0,1,.23.26.8.8,0,0,1,.07.34,1,1,0,0,1-.25.67,7.71,7.71,0,0,1-.65.63,6.2,6.2,0,0,0-.48.43,2.93,2.93,0,0,0-.45.54,2.55,2.55,0,0,0-.33.66,2.62,2.62,0,0,0-.13.83v.35a.24.24,0,0,0,0,.12.35.35,0,0,0,.17.17l.12,0h1.71l.12,0a.23.23,0,0,0,.1-.07.21.21,0,0,0,.06-.1.27.27,0,0,0,0-.12V10.3a1,1,0,0,1,.26-.7q.27-.28.66-.63a5.79,5.79,0,0,0,.51-.48,4.51,4.51,0,0,0,.48-.6,2.56,2.56,0,0,0,.36-.72,2.81,2.81,0,0,0,.14-1A2.66,2.66,0,0,0,14.74,5Z"></path>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M12.38,12.15H10.5l-.12,0a.34.34,0,0,0-.18.29v1.82a.36.36,0,0,0,.08.23.23.23,0,0,0,.1.07l.12,0h1.88a.24.24,0,0,0,.12,0,.26.26,0,0,0,.11-.07.36.36,0,0,0,.07-.1.28.28,0,0,0,0-.13V12.46a.27.27,0,0,0,0-.12.61.61,0,0,0-.07-.1A.32.32,0,0,0,12.38,12.15Z"></path>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M6.79,12.15H4.91l-.12,0a.34.34,0,0,0-.18.29v1.82a.36.36,0,0,0,.08.23.23.23,0,0,0,.1.07l.12,0H6.79a.24.24,0,0,0,.12,0A.26.26,0,0,0,7,14.51a.36.36,0,0,0,.07-.1.28.28,0,0,0,0-.13V12.46a.27.27,0,0,0,0-.12.61.61,0,0,0-.07-.1A.32.32,0,0,0,6.79,12.15Z"></path>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M8.39,4A3.76,3.76,0,0,0,7.3,3.48a4.07,4.07,0,0,0-1.2-.19,3.92,3.92,0,0,0-1.18.17,5.87,5.87,0,0,0-.9.37,3.37,3.37,0,0,0-.55.38l-.21.19a.32.32,0,0,0,0,.41l1,1.2a.26.26,0,0,0,.2.12.48.48,0,0,0,.24-.06L4.78,6a2.9,2.9,0,0,1,.29-.19l.4-.17A1.66,1.66,0,0,1,6,5.56a1.1,1.1,0,0,1,.72.24.72.72,0,0,1,.23.26A.77.77,0,0,1,7,6.4a1,1,0,0,1-.26.67,7.6,7.6,0,0,1-.64.63,6.28,6.28,0,0,0-.49.43,2.93,2.93,0,0,0-.45.54,2.72,2.72,0,0,0-.33.66,2.62,2.62,0,0,0-.13.83v.35a.43.43,0,0,0,0,.12.39.39,0,0,0,.08.1.18.18,0,0,0,.1.07.21.21,0,0,0,.12,0H6.72l.12,0a.23.23,0,0,0,.1-.07.36.36,0,0,0,.07-.1.5.5,0,0,0,0-.12V10.3a1,1,0,0,1,.27-.7A8,8,0,0,1,8,9c.18-.15.35-.31.52-.48A7,7,0,0,0,9,7.89a3.23,3.23,0,0,0,.36-.72,3.07,3.07,0,0,0,.13-1A2.66,2.66,0,0,0,9.15,5,2.58,2.58,0,0,0,8.39,4Z"></path>\n    </g>\n  </g>`,Qt=`<g id="book">\n    <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${Wt.ClassNames.Background}" fill="#a88865" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g>\n      <path class="${Wt.ClassNames.ComponentShadow}" opacity="0.3" isolation="isolate" d="M8.45,5.9c-1-.75-2.51-1.09-4.83-1.09H2.54v8.71H3.62a8.16,8.16,0,0,1,4.83,1.17Z"></path>\n      <path class="${Wt.ClassNames.ComponentShadow}" opacity="0.3" isolation="isolate" d="M9.54,14.69a8.14,8.14,0,0,1,4.84-1.17h1.08V4.81H14.38c-2.31,0-3.81.34-4.84,1.09Z"></path>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M8.45,5.4c-1-.75-2.51-1.09-4.83-1.09H3V13h.58a8.09,8.09,0,0,1,4.83,1.17Z"></path>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M9.54,14.19A8.14,8.14,0,0,1,14.38,13H15V4.31h-.58c-2.31,0-3.81.34-4.84,1.09Z"></path>\n    </g>\n  </g>`,Xt=`<g id="Brilliant">\n    <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${Wt.ClassNames.Background}" fill="#1bada6" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M12.57,14.6a.51.51,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0h-2l-.13,0L10,14.84A.41.41,0,0,1,10,14.6V12.7a.32.32,0,0,1,.09-.23.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13Zm-.12-3.93a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H10.35a.31.31,0,0,1-.34-.31L9.86,3.9A.36.36,0,0,1,10,3.66a.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0H12.3a.32.32,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>\n      <path d="M8.07,14.6a.51.51,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0h-2l-.13,0-.11-.08a.41.41,0,0,1-.08-.24V12.7a.27.27,0,0,1,0-.13.36.36,0,0,1,.07-.1.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13ZM8,10.67a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H5.85a.31.31,0,0,1-.34-.31L5.36,3.9a.36.36,0,0,1,.09-.24.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0H7.8a.35.35,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>\n    </g>\n    <g>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M12.57,14.1a.51.51,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0h-2l-.13,0L10,14.34A.41.41,0,0,1,10,14.1V12.2A.32.32,0,0,1,10,12a.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13Zm-.12-3.93a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H10.35a.31.31,0,0,1-.34-.31L9.86,3.4A.36.36,0,0,1,10,3.16a.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0H12.3a.32.32,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M8.07,14.1a.51.51,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0h-2l-.13,0-.11-.08a.41.41,0,0,1-.08-.24V12.2a.27.27,0,0,1,0-.13.36.36,0,0,1,.07-.1.39.39,0,0,1,.1-.08l.13,0h2A.31.31,0,0,1,8,12a.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13ZM8,10.17a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H5.85a.31.31,0,0,1-.34-.31L5.36,3.4a.36.36,0,0,1,.09-.24.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0H7.8a.35.35,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>\n    </g>\n  </g>`,Yt=`<g id="checkmate_black">\n    <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${Wt.ClassNames.Background}" fill="#312e2b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <path d="M11.44,8.41h1.74l.1-1.55H11.54l.18-2.78H10.17L10,6.86H8.31l.18-2.78H6.94L6.76,6.86H5l-.1,1.55H6.66l-.11,1.68H4.82l-.1,1.55H6.46l-.18,2.78H7.83L8,11.64H9.69l-.18,2.78h1.55l.18-2.78H13l.1-1.55H11.34ZM8.11,10.09l.1-1.68H9.89l-.1,1.68Z"></path>\n    <path class="${Wt.ClassNames.ComponentShadow}" fill="#fff" d="M11.44,7.91h1.74l.1-1.55H11.54l.18-2.78H10.17L10,6.36H8.31l.18-2.78H6.94L6.76,6.36H5l-.1,1.55H6.66L6.55,9.59H4.82l-.1,1.55H6.46l-.18,2.78H7.83L8,11.14H9.69l-.18,2.78h1.55l.18-2.78H13l.1-1.55H11.34ZM8.11,9.59l.1-1.68H9.89l-.1,1.68Z"></path>\n  </g>`,Jt=`<g id="checkmate_white">\n    <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <circle class="${Wt.ClassNames.Background}" fill="#f8f8f8" cx="9" cy="9" r="8.5"></circle>\n    <path class="${Wt.ClassNames.ComponentShadow}" fill="#e8e8e8" d="M9,1A8,8,0,1,1,1,9,8,8,0,0,1,9,1M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <path d="M11.44,8.11h1.74l.1-1.55H11.54l.18-2.78H10.17L10,6.56H8.31l.18-2.78H6.94L6.76,6.56H5l-.1,1.55H6.66L6.55,9.79H4.82l-.1,1.55H6.46l-.18,2.78H7.83L8,11.34H9.69l-.18,2.78h1.55l.18-2.78H13l.1-1.55H11.34ZM8.11,9.79l.1-1.68H9.89l-.1,1.68Z"></path>\n  </g>`,en=`<g id="correct">\n    <g>\n      <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <path class="${Wt.ClassNames.Background}" fill="#96bc4b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    </g>\n    <g>\n      <path class="${Wt.ClassNames.ComponentShadow}" opacity="0.2" d="M15.11,6.81,9.45,12.47,7.79,14.13a.39.39,0,0,1-.28.11.39.39,0,0,1-.27-.11L2.89,9.78a.39.39,0,0,1-.11-.28.39.39,0,0,1,.11-.27L4.28,7.85a.34.34,0,0,1,.12-.09l.15,0a.37.37,0,0,1,.15,0,.38.38,0,0,1,.13.09l2.69,2.68,5.65-5.65a.38.38,0,0,1,.13-.09.37.37,0,0,1,.15,0,.4.4,0,0,1,.15,0,.34.34,0,0,1,.12.09l1.39,1.38a.41.41,0,0,1,.08.13.33.33,0,0,1,0,.15.4.4,0,0,1,0,.15A.5.5,0,0,1,15.11,6.81Z"></path>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M15.11,6.31,9.45,12,7.79,13.63a.39.39,0,0,1-.28.11.39.39,0,0,1-.27-.11L2.89,9.28A.39.39,0,0,1,2.78,9a.39.39,0,0,1,.11-.27L4.28,7.35a.34.34,0,0,1,.12-.09l.15,0a.37.37,0,0,1,.15,0,.38.38,0,0,1,.13.09L7.52,10l5.65-5.65a.38.38,0,0,1,.13-.09.37.37,0,0,1,.15,0,.4.4,0,0,1,.15,0,.34.34,0,0,1,.12.09l1.39,1.38a.41.41,0,0,1,.08.13.33.33,0,0,1,0,.15.4.4,0,0,1,0,.15A.5.5,0,0,1,15.11,6.31Z"></path>\n    </g>\n  </g>`,tn=`<g id="critical">\n    <g class="${Wt.ClassNames.Shadow}" opacity="0.3">\n      <path d="M17.68,5.2,11.06,16.67a2.37,2.37,0,0,1-4.11,0L.32,5.2A2.38,2.38,0,0,1,2.38,1.64H15.62A2.38,2.38,0,0,1,17.68,5.2Z"></path>\n    </g>\n    <path class="${Wt.ClassNames.Background}" fill="#ad5b8c" d="M17.68,4.7,11.06,16.17a2.37,2.37,0,0,1-4.11,0L.32,4.7A2.38,2.38,0,0,1,2.38,1.14H15.62A2.38,2.38,0,0,1,17.68,4.7Z"></path>\n    <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M8.67,3.22,5.9,9.92V10a.14.14,0,0,0,0,.06l0,0,0,0H8.4a.1.1,0,0,1,.09,0,.09.09,0,0,1,0,.08l0,5c0,.11.17.17.21.07L12.1,8V7.92a.14.14,0,0,0,0-.06.09.09,0,0,0-.05,0l-.06,0H9.32a.11.11,0,0,1-.08,0,.12.12,0,0,1,0-.09l-.32-4.4C8.87,3.18,8.71,3.12,8.67,3.22Z"></path>\n    </g>\n    <path class="${Wt.ClassNames.Component}" fill="#fff" d="M8.67,2.72,5.9,9.42v.05a.14.14,0,0,0,0,.06l0,0,0,0H8.4a.1.1,0,0,1,.09,0,.09.09,0,0,1,0,.08l0,5c0,.11.17.17.21.07l3.4-7.24V7.42a.14.14,0,0,0,0-.06.09.09,0,0,0-.05,0l-.06,0H9.32a.11.11,0,0,1-.08,0,.12.12,0,0,1,0-.09l-.32-4.4C8.87,2.68,8.71,2.62,8.67,2.72Z"></path>\n  </g>`,nn=`<g id="draw_black">\n    <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${Wt.ClassNames.Background}" fill="#312e2b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <path d="M2.92,7V5.84c.81,0,1.75-.28,1.8-1.22H6.14v5.5H4.34V7Zm8.87-2.39L7,13.88H5l4.8-9.26ZM9.85,13.88c-.08-1.54,1.38-2.19,2.57-2.89.33-.17.78-.4.78-.78a.66.66,0,0,0-.68-.7c-.69,0-.94.58-.92,1.16H10a2.17,2.17,0,0,1,.64-1.79,2.74,2.74,0,0,1,1.91-.62C14.1,8.26,15,8.78,15,10c0,1.82-2.66,2.18-2.66,2.5h2.73v1.38Z"></path>\n    <path class="${Wt.ClassNames.ComponentShadow}" fill="#fff" d="M2.92,6.51V5.34c.81,0,1.75-.28,1.8-1.22H6.14v5.5H4.34V6.51Zm8.87-2.39L7,13.38H5l4.8-9.26ZM9.85,13.38c-.08-1.54,1.38-2.19,2.57-2.89.33-.17.78-.4.78-.78a.66.66,0,0,0-.68-.7c-.69,0-.94.58-.92,1.16H10a2.17,2.17,0,0,1,.64-1.79,2.74,2.74,0,0,1,1.91-.62C14.1,7.76,15,8.28,15,9.5c0,1.82-2.66,2.18-2.66,2.5h2.73v1.38Z"></path>\n  </g>`,rn=`<g id="draw_white">\n    <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <circle class="${Wt.ClassNames.Background}" fill="#f8f8f8" cx="9" cy="9" r="8.5"></circle>\n    <path class="${Wt.ClassNames.ComponentShadow}" fill="#e8e8e8" d="M9,1A8,8,0,1,1,1,9,8,8,0,0,1,9,1M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <path d="M2.92,6.61V5.44c.81,0,1.75-.28,1.8-1.22H6.14v5.5H4.34V6.61Zm8.87-2.39L7,13.48H5l4.8-9.26ZM9.85,13.48c-.08-1.54,1.38-2.19,2.57-2.89.33-.17.78-.4.78-.78a.66.66,0,0,0-.68-.7c-.69,0-.94.58-.92,1.16H10a2.17,2.17,0,0,1,.64-1.79,2.74,2.74,0,0,1,1.91-.62C14.1,7.86,15,8.38,15,9.6c0,1.82-2.66,2.18-2.66,2.5h2.73v1.38Z"></path>\n  </g>`,an=`<g id="excellent">\n    <g>\n      <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <path class="${Wt.ClassNames.Background}" fill="#96bc4b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    </g>\n    <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M13.79,11.34c0-.2.4-.53.4-.94S14,9.72,14,9.58a2.06,2.06,0,0,0,.18-.83,1,1,0,0,0-.3-.69,1.13,1.13,0,0,0-.55-.2,10.29,10.29,0,0,1-2.07,0c-.37-.23,0-1.18.18-1.7S11.9,4,10.62,3.7c-.69-.17-.66.37-.78.9-.05.21-.09.43-.13.57A5,5,0,0,1,7.05,8.23a1.57,1.57,0,0,1-.42.18v4.94A7.23,7.23,0,0,1,8,13.53c.52.12.91.25,1.44.33A11.11,11.11,0,0,0,11,14a6.65,6.65,0,0,0,1.18,0,1.09,1.09,0,0,0,1-.59.66.66,0,0,0,.06-.2,1.63,1.63,0,0,1,.07-.3c.13-.28.37-.3.5-.68S13.74,11.53,13.79,11.34Z"></path>\n      <path d="M5.49,8.09H4.31a.5.5,0,0,0-.5.5v4.56a.5.5,0,0,0,.5.5H5.49a.5.5,0,0,0,.5-.5V8.59A.5.5,0,0,0,5.49,8.09Z"></path>\n    </g>\n    <g>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M13.79,10.84c0-.2.4-.53.4-.94S14,9.22,14,9.08a2.06,2.06,0,0,0,.18-.83,1,1,0,0,0-.3-.69,1.13,1.13,0,0,0-.55-.2,10.29,10.29,0,0,1-2.07,0c-.37-.23,0-1.18.18-1.7s.51-2.12-.77-2.43c-.69-.17-.66.37-.78.9-.05.21-.09.43-.13.57A5,5,0,0,1,7.05,7.73a1.57,1.57,0,0,1-.42.18v4.94A7.23,7.23,0,0,1,8,13c.52.12.91.25,1.44.33a11.11,11.11,0,0,0,1.62.16,6.65,6.65,0,0,0,1.18,0,1.09,1.09,0,0,0,1-.59.66.66,0,0,0,.06-.2,1.63,1.63,0,0,1,.07-.3c.13-.28.37-.3.5-.68S13.74,11,13.79,10.84Z"></path>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M5.49,7.59H4.31a.5.5,0,0,0-.5.5v4.56a.5.5,0,0,0,.5.5H5.49a.5.5,0,0,0,.5-.5V8.09A.5.5,0,0,0,5.49,7.59Z"></path>\n    </g>\n  </g>`,sn=`<g id="fast_win">\n    <g>\n      <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <path class="${Wt.ClassNames.Background}" fill="#96af8b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    </g>\n    <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M4.85,4.7,9.67,9.19a.18.18,0,0,1,.05.07.21.21,0,0,1,0,.18l-.05.07L4.85,14a.24.24,0,0,1-.11.06.3.3,0,0,1-.13,0A.23.23,0,0,1,4.52,14a.28.28,0,0,1,0-.12v-9a.28.28,0,0,1,0-.12.23.23,0,0,1,.09-.08.3.3,0,0,1,.13,0A.24.24,0,0,1,4.85,4.7Z"></path>\n      <path d="M10,4.7l4.82,4.49a.18.18,0,0,1,.05.07.21.21,0,0,1,0,.18l-.05.07L10,14a.24.24,0,0,1-.11.06.27.27,0,0,1-.13,0A.18.18,0,0,1,9.7,14a.19.19,0,0,1,0-.12v-9a.19.19,0,0,1,0-.12.18.18,0,0,1,.09-.08.27.27,0,0,1,.13,0A.24.24,0,0,1,10,4.7Z"></path>\n    </g>\n    <g>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M4.85,4.2,9.67,8.69a.18.18,0,0,1,.05.07.21.21,0,0,1,0,.18L9.67,9,4.85,13.5a.24.24,0,0,1-.11.06.3.3,0,0,1-.13,0,.23.23,0,0,1-.09-.08.28.28,0,0,1,0-.12v-9a.28.28,0,0,1,0-.12.23.23,0,0,1,.09-.08.3.3,0,0,1,.13,0A.24.24,0,0,1,4.85,4.2Z"></path>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M10,4.2l4.82,4.49a.18.18,0,0,1,.05.07.21.21,0,0,1,0,.18L14.85,9,10,13.5a.24.24,0,0,1-.11.06.27.27,0,0,1-.13,0,.18.18,0,0,1-.09-.08.19.19,0,0,1,0-.12v-9a.19.19,0,0,1,0-.12.18.18,0,0,1,.09-.08.27.27,0,0,1,.13,0A.24.24,0,0,1,10,4.2Z"></path>\n    </g>\n  </g>`,cn=`<g id="free_piece">\n    <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${Wt.ClassNames.Background}" fill="#ec6250" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M9.76,9.66h3.89v4.19a.68.68,0,0,1-.68.68H9.76Z"></path>\n      <path d="M4.35,9.66H8.24v4.87H5a.58.58,0,0,1-.26-.06.6.6,0,0,1-.36-.36.58.58,0,0,1,0-.26V9.66Z"></path>\n      <path d="M13.39,7H10.13l2-1a.78.78,0,0,0,.29-.25.78.78,0,0,0,.13-.36A.82.82,0,0,0,12.53,5a.87.87,0,0,0-.23-.31l-1.15-1a.76.76,0,0,0-.34-.16.74.74,0,0,0-.39,0,.94.94,0,0,0-.33.2.84.84,0,0,0-.19.33L9.08,7H9l-.83-2.9A.73.73,0,0,0,8,3.81a.79.79,0,0,0-.33-.2.7.7,0,0,0-.38,0,.75.75,0,0,0-.35.16l-1.14,1A.87.87,0,0,0,5.54,5a.71.71,0,0,0,0,.38.78.78,0,0,0,.13.36A.71.71,0,0,0,5.91,6l2,1H4.61a.46.46,0,0,0-.49.44v.87a.47.47,0,0,0,.49.45h8.78a.47.47,0,0,0,.49-.45V7.48A.47.47,0,0,0,13.39,7Z"></path>\n    </g>\n    <g>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M9.76,14H13a.71.71,0,0,0,.48-.19.72.72,0,0,0,.2-.48V9.16H9.76Z"></path>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M4.36,13.35a.58.58,0,0,0,0,.26.6.6,0,0,0,.36.36A.58.58,0,0,0,5,14H8.24V9.16H4.36Z"></path>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M13.39,6.54H10.13l2-1a.78.78,0,0,0,.29-.25.78.78,0,0,0,.13-.36.82.82,0,0,0-.05-.38.87.87,0,0,0-.23-.31l-1.15-1a.76.76,0,0,0-.34-.16.74.74,0,0,0-.39,0,.94.94,0,0,0-.33.2.84.84,0,0,0-.19.33l-.82,2.9H9l-.83-2.9A.73.73,0,0,0,8,3.31a.79.79,0,0,0-.33-.2.7.7,0,0,0-.38,0,.75.75,0,0,0-.35.16l-1.14,1a.87.87,0,0,0-.23.31.71.71,0,0,0,0,.38.78.78,0,0,0,.13.36.71.71,0,0,0,.29.25l2,1H4.61A.46.46,0,0,0,4.12,7v.87a.47.47,0,0,0,.49.45h8.78a.47.47,0,0,0,.49-.45V7A.47.47,0,0,0,13.39,6.54Z"></path>\n    </g>\n  </g>`,ln=`<path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n<path class="${Wt.ClassNames.Background}" fill="#7979a1" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n<g class="${Wt.ClassNames.ComponentShadow}" opacity="0.1">\n    <polygon points="11.29 11.34 11.29 8.56 7.79 11.3 7.79 11.34 5.39 11.34 9.54 16.5 13.73 11.34 11.29 11.34"></polygon>\n    <polygon points="7.83 7.51 7.83 10.32 11.33 7.58 11.33 7.5 13.73 7.5 9.58 2.35 5.39 7.51 7.83 7.51"></polygon>\n  </g>\n<g>\n    <polygon class="${Wt.ClassNames.Component}" fill="#fff" points="10.9 10.92 10.9 8.13 7.4 10.87 7.4 10.92 5 10.92 9.15 16.07 13.34 10.92 10.9 10.92"></polygon>\n    <polygon class="${Wt.ClassNames.Component}" fill="#fff" points="7.44 7.08 7.44 9.9 10.94 7.16 10.94 7.08 13.34 7.08 9.19 1.93 5 7.08 7.44 7.08"></polygon>\n  </g>`,un=`<g id="great_find">\n    <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${Wt.ClassNames.Background}" fill="#5c8bb0" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g>\n      <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.2">\n        <path d="M10.32,14.6a.27.27,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0H8l-.13,0-.11-.08a.41.41,0,0,1-.08-.24V12.7a.27.27,0,0,1,0-.13.36.36,0,0,1,.07-.1.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13Zm-.12-3.93a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H8.1a.31.31,0,0,1-.34-.31L7.61,3.9a.36.36,0,0,1,.09-.24.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0h2.11a.32.32,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>\n      </g>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M10.32,14.1a.27.27,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0H8l-.13,0-.11-.08a.41.41,0,0,1-.08-.24V12.2a.27.27,0,0,1,0-.13.36.36,0,0,1,.07-.1.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13Zm-.12-3.93a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H8.1a.31.31,0,0,1-.34-.31L7.61,3.4a.36.36,0,0,1,.09-.24.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0h2.11a.32.32,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>\n    </g>\n  </g>`,dn=`<g id="forced">\n    <g id="fast_win">\n      <g>\n        <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n        <path class="${Wt.ClassNames.Background}" fill="#96af8b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n      </g>\n    </g>\n    <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M14.39,9.07,9,4.31a.31.31,0,0,0-.3,0,.32.32,0,0,0-.13.1.29.29,0,0,0,0,.16V7.42H3.9a.58.58,0,0,0-.19,0,.5.5,0,0,0-.17.11.91.91,0,0,0-.11.16.63.63,0,0,0,0,.19v3.41a.58.58,0,0,0,0,.19.64.64,0,0,0,.11.16.39.39,0,0,0,.17.11.41.41,0,0,0,.19,0H8.5v2.74a.26.26,0,0,0,.16.26.3.3,0,0,0,.16,0A.34.34,0,0,0,9,14.79L14.39,10a.69.69,0,0,0,.16-.22.7.7,0,0,0,0-.52A.69.69,0,0,0,14.39,9.07Z"></path>\n    </g>\n    <path class="${Wt.ClassNames.Component}" fill="#fff" d="M14.39,8.57,9,3.81a.31.31,0,0,0-.3,0,.32.32,0,0,0-.13.1A.29.29,0,0,0,8.5,4V6.92H3.9a.58.58,0,0,0-.19,0,.5.5,0,0,0-.17.11.91.91,0,0,0-.11.16.63.63,0,0,0,0,.19v3.41a.58.58,0,0,0,0,.19.64.64,0,0,0,.11.16.39.39,0,0,0,.17.11.41.41,0,0,0,.19,0H8.5v2.74a.26.26,0,0,0,.16.26.3.3,0,0,0,.16,0A.34.34,0,0,0,9,14.29l5.42-4.76a.69.69,0,0,0,.16-.22.7.7,0,0,0,0-.52A.69.69,0,0,0,14.39,8.57Z"></path>\n  </g>`,fn=`<g id="good">\n    <g>\n      <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <path class="${Wt.ClassNames.Background}" fill="#96af8b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    </g>\n    <g>\n      <path class="${Wt.ClassNames.ComponentShadow}" opacity="0.2" d="M15.11,6.81,9.45,12.47,7.79,14.13a.39.39,0,0,1-.28.11.39.39,0,0,1-.27-.11L2.89,9.78a.39.39,0,0,1-.11-.28.39.39,0,0,1,.11-.27L4.28,7.85a.34.34,0,0,1,.12-.09l.15,0a.37.37,0,0,1,.15,0,.38.38,0,0,1,.13.09l2.69,2.68,5.65-5.65a.38.38,0,0,1,.13-.09.37.37,0,0,1,.15,0,.4.4,0,0,1,.15,0,.34.34,0,0,1,.12.09l1.39,1.38a.41.41,0,0,1,.08.13.33.33,0,0,1,0,.15.4.4,0,0,1,0,.15A.5.5,0,0,1,15.11,6.81Z"></path>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M15.11,6.31,9.45,12,7.79,13.63a.39.39,0,0,1-.28.11.39.39,0,0,1-.27-.11L2.89,9.28A.39.39,0,0,1,2.78,9a.39.39,0,0,1,.11-.27L4.28,7.35a.34.34,0,0,1,.12-.09l.15,0a.37.37,0,0,1,.15,0,.38.38,0,0,1,.13.09L7.52,10l5.65-5.65a.38.38,0,0,1,.13-.09.37.37,0,0,1,.15,0,.4.4,0,0,1,.15,0,.34.34,0,0,1,.12.09l1.39,1.38a.41.41,0,0,1,.08.13.33.33,0,0,1,0,.15.4.4,0,0,1,0,.15A.5.5,0,0,1,15.11,6.31Z"></path>\n    </g>\n  </g>`,pn=`<g id="inaccuracy">\n    <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${Wt.ClassNames.Background}" fill="#f7c045" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M13.66,14.8a.28.28,0,0,1,0,.13.23.23,0,0,1-.08.11.28.28,0,0,1-.11.08l-.12,0h-2l-.13,0a.27.27,0,0,1-.1-.08A.36.36,0,0,1,11,14.8V12.9a.59.59,0,0,1,0-.13.36.36,0,0,1,.07-.1l.1-.08.13,0h2a.33.33,0,0,1,.23.1.39.39,0,0,1,.08.1.28.28,0,0,1,0,.13Zm-.12-3.93a.31.31,0,0,1,0,.13.3.3,0,0,1-.07.1.3.3,0,0,1-.23.08H11.43a.31.31,0,0,1-.34-.31L10.94,4.1A.5.5,0,0,1,11,3.86l.11-.08.13,0h2.11a.35.35,0,0,1,.26.1.41.41,0,0,1,.08.24Z"></path>\n      <path d="M7.65,14.82a.27.27,0,0,1,0,.12.26.26,0,0,1-.07.11l-.1.07-.13,0H5.43a.25.25,0,0,1-.12,0,.27.27,0,0,1-.1-.08.31.31,0,0,1-.09-.22V13a.36.36,0,0,1,.09-.23l.1-.07.12,0H7.32a.32.32,0,0,1,.23.09.3.3,0,0,1,.07.1.28.28,0,0,1,0,.13Zm2.2-7.17a3.1,3.1,0,0,1-.36.73A5.58,5.58,0,0,1,9,9a4.85,4.85,0,0,1-.52.49,8,8,0,0,0-.65.63,1,1,0,0,0-.27.7V11a.21.21,0,0,1,0,.12.17.17,0,0,1-.06.1.23.23,0,0,1-.1.07l-.12,0H5.53a.21.21,0,0,1-.12,0,.18.18,0,0,1-.1-.07.2.2,0,0,1-.08-.1.37.37,0,0,1,0-.12v-.35a2.68,2.68,0,0,1,.13-.84,2.91,2.91,0,0,1,.33-.66,3.38,3.38,0,0,1,.45-.55c.16-.15.33-.29.49-.42a7.84,7.84,0,0,0,.65-.64,1,1,0,0,0,.25-.67.77.77,0,0,0-.07-.34.67.67,0,0,0-.23-.27A1.16,1.16,0,0,0,6.49,6,1.61,1.61,0,0,0,6,6.11a3,3,0,0,0-.41.18,1.75,1.75,0,0,0-.29.18l-.11.09A.5.5,0,0,1,5,6.62a.31.31,0,0,1-.21-.13l-1-1.21a.3.3,0,0,1,0-.4A1.36,1.36,0,0,1,4,4.68a3.07,3.07,0,0,1,.56-.38,5.49,5.49,0,0,1,.9-.37,3.69,3.69,0,0,1,1.19-.17,3.92,3.92,0,0,1,2.3.75,2.85,2.85,0,0,1,.77.92A2.82,2.82,0,0,1,10,6.71,3,3,0,0,1,9.85,7.65Z"></path>\n    </g>\n    <g>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M13.66,14.3a.28.28,0,0,1,0,.13.23.23,0,0,1-.08.11.28.28,0,0,1-.11.08l-.12,0h-2l-.13,0a.27.27,0,0,1-.1-.08A.36.36,0,0,1,11,14.3V12.4a.59.59,0,0,1,0-.13.36.36,0,0,1,.07-.1l.1-.08.13,0h2a.33.33,0,0,1,.23.1.39.39,0,0,1,.08.1.28.28,0,0,1,0,.13Zm-.12-3.93a.31.31,0,0,1,0,.13.3.3,0,0,1-.07.1.3.3,0,0,1-.23.08H11.43a.31.31,0,0,1-.34-.31L10.94,3.6A.5.5,0,0,1,11,3.36l.11-.08.13,0h2.11a.35.35,0,0,1,.26.1.41.41,0,0,1,.08.24Z"></path>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M7.65,14.32a.27.27,0,0,1,0,.12.26.26,0,0,1-.07.11l-.1.07-.13,0H5.43a.25.25,0,0,1-.12,0,.27.27,0,0,1-.1-.08.31.31,0,0,1-.09-.22V12.49a.36.36,0,0,1,.09-.23l.1-.07.12,0H7.32a.32.32,0,0,1,.23.09.3.3,0,0,1,.07.1.28.28,0,0,1,0,.13Zm2.2-7.17a3.1,3.1,0,0,1-.36.73,5.58,5.58,0,0,1-.49.6A4.85,4.85,0,0,1,8.48,9a8,8,0,0,0-.65.63,1,1,0,0,0-.27.7v.22a.21.21,0,0,1,0,.12.17.17,0,0,1-.06.1.23.23,0,0,1-.1.07l-.12,0H5.53a.21.21,0,0,1-.12,0,.18.18,0,0,1-.1-.07.2.2,0,0,1-.08-.1.37.37,0,0,1,0-.12v-.35a2.68,2.68,0,0,1,.13-.84,2.91,2.91,0,0,1,.33-.66,3.38,3.38,0,0,1,.45-.55c.16-.15.33-.29.49-.42a7.84,7.84,0,0,0,.65-.64,1,1,0,0,0,.25-.67.77.77,0,0,0-.07-.34.67.67,0,0,0-.23-.27,1.16,1.16,0,0,0-.72-.24A1.61,1.61,0,0,0,6,5.61a3,3,0,0,0-.41.18A1.75,1.75,0,0,0,5.3,6l-.11.09A.5.5,0,0,1,5,6.12.31.31,0,0,1,4.74,6l-1-1.21a.3.3,0,0,1,0-.4A1.36,1.36,0,0,1,4,4.18a3.07,3.07,0,0,1,.56-.38,5.49,5.49,0,0,1,.9-.37,3.69,3.69,0,0,1,1.19-.17A3.92,3.92,0,0,1,8.93,4a2.85,2.85,0,0,1,.77.92A2.82,2.82,0,0,1,10,6.21,3,3,0,0,1,9.85,7.15Z"></path>\n    </g>\n  </g>`,hn=`<g id="incorrect">\n    <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${Wt.ClassNames.Background}" fill="#ca3431" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M14,12.51a.57.57,0,0,1,.08.13.39.39,0,0,1,0,.3.5.5,0,0,1-.08.12l-1.38,1.38a.5.5,0,0,1-.12.08l-.15,0-.15,0a.57.57,0,0,1-.13-.08L9,11.37,5.94,14.44a.57.57,0,0,1-.13.08l-.15,0-.15,0a.36.36,0,0,1-.12-.08L4,13.06a.39.39,0,0,1-.11-.27A.41.41,0,0,1,4,12.51L7.07,9.45,4,6.39a.43.43,0,0,1-.11-.28A.39.39,0,0,1,4,5.84L5.39,4.46a.39.39,0,0,1,.27-.11.43.43,0,0,1,.28.11L9,7.52l3.06-3.06a.41.41,0,0,1,.28-.11.39.39,0,0,1,.27.11L14,5.84a.36.36,0,0,1,.08.12.39.39,0,0,1,0,.3.57.57,0,0,1-.08.13L10.92,9.45Z"></path>\n    </g>\n    <path class="${Wt.ClassNames.Component}" fill="#f1f2f2" d="M14,12a.57.57,0,0,1,.08.13.39.39,0,0,1,0,.3.5.5,0,0,1-.08.12l-1.38,1.38a.5.5,0,0,1-.12.08l-.15,0-.15,0a.57.57,0,0,1-.13-.08L9,10.87,5.94,13.94a.57.57,0,0,1-.13.08l-.15,0-.15,0a.36.36,0,0,1-.12-.08L4,12.56a.39.39,0,0,1-.11-.27A.41.41,0,0,1,4,12L7.07,9,4,5.89a.43.43,0,0,1-.11-.28A.39.39,0,0,1,4,5.34L5.39,4a.39.39,0,0,1,.27-.11A.43.43,0,0,1,5.94,4L9,7,12.06,4a.41.41,0,0,1,.28-.11.39.39,0,0,1,.27.11L14,5.34a.36.36,0,0,1,.08.12.39.39,0,0,1,0,.3.57.57,0,0,1-.08.13L10.92,9Z"></path>\n  </g>`,mn=`<g id="mate">\n    <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${Wt.ClassNames.Background}" fill="#ec6250" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g>\n      <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.2">\n        <path d="M11.44,8.61h1.74l.1-1.55H11.54l.18-2.78H10.17L10,7.06H8.31l.18-2.78H6.94L6.76,7.06H5l-.1,1.55H6.66l-.11,1.68H4.82l-.1,1.55H6.46l-.18,2.78H7.83L8,11.84H9.69l-.18,2.78h1.55l.18-2.78H13l.1-1.55H11.34ZM8.11,10.29l.1-1.68H9.89l-.1,1.68Z"></path>\n      </g>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M11.44,8.11h1.74l.1-1.55H11.54l.18-2.78H10.17L10,6.56H8.31l.18-2.78H6.94L6.76,6.56H5l-.1,1.55H6.66L6.55,9.79H4.82l-.1,1.55H6.46l-.18,2.78H7.83L8,11.34H9.69l-.18,2.78h1.55l.18-2.78H13l.1-1.55H11.34ZM8.11,9.79l.1-1.68H9.89l-.1,1.68Z"></path>\n    </g>\n  </g>`,gn=`<g id="missed_win">\n    <g>\n      <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <path class="${Wt.ClassNames.Background}" fill="#dbac16" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    </g>\n    <g>\n      <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.2">\n        <rect x="2.74" y="8.1" width="12.51" height="3.11" rx="0.36"></rect>\n      </g>\n      <rect class="${Wt.ClassNames.Component}" fill="#fff" x="2.74" y="7.6" width="12.51" height="3.11" rx="0.36"></rect>\n    </g>\n  </g>`,vn=`<g id="mistake">\n    <g>\n      <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <path class="${Wt.ClassNames.Background}" fill="#e58f2a" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    </g>\n    <g>\n      <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.2">\n        <path d="M9.92,15a.27.27,0,0,1,0,.12.41.41,0,0,1-.07.11.32.32,0,0,1-.23.09H7.7a.25.25,0,0,1-.12,0,.27.27,0,0,1-.1-.08A.31.31,0,0,1,7.39,15V13.19A.32.32,0,0,1,7.48,13l.1-.07.12,0H9.59a.32.32,0,0,1,.23.09.61.61,0,0,1,.07.1.28.28,0,0,1,0,.13Zm2.2-7.17a3.1,3.1,0,0,1-.36.73,5.58,5.58,0,0,1-.49.6,6,6,0,0,1-.52.49,8,8,0,0,0-.65.63,1,1,0,0,0-.27.7v.22a.24.24,0,0,1,0,.12.17.17,0,0,1-.06.1.3.3,0,0,1-.1.07l-.12,0H7.79l-.12,0a.3.3,0,0,1-.1-.07.26.26,0,0,1-.07-.1.37.37,0,0,1,0-.12v-.35A2.42,2.42,0,0,1,7.61,10a2.55,2.55,0,0,1,.33-.66,3.38,3.38,0,0,1,.45-.55c.16-.15.33-.29.49-.42a7.73,7.73,0,0,0,.64-.64,1,1,0,0,0,.26-.67.77.77,0,0,0-.07-.34.75.75,0,0,0-.23-.27,1.16,1.16,0,0,0-.72-.24,1.61,1.61,0,0,0-.49.07,3,3,0,0,0-.41.18,1.41,1.41,0,0,0-.29.18l-.11.09a.5.5,0,0,1-.24.06A.31.31,0,0,1,7,6.69L6,5.48a.29.29,0,0,1,0-.4,1.36,1.36,0,0,1,.21-.2,3.07,3.07,0,0,1,.56-.38,5.38,5.38,0,0,1,.89-.37A3.75,3.75,0,0,1,8.9,4a4.07,4.07,0,0,1,1.2.19,4,4,0,0,1,1.09.56,2.76,2.76,0,0,1,.78.92,2.82,2.82,0,0,1,.28,1.28A3,3,0,0,1,12.12,7.85Z"></path>\n      </g>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M9.92,14.52a.27.27,0,0,1,0,.12.41.41,0,0,1-.07.11.32.32,0,0,1-.23.09H7.7a.25.25,0,0,1-.12,0,.27.27,0,0,1-.1-.08.31.31,0,0,1-.09-.22V12.69a.32.32,0,0,1,.09-.23l.1-.07.12,0H9.59a.32.32,0,0,1,.23.09.61.61,0,0,1,.07.1.28.28,0,0,1,0,.13Zm2.2-7.17a3.1,3.1,0,0,1-.36.73,5.58,5.58,0,0,1-.49.6,6,6,0,0,1-.52.49,8,8,0,0,0-.65.63,1,1,0,0,0-.27.7v.22a.24.24,0,0,1,0,.12.17.17,0,0,1-.06.1.3.3,0,0,1-.1.07l-.12,0H7.79l-.12,0a.3.3,0,0,1-.1-.07.26.26,0,0,1-.07-.1.37.37,0,0,1,0-.12v-.35a2.42,2.42,0,0,1,.13-.84,2.55,2.55,0,0,1,.33-.66,3.38,3.38,0,0,1,.45-.55c.16-.15.33-.29.49-.42a7.73,7.73,0,0,0,.64-.64,1,1,0,0,0,.26-.67.77.77,0,0,0-.07-.34A.75.75,0,0,0,9.48,6a1.16,1.16,0,0,0-.72-.24,1.61,1.61,0,0,0-.49.07A3,3,0,0,0,7.86,6a1.41,1.41,0,0,0-.29.18l-.11.09a.5.5,0,0,1-.24.06A.31.31,0,0,1,7,6.19L6,5a.29.29,0,0,1,0-.4,1.36,1.36,0,0,1,.21-.2A3.07,3.07,0,0,1,6.81,4a5.38,5.38,0,0,1,.89-.37,3.75,3.75,0,0,1,1.2-.17,4.07,4.07,0,0,1,1.2.19,4,4,0,0,1,1.09.56,2.76,2.76,0,0,1,.78.92,2.82,2.82,0,0,1,.28,1.28A3,3,0,0,1,12.12,7.35Z"></path>\n    </g>\n  </g>`,yn=`<g id="resign_black">\n    <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${Wt.ClassNames.Background}" fill="#312e2b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g>\n      <path d="M4.94,6.34H4.89a.63.63,0,0,0-.44.77l2.16,8.09a.63.63,0,0,0,.77.45l0,0a.62.62,0,0,0,.44-.76L5.7,6.78A.62.62,0,0,0,4.94,6.34Z"></path>\n      <path d="M12.33,4.48c-2,2.29-3.83-.41-6,1.52a.54.54,0,0,0-.15.25.48.48,0,0,0,0,.29c.22.89.87,3.3,1.12,4.15a.15.15,0,0,0,.26.07c1.92-2.65,4,.27,6.11-1.69a.46.46,0,0,0,.12-.44c-.21-.78-.8-3-1.1-4.05C12.62,4.44,12.42,4.36,12.33,4.48Z"></path>\n    </g>\n    <g>\n      <path class="${Wt.ClassNames.ComponentShadow}" fill="#fff" d="M4.94,5.74H4.89a.63.63,0,0,0-.44.77l2.16,8.09a.63.63,0,0,0,.77.45l0,0a.62.62,0,0,0,.44-.76L5.7,6.18A.62.62,0,0,0,4.94,5.74Z"></path>\n      <path class="${Wt.ClassNames.ComponentShadow}" fill="#fff" d="M12.33,3.88c-2,2.29-3.83-.41-6,1.52a.54.54,0,0,0-.15.25.48.48,0,0,0,0,.29c.22.89.87,3.3,1.12,4.15a.15.15,0,0,0,.26.07c1.92-2.65,4,.27,6.11-1.69A.46.46,0,0,0,13.76,8c-.21-.78-.8-3-1.1-4C12.62,3.84,12.42,3.76,12.33,3.88Z"></path>\n    </g>\n  </g>`,_n=`<g id="resign_white">\n    <g>\n      <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <circle class="${Wt.ClassNames.Background}" fill="#f8f8f8" cx="9" cy="9" r="8.5"></circle>\n      <g>\n        <path d="M4.94,5.74H4.89a.63.63,0,0,0-.44.77l2.16,8.09a.63.63,0,0,0,.77.45l0,0a.62.62,0,0,0,.44-.76L5.7,6.18A.62.62,0,0,0,4.94,5.74Z"></path>\n        <path d="M12.33,3.88c-2,2.29-3.83-.41-6,1.52a.54.54,0,0,0-.15.25.48.48,0,0,0,0,.29c.22.89.87,3.3,1.12,4.15a.15.15,0,0,0,.26.07c1.92-2.65,4,.27,6.11-1.69A.46.46,0,0,0,13.76,8c-.21-.78-.8-3-1.1-4C12.62,3.84,12.42,3.76,12.33,3.88Z"></path>\n      </g>\n    </g>\n    <path class="${Wt.ClassNames.ComponentShadow}" fill="#e8e8e8" d="M9,1A8,8,0,1,1,1,9,8,8,0,0,1,9,1M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n  </g>`,bn=`<g id="sharp">\n    <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${Wt.ClassNames.Background}" fill="#ad5b8c" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M13.37,11.74,9.25,2.81a.22.22,0,0,0-.1-.11.27.27,0,0,0-.28,0,.18.18,0,0,0-.1.11L4.63,11.74a.26.26,0,0,0,0,.15.25.25,0,0,0,.08.14l2.67,2.29.07.09a.3.3,0,0,1,0,.1v1.08a.25.25,0,0,0,.08.18.24.24,0,0,0,.18.07h2.57a.26.26,0,0,0,.18-.07.25.25,0,0,0,.08-.18V14.51a.16.16,0,0,1,0-.1.47.47,0,0,1,.06-.09L13.31,12a.25.25,0,0,0,.08-.14A.26.26,0,0,0,13.37,11.74ZM9,5v8.73a.24.24,0,0,1-.38.17L5.91,11.76a.3.3,0,0,1-.09-.13.22.22,0,0,1,0-.16L8.84,5a.08.08,0,0,1,0,0h.06A.09.09,0,0,1,9,5S9,5,9,5Z"></path>\n    </g>\n    <path class="${Wt.ClassNames.Component}" fill="#fff" d="M13.37,11.24,9.25,2.31a.22.22,0,0,0-.1-.11.26.26,0,0,0-.28,0,.18.18,0,0,0-.1.11L4.63,11.24a.26.26,0,0,0,0,.15.25.25,0,0,0,.08.14l2.67,2.29.07.09a.3.3,0,0,1,0,.1v1.08a.25.25,0,0,0,.08.18.24.24,0,0,0,.18.07h2.57a.26.26,0,0,0,.18-.07.25.25,0,0,0,.08-.18V14a.16.16,0,0,1,0-.1.47.47,0,0,1,.06-.09l2.67-2.29a.25.25,0,0,0,.08-.14A.26.26,0,0,0,13.37,11.24ZM9,4.51v8.73a.24.24,0,0,1-.38.17L5.91,11.26a.3.3,0,0,1-.09-.13.22.22,0,0,1,0-.16l3-6.49a.08.08,0,0,1,0,0h.06a.09.09,0,0,1,.05,0S9,4.49,9,4.51Z"></path>\n  </g>`,Cn=`<g id="take_back">\n    <g>\n      <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <path class="${Wt.ClassNames.Background}" fill="#96af8b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    </g>\n    <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M3.67,10.38a.25.25,0,0,1,.24-.31L5,9.93a.49.49,0,0,1,.2.05.26.26,0,0,1,.1.2,3.77,3.77,0,0,0,1.26,2.34,3.87,3.87,0,0,0,2.52.94,3.53,3.53,0,0,0,1.47-.31,3.72,3.72,0,0,0,1.22-.81,4.13,4.13,0,0,0,.82-1.2,3.74,3.74,0,0,0,0-3A3.94,3.94,0,0,0,11.77,7a3.72,3.72,0,0,0-1.22-.81,3.53,3.53,0,0,0-1.47-.31,3.43,3.43,0,0,0-1.23.22,3.07,3.07,0,0,0-1.09.6L7.85,7.75c.16.14.22.29.16.38s-.18.16-.4.16H4.45a.33.33,0,0,1-.19,0,1,1,0,0,1-.17-.1A.57.57,0,0,1,4,8a.46.46,0,0,1,0-.21V4.6a.4.4,0,0,1,.16-.38c.11,0,.26,0,.42.17L5.6,5.49a5.93,5.93,0,0,1,1.63-1,5.42,5.42,0,0,1,4,.11A5.17,5.17,0,0,1,12.93,5.8a5.48,5.48,0,0,1,1.16,1.73,5.17,5.17,0,0,1,.44,2.12,5,5,0,0,1-.44,2.12,5.54,5.54,0,0,1-2.88,2.91,5.77,5.77,0,0,1-2.13.42,5.39,5.39,0,0,1-1.94-.37,5.36,5.36,0,0,1-2.85-2.48A5.43,5.43,0,0,1,3.67,10.38Z"></path>\n    </g>\n    <path class="${Wt.ClassNames.Component}" fill="#fff" d="M3.67,9.88a.25.25,0,0,1,.24-.31L5,9.43a.49.49,0,0,1,.2.05.26.26,0,0,1,.1.2A3.77,3.77,0,0,0,6.56,12,3.87,3.87,0,0,0,9.08,13a3.53,3.53,0,0,0,1.47-.31,3.72,3.72,0,0,0,1.22-.81,4.13,4.13,0,0,0,.82-1.2,3.74,3.74,0,0,0,0-3,3.94,3.94,0,0,0-.82-1.2,3.72,3.72,0,0,0-1.22-.81,3.53,3.53,0,0,0-1.47-.31,3.43,3.43,0,0,0-1.23.22,3.07,3.07,0,0,0-1.09.6L7.85,7.25c.16.14.22.29.16.38s-.18.16-.4.16H4.45a.33.33,0,0,1-.19,0,1,1,0,0,1-.17-.1A.57.57,0,0,1,4,7.47a.46.46,0,0,1,0-.21V4.1a.4.4,0,0,1,.16-.38c.11-.05.26,0,.42.17L5.6,5A5.93,5.93,0,0,1,7.23,4a5.42,5.42,0,0,1,4,.11A5.17,5.17,0,0,1,12.93,5.3,5.48,5.48,0,0,1,14.09,7a5.17,5.17,0,0,1,.44,2.12,5,5,0,0,1-.44,2.12,5.54,5.54,0,0,1-2.88,2.91,5.77,5.77,0,0,1-2.13.42,5.39,5.39,0,0,1-1.94-.37,5.63,5.63,0,0,1-1.65-1,5.59,5.59,0,0,1-1.2-1.5A5.43,5.43,0,0,1,3.67,9.88Z"></path>\n  </g>`,Sn=`<g id="threat">\n    <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${Wt.ClassNames.Background}" fill="#ec6250" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M15.12,9.65a6.14,6.14,0,0,1-3.78,5.65,6.19,6.19,0,0,1-3.53.35A6.15,6.15,0,0,1,3,10.84,6.11,6.11,0,0,1,9,3.53a6.15,6.15,0,0,1,6.12,6.12ZM5,9.65a4,4,0,0,0,.67,2.22,4.09,4.09,0,0,0,1.79,1.47,4,4,0,0,0,5.22-5.22A4,4,0,0,0,5,9.65Z"></path>\n      <path d="M6.75,9.65a2.24,2.24,0,0,0,.38,1.25,2.27,2.27,0,0,0,1,.83,2.22,2.22,0,0,0,1.3.12,2.22,2.22,0,0,0,1.76-1.76,2.22,2.22,0,0,0-.13-1.3,2.25,2.25,0,0,0-4.32.86Z"></path>\n    </g>\n    <g>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M15.12,9.15a6.14,6.14,0,0,1-3.78,5.65,6.19,6.19,0,0,1-3.53.35A6.15,6.15,0,0,1,3,10.34,6.11,6.11,0,0,1,9,3a6.15,6.15,0,0,1,6.12,6.12ZM5,9.15a4,4,0,0,0,.67,2.22,4.09,4.09,0,0,0,1.79,1.47,4,4,0,0,0,5.22-5.22A4,4,0,0,0,5,9.15Z"></path>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M6.75,9.15a2.24,2.24,0,0,0,.38,1.25,2.27,2.27,0,0,0,1,.83,2.22,2.22,0,0,0,1.3.12A2.22,2.22,0,0,0,11.2,9.59a2.22,2.22,0,0,0-.13-1.3,2.25,2.25,0,0,0-4.32.86Z"></path>\n    </g>\n  </g>`,kn=`<path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n<path class="${Wt.ClassNames.Background}" fill="#312e2b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n<path d="M8.57,7.26,8.11,10l.89.86L9.89,10,9.45,7.26ZM9,12.86A3.35,3.35,0,1,1,12.36,9.5,3.34,3.34,0,0,1,9,12.86Zm.7-8.29V4.12h.82V2.79h-3V4.12H8.3v.45a5,5,0,1,0,1.4,0Z"></path>\n<path class="${Wt.ClassNames.ComponentShadow}" fill="#fff" d="M8.57,6.76,8.11,9.48l.89.86.89-.86L9.45,6.76ZM9,12.36A3.35,3.35,0,1,1,12.36,9,3.34,3.34,0,0,1,9,12.36Zm.7-8.29V3.62h.82V2.29h-3V3.62H8.3v.45a5,5,0,1,0,1.4,0Z"></path>`,wn=`<path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n<circle class="${Wt.ClassNames.Background}" fill="#f8f8f8" cx="9" cy="9" r="8.5"></circle>\n<path class="${Wt.ClassNames.ComponentShadow}" fill="#e8e8e8" d="M9,1A8,8,0,1,1,1,9,8,8,0,0,1,9,1M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n<path d="M8.57,6.76,8.11,9.48l.89.86.89-.86L9.45,6.76ZM9,12.36A3.35,3.35,0,1,1,12.36,9,3.34,3.34,0,0,1,9,12.36Zm.7-8.29V3.62h.82V2.29h-3V3.62H8.3v.45a5,5,0,1,0,1.4,0Z"></path>`,Tn=`\n  <path\n    class="${Wt.ClassNames.Shadow}"\n    d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"\n    opacity=".3"></path>\n  <path\n    class="${Wt.ClassNames.Background}"\n    d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"\n    fill="#8a8886"></path>\n  <path\n    d="M3.59,10.23a.25.25,0,0,1,.24-.31l1.08-.15a.49.49,0,0,1,.2.06.25.25,0,0,1,.11.2,3.58,3.58,0,0,0,.42,1.28,3.68,3.68,0,0,0,.84,1.06,3.76,3.76,0,0,0,1.16.69A3.9,3.9,0,0,0,9,13.31,3.58,3.58,0,0,0,10.47,13a3.94,3.94,0,0,0,1.22-.81A4.09,4.09,0,0,0,12.5,11a3.74,3.74,0,0,0,0-3,4.09,4.09,0,0,0-.81-1.2A3.94,3.94,0,0,0,10.47,6,3.65,3.65,0,0,0,9,5.69a3.61,3.61,0,0,0-1.23.21,3.23,3.23,0,0,0-1.09.6L7.77,7.59c.16.15.21.29.16.38s-.18.17-.4.17H4.37a.36.36,0,0,1-.2,0A.76.76,0,0,1,4,8a.52.52,0,0,1-.17-.38V4.45c0-.2.06-.33.17-.38s.25,0,.41.16L5.51,5.34a5.83,5.83,0,0,1,1.64-1A5.19,5.19,0,0,1,9,4.05a5.3,5.3,0,0,1,2.12.44,5,5,0,0,1,1.73,1.16A5.59,5.59,0,0,1,14,7.38a5.23,5.23,0,0,1,.44,2.12A5.16,5.16,0,0,1,14,11.62a5.59,5.59,0,0,1-1.16,1.73,5.32,5.32,0,0,1-1.73,1.18A5.64,5.64,0,0,1,9,15a5.23,5.23,0,0,1-1.94-.37A5.27,5.27,0,0,1,4.21,12.1,5.1,5.1,0,0,1,3.59,10.23Z"\n    class="${Wt.ClassNames.ComponentShadow}"\n    opacity=".3"></path>\n  <path\n    d="M3.59,9.73a.25.25,0,0,1,.24-.31l1.08-.15a.49.49,0,0,1,.2.06.25.25,0,0,1,.11.2,3.58,3.58,0,0,0,.42,1.28,3.68,3.68,0,0,0,.84,1.06,3.76,3.76,0,0,0,1.16.69A3.9,3.9,0,0,0,9,12.81a3.58,3.58,0,0,0,1.47-.31,3.94,3.94,0,0,0,1.22-.81,4.09,4.09,0,0,0,.81-1.2,3.74,3.74,0,0,0,0-3,4.09,4.09,0,0,0-.81-1.2,3.94,3.94,0,0,0-1.22-.81A3.65,3.65,0,0,0,9,5.19a3.61,3.61,0,0,0-1.23.21A3.23,3.23,0,0,0,6.68,6L7.77,7.09c.16.15.21.29.16.38s-.18.17-.4.17H4.37a.36.36,0,0,1-.2,0A.76.76,0,0,1,4,7.49a.52.52,0,0,1-.17-.38V4c0-.2.06-.33.17-.38s.25,0,.41.16L5.51,4.84a5.83,5.83,0,0,1,1.64-1A5.19,5.19,0,0,1,9,3.55,5.3,5.3,0,0,1,11.12,4a5,5,0,0,1,1.73,1.16A5.59,5.59,0,0,1,14,6.88,5.23,5.23,0,0,1,14.45,9,5.16,5.16,0,0,1,14,11.12a5.59,5.59,0,0,1-1.16,1.73A5.32,5.32,0,0,1,11.12,14,5.64,5.64,0,0,1,9,14.45a5.23,5.23,0,0,1-1.94-.37A5.27,5.27,0,0,1,4.21,11.6,5.1,5.1,0,0,1,3.59,9.73Z"\n    class="${Wt.ClassNames.Component}"\n    fill="#ffffff"></path>\n`,Pn=`<g id="winner">\n    <g>\n      <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <path class="${Wt.ClassNames.Background}" fill="#dbac16" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    </g>\n    <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path class="cls-4" d="M4.35,12.66,2.86,7.72a.37.37,0,0,1,0-.21A.35.35,0,0,1,3,7.34a.31.31,0,0,1,.2-.07.3.3,0,0,1,.21.05L6.27,9.15l.14,0h.14a.31.31,0,0,0,.13-.06A.48.48,0,0,0,6.77,9L8.69,5.54a.4.4,0,0,1,.13-.13.37.37,0,0,1,.18,0,.36.36,0,0,1,.31.18L11.22,9a.52.52,0,0,0,.1.11.31.31,0,0,0,.13.06h.14l.13,0,2.89-1.83a.3.3,0,0,1,.21-.05.31.31,0,0,1,.2.07.35.35,0,0,1,.12.17.37.37,0,0,1,0,.21l-1.49,4.94a.34.34,0,0,1-.13.18.31.31,0,0,1-.21.07H4.69a.31.31,0,0,1-.21-.07A.34.34,0,0,1,4.35,12.66Z"></path>\n    </g>\n    <path class="undefined" fill-rule="evenodd" d="M4.35,12.06,2.86,7.12a.37.37,0,0,1,0-.21A.35.35,0,0,1,3,6.74a.31.31,0,0,1,.2-.07.3.3,0,0,1,.21,0L6.27,8.55l.14,0h.14a.31.31,0,0,0,.13-.06.48.48,0,0,0,.09-.11L8.69,4.94a.4.4,0,0,1,.13-.13.37.37,0,0,1,.18,0,.36.36,0,0,1,.31.18l1.91,3.48a.52.52,0,0,0,.1.11.31.31,0,0,0,.13.06h.14l.13,0,2.89-1.83a.3.3,0,0,1,.21,0,.31.31,0,0,1,.2.07.35.35,0,0,1,.12.17.38.38,0,0,1,0,.21l-1.49,4.94a.34.34,0,0,1-.13.18.31.31,0,0,1-.21.07H4.69a.31.31,0,0,1-.21-.07A.34.34,0,0,1,4.35,12.06Z"></path>\n  </g>`,En=`<g id="winner-white" fill="#fff">\n    <g>\n      <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <path class="${Wt.ClassNames.Background}" fill="#dbac16" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    </g>\n    <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path class="cls-4" d="M4.35,12.66,2.86,7.72a.37.37,0,0,1,0-.21A.35.35,0,0,1,3,7.34a.31.31,0,0,1,.2-.07.3.3,0,0,1,.21.05L6.27,9.15l.14,0h.14a.31.31,0,0,0,.13-.06A.48.48,0,0,0,6.77,9L8.69,5.54a.4.4,0,0,1,.13-.13.37.37,0,0,1,.18,0,.36.36,0,0,1,.31.18L11.22,9a.52.52,0,0,0,.1.11.31.31,0,0,0,.13.06h.14l.13,0,2.89-1.83a.3.3,0,0,1,.21-.05.31.31,0,0,1,.2.07.35.35,0,0,1,.12.17.37.37,0,0,1,0,.21l-1.49,4.94a.34.34,0,0,1-.13.18.31.31,0,0,1-.21.07H4.69a.31.31,0,0,1-.21-.07A.34.34,0,0,1,4.35,12.66Z"></path>\n    </g>\n    <path class="undefined" fill-rule="evenodd" d="M4.35,12.06,2.86,7.12a.37.37,0,0,1,0-.21A.35.35,0,0,1,3,6.74a.31.31,0,0,1,.2-.07.3.3,0,0,1,.21,0L6.27,8.55l.14,0h.14a.31.31,0,0,0,.13-.06.48.48,0,0,0,.09-.11L8.69,4.94a.4.4,0,0,1,.13-.13.37.37,0,0,1,.18,0,.36.36,0,0,1,.31.18l1.91,3.48a.52.52,0,0,0,.1.11.31.31,0,0,0,.13.06h.14l.13,0,2.89-1.83a.3.3,0,0,1,.21,0,.31.31,0,0,1,.2.07.35.35,0,0,1,.12.17.38.38,0,0,1,0,.21l-1.49,4.94a.34.34,0,0,1-.13.18.31.31,0,0,1-.21.07H4.69a.31.31,0,0,1-.21-.07A.34.34,0,0,1,4.35,12.06Z"></path>\n  </g>`,An=`<g id="interesting">\n    <path class="${Wt.ClassNames.Shadow}" d="m9 .5a9 9 0 1 0 9 9 9 9 0 0 0 -9-9z" opacity="0.3"></path>\n    <path  class="${Wt.ClassNames.Background}" d="m0 9a9 9 0 1 0 9-9 9 9 0 0 0 -9 9z" fill="#7979a1"></path>\n    <g  class="${Wt.ClassNames.Component}" opacity=".2">\n      <path d="m4.75 12.9a.28.28 0 0 1 0-.13.25.25 0 0 1 .08-.1.33.33 0 0 1 .23-.1h2 .12l.11.08a.36.36 0 0 1 .07.1.59.59 0 0 1 0 .13v1.9a.36.36 0 0 1 -.09.24.27.27 0 0 1 -.1.08h-.13-2-.12a.44.44 0 0 1 -.19-.19.28.28 0 0 1 0-.13zm-.06-8.8a.41.41 0 0 1 .08-.24.35.35 0 0 1 .23-.1h2.14.13l.11.08a.5.5 0 0 1 .09.24l-.15 6.77c0 .21-.15.31-.34.31h-1.78a.3.3 0 0 1 -.2-.06.3.3 0 0 1 -.1-.1.31.31 0 0 1 0-.13z"/><path d="m12.39 14.82a.25.25 0 0 1 0 .12.28.28 0 0 1 -.08.11l-.1.07h-.12-1.91a.27.27 0 0 1 -.13 0 .39.39 0 0 1 -.05-.12.35.35 0 0 1 -.08-.22v-1.78a.32.32 0 0 1 .09-.23l.1-.07h.12 1.89a.33.33 0 0 1 .23.09.61.61 0 0 1 .07.1.27.27 0 0 1 0 .13zm2.2-7.17a2.49 2.49 0 0 1 -.36.73 4.51 4.51 0 0 1 -.48.6 6 6 0 0 1 -.52.49q-.39.34-.66.63a1 1 0 0 0 -.27.7v.2a.22.22 0 0 1 0 .12.35.35 0 0 1 -.17.17.2.2 0 0 1 -.11 0h-1.75-.12a.23.23 0 0 1 -.1-.07.26.26 0 0 1 -.07-.1.22.22 0 0 1 .02-.12v-.35a2.41 2.41 0 0 1 .12-.84 2.91 2.91 0 0 1 .33-.66 3.38 3.38 0 0 1 .45-.55l.49-.42a6.55 6.55 0 0 0 .61-.62 1 1 0 0 0 .26-.67.66.66 0 0 0 -.08-.34.64.64 0 0 0 -.18-.27 1.18 1.18 0 0 0 -.77-.28 1.66 1.66 0 0 0 -.49.07 3 3 0 0 0 -.41.18 2.29 2.29 0 0 0 -.29.18l-.1.09a.53.53 0 0 1 -.24.06c-.12 0-.19-.07-.21-.13l-1-1.21a.29.29 0 0 1 0-.4 1.36 1.36 0 0 1 .21-.2 3 3 0 0 1 .55-.38 5.87 5.87 0 0 1 .9-.37 3.75 3.75 0 0 1 1.2-.17 4.12 4.12 0 0 1 1.2.19 4 4 0 0 1 1.09.56 2.73 2.73 0 0 1 .77.92 2.7 2.7 0 0 1 .29 1.28 2.72 2.72 0 0 1 -.11.98z"/></g><g fill="#fff"><path d="m4.75 12.4a.28.28 0 0 1 0-.13.25.25 0 0 1 .08-.1.33.33 0 0 1 .23-.1h2 .12l.11.08a.36.36 0 0 1 .07.1.59.59 0 0 1 0 .13v1.9a.36.36 0 0 1 -.09.24.27.27 0 0 1 -.1.08h-.13-2-.12a.44.44 0 0 1 -.19-.19.28.28 0 0 1 0-.13zm-.06-8.8a.41.41 0 0 1 .08-.24.35.35 0 0 1 .23-.1h2.14.13l.11.08a.5.5 0 0 1 .09.24l-.15 6.77c0 .21-.15.31-.34.31h-1.78a.3.3 0 0 1 -.2-.06.3.3 0 0 1 -.07-.1.31.31 0 0 1 0-.13z"/><path d="m12.39 14.32a.25.25 0 0 1 0 .12.28.28 0 0 1 -.08.11l-.1.07h-.12-1.91a.27.27 0 0 1 -.13 0 .39.39 0 0 1 -.1-.08.35.35 0 0 1 -.08-.22v-1.83a.32.32 0 0 1 .09-.23l.1-.07h.12 1.89a.33.33 0 0 1 .23.09.61.61 0 0 1 .07.1.27.27 0 0 1 0 .13zm2.2-7.17a2.49 2.49 0 0 1 -.36.73 4.51 4.51 0 0 1 -.48.6 6 6 0 0 1 -.52.49q-.39.34-.66.63a1 1 0 0 0 -.27.7v.22a.22.22 0 0 1 0 .12.35.35 0 0 1 -.17.17.2.2 0 0 1 -.11 0h-1.75-.12a.23.23 0 0 1 -.1-.07.26.26 0 0 1 -.07-.1.22.22 0 0 1 0-.12v-.35a2.41 2.41 0 0 1 .12-.84 2.91 2.91 0 0 1 .33-.66 3.38 3.38 0 0 1 .45-.55l.49-.42a6.55 6.55 0 0 0 .63-.64 1 1 0 0 0 .26-.67.66.66 0 0 0 -.08-.34.64.64 0 0 0 -.18-.27 1.18 1.18 0 0 0 -.73-.24 1.66 1.66 0 0 0 -.49.07 3 3 0 0 0 -.41.18 2.29 2.29 0 0 0 -.37.21l-.1.09a.53.53 0 0 1 -.24.06c-.12 0-.19-.07-.21-.13l-1-1.21a.29.29 0 0 1 0-.4 1.36 1.36 0 0 1 .21-.2 3 3 0 0 1 .55-.38 5.87 5.87 0 0 1 .9-.37 3.75 3.75 0 0 1 1.2-.17 4.12 4.12 0 0 1 1.2.19 4 4 0 0 1 1.16.52 2.73 2.73 0 0 1 .77.92 2.7 2.7 0 0 1 .29 1.28 2.72 2.72 0 0 1 -.14.95z"/>\n    </g>\n  </g>`,Mn=`<g id="warning">\n    <g>\n      <g class="${Wt.ClassNames.Shadow}" opacity="0.3">\n        <path d="M.32,14.3,6.94,2.83a2.37,2.37,0,0,1,4.11,0L17.68,14.3a2.38,2.38,0,0,1-2.06,3.56H2.38A2.38,2.38,0,0,1,.32,14.3Z"></path>\n      </g>\n      <path class="${Wt.ClassNames.Background}" fill="#ec6250" d="M.32,13.8,6.94,2.33a2.37,2.37,0,0,1,4.11,0L17.68,13.8a2.38,2.38,0,0,1-2.06,3.56H2.38A2.38,2.38,0,0,1,.32,13.8Z"></path>\n    </g>\n    <g>\n      <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.2">\n        <path d="M10.21,15.19a.5.5,0,0,1,0,.12.26.26,0,0,1-.07.1.31.31,0,0,1-.22.09H8.1a.25.25,0,0,1-.12,0,.31.31,0,0,1-.09-.07.35.35,0,0,1-.08-.22V13.45a.29.29,0,0,1,.09-.21A.22.22,0,0,1,8,13.17l.11,0H9.9a.31.31,0,0,1,.22.09.27.27,0,0,1,.09.21ZM10.1,11.6a.22.22,0,0,1,0,.11.23.23,0,0,1-.07.1.27.27,0,0,1-.21.07H8.18a.29.29,0,0,1-.31-.28L7.73,5.41a.35.35,0,0,1,.08-.22.23.23,0,0,1,.1-.07A.25.25,0,0,1,8,5.1H10a.32.32,0,0,1,.23.09.35.35,0,0,1,.08.22Z"></path>\n      </g>\n      <path class="${Wt.ClassNames.Component}" fill="#fff" d="M10.21,14.69a.5.5,0,0,1,0,.12.26.26,0,0,1-.07.1A.31.31,0,0,1,9.9,15H8.1A.25.25,0,0,1,8,15a.31.31,0,0,1-.09-.07.35.35,0,0,1-.08-.22V13a.29.29,0,0,1,.09-.21A.22.22,0,0,1,8,12.67l.11,0H9.9a.31.31,0,0,1,.22.09.27.27,0,0,1,.09.21ZM10.1,11.1a.22.22,0,0,1,0,.11.23.23,0,0,1-.07.1.27.27,0,0,1-.21.07H8.18a.29.29,0,0,1-.31-.28L7.73,4.91a.35.35,0,0,1,.08-.22.23.23,0,0,1,.1-.07A.25.25,0,0,1,8,4.6H10a.32.32,0,0,1,.23.09.35.35,0,0,1,.08.22Z"></path>\n    </g>\n  </g>`,xn=`<g id="equal">\n    <path class="${Wt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"/>\n    <path class="${Wt.ClassNames.Background}" fill="#a88865" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"/>\n    <g class="${Wt.ClassNames.ComponentShadow}" opacity="0.4">\n      <path d="M5.31,8.36l-.15,0A.57.57,0,0,1,5,8.25.57.57,0,0,1,5,8.12a.4.4,0,0,1,0-.15V6a.38.38,0,0,1,.39-.39h7.38a.38.38,0,0,1,.39.39V8a.4.4,0,0,1,0,.15.57.57,0,0,1-.08.13.57.57,0,0,1-.13.08l-.15,0Z"/>\n      <path d="M5.31,13.36l-.15,0A.57.57,0,0,1,5,13.25.57.57,0,0,1,5,13.12a.4.4,0,0,1,0-.15V11a.38.38,0,0,1,.39-.39h7.38a.38.38,0,0,1,.39.39V13a.4.4,0,0,1,0,.15.33.33,0,0,1-.21.21l-.15,0Z"/>\n    </g>\n    <g>\n      <path class="${Wt.ClassNames.Component}" fill="#f1f2f2" d="M5.31,7.86l-.15,0A.57.57,0,0,1,5,7.75.57.57,0,0,1,5,7.62a.4.4,0,0,1,0-.15V5.53a.38.38,0,0,1,.39-.39h7.38a.38.38,0,0,1,.39.39V7.47a.4.4,0,0,1,0,.15.57.57,0,0,1-.08.13.57.57,0,0,1-.13.08l-.15,0Z"/>\n      <path class="${Wt.ClassNames.Component}" fill="#f1f2f2" d="M5.31,12.86l-.15,0A.57.57,0,0,1,5,12.75.57.57,0,0,1,5,12.62a.4.4,0,0,1,0-.15V10.53a.38.38,0,0,1,.39-.39h7.38a.38.38,0,0,1,.39.39v1.94a.4.4,0,0,1,0,.15.33.33,0,0,1-.21.21l-.15,0Z"/>\n    </g>\n  </g>`,On={[Pe.Alternative]:zt,[Pe.BestMove]:Kt,[Pe.Blunder]:Zt,[Pe.Book]:Qt,[Pe.Brilliant]:Xt,[Pe.CheckmateBlack]:Yt,[Pe.CheckmateWhite]:Jt,[Pe.Correct]:en,[Pe.Critical]:tn,[Pe.DrawBlack]:nn,[Pe.DrawWhite]:rn,[Pe.Excellent]:an,[Pe.FastWin]:sn,[Pe.Forced]:dn,[Pe.FreePiece]:cn,[Pe.Gamechanger]:ln,[Pe.Good]:fn,[Pe.GreatFind]:un,[Pe.Inaccuracy]:pn,[Pe.Incorrect]:hn,[Pe.Mate]:mn,[Pe.MissedWin]:gn,[Pe.Mistake]:vn,[Pe.ResignBlack]:yn,[Pe.ResignWhite]:_n,[Pe.Sharp]:bn,[Pe.Takeback]:Cn,[Pe.Threat]:Sn,[Pe.TimeoutBlack]:kn,[Pe.TimeoutWhite]:wn,[Pe.Undo]:Tn,[Pe.Winner]:Pn,[Pe.WinnerWhite]:En,[Pe.Interesting]:An,[Pe.Warning]:Mn,[Pe.Equal]:xn};function makeSvgIcon({className:e="",path:t="",size:n="24",viewBox:a="0 0 18 19"}){return`\n    <svg xmlns="http://www.w3.org/2000/svg" class="${e}" width="${n}" height="${n}" viewBox="${a}">\n      ${t}\n    </svg>\n  `}function tuckMarking({square:e,isFlipped:t,effectEl:n}){const a=getTuckPosition(e,t);a.top&&n.classList.add("tuck-top"),a.right&&n.classList.add("tuck-right")}function getTuckPosition(e,t){const n={top:t?"1":"8",right:t?"a":"h"};return{top:e.includes(n.top),right:e.includes(n.right)}}function createEffectsMethods({board:e,el:t,options:n}){const a=document.createComment("/Effects");e.addToDom({el:a,insertAfter:!0,type:Nt.HoverSquare});const l=new Map;return{addEffects:function addEffects(f){f.forEach((f=>{const{data:{square:p,type:h},key:m}=f,g=document.createElement("div");g.classList.add("effect"),g.innerHTML=makeSvgIcon({path:On[h],size:"100%"}),setPositionBySquare({el:g,square:p}),n.test&&setTestData(g,{[Bt.Element]:jt.Effect,[Bt.Square]:p,[Bt.Type]:h}),isEdgeSquare(p)&&tuckMarking({square:p,isFlipped:e.el.classList.contains("flipped"),effectEl:g});const v=l.get(m);v&&e.el.removeChild(v),t.insertBefore(g,a),l.set(m,g)}))},getEffectElements:function getEffectElements(){return l},removeEffects:function removeEffects(t){t.forEach((t=>{const{key:n}=t,a=l.get(n);a&&(e.el.removeChild(a),l.delete(n))}))}}}function createEffectsPlugin(){return{create:e=>function init$1(e){const{api:t,options:n,renderer:a}=e,l=t.markings;null==a||a.extendRenderer(createEffectsMethods);const f=n.allowMarkings?l.getAllWhere({types:[Te]}):[];null==a||a.addEffects(f,e)}(e),match:[{condition:isMark(Te),handler:function markEffect(e,t){const{renderer:n}=t,a=e.data.filter(isType(Te));null==n||n.addEffects(a,t)}},{condition:isUnmark(Te),handler:function unmarkEffect(e,t){const{renderer:n}=t,a=e.data.filter(isType(Te));null==n||n.removeEffects(a,t)}},{condition:is(f.InstanceEvents.RendererSet),handler:function init2(e,t){const{api:n,options:a,renderer:l}=t,f=n.markings;null==l||l.extendRenderer(createEffectsMethods);const p=a.allowMarkings?f.getAllWhere({types:[Te]}):[];null==l||l.addEffects(p,t)}}],name:ke.Plugin.Name}}function createFadeSetupPlugin(){return{match:[{condition:isOneOf([f.InstanceEvents.RendererSet,f.APIEvents.Load]),handler:function fadeSetup(e,t){var n;null==(n=null==t?void 0:t.renderer)||n.fadeSetup(t)}}],name:Ae.Plugin.Name}}var Rn,In,Ln,Nn,Dn,Bn;function createFlipBoardPlugin(e=Rn.FlipBoardModifierKey){let t;return{match:[{condition:isOneOf([f.InstanceEvents.Create,f.InstanceEvents.RendererSet,f.OptionsEvents.Update]),handler:function runFlipBoardPlugin(e,n){const{options:a,renderer:l,state:p}=n;if(!l)return;if(a.flipped!==t){l.flipBoard(a.flipped,n);const e=p.get(f.State.PromotionMove);e&&l.openPromotionWindow(e,n)}t=a.flipped}},{condition:is(Ln.Events.Keydown),handler:function onKeydown(t,n){const{api:a,options:l,queue:f}=n;if(t.data!==e)return;f.add(a.setOptions,{flipped:!l.flipped})}}],name:Rn.Plugin.Name}}function excludeIntersection(e,t,{isDuplicateWhen:n}={}){const a=new Set(e);return t.forEach((t=>{if(function isObject(e){return"[object Object]"===Object.prototype.toString.call(e)}(t)&&n){const l=e.find((e=>n(e,t)));l&&a.delete(l)}else a.delete(t)})),[...a]}function highlightsHaveSameKeyAndColor(e,t){return e.key===t.key&&e.data.color===t.data.color}function createHighlightsAPI(e){return function createAPI2(){return function createHighlights(e){const t=new Set(e),n=new Map;return __spreadProps(__spreadValues({},t),{addModule:function addModule(e){return t.add(e)},getModules:getAllModulesAsArray,removeModule:function removeModule(e){return t.delete(e)},getAll:getAll,update:function update5(...e){const t=getAll();n.clear();const a=Array.from(getAllModulesAsArray().reduce(((t,n)=>(n(...e).forEach((e=>{t.set(e.data.square,e)})),t)),new Map).values());a.forEach((e=>n.set(e.data.square,e)));return{toAdd:excludeIntersection(a,t,{isDuplicateWhen:highlightsHaveSameKeyAndColor}),toRemove:excludeIntersection(t,a,{isDuplicateWhen:highlightsHaveSameKeyAndColor})}}});function getAll(){return Array.from(n.values())}function getAllModulesAsArray(){return Array.from(t)}}(e)}}function isNot(e){return function isType2(t){return e!==t.type}}function createHighlightsPlugin(e){return{api:createHighlightsAPI(e),destroy:function destroy10(e){const{api:t,renderer:n}=e,a=t.highlights;null==n||n.removeHighlights(a.getAll(),e)},match:[{condition:isNot(f.UserEvents.Pointermove),handler:function updateHighlights(e,t){const{api:n,renderer:a}=t;if(!a)return;const l=n.highlights,{toAdd:f,toRemove:p}=l.update(e,t);a.removeHighlights(p,t),a.addHighlights(f,t)}}],name:A.Plugin.Name}}function isNotOneOf(e){const t=new Set(Array.isArray(e)?e:Object.values(e));return function isType2(e){return!t.has(e.type)}}function pipeConditions(...e){return function checkMultipleConditions(t,n){return e.every((e=>e(t,n)))}}function createHoverSquarePlugin(){const e=(0,x.c)({data:{square:void 0},initialState:"hidden",states:{hidden:{dragPiece:e=>({data:{square:e},nextState:"showing"})},showing:{dragPiece:e=>({data:{square:e},nextState:"showing"}),dropPiece:()=>({nextState:"hidden"}),setOptionToFalse:()=>({nextState:"hidden"})}}});return{match:[{condition:pipeConditions((t=ht.BooleanOptions.HoverSquareOutline,function optionValueIsTruthy(e,n){var a,l;return Boolean(null==(l=null==(a=n.api)?void 0:a.getOptions)?void 0:l.call(a)[t])}),isNotOneOf([f.APIEvents.ClearMarkings,nt.Events.Tick])),handler:function updateHoverSquare(t,n){const{options:a,renderer:l,state:p}=n,h=!0!==p.get(f.State.HideHoverSquare)&&p.get(f.State.MachineState)!==Rt.States.PromotionAreaShowing&&p.get(f.State.DraggingPiece),m=t.data&&(t.data.square||t.data.squareInsideBoard||e.getData().square||h);let g=!1;g=a.highlightMoves?h?e.transition("dragPiece",m):e.transition("dropPiece"):e.transition("setOptionToFalse");if(!g||!l)return;"hidden"===e.getCurrentState()?l.hideHoverSquare(n):l.showHoverSquare(e.getData().square,n)}}],name:Le.Plugin.Name};var t}function convertMarkingFromJCE(e){const{color:t,data:n,type:a}=e,l=function stringArrayToObject(e){return e.reduce(((e,t,n,a)=>(n%2==0||(e[a[n-1]]=t),e)),{})}(n);Object.keys(l).forEach((e=>{l[e]=decodeURIComponent(l[e])}));const f=l,{persistent:p}=f,h=((e,t)=>{var n={};for(var a in e)N.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&L)for(var a of L(e))t.indexOf(a)<0&&D.call(e,a)&&(n[a]=e[a]);return n})(f,["persistent"]),m={key:fromJCEKey(e.key,e.type),node:!0,data:__spreadProps(__spreadValues({},h),{keyPressed:fromJCEColor(t)}),type:a};return void 0!==p&&(m.persistent="true"===p),m}function fromJCEKey(e,t){return`${t}|${e}`}function fromJCEColor(e){switch(e){case Dn.Alt:return ut.Alt;case Dn.Default:return ut.None;case Dn.Shift:return ut.Shift;case Dn.Ctrl:return ut.Ctrl;default:return}}function convertMarkingToJCE(e){const{data:t,persistent:n}=e,a=void 0!==n?__spreadProps(__spreadValues({},t),{persistent:n}):t,l=function toJCEColor(e){switch(e){case ut.Alt:return Dn.Alt;case ut.None:return Dn.Default;case ut.Shift:return Dn.Shift;case ut.Ctrl:return Dn.Ctrl;default:return Dn.Custom}}(t.keyPressed),f=l===Dn.Custom?a:function omit(e,...t){const n=__spreadValues({},e);return t.forEach((e=>{delete n[e]})),n}(a,"color");return Object.keys(f).forEach((e=>{f[e]=encodeURIComponent(f[e])})),{color:l!==Dn.Custom?l:void 0,data:(p=f,Object.entries(p).reduce(((e,[t,n])=>(void 0===n||e.push(t,n.toString()),e)),[])),key:toJCEKey(e),type:e.type};var p}function toJCEKey(e){const{data:{from:t,square:n,to:a},key:l}=e;return n||(t&&a?`${t}${a}`:l)}function getMarkingsFromJCE(e,t){const n=[],a=null!=t?t:e.markings();return Object.values(a).forEach((e=>{Object.values(e).forEach((e=>{n.push(convertMarkingFromJCE(e))}))})),n}function JCENodeHasMarking(e,t,n){const{key:a}=t,l=getMarkingsFromJCE(e,n);return Boolean(l.find((e=>e.key===a)))}(In=Rn||(Rn={})).FlipBoardModifierKey="x",function(e){e.Name="flip-board"}(In.Plugin||(In.Plugin={})),function(e){e.Name="keys"}((Nn=Ln||(Ln={})).Plugin||(Nn.Plugin={})),function(e){e.Keydown="Keydown",e.Keyup="Keyup"}(Nn.Events||(Nn.Events={})),(Bn=Dn||(Dn={})).Alt="a",Bn.Ctrl="l",Bn.Custom="c",Bn.Default="d",Bn.Shift="s";const Fn=[f.APIEvents.CreateGame,f.APIEvents.DeletePosition,f.APIEvents.Load,f.APIEvents.Move,f.APIEvents.MoveBackward,f.APIEvents.MoveForward,f.APIEvents.MoveVariation,f.APIEvents.PromoteVariation,f.APIEvents.SelectLineEnd,f.APIEvents.SelectLineStart,f.APIEvents.SelectNode,f.APIEvents.Reload,f.APIEvents.ResetToMainLine,f.APIEvents.Undo];function removeFromJCENode(e,t){const n=convertMarkingToJCE(t);e.mark(n,!0)}function createEventHandlers$2(){return[{condition:isOneOf(Fn),handler:function handlePositionChange(e,t){const{api:n,queue:a}=t;if(0===e.data.plyDiff&&0===e.data.lineDiff)return;a.add((function refreshMarkings(){const{game:e}=n.getContext(),t=n.markings,a=getMarkingsFromJCE(e);t.removeAllWhere({node:!0}),a.length&&t.addMany(a)}))}},{condition:is(f.APIEvents.Mark),handler:function handleMark(e,t){const{api:n}=t,{data:a}=e,{game:l}=n.getContext();(Array.isArray(a)?a:[a]).forEach((e=>{e.node&&!JCENodeHasMarking(l,e)&&function addToJCENode(e,t){const n=convertMarkingToJCE(t);e.mark(n)}(l,e)}))}},{condition:is(f.APIEvents.Unmark),handler:function handleUnmark(e,t){const{api:n}=t,{data:a}=e,{game:l}=n.getContext();(Array.isArray(a)?a:[a]).forEach((e=>{e.node&&JCENodeHasMarking(l,e)&&removeFromJCENode(l,e)}))}}]}function intersection(...e){if(1===e.length)return e[0];const t=new Set;for(const n of e)for(const a of n)e.every((e=>e.has(a)))&&t.add(a);return t}function createTaggedMap({batchCallbacks:e=!0,onEntryAdded:t,onEntryRemoved:n,primaryKey:a="id"}={primaryKey:"id"}){const l=new Map,f=new Map,{flush:p,isBatching:h,stack:m,startBatching:g}=function createStacks(e){let t=!1;const n=new Map;return Object.entries(e).forEach((([e,t])=>{t&&n.set(e,{callback:t,entries:new Set})})),{flush:function flushEntries(){n.forEach((e=>{var n;const a=Array.from(e.entries.values());a.length&&(null==(n=e.callback)||n.call(e,a),e.entries.clear()),t=!1}))},isBatching:()=>t,stack:function stackEntry(e){return function entryModified(t){var a;null==(a=n.get(e))||a.entries.add(t)}},startBatching:function startBatchingEntries(){t=!0}}}({added:t,removed:n});function entryAddedCallback(n){return e&&h()?m("added")(n):null==t?void 0:t(n)}function entryRemovedCallback(t){return e&&h()?m("removed")(t):null==n?void 0:n(t)}return{addOne:addOne,addMany:batch((function addMany(e,t){return e.map(((e,n)=>addOne(e,null==t?void 0:t[n])))})),batch:batch,getAll:function getAll(){return Array.from(l.values())},getManyByTags:function getManyByTags(e,t={}){return getMatchingKeys(e,t).map((e=>l.get(e))).filter((e=>void 0!==e))},getMatchingKeys:getMatchingKeys,getMap:function getMap(){return l},getMany:function getMany(e){return e.map((e=>l.get(e))).filter((e=>void 0!==e))},getOne:function getOne(e){return l.get(e)},removeAll:batch((function removeAll(){for(const[e,t]of l.entries())null==entryRemovedCallback||entryRemovedCallback(t);return l.clear(),f.clear(),!0})),removeMany:batch((function removeMany(e){return e.every(removeOne)})),removeManyByTags:batch((function removeManyByTags(e,t={}){return getMatchingKeys(e,t).every((e=>removeOne(e)))})),removeOne:removeOne};function batch(e){return(...t)=>{g();const n=e(...t);return p(),n}}function addOne(e,t){const n=e[a],p=l.get(n);return p&&(l.delete(n),null==entryRemovedCallback||entryRemovedCallback(p)),null==t||t.forEach((e=>{var t;f.get(e)||f.set(e,new Set),null==(t=f.get(e))||t.add(n)})),l.set(n,e),null==entryAddedCallback||entryAddedCallback(e),n}function getMatchingKeys(e,t={}){const{matchAll:n}=t,a=e.map((e=>f.get(e))).filter((e=>void 0!==e));let l;return l=n?Array.from(intersection(...a)):Array.from(function union(...e){const t=new Set;for(const n of e)for(const e of n)t.add(e);return t}(...a)),l}function removeOne(e){var t;const n=l.get(e);n&&(l.delete(e),null==entryRemovedCallback||entryRemovedCallback(n));const a=f.entries();for(const[l,p]of a)p.has(e)&&p.delete(e),0===(null==(t=f.get(l))?void 0:t.size)&&f.delete(l);return!0}}function isBoardSquare(e){return/^([a-h][1-8])$/.test(e)}function toArray(e){return Array.isArray(e)?e:[e]}function createMarkings({generateKey:e=generatePrimaryKey,onMarkingAdded:t,onMarkingRemoved:n}={}){const a=createTaggedMap({batchCallbacks:!0,onEntryAdded:t,onEntryRemoved:n,primaryKey:"key"});return{addOne:addOne,addMany:function addMany(e){return function addManyWithoutBatching(e){return e.map(addOne)}(e)},getMany:a.getMany,getAll:a.getAll,getAllWhere:function getAllWhere(e={}){return getKeysWhere(e).map((e=>a.getMap().get(e))).filter(Boolean)},getOne:a.getOne,removeAll:a.removeAll,removeAllWhere:function removeAllWhere(e={}){var t;0===(null==(t=e.types)?void 0:t.length)&&(e.types=void 0);return a.removeMany(getKeysWhere(e))},removeOne:a.removeOne,removeMany:a.removeMany,toggleMany:function toggleMany(e){return e.map(toggleOne)},toggleOne:toggleOne};function addOne(e){if(!function markingHasValidSquareOrFromTo(e){const{from:t,square:n,to:a}=e.data,l=n?[n]:[t,a];for(const f of l)if(!isBoardSquare(f))return!1;return!0}(e))return null;const t=function getMarkingTags(e){const{node:t,persistent:n,tags:a=[],type:l}=e;return[t?"node":"board",n?"persistent":"temporary",...a,l]}(e);return a.addOne(withKey(e),t)}function getKeysWhere(e={}){const{node:t,persistent:n,tags:l,types:f}=e;let p,h;void 0!==t&&(p=t?"node":"board"),void 0!==n&&(h=n?"persistent":"temporary");const m=[p,h,l,f].filter((e=>void 0!==e));if(!m.length)return Array.from(a.getMap().keys());const g=m.map(toArray).map((e=>new Set(a.getMatchingKeys(e))));return Array.from(intersection(...g))}function toggleOne(e){const t=withKey(e),n=a.getOne(t.key);return n&&function objectsAreShallowEqual(e,t){const n={a:Object.getOwnPropertyNames(e),b:Object.getOwnPropertyNames(t)};return n.a.length===n.b.length&&n.a.every((n=>e[n]===t[n]))}(n.data,t.data)?a.removeOne(t.key):addOne(t)}function withKey(t){return __spreadProps(__spreadValues({},t),{key:t.key||e(t)})}}function generatePrimaryKey(e){const{data:{from:t,square:n,to:a},type:l}=e;if(!(n||t&&a))throw new Error('Markings that do not have a "square" property must provide a "from" and "to"');return`${l}|${n||`${t}${a}`}`}function createMarkingsAPI(e){const{respond:t}=e;return createMarkings({onMarkingAdded:function onMarkingAdded(e){t(f.APIEvents.Mark,toArray(e))},onMarkingRemoved:function onMarkingRemoved(e){t(f.APIEvents.Unmark,toArray(e))}})}var jn,$n,Hn,Vn;function createMarkingsPlugin(){return{api:createMarkingsAPI,match:createEventHandlers$2(),name:jn.Plugin.Name}}function createMoveHintsPlugin(){let e=[];return{match:[{condition:isNotOneOf([f.UserEvents.Pointermove,nt.Events.Tick]),handler:updateMoveHints},{condition:is(f.InstanceEvents.RendererSet),handler:function resetMoveHints(t,n){e=[],updateMoveHints(t,n)}}],name:De.Plugin.Name};function updateMoveHints(t,n){const{renderer:a}=n;a&&(e=function updateHints({addMoveHints:e,addCaptureHints:t,context:n,currentHints:a,getNextHints:l,removeHints:p}){let h=a;const{api:m,mode:g,options:v,state:y}=n;if(!v||!v.highlightLegalMoves||!g.isAllowedToMove())return p([...a],n),h.length=0,h;const _=y.get(f.State.SelectedPiece)||y.get(f.State.DraggingPiece);if(!_)return h.length&&(p(h,n),h=[]),h;const b=y.get(f.State.MachineState)===Rt.States.PromotionAreaShowing?[]:m.getLegalMovesForSquare(_),C=h.filter((e=>!b.includes(e)));p(C,n);const S=l(b),k=[],w=[],T=m.getPieces().keys();return S.forEach((e=>{t&&T.includes(e)?w.push(e):k.push(e)})),k.length&&e(k,n),w.length&&(null==t||t(w,n)),h.filter((e=>!C.includes(e))).concat(S)}({addMoveHints:a.addMoveHints,addCaptureHints:a.addCaptureHints,context:n,currentHints:e,getNextHints:t=>t.filter((t=>!e.includes(t))),removeHints:a.removeHints}))}}function createPiecesPlugin(){return{match:[{condition:isOneOf(f.APIEvents),handler:function updatePieces(e,t){const{renderer:n}=t;if(!n)return;if(e.type===f.APIEvents.IllegalMove)return void n.illegalMove(!1,t);const{plyDiff:a,move:l,pieces:p}=e.data;if(p)return void n.loadPieces({pieces:p},t);if(l&&-1===a)return void("--"!==l.san&&n.undoMove(l,t));l&&n.makeMove(l,t)}},{condition:is(f.InstanceEvents.RendererSet),handler:function reloadPieces(e,t){const{api:n,renderer:a}=t;null==a||a.loadPieces({pieces:n.getPieces()},t)}}],name:Fe.Plugin.Name}}function createRendererErrorCatcherPlugin(){let e={};return{create:create3,destroy:function destroy10(t){const{renderer:n}=t;if(!n)return;Object.keys(e).forEach((t=>{n[t]=e[t]})),e={}},match:[{condition:is(f.InstanceEvents.RendererSet),handler:(e,t)=>create3(t)}],name:Hn.Plugin.Name};function create3(t){const{options:n,renderer:a}=t;a&&!n.test&&["dragPiece","dropPiece","makeMove","removePiece","undoMove"].forEach((n=>{const l=function reloadOnError({context:e,method:t}){return function wrappedRendererMethod(...n){try{return t(...n)}catch(a){const{api:t,renderer:n}=e;console.error("Board position reloaded due to game and renderer state desynchronisation:\n",a),t.logger.log({code:Hn.ErrorCodes.StateDesynchronisation,data:a,level:Vt.Levels.Error}),null==n||n.loadPieces({pieces:t.getPieces(),reloadAll:!0},e)}}}({context:t,method:a[n]});e[n]=a[n],a[n]=l}))}}(function(e){e.Name="markings"})(($n=jn||(jn={})).Plugin||($n.Plugin={})),((Vn=Hn||(Hn={})).ErrorCodes||(Vn.ErrorCodes={})).StateDesynchronisation="StateDesynchronisation",function(e){e.Name="rendererErrorCatcher"}(Vn.Plugin||(Vn.Plugin={}));const Un={enPassant:"https://www.chess.com/article/view/how-to-capture-en-passant",soundsDefault:"https://www.chess.com/bundles/web/sounds",soundsTheme:"https://images.chesscomfiles.com/chess-themes/sounds/",webglAssetPaths:"__CHESSCOM_WEBGL_ASSET_PATHS__",webglDataUrl:"https://www.chess.com/bundles/web/images/webgl_data",webglDataUrlDev:"static/webgl_data"};function getThemeUrls(e,t){return["webm","ogg","mp3","wav"].map((n=>function getThemeUrl({theme:e="default",type:t,format:n}){return`${Un.soundsTheme}_${n.toUpperCase()}_/${e}/${t}.${n}`}({format:n,theme:e,type:t})))}const Gn=[Ke.BoardSounds.GameStart,Ke.BoardSounds.GameEnd,Ke.BoardSounds.Capture,Ke.BoardSounds.Castle,Ke.BoardSounds.Premove,Ke.BoardSounds.MoveSelf,Ke.BoardSounds.MoveCheck,Ke.BoardSounds.MoveOpponent,Ke.BoardSounds.Promote,Ke.BoardSounds.Notify,Ke.BoardSounds.TenSeconds,Ke.BoardSounds.Illegal];var qn,Wn,zn,Kn;function isCapture(e){return void 0!==e.flags&&(Boolean(1==(1&e.flags))||e.flags===qn.Move.Flags.EPCapture)}function isCastle(e){return e.flags===qn.Move.Flags.AnyCastle||e.flags===qn.Move.Flags.KingsideCastle||e.flags===qn.Move.Flags.QueensideCastle}function isPromotion(e){return e.flags===qn.Move.Flags.Promotion||e.flags===qn.Move.Flags.CapturePromotion}function createSoundsPlugin(e){let t=e;return{api:()=>({getSoundsInstance:()=>t}),match:[{condition:isNot(f.UserEvents.Pointermove),handler:function runPlaySoundPlugin(e,n){var a;if(!t)return;const{api:l,options:p,state:h}=n;if(e.type===f.OptionsEvents.Update&&p.soundTheme!==t.getTheme())return t.destroy(),void t.load({theme:p.soundTheme});if(e.type===f.SoundEvents.Play)return t.play(e.data.sound),void h.set({soundPlayed:e.data.sound});if(!p.playSounds||!(null==(a=e.data)?void 0:a.plyDiff))return;let m=l.getSelectedNode();e.type===f.APIEvents.MoveBackward&&(m=e.data.move);if(!m)return;const g=l.getPlayingAs(),v=Boolean(g&&g!==m.color),y=function getSoundType(e,t){if(!e||!e.san)return null;let n;return n=function isCheck(e){return!(!e||!e.san)&&["+","#"].includes(e.san.slice(-1))}(e)?Ke.BoardSounds.MoveCheck:e.isPremove?Ke.BoardSounds.Premove:isPromotion(e)?Ke.BoardSounds.Promote:isCapture(e)?Ke.BoardSounds.Capture:isCastle(e)?Ke.BoardSounds.Castle:t?Ke.BoardSounds.MoveOpponent:Ke.BoardSounds.MoveSelf,n}(m,v);y&&(t.play(y),h.set({soundPlayed:y}))}}],name:Ke.Plugin.Name,create:function create3(e){t||(t=function createSounds(e){let t,n=Gn,a="default";e&&(n=e.codes,a=e.theme);let l=a;return load3({codes:n,theme:a}),{destroy:function destroy10(){Object.keys(t).forEach((e=>{t[e].unload()}))},getSounds:function getSounds(){return t},getTheme:getTheme2,load:load3,loadExtra:function loadExtra(e){const n=e.codes.reduce(((t,n)=>(t[n]=(0,x.l)(function getExtraSoundUrls(e,t){return["webm","ogg","mp3","wav"].map((n=>`${e}/${n}/${t}.${n}`))}(e.baseURL,n),void 0,!0),t)),{});Object.keys(n).forEach((e=>{var a;null==(a=t[e])||a.unload(),t[e]=n[e]})),(0,x.e)()},play:function play(e){const n=t[e],a=getTheme2();if(!n)return a;try{return(0,x.p)(n),a}catch(l){return a}}};function getTheme2(){return l}function load3(e){l=e.theme,t=(e.codes||Gn).reduce(((e,t)=>(e[t]=(0,x.l)(getThemeUrls(l,t),Ke.maxTagsPerSound,!0),e)),{}),(0,x.e)()}}({theme:e.options.soundTheme}))}}}!function(e){var t;let n;var a,l,f,p,h,m,g,v,y,_,b,C,S,k,w,T,P;(t=e.ColorsAsNumbers||(e.ColorsAsNumbers={}))[t.White=1]="White",t[t.Black=2]="Black",(a=n=e.Variants||(e.Variants={})).Bughouse="bughouse",a.Chess="chess",a.Chess960="chess960",a.Crazyhouse="crazyhouse",a.KingOfTheHill="kingofthehill",a.ThreeCheck="threecheck",e.JCEVariantTypes={[n.Bughouse]:"Bughouse",[n.Chess]:"Chess",[n.Chess960]:"Chess960",[n.Crazyhouse]:"Crazyhouse",[n.ThreeCheck]:"3-check",[n.KingOfTheHill]:"King of the Hill"},(l=e.ColorsAsLetters||(e.ColorsAsLetters={})).White="w",l.Black="b",(f=e.ColorsAsWords||(e.ColorsAsWords={})).White="white",f.Black="black",e.DefaultTimeControl=5,(p=e.EmptyPGNHeaders||(e.EmptyPGNHeaders={})).Black="?",p.Event="?",p.Date="????.??.??",p.Site="?",p.Value="?",p.Result="*",p.Round="?",p.White="?",h=e.Move||(e.Move={}),(m=h.Flags||(h.Flags={}))[m.Capture=1]="Capture",m[m.BigPawn=2]="BigPawn",m[m.EPCapture=4]="EPCapture",m[m.AnyCapture=5]="AnyCapture",m[m.Promotion=8]="Promotion",m[m.CapturePromotion=9]="CapturePromotion",m[m.KingsideCastle=16]="KingsideCastle",m[m.QueensideCastle=32]="QueensideCastle",m[m.AnyCastle=48]="AnyCastle",m[m.Drop=64]="Drop",m[m.DropOrCapture=69]="DropOrCapture",m[m.DropOrPromote=72]="DropOrPromote",function(e){e[e.Capture=0]="Capture",e[e.Castle=1]="Castle",e[e.Check=2]="Check",e[e.Checkmate=3]="Checkmate",e[e.Normal=4]="Normal",e[e.Premove=5]="Premove",e[e.Promotion=6]="Promotion"}(h.Types||(h.Types={})),g=e.Node||(e.Node={}),v=g.Marking||(g.Marking={}),function(e){!function(e){e.Arrows="arrows",e.Effects="effects",e.Pieces="pieces"}(e.Targets||(e.Targets={})),function(e){e.Above="above",e.Below="below"}(e.Positions||(e.Positions={}))}((y=v.CustomItem||(v.CustomItem={})).VisualOrder||(y.VisualOrder={})),(_=y.Types||(y.Types={})).Image="Image",_.Star="Star",_.TextBox="TextBox",(b=v.ColorKeys||(v.ColorKeys={})).alt="a",b.custom="c",b.default="d",b.shift="s",b.ctrl="l",(C=v.JCEColorsMap||(v.JCEColorsMap={})).a="alt",C.c="custom",C.d="default",C.s="shift",C.l="ctrl",function(e){e.Arrow="arrow",e.Effect="effect",e.Square="square",e.CustomItem="customItem"}(v.Types||(v.Types={})),S=e.Piece||(e.Piece={}),(k=S.Names||(S.Names={})).p="pawn",k.n="knight",k.b="bishop",k.r="rook",k.q="queen",k.k="king",function(e){e.Pawn="p",e.Knight="n",e.Bishop="b",e.Rook="r",e.Queen="q",e.King="k"}(S.Types||(S.Types={})),w=e.Highlight||(e.Highlight={}),(T=w.Defaults||(w.Defaults={})).Color="#ffff00",T[T.Opacity=.5]="Opacity",function(e){e.Analysis="analysis",e.Move="move",e.Premove="premove",e.Selection="selection"}(w.Types||(w.Types={})),function(e){e.Blitz="blitz",e.Bullet="bullet",e.Rapid="rapid"}(e.TimeControlTypes||(e.TimeControlTypes={})),(P=e.Results||(e.Results={})).Black="0-1",P.Draw="1/2-1/2",P.None="*",P.White="1-0"}(qn||(qn={})),zn=Wn||(Wn={}),(Kn=zn.Modifiers||(zn.Modifiers={})).Shift="Shift",Kn.Control="Control",Kn.Alt="Alt",Kn.Meta="Meta";const Zn=["Escape","Tab","Backspace","Enter","Backlash","Period","Slash","Comma","Space","Delete","Home","End","PageUp","PageDown","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],Qn=[Wn.Modifiers.Meta.toLowerCase(),Wn.Modifiers.Alt.toLowerCase(),Wn.Modifiers.Control.toLowerCase()];function convertCodeToKey(e){let t;return e.includes("Digit")?t=e.replace("Digit",""):e.includes("Numpad")?t=e.replace("Numpad",""):e.includes("Key")?t=e.replace("Key",""):e.includes(Wn.Modifiers.Control)?t=Wn.Modifiers.Control:e.includes(Wn.Modifiers.Shift)?t=Wn.Modifiers.Shift:e.includes(Wn.Modifiers.Alt)?t=Wn.Modifiers.Alt:e.includes(Wn.Modifiers.Meta)?t=Wn.Modifiers.Meta:Zn.includes(e)&&(t=e),null==t?void 0:t.toLowerCase()}function createKeysService({onKeydown:e,onKeyup:t}={}){let n=!0;const a=new Set;return document.addEventListener("keydown",onKeydownHandler),document.addEventListener("keyup",onKeyupHandler),window.addEventListener("blur",clearPressedKeys),window.addEventListener("contextmenu",clearPressedKeys),{isPressed:function isPressed(e){return a.has(e.toLowerCase())},getPressedKeys:function getPressedKeys(){return[...a].sort()},disable:function disable(){n=!1,a.clear()},enable:function enable(){n=!0},destroy:function destroy10(){document.removeEventListener("keydown",onKeydownHandler),document.removeEventListener("keyup",onKeyupHandler),window.removeEventListener("blur",clearPressedKeys),window.removeEventListener("contextmenu",clearPressedKeys),a.clear()}};function onKeydownHandler(t){const l=document.activeElement;if(!n||function isElementBlacklisted(e){return Boolean(!e||e.isContentEditable||["INPUT","TEXTAREA"].includes(e.tagName))}(l))return;const f=convertCodeToKey(t.code);f&&(a.add(f),null==e||e(f))}function onKeyupHandler(e){const n=convertCodeToKey(e.code);n&&(Qn.includes(n)&&a.clear(),a.delete(n),null==t||t(n))}function clearPressedKeys(){a.clear()}}function createCoreEvent(e,t){return{data:t||{},type:e}}function createKeysPlugin(){let e;const t=createKeysService({onKeydown:createEmitter(Ln.Events.Keydown),onKeyup:createEmitter(Ln.Events.Keyup)}),n={[Ln.Events.Keydown]:{},[Ln.Events.Keyup]:{}};return{api:()=>({isPressed:t.isPressed,getPressedKeys:t.getPressedKeys,setCallbacks:setCallbacks,removeCallbacks:removeCallbacks}),create:function create3(t){e=t.run},destroy:function destroy10(){t.destroy()},match:[{condition:is(f.OptionsEvents.Update),handler:function updateKeysPlugin(e,n){const{options:a}=n;a.captureKeyStrokes?t.enable():t.disable()}},{condition:is(Ln.Events.Keydown),handler:queueKeyCallback},{condition:is(Ln.Events.Keyup),handler:queueKeyCallback}],name:Ln.Plugin.Name};function createEmitter(t){return function emit(n){null==e||e(createCoreEvent(t,n))}}function queueKeyCallback(e,t){const{type:a,data:l}=e,f=n[a][l];f&&t.queue.add(f(t.api))}function setCallbacks(e){e.forEach((({key:e,callback:t,trigger:a=Ln.Events.Keydown})=>{n[a][e]=t}))}function removeCallbacks(e){e.forEach((({trigger:e=Ln.Events.Keydown,key:t})=>{delete n[e][t]}))}}var Xn,Yn,Jn,er,tr;(Yn=Xn||(Xn={})).DefaultAcceptableFrequency=1e3,function(e){e.Name="webgl-context-lost"}(Yn.Plugin||(Yn.Plugin={})),function(e){e.Name="recorder"}((er=Jn||(Jn={})).Plugin||(er.Plugin={})),(tr=er.Mode||(er.Mode={})).Idle="Idle",tr.Playing="Playing",tr.Recording="Recording";const nr=[{name:"addMoveToEndOfLine"},{name:"agreeDraw"},{name:"blinkSquare"},{name:"claimDraw"},{name:"clearMarkings"},{name:"createContinuation"},{name:"createGame"},{name:"setPlayingAs"},{name:"usePlayingAs"},{name:"deletePosition"},{name:"load"},{name:"mark"},{name:"move"},{name:"moveBackward"},{name:"moveForward"},{name:"moveVariation"},{name:"outOfTime"},{name:"promoteVariation"},{name:"reload"},{name:"resetGame"},{name:"resetToMainLine"},{name:"resign"},{name:"selectLineEnd"},{name:"selectLineStart"},{name:"selectNode"},{name:"setGameDetails"},{name:"setResult"},{name:"setTurn"},{name:"toggleMarking"},{name:"undo"},{name:"unmark"},{name:"updateLineComment"},{name:"updateNode"},{name:"setOptions"},{name:"setMode"},{name:"playSound"},{namespace:"arrowKeys",name:"setKeys"},{namespace:"arrowKeys",name:"resetKeys"},{namespace:"boardImages",name:"mark"},{namespace:"boardImages",name:"unmark"},{namespace:"boardImages",name:"showWindow"},{namespace:"boardImages",name:"hideWindow"},{namespace:"clocks",name:"activate"},{namespace:"clocks",name:"deactivate"},{namespace:"clocks",name:"resetClocks"},{namespace:"clocks",name:"stopClocks"},{namespace:"hml",name:"addDiagramActions"},{namespace:"hml",name:"addCommentLink"},{namespace:"hml",name:"setScrollContainer"},{namespace:"hml",name:"updateNodeLimits"},{namespace:"keys",name:"setCallbacks"},{namespace:"keys",name:"removeCallbacks"},{namespace:"premoves",name:"cancel"},{namespace:"premoves",name:"consumeNext"},{namespace:"premoves",name:"loadQueue"},{namespace:"premoves",name:"move"},{namespace:"premoves",name:"reload"},{namespace:"threats",name:"enable"},{namespace:"threats",name:"onlyShowThreatsCreatedByColor"},{namespace:"vml",name:"activate"},{namespace:"vml",name:"deactivate"},{namespace:"vml",name:"waitForVMLReady"},{namespace:"markings",name:"addMany"},{namespace:"markings",name:"addOne"},{namespace:"markings",name:"removeAll"},{namespace:"markings",name:"removeAllWhere"},{namespace:"markings",name:"removeMany"},{namespace:"markings",name:"removeOne"},{namespace:"markings",name:"toggleMany"},{namespace:"markings",name:"toggleOne"}];const rr={mode:Jn.Mode.Idle,recordEvents:!1,lastRecordedEventTime:0,verbose:!1,playState:{playCounter:0,initDirty:!1,playedEvents:[]},recording:{events:[],pgn:"",modeName:"",variant:"",modeOptions:{},boardOptions:{},plugins:[],timestamp:""}};function createRecorderPlugin(){return{api:e=>function createRecorderAPI(e,t){const{api:n}=e;return{record:function record(e=!0){clear5(),t.recording={modeName:n.getMode().name,variant:n.getVariant(),modeOptions:n.getMode().getOptions(),boardOptions:n.getOptions(),pgn:n.getPGN(),plugins:n.plugins.get().map((e=>e.name)),timestamp:(new Date).toISOString(),events:[]},t.mode=Jn.Mode.Recording,t.recordEvents=e},play:function play({fixedDelay:e,skipEvents:n=!1,verbose:a=!0}={}){stop2(),t.playState.initDirty&&init2(),t.mode=Jn.Mode.Playing,t.verbose=a,t.verbose&&console.log("Playing",t.recording.events.length-1),playEvent({fixedDelay:e,skipEvents:n,autoContinue:!0})},step:function step({fastForwardEvents:e=!1,skipEvents:n=!1,verbose:a=!0}={}){stop2(),t.mode=Jn.Mode.Playing,t.verbose=a,playEvent({fixedDelay:0,skipEvents:n,fastForwardEvents:e,autoContinue:!1})},forward:function forward({eventNumber:e,skipEvents:n=!1,verbose:a=!0}){stop2(),(!t.playState.playCounter||t.playState.playCounter>=e||t.playState.playCounter===t.recording.events.length)&&init2(),t.mode=Jn.Mode.Playing,t.verbose=a,playEvent({fixedDelay:0,maxEventNumber:e,skipEvents:n,autoContinue:!0})},stop:stop2,init:init2,clear:clear5,get:()=>t,getJSON:function getJSON(){return t.recording?JSON.stringify(t.recording):""},load:function load3(e){const n=JSON.parse(e);return clear5(),t.recording=n,init2()}};function stop2(){return t.mode=Jn.Mode.Idle,t.recording.events.length}function clear5(){t.mode=Jn.Mode.Idle,t.lastRecordedEventTime=0,t.recording={events:[],pgn:"",modeName:"",variant:"",modeOptions:{},boardOptions:{},plugins:[],timestamp:""},t.playState={playCounter:0,initDirty:!1,playedEvents:[]}}function init2(){if(stop2(),!t.recording)return 0;t.playState={playCounter:0,playedEvents:[],initDirty:!1};const{pgn:n,events:a}=t.recording;return e.api.load({pgn:n}),e.api.markings.removeAll(),"localhost"===window.location.hostname&&e.api.boardImages&&!e.api.boardImages.isInitialized()&&e.api.boardImages.initDefault(),t.playState.initDirty=!1,a.length}function playEvent({maxEventNumber:e,fixedDelay:a,skipEvents:l,fastForwardEvents:f,autoContinue:p}){const h=t.recording.events[t.playState.playCounter];if(!h)return void(t.mode=Jn.Mode.Idle);const{name:m,args:g,namespace:v}=h;v?n[v][m](...g):"event"===m?l?(t.playState.playCounter+=1,t.playState.playedEvents.push(`skipped: ${g[0].type}`)):n.emit(g[0].type,g[0]):n[m](...g);const y=t.recording.events[t.playState.playCounter];if(t.mode!==Jn.Mode.Playing||!y||!p&&(!l||!f)||e&&t.playState.playCounter>=e)return t.mode=Jn.Mode.Idle,void(!y&&t.verbose&&console.log("Finished playing"));let _=null!=a?a:y.time;l&&"event"===y.name&&(_=0),(p||(l||f)&&"event"===y.name)&&setTimeout((()=>{playEvent({maxEventNumber:e,fixedDelay:a,skipEvents:l,fastForwardEvents:f,autoContinue:p})}),_)}}(e,rr),create:e=>setTimeout((()=>function create3(e){const{api:t}=e;addProxies(t);const apply=(e,n,a)=>{const l=(Array.isArray(a[0])?a[0]:a).map((e=>e.name)),f=e(...a);return l.forEach((e=>{addProxies(t,e)})),f};e.api.plugins.add=new Proxy(e.api.plugins.add,{apply:apply}),e.api.plugins.addMany=new Proxy(e.api.plugins.addMany,{apply:apply})}(e))),match:[{condition:()=>rr.mode===Jn.Mode.Recording&&rr.recordEvents,handler:e=>{rr.recording.events.push({name:"event",args:[e],time:getElapsedTime()})}},{condition:()=>rr.mode===Jn.Mode.Playing,handler:e=>{rr.verbose&&console.log(`${rr.playState.playCounter} / ${rr.recording.events.length-1}`,e),rr.playState.playCounter+=1,rr.playState.playedEvents.push(e)}}],name:Jn.Plugin.Name}}function addProxies(e,t){(t?nr.filter((e=>e.namespace===t)):nr).forEach((({namespace:t,name:n})=>{if(!t&&!e[n]||t&&!e[t]||t&&e[t]&&!e[t][n])return;const a=function getProxyApply(e,t){return function proxyApply(n,a,l){if(rr.playState.initDirty=!0,rr.mode===Jn.Mode.Recording){const n=getElapsedTime(),a=t?{namespace:t}:{};rr.recording.events.push(__spreadValues({name:e,args:l,time:n},a))}if(rr.mode===Jn.Mode.Playing){const n=rr.recording.events[rr.playState.playCounter];if(n&&n.name===e&&(!n.namespace||n.namespace===t)&&JSON.stringify(n.args).substring(0,50)===JSON.stringify(l).substring(0,50)){if(rr.verbose){const e=n.namespace?`${n.namespace}.${n.name}`:n.name;console.log(`${rr.playState.playCounter} / ${rr.recording.events.length-1}`,`${e}`,...n.args)}rr.playState.playCounter+=1}const a=t?{namespace:t}:{};rr.playState.playedEvents.push(__spreadValues({name:e,args:l},a))}return n(...l)}}(n,t);t?e[t][n]=new Proxy(e[t][n],{apply:a}):e[n]=new Proxy(e[n],{apply:a})}))}function getElapsedTime(){const e=Date.now(),t=0===rr.lastRecordedEventTime?0:e-rr.lastRecordedEventTime;return rr.lastRecordedEventTime=e,t}function createKeyedHighlight({color:e,type:t,opacity:n,square:a,turn:l}){return{data:{color:e,opacity:n,square:a,turn:l,type:t},key:`${t}|${a}`,type:"highlight"}}function getHighlightColorFromKeyPressed(e,t){switch(e){case ut.Alt:return t.analysisHighlightColors.alt;case ut.Ctrl:return t.analysisHighlightColors.ctrl;case ut.Shift:return t.analysisHighlightColors.shift;case ut.None:return t.analysisHighlightColors.default;default:return}}function getAnalysisHighlights(e,t){const{api:n,options:a}=t;return a&&a.allowMarkings?n.markings.getAllWhere({types:[B]}).map((({data:{color:e,keyPressed:t,opacity:n,square:l}})=>{var f,p;return createKeyedHighlight({color:null!=(p=null!=(f=getHighlightColorFromKeyPressed(t,a))?f:e)?p:a.analysisHighlightColors.default,opacity:null!=n?n:a.analysisHighlightOpacity,square:l,type:"analysis"})})):[]}function isLine(e){return void 0!==e.id}const ir=["wp","wn","wb","wr","wq","wk","bp","bn","bb","br","bq","bk"],ar={"8_bit":["#6a9b41","#f3f3f4","8_bit",".png","#ffff00"],bases:["#c26b38","#efcca1","bases",".jpg","#f5cc2a"],blackwhite:["#667188","#282f3f","translucent",".png","#5b91b3"],blue:["#4D6D92","#ECECD7","blue",".png","#00a5ff"],brown:["#B58863","#F0D9B5","brown",".png","#ffff00"],bubblegum:["#f9cdd3","#fff3f3","bubblegum",".png","#de5d6f"],burled_wood:["#895132","#d9b088","burled_wood",".jpg","#ee9016"],dark_wood:["#8d675e","#e7cdb2","dark_wood",".jpg","#cc9122"],dash:["#6b3a27","#bd9257","dash",".jpg","#eca722"],default:["#779952","#edeed1","green",".png","#ffff00"],glass:["#282f3f","#667188","glass",".png","#5b91b3"],graffiti:["#b96f18","#aeaeae","graffiti",".jpg","#f39011"],green:["#779952","#edeed1","green",".png","#ffff00"],grey:["#aaaaaa","#dcdcdc","light",".png","#a4b8c4"],icy_sea:["#7a9db2","#c5d5dc","icy_sea",".jpg","#5ed7f1"],light:["#aaaaaa","#dcdcdc","light",".png","#a4b8c4"],lolz:["#909898","#e0e9e9","lolz",".jpg","#a3becd"],marble:["#706b66","#c7bdaa","marble",".jpg","#f0db86"],marbleblue:["#c2d7e2","#efefef","marbleblue",".jpg","#65daf7"],marblebrown:["#b96f18","#aeaeae","graffiti",".jpg","#f39011"],marblegreen:["#706b66","#c7bdaa","marblegreen",".jpg","#f0db86"],metal:["#6e6e6e","#c9c9c9","metal",".jpg","#a3becd"],natural:["#D08B18","#FCE4B2","tan",".png","#f0e464"],nature:["#8c976e","#c3d1a4","translucent",".png","#eef396"],neon:["#636363","#b9b9b9","neon",".png","#6d90a6"],newspaper:["#5a5956","#5a5956","newspaper",".jpg","#99976e"],orange:["#D08B18","#FCE4B2","orange",".png","#ffff00"],overlay:["#789ebd","#4878a0","overlay",".png","#0d9acf"],parchment:["#B58863","#F0D9B5","parchment",".jpg","#d8cc66"],pink:["#f9cdd3","#fff3f3","bubblegum",".png","#de5d6f"],purple:["#8877B7","#EFEFEF","purple",".png","#7dacc9"],red:["#BA5546","#F0D8BF","red",".png","#f8f893"],sand:["#b8a590","#e5d3c4","sand",".jpg","#e2bc87"],sky:["#c2d7e2","#efefef","sky",".png","#65daf7"],stone:["#666463","#c8c3bd","stone",".jpg","#36525f"],tan:["#D08B18","#FCE4B2","tan",".png","#f7d84a"],tournament:["#316549","#ebece8","tournament",".jpg","#a4c25b"],translucent:["#667188","#282f3f","translucent",".png","#5b91b3"],walnut:["#835f42","#c0a684","walnut",".jpg","#d1a52d"],winboard:["#316549","#ebece8","tournament",".jpg","#a4c25b"],wood:["#8d675e","#e7cdb2","dark_wood",".jpg","#cc9122"],wooddark:["#895132","#d9b088","burled_wood",".jpg","#ee9016"],woodlight:["#B58863","#F0D9B5","parchment",".jpg","#d8cc66"],woodmid:["#8d675e","#e7cdb2","dark_wood",".jpg","#cc9122"],woodolive:["#6e6e6e","#c9c9c9","woodolive",".jpg","#a3becd"]},sr={"3d_staunton":{format:"png",isPseudo3d:!0,path:"3d_staunton"},"3dchesskid":{format:"png",isPseudo3d:!0,path:"3d_chesskid"},"3dplastic":{format:"png",isPseudo3d:!0,path:"3d_plastic"},"3dwood":{format:"png",isPseudo3d:!0,path:"3d_wood"},"8_bit":{format:"png",path:"8_bit"},alpha:{format:"png",path:"alpha"},bases:{format:"png",path:"bases"},blindfold:{format:"png",path:"blindfold"},book:{format:"png",path:"book"},bubblegum:{format:"png",path:"bubblegum"},cases:{format:"png",path:"cases"},classic:{format:"png",path:"classic"},club:{format:"png",path:"club"},condal:{format:"png",path:"condal"},dash:{format:"png",path:"dash"},game_room:{format:"png",path:"game_room"},glass:{format:"png",path:"glass"},gothic:{format:"png",path:"gothic"},graffiti:{format:"png",path:"graffiti"},icy_sea:{format:"png",path:"icy_sea"},light:{format:"png",path:"light"},lolz:{format:"png",path:"lolz"},marble:{format:"png",path:"marble"},maya:{format:"png",path:"maya"},metal:{format:"png",path:"metal"},modern2:{format:"png",path:"modern"},nature:{format:"png",path:"nature"},neo:{format:"png",path:"neo"},neo_wood:{format:"png",path:"neo_wood"},neon:{format:"png",path:"neon"},newspaper:{format:"png",path:"newspaper"},ocean:{format:"png",path:"ocean"},real3d:{format:"png",path:"neo"},sky:{format:"png",path:"sky"},space:{format:"png",path:"space"},tigers:{format:"png",path:"tigers"},tournament:{format:"png",path:"tournament"},vintage:{format:"png",path:"vintage"},wood:{format:"png",path:"wood"}};function getTheme(e){const t=ar[e];if(!t)return null;const[n,a,l,f,p]=t;return{darkSquareColor:n,lightSquareColor:a,path:l,extension:f,highlightColor:p}}const cr="move";function getMoveHighlights(e,t){const{api:n,options:a}=t,l=[];if(!a||!a.highlightMoves)return l;const f=n.getSelectedNode();return!f||isLine(f)||[f.from,f.to].forEach((e=>{var t,n,p;if(!e)return;const h=createKeyedHighlight({color:null!=(p=null!=(n=a.highlightColor)?n:null==(t=getTheme(a.boardStyle))?void 0:t.highlightColor)?p:ht.HighlightColors.Selected,opacity:a.highlightOpacity,square:e,turn:f.color,type:cr});l.push(h)})),l}function getSelectionSquare(e,t){var n,a;const{options:l,state:p}=t;if(!l||!l.highlightMoves)return[];const h=p.get(f.State.SelectedPiece)||p.get(f.State.DraggingPiece);if(!h)return[];return[createKeyedHighlight({color:null!=(a=null==(n=getTheme(l.boardStyle))?void 0:n.highlightColor)?a:ht.HighlightColors.Selected,opacity:l.highlightOpacity,square:h,type:"SelectionHiglight"})]}let lr;const ur="IS_POPULATED",dr="VERSION";function getDB(){return lr}async function initDB({ecoPath:e,http:t}){const n="0d4797b6b8a20d1546c98f8c37c24593",a=await async function storeIsPopulated(){return(0,x.g)(ur,lr).then(Boolean)}(),l=await async function getVersion(){return(0,x.g)(dr,lr).then(String)}();if(!a||!l||l!==n)return function setVersion(e){return(0,x.s)(dr,e,lr)}(n),async function populateStore({ecoPath:e,http:t}){return t.get(e).then((e=>{var t,n;!function setMany(e,t){return t._withIDBStore("readwrite",(t=>{e.forEach((e=>{t.put(e,e.f)}))}))}(null!=(n=(null==(t=null==e?void 0:e.data)?void 0:t.positions)?e.data.positions:e.data)?n:e,lr)}))}({ecoPath:e,http:t}).then(setPopulated)}function setPopulated(){return(0,x.s)(ur,!0,lr)}async function getECO({ecoPath:e,fens:t,http:n}){const a=function formatFENsForECOLookup(e){return e.reverse().map((e=>e.split(" ").slice(0,3).join(" ")))}(t);await initDB({ecoPath:e,http:n});return(await function getECOValuesFromDB(e){return Promise.all(e.map((e=>(0,x.g)(e,getDB()))))}(a)).find(Boolean)}var fr,pr;(fr||(fr={})).ECO="chesscom_eco",(pr||(pr={})).ECO="eco";const hr={get:e=>fetch(e,{method:"GET"}).then((e=>e.json()))};function createCancelPremoves(e,t){return function cancelPremoves(...n){e.premoves.cancel(),t(...n)}}function createPremoveAPIOverrides(){return{agreeDraw:({api:e})=>createCancelPremoves(e,e.agreeDraw),deletePosition:({api:e})=>createCancelPremoves(e,e.deletePosition),getLegalMovesForSquare:({api:e})=>function createGetLegalMovesForSquare$2(e){const t=e.getLegalMovesForSquare;return function getLegalMovesForSquare(n){return e.getPlayingAs()!==e.getTurn()?e.premoves.getLegalMovesForSquare(n):t(n)}}(e),getMove:({api:e})=>function createGetMove$4(e){const t=e.getMove;return function getMove(n){return e.getPlayingAs()!==e.getTurn()?e.premoves.getMove(n):t(n)}}(e),getPieces:({api:e})=>function createGetPieces$2(e){const t=e.getPieces;return function getPieces(){return e.premoves.getQueue().length?e.premoves.getPieces():t()}}(e),load:({api:e})=>function createReloadPremoves(e,t){return function reloadPremoves(...n){var a;e.premoves.cancel();const l=null==(a=n[0])?void 0:a.premoves;if(l){const t=e.getContext().game;l.forEach((e=>{t.premove.move(e)})),e.premoves.loadQueue(l),n[0].pieces=e.premoves.getPieces()}t(...n)}}(e,e.load),move:({api:e})=>function createMove$9(e){const t=e.move;return function move(n){const{respond:a}=e.getContext();if(e.getPlayingAs()===e.getTurn())return t(n);if(n.userGenerated)return e.premoves.move(n);const l=e.premoves.getQueue().length>0;l&&e.premoves.reload();const p=t(n);return l&&a(f.APIEvents.SetBoardPosition,{pieces:e.premoves.getPieces(),holdSelectedPiece:!0}),p}}(e),moveBackward:({api:e})=>createCancelPremoves(e,e.moveBackward),moveForward:({api:e})=>createCancelPremoves(e,e.moveForward),outOfTime:({api:e})=>createCancelPremoves(e,e.outOfTime),resign:({api:e})=>createCancelPremoves(e,e.resign),selectLineEnd:({api:e})=>createCancelPremoves(e,e.selectLineEnd),selectLineStart:({api:e})=>createCancelPremoves(e,e.selectLineStart),selectNode:({api:e})=>createCancelPremoves(e,e.selectNode),undo:({api:e})=>createCancelPremoves(e,e.undo)}}function isAllowedToMoveInPlayingMode({api:e,canMoveWhenNotPlayerTurn:t,modeOptions:n}){const{canAddMovesToMainLine:a,canMoveWhenGameIsOver:l,canModifyExistingMovesOnMainLine:f}=n;return Boolean((l||!e.isGameOver())&&(a&&e.isAtEndOfLine()||f)&&(t||e.getPlayingAs()===e.getTurn()))}function createIsAllowedToMove(e,t){return function isAllowedToMove(){return isAllowedToMoveInPlayingMode({api:t,canMoveWhenNotPlayerTurn:!0,modeOptions:e.getOptions()})}}function createCancel(e){return function cancel(){const{api:t,game:n}=e;return t.premoves.getQueue().length?(n.premove.cancel(),t.reload()):null}}function setTimestampOnNode({api:e,node:t,timestamp:n}){var a;const{game:l,respond:p}=e.getContext(),{line:h,move:m}=t.ids;if(null===n)return(null==(a=t.commands)?void 0:a.timestamp)&&delete t.commands.timestamp,p(f.APIEvents.NodeUpdated,{changes:{timestamp:n,node:t}});t.commands||(t.commands={}),l.updateNode({commands:Object.assign(t.commands,{timestamp:`${n}`})},m,h)}function millisecondsToDeciseconds(e){return Math.round(e/100)}function isNode(e){return void 0!==(null==e?void 0:e.ids)}function getPreviousNodeOfSameColor({api:e,node:t}){const n=e.getNodeByIds({move:t.ids.move-2,line:t.ids.line});return isNode(n)?n:null}function addTimeToConsumedPremove({api:e,timeControl:t}){const n=e.getLine(0);if(!n)return null;const a=n[n.length-1],l=getPreviousNodeOfSameColor({api:e,node:a}),{baseTime:f,increment:p}=t,h=function getGameTimeLeft({baseTime:e,increment:t,lastNodeTime:n}){return getStartingTime()-1;function getStartingTime(){return n?n+t:e}}({baseTime:millisecondsToDeciseconds(f),increment:millisecondsToDeciseconds(p),lastNodeTime:null==l?void 0:l.time});return h&&a&&(a.time=h),h}function createConsumeNext(e){return function consumeNext(){const{api:t,game:n,mutateGame:a}=e;if(!t.premoves.getQueue().length)return null;if(t.isGameOver())return t.premoves.cancel();t.premoves.reload();const l=a((function consume(){n.premove.consume()}));if(!l||0===l.plyDiff)return null;if(l.consumedPremove=!0,t.premoves.getQueue().length&&(l.pieces=t.premoves.getPieces()),l.move){const e=t.timeControl.get();e&&(addTimeToConsumedPremove({api:t,timeControl:e}),setTimestampOnNode({api:t,node:l.move,timestamp:1})),Object.assign(l.move,{animate:!1,userGenerated:!0})}return l.result&&t.setResult(l.result),l}}function createGetLegalMovesForSquare$1(e){return function getLegalMovesForSquare(t){const{game:n}=e,a=n.premove.moves(t);return a?a.filter((e=>void 0===t||e.from===t)).map((e=>e.to)).filter(((e,t,n)=>n.indexOf(e)===t)):[]}}function createGetMove$3(e){return function getMove(t){const{game:n}=e,a=n.premove.moves(t.from),l=a?a.find((e=>e.to===t.to)):null;return l?n.moveDetails(__spreadValues({},l)):null}}function createGetPieces$1(e){return function getPieces(){const{game:t}=e;return createCollection(t.premove.getPieces(!0))}}function createGetQueue(e){return function getQueue(){const{game:t}=e;return t.premove.queue}}function createIsLegalMove$1(e){return function isLegalMove(t){const{game:n}=e;return!!n.premove.move(t)&&(n.undo(),!0)}}function createLoadQueue(e){return function loadQueue(t){const{game:n}=e;n.premove.queue.length=0,n.premove.queue.push(...t)}}function createMove$8(e){return function move(t){const{api:n,game:a,respond:l}=e;return a.premove.move(t)?(n.getOptions().playSounds&&l(f.SoundEvents.Play,{sound:Ke.BoardSounds.Premove}),l(f.APIEvents.SetBoardPosition,{pieces:n.premoves.getPieces()})):null}}function createReload$1(e){return function reload(){const{api:t}=e;if(t.premoves.getQueue().length){const e=[...t.premoves.getQueue()];t.reload(),t.premoves.loadQueue(e)}else t.reload()}}const mr="premove";function getPremoveHighlights(e,t){var n;const{api:a,options:l}=t,f=null==(n=a.premoves)?void 0:n.getQueue();if(!l||!l.allowMarkings||!f.length)return[];const p=[];return f.forEach((e=>{if(e.from){const t=createKeyedHighlight({color:l.premoveHighlightColor,opacity:l.premoveHighlightOpacity,square:e.from,type:mr});p.push(t)}const t=createKeyedHighlight({color:l.premoveHighlightColor,opacity:l.premoveHighlightOpacity,square:e.kingTo||e.to,type:mr});p.push(t)})),p}const noop=()=>{};function createQueue(e=!0){const t=[];let n=!1;return{add:function add2(a,...l){let f=noop,p=noop;const h=new Promise(((e,t)=>{p=e,f=t}));t.push({fn:a,params:l,reject:f,resolve:p}),e&&!1===n&&flush2();return h},clear:function clear5(){n=!1,t.length=0},flush:flush2,getEntries:function getEntries(){return t}};async function flush2(){const e=t.shift();if(e){n=!0;try{const t=await e.fn(...e.params);return e.resolve(t),flush2()}catch(a){e.reject(a)}}else n=!1}}function createExternallyResolvablePromise(){let e,t;return{promise:new Promise(((n,a)=>{e=n,t=a})),reject:t,resolve:e}}var gr,vr,yr,_r,br,Cr,Sr,kr,wr,Tr,Pr;function addCustomColor(e,t){Object.values(gr.CssVariables).forEach((function setVariable(n){!function setCSSVariable({el:e,value:t,variable:n}){if(void 0!==t)return e.style.setProperty(n,t);e.style.removeProperty(n)}({el:e,value:t,variable:n})}))}vr=gr||(gr={}),(yr=vr.Classes||(vr.Classes={})).EnPassant="circle-info",yr.MoveInfoIcon="move-info-icon",yr.ThreeFoldIcon="redo",yr.IconFont="icon-font-chess",yr.MoveList="move-list",(vr.Tags||(vr.Tags={})).EnPassantIcon="span",(vr.CssVariables||(vr.CssVariables={})).Color="--nodeCustomColor",br=_r||(_r={}),function(e){e.ClearAllAnalysis="Clear All Analysis",e.DeleteCommentAfter="Delete Comment After",e.DeleteCommentBefore="Delete Comment Before",e.DeleteLine="Delete Entire Variation",e.DeleteMove="Delete Move",e.InsertCommentAfter="Comment After",e.InsertCommentBefore="Comment Before",e.InsertContinuation="Insert Continuation",e.MoveVariationDown="Move Variation Down",e.MoveVariationUp="Move Variation Up",e.Promote="Promote",e.RemoveAnnotation="Remove Annotation",e.RemoveBegin="Remove Begin",e.RemoveEnd="Remove End",e.RemoveEvaluationAnnotation="Remove Evaluation Annotation",e.RemoveFocus="Remove Focus",e.SetBegin="Set Begin",e.SetEnd="Set End",e.SetFocus="Set Focus"}((Cr=br.Translation||(br.Translation={})).Actions||(Cr.Actions={})),(Sr=Cr.Annotations||(Cr.Annotations={})).BadMove="Bad move",Sr.BlackHasDecisiveAdvantage="Black has a decisive advantage",Sr.BlackHasModerateAdvantage="Black has a moderate advantage",Sr.BlackHasSlightAdvantage="Black has a slight advantage",Sr.Blunder="Blunder",Sr.Drawish="Drawish",Sr.DubiousMove="Dubious move",Sr.ExcellentMove="Excellent move",Sr.GoodMove="Good move",Sr.Novelty="Novelty",Sr.Unclear="Unclear",Sr.PositionInZuqZwang="The position is in zugzwang",Sr.SpeculativeMove="Speculative move",Sr.WhiteHasSlightAdvantage="White has a slight advantage",Sr.WhiteHasModerateAdvantage="White has a moderate advantage",Sr.WhiteHasDecisiveAdvantage="White has a decisive advantage",Sr.WithInitiative="With initiative",Sr.WithCompensation="With compensation",Sr.WithAttack="With an attack",function(e){e.B="B",e.K="K",e.N="N",e.P="P",e.Q="Q",e.R="R"}(Cr.Pieces||(Cr.Pieces={})),(kr=Cr.Plural||(Cr.Plural={})).NumberOfDays="numberOfDays",kr.NumberOfHours="numberOfHours",kr.NumberOfMinutes="numberOfMinutes",(Cr.Prompt||(Cr.Prompt={})).AddComment="Add Comment...",(wr=Cr.Tooltips||(Cr.Tooltips={})).EnPassant="En passant is a special pawn move by which a pawn captures another pawn that has advanced two squares.",wr.ThreeFoldRepetition="This game ended in a draw because the same position was repeated three times.",function(e){e.HML="hml",e.VML="vml"}(br.Types||(br.Types={})),(Pr=Tr||(Tr={})).Mousedown="mousedown",Pr.MouseMove="mousemove",Pr.Mouseup="mouseup",Pr.PointerDown="pointerdown",Pr.PointerMove="pointermove",Pr.PointerUp="pointerup",Pr.Touchstart="touchstart",Pr.Touchmove="touchmove",Pr.Touchend="touchend";const{Pointerdown:Er,Pointermove:Ar,Pointerup:Mr}=function getPointerEvents(){const e="onpointerdown"in window,t="ontouchstart"in window;let n,a,l;e?(n=Tr.PointerDown,a=Tr.PointerMove,l=Tr.PointerUp):t?(n=Tr.Touchstart,a=Tr.Touchmove,l=Tr.Touchend):(n=Tr.Mousedown,a=Tr.MouseMove,l=Tr.Mouseup);return{Pointerdown:n,Pointermove:a,Pointerup:l}}();function toFigurine(e,t){return e.toUpperCase()===e?function getFigurineHTML(e,t){return`<span class="icon-font-chess ${function getPieceName(e){return qn.Piece.Names[e.toLowerCase()]}(e)}-${t}" data-figurine="${e}"></span>`}(e,t):e}function formatText({color:e,moveListDisplayType:t,san:n,translations:a}){return n.split("").map((n=>"NBRQK".includes(n)?t===ht.MoveListDisplayTypes.Figurine?toFigurine(n,e):a[n]():n)).join("")}function getColorAsWord(e){return e===qn.ColorsAsNumbers.Black?qn.ColorsAsWords.Black:qn.ColorsAsWords.White}function getThreeFoldElements(e,t){if(!e)return;return function findThreeFoldMoves(e){return e.reduceRight(((e,t,n,a)=>(3===(t===a[a.length-1]?e.push(n):e.length)&&(a.length=0),e)),[])}(e.map((({fen:e})=>e.split(" ")[0]))).map(function toMoveElements(e){return function mapElement(t){const n=Math.floor(t/2),a=t%2;return e[n].children[a]}}(t))}function isEPCapture(e){return e===qn.Move.Flags.EPCapture}function toClassString(e){return`.${e}`}var xr;function scrollToNode$1({containerEl:e,moveListEl:t,nodeEl:n}){if(!t||!n)return;const a=e||t,l=a.getBoundingClientRect(),f=n.getBoundingClientRect(),p=(l.bottom-l.top)/2,h=l.top-f.top+p;a.scrollTop-=h}function createVMLDOM(e){const{el:t,resultNodeIsSelectable:n,toggleTimestamps:a}=e,l=[],f=function createState(e={}){const t=__spreadValues({},e);return{get:function get2(){return t},set:function set3(e){Object.assign(t,e)}}}(e);return{addMove:addMove,addNode:function addNode(e){const{color:t,flags:n,ids:a,ply:l,san:f,wholeMoveNumber:p}=e;if(!t||!l||!f||!p||getNodeElement(l))return;let h=getMoveElement2(p);h||(h=addMove(p));const m=createNodeElement({color:getColorAsWord(t),moveId:a.move,isEPCapture:!!n&&isEPCapture(n),ply:l,san:f});if(!m)return;e.ply&&Object.prototype.hasOwnProperty.call(e,"customColor")&&addCustomColor(m,e.customColor);return h.appendChild(m)},addTimestamp:function addTimestamp({baseTime:e,node:t,timestamp:n,title:a,value:l}){const{color:f,ply:p,wholeMoveNumber:h}=t;if(!f||!p||!h)return;const m=getMoveElement2(h);if(!m)return;const g=getTimestampElement(p);g&&m.removeChild(g);const v=function createTimestampElement(e){const t=document.createElement("div");return t.setAttribute(xr.DOM.Attributes.Ply,e.toString()),t.setAttribute(xr.DOM.Attributes.VMLElement,xr.DOM.ElementTypes.Timestamp),t}(p);a&&function setTimestampElementTitle(e,t){t.title=e}(a,v);return setTimestampElementColor(f,v),setTimestampValue({baseTime:e,ply:p,timestamp:n,value:l},v),m.appendChild(v),v},clearList:function clearList(){destroyList(),createList()},createList:createList,deselectNode:function deselectNode(e){const t=e?getNodeElement(e):getSelectedNodeElement();if(!t)return;deselectNodeElement(t)},destroyList:destroyList,enableColors:function enableColors(e){const{colorsEnabled:n}=f.get();if(n===e)return;f.set({colorsEnabled:e}),t.classList[e?"add":"remove"](xr.DOM.ClassNames.ColorsEnabled)},getLastPly:getLastPly,getParams:f.get,getResult:function getResult(){const e=getResultNodeElement();if(!e)return qn.Results.None;return e.innerText},getResultNodeElement:getResultNodeElement,getTimestamp:function getTimestamp2(e){const t=getTimestampElement(e);if(!t)return null;const n=t.getAttribute(xr.DOM.Attributes.Time);if(0===(null==n?void 0:n.length))return null;return parseFloat(n)},hasResultNode:function hasResultNode(){return Boolean(t.querySelector(toClassString(xr.DOM.ClassNames.GameResult)))},addThreeFoldMoveIcons:function addThreeFoldMoveIcons(e){const t=getThreeFoldElements(e,getMoveElements());if(!t||3!==t.length)return;t.forEach((e=>{e.querySelector(toClassString(gr.Classes.MoveInfoIcon))||e.appendChild(function createThreeFoldIconElement(){const{translations:e}=f.get(),t=document.createElement("div"),n=document.createElement("span");return t.appendChild(n),t.classList.add(gr.Classes.MoveInfoIcon),n.classList.add(gr.Classes.IconFont,gr.Classes.ThreeFoldIcon),t.dataset.tooltip=e[_r.Translation.Tooltips.ThreeFoldRepetition](),t.addEventListener("mouseover",positionTooltip),t;function positionTooltip(){const e=t.getBoundingClientRect().y;t.style.setProperty("--tooltip-top",`${e}px`)}}())}))},isResultNodeSelected:function isResultNodeSelected(){var e;return Boolean(null==(e=t.querySelector(toClassString(xr.DOM.ClassNames.GameResult)))?void 0:e.classList.contains(xr.DOM.ClassNames.Selected))},removeTimestamp:function removeTimestamp(e){const t=getTimestampElement(e);if(!t)return;t.parentNode.removeChild(t)},scrollToSelectedNode:function scrollToSelectedNode(){const{scrollContainer:e}=f.get(),n=getSelectedNodeElement(),a=e||t;if(!n)return void(a.scrollTop=0);scrollToNode$1({containerEl:a,moveListEl:t,nodeEl:n})},selectNode:function selectNode2(e){const t=getNodeElement(e);if(!t)return;selectNodeElement(t)},selectNodeElement:selectNodeElement,selectResultNode:function selectResultNode(){const e=getResultNodeElement();e&&(selectNodeElement(e),t.dispatchEvent(new CustomEvent(xr.Events.SelectResultNode)))},setResultNode:function setResultNode(e){const t=getResultNodeElement();if(null!==t){const e=t.parentNode;if(!e)return;e.removeChild(t),0===e.childNodes.length&&e.parentNode.removeChild(e)}if(e===qn.Results.None)return;const a=getNodeElements().slice(-1)[0],l=a&&function getNodeElementColor(e){return e.classList.contains(qn.ColorsAsWords.Black)?qn.ColorsAsNumbers.Black:qn.ColorsAsNumbers.White}(a)!==qn.ColorsAsNumbers.Black?qn.ColorsAsWords.Black:qn.ColorsAsWords.White,f=l===qn.ColorsAsWords.White?addMove():getMoveElements().slice(-1)[0];let p;if(n){const t=getLastPly()||2;p=createNodeElement({color:l,isEPCapture:!1,moveId:getNodeElements().length-1,ply:t,san:e,isResultNode:!0}),p.classList.add(l,xr.DOM.ClassNames.GameResult)}else p=function createResultNodeElement(e,t){const n=document.createElement("span");return n.innerHTML=e,n.classList.add(t,xr.DOM.ClassNames.GameResult),n}(e,l);f.appendChild(p)},setTimestampValue:setTimestampValue,setParams:f.set,updateNodeColor:function updateNodeColor(e,t){const n=getNodeElement(e);if(!n)return;addCustomColor(n,t)}};function addMove(e){const n=document.createElement("div");return n.classList.add(xr.DOM.ClassNames.Move),e&&(n.setAttribute(xr.DOM.Attributes.WholeMoveNumber,`${e}`),n.innerHTML=`${e}.`),t.appendChild(n),n}function createList(){destroyList(),t.classList.add(xr.DOM.ClassNames.List),a&&t.classList.add(xr.DOM.ClassNames.ToggleTimestamps)}function createNodeElement({color:e,isEPCapture:n,isResultNode:a,moveId:p,ply:h,san:m}){const{EPIconInfoPath:g,moveListDisplayType:v,translations:y}=f.get(),_=document.createElement("div");if(_.setAttribute(xr.DOM.Attributes.Ply,h.toString()),_.classList.add(e,xr.DOM.ClassNames.Node),_.innerHTML=formatText({color:e,moveListDisplayType:v,san:m,translations:y}),n){const{el:e,listener:t}=function createEnPassantIcon(e,t){const n=document.createElement("div"),a=document.createElement(gr.Tags.EnPassantIcon);return n.appendChild(a),n.classList.add(gr.Classes.MoveInfoIcon),a.classList.add(gr.Classes.IconFont,gr.Classes.EnPassant),n.addEventListener(Er,EPIconPointerdownHandler),n.addEventListener("mouseover",(function positionTooltip(){const e=n.getBoundingClientRect().y;n.style.setProperty("--tooltip-top",`${e}px`)})),n.dataset.tooltip=t[_r.Translation.Tooltips.EnPassant](),{el:n,listener:{el:n,eventName:Er,handler:EPIconPointerdownHandler}};function EPIconPointerdownHandler(t){t.stopPropagation(),window.open(e,"_blank")}}(g,y);_.appendChild(e),l.push({el:e,eventName:Er,handler:t.handler})}return _.addEventListener(Er,halfMovePointerdownHandler),l.push({eventName:Er,handler:halfMovePointerdownHandler}),_;function halfMovePointerdownHandler(){t.dispatchEvent(new CustomEvent(xr.Events.SelectNode,{detail:{ids:{move:p,line:0},ply:h,isResultNode:a}}))}}function deselectNodeElement(e){e.classList.remove(xr.DOM.ClassNames.Selected)}function destroyList(){l.forEach((e=>{t.removeEventListener(e.eventName,e.handler)})),t.classList.remove(xr.DOM.ClassNames.List),t.innerHTML=""}function getLastPly(){const e=getNodeElements();if(!e.length)return;const t=function getNodeElementPly(e){const t=e.getAttribute(xr.DOM.Attributes.Ply);return t?parseInt(t,10):null}(e[e.length-1]);return t||void 0}function getMoveElement2(e){return t.querySelector(`[${xr.DOM.Attributes.WholeMoveNumber}="${e}"]`)}function getMoveElements(){return Array.from(t.querySelectorAll(`${toClassString(xr.DOM.ClassNames.Move)}`))}function getNodeElement(e){return t.querySelector(`${toClassString(xr.DOM.ClassNames.Node)}[${xr.DOM.Attributes.Ply}="${e}"]`)}function getNodeElements(){return Array.from(t.querySelectorAll(`${toClassString(xr.DOM.ClassNames.Node)}`))}function getResultNodeElement(){return t.querySelector(toClassString(xr.DOM.ClassNames.GameResult))}function getTimestampElement(e){return t.querySelector(`[${xr.DOM.Attributes.VMLElement}="${xr.DOM.ElementTypes.Timestamp}"][${xr.DOM.Attributes.Ply}="${e}"]`)}function getSelectedNodeElement(){return t.querySelector(toClassString(xr.DOM.ClassNames.Selected))}function selectNodeElement(e){const t=getSelectedNodeElement();e!==t&&(t&&deselectNodeElement(t),e.classList.add(xr.DOM.ClassNames.Selected))}function setMaxMoveTimeTaken(e){null!==e?t.style.setProperty(xr.DOM.CSSVariables.MaxMoveTimeTaken,e.toString()):t.style.removeProperty(xr.DOM.CSSVariables.MaxMoveTimeTaken)}function setTimestampElementColor(e,t){t.classList.add(function getTimestampClass(e){return`time-${e}`}(getColorAsWord(e)))}function setTimestampValue({baseTime:e,ply:n,value:a,timestamp:l},f){const p=f||getTimestampElement(n);if(!p)return;const h=function getTimestampWidth(){const e=t.style.getPropertyValue(xr.DOM.CSSVariables.TimestampWidth);return e.length?parseFloat(e):null}(),m=function getMaxMoveTimeTaken(){const e=t.style.getPropertyValue(xr.DOM.CSSVariables.MaxMoveTimeTaken);return e.length?parseFloat(e):null}();if(p.setAttribute(xr.DOM.Attributes.Time,l.toString()),p.style.setProperty(xr.DOM.CSSVariables.TimeValue,l.toString()),p.innerHTML=a,(!h||7*a.length>h)&&function setTimestampWidth(e){const n=7*e;t.style.setProperty(xr.DOM.CSSVariables.TimestampWidth,`${n}px`)}(a.length),e){const n=function getBarWidth(e,t){const n=e/(t/40);return 130/Math.PI*Math.atan(n/3)}(l,millisecondsToDeciseconds(e));return p.style.setProperty(xr.DOM.CSSVariables.TimeBarWidth,`${n}px`),t.classList.add(xr.DOM.ClassNames.WithBaseTime),void(m&&setMaxMoveTimeTaken(null))}t.classList.remove(xr.DOM.ClassNames.WithBaseTime),(!m||l>m)&&setMaxMoveTimeTaken(l)}}!function(e){var t,n,a,l;t=e.DOM||(e.DOM={}),(n=t.Attributes||(t.Attributes={})).Ply="data-ply",n.Time="data-time",n.WholeMoveNumber="data-whole-move-number",n.VMLElement="data-vml-element",(a=t.CSSVariables||(t.CSSVariables={})).TimeBarWidth="--timeBarWidth",a.TimeValue="--timeValue",a.MaxMoveTimeTaken="--timeMaxValue",a.TimestampWidth="--timestampWidth",(l=t.ClassNames||(t.ClassNames={})).ColorsEnabled="movelist-colored",l.List="vertical-move-list",l.GameResult="game-result",l.Move="move",l.Node="node",l.Selected="selected",l.WithBaseTime="timestamps-with-base-time",l.ToggleTimestamps="toggle-timestamps",(t.ElementTypes||(t.ElementTypes={})).Timestamp="timestamp",function(e){e.SelectNode="SelectNode",e.SelectResultNode="SelectResultNode"}(e.Events||(e.Events={}))}(xr||(xr={}));const Or={[_r.Translation.Prompt.AddComment]:()=>_r.Translation.Prompt.AddComment,[_r.Translation.Annotations.BadMove]:()=>_r.Translation.Annotations.BadMove,[_r.Translation.Annotations.BlackHasDecisiveAdvantage]:()=>_r.Translation.Annotations.BlackHasDecisiveAdvantage,[_r.Translation.Annotations.BlackHasModerateAdvantage]:()=>_r.Translation.Annotations.BlackHasModerateAdvantage,[_r.Translation.Annotations.BlackHasSlightAdvantage]:()=>_r.Translation.Annotations.BlackHasSlightAdvantage,[_r.Translation.Annotations.Blunder]:()=>_r.Translation.Annotations.Blunder,[_r.Translation.Actions.ClearAllAnalysis]:()=>_r.Translation.Actions.ClearAllAnalysis,[_r.Translation.Actions.DeleteCommentAfter]:()=>_r.Translation.Actions.DeleteCommentAfter,[_r.Translation.Actions.DeleteCommentBefore]:()=>_r.Translation.Actions.DeleteCommentBefore,[_r.Translation.Actions.DeleteLine]:()=>_r.Translation.Actions.DeleteLine,[_r.Translation.Actions.DeleteMove]:()=>_r.Translation.Actions.DeleteMove,[_r.Translation.Annotations.Drawish]:()=>_r.Translation.Annotations.Drawish,[_r.Translation.Annotations.DubiousMove]:()=>_r.Translation.Annotations.DubiousMove,[_r.Translation.Annotations.ExcellentMove]:()=>_r.Translation.Annotations.ExcellentMove,[_r.Translation.Tooltips.EnPassant]:()=>_r.Translation.Tooltips.EnPassant,[_r.Translation.Annotations.GoodMove]:()=>_r.Translation.Annotations.GoodMove,[_r.Translation.Actions.InsertCommentAfter]:()=>_r.Translation.Actions.InsertCommentAfter,[_r.Translation.Actions.InsertCommentBefore]:()=>_r.Translation.Actions.InsertCommentBefore,[_r.Translation.Actions.InsertContinuation]:()=>_r.Translation.Actions.InsertContinuation,[_r.Translation.Actions.MoveVariationDown]:()=>_r.Translation.Actions.MoveVariationDown,[_r.Translation.Actions.MoveVariationUp]:()=>_r.Translation.Actions.MoveVariationUp,[_r.Translation.Annotations.Novelty]:()=>_r.Translation.Annotations.Novelty,[_r.Translation.Pieces.B]:()=>_r.Translation.Pieces.B,[_r.Translation.Pieces.K]:()=>_r.Translation.Pieces.K,[_r.Translation.Pieces.N]:()=>_r.Translation.Pieces.N,[_r.Translation.Pieces.P]:()=>_r.Translation.Pieces.P,[_r.Translation.Pieces.Q]:()=>_r.Translation.Pieces.Q,[_r.Translation.Pieces.R]:()=>_r.Translation.Pieces.R,[_r.Translation.Actions.Promote]:()=>_r.Translation.Actions.Promote,[_r.Translation.Actions.RemoveAnnotation]:()=>_r.Translation.Actions.RemoveAnnotation,[_r.Translation.Actions.RemoveBegin]:()=>_r.Translation.Actions.RemoveBegin,[_r.Translation.Actions.RemoveEnd]:()=>_r.Translation.Actions.RemoveEnd,[_r.Translation.Actions.RemoveEvaluationAnnotation]:()=>_r.Translation.Actions.RemoveEvaluationAnnotation,[_r.Translation.Actions.RemoveFocus]:()=>_r.Translation.Actions.RemoveFocus,[_r.Translation.Actions.SetBegin]:()=>_r.Translation.Actions.SetBegin,[_r.Translation.Actions.SetEnd]:()=>_r.Translation.Actions.SetEnd,[_r.Translation.Actions.SetFocus]:()=>_r.Translation.Actions.SetFocus,[_r.Translation.Annotations.SpeculativeMove]:()=>_r.Translation.Annotations.SpeculativeMove,[_r.Translation.Tooltips.ThreeFoldRepetition]:()=>_r.Translation.Tooltips.ThreeFoldRepetition,[_r.Translation.Annotations.PositionInZuqZwang]:()=>_r.Translation.Annotations.PositionInZuqZwang,[_r.Translation.Annotations.Unclear]:()=>_r.Translation.Annotations.Unclear,[_r.Translation.Annotations.WhiteHasDecisiveAdvantage]:()=>_r.Translation.Annotations.WhiteHasDecisiveAdvantage,[_r.Translation.Annotations.WhiteHasModerateAdvantage]:()=>_r.Translation.Annotations.WhiteHasModerateAdvantage,[_r.Translation.Annotations.WhiteHasSlightAdvantage]:()=>_r.Translation.Annotations.WhiteHasSlightAdvantage,[_r.Translation.Annotations.WithAttack]:()=>_r.Translation.Annotations.WithAttack,[_r.Translation.Annotations.WithCompensation]:()=>_r.Translation.Annotations.WithCompensation,[_r.Translation.Annotations.WithInitiative]:()=>_r.Translation.Annotations.WithInitiative,[_r.Translation.Plural.NumberOfDays]:e=>1===e?`${e} day`:`${e} days`,[_r.Translation.Plural.NumberOfHours]:e=>1===e?`${e} hr`:`${e} hrs`,[_r.Translation.Plural.NumberOfMinutes]:e=>1===e?`${e} min`:`${e} mins`};var Rr,Ir,Lr,Nr,Dr,Br,Fr,jr,$r;function decisecondsToDaysHoursMinutesObject(e){const t=Math.ceil(e/10);let n=Math.floor(t/86400),a=Math.floor(t%86400/3600),l=Math.ceil(t%3600/60);return 60===l&&(l=0,a+=1),24===a&&(a=0,n+=1),{days:n,hours:a,minutes:l}}function decisecondsToDaysHoursMinutesString(e,t){const{days:n,hours:a,minutes:l}=decisecondsToDaysHoursMinutesObject(e),f=a>0||l>0?", ":"",p=l>0?", ":"";return`${n>0?`${t[_r.Translation.Plural.NumberOfDays](n)}${f}`:""}${a>0?`${t[_r.Translation.Plural.NumberOfHours](a)}${p}`:""}${l>0?`${t[_r.Translation.Plural.NumberOfMinutes](l)}`:""}`}function decisecondsToHumanReadableFormat(e,t){const{days:n,hours:a,minutes:l}=decisecondsToDaysHoursMinutesObject(e);return n?n>0?`${t[_r.Translation.Plural.NumberOfDays](n)}`:"":a?a>0?`${t[_r.Translation.Plural.NumberOfHours](a)}`:"":l>0?`${t[_r.Translation.Plural.NumberOfMinutes](l)}`:""}function formatDecisecondsAsClockString(e){const t=Math.floor(e/600),n=((e-600*t)/10).toFixed(1);if(0===t)return n;return`${t}:${`0${n}`.substr(-4)}`}function getTimestampElementParameters({formatTimestampAsHumanReadable:e,timestamp:t,translations:n}){return{title:e?decisecondsToDaysHoursMinutesString(t,n):void 0,value:e?decisecondsToHumanReadableFormat(t,n):formatDecisecondsAsClockString(t)}}function getTimestampFromNode(e){var t;return(null==(t=e.commands)?void 0:t.timestamp)?parseInt(e.commands.timestamp,10):null}function createVMLAPIOverrides({resultNodeIsSelectable:e}){return{moveBackward:({api:e})=>function createMoveBackward$2({api:e}){const t=e.moveBackward;return function moveBackward(){e.vml.getMoveList().isResultNodeSelected()?e.selectLineEnd(0):t()}}({api:e}),moveForward:({api:t})=>function createMoveForward$1({api:e,resultNodeIsSelectable:t}){const n=e.moveForward;return function moveForward(){var a;if(!t)return void n();const l=e.vml.getMoveList(),f=e.getFEN(),p=null==(a=e.getLastMove())?void 0:a.fen;l.isResultNodeSelected()||(p===f?l.selectResultNode():n())}}({api:t,resultNodeIsSelectable:e})}}function selectNode({node:e,lines:t}){return function getMachineStateForSelectedNode(e,t){return!e||isLine(e)?$r.StartingPosition:e.ids.move===Object.keys(t[e.ids.line]).length-1?$r.EndOfLineSelected:$r.MiddleOfLineSelected}(e,t)}function createHMLStateMachine(){return(0,x.c)(function getStateMachine$1(){return{initialState:$r.StartingPosition,states:{[$r.StartingPosition]:{[f.APIEvents.SelectNode]:selectNode,[f.APIEvents.Move]:function makeMove({component:e,event:t}){const{api:n,dom:a}=e;return n.getMoveNode({line:t.ids.line,move:t.ids.move})?(n.selectNode({line:t.ids.line,move:t.ids.move}),$r.MiddleOfLineSelected):0!==t.ids.line?(a.insertVariation({node:t}),$r.EndOfLineSelected):(a.insertNode({node:t}),$r.EndOfLineSelected)}},[$r.EndOfLineSelected]:{[f.APIEvents.SelectNode]:selectNode,[f.APIEvents.Move]:function makeMove({component:e,event:t}){const{api:n,dom:a}=e;return a.insertNode({node:t,nodeToInsertAfter:n.getSelectedNode()}),$r.EndOfLineSelected}},[$r.MiddleOfLineSelected]:{[f.APIEvents.SelectNode]:selectNode,[f.APIEvents.Move]:function makeMove({component:e,event:t}){const{api:n,dom:a}=e;return n.getMoveNode({line:t.ids.line,move:t.ids.move})?(n.selectNode({line:t.ids.line,move:t.ids.move}),$r.MiddleOfLineSelected):(a.insertVariation({node:t}),$r.EndOfLineSelected)}}}}}())}(function(e){e.AddMove="AddMove",e.AnalysisEnd="AnalysisEnd",e.AnalysisStart="AnalysisStart"})((Ir=Rr||(Rr={})).APIEvents||(Ir.APIEvents={})),function(e){e.Name="observing"}(Ir.Plugin||(Ir.Plugin={})),Nr=Lr||(Lr={}),(Dr=Nr.Placeholders||(Nr.Placeholders={})).GameResult="game-result",Dr.Moves="moves",(Br=Nr.ClassNames||(Nr.ClassNames={})).Component="horizontal-move-list",Br.MainLine="main",Br.Variation="variation",Nr.ComponentIdentifier="data-id",function(e){e.Copy="copy"}(Nr.Events||(Nr.Events={})),(Fr=Nr.VariationParenthesis||(Nr.VariationParenthesis={})).Before="(",Fr.After=")",(jr=Nr.NodeLimitTypes||(Nr.NodeLimitTypes={})).Begin="begin",jr.Focus="focus",jr.End="end",function(e){e.EndOfLineSelected="EndOfLineSelected",e.MiddleOfLineSelected="MiddleOfLineSelected",e.StartingPosition="StartingPosition"}($r||($r={}));const Hr={condition:function condition$a({event:e}){return function match2(){return e.type===f.APIEvents.AddMove}},handler:function handler$a({context:e,event:t}){const{moveList:n}=e,{listMove:a}=t.data;if(!(null==a?void 0:a.ids))return;const l=n.api.getMoveNode({line:0,move:a.ids.move-1});n.dom.insertNode({node:a,nodeToInsertAfter:l})}};const Vr={condition:function condition$9({event:e}){return function match2(){return e.type===f.APIEvents.CreateContinuation}},handler:function handler$9({context:e,event:t,selectedNode:n}){const{moveList:a,methods:{selectCurrentPosition:l}}=e;if(a.dom.insertVariation({node:t.data.node}),a.api.getMoveNode(t.data.node.ids))return void a.api.selectNode(t.data.node.ids);l(n)}};const Ur={condition:function condition$8({event:e}){return function match2(){return f.APIEvents.UpdatePGNHeaders===e.type&&e.data.Result}},handler:function handler$8({context:e,coreContext:t}){const{moveList:n}=e;n.dom.setResultNode(t.api.getResult())}};var Gr,qr;function isEditingComment(e){return Boolean(e.getElement().querySelector((0,x.t)(Gr.Classes.Component)))}(function(e){e.FocusOut="comment-field-focus-out",e.CommentChanged="comment-has-changed"})((qr=Gr||(Gr={})).Events||(qr.Events={})),function(e){e.Component="editable-comment"}(qr.Classes||(qr.Classes={})),function(e){e[e.CommentUpdateDelay=500]="CommentUpdateDelay"}(qr.Constants||(qr.Constants={}));const Wr={condition:function condition$7({event:e}){return function match2(){return e.type===f.APIEvents.LineCommentUpdated}},handler:function handler$7({context:e,event:t}){const{moveList:n}=e,{data:a}=t;if(isEditingComment(n.dom))return;n.dom.updateLineComponent(a.lineId,{initComment:a.comment})}};const zr={condition:function condition$6({event:e}){return function match2(){return[f.APIEvents.CreateGame,f.APIEvents.CreateContinuation,f.APIEvents.DeletePosition,f.APIEvents.Load,f.APIEvents.MoveVariation,f.APIEvents.PromoteVariation,f.APIEvents.ResetToMainLine].includes(e.type)||e.data.linesReordered}},handler:function handler$6({context:e,coreContext:t}){const{moveList:n,methods:{destroyContextMenu:a},queue:l}=e,{api:f}=t;a(),l.flush(),n.dom.load(),n.dom.setResultNode(f.getResult())}};const Kr={condition:function condition$5({event:e}){return function match2(){return e.type===f.APIEvents.Move}},handler:function handler$5({context:e,event:t,selectedNode:n}){const{moveList:a,stateMachine:l,methods:{selectCurrentPosition:p}}=e;if(a.api.getMoveNode(t.data.move.ids))return void a.api.selectNode(t.data.move.ids);l.transition(f.APIEvents.Move,{component:a,event:t.data.move,selectedNode:n}),p(n)}};const Zr={condition:function condition$4({event:e}){return function match2(){return e.type===f.APIEvents.NodeUpdated}},handler:function handler$4({context:e,event:t}){const{moveList:n}=e,{data:a}=t;if(isEditingComment(n.dom))return;if(!a.ids)return;n.dom.updateMoveNodeComponent(a.ids,a.changes)}};const Qr={condition:function condition$3({event:e}){return function match2(){return[f.APIEvents.ResetToMainLine].includes(e.type)}},handler:function handler$3({context:e}){const{moveList:t}=e;t.dom.load()}};const Xr={condition:function condition$2({event:e}){return function match2(){return e.type===f.OptionsEvents.Update}},handler:function handler$2({coreContext:e,context:t,event:n}){const{el:a,moveList:l,methods:{destroyContextMenu:f}}=t,p=e.api.getOptions();l.api.setOptions(n.data),p.test&&setTestData(a,{[Bt.Editable]:n.data.moveListContextMenuEnabled});!1===n.data.moveListContextMenuEnabled&&f()}};const Yr={condition:function condition$1({event:e}){return function match2(){return e.type===f.APIEvents.MoveForward||e.type===f.APIEvents.MoveBackward||e.type===f.APIEvents.SelectLineEnd||e.type===f.APIEvents.SelectLineStart||e.type===f.APIEvents.SelectNode||e.type===f.APIEvents.ResetToMainLine}},handler:function handler$1({context:e,selectedNode:t}){const{methods:{selectCurrentPosition:n}}=e;n(t)}};var Jr,eo,to,ro,oo,io,ao,so,co,lo,uo,fo,po,ho;(function(e){e.ClearAnalysis="ClearAnalysis",e.DeleteComment="DeleteComment",e.DeleteCommentBefore="DeleteCommentBefore",e.DeleteMove="DeleteMove",e.DeleteVariation="DeleteVariation",e.InsertComment="InsertComment",e.InsertCommentBefore="InsertCommentBefore",e.InsertContinuation="InsertContinuation",e.MoveVariationDown="MoveVariationDown",e.MoveVariationUp="MoveVariationUp",e.PromoteVariation="PromoteVariation",e.RemoveAnnotation="RemoveAnnotation",e.RemoveBegin="RemoveBegin",e.RemoveEnd="RemoveEnd",e.RemoveAdditionalAnnotation="RemoveAdditionalAnnotation",e.RemoveFocus="RemoveFocus",e.SetBegin="SetBegin",e.SetEnd="SetEnd",e.SetFocus="SetFocus"})((eo=Jr||(Jr={})).Actions||(eo.Actions={})),(to=eo.AnnotationActions||(eo.AnnotationActions={})).AddAnnotation="AddAnnotation",to.AddAdditionalAnnotation="AddAdditionalAnnotation",function(e){e.Actions="actions",e.Translations="translations"}(eo.Keys||(eo.Keys={})),function(e){e.ActionClicked="action-clicked",e.AnnotationClicked="annotation-clicked",e.Close="close-context-menu"}(eo.Events||(eo.Events={})),function(e){e.Name="contextMenu"}(eo.Plugin||(eo.Plugin={})),function(e){e.ActionName="action-name",e.Annotation="annotation",e.AnnotationsContainer="annotations-container",e.Component="move-node-context-menu",e.Divider="divider"}((oo=ro||(ro={})).Classes||(oo.Classes={})),function(e){e.Annotation="annotation",e.CustomColor="customColor",e.id="id",e.MoveNumber="moveNumber",e.San="san",e.Selected="selected"}((ao=io||(io={})).Keys||(ao.Keys={})),(so=ao.TouchableKeys||(ao.TouchableKeys={})).Annotation="annotation",so.CustomColor="customColor",so.MoveNumber="moveNumber",so.San="san",function(e){e.Comment="comment",e.GameResultNode="game-result-node",e.IconFont="icon-font-chess",e.MoveNode="move-node",e.MoveNumber="move-number",e.MoveText="move-text",e.Selected="selected",e.StaticComment="static-comment"}((lo=co||(co={})).Classes||(lo.Classes={})),function(e){e[e.TouchDelay=500]="TouchDelay"}(lo.Constants||(lo.Constants={})),function(e){e.Click="click",e.OpenContextMenu="contextmenu"}(lo.Events||(lo.Events={}));class ChessError extends Error{constructor({code:e,message:t,data:n}){super(t),this.code=e,this.data=n,this.message=t,this.name="ChessError"}}(fo=uo||(uo={})).BadData="Bad Data",fo.BeforeStateHooksConflict="Before State hooks conflict",fo.DOMDoesNotMatchJCE="DOM Does Not Match JCE",fo.ElementAlreadyExists="Element Already Exists",fo.ElementNotFound="Element Not Found",fo.IllegalJCECall="Illegal JCE Call",fo.IncorrectMode="Incorrect Mode",fo.InvalidStateMachine="Invalid State Machine",fo.MissingPluginDependency="Missing Plugin Dependency",(ho=po||(po={}))[ho.MainLine=0]="MainLine",ho[ho.MainLineChild=-1]="MainLineChild",ho[ho.Parent=1]="Parent";const mo={[Jr.Actions.InsertCommentBefore]:function createInsertCommentBeforeAction(){return{action:Jr.Actions.InsertCommentBefore,handler:function handler2(e,{moveList:t,context:n}){const{game:a}=n;let l=e;const f=a.getLine(e.ids.line);l=0===e.ids.move&&f?f:a.getNodeByIds(e.previous);t.dom.insertEditableComment(l)},isVisible:function isVisible({api:e,node:t}){if(0===t.ids.move){const n=e.getLine(t.ids.line);return!n||!n.initComment}const n=e.getNodeByIds(t.previous);return isNode(n)&&!n.comment},name:_r.Translation.Actions.InsertCommentBefore}}(),[Jr.Actions.InsertComment]:function createInsertCommentAction(){return{action:Jr.Actions.InsertComment,handler:function handler2(e,{moveList:t}){t.dom.insertEditableComment(e)},isVisible:function isVisible({node:e}){return void 0===e.comment},name:_r.Translation.Actions.InsertCommentAfter}}(),[Jr.Actions.DeleteCommentBefore]:function createDeleteCommentBeforeAction(){return{action:Jr.Actions.DeleteCommentBefore,handler:function handler2(e,{context:{game:t},moveList:n,moveNodeComponent:a}){let l=e;const f=t.getLine(e.ids.line);f&&0===e.ids.move?(l=f,t.updateLineComment(void 0,f.id)):(l=t.getNodeByIds(e.previous),t.updateNode(l.ids,{comment:void 0}),a.touch(io.TouchableKeys.MoveNumber));n.dom.removeComment(l)},isVisible:function isVisible({api:e,node:t}){if(0===t.ids.move){const n=e.getLine(t.ids.line);return Boolean(n&&n.initComment)}const n=e.getNodeByIds(t.previous);return isNode(n)&&Boolean(n.comment)},name:_r.Translation.Actions.DeleteCommentBefore}}(),[Jr.Actions.DeleteComment]:function createDeleteCommentAction(){return{action:Jr.Actions.DeleteComment,handler:function handler2(e,{context:{game:t},moveList:n,moveNodeComponent:a}){t.updateNode(e.ids,{comment:void 0}),n.dom.removeComment(e),a.touchNextNode()},isVisible:function isVisible({node:e}){return"string"==typeof e.comment},name:_r.Translation.Actions.DeleteCommentAfter}}(),[Jr.Actions.RemoveAnnotation]:function createRemoveAnnotationAction(){return{action:Jr.Actions.RemoveAnnotation,handler:function handler2(e,{context:{game:t},moveNodeComponent:n}){t.updateNode(e.ids,{annotation:void 0}),n.touch(io.TouchableKeys.Annotation)},isVisible:function isVisible({node:e}){return Boolean(e.annotation)},name:_r.Translation.Actions.RemoveAnnotation}}(),[Jr.Actions.RemoveAdditionalAnnotation]:function createRemoveAdditionalAnnotationAction(){return{action:Jr.Actions.RemoveAdditionalAnnotation,handler:function handler2(e,{context:{game:t},moveNodeComponent:n}){t.updateNode(e.ids,{additionalAnnotation:void 0}),n.touch(io.TouchableKeys.Annotation)},isVisible:function isVisible({node:e}){return Boolean(e.additionalAnnotation&&e.additionalAnnotation.length>0)},name:_r.Translation.Actions.RemoveEvaluationAnnotation}}(),[Jr.Actions.DeleteVariation]:function createDeleteVariationAction(){return{action:Jr.Actions.DeleteVariation,handler:function handler2(e,{context:{game:t},moveList:n}){t.deletePosition(-1,e.ids.line),n.dom.load()},isVisible:function isVisible({node:e}){return 0!==e.ids.line},name:_r.Translation.Actions.DeleteLine}}(),[Jr.Actions.DeleteMove]:function createDeleteMoveAction(){return{action:Jr.Actions.DeleteMove,handler:function handler2(e,{context:{game:t}}){t.deletePosition(e.ids.move,e.ids.line)},isVisible:function isVisible({api:e,node:t}){if(0===t.ids.line)return e.getMode().getOptions().canModifyExistingMovesOnMainLine;return!0},name:_r.Translation.Actions.DeleteMove}}(),[Jr.Actions.PromoteVariation]:function createPromoteVariationAction(){return{action:Jr.Actions.PromoteVariation,handler:function handler2(e,{context:{game:t}}){t.promoteVariation(e.ids.line,po.Parent)},isVisible:function isVisible({api:e,node:t}){const n=t.ids.line;if(0===n)return!1;const a=e.getLine(n);if(!a)return!1;if(0===a.parentId){const{canAddMovesToMainLine:t,canModifyExistingMovesOnMainLine:n}=e.getMode().getOptions();return t&&n}return!0},name:_r.Translation.Actions.Promote}}(),[Jr.Actions.MoveVariationDown]:function createMoveVariationDownAction(){return{action:Jr.Actions.MoveVariationDown,handler:function handler2(e,{context:{game:t}}){t.moveVariation(e.ids.line,!1)},isVisible:function isVisible({api:e,node:t}){if(0===t.ids.line)return!1;const n=e.getLine(t.ids.line);if(!n)return!1;const a=e.getNodeByIds({line:n.parentId,move:n.atMoveNode});if(a.lines&&a.lines.length>1)return!function isOnLastLineOfParentNode(e,t){return!!t.lines&&e.ids.line===t.lines[t.lines.length-1]}(t,a);return!1},name:_r.Translation.Actions.MoveVariationDown}}(),[Jr.Actions.MoveVariationUp]:function createMoveVariationUpAction(){return{action:Jr.Actions.MoveVariationUp,handler:function handler2(e,{context:{game:t}}){t.moveVariation(e.ids.line,!0)},isVisible:function isVisible({api:e,node:t}){if(0===t.ids.line)return!1;const n=e.getLine(t.ids.line);if(!n)return!1;const a=e.getNodeByIds({line:n.parentId,move:n.atMoveNode});if(a.lines&&a.lines.length>1)return!function isOnFirstLineOfParentNode(e,t){return!!t.lines&&e.ids.line===t.lines[0]}(t,a);return!1},name:_r.Translation.Actions.MoveVariationUp}}(),[Jr.Actions.InsertContinuation]:function createInsertContinuationAction(){return{action:Jr.Actions.InsertContinuation,handler:function handler2(e,{context:{game:t}}){t.createContinuation()},isVisible:function isVisible({api:e,node:t}){const n=e.getRawLines();return t.ids.move===n[t.ids.line].length-1},name:_r.Translation.Actions.InsertContinuation}}(),[Jr.Actions.ClearAnalysis]:function createClearAnalysisAction(){return{action:Jr.Actions.ClearAnalysis,handler:function handler2(e,{context:{game:t},event:n,moveList:a}){t.hml.contextMenu.requestConfirmation({action:function onConfirmation(){const n=Object.keys(a.api.getNodes()),l=t.getLine(0);if(!l)return;const f={};if(n.length>1)for(let e=n.length-1;e>0;e--){const n=t.getLine(e);if(!n)return;a.dom.removeLine(n),0===n.parentId&&(f[n.atMoveNode]=!0)}Object.keys(a.api.getComments()).forEach((e=>{a.api.getComments()[e].destroy()})),t.resetToMainLine(),l.forEach((n=>{var l,p;const h=[];let m=!1;if(f[n.ids.move]&&h.push(io.TouchableKeys.MoveNumber),(n.annotation||n.additionalAnnotation)&&h.push(io.TouchableKeys.Annotation),n.comment&&n.color===qn.ColorsAsNumbers.White&&(m=!0),t.updateNode(n.ids,{additionalAnnotation:void 0,annotation:void 0,comment:void 0}),null==(l=e.commands)||delete l.href,null==(p=e.commands)||delete p.text,Object.keys(h).length>0||m){const t=a.api.getMoveNode(n.ids);if(!t)throw new ChessError({code:uo.ElementNotFound,data:e,message:"No move node found."});h.forEach((e=>{t.touch(e)})),t.touchNextNode()}})),l.initComment&&t.updateLineComment(void 0,l.id)},data:{event:n},text:"Are you sure you want to clear all analysis?",type:Jr.Actions.ClearAnalysis})},isVisible:()=>!0,name:_r.Translation.Actions.ClearAllAnalysis}}()};function createContextMenuAPI(e){return function createConfirmations(e){const t=new Map;let n=e;return{cancelConfirmation:cancelConfirmation,cancelAllConfirmations:function cancelAllConfirmations(){t.clear()},confirmAction:confirmAction,registerConfirmationCallback:function registerConfirmationCallback(e){n=e},requestConfirmation:async function requestConfirmation(e){const{action:a,data:l,text:f,type:p}=e;return t.set(p,a),n?await n({data:l,text:f,type:p})?confirmAction(p):cancelConfirmation(p):window.confirm(f)?confirmAction(p):void cancelConfirmation(p)}};function cancelConfirmation(e){t.delete(e)}function confirmAction(e){var n;null==(n=t.get(e))||n(),t.delete(e)}}(e)}function createContextMenuPlugin(e){return{api:()=>createContextMenuAPI(e),destroy:function destroy10(e){if(!e)return;e.game.hml.contextMenu.cancelAllConfirmations()},name:Jr.Plugin.Name}}function createGetContextMenuActions(e){return function getContextMenuActions(t){const{contextMenuActions:n,game:a}=e,l=a.getNodeByIds(t);if(!isNode(l))throw new ChessError({code:uo.BadData,data:t,message:"No move node found"});const f=[];return Object.values(n).forEach((t=>{if(!t)return;t.isVisible({api:a,node:l,options:a.getOptions(),state:e.state})&&f.push(t)})),f}}function createGetMoveNodeMethod(e){return function getMoveNode({line:t,move:n}){const{state:a}=e;return a.nodes[t]&&e.state.nodes[t][n]}}function createResetSelectedNode(e){return function resetSelectedNode(){const{state:t}=e;t.selectedNode&&(t.selectedNode.set({[io.Keys.Selected]:!1}),t.selectedNode=void 0)}}function createSelectLineStart$1(e){return function selectLineStart(t){const{api:n,stateMachine:a}=e;n.resetSelectedNode(),a.transition(f.APIEvents.SelectNode,{lines:n.getNodes(),node:t})}}function getLineElement(e,t){return t.querySelector(`[${Lr.ComponentIdentifier}="line-${e}"]`)}function forceNextFrame(e,t=[]){requestAnimationFrame((()=>{requestAnimationFrame((()=>{e(...t)}))}))}function createSelectNodeMethod(e){return function selectNode2({line:t,move:n}){const{api:a,el:l,scrollContainer:p,state:h,stateMachine:m}=e;if(void 0===t||void 0===n)return;a.resetSelectedNode();const g=a.getMoveNode({line:t,move:n});g&&(g.set({[io.Keys.Selected]:!0}),h.selectedNode=g,m.transition(f.APIEvents.SelectNode,{lines:a.getNodes(),node:h.selectedNode.getNodeData()}),forceNextFrame((()=>{l.classList.contains(Lr.ClassNames.Component)&&(0===g.ids.line||getLineElement(g.ids.line,l))&&function scrollToNode({containerEl:e,moveNode:t,moveListEl:n}){let a;try{a=t.getElement()}catch(l){}a&&scrollToNode$1({containerEl:e,moveListEl:n,nodeEl:a})}({containerEl:p,moveListEl:l,moveNode:g})})))}}function setMoveListDisplayType(e){!function forEachNode(e,t){Object.keys(e).forEach((n=>{(Object.keys(e[n])||[]).forEach((a=>{t(e[n][a])}))}))}(e.api.getNodes(),(function touchSan2(e){e.touch(io.TouchableKeys.San)}))}function setMoveListContextMenuEnabled(e){const t=e.state.comments;Object.keys(t).forEach((n=>{t[n][e.options.moveListContextMenuEnabled?"registerClickListeners":"deregisterClickListeners"]()}))}function createSetOptionsMethod(e){const t={moveListContextMenuEnabled:setMoveListContextMenuEnabled,moveListDisplayType:setMoveListDisplayType};return function setOptions(n){Object.keys(e.options).forEach((a=>{if(!(a in n))return;const l=e.options[a]!==n[a];e.options[a]=n[a],l&&t[a]&&t[a](e)}))}}var go;function create_if_block$1(e){let t,n,a;return{c(){t=(0,x.f)("span"),n=(0,x.h)(e[2]),(0,x.j)(t,"class",a=(0,x.n)(co.Classes.MoveNumber)+" svelte-10qut0i")},m(e,a){(0,x.k)(e,t,a),(0,x.m)(t,n)},p(e,t){4&t&&(0,x.o)(n,e[2])},d(e){e&&(0,x.q)(t)}}}function create_fragment$3(e){let t,n,a,l,f,p,h,m,g=(e[4]||"")+"",v=e[2]&&create_if_block$1(e);return{c(){t=(0,x.f)("span"),v&&v.c(),n=(0,x.r)(),a=(0,x.f)("span"),l=new x.H,f=(0,x.u)(),p=new x.H,l.a=f,p.a=null,(0,x.j)(a,"class",(0,x.n)(co.Classes.MoveText)+" svelte-10qut0i"),(0,x.j)(t,"data-id",e[1]),(0,x.j)(t,"class",(0,x.n)(co.Classes.MoveNode)+" svelte-10qut0i"),(0,x.v)(t,"customColor",e[0]),(0,x.v)(t,"selected",e[5])},m(y,_){(0,x.k)(y,t,_),v&&v.m(t,null),(0,x.m)(t,n),(0,x.m)(t,a),l.m(e[3],a),(0,x.m)(a,f),p.m(g,a),h||(m=[(0,x.w)(t,"click",e[7]),(0,x.w)(t,"contextmenu",e[6]),(0,x.w)(t,"touchstart",e[8]),(0,x.w)(t,"touchend",e[9],{passive:!0})],h=!0)},p(e,[a]){e[2]?v?v.p(e,a):(v=create_if_block$1(e),v.c(),v.m(t,n)):v&&(v.d(1),v=null),8&a&&l.p(e[3]),16&a&&g!==(g=(e[4]||"")+"")&&p.p(g),2&a&&(0,x.j)(t,"data-id",e[1]),1&a&&(0,x.v)(t,"customColor",e[0]),32&a&&(0,x.v)(t,"selected",e[5])},i:x.x,o:x.x,d(e){e&&(0,x.q)(t),v&&v.d(),h=!1,(0,x.y)(m)}}}function instance$3(e,t,n){const a=(0,x.z)();let l,{customColor:f}=t,{id:p}=t,{moveListEl:h}=t,{moveNumber:m}=t,{san:g}=t,{annotation:v}=t,{selected:y}=t;function dispatchContextMenu(e){e.preventDefault(),a(co.Events.OpenContextMenu)}function handleNodeClick(e){a(co.Events.Click)}return e.$$set=e=>{"customColor"in e&&n(0,f=e.customColor),"id"in e&&n(1,p=e.id),"moveListEl"in e&&n(10,h=e.moveListEl),"moveNumber"in e&&n(2,m=e.moveNumber),"san"in e&&n(3,g=e.san),"annotation"in e&&n(4,v=e.annotation),"selected"in e&&n(5,y=e.selected)},e.$$.update=()=>{1&e.$$.dirty&&function updateNodeColorVariables(e){const t=h.querySelector(`[${Lr.ComponentIdentifier}="${p}"]`);t&&addCustomColor(t,e)}(f)},[f,p,m,g,v,y,dispatchContextMenu,handleNodeClick,function handleTouchStart(e){handleNodeClick(),l=setTimeout((()=>{dispatchContextMenu(e),l=null}),co.Constants.TouchDelay)},function handleTouchEnd(){l&&clearTimeout(l)},h]}class Move_node extends x.b{constructor(e){super(),(0,x.i)(this,e,instance$3,create_fragment$3,x.d,{customColor:0,id:1,moveListEl:10,moveNumber:2,san:3,annotation:4,selected:5})}}function createSvelteComponent({ComponentType:e,methods:t,options:n,replaceContainer:a=!0}){const l=a?function replaceContainer(e,t){const n=document.createDocumentFragment(),a=new e(Object.assign({},t,{target:n}));return t.target.replaceWith(n),a}(e,n):new e(n),f={destroy:function destroy10(){l.$destroy()},el:n.target,get:function get2(e){if("string"==typeof e)return l.$$.ctx[e];return(0,x.A)(l.$$.ctx,e)},instance:l,on:function on(e,t){l.$on(e,t)},set:function set3(e){l.$set(e)}};return t&&t.length&&t.forEach((e=>{f[e]=l[e]})),f}function isNagFormat(e){return Boolean(e&&"$"===e.charAt(0))}!function(e){var t,n;(t=e.Nags||(e.Nags={})).$1="$1",t.$2="$2",t.$3="$3",t.$4="$4",t.$5="$5",t.$6="$6",t.$10="$10",t.$11="$11",t.$12="$12",t.$13="$13",t.$14="$14",t.$15="$15",t.$16="$16",t.$17="$17",t.$18="$18",t.$19="$19",t.$22="$22",t.$36="$36",t.$40="$40",t.$146="$146",t.$256="$256",(n=e.Values||(e.Values={})).$1="!",n.$2="?",n.$3="!!",n.$4="??",n.$5="!?",n.$6="?!",n.$10="=",n.$11="=",n.$12="=",n.$13="",n.$14="",n.$15="",n.$16="",n.$17="",n.$18="+-",n.$19="-+",n.$22="",n.$40="",n.$146="N",n.$256="=/"}(go||(go={}));const vo={$1:"!",$2:"?",$3:"!!",$4:"??",$5:"!?",$6:"?!",$10:"=",$11:"=",$12:"=",$13:"",$14:"",$15:"",$16:"",$17:"",$18:"+-",$19:"-+",$22:"",$23:"",$32:"",$33:"",$36:"",$37:"",$40:"",$41:"",$44:"/=",$45:"=/",$132:"",$133:"",$146:"N",$256:"=/"},yo=(0,x.B)(vo),_o=[{action:Jr.AnnotationActions.AddAnnotation,code:go.Nags.$1,display:vo.$1,meaning:_r.Translation.Annotations.GoodMove},{action:Jr.AnnotationActions.AddAnnotation,code:go.Nags.$2,display:vo.$2,meaning:_r.Translation.Annotations.BadMove},{action:Jr.AnnotationActions.AddAnnotation,code:go.Nags.$3,display:vo.$3,meaning:_r.Translation.Annotations.ExcellentMove},{action:Jr.AnnotationActions.AddAnnotation,code:go.Nags.$4,display:vo.$4,meaning:_r.Translation.Annotations.Blunder},{action:Jr.AnnotationActions.AddAnnotation,code:go.Nags.$5,display:vo.$5,meaning:_r.Translation.Annotations.SpeculativeMove},{action:Jr.AnnotationActions.AddAnnotation,code:go.Nags.$6,display:vo.$6,meaning:_r.Translation.Annotations.DubiousMove},{action:Jr.AnnotationActions.AddAdditionalAnnotation,code:go.Nags.$10,display:vo.$10,meaning:_r.Translation.Annotations.Drawish},{action:Jr.AnnotationActions.AddAdditionalAnnotation,code:go.Nags.$13,display:vo.$13,meaning:_r.Translation.Annotations.Unclear},{action:Jr.AnnotationActions.AddAdditionalAnnotation,code:go.Nags.$14,display:vo.$14,meaning:_r.Translation.Annotations.WhiteHasSlightAdvantage},{action:Jr.AnnotationActions.AddAdditionalAnnotation,code:go.Nags.$15,display:vo.$15,meaning:_r.Translation.Annotations.BlackHasSlightAdvantage},{action:Jr.AnnotationActions.AddAdditionalAnnotation,code:go.Nags.$16,display:vo.$16,meaning:_r.Translation.Annotations.WhiteHasModerateAdvantage},{action:Jr.AnnotationActions.AddAdditionalAnnotation,code:go.Nags.$17,display:vo.$17,meaning:_r.Translation.Annotations.BlackHasModerateAdvantage},{action:Jr.AnnotationActions.AddAdditionalAnnotation,code:go.Nags.$18,display:vo.$18,meaning:_r.Translation.Annotations.WhiteHasDecisiveAdvantage},{action:Jr.AnnotationActions.AddAdditionalAnnotation,code:go.Nags.$19,display:vo.$19,meaning:_r.Translation.Annotations.BlackHasDecisiveAdvantage},{action:Jr.AnnotationActions.AddAdditionalAnnotation,code:go.Nags.$22,display:vo.$22,meaning:_r.Translation.Annotations.PositionInZuqZwang},{action:Jr.AnnotationActions.AddAdditionalAnnotation,code:go.Nags.$36,display:vo.$36,meaning:_r.Translation.Annotations.WithInitiative},{action:Jr.AnnotationActions.AddAdditionalAnnotation,code:go.Nags.$40,display:vo.$40,meaning:_r.Translation.Annotations.WithCompensation},{action:Jr.AnnotationActions.AddAdditionalAnnotation,code:go.Nags.$146,display:vo.$146,meaning:_r.Translation.Annotations.Novelty},{action:Jr.AnnotationActions.AddAdditionalAnnotation,code:go.Nags.$256,display:vo.$256,meaning:_r.Translation.Annotations.WithAttack}];function normalizeAnnotation(e){return e&&(Object.prototype.hasOwnProperty.call(vo,e)||Object.prototype.hasOwnProperty.call(yo,e))?isNagFormat(e)?vo[e]:normalizeAnnotation(yo[e]):e||""}function generateAnnotationString(e){let t="";return e.annotation&&(t=`${t}${normalizeAnnotation(e.annotation)}`),e.additionalAnnotation&&e.additionalAnnotation[0]&&(t=`${t}&nbsp;${normalizeAnnotation(e.additionalAnnotation[0])}`),t}function getNodeDisplayNumber({node:e,previous:t,startingMoveNumber:n=1}){let a="";if(!e)return a;const l=function getMoveNumber$1({color:e,ply:t,startingMoveNumber:n=1}){let a;return a=e===qn.ColorsAsNumbers.White?Math.ceil(t/2+1):Math.floor(t/2+1),a+(n-1)}({color:e.color,ply:e.moveNumber,startingMoveNumber:n});return function shouldShowDisplayNumber(e,t){return Boolean(e.color===qn.ColorsAsNumbers.White||e.ids&&0===e.ids.move||t&&"string"==typeof t.comment||t&&t.lines&&t.lines.length)}(e,t)&&(a+=`${l}.`,function shouldShowEllipsisOnBlackMoveNumber(e,t){return Boolean(e.color===qn.ColorsAsNumbers.Black&&(t&&"string"==typeof t.comment||t&&t.lines&&t.lines.length||e.ids&&0===e.ids.move))}(e,t)&&(a+="..")),a}const bo={[io.Keys.MoveNumber]:function touchMoveNumber({game:e,node:t}){return getNodeDisplayNumber({node:t,previous:(null==t?void 0:t.previous)?e.getNodeByIds(t.previous):void 0,startingMoveNumber:e.getStartingMoveNumber()})},[io.Keys.Annotation]:function touchAnnotations({node:e}){return generateAnnotationString(e)},[io.Keys.CustomColor]:function touchCustomColor({node:e}){return e.customColor},[io.Keys.San]:function touchSan({moveList:e,node:t,translations:n}){return formatText({color:getColorAsWord(null==t?void 0:t.color),moveListDisplayType:e.getOptions().moveListDisplayType,san:null==t?void 0:t.san,translations:n})}};function createMoveNode({moveList:e,game:t,node:n,options:a,emitter:l,translations:f}){if(isLine(n))throw new ChessError({code:uo.BadData,data:n,message:"Invalid move ids."});const p=function createMoveNodeComponent(e,{anchor:t,props:n}){return createSvelteComponent({ComponentType:Move_node,options:{anchor:t,props:n,target:e},replaceContainer:!1})}(a.target,{anchor:a.anchor,props:{annotation:generateAnnotationString(n),id:getId(),moveListEl:e.dom.getElement(),moveNumber:bo[io.Keys.MoveNumber](createTouchContext()),san:bo[io.Keys.San](createTouchContext()),selected:!1}}),h={addNodeStyles:function addNodeStyles(e){const t=getElement();e&&Object.assign(t.style,e)},destroy:p.destroy,getElement:getElement,getId:getId,getNodeData:getNodeData,ids:n.ids,insertBeforeNode:function insertBeforeNode(e){const t=getElement();t.parentNode&&t.parentNode.insertBefore(e,t)},insertAfterNode:function insertAfterNode(t){const n=e.dom.getElement(),a=getElement();a.nextElementSibling?n.insertBefore(t,a.nextElementSibling):n.appendChild(t)},removeNodeStyles:function removeNodeStyles(){getElement().removeAttribute("style")},set:p.set,touch:function touch(e){p.set({[e]:bo[e](createTouchContext())})},touchNextNode:function touchNextNode(t=[io.TouchableKeys.MoveNumber]){const a=e.api.getMoveNode({line:n.ids.line,move:n.ids.move+1});a&&t.forEach((e=>a.touch(e)))}};return function registerComponentListeners(){p.on(co.Events.Click,(function selectNode2(){t.selectNode(n.ids.line,n.ids.move)})),p.on(co.Events.OpenContextMenu,(function emitContextMenuOpen(){e.api.getOptions().moveListContextMenuEnabled&&(t.selectNode(n.ids.line,n.ids.move),l.emit(co.Events.OpenContextMenu,{node:n}))}))}(),h;function createTouchContext(){return{game:{getNodeByIds:t.getNodeByIds,getStartingMoveNumber:t.getStartingMoveNumber},moveList:{getOptions:e.api.getOptions},node:getNodeData(),translations:f}}function getElement(){var t;const a=e.dom.getElement(),l=`[${Lr.ComponentIdentifier}="${getId()}"]`,f=null!=(t=a.querySelector(l))?t:p.el.querySelector(l);if(!f)throw new ChessError({code:uo.ElementNotFound,data:n.ids,message:`Move node element was not found for ${n.ids.line}-${n.ids.move}.`});return f}function getId(){const e=n.ids;return`move-node-${e.line}-${e.move}`}function getNodeData(){return t.getNodeByIds(n.ids)}}function createAddNodeMethod(e){return function addNode(t,n){var a;const{game:l,getComponent:f,state:p,stateMachine:h,translations:m}=e,g=t.ids;return void 0===p.nodes[g.line]&&(p.nodes[g.line]={}),void 0!==p.nodes[g.line][g.move]&&p.nodes[g.line][g.move].destroy(),p.nodes[g.line][g.move]=createMoveNode({emitter:h,game:l,moveList:null!=(a=f())?a:e.el,node:t,options:n,translations:m}),p.nodes[g.line][g.move]}}function disableContextMenu(e){e.preventDefault()}function createDestroyMethod(e){return function destroy10(){const{dom:t,el:n,queue:a}=e;n.classList.remove(Lr.ClassNames.Component),n.removeEventListener("contextmenu",disableContextMenu),t.reset(),a.clear()}}function stripHTMLTags(e,t){if(t){const t=["br"],n=t.map((e=>`\\/${e}`)),a=t.concat(n).join("|"),l=new RegExp(`<(?!${a}s*/?)[^>]+>`,"g");return e.replace(l,"")}return e.replace(/<\/?[^>]+(>|$)/g,"")}function cleanCommentString(e){let t;return t=function decodeHTMLEntities(e){const t=document.createElement("textarea");return t.innerHTML=e.replace(/&nbsp;/g," "),t.value}(stripHTMLTags(e))," "===t&&(t=""),t}function create_fragment$2(e){let t,n,a,l,f;return{c(){t=(0,x.f)("span"),n=(0,x.h)(e[2]),(0,x.j)(t,"class",(0,x.n)(Gr.Classes.Component)+" svelte-17mydln"),(0,x.j)(t,"contenteditable","true"),(0,x.j)(t,"placeholder",a=e[0]["Add Comment..."]())},m(a,p){(0,x.k)(a,t,p),(0,x.m)(t,n),e[7](t),l||(f=[(0,x.w)(t,"focusin",e[3]),(0,x.w)(t,"focusout",e[4]),(0,x.w)(t,"input",e[5])],l=!0)},p(e,[l]){4&l&&(0,x.o)(n,e[2]),1&l&&a!==(a=e[0]["Add Comment..."]())&&(0,x.j)(t,"placeholder",a)},i:x.x,o:x.x,d(n){n&&(0,x.q)(t),e[7](null),l=!1,(0,x.y)(f)}}}function instance$2(e,t,n){let a;const l=(0,x.z)();let f,{comment:p=""}=t,{translations:h}=t;return(0,x.C)((()=>{f.focus()})),e.$$set=e=>{"comment"in e&&n(6,p=e.comment),"translations"in e&&n(0,h=e.translations)},e.$$.update=()=>{64&e.$$.dirty&&n(2,a=p||"")},[h,f,a,function selectCommentText(){p&&document.execCommand("selectAll",!1,null)},function handleFocusOut(){l(Gr.Events.FocusOut,f.innerHTML)},function handleInput(){l(Gr.Events.CommentChanged,f.innerHTML)},p,function span_binding(e){x.D[e?"unshift":"push"]((()=>{f=e,n(1,f)}))}]}class Editable_comment extends x.b{constructor(e){super(),(0,x.i)(this,e,instance$2,create_fragment$2,x.d,{comment:6,translations:0})}}function getLineEditableCommentConfig(e,{moveList:t,api:n}){let a,l;l=0===e.id?t.dom.getElement():getLineElement(e.id,t.dom.getElement());const f=t.api.getMoveNode({line:e.id,move:0});return f&&(a=f.getElement()),{anchor:a,comment:e.initComment,element:l,handler:function saveComment(a,l){!function updateLineComment(e,{api:t,comment:n,moveList:a,noUIUpdates:l}){t.updateLineComment("string"==typeof n&&n.length>0?n:void 0,e.id),!l&&e.initComment&&(0===e.id?a.dom.getElement():getLineElement(e.id,a.dom.getElement())).prepend(a.dom.addComment(e))}(e,{api:n,comment:a,moveList:t,noUIUpdates:l})}}}function createInsertEditableCommentMethod(e){return function insertEditableComment(t){const{dom:n,game:a,getComponent:l,translations:f}=e;let p,h;if(isNode(t))p=function getNodeEditableCommentConfig(e,{moveList:t,api:n}){const a=t.api.getMoveNode(e.ids);if(!a)throw new ChessError({code:uo.ElementNotFound,data:e,message:"No move node found."});return{comment:e.comment,element:a.getElement(),handler:function saveComment(e,l){!function updateNodeComment(e,{api:t,comment:n,moveList:a,noUIUpdates:l}){t.updateNode(e.ids,{comment:"string"==typeof n&&n.length>0?n:void 0}),l||(e.getNodeData().comment&&e.getElement().appendChild(a.dom.addComment(e.getNodeData())),e.touchNextNode())}(a,{api:n,comment:e,moveList:t,noUIUpdates:l})}}}(t,{api:a,moveList:l()});else{if(!isLine(t))throw new ChessError({code:uo.BadData,data:t,message:"No line or node found"});p=getLineEditableCommentConfig(t,{api:a,moveList:l()})}n.removeEditableComment(),e.editableCommentComponent=function createEditableCommentComponent(e,{anchor:t,props:n}){return createSvelteComponent({ComponentType:Editable_comment,options:{anchor:t,props:n,target:e},replaceContainer:!1})}(p.element,{anchor:p.anchor,props:{comment:p.comment,translations:f}}),e.editableCommentComponent.on(Gr.Events.CommentChanged,(function handleCommentChange({detail:e}){clearTimeout(h),h=window.setTimeout((()=>{!function saveComment(e=""){const t=cleanCommentString(e);p.handler(t,!0)}(e)}),Gr.Constants.CommentUpdateDelay)})),e.editableCommentComponent.on(Gr.Events.FocusOut,(function saveAndDestroy({detail:t}){clearTimeout(h);const n=cleanCommentString(t);p.handler(n),e.dom.removeEditableComment()}))}}var Co,So,ko,wo;function getCommentElementId(e){if(isLine(e))return`line-comment-${e.id}`;if(isNode(e))return`move-node-comment-${e.ids.line}-${e.ids.move}`;throw new ChessError({code:uo.BadData,data:e,message:"No line or node found"})}function convertCommentNagsToAnnotation(e){return e.split(" ").map((e=>isNagFormat(e)?normalizeAnnotation(e):e)).join(" ")}function createAddCommentMethod(e){return function addComment(t,n=!0,a){const{dom:l,options:f,state:p,stateMachine:h}=e,m=Boolean("isCommentEnabled"in t?t.isCommentEnabled:n),g=function createCommentComponent({commentLinkData:e,lineOrNode:t,context:n}){const a=getCommentElementId(t);let l,f,p,h=!1;if(isLine(t))l=convertCommentNagsToAnnotation(t.initComment),p={line:t.id,move:0};else{if(!isNode(t))throw new ChessError({code:uo.BadData,data:t,message:"No line or node found"});l=t.comment?convertCommentNagsToAnnotation(t.comment):t.comment,p=t.ids}return function createElement(){var t;const p=e?"a":"span";f=document.createElement(p),f.setAttribute(Lr.ComponentIdentifier,a),f.innerHTML=stripHTMLTags((null!=(t=null==e?void 0:e.text)?t:l)||"",!0),f.classList.add(co.Classes.Comment,co.Classes.StaticComment),e&&(f.setAttribute("href",e.href),f.setAttribute("target","_blank")),n.editingEnabled&&!e&&registerClickListeners()}(),{deregisterClickListeners:deregisterClickListeners,destroy:destroy10,getElement:()=>f,getId:()=>a,registerClickListeners:registerClickListeners};function destroy10(){deregisterClickListeners(),n.removeCommentFromMoveList(a)}function registerClickListeners(){h||(f.addEventListener("click",handleCommentClick,{once:!0}),f.addEventListener("contextmenu",handleContextMenuClick),h=!0)}function deregisterClickListeners(){f.removeEventListener("click",handleCommentClick),f.removeEventListener("contextmenu",handleContextMenuClick),h=!1}function handleCommentClick(){destroy10(),n.emitter.emit(Co.Events.Click,t)}function handleContextMenuClick(e){e.preventDefault(),n.emitter.emit(co.Events.OpenContextMenu,{node:{ids:p}})}}({commentLinkData:null!=a?a:null,lineOrNode:t,context:{editingEnabled:f.moveListContextMenuEnabled&&m,emitter:h,removeCommentFromMoveList(){l.removeComment(t)}}});return p.comments[g.getId()]&&l.removeComment(t),p.comments[g.getId()]=g,g.getElement()}}function isMainLine(e){return 0===e}function createInsertNodeMethod(e){return function insertNode2({node:t,nodeToInsertAfter:n}){const{dom:a,el:l,placeholders:f}=e,p=f[Lr.Placeholders.Moves],h=isMainLine(t.ids.line)?p:void 0;let m=l;if(n){const e=n.getElement();if(!e)throw new ChessError({code:uo.ElementNotFound,message:"Node element does not exist."});m=e.parentNode}a.addNode(t,{anchor:h,target:m})}}function createLineElement(e,...t){const n=document.createElement("span");return n.setAttribute(Lr.ComponentIdentifier,`line-${e}`),n.classList.add(...t),n}function createInsertVariationMethod(e){return function insertVariation({node:t}){const{api:n,dom:a,el:l,game:f}=e,p=t.ids,h=f.getRawLines()[p.line],m={line:h.parentId,move:h.atMoveNode},g=n.getMoveNode({line:m.line,move:m.move+1}),v=f.getNodeByIds(m);if(!v||isLine(v))throw new ChessError({code:uo.ElementNotFound,message:"Anchor node element for variation not found."});let y=l;const _=createLineElement(h.id,Lr.ClassNames.Variation);if(0===v.ids.line&&_.classList.add(Lr.ClassNames.MainLine),a.addNode(t,{target:_}),v.lines&&v.lines.length>1)y=getLineElement(v.lines[v.lines.length-2],l);else{const e=n.getMoveNode(v.ids);e&&(y=e.getElement())}y&&y.after(_),void 0!==g&&g.touch(io.TouchableKeys.MoveNumber)}}function getVariations(e,t){return t.lines?t.lines.reduce(((t,n)=>(t.push(e[n]),t)),[]):[]}function createLineVariationElements({api:e,depth:t,parentLineEl:n,lines:a,line:l}){let f;f=1===t?document.createDocumentFragment():createLineElement(l.id,Lr.ClassNames.Variation),l.initComment&&f.appendChild(e.addComment(l)),l.forEach((n=>{const l=e.addNode(n,{target:f});n.comment&&l.getElement().appendChild(e.addComment(n)),n.lines&&getVariations(a,n).forEach((n=>{createLineVariationElements({api:e,depth:t+1,line:n,lines:a,parentLineEl:f})}))})),n.appendChild(f)}function createLoadMethod(e){return function load3(){const{api:t,dom:n,el:a,game:l,placeholders:f}=e,p=f[Lr.Placeholders.Moves];n.reset();const h=l.getRawLines();h[0].initComment&&a.insertBefore(n.addComment(h[0]),p),h[0].forEach((e=>{var t,f;const m=n.addNode(e,{anchor:p,target:a});if(e.comment&&m.getElement().appendChild(n.addComment(e)),(null==(t=e.commands)?void 0:t.text)&&(null==(f=e.commands)?void 0:f.href)){const{text:t,href:n}=e.commands;l.hml.addCommentLink({node:e,text:t,href:n})}e.lines&&getVariations(h,e).forEach((e=>{const t=createLineElement(e.id,Lr.ClassNames.Variation,Lr.ClassNames.MainLine);createLineVariationElements({api:{addComment:n.addComment,addNode:n.addNode},depth:1,line:e,lines:h,parentLineEl:t}),a.insertBefore(t,p)}))}));const m=l.getSelectedNode();m&&t.selectNode(m.ids),function restoreCustomColorsData({dom:e,game:t}){t.getRawLines().forEach((n=>{n.forEach((n=>{const a=t.getNodeByIds(n.ids);if(!isNode(a))return;const l=a.customColor;l&&e.updateMoveNodeComponent(n.ids,{customColor:l})}))}))}(e),e.state.nodeLimit&&e.game.hml.updateNodeLimits(e.state.nodeLimit)}}function createRemoveCommentMethod(e){return function removeComment(t){const{state:n}=e,a=getCommentElementId(t),l=e.el;n.comments[a]&&(!function removeCommentElement(e,t){const n=t.querySelector(`[${Lr.ComponentIdentifier}="${getCommentElementId(e)}"`);n&&n.parentNode&&n.parentNode.removeChild(n)}(t,l),delete n.comments[a])}}function createRemoveEditableCommentMethod(e){return function removeEditableComment(){if(void 0!==e.editableCommentComponent){try{e.editableCommentComponent.destroy()}catch(t){}e.editableCommentComponent=void 0}}}function createRemoveLineMethod(e){return function removeLine(t){const{api:n,dom:a,el:l,state:f}=e,p=t.id;if(void 0===f.nodes[p])throw new ChessError({code:uo.BadData,data:t,message:`No line with id ${p} found`});f.nodes[p][0]&&a.removeNode({line:p,move:0});const h=getLineElement(p,l);let m;h&&h.parentNode.removeChild(h),delete f.nodes[p],void 0!==t.atMoveNode&&void 0!==t.parentId&&(m=n.getMoveNode({line:t.parentId,move:t.atMoveNode+1})),m&&m.touch(io.TouchableKeys.MoveNumber)}}function createRemoveNodeMethod(e){return function removeNode2({line:t,move:n}){const{api:a,state:l}=e,f=a.getMoveNode({line:t,move:n});if(!f)return;const p=Object.keys(l.nodes[f.ids.line]).length-1;if(l.nodes[f.ids.line][f.ids.move]!==l.nodes[f.ids.line][p])for(let e=p;e>f.ids.move;e--)l.nodes[f.ids.line][e].destroy(),delete l.nodes[f.ids.line][e];f.destroy(),delete l.nodes[f.ids.line][f.ids.move],function removeOrphanedElements({el:e,game:t,state:n}){const a=t.getRawLines();Object.keys(n.nodes).forEach((t=>{var l;a[t]||(Object.values(n.nodes[t]).forEach((e=>e.destroy())),null==(l=getLineElement(Number(t),e))||l.remove(),delete n.nodes[t])}))}(e);const h=a.getMoveNode({line:f.ids.line,move:f.ids.move+1});h&&h.touch(io.TouchableKeys.MoveNumber)}}function createResetMethod(e){return function reset2(){const{dom:t,el:n,state:a,placeholders:l}=e;t.removeEditableComment(),n.innerHTML="",a.comments={},a.nodes={},a.selectedNode=void 0,n.appendChild(l[Lr.Placeholders.Moves]),n.appendChild(l[Lr.Placeholders.GameResult])}}function createSetResultNodeMethod(e){return function setResultNode(t){var n;const{el:a}=e,l=a.querySelector(`.${co.Classes.GameResultNode}`),f=e.placeholders[Lr.Placeholders.GameResult];if(l&&(null==(n=l.parentElement)||n.removeChild(l)),t===qn.Results.None)return;const p=document.createElement("span");p.classList.add(co.Classes.GameResultNode),p.innerText=t,a.insertBefore(p,f)}}function createUpdateLineComponent(e){return function updateLineComponent(t,n){var a;const{dom:l,game:f}=e,p=f.getLine(t);if(!p)return;const{initComment:h}=n;if(void 0!==h){const t=0===p.id?null!=(a=null==l?void 0:l.getElement())?a:e.el:getLineElement(p.id,e.el);null==t||t.prepend(l.addComment(p))}}}function createUpdateMoveNodeComponent(e){return function updateMoveNodeComponent(t,n){const{api:a,dom:l,game:f}=e,p=f.getNodeByIds(t),h=a.getMoveNode(t);if(!p||isLine(p)||!h)return;const m=null==h?void 0:h.getElement(),g=[],{additionalAnnotation:v,annotation:y,comment:_,customColor:b,isCommentEnabled:C}=n;if(void 0===v&&void 0===y||g.push(io.TouchableKeys.Annotation),void 0!==_)if(""===_)l.removeComment(p);else{const e=h.getNodeData(),t=l.addComment(e,null==C||C);m.appendChild(t)}void 0!==b&&g.push(io.TouchableKeys.CustomColor),g.forEach((e=>h.touch(e)))}}function createPluginsAPI(e=[],t,n=(0,x.a)()){const a=new Map;let l=t;return addMany(e),__spreadProps(__spreadValues({add:addPlugin,addMany:addMany,destroy:function destroy10(){a.forEach((e=>remove(e.name)))}},n),{getAll:function getAll(){return[...a.values()]},getContext:function getContext(){return l},getOne:function getOne(e){return a.get(e)},has:a.has.bind(a),remove:remove,setContext:function setContext(e){l=e,n.emit(ko.Events.ContextSet,l)}});function addPlugin(e){var t;return!!e.name&&(a.has(e.name)&&remove(e.name),a.set(e.name,e),null==(t=e.create)||t.call(e,l),n.emit(ko.Events.PluginAdded,e),!0)}function addMany(e){if(!e||0===e.length)return!1;return(Array.isArray(e)?e:[e]).reduce((function pluginsAddedSuccessfully(e,t){return addPlugin(t)||(e=!1),e}),!0)}function remove(e){var t;const f=a.get(e);return!!f&&(null==(t=f.destroy)||t.call(f,l),a.delete(e),n.emit(ko.Events.PluginRemoved,f),!0)}}function createHMLPluginsAPI(e,t){return function withAPI(e,t,n){const a=function createExtendAPI$1(e,t){return function extendAPI(n,a){const l=e[n];return e[n]=a(t),function destroyOverride(){var t,a;null==(a=(t=e[n]).destroy)||a.call(t),e[n]=l}}}(t,n),l=new Map;return e.on(ko.Events.PluginAdded,(function pluginAddedEventHandler(e){if(e.api){const t=a(e.name,e.api);t&&l.set(e.name,t)}})),e.on(ko.Events.PluginRemoved,(function pluginRemovedEventHandler(e){const t=l.get(e.name);null==t||t(),l.delete(e.name)})),e}(createPluginsAPI([],t),e,t)}function createHorizontalMoveList({el:e,game:t,nodeLimit:n,options:a,plugins:l=[createContextMenuPlugin()],stateMachineListeners:f,stateMachine:p,queue:h,placeholders:m,scrollContainer:g,translations:v=Or}){const y={},_={api:y,contextMenuActions:mo,dom:{getElement:()=>e},editableCommentComponent:void 0,el:e,game:t,getComponent:function getComponent(){return k},options:a,queue:h,placeholders:m,scrollContainer:g,state:{comments:{},nodes:{},nodeLimit:n,selectedNode:void 0},stateMachine:p,stateMachineListeners:f,translations:v},{dom:b,game:C}=_,S=createHMLPluginsAPI(C.hml,_);S.addMany(l),Object.assign(y,__spreadValues({},function createHMLComponentAPI(e){return{getComments:()=>e.state.comments,getContext:()=>e,getContextMenuActions:createGetContextMenuActions(e),getMoveNode:createGetMoveNodeMethod(e),getNodes:()=>e.state.nodes,getOptions:()=>e.options,getSelectedNode:()=>e.state.selectedNode,resetSelectedNode:createResetSelectedNode(e),selectLineStart:createSelectLineStart$1(e),selectNode:createSelectNodeMethod(e),setOptions:createSetOptionsMethod(e)}}(_))),Object.assign(b,__spreadValues({},function createHMLDOMService(e){const{el:t,placeholders:n}=e;return t.classList.add(Lr.ClassNames.Component),t.addEventListener("contextmenu",disableContextMenu),t.appendChild(n[Lr.Placeholders.Moves]),t.appendChild(n[Lr.Placeholders.GameResult]),{addComment:createAddCommentMethod(e),addNode:createAddNodeMethod(e),destroy:createDestroyMethod(e),getElement:()=>t,insertEditableComment:createInsertEditableCommentMethod(e),insertNode:createInsertNodeMethod(e),insertVariation:createInsertVariationMethod(e),load:createLoadMethod(e),removeComment:createRemoveCommentMethod(e),removeEditableComment:createRemoveEditableCommentMethod(e),removeLine:createRemoveLineMethod(e),removeNode:createRemoveNodeMethod(e),reset:createResetMethod(e),setResultNode:createSetResultNodeMethod(e),setScrollContainer:t=>e.scrollContainer=t,updateLineComponent:createUpdateLineComponent(e),updateMoveNodeComponent:createUpdateMoveNodeComponent(e)}}(_))),C.extendAPI(Re.Plugin.Name,{addContextMenuActions:()=>function createAddContextMenuActions(e){return function addContextMenuActions(t){Object.keys(t).forEach((n=>{e.contextMenuActions[n]=t[n]}))}}(_)});const k={api:y,destroy:function destroy10(){S.destroy()},dom:b,plugins:S};return k}function initializeMoveList({context:e,coreContext:t}){var n,a;const{el:l,nodeLimit:f,scrollContainer:p,translations:h}=e,{api:m}=t,g=m.getOptions();null==(a=null==(n=e.moveList)?void 0:n.destroy)||a.call(n),e.methods.destroy(),e.stateMachineListeners.push([Co.Events.Click,e.methods.handleCommentClick]),e.stateMachine.on(Co.Events.Click,e.methods.handleCommentClick),e.moveList=createHorizontalMoveList({el:l,game:m,nodeLimit:f,options:{moveListContextMenuEnabled:g.moveListContextMenuEnabled,moveListDisplayType:g.moveListDisplayType},queue:e.queue,placeholders:e.placeholders,scrollContainer:p,stateMachine:e.stateMachine,stateMachineListeners:e.stateMachineListeners,translations:h}),e.moveList.dom.load(),e.moveList.dom.setResultNode(m.getResult())}(function(e){e.Click="click"})((So=Co||(Co={})).Events||(So.Events={})),function(e){e.PluginAdded="PluginAdded",e.PluginRemoved="PluginRemoved",e.ContextSet="ContextSet"}((wo=ko||(ko={})).Events||(wo.Events={}));function get_each_context$1(e,t,n){const a=e.slice();return a[9]=t[n],a}function get_each_context_1(e,t,n){const a=e.slice();return a[12]=t[n],a}function create_each_block_1(e){let t,n,a,l,f,p=(e[1][e[12].name]?e[1][e[12].name]():e[12].name)+"";function click_handler(...t){return e[6](e[12],...t)}return{c(){t=(0,x.f)("span"),n=(0,x.h)(p),(0,x.j)(t,"class",a=(0,x.n)(ro.Classes.ActionName)+" svelte-1hoe0fe")},m(e,a){(0,x.k)(e,t,a),(0,x.m)(t,n),l||(f=(0,x.w)(t,"click",click_handler),l=!0)},p(t,a){e=t,3&a&&p!==(p=(e[1][e[12].name]?e[1][e[12].name]():e[12].name)+"")&&(0,x.o)(n,p)},d(e){e&&(0,x.q)(t),l=!1,f()}}}function create_each_block$1(e){let t,n,a,l,f,p,h,m=e[9].display+"";function click_handler_1(){return e[7](e[9])}return{c(){t=(0,x.f)("span"),n=(0,x.h)(m),a=(0,x.r)(),(0,x.j)(t,"alt",l=e[1][e[9].meaning]()),(0,x.j)(t,"class",f=(0,x.n)(ro.Classes.Annotation)+" svelte-1hoe0fe")},m(e,l){(0,x.k)(e,t,l),(0,x.m)(t,n),(0,x.m)(t,a),p||(h=(0,x.w)(t,"click",click_handler_1),p=!0)},p(n,a){e=n,2&a&&l!==(l=e[1][e[9].meaning]())&&(0,x.j)(t,"alt",l)},d(e){e&&(0,x.q)(t),p=!1,h()}}}function create_fragment$1(e){let t,n,a,l,f,p,h,m,g=e[0],v=[];for(let b=0;b<g.length;b+=1)v[b]=create_each_block_1(get_each_context_1(e,g,b));let y=_o,_=[];for(let b=0;b<y.length;b+=1)_[b]=create_each_block$1(get_each_context$1(e,y,b));return{c(){t=(0,x.f)("div");for(let e=0;e<v.length;e+=1)v[e].c();n=(0,x.r)(),a=(0,x.f)("div"),l=(0,x.r)(),f=(0,x.f)("div");for(let e=0;e<_.length;e+=1)_[e].c();p=(0,x.r)(),(0,x.j)(a,"class",(0,x.n)(ro.Classes.Divider)+" svelte-1hoe0fe"),(0,x.j)(f,"class",(0,x.n)(ro.Classes.AnnotationsContainer)+" svelte-1hoe0fe"),(0,x.j)(t,"class",(0,x.n)(ro.Classes.Component)+" svelte-1hoe0fe")},m(g,y){(0,x.k)(g,t,y);for(let e=0;e<v.length;e+=1)v[e].m(t,null);(0,x.m)(t,n),(0,x.m)(t,a),(0,x.m)(t,l),(0,x.m)(t,f);for(let e=0;e<_.length;e+=1)_[e].m(f,null);(0,x.m)(t,p),e[8](t),h||(m=(0,x.w)(document.body,"click",e[4]),h=!0)},p(e,[a]){if(11&a){let l;for(g=e[0],l=0;l<g.length;l+=1){const f=get_each_context_1(e,g,l);v[l]?v[l].p(f,a):(v[l]=create_each_block_1(f),v[l].c(),v[l].m(t,n))}for(;l<v.length;l+=1)v[l].d(1);v.length=g.length}if(10&a){let t;for(y=_o,t=0;t<y.length;t+=1){const n=get_each_context$1(e,y,t);_[t]?_[t].p(n,a):(_[t]=create_each_block$1(n),_[t].c(),_[t].m(f,null))}for(;t<_.length;t+=1)_[t].d(1);_.length=y.length}},i:x.x,o:x.x,d(n){n&&(0,x.q)(t),(0,x.E)(v,n),(0,x.E)(_,n),e[8](null),h=!1,m()}}}function instance$1(e,t,n){let{actions:a}=t,{translations:l}=t;const f=(0,x.z)();let p;return e.$$set=e=>{"actions"in e&&n(0,a=e.actions),"translations"in e&&n(1,l=e.translations)},[a,l,p,f,function handleDocumentClick(e){e.target.classList.contains(ro.Classes.Component)||f(Jr.Events.Close)},function getElement(){return p},(e,t)=>f(Jr.Events.ActionClicked,{action:e,event:t}),e=>f(Jr.Events.AnnotationClicked,{action:e.action,data:e.code}),function div2_binding(e){x.D[e?"unshift":"push"]((()=>{p=e,n(2,p)}))}]}class Context_menu extends x.b{constructor(e){super(),(0,x.i)(this,e,instance$1,create_fragment$1,x.d,{actions:0,translations:1,getElement:5})}get getElement(){return this.$$.ctx[5]}}function createContextMenu({actions:e,el:t,moveNode:n,emitter:a,translations:l}){const f=null==n?void 0:n.getElement(),p=function createContextMenuComponent(e,{anchor:t,props:n}){return createSvelteComponent({ComponentType:Context_menu,methods:["getElement"],options:{anchor:t,props:n,target:e},replaceContainer:!1})}((null==f?void 0:f.parentElement)||t,{anchor:f,props:{actions:e,translations:l}});return setPosition(),function registerListeners(){p.on(Jr.Events.ActionClicked,createEventHandler(Jr.Events.ActionClicked)),p.on(Jr.Events.AnnotationClicked,createEventHandler(Jr.Events.AnnotationClicked)),p.on(Jr.Events.Close,(()=>a.emit(Jr.Events.Close))),t.addEventListener("scroll",function debounce(e,t){let n;return function run2(...a){clearTimeout(n),n=setTimeout((()=>{n=null,e(...a)}),t)}}(setPosition,50))}(),{destroy:p.destroy};function createEventHandler(e){return function handleEvent({detail:t}){a.emit(e,{action:t.action,data:t.data,event:t.event,moveNode:n.getNodeData()})}}function setPosition(){const e=null==p?void 0:p.getElement();if(!e)return;const{left:n,top:a}=function getContextMenuPosition({contextMenu:e,moveNode:t,padding:n={x:10,y:20}}){const a=t.y+n.y-window.pageYOffset,l=window.innerHeight-e.height,f={left:0,top:0};return f.top=Math.min(a,l),f.bottom=f.top+e.height,t.x>window.innerWidth-e.width?f.left=t.x+t.width-e.width:(a<l&&(n.x=0),f.left=t.x+n.x),f}({contextMenu:e.getBoundingClientRect(),moveNode:(null==f?void 0:f.getBoundingClientRect())||t.getBoundingClientRect()});e.style.left=`${n}px`,e.style.top=`${a}px`}}function initializeContextMenu(e){const{el:t,moveList:n,stateMachine:a,methods:{destroyContextMenu:l},translations:f}=e;function handleContextMenuAction(e){l();const t=function createContextMenuActionHandler(e,t){return function handleContextMenuAction({action:n,data:a,event:l,moveNode:f}){const p=t.api.getMoveNode(f.ids);if(!p)throw new ChessError({code:uo.BadData,data:f.ids,message:"No move node found."});n.handler(f,{context:e,data:a,moveList:t,moveNodeComponent:p,event:l}),e.queue.flush()}}(n.api.getContext(),n);t(e)}function handleAnnotationAction({action:e,data:t,moveNode:a}){l();const f=n.api.getMoveNode(a.ids);if(!f)throw new ChessError({code:uo.BadData,data:a.ids,message:"No move node found."});const p={data:t,game:n.api.getContext().game,moveNodeComponent:f,node:a};e===Jr.AnnotationActions.AddAnnotation?function addAnnotation({node:e,game:t,data:n,moveNodeComponent:a}){const l=normalizeAnnotation(n),f=a.getNodeData().annotation===l?void 0:l;t.updateNode(e.ids,{annotation:f}),a.touch(io.TouchableKeys.Annotation)}(p):e===Jr.AnnotationActions.AddAdditionalAnnotation&&function addAdditionalAnnotation({node:e,game:t,data:n,moveNodeComponent:a}){const l=normalizeAnnotation(n),f=a.getNodeData().additionalAnnotation,p=(null==f?void 0:f[0])===l?void 0:[l];t.updateNode(e.ids,{additionalAnnotation:p}),a.touch(io.TouchableKeys.Annotation)}(p)}function createOpenContextMenuHandler(p){var h;n.api.selectNode(p.node.ids);const m=n.api.getContextMenuActions(p.node.ids);l(),e.contextMenu=createContextMenu({actions:m,el:null!=(h=e.scrollContainer)?h:t,emitter:a,moveNode:n.api.getMoveNode(p.node.ids),translations:f})}e.stateMachineListeners.push([Jr.Events.ActionClicked,handleContextMenuAction],[Jr.Events.AnnotationClicked,handleAnnotationAction],[Jr.Events.Close,l],[co.Events.OpenContextMenu,createOpenContextMenuHandler]),a.on(Jr.Events.Close,l),a.on(Jr.Events.ActionClicked,handleContextMenuAction),a.on(Jr.Events.AnnotationClicked,handleAnnotationAction),a.on(co.Events.OpenContextMenu,createOpenContextMenuHandler)}const To={condition:function condition({context:e,event:t}){return function match2(){return t.type===f.InstanceEvents.Create||t.type===f.InstanceEvents.ModeChanged||!e.moveList||0===Object.entries(e.moveList).length}},handler:function handler({context:e,coreContext:t}){initializeMoveList({context:e,coreContext:t}),e.enableContextMenu&&initializeContextMenu(e)}};function createQueuedEventHandler(e,t){return function queuedEvent(n){n.selectedNode=__spreadValues({},n.coreContext.api.getRelativeNode()),e.add(t,n)}}const Po=Lr.VariationParenthesis.Before,Eo=Lr.VariationParenthesis.After;function copyMoveListContentToClipboard({api:e,el:t,win:n=window}){const a=n.getSelection(),l=null==a?void 0:a.anchorNode,f=null==a?void 0:a.focusNode;if(!l||!f)return null;const p=e.getPGN(),h=getPosition({moveList:t,node:l,pgn:p}),m=getPosition({moveList:t,node:f,pgn:p});if(null===h||null===m)return null;const g=Math.min(h,m),v=Math.max(h,m),y=getMoveText(getMoveElement(h<m?f:l)).length,_=v+y-g;let b=p.substr(g,_);return b=function addClosingParentheses({lastIndex:e,pgn:t,pgnPiece:n}){const a=new RegExp(`\\${Po}`,"g"),l=(n.match(a)||[]).length;let f=n;for(let p=0;p<l&&t[e+p]===Eo;p++)f+=Eo;return f}({lastIndex:v+y,pgn:p,pgnPiece:b}),function copyStringToClipboard(e){const t=document.createElement("textarea");document.body.append(t),t.value=e,t.focus(),t.select(),document.execCommand("cut"),t.remove()}(b),b}function getPosition({moveList:e,pgn:t,node:n}){const a=getMoveElement(n),l=getMoveText(a);let f=function getMoveOrder(e,t){const n=Array.from(e.querySelectorAll(`.${co.Classes.MoveNode}`));return n.filter((e=>e.textContent===t.textContent)).findIndex((e=>e===t))}(e,a)||0;return t.split("").findIndex(((e,n)=>{if(t.substr(n,l.length)===l){if(0===f)return n;f--}return!1}))}function getMoveElement(e){var t;return!e.parentNode||(null==(t=null==e?void 0:e.classList)?void 0:t.contains(co.Classes.MoveNode))?e:getMoveElement(e.parentNode)}function getMoveText(e){const t=e.querySelector(`.${co.Classes.MoveNumber}`),n=e.querySelector(`.${co.Classes.MoveText}`),a=e.querySelector(`.${co.Classes.Comment}`);let l="";return t&&(l+=`${t.textContent} `),n&&(l+=n.textContent),a&&(l+=` {${a.textContent}}`),l}function createDiagramAction({action:e,nodeLimit:t}){const n=e.includes("Set");return{action:Jr.Actions[e],handler:function handler2(e,{moveList:a,moveNodeComponent:l}){diagramActionHandler({limitType:t,isSettingNodeLimits:n,moveList:a,moveNodeComponent:l,node:e})},isVisible:function isVisible({state:e}){var a,l;const f=null==(a=e.nodeLimit)?void 0:a[t],p=Boolean((null==f?void 0:f.move)===(null==(l=e.selectedNode)?void 0:l.getNodeData().move));return n?Boolean(!f||!p):Boolean(f&&p)},name:_r.Translation.Actions[e]}}const Ao={[Jr.Actions.SetBegin]:createDiagramAction({action:Jr.Actions.SetBegin,nodeLimit:Lr.NodeLimitTypes.Begin}),[Jr.Actions.SetFocus]:createDiagramAction({action:Jr.Actions.SetFocus,nodeLimit:Lr.NodeLimitTypes.Focus}),[Jr.Actions.SetEnd]:createDiagramAction({action:Jr.Actions.SetEnd,nodeLimit:Lr.NodeLimitTypes.End}),[Jr.Actions.RemoveBegin]:createDiagramAction({action:Jr.Actions.RemoveBegin,nodeLimit:Lr.NodeLimitTypes.Begin}),[Jr.Actions.RemoveFocus]:createDiagramAction({action:Jr.Actions.RemoveFocus,nodeLimit:Lr.NodeLimitTypes.Focus}),[Jr.Actions.RemoveEnd]:createDiagramAction({action:Jr.Actions.RemoveEnd,nodeLimit:Lr.NodeLimitTypes.End})};function createAddDiagramActions(e,t){const{api:n}=e;return function addDiagramActions(){n.addContextMenuActions(Ao),createDestroyDiagramActions(e,t)}}function diagramActionHandler({limitType:e,isSettingNodeLimits:t,moveList:n,moveNodeComponent:a,node:l}){var f,p;const h=n.api.getContext(),m=null==(f=h.state.nodeLimit)?void 0:f[e];let g;m&&(g=n.api.getMoveNode({line:m.ids.line,move:m.ids.move})),t?function setNodeLimits({limitType:e,moveList:t,moveNodeComponent:n,node:a}){const l=t.api.getContext();l.state.nodeLimit&&(l.state.nodeLimit[e]=a);if(e===Lr.NodeLimitTypes.Focus)return void n.addNodeStyles({fontStyle:"italic"});const f=document.createElement("span"),p=`diagram-${e}`,h=e===Lr.NodeLimitTypes.Begin?"[[":"]]";f.classList.add(p),f.innerHTML=h,e===Lr.NodeLimitTypes.Begin?n.insertBeforeNode(f):e===Lr.NodeLimitTypes.End&&n.insertAfterNode(f)}({limitType:e,moveList:n,moveNodeComponent:a,node:l}):(null==(p=h.state.nodeLimit)||delete p[e],removeNodeLimits({limitType:e,moveList:n,moveNodeComponent:a})),g&&removeNodeLimits({limitType:e,moveList:n,moveNodeComponent:g})}function removeNodeLimits({limitType:e,moveList:t,moveNodeComponent:n}){const a=t.dom.getElement().querySelector(`.diagram-${e}`);a?a.remove():n.removeNodeStyles()}function createUpdateNodeLimits(e,t){return function updateNodeLimits(n){const{moveList:a}=t;e.api.getDiagramNodeLimits||createDestroyDiagramActions(e,t),Object.entries(n).forEach((([e,t])=>{const n=a.api.getMoveNode({line:t.ids.line,move:t.ids.move});diagramActionHandler({limitType:e,isSettingNodeLimits:!0,moveList:a,moveNodeComponent:n,node:t})}))}}function createDestroyDiagramActions(e,t){var n;const a=t.moveList.api.getContext();a.state.nodeLimit=null!=(n=e.api.getDiagramNodeLimits)?n:{},t.methods.destroyDiagramActions=e.api.extendAPI(Re.Plugin.Name,{getDiagramNodeLimits(){var e;return null!=(e=null==a?void 0:a.state.nodeLimit)?e:{}}})}function createAddCommentLink(e,t){return function addCommentLink({node:n,text:a,href:l}){var f,p;const h=t.moveList.dom.addComment(n,!1,{text:a,href:l});e.api.getOptions().test&&setTestData(h,{[Bt.Element]:jt.CommentLink}),n.commands||(n.commands={}),e.api.updateNode(n.ids,{commands:Object.assign(n.commands,{href:`${l}`,text:`${a}`})}),0===n.ids.line?null==(f=t.moveList.api.getMoveNode(n.ids))||f.getElement().appendChild(h):null==(p=getLineElement(n.ids.line,t.el))||p.append(h)}}function createSetScrollContainer(e){return function setScrollContainer(t){e.scrollContainer=t,e.moveList.dom.setScrollContainer(t)}}function createMarkingShortcutsFromFrame(e){const{id:t,itemsPerRow:n,rows:a,itemsConfiguration:l=[]}=e;return[...Array(n*a)].map(((e,a)=>{const f=l[a],{name:p,animatedImageURL:h,removalSoundBaseURL:m}="object"==typeof f?f:{name:null!=f?f:`${t}-${a}`},g=a%n,v=Math.floor(a/n);return{name:p,frameId:t,xIndex:g,yIndex:v,animatedImageURL:h,removalSoundBaseURL:m}}))}function preloadImage(e){const t=new Image;return t.src=e,t}function createSetFrames({api:e,framesMap:t,shortcuts:n}){return function setFrames(a=[]){t.clear(),n.clear(),a.forEach((e=>{t.set(e.id,e),preloadImage(e.imageURL)})),a.map(createMarkingShortcutsFromFrame).forEach((e=>{e.forEach((e=>{n.set(e),e.animatedImageURL&&preloadImage(e.animatedImageURL)}))})),function loadRemovalSounds(){const t=n.getAsArray().filter((e=>e.removalSoundBaseURL));if(!t.length)return;const a=t.reduce(((e,t)=>{var n;const{name:a,removalSoundBaseURL:l=""}=t,f=null!=(n=e[l])?n:[];return f.push(a),e[l]=f,e}),{}),l=Object.keys(a);if(l.length){const t=e.sounds.getSoundsInstance();l.forEach((e=>{t.loadExtra({baseURL:e,codes:a[e]})}))}}()}}function getShortcutId({xIndex:e,yIndex:t,frameId:n}){return`frameId=${n}, xIndex=${e}, yIndex=${t}`}function getFrameNotFoundError(e,t){return`Frame: '${e}' not found (frames available: ${t.join(", ")})`}function getResultMarkingData({markings:e,framesMap:t,shortcuts:n}){const a=[],l=[];return e.forEach((e=>{const{model:f}=e;(Array.isArray(e.square)?e.square:[e.square]).forEach((p=>{if("string"==typeof f){const t={data:{square:p,type:Pe[f]},type:"effect",persistent:!0,node:!0};return void a.push({square:p,input:e,marking:t})}const{customMarking:h,itemDisappears:m}=function createCustomMarkingWithFrame({model:e,shortcuts:t,framesMap:n,square:a}){var l;const f=t.find(e);if(!f)throw new Error(function getMarkingShortcutNotFoundError(e){if("xIndex"in e){const{xIndex:t,yIndex:n,frameId:a}=e;return`Marking shortcut: '${getShortcutId({xIndex:t,yIndex:n,frameId:a})}' not found`}return`Marking shortcut: '${e.name}' not found`}(e));const p=n.get(f.frameId);if(!p)throw new Error(getFrameNotFoundError(f.frameId,[...n.keys()]));const{xIndex:h,yIndex:m,animatedImageURL:g,removalSoundBaseURL:v,name:y}=f,{itemsPerRow:_,rows:b,imageURL:C}=p,S=g?{imageAnimated:!0,imageURL:g,positionRatioX:0,positionRatioY:0,widthRatio:1,heightRatio:1}:{imageURL:C,positionRatioX:h/_,positionRatioY:m/b,widthRatio:1/_,heightRatio:1/b};return{customMarking:{data:{square:a,type:ge.Image,removalTimeout:2e3,removalClass:g?void 0:"custom-item__frame--disappear",removalSound:v?y:void 0,frame:S},type:"customItem",persistent:!0},itemDisappears:null!=(l=e.autoRemove)&&l}}({model:f,shortcuts:n,framesMap:t,square:p});a.push({square:p,input:e,marking:h}),m&&l.push(p)}))})),{resultMarkings:a,disappearingMarkingSquares:l}}function createMark$1({api:e,markedSquares:t,framesMap:n,shortcuts:a}){return function mark(l){const f=Array.isArray(l)?l:[l],{resultMarkings:p,disappearingMarkingSquares:h}=getResultMarkingData({markings:f,framesMap:n,shortcuts:a});let m;p.length&&(m=function markModels(t){var n;if(!t.length)return[];if(t.length>1){return e.markings.addMany(t).map((e=>null!=e?e:""))}return[null!=(n=e.markings.addOne(t[0]))?n:""]}(p.map((e=>e.marking)))),p.forEach(((e,n)=>{var a;const{input:l,marking:f,square:p}=e,h=null!=(a=null==m?void 0:m[n])?a:"";h.length&&"effect"!==f.type&&t.set(p,{input:l,marking:__spreadProps(__spreadValues({},f),{key:h})})})),h.length&&setTimeout((()=>{e.boardImages.unmark(h)}),1500)}}function createSetWindow$1({boardImagesDOM:e,framesMap:t,windowState:n,hotkeysMap:a,shortcuts:l,api:f}){return function setWindow(t){var a,l;n.window=t,e.clearElement(),t&&(e.setSize(t.widthPercent/(null!=(a=t.boardContainerAspectRatio)?a:1),t.heightPercent),e.setWindow({elementClickedCallback:defaultMarkFunction,closeButtonCallback:f.boardImages.hideWindow,elements:getDOMWindowElements(null!=(l=t.elements)?l:[])}))};function getDOMWindowElements(e){const n=new Map,getTitle=e=>[...e,"left click"].join(" + ");return[...a.values()].forEach((e=>{const{keys:t,model:a}=e;if("string"==typeof a)n.set(a,getTitle(t));else{const e=l.find(a);if(e){const{xIndex:a,yIndex:l,frameId:f}=e;n.set(getShortcutId({xIndex:a,yIndex:l,frameId:f}),getTitle(t))}}})),e.map((e=>{if("frameId"in e)return function mapFrameToDOMFrame(e,n){const a=t.get(e.frameId);if(!a){const n=getFrameNotFoundError(e.frameId,[...t.keys()]);throw new Error(n)}const{frameId:l,emptyItemsPerRow:f,itemsAutoRemove:p}=e,{itemsPerRow:h,rows:m,imageURL:g}=a;return{id:l,emptyItemsPerRow:f,itemsPerRow:h,rows:m,imageURL:g,itemsAutoRemove:p,titles:getTitlesForDOMFrame(a,n)}}(e,n);{const{effects:t,id:a,emptyItemsPerRow:l,itemsPerRow:f}=e;return{id:a,emptyItemsPerRow:l,itemsPerRow:f,effects:t.map((e=>{if("string"==typeof e){const t=n.get(e);return t?{title:t,type:e}:e}return e}))}}}))}function getTitlesForDOMFrame(e,t){const{itemsPerRow:n,rows:a,id:l}=e;return[...Array(n*a)].map(((e,a)=>{var f;const p=getShortcutId({xIndex:a%n,yIndex:Math.floor(a/n),frameId:l});return null!=(f=t.get(p))?f:""}))}function defaultMarkFunction(e){n.windowPosition&&("type"in e?f.boardImages.mark({square:n.windowPosition,model:e.type}):f.boardImages.mark({square:n.windowPosition,model:e}),f.boardImages.hideWindow())}}function createInitDefault(e){return function initDefault(t={}){const n=window.location.href.replace(window.location.search,""),{imagesBaseURL:a=`${n}/static/test`,soundsBaseURL:l=`${n}/static/test/sounds`,boardContainerAspectRatio:f=1}=t,{defaultFrames:p,defaultWindow:h,defaultHotkeys:m}=function getDefaultValues({imagesBaseURL:e,soundsBaseURL:t,boardContainerAspectRatio:n}){const a=`${e}/animated-images`;return{defaultFrames:[{id:"objective-markers",imageURL:`${e}/objective-markers.png`,rows:1,itemsPerRow:5,itemsConfiguration:[{name:"star",animatedImageURL:`${a}/star.png`,removalSoundBaseURL:t},{name:"coin",animatedImageURL:`${a}/coin.png`,removalSoundBaseURL:t},{name:"target",animatedImageURL:`${a}/target.png`,removalSoundBaseURL:t},{name:"skull",animatedImageURL:`${a}/skull.png`,removalSoundBaseURL:t},{name:"bomb",animatedImageURL:`${a}/bomb.png`,removalSoundBaseURL:t}]},{id:"emotive-markers",imageURL:`${e}/emotive-markers.png`,rows:17,itemsPerRow:5,itemsConfiguration:["happy","sad","wut","wink","cry","cheeky","meh","bigsmile","cringe","mad","blush","shock","dead","sleepy","tongue","lol","crying","horror","love","nerd","glasses","mustache","kisses","mindblow","stareyes","sick","devil","ghost","scream","facepalm","thumbsup","thumbsdown","worship","wave","clap","knuckles","muscle","donkey","clock","fire","troll","donut","earth","panda","unicorn","shakehands","resign","gameover","bullet","blitz","skewer","fork","pin","fish","trophy","arena","puzzle","computer","scc","tt","tilt","960","doubleexclam","doublequestion","10","1","12","hype","gg","rip","present","gold","stockfish","lc0","komodo","danny","omg","robert","hikaru","anna","alexandra","andrea","levy","eric","aman"]}],defaultWindow:{heightPercent:50,widthPercent:40,boardContainerAspectRatio:n,elements:[{id:"effects",itemsPerRow:5,effects:[Pe.Brilliant,Pe.GreatFind,Pe.BestMove,Pe.Excellent,Pe.Correct,Pe.Equal,Pe.Interesting,Pe.Inaccuracy,Pe.Mistake,Pe.Blunder,Pe.Incorrect,Pe.Book,Pe.Warning,Pe.WinnerWhite]},{frameId:"objective-markers"},{frameId:"emotive-markers",itemsAutoRemove:!0}]},defaultHotkeys:[{keys:["B"],model:Pe.Brilliant},{keys:["G"],model:Pe.GreatFind},{keys:["B","E"],model:Pe.BestMove},{keys:["G","D"],model:Pe.Excellent},{keys:["K"],model:Pe.Correct},{keys:["E","Q"],model:Pe.Equal},{keys:["I"],model:Pe.Interesting},{keys:["D"],model:Pe.Inaccuracy},{keys:["M"],model:Pe.Mistake},{keys:["L"],model:Pe.Blunder},{keys:["W"],model:Pe.Incorrect},{keys:["O"],model:Pe.Book},{keys:["H"],model:Pe.Warning},{keys:["shift","8"],model:Pe.WinnerWhite},{keys:["S"],model:{name:"star"}},{keys:["C"],model:{name:"coin"}},{keys:["T"],model:{name:"target"}},{keys:["S","K"],model:{name:"skull"}},{keys:["F"],model:{name:"bomb"}},{keys:["0"],model:{name:"happy",autoRemove:!0}},{keys:["shift","S"],model:{name:"sad",autoRemove:!0}},{keys:["shift","W"],model:{name:"wut",autoRemove:!0}},{keys:["shift","0"],model:{name:"wink",autoRemove:!0}},{keys:["shift","R"],model:{name:"cry",autoRemove:!0}},{keys:["shift","Q"],model:{name:"cheeky",autoRemove:!0}},{keys:["shift","E"],model:{name:"meh",autoRemove:!0}},{keys:["shift","B"],model:{name:"bigsmile",autoRemove:!0}},{keys:["shift","C"],model:{name:"cringe",autoRemove:!0}},{keys:["shift","1"],model:{name:"mad",autoRemove:!0}},{keys:["shift","U"],model:{name:"blush",autoRemove:!0}},{keys:["shift","O"],model:{name:"shock",autoRemove:!0}},{keys:["shift","D"],model:{name:"dead",autoRemove:!0}},{keys:["S","E"],model:{name:"sleepy",autoRemove:!0}},{keys:["shift","P"],model:{name:"tongue",autoRemove:!0}},{keys:["shift","L"],model:{name:"lol",autoRemove:!0}},{keys:["shift","I"],model:{name:"crying",autoRemove:!0}},{keys:["shift","H"],model:{name:"horror",autoRemove:!0}},{keys:["shift","V"],model:{name:"love",autoRemove:!0}},{keys:["shift","N"],model:{name:"nerd",autoRemove:!0}},{keys:["shift","G"],model:{name:"glasses",autoRemove:!0}},{keys:["shift","T"],model:{name:"mustache",autoRemove:!0}},{keys:["shift","K"],model:{name:"kisses",autoRemove:!0}},{keys:["shift","M"],model:{name:"mindblow",autoRemove:!0}},{keys:["shift","Y"],model:{name:"stareyes",autoRemove:!0}},{keys:["S","I"],model:{name:"sick",autoRemove:!0}},{keys:["D","V"],model:{name:"devil",autoRemove:!0}},{keys:["G","H"],model:{name:"ghost",autoRemove:!0}},{keys:["shift","J"],model:{name:"scream",autoRemove:!0}},{keys:["shift","F"],model:{name:"facepalm",autoRemove:!0}},{keys:["arrowup"],model:{name:"thumbsup",autoRemove:!0}},{keys:["arrowdown"],model:{name:"thumbsdown",autoRemove:!0}},{keys:["I","P"],model:{name:"worship",autoRemove:!0}},{keys:["W","V"],model:{name:"wave",autoRemove:!0}},{keys:["L","P"],model:{name:"clap",autoRemove:!0}},{keys:["K","N"],model:{name:"knuckles",autoRemove:!0}},{keys:["M","U"],model:{name:"muscle",autoRemove:!0}},{keys:["D","K"],model:{name:"donkey",autoRemove:!0}},{keys:["L","K"],model:{name:"clock",autoRemove:!0}},{keys:["F","R"],model:{name:"fire",autoRemove:!0}},{keys:["T","R"],model:{name:"troll",autoRemove:!0}},{keys:["N","T"],model:{name:"donut",autoRemove:!0}},{keys:["E","T"],model:{name:"earth",autoRemove:!0}},{keys:["P","N"],model:{name:"panda",autoRemove:!0}},{keys:["U","I"],model:{name:"unicorn",autoRemove:!0}},{keys:["S","H"],model:{name:"shakehands",autoRemove:!0}},{keys:["R","E"],model:{name:"resign",autoRemove:!0}},{keys:["G","M"],model:{name:"gameover",autoRemove:!0}},{keys:["B","U"],model:{name:"bullet",autoRemove:!0}},{keys:["B","T"],model:{name:"blitz",autoRemove:!0}},{keys:["W","E"],model:{name:"skewer",autoRemove:!0}},{keys:["R","R"],model:{name:"fork",autoRemove:!0}},{keys:["I","N"],model:{name:"pin",autoRemove:!0}},{keys:["H","I"],model:{name:"fish",autoRemove:!0}},{keys:["H","Y"],model:{name:"trophy",autoRemove:!0}},{keys:["A","R"],model:{name:"arena",autoRemove:!0}},{keys:["U","L"],model:{name:"puzzle",autoRemove:!0}},{keys:["M","P"],model:{name:"computer",autoRemove:!0}},{keys:["S","C"],model:{name:"scc",autoRemove:!0}},{keys:["T","Y"],model:{name:"tt",autoRemove:!0}},{keys:["T","L"],model:{name:"tilt",autoRemove:!0}},{keys:["9"],model:{name:"960",autoRemove:!0}},{keys:["2"],model:{name:"doubleexclam",autoRemove:!0}},{keys:["3"],model:{name:"doublequestion",autoRemove:!0}},{keys:["J"],model:{name:"10",autoRemove:!0}},{keys:["Q"],model:{name:"1",autoRemove:!0}},{keys:["V"],model:{name:"12",autoRemove:!0}},{keys:["Y"],model:{name:"hype",autoRemove:!0}},{keys:["G","E"],model:{name:"gg",autoRemove:!0}},{keys:["R","I"],model:{name:"rip",autoRemove:!0}},{keys:["P"],model:{name:"present",autoRemove:!0}},{keys:["G","L"],model:{name:"gold",autoRemove:!0}},{keys:["S","T"],model:{name:"stockfish",autoRemove:!0}},{keys:["L","0"],model:{name:"lc0",autoRemove:!0}},{keys:["K","O"],model:{name:"komodo",autoRemove:!0}},{keys:["D","N"],model:{name:"danny",autoRemove:!0}},{keys:["O","M"],model:{name:"omg",autoRemove:!0}},{keys:["R","B"],model:{name:"robert",autoRemove:!0}},{keys:["H","K"],model:{name:"hikaru",autoRemove:!0}},{keys:["N","R"],model:{name:"anna",autoRemove:!0}},{keys:["D","R"],model:{name:"alexandra",autoRemove:!0}},{keys:["E","A"],model:{name:"andrea",autoRemove:!0}},{keys:["L","Y"],model:{name:"levy",autoRemove:!0}},{keys:["E","C"],model:{name:"eric",autoRemove:!0}},{keys:["M","N"],model:{name:"aman",autoRemove:!0}}]}}({imagesBaseURL:a,soundsBaseURL:l,boardContainerAspectRatio:f});e.boardImages.reset(),e.boardImages.setFrames(p),e.boardImages.setWindow(h),e.boardImages.setHotkeys(m)}}function getHotkeyId(e){return[...e.map((e=>e.toLowerCase()))].sort().join("-")}function createGetElement(e){return function getElement(){return e}}function initDOMElements(e,t){const n=document.createElement("div");n.className="board-images__window";const a=document.createElement("div");a.className="board-images__window-body";const l=document.createElement("div");l.className="board-images__close-button";const f=document.createElement("div");f.innerHTML='\n<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 19">\n  <defs>\n    <style>\n      .cls-1 {\n        opacity: 0.3;\n      }\n\n      .cls-2 {\n        fill: #f8f8f8;\n      }\n\n      .cls-3 {\n        fill: #8a8886;\n      }\n    </style>\n  </defs>\n  <g>\n    <path class="cls-1" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"/>\n    <circle class="cls-2" cx="9" cy="9" r="8.5"/>\n    <path class="cls-2" d="M9,1A8,8,0,1,1,1,9,8,8,0,0,1,9,1M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"/>\n    <path class="cls-3" d="M13.37,12a.53.53,0,0,1,0,.78l-.59.61a.56.56,0,0,1-.4.17.54.54,0,0,1-.4-.17l-3-3-3,3a.58.58,0,0,1-.4.17.54.54,0,0,1-.39-.17l-.59-.59a.54.54,0,0,1-.17-.4.52.52,0,0,1,.17-.4l3-3-3-3a.52.52,0,0,1-.17-.4.54.54,0,0,1,.17-.4l.59-.59a.56.56,0,0,1,.8,0l3,3,3-3a.58.58,0,0,1,.4-.17.56.56,0,0,1,.4.17l.59.59a.54.54,0,0,1,.17.41.5.5,0,0,1-.17.39l-3,3,3,3Z"/>\n  </g>\n</svg>\n',l.appendChild(f);const p=document.createElement("div");p.className="board-images__title";const h=t.map((e=>"effects"in e?function createElementsForDOMEffects(e){const{id:t,effects:n,itemsPerRow:a,emptyItemsPerRow:l=0}=e,f=a+l,p=document.createElement("div");p.className="board-images__effects-container";const h=n.map(((e,t)=>{const n="string"==typeof e?e:e.type,h=document.createElement("div");if(h.className="board-images__effect","object"==typeof e&&e.title&&h.setAttribute("custom-title",e.title),h.style.width=100/f+"%",h.innerHTML=makeSvgIcon({path:On[n],size:"100%"}),l>0&&t/a>0&&t%a==0){const e=document.createElement("div");e.className="board-images__break",e.style.width=l/f*100+"%",p.append(e)}return p.append(h),{container:h,type:n}}));return{id:t,container:p,domEffects:h}}(e):function createElementsForDOMFrame(e){const{id:t,itemsPerRow:n,rows:a,imageURL:l,emptyItemsPerRow:f=0,itemsAutoRemove:p,titles:h}=e,m=n+f,g=document.createElement("div");g.className="board-images__hover-container",g.style.width=n/m*100+"%";const v=document.createElement("img");return v.className="board-images__image",v.src=l,v.draggable=!1,g.appendChild(v),{id:t,container:g,imageElement:v,itemsPerRow:n,rows:a,itemsAutoRemove:p,titles:h}}(e)));return h.forEach((e=>{a.appendChild(e.container)})),n.appendChild(a),e.appendChild(n),e.appendChild(p),e.appendChild(l),{closeButton:l,titleElement:p,domElements:h}}function limitNumberWithinRange(e,t){return Math.min(Math.max(e,t.min),t.max)}let Mo=-1,xo=-1;function getXYFromEvent({clientX:e,clientY:t,pointer:n,type:a,touches:l}){return(a===Tr.Touchmove||a===Tr.Touchstart)&&l.length>0&&(Mo=l[0].clientX,xo=l[0].clientY),a===Tr.Touchend?{x:Mo,y:xo}:n?{x:n.x,y:n.y}:l&&l.length>0?{x:l[0].clientX,y:l[0].clientY}:{x:null!=e?e:-1,y:null!=t?t:-1}}function translateEventToIndex({itemsPerRow:e,rows:t,imageElement:n,event:a}){const{width:l,height:f}=n;let p,h;if("offsetX"in a)p=a.offsetX,h=a.offsetY;else{const{x:e,y:t}=getXYFromEvent(a);p=e,h=t}return function translateCoordinatesToIndex({offsetX:e,offsetY:t,itemsPerRow:n,rows:a,width:l,height:f}){const p=l/n,h=f/a,m=limitNumberWithinRange(e,{min:0,max:l}),g=limitNumberWithinRange(t,{min:0,max:f});return{xIndex:limitNumberWithinRange(Math.floor(m/p),{min:0,max:n-1}),yIndex:limitNumberWithinRange(Math.floor(g/h),{min:0,max:a-1})}}({offsetX:p,offsetY:h,itemsPerRow:e,rows:t,width:l,height:f})}function addEventListeners({closeButton:e,titleElement:t,domElements:n,closeButtonCallback:a,elementClickedCallback:l}){var f;null==(f=e.firstChild)||f.addEventListener(Er,(e=>{e.stopPropagation(),a()}));const hideTitle=()=>{t.style.display="none",t.innerHTML=""};n.forEach((e=>{"domEffects"in e?function addEventListenersToEffectsDOMElement({domElement:e,titleElement:t,elementClickedCallback:n,hideTitle:a}){const{domEffects:l,id:f}=e;l.forEach(((e,l)=>{const{container:p,type:h}=e,m=p.getAttribute("custom-title");p.addEventListener(Er,(e=>{e.stopPropagation(),n({effectsId:f,index:l,type:h})})),m&&(p.addEventListener(Ar,(()=>{t.innerHTML=m,t.style.display=""})),p.addEventListener("pointerout",a))}))}({domElement:e,titleElement:t,elementClickedCallback:l,hideTitle:hideTitle}):function addEventListenersToFrameDOMElement({domElement:e,elementClickedCallback:t,titleElement:n,hideTitle:a}){const{container:l,imageElement:f,id:p,itemsPerRow:h,rows:m,itemsAutoRemove:g,titles:v=[]}=e;l.addEventListener(Er,(e=>{e.stopPropagation();const{xIndex:n,yIndex:a}=translateEventToIndex({itemsPerRow:h,rows:m,imageElement:f,event:e});t({frameId:p,xIndex:n,yIndex:a,autoRemove:g})})),f.addEventListener(Ar,(e=>{var t;a();const{xIndex:l,yIndex:p}=translateEventToIndex({itemsPerRow:h,rows:m,imageElement:f,event:e});n.innerHTML=null!=(t=v[l+p*h])?t:"",n.style.display=""})),f.addEventListener("pointerout",a)}({domElement:e,elementClickedCallback:l,titleElement:t,hideTitle:hideTitle})}))}function createSetWindow(e){return function setWindow(t){const{closeButtonCallback:n,elementClickedCallback:a,elements:l}=t,{closeButton:f,titleElement:p,domElements:h}=initDOMElements(e,l);addEventListeners({closeButton:f,titleElement:p,domElements:h,closeButtonCallback:n,elementClickedCallback:a})}}function createShowWindow(e){return function showWindow(){e.style.display=""}}function createHideWindow(e){return function hideWindow(){e.style.display="none"}}function createSetSize(e){return function setSize(t,n){e.style.width=t?`${t}%`:"",e.style.height=n?`${n}%`:""}}function createSetPosition(e){const t="horizontal-overflow";return function setPosition({squareCoords:n,widthInPercent:a,heightInPercent:l,allowOverflow:f}={}){if(e.classList.contains(t)&&e.classList.remove(t),!n||!a||!l)return e.style.top="",void(e.style.left="");const{top:p,left:h,overflows:m}=function calculateTopLeftForWindowInSquare({squareCoords:e,heightInPercent:t,widthInPercent:n,allowOverflow:a}){let l=!1,f=e.x,p=e.y;a||(p+t>100&&(p=limitNumberWithinRange(100-t,{min:0,max:100})),f+n>100&&(f=limitNumberWithinRange(f-n-(e.centered?0:12.5),{min:0,max:100}),l=!0));return{top:p,left:f,overflows:l}}({squareCoords:n,heightInPercent:l,widthInPercent:a,allowOverflow:null!=f&&f});m&&e.classList.add(t),e.style.top=`${p}%`,e.style.left=`${h}%`}}function createClearElement(e){return function clearElement(){e.innerHTML=""}}function createResetBoardElement(e){return function resetBoardElement(t){e.remove(),t.appendChild(e)}}function createBoardImagesAPI(e){const t={windowPosition:void 0,window:void 0},{api:n}=e,a=new Map,l=function createKeyedSet({items:e=[],keys:t=[],createKey:n}={}){if(!n&&!t.length)throw new Error("Need to specify at least one key or createKey function");const a=!t.includes("id")&&n?["id",...t]:t,l=a.map((()=>new Map));function set3(e){a.forEach(((t,a)=>{var f;const p=null!=(f=e[t])?f:null==n?void 0:n(e);p&&l[a].set(p,e)}))}return e.forEach((e=>{set3(e)})),{find:function find(e){let t;const f=l.find((l=>{let f=!1;const p=a.find((t=>{const n=e[t];return n&&(f=!0),n&&l.has(n)}));if(p)return t=e[p],!0;const h=null==n?void 0:n(e);if(!f&&!h)throw new Error("Could not find a key or create a key with passed in parameter");return!(!h||!l.has(h)||(t=h,0))}));return t&&(null==f?void 0:f.get(t))},set:set3,getAsArray:function getAsArray(){var e;return[...null==(e=l[0])?void 0:e.values()]},clear:function clear5(){l.forEach((e=>e.clear()))}}}({keys:["id","name"],createKey:getShortcutId}),f=new Map,p=function createBoardImagesDOMService(){const e=function createBoardImagesElement(){const e=document.createElement("div");return e.className="board-images",e.style.display="none",e.addEventListener("pointerdown",(e=>{e.stopPropagation()})),e.addEventListener("wheel",(e=>{e.stopPropagation()})),e}();return{showWindow:createShowWindow(e),hideWindow:createHideWindow(e),setWindow:createSetWindow(e),setSize:createSetSize(e),setPosition:createSetPosition(e),getElement:createGetElement(e),clearElement:createClearElement(e),resetBoardElement:createResetBoardElement(e)}}(),h=new Map;return function createAPIFunctions(e){const p=function createGetHotkey(e){return function getHotkey(t){return e.get(getHotkeyId(t))}}(h),m=function createGetHotkeys(e){return function getHotkeys(){return[...e.values()]}}(h),g=function createGetFrames(e){return function getFrames(){return[...e.values()]}}(a),v=createSetFrames({api:n,framesMap:a,shortcuts:l}),y=function createGetAllMarkingShortcuts(e){return function getAllMarkingShortcuts(){return e.getAsArray()}}(l),_=function createGetMarkingShortcut(e){return function getMarkingShortcut(t){return e.find({name:t})}}(l),b=function createUnmark$1(e,t){return function unmark(n){const a=Array.isArray(n)?n:[n],l=[];a.forEach((e=>{const n=t.get(e);n&&(l.push(n.marking.key),t.delete(e))})),l.length&&(l.length>1?e.markings.removeMany(l):e.markings.removeOne(l[0]))}}(n,f),C=createMark$1({api:n,markedSquares:f,framesMap:a,shortcuts:l}),S=function createIsMarked(e){return function isMarked(t){return e.has(t)}}(f),k=function createGetMarkings$1(e){return function getMarkings(){return[...e.values()].map((e=>e.input))}}(f),w=function createClearMarkings$1(e,t){return function clearMarkings(){const n=[...e.keys()];n.length&&t.boardImages.unmark(n)}}(f,n),T=function createGetWindow(e){return function getWindow(){return e.window}}(t),P=function createHideWindow$1({windowState:e,api:t,boardImagesDOM:n}){return function hideWindow(){const{window:a,windowPosition:l}=e;if(a){if(l){const a=t.markings.getAllWhere({types:[B]}).find((e=>e.data.square===l));a&&t.markings.removeOne(a.key),e.windowPosition=void 0,n.setPosition()}n.hideWindow()}}}({windowState:t,api:n,boardImagesDOM:e}),A=function createIsInitialized(e){return function isInitialized(){return!!e.boardImages.getWindow()&&e.boardImages.getFrames().length>0&&e.boardImages.getHotkeys().length>0}}(n),M=createSetWindow$1({boardImagesDOM:e,framesMap:a,windowState:t,hotkeysMap:h,shortcuts:l,api:n}),x=function createSetHotkeys({hotkeysMap:e,windowState:t,api:n}){return function setHotkeys(a=[]){e.clear(),a.forEach((t=>{const n=getHotkeyId(t.keys);if(e.has(n))throw new Error(function getHotkeyError(e){return`Hotkey combination already in use: ${e.join(", ")})`}(t.keys));e.set(n,t)})),n.boardImages.setWindow(t.window)}}({windowState:t,hotkeysMap:h,api:n}),O=function createShowWindow$1({windowState:e,api:t,boardImagesDOM:n}){return function showWindow({square:a,squareCoords:l,allowWindowOverflow:f=!1}){var p;const{window:h,windowPosition:m}=e;if(h){if(m){const e=t.markings.getAllWhere({types:[B]}).find((e=>e.data.square===m));e&&t.markings.removeOne(e.key)}e.windowPosition=a,t.markings.addOne({data:{square:a,color:ht.HighlightColors.Selected,opacity:.5},persistent:!0,type:B}),n.setPosition({squareCoords:l,heightInPercent:h.heightPercent,widthInPercent:h.widthPercent/(null!=(p=h.boardContainerAspectRatio)?p:1),allowOverflow:f}),n.showWindow()}}}({windowState:t,api:n,boardImagesDOM:e}),R=function createGetWindowPosition(e){return function getWindowPosition(){const{window:t,windowPosition:n}=e;if(t)return n}}(t),I=function createToggleWindow(e){return function toggleWindow({square:t,squareCoords:n,allowWindowOverflow:a=!1}){t===e.boardImages.getWindowPosition()?e.boardImages.hideWindow():e.boardImages.showWindow({square:t,squareCoords:n,allowWindowOverflow:a})}}(n),L=function createReset(e){return function reset2(){e.boardImages.setFrames(),e.boardImages.clearMarkings(),e.boardImages.hideWindow(),e.boardImages.setWindow(),e.boardImages.setHotkeys()}}(n),N=createInitDefault(n),D=function createDestroy$1(e,t){return function destroy10(){e.boardImages.reset(),t.getElement().remove()}}(n,e);return{initDefault:N,reset:L,destroy:D,isInitialized:A,getFrames:g,setFrames:v,getAllMarkingShortcuts:y,getMarkingShortcut:_,setHotkeys:x,getHotkeys:m,getHotkey:p,mark:C,unmark:b,isMarked:S,getMarkings:k,clearMarkings:w,getWindow:T,setWindow:M,showWindow:O,hideWindow:P,toggleWindow:I,getWindowPosition:R,dom:e}}(p)}function getSquareCoords({square:e,el:t,renderer:n,boardFlipped:a=!1}){if(!n)return{x:0,y:0};const l=n.getCoordsFromSquare(e,a);return n.name===Mt.Types.WebGL2D?{x:l.x/t.clientWidth*100+6.25,y:l.y/t.clientHeight*100-6.25}:n.name===Mt.Types.WebGL3D?{x:l.x/t.clientWidth*100,y:l.y/t.clientHeight*100,centered:!0}:{x:(l.x+100)/800*100,y:l.y/800*100}}function createMinimalPlugins(){return[createAssetsPlugin(),createBoardSizePlugin(),createPiecesPlugin(),createRendererErrorCatcherPlugin()]}function createStandardPlugins({exclude:e}={}){const t={[Ln.Plugin.Name]:createKeysPlugin,[a.Plugin.Name]:createAccessibilityPlugin,[F.Plugin.Name]:createArrowKeysPlugin,[H.Plugin.Name]:createArrowsPlugin,[W.Plugin.Name]:createBlinkingHighlightPlugin,[se.Plugin.Name]:createCoordinatesPlugin,[Rn.Plugin.Name]:createFlipBoardPlugin,[A.Plugin.Name]:createHighlightsPlugin,[Le.Plugin.Name]:createHoverSquarePlugin,[jn.Plugin.Name]:createMarkingsPlugin,[ft.Plugin.Name]:createBoardDisabledPlugin,[De.Plugin.Name]:createMoveHintsPlugin,[Ke.Plugin.Name]:createSoundsPlugin};e&&e.forEach((e=>{delete t[e]}));const n=[getSelectionSquare,getMoveHighlights,getAnalysisHighlights],l=[...createMinimalPlugins()];return Object.keys(t).forEach((e=>e===A.Plugin.Name?l.push(t[e](n)):l.push(t[e]()))),l}function createPremiumPlugins(){return[...createStandardPlugins(),createFadeSetupPlugin(),createEffectsPlugin(),createCustomItemsPlugin(),createCheatDetectionPlugin()]}Symbol.toStringTag;const Oo=/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*((\d|\.)+))?\)$/;function rgbToHex(e){if(-1===e.search("rgb"))return e;const t=e.match(Oo);return`#${hexValue(t[1])}${hexValue(t[2])}${hexValue(t[3])}`}function rgbaToOpacity(e){return-1===e.search("rgba")?1:parseFloat(e.match(Oo)[4])}function hexValue(e){return`0${parseInt(e,10).toString(16)}`.slice(-2)}function getElementBackgroundImage(e,t){return window.getComputedStyle(e,t).backgroundImage}function getPieceShortStringFromUrl(e){const[t,n]=e.split("/").pop().split(".")[0];return"w"===t?n.toUpperCase():n}function getFileRankFromSan(e){return{file:e.toLowerCase().charCodeAt(0)-96,rank:Number(e.charAt(1))}}function getSanFromFileRank$1(e){if(!(!e||!e.file||!e.rank||e.file>8||e.rank>8))return`${String.fromCharCode(96+e.file)}${e.rank.toString()}`}function buildMode({base:e,initialOptions:t}){return function getBoundMode(n){const a=Object.keys(t).reduce(((e,n)=>(e[n]=t[n].default,e)),{}),l=e({api:n,options:a}),f=function createExtendMode(e,t){return function extendMode(n){const a=Object.entries(n).map((([n,a])=>{var l;if(!a||!(null==(l=e.overridableMethods)?void 0:l.includes(n)))return;const f=e[n];return e[n]=a(e,t),function destroyOverride(){e[n]=f}}));return function destroyOverride(){a.map((e=>null==e?void 0:e()))}}}(l,n);return Object.assign(l,{extendMode:f,getOptions:function getOptions(){return a},setOption:function setOption(e,n){var l;if(!(null==(l=t[e])?void 0:l.editable))return void warnOptionNotEditable(e);a[e]=n}})}}function createModeFactory(e,t){return function createMode(n={}){const a=Object.keys(n).reduce(((e,a)=>{var l;return(null==(l=t[a])?void 0:l.editable)?Object.assign(e,{[a]:{default:n[a],editable:!0}}):warnOptionNotEditable(a),e}),t);return buildMode({base:e,initialOptions:a})}}function warnOptionNotEditable(e){console.warn(`${e} is not an editable option in this mode.`)}function canMoveForward({api:e,followAlternateLines:t=!1,mv:n}){const{game:a,mutateGame:l}=e.getContext(),f=l((function callMethod(){a.moveForward(t,n)}));return!!(null==f?void 0:f.plyDiff)&&(a.moveBackward(),!0)}function createMove$7(e){const{api:t}=e,n=t.move;return function move(e){const a=t.isAtEndOfLine(),{canAddMovesToMainLine:l}=t.getMode().getOptions();return canMoveForward({api:t,followAlternateLines:!0,mv:e})?n(e):function shouldAddContinuation({canAddMovesToMainLine:e,isAtEndOfLine:t,node:n}){var a;const l=isNode(n)?null==(a=null==n?void 0:n.ids)?void 0:a.line:null==n?void 0:n.id;return!e&&t&&0===l}({canAddMovesToMainLine:l,isAtEndOfLine:a,node:t.getRelativeNode()})?function addContinuation(){if(t.createContinuation())return n(e);return null}():n(e)}}var Ro,Io,Lo,No,Do,Bo;(function(e){e.Name="analysis"})((Io=Ro||(Ro={})).Plugin||(Io.Plugin={})),function(e){e.Name="effectsHMLSync"}((No=Lo||(Lo={})).Plugin||(No.Plugin={})),(Bo=Do||(Do={})).GreatFind="!",Bo.Mistake="?",Bo.Brilliant="!!",Bo.Blunder="??",Bo.Interesting="!?",Bo.Inaccuracy="?!",Bo.Drawish="=",Bo.Unclear="",Bo.WhiteHasModerateAdvantage="",Bo.BlackHasModerateAdvantage="",Bo.WhiteHasDecisiveAdvantage="+-",Bo.BlackHasDecisiveAdvantage="-+",Bo.PositionInZugzwang="",Bo.WithCompensation="",Bo.Novelty="N",Bo.WithAttack="=/";const Fo=function createGetAnnotationName(){const e=new Map;return Object.keys(Do).forEach((t=>{const n=Do[t];e.set(n,t)})),function getName(t){if(t)return e.get(t)}}();function annotationAdded(e,t){const{data:n}=e;if(n.changes.userGenerated)return!1;const a=Fo(n.changes.annotation);return Boolean(a)}function annotationRemoved(e,t){const{data:n}=e;return!n.changes.userGenerated&&("annotation"in n.changes&&!n.changes.annotation)}function selectedNodeUpdated(e,t){const{data:n}=e,{api:a}=t;if(n.changes.userGenerated)return!1;const l=a.getSelectedNode();if(!isNode(l))return!1;const{ids:f}=l,{ids:p}=n;return!(!f||!p)&&(p.move===f.move&&p.line===f.line)}function unselectedNodeUpdated(e,t){var n,a;const{data:l}=e,{api:f}=t;if(l.changes.userGenerated)return!1;const p=f.getSelectedNode(),{ids:h}=l;return!!h&&(h.move!==(null==(n=null==p?void 0:p.ids)?void 0:n.move)||h.line===(null==(a=null==p?void 0:p.ids)?void 0:a.line))}function selectedNodeHasAnnotation(e,t){const{api:n}=t,a=n.getSelectedNode();return!!isNode(a)&&Boolean(a.annotation)}function selectedNodeAnnotationDoesNotMatchEffect(e,t){var n;const{api:a}=t,l=a.markings,f=a.getSelectedNode();if(!isNode(f))return!1;const p=Fo(f.annotation);if(!p)return!1;const h=l.getAllWhere({types:[Te]}).find((e=>e.data.square===(null==f?void 0:f.to)&&e.node));return p!==(null==(n=null==h?void 0:h.data)?void 0:n.type)}function addEffect(e,t){const{data:n}=e,{api:a,queue:l}=t,f=a.markings,p=Fo(n.node.annotation);l.add((function addMarking(){f.addOne({data:{square:n.node.to,type:p},persistent:!0,node:!0,type:Te})}))}function removeEffect(e,t){const{data:n}=e,{api:a,queue:l}=t,f=a.markings,p=f.getAllWhere({types:[Te]}).find((e=>e.data.square===n.node.to));p&&l.add((function removeMarking(){f.removeOne(p.key)}))}function updateAnnotation(e,t){var n;const{api:a,queue:l}=t,f=a.getSelectedNode();if(!isNode(f))return;const p=e.data.filter(isType(Te)).find((e=>e.data.square===f.to&&e.node));if(!p)return;const h=null!=(n=Do[p.data.type])?n:"";f.annotation&&f.annotation===h||l.add((function refreshAnnotation(){l.add((function refreshAnnotationInNextCycle(){a.updateNode(f.ids,{annotation:h,userGenerated:!0})}))}))}function removeAnnotation(e,t){const{api:n,queue:a}=t,l=n.getSelectedNode();if(!isNode(l))return;const f=e.data.filter(isType(Te)).find((e=>e.data.square===l.to&&e.node));f&&Do[f.data.type]&&a.add((function clearAnnotation(){n.updateNode(l.ids,{annotation:"",userGenerated:!0})}))}function removeEffectFromJCE(e,t){const{data:n}=e,{api:a}=t,{move:l,line:f}=n.ids,{game:p}=a.getContext(),h=p.ids();p.selectPosition(l,f);const m=getMarkingsFromJCE(p).find((e=>e.data.square===n.node.to&&"effect"===e.type));m&&removeFromJCENode(p,m),p.selectPosition(h.move,h.line)}function queueAddEffect(e,t){const{api:n,queue:a}=t,l=n.markings,f=n.getSelectedNode();if(!isNode(f))return;const{annotation:p}=f;a.add((function addEffect2(){a.add((function addEffectInNextCycle(){const e=n.getSelectedNode();if(!isNode(e))return;const{annotation:t}=e,a=Fo((null==t?void 0:t.length)?t:p);a&&l.addOne({data:{square:null==f?void 0:f.to,type:a},persistent:!0,node:!0,type:Te})}))}))}var jo,$o;(function(e){e.Analysis="analysis",e.CaptureTheStar="capture-the-star",e.Explorer="exploring",e.GuessTheMove="guess-the-move",e.PassiveObserving="passive-observing",e.Observing="observing",e.Playing="playing",e.Setup="setup"})(($o=jo||(jo={})).Types||($o.Types={}));const Ho=createModeFactory((function base$7({api:e}){return{isAllowedToMove:function isAllowedToMove(){const{canAddMovesToMainLine:t}=e.getMode().getOptions();return t||Boolean(e.getSelectedNode())},name:jo.Types.Analysis,plugins:[{apiOverrides:{move:createMove$7},name:Ro.Plugin.Name},createAnalysisOverlayPlugin(),{match:[{condition:isMark(Te),handler:updateAnnotation},{condition:pipeConditions(isUnmark(Te),selectedNodeHasAnnotation),handler:removeAnnotation},{condition:pipeConditions(is(f.APIEvents.NodeUpdated),selectedNodeUpdated,annotationAdded,selectedNodeAnnotationDoesNotMatchEffect),handler:addEffect},{condition:pipeConditions(is(f.APIEvents.NodeUpdated),selectedNodeUpdated,annotationRemoved),handler:removeEffect},{condition:pipeConditions(isOneOf(Fn),selectedNodeHasAnnotation),handler:queueAddEffect},{condition:pipeConditions(is(f.APIEvents.NodeUpdated),unselectedNodeUpdated),handler:removeEffectFromJCE}],name:Lo.Plugin.Name}]}}),{canAddMovesToMainLine:{default:!0,editable:!0},canInteractWithPieces:{default:!0,editable:!0},canMoveWhenGameIsOver:{default:!0,editable:!1},canModifyExistingMovesOnMainLine:{default:!0,editable:!0}});var Vo,Uo;Symbol.toStringTag;function createConfigureitems(e){return function configureItems(t){e.config.set("items",t)}}function createGetCurrentMoveCount(e){return function getCurrentMoveCount(){var t;return(null==(t=e.getHistorySANs())?void 0:t.length)-1||0}}function createGetData(e,t){return function getData(){const n=e.captureTheStar;return{completed:t.status.get("completed")||!1,completedMoveCount:t.status.get("completedMoveCount"),itemsRemaining:n.getNumItemsRemaining(),moveCount:n.getCurrentMoveCount()}}}function createGetItems(e){return function getItems(t={}){const{api:n,game:a}=e,l=n.markings,{previousNode:f}=t;let p=[];if(f){const e=a.ids();a.moveBackward(),p=getItems(),a.selectPosition(e.move,e.line)}else p=l.getAllWhere({types:[de]});return p}}function createGetItemSquares(e){return function getItemSquares(){return e.captureTheStar.getItems().map((e=>e.data.square))}}(function(e){e.Completed="CTSCompleted"})((Uo=Vo||(Vo={})).Events||(Uo.Events={})),function(e){e.Name="captureTheStar"}(Uo.Plugin||(Uo.Plugin={}));const Go='Move object has no "from" square.',qo="Cannot load without any items.",Wo="Cannot load without a piece.",zo="Configuration missing for custom item";function getIntermediateSquares(e,t){const{file:n,rank:a}=getFileRankFromSan$1(e),{file:l,rank:f}=getFileRankFromSan$1(t),p="abcdefgh",h="12345678";if(n===l)return getIntegersBetweenTwoNumbers(a,f).map((e=>`${p.charAt(n-1)}${h.charAt(e-1)}`));if(a===f)return getIntegersBetweenTwoNumbers(n,l).map((e=>`${p.charAt(e-1)}${h.charAt(a-1)}`));if(Math.abs(l-n)!==Math.abs(f-a))throw new Error("Squares are not on same file, rank, or diagonal");const m=getIntegersBetweenTwoNumbers(n,l),g=getIntegersBetweenTwoNumbers(a,f);return m.reduce(((e,t,n)=>(e.push(`${p.charAt(t-1)}${h.charAt(g[n]-1)}`),e)),[])}function getIntegersBetweenTwoNumbers(e,t){const[n,a]=[e,t].sort();return Array(a-n-1).fill(void 0).map(((e,t)=>n+t+1))}function createGetNextItems(e){return function getNextItems(t){const n=e.captureTheStar,{from:a,to:l}=t;if(!a)throw new Error(Go);let f=[];return f="n"===t.piece.toLowerCase()?[l]:[l,...getIntermediateSquares(a,l)],n.getItems({previousNode:!0}).filter((e=>!f.includes(e.data.square)))}}function createGetNumItemsRemaining(e){return function getNumItemsRemaining(){const t=e.captureTheStar;return Object.keys(t.getItems()).length}}function createIsCompleted(e){return function isCompleted(){return Boolean(e.status.get("completed"))}}function createLoad$2(e,t){return function load3(n){const{items:a,piece:l}=n,{api:p,game:h,respond:m}=e,g=p.captureTheStar,v=p.markings;if(!Object.keys(a).length)throw new Error(qo);if(!l)throw new Error(Wo);return p.clearMarkings(),h.load("8/8/8/8/8/8/8/8"),h.put(l,l.square),Object.entries(a).forEach((([e,n])=>{const a=function createCTSMarking(e,t,n){const a=null==e?void 0:e[n];if(!ge[n]&&!a)return null;const l={data:{square:t,type:a?ge.Image:ge.Star},node:!0,persistent:!0,type:de,key:`cts-${t}`};return a&&(l.data.image={url:a}),l}(t.config.get("items"),e,n);if(!a)throw new Error(zo);v.addOne(a)})),p.setPlayingAs(l.color),p.setTurn(l.color),g.resetPuzzleStatus(),m(f.APIEvents.Load,{pieces:p.getPieces()})}}function createUpdatePuzzleStatus(e,t){return function updatePuzzleStatus(){const n=e.captureTheStar;0!==n.getNumItemsRemaining()||n.isCompleted()||(t.status.set("completed",!0),t.status.set("completedMoveCount",n.getCurrentMoveCount()),n.emit(Vo.Events.Completed,n.getData()))}}function createCaptureTheStarAPI(e){const{api:t}=e,n=(0,x.a)(),a=function createInternalAPI(){const e=new Map,t=new Map;return{config:e,status:t}}();a.config.set("items",{});const l=function createResetPuzzleStatus(e){return function resetPuzzleStatus(){e.status.set("completed",!1),e.status.delete("completedMoveCount")}}(a);return l(),__spreadProps(__spreadValues({configureItems:createConfigureitems(a),getCurrentMoveCount:createGetCurrentMoveCount(t),getData:createGetData(t,a),getItems:createGetItems(e),getItemSquares:createGetItemSquares(t),getNextItems:createGetNextItems(t),getNumItemsRemaining:createGetNumItemsRemaining(t)},n),{isCompleted:createIsCompleted(a),load:createLoad$2(e,a),resetPuzzleStatus:l,updatePuzzleStatus:createUpdatePuzzleStatus(t,a)})}function getOppositeColor(e){return e===qn.ColorsAsNumbers.Black?qn.ColorsAsNumbers.White:qn.ColorsAsNumbers.Black}function createGetLegalMoves$1(e){const{api:t,game:n}=e,a=t.getLegalMoves;return function getLegalMoves(){const e=t.captureTheStar;if(!t.getPlayingAs())return[];const l=a(),f=n.getPieces(!1)[0];if(!f||"p"!==f.type)return l;const p=function buildFEN(e,t){const n=getOppositeColor(t.color)===qn.ColorsAsNumbers.Black?"p":"P",a=t.color===qn.ColorsAsNumbers.Black?t.type:t.type.toUpperCase(),l=new Array(8).fill(void 0).map((()=>new Array(8).fill(".")));return l[8-t.rank][t.file-1]=a,e.reduce(((e,t)=>{const{file:a,rank:l}=getFileRankFromSan$1(t);return a&&l?(e[8-l][a-1]=n,e):e}),l).map((e=>e.join("").replace(/(\.+)/g,(e=>e.length.toString())))).join("/")}(e.getItemSquares(),f),h=x.J.getLegalMoves(p);return function deduplicateByKey(e,t){return[...new Map(e.map((e=>[e[t],e]))).values()]}([...l,...h],"san")}}function createGetMove$2(e){const{api:t}=e,n=t.getMove;return function getMove(e){var a;const l=n(e);return l||(null!=(a=t.getLegalMoves().find((t=>t.to===e.to)))?a:null)}}function createMove$6(e){const{api:t,game:n}=e,a=t.move;return function move(e){if(!t.isAtEndOfLine())return t.selectLineEnd();if(!e.userGenerated||!("flags"in e))return a(e);const l=e;return isCapture(l)&&"p"===l.piece&&n.put({type:"p",color:getOppositeColor(l.color)},e.to),a(e)}}function createMoveBackward$1(e){return function moveBackward(){var t;const{respond:n,game:a,mutateGame:l}=e,p=l((function callMethod(){a.moveBackward()}));return!p||0===p.lineDiff&&0===p.plyDiff?n(f.APIEvents.MoveBackward,null):((null==(t=p.move)?void 0:t.captured)&&(p.move.captured=void 0),n(f.APIEvents.MoveBackward,p))}}function createHandleIllegalMove(e){return function handleIllegalMove(){e.isAtEndOfLine()||e.selectLineEnd()}}const Ko=createModeFactory((function base$6({api:e}){return{isAllowedToMove:function isAllowedToMove(){return!0},handleIllegalMove:createHandleIllegalMove(e),name:jo.Types.CaptureTheStar,plugins:[{api:createCaptureTheStarAPI,apiOverrides:{getLegalMoves:createGetLegalMoves$1,getMove:createGetMove$2,move:createMove$6,moveBackward:createMoveBackward$1},create:function create3(e){const{api:n}=e,a=n.captureTheStar;t&&a.configureItems(t.items)},match:[{condition:isOneOf(Fn),handler:function setTurn(e,t){const{api:n,queue:a}=t,l=n.getPlayingAs();l&&a.add(n.setTurn,l)}},{condition:is(f.APIEvents.Move),handler:function handleMove2(e,t){const{api:n,queue:a}=t,l=n.captureTheStar,f=n.markings,p=n.getContext().game,h=l.getNextItems(e.data.move);a.add((function refreshCTS(){a.add((function refreshInNextCycle(){f.addMany(h),p.turn(n.getPlayingAs()),l.updatePuzzleStatus()}))}))}}],name:Vo.Plugin.Name}],usePlayingAs:!0};var t}),{canAddMovesToMainLine:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!1}});var Zo,Qo;Symbol.toStringTag;function getIdsToDelete(e){return isNode(e)?{line:e.ids.line,move:e.ids.move+1}:{line:0,move:0}}function createMove$5(e){const{api:t}=e,n=t.move;return function move(e){if(t.isAtEndOfLine())return n(e);const{line:a,move:l}=getIdsToDelete(t.getRelativeNode());return t.deletePosition(l,a),n(e)}}(function(e){e.Name="exploring"})((Qo=Zo||(Zo={})).Plugin||(Qo.Plugin={}));const Xo=createModeFactory((function base$5(){return{isAllowedToMove:function isAllowedToMove(){return!0},name:jo.Types.Explorer,plugins:[{apiOverrides:{move:createMove$5},name:Zo.Plugin.Name}]}}),{canAddMovesToMainLine:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!0,editable:!1}});var Yo,Jo,ei;Symbol.toStringTag;function createGuessTheMoveAPI(e){let t=[];return{cancel:function cancel(){const{api:n,respond:a}=e,l=getActiveGuess();if(!l)return;t.pop(),a(f.APIEvents.SetBoardPosition,{pieces:n.getPieces()}),a(Yo.APIEvents.CancelGuess,l)},confirm:function confirm(t){const{respond:n}=e,a=getLastGuess();if(!a)return;Object.assign(a,{confirmed:!0,correct:t}),n(Yo.APIEvents.GuessConfirmed,a)},get:function get2(){return t},getActiveGuess:getActiveGuess,guess:function guess(n){var a,l;const{api:f,respond:p}=e,h=__spreadProps(__spreadValues({},n),{confirmed:!1,correct:!1,ids:null!=(l=null==(a=f.getSelectedNode())?void 0:a.ids)?l:{line:0,move:0}});t.push(h),p(Yo.APIEvents.GuessMade,h)},reset:function reset2(){t=[]}};function getActiveGuess(){const e=getLastGuess();return(null==e?void 0:e.confirmed)?void 0:e}function getLastGuess(){return t[t.length-1]}}function createMove$4(e){const{api:t,game:n,respond:a}=e,l=t.move;return function move(e){return e.userGenerated?function handleGuessAttempt(e){if(t.isLegalMove(e)){const l=n.move(e);if(!l)return a(f.APIEvents.IllegalMove);t.guessTheMove.guess(l);const p=__spreadValues({},t.getPieces());return n.undo(),a(f.APIEvents.SetBoardPosition,{pieces:p})}return a(f.APIEvents.IllegalMove)}(e):function handleGameMoveAndConfirmGuess(e){const n=__spreadValues({},e),a=t.guessTheMove.getActiveGuess(),f=t.getMove(e);if(!f||!a)return t.isAtEndOfLine()?l(e):t.addMoveToEndOfLine(n);const p=f.color===t.getPlayingAs()&&f.san===a.san;return e.animate=!p,t.reload(),l(e),t.guessTheMove.confirm(p)}(e)}}(function(e){e.Name="guessTheMove"})((Jo=Yo||(Yo={})).Plugin||(Jo.Plugin={})),function(e){e.CancelGuess="CancelGuess",e.GuessConfirmed="GuessConfirmed",e.GuessMade="GuessMade"}(Jo.APIEvents||(Jo.APIEvents={})),(ei=Jo.Colors||(Jo.Colors={})).Correct="#96bc4b",ei.Incorrect="#c93430";function getGuessTheMoveHighlights(e,t){var n;const{api:a,options:l}=t,f=null==(n=a.guessTheMove)?void 0:n.getActiveGuess();if(!l||!l.allowMarkings||!f)return[];const p=[];if(f.from){const e=createKeyedHighlight({color:l.premoveHighlightColor,opacity:l.premoveHighlightOpacity,square:f.from,type:"gtm"});p.push(e)}const h=createKeyedHighlight({color:l.premoveHighlightColor,opacity:l.premoveHighlightOpacity,square:f.kingTo||f.to,type:"gtm"});return p.push(h),p}function createGuessTheMoveModePlugin(){let e=!1;return{api:createGuessTheMoveAPI,apiOverrides:{move:createMove$4},beforeState:[{condition:is(f.UserEvents.PointerdownRight),handler:function cancelGuess(e,{api:t,queue:n}){if(!t.guessTheMove.getActiveGuess())return!0;return n.add(t.guessTheMove.cancel),!1}}],destroy:function destroy10(e){var t;const{api:n}=e;null==(t=n.highlights)||t.removeModule(getGuessTheMoveHighlights)},match:[{condition:isOneOf(Fn),handler:function handler2(e,t){const{api:n,queue:a}=t;e.type===f.APIEvents.Load&&n.guessTheMove.reset();const l=n.getTurn();a.add(n.setPlayingAs,l)}},{condition:isOneOf(Yo.APIEvents),handler:function addHighlights(t,n){var a,l,f;if(e)return;const{api:p}=n;null==(a=p.highlights)||a.addModule(getGuessTheMoveHighlights),(null!=(f=null==(l=p.highlights)?void 0:l.getModules())?f:[]).find((e=>"getGuessTheMoveHighlights"===e.name))&&(e=!0)}},{condition:is(Yo.APIEvents.GuessConfirmed),handler:function handleGuessConfirmation(e,t){const{api:n}=t,{correct:a,ids:l}=e.data;n.updateNode(l,{customColor:a?Yo.Colors.Correct:Yo.Colors.Incorrect})}}],name:Yo.Plugin.Name}}const ti=createModeFactory((function base$4({api:e}){return{isAllowedToMove:function isAllowedToMove(){return e.guessTheMove&&e.isAtEndOfLine()&&!e.guessTheMove.getActiveGuess()},handleIllegalMove:createHandleIllegalMove(e),name:jo.Types.GuessTheMove,plugins:[createGuessTheMoveModePlugin()],usePlayingAs:!0}}),{canAddMovesToMainLine:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!1}});Symbol.toStringTag;function createLoad$1(e){const{api:t,respond:n}=e,a=t.load;return function load3(e,l){const f=t.observing;return f.setCachedPGN(""),f.isAnalyzing()&&(f.clearCachedIds(),n(Rr.APIEvents.AnalysisEnd)),a(e,l)}}function isNullNode(e){return Boolean(e&&"san"in e&&"--"===e.san)}function createMove$3(e){const{api:t,respond:n,game:a}=e,l=t.move;return function move(e){const p=t.observing.getCachedPGN();return p&&t.load({pgn:p}),e.userGenerated?function userGeneratedMove(e){var p;const h=t.observing,{move:m,line:g}=a.ids(),v=h.isAnalyzing(),y=isMainLine(g);0===(null==(p=t.getLine(0))?void 0:p.length)&&a.move("--");const _=t.getNodeByIds({line:0,move:0});isNullNode(_)&&"san"in e&&(e.san="");isNullNode(_)&&isNullNode(t.getSelectedNode())&&t.selectNode(0,-1);y&&!canMoveForward({api:t,followAlternateLines:!0,mv:e})&&t.isAtEndOfLine()&&t.createContinuation();const b=l(e);if((null==b?void 0:b.type)!==f.APIEvents.Move)return b;const C=isMainLine(a.ids().line);!y||C||v||(h.setCachedIds(m,g),n(Rr.APIEvents.AnalysisStart));return b}(e):function programmaticMove(e){const n=t.observing,f=isNullNode(t.getNodeByIds({line:0,move:0})),p=t.getLine(0);if(f&&1===(null==p?void 0:p.length))return void function replaceNullMove({move:e,api:t,game:n}){const a=t.observing,l=n.ids();n.selectPosition(0,0),n.createVariation(),n.move(e);const f=t.getRawLines().length-1;n.promoteVariation(f,0),n.deletePosition(0,f);const{playSounds:p}=t.getOptions();p&&t.setOptions({playSounds:!1});const h=a.getCachedIds();h&&a.clearCachedIds(),t.load({pgn:t.getPGN()}),p&&t.setOptions({playSounds:!0}),h&&a.setCachedIds(h.move,h.line),t.selectNode(l.line,l.move)}({move:e,api:t,game:a});if(n.isAnalyzing()||!t.isAtEndOfLine())return t.addMoveToEndOfLine(e,0);return l(e,!1)}(e)}}function createRestorePosition(e){const{api:t}=e;return function restorePosition2(e,n){const a=t.observing;if(!a.isAnalyzing())return;const l=a.getCachedIds();e?t.load(e,n):t.load({pgn:t.getPGN()}),l&&t.selectNode(l.line,l.move)}}function createObservingModeAPI(e){let t,n="";return{clearCachedIds:function clearCachedIds(){t=void 0},getCachedIds:function getCachedIds(){return t},isAnalyzing:function isAnalyzing(){return Boolean(t)},restorePosition:createRestorePosition(e),setCachedIds:function setCachedIds(e,n){t={move:e,line:n}},setCachedPGN:function setCachedPGN(e){n=e},getCachedPGN:function getCachedPGN(){return n}}}function or(...e){return function checkConditions(t,n){return Boolean(e.find((e=>e(t,n))))}}function nullMovePresent(e,t){const{api:n}=t;return isNullNode(n.getNodeByIds({line:0,move:0}))}function nullMoveAbsent(e,t){const{api:n}=t;return!isNullNode(n.getNodeByIds({line:0,move:0}))}function nullMoveSelected(e,t){const{api:n}=t;return isNullNode(n.getSelectedNode())}function startingPositionSelected(e,t){var n,a;const{api:l}=t,f=l.getSelectedNode();return 0===(null==(n=null==f?void 0:f.ids)?void 0:n.line)&&-1===(null==(a=null==f?void 0:f.ids)?void 0:a.move)}function variationSelected(e,t){const{api:n}=t,a=n.getSelectedNode();return Boolean(a&&0!==a.ids.line)}function firstVariationEmpty(e,t){const{api:n}=t,a=n.getLine(1);return Boolean(!a||0===a.length)}function firstNodeDeletedFromVariation(e,t){var n;const{data:a}=e;return Boolean(0===(null==(n=a.line)?void 0:n.atMoveNode))}function cachePGNAndLoadEmptyPGN(e,t){const{api:n,queue:a}=t,l=n.observing,f=n.getPGN();a.add((function loadInNextCycle(){a.add((function loadAndSetPGN(){n.load({pgn:"*"}),l.setCachedPGN(f)}))}))}function startAnalysis(e,t){const{api:n,queue:a}=t;n.observing.isAnalyzing()||a.add((function initAnalysis(){var e;const t=null==(e=n.getSelectedNode())?void 0:e.ids;t&&(n.observing.setCachedIds(t.move,t.line),n.getContext().respond(Rr.APIEvents.AnalysisStart))}))}function selectFirstVariationNode(e,t){const{api:n,queue:a}=t;a.add((function selectNode2(){n.selectNode(1,0)}))}function selectFirstVariationEnd(e,t){const{api:n,queue:a}=t,l=n.getLine(1);if(l){const e=Math.max(...l.map((e=>e.moveNumber)));a.add((function selectNode2(){n.selectNode(1,e)}))}}function removeNullMoveAndRestorePosition(e,t){const{api:n}=t,a=n.observing;n.deletePosition(0,0),a.setCachedPGN(""),a.restorePosition()}function selectStartingPosition(e,t){const{api:n,queue:a}=t;a.add((function selectNode2(){n.selectNode(0,-1)}))}function refreshAnalysisOverlay(e,t){const{api:n}=t,a=n.observing,{overlayInAnalysisMode:l}=n.getOptions(),f=a.isAnalyzing();f!==l&&n.setOptions({overlayInAnalysisMode:f})}function restorePosition(e,t){const{api:n}=t;n.observing.restorePosition()}function selectNullNode(e,t){const{api:n,queue:a}=t;a.add((function selectNode2(){n.selectNode(0,0)}))}const ni=createModeFactory((function base$3(){return{isAllowedToMove:function isAllowedToMove(){return!0},name:jo.Types.Observing,plugins:[createAnalysisOverlayPlugin(),{api:createObservingModeAPI,apiOverrides:{load:createLoad$1,move:createMove$3},create:function create3(e){const{api:t}=e;t.setOptions({overlayInAnalysisMode:!1})},match:[{condition:isOneOf([Rr.APIEvents.AnalysisStart,Rr.APIEvents.AnalysisEnd]),handler:refreshAnalysisOverlay},{condition:pipeConditions(is(Rr.APIEvents.AnalysisEnd),nullMovePresent),handler:cachePGNAndLoadEmptyPGN},{condition:pipeConditions(is(f.APIEvents.ResetToMainLine),nullMovePresent),handler:removeNullMoveAndRestorePosition},{condition:pipeConditions(is(f.APIEvents.ResetToMainLine),nullMoveAbsent),handler:restorePosition},{condition:pipeConditions(is(f.APIEvents.DeletePosition),nullMovePresent,firstVariationEmpty),handler:removeNullMoveAndRestorePosition},{condition:pipeConditions(is(f.APIEvents.DeletePosition),nullMovePresent,firstNodeDeletedFromVariation),handler:selectNullNode},{condition:pipeConditions(is(f.APIEvents.DeletePosition),nullMoveAbsent,firstVariationEmpty),handler:restorePosition},{condition:pipeConditions(is(f.APIEvents.SelectNode),nullMoveSelected),handler:selectStartingPosition},{condition:pipeConditions(is(f.APIEvents.SelectNode),nullMoveAbsent,variationSelected),handler:startAnalysis},{condition:pipeConditions(is(f.APIEvents.MoveForward),nullMovePresent,or(nullMoveSelected,startingPositionSelected)),handler:selectFirstVariationNode},{condition:pipeConditions(is(f.APIEvents.SelectLineEnd),nullMovePresent,or(nullMoveSelected,startingPositionSelected)),handler:selectFirstVariationEnd}],name:Rr.Plugin.Name}]}}),{canAddMovesToMainLine:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!1}});var ri,oi;Symbol.toStringTag;function createMove$2(e){const{api:t}=e,n=t.move,a=function handleMoveOnPreviousNodeFactory(e){const{api:t}=e;return function handleMoveOnPreviousNode(){if(!t.isAtEndOfLine())if(t.getMode().getOptions().canModifyExistingMovesOnMainLine){const{line:e,move:n}=getIdsToDelete(t.getRelativeNode());t.deletePosition(n,e)}else t.selectLineEnd()}}(e);return function move(e){return t.isGameOver()&&t.getMode().getOptions().canMoveWhenGameIsOver&&t.setResult(qn.Results.None),a(),n(e)}}(function(e){e.Name="playing"})((oi=ri||(ri={})).Plugin||(oi.Plugin={}));const ii=createModeFactory((function base$2({api:e}){return{handleIllegalMove:createHandleIllegalMove(e),isAllowedToMove:function isAllowedToMove(){return isAllowedToMoveInPlayingMode({api:e,canMoveWhenNotPlayerTurn:!1,modeOptions:e.getMode().getOptions()})},name:jo.Types.Playing,plugins:[{apiOverrides:{move:createMove$2},name:ri.Plugin.Name}],overridableMethods:["isAllowedToMove"],usePlayingAs:!0}}),{canAddMovesToMainLine:{default:!0,editable:!0},canMoveWhenGameIsOver:{default:!1,editable:!0},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!0}});Symbol.toStringTag;const ai=createModeFactory((function base$1(){return{isAllowedToMove:function isAllowedToMove(){return!1},name:jo.Types.PassiveObserving}}),{canAddMovesToMainLine:{default:!1,editable:!1},canInteractWithPieces:{default:!1,editable:!1},canModifyExistingMovesOnMainLine:{default:!1,editable:!1}});var si,ci;Symbol.toStringTag;function createDropPiece(e){return function dropPiece2({piece:t,square:n}){const{api:a,game:l}=e;return l.remove(n),l.put(t,n),a.setGameDetails({FEN:l.fen()}),a.reload()}}function createMovePiece(e){return function movePiece({from:t,piece:n,to:a}){const{api:l,game:f}=e;return f.remove(t),f.remove(a),f.put(n,a),l.setGameDetails({FEN:f.fen()}),l.reload()}}function createRemovePiece(e){return function removePiece(t){const{api:n,game:a}=e;return a.remove(t),n.setGameDetails({FEN:a.fen()}),n.reload()}}function createSetupAPI(e){return{dropPiece:createDropPiece(e),movePiece:createMovePiece(e),removePiece:createRemovePiece(e)}}function createGetMove$1(){return function getMove(e){return e}}function createMove$1(e){const{api:t}=e;return function move(e){const{color:n,drop:a,from:l,to:f}=e,{setup:p}=t,h=n&&a?{color:n,type:a}:t.getPiece(l);h&&(l&&f?p.movePiece({from:l,piece:h,to:f}):f?p.dropPiece({piece:h,square:f}):l&&p.removePiece(l))}}(function(e){e.DropPiece="DropPiece",e.MovePiece="MovePiece",e.RemovePiece="RemovePiece"})((ci=si||(si={})).Events||(ci.Events={})),function(e){e.Name="setup"}(ci.Plugin||(ci.Plugin={}));const li=createModeFactory((function base(){return{isAllowedToMove:function isAllowedToMove(){return!0},name:jo.Types.Setup,plugins:[{api:createSetupAPI,apiOverrides:{getMove:createGetMove$1,isLegalMove:()=>!0,move:createMove$1},name:si.Plugin.Name}]}}),{canAddMovesToMainLine:{default:!1,editable:!1},canDropOffBoard:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!1},canDropPiecesContinuously:{default:!1,editable:!0}});Symbol.toStringTag;buildMarkingsWarning("clearMarkings","api.markings.removeAll/removeAllWhere/removeMany/removeOne"),buildMarkingsWarning("mark","api.markings.addOne/addMany"),buildMarkingsWarning("toggleMarking","api.markings.toggleOne/toggleMany"),buildMarkingsWarning("unmark","api.markings.removeOne/removeMany");function buildMarkingsWarning(e,t){return`The "${e}" method is deprecated and will be removed in v2.0.0. Please use the ${t} methods instead.`}qn.Variants.ThreeCheck,qn.Variants.Bughouse,qn.Variants.Chess,qn.Variants.Chess960,qn.Variants.Crazyhouse,qn.Variants.KingOfTheHill;const ui={anyAPIEvent:({UpdateParams:e})=>(e.cancelMarkingStartSquare(),Rt.States.Idle),[f.UserEvents.PointerdownLeft]:({UpdateParams:e})=>(e.cancelMarkingStartSquare(),Rt.States.Idle),[f.UserEvents.Pointerup]:({context:e,data:{keyPressed:t,square:n},params:{markingStartSquare:a},UpdateParams:l})=>{const{api:{markings:f},options:p,queue:h}=e;return n&&a&&h.add(f.toggleOne,function getMarking({endSquare:e,keyPressed:t,opacity:n,startSquare:a}){if(a===e)return{data:{keyPressed:t,opacity:n,square:a},node:!0,persistent:!1,type:B};return{data:{keyPressed:t,from:a,opacity:n,to:e},node:!0,persistent:!1,type:U}}({endSquare:n,keyPressed:t,opacity:p.analysisHighlightOpacity,startSquare:a})),l.cancelMarkingStartSquare(),Rt.States.Idle}};const di={[f.UserEvents.PointerdownLeft]:({context:e,data:{coords:t,square:n},UpdateParams:a})=>{const{api:{getPieces:l,markings:f},mode:{getOptions:p},options:h,queue:m,renderer:g,state:v}=e;if(n&&m.add(f.removeAllWhere,{node:!0,persistent:!1,types:[U,Te,B]}),!h.enabled||!p().canInteractWithPieces)return Rt.States.Idle;if(!l().isDefined(n))return Rt.States.Idle;if(h.moveMethod===ht.MoveMethods.Click){const t=null==g?void 0:g.getCoordsFromSquare(n,h.flipped);if(void 0===t)throw new ChessError({code:uo.BadData,message:`getCoordsFromSquare returned undefined for ${n}`});return a.dragPiece(t,n),v.set({hideHoverSquare:!0}),null==g||g.dragPiece({coords:t,square:n},e),Rt.States.PieceDragging}return a.dragPiece(t,n),null==g||g.dragPiece({coords:t,square:n},e),Rt.States.PieceDragging},[f.UserEvents.PointerdownRight]:({context:e,data:{square:t},UpdateParams:n})=>{const{options:a}=e;if(a.enabled)return n.setMarkingStartSquare(t),Rt.States.AddingMarkings}};function shouldDropOrDeselectPiece({api:e,move:t,plyDiff:n,pieceSquare:a}){var l;const f=a&&(null==(l=e.getPieces().getCollection()[a])?void 0:l.color);return!t||1!==n||!f||f===t.color&&!t.userGenerated||(t.from===a||t.to===a)}const fi={anyAPIEvent:({context:e,data:{holdSelectedPiece:t,move:n,plyDiff:a},params:{draggingPiece:l},UpdateParams:f})=>{const{renderer:p}=e;return l&&!t&&shouldDropOrDeselectPiece({api:e.api,move:n,pieceSquare:l,plyDiff:a})?(f.resetElevatedState(),null==p||p.dropPiece(l,e),Rt.States.Idle):Rt.States.PieceDragging},[f.UserEvents.MousedownRight]:({context:e,params:{draggingPiece:t},UpdateParams:n})=>{const{renderer:a}=e;if(!t)throw new ChessError({code:uo.BadData,message:"Attempted to pointerdown on a dragging piece but dragging piece is null or undefined"});return n.dropPiece(),n.deselectPiece(),null==a||a.dropPiece(t,e),Rt.States.Idle},[f.UserEvents.Pointermove]:({context:e,data:{coordsInsideBoard:t},params:{draggingPiece:n},UpdateParams:a})=>{const{renderer:l}=e;if(!n)throw new ChessError({code:uo.BadData,message:"Attempted to drag a piece but draggingPiece is null or undefined"});return a.dragPiece(t,n),null==l||l.dragPiece({coords:t,square:n},e),Rt.States.PieceDragging},[f.UserEvents.Pointerup]:({context:e,data:{keyPressed:t,square:n},params:{draggingPiece:a,selectedPiece:l},UpdateParams:f})=>{var p;const{api:{getMove:h,getPiece:m,getTurn:g,isCheck:v,move:y,playSound:_},mode:b,options:C,queue:S,renderer:k}=e;if(!a)throw new ChessError({code:uo.BadData,message:"Attempted to pointerup on a dragging piece but dragging piece is null or undefined"});if(e.options.test){const t=e.el.querySelector(".dragging");null==t||t.setAttribute("data-test-dragging","false"),null==t||t.removeAttribute("dragging")}if(a===n)return f.dropPiece(),null==k||k.dropPiece(a,e),l===n||C.moveMethod===ht.MoveMethods.DragOnly?(f.deselectPiece(),Rt.States.Idle):(f.selectPiece(a),Rt.States.PieceSelected);l&&f.deselectPiece();const w={from:a,to:n},T=h(w),P=!(!b.isAllowedToMove()||!T)&&__spreadProps(__spreadValues({},T),{animate:!1,userGenerated:!0,userGeneratedDrop:!0});if(!P){f.dropPiece(),b.handleIllegalMove&&S.add(b.handleIllegalMove,w);const t=v();let n=!1;return(null==(p=m(a))?void 0:p.color)===g()&&t&&(C.playSounds&&S.add(_,Ke.BoardSounds.Illegal),n=t),null==k||k.illegalMove(n,e),null==k||k.dropPiece(a,e),C.moveMethod===ht.MoveMethods.DragOnly?(f.deselectPiece(),Rt.States.Idle):(f.selectPiece(a),Rt.States.PieceSelected)}return isPromotion(P)?C.autoPromote&&"alt"!==t?(f.dropPiece(),null==k||k.dropPiece(P.to,e),S.add(y,__spreadProps(__spreadValues({},P),{promotion:qn.Piece.Types.Queen})),Rt.States.Idle):(f.dragPiece({},a),f.showPromotionArea(P),null==k||k.dragPiece({square:a,toSquare:P.to},e),null==k||k.openPromotionWindow(P,e),Rt.States.PromotionAreaShowing):(f.dropPiece(),null===n&&b.getOptions().canDropOffBoard?null==k||k.removePiece(a,e):null==k||k.dropPiece(n,e),S.add(y,P),Rt.States.Idle)}},pi={anyAPIEvent:({context:e,data:{holdSelectedPiece:t,move:n,plyDiff:a},params:{selectedPiece:l},UpdateParams:f})=>!t&&shouldDropOrDeselectPiece({api:e.api,move:n,pieceSquare:l,plyDiff:a})?(f.resetElevatedState(),Rt.States.Idle):Rt.States.PieceSelected,[f.UserEvents.PointerdownLeft]:({context:e,data:{coords:t,keyPressed:n,square:a},params:{selectedPiece:l},UpdateParams:f})=>{const{api:{getMove:p,getPieces:h,move:m},mode:{isAllowedToMove:g},options:v,queue:y,renderer:_,state:b}=e;if(!l)throw new ChessError({code:uo.BadData,message:"Attempted to interact with a selectedPiece but selectedPiece is null or undefined"});if(a===l){const n=v.moveMethod===ht.MoveMethods.Drag||v.moveMethod===ht.MoveMethods.DragOnly?t:(null==_?void 0:_.getCoordsFromSquare(a,v.flipped))||t;return f.dragPiece(n,l),v.moveMethod===ht.MoveMethods.Click&&b.set({hideHoverSquare:!0}),null==_||_.dragPiece({coords:n,square:l},e),Rt.States.PieceDragging}const C={from:l,to:a},S=h(),k=p(C),w=!(!g()||!k)&&__spreadProps(__spreadValues({},k),{userGenerated:!0});if(!w){if(f.deselectPiece(),!S.isDefined(a))return Rt.States.Idle;if(v.moveMethod===ht.MoveMethods.Click){const n=(null==_?void 0:_.getCoordsFromSquare(a,v.flipped))||t;return f.dragPiece(n,a),b.set({hideHoverSquare:!0}),null==_||_.dragPiece({coords:n,square:a},e),Rt.States.PieceDragging}return f.dragPiece(t,a),null==_||_.dragPiece({coords:t,square:a},e),Rt.States.PieceDragging}return isPromotion(w)?v.autoPromote&&"alt"!==n?(f.deselectPiece(),y.add(m,w,__spreadProps(__spreadValues({},w),{promotion:qn.Piece.Types.Queen})),Rt.States.Idle):(f.deselectPiece(),f.dragPiece({},l),f.showPromotionArea(w),null==_||_.dragPiece({square:l,toSquare:w.to},e),null==_||_.openPromotionWindow(w,e),Rt.States.PromotionAreaShowing):(f.deselectPiece(),y.add(m,w),Rt.States.Idle)},[f.UserEvents.PointerdownRight]:({context:e,data:{square:t},UpdateParams:n})=>{const{options:a}=e;if(a.enabled)return n.deselectPiece(),n.setMarkingStartSquare(t),Rt.States.AddingMarkings}};function cancelPromotion({context:e,params:{draggingPiece:t},UpdateParams:n}){const{renderer:a}=e;return n.dropPiece(),n.cancelPromotion(),null==a||a.dropPiece(t,e),null==a||a.closePromotionWindow(e),Rt.States.Idle}const hi={anyAPIEvent:e=>{const{data:t}=e;return t.move?Rt.States.PromotionAreaShowing:cancelPromotion(e)},[f.BoardEvents.PromotionPiecePointerdown]:({context:e,data:{piece:t},params:{draggingPiece:n,promotionMove:a},UpdateParams:l})=>{const{api:{move:f},queue:p,renderer:h}=e;return l.dropPiece(),l.cancelPromotion(),null==h||h.dropPiece(n,e),null==h||h.closePromotionWindow(e),a?(p.add(f,{animate:!1,flags:a.flags,from:a.from,piece:qn.Piece.Types.Pawn,promotion:t,to:a.to,userGenerated:!0}),Rt.States.Idle):Rt.States.Idle},[f.BoardEvents.PromotionAreaClosePointerdown]:cancelPromotion,[f.UserEvents.PointerdownLeft]:cancelPromotion,[f.UserEvents.PointerdownRight]:cancelPromotion};Rt.States.AddingMarkings,Rt.States.PieceDragging,Rt.States.Idle,Rt.States.PromotionAreaShowing,Rt.States.PieceSelected;function isTouchEvent(e){return void 0!==e.touches}function isRightButton(e){return!isTouchEvent(e)&&3===e.which}function generateRandomId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";return[0,0,0,0,0,0,0,0,0,0].reduce((t=>t+e.charAt(Math.floor(Math.random()*e.length))),"")}function getDefaultOptions(){return{allowMarkings:!0,analysisHighlightColors:{alt:ht.HighlightColors.Blue,ctrl:ht.HighlightColors.Orange,default:ht.HighlightColors.Red,shift:ht.HighlightColors.Green},analysisHighlightOpacity:.8,animationType:ht.Animation.Types.Default,arrowColors:{alt:ht.HighlightedArrowColors.Blue,ctrl:ht.HighlightedArrowColors.Red,default:ht.HighlightedArrowColors.Orange,shift:ht.HighlightedArrowColors.Green},aspectRatio:1,autoClaimDraw:!0,autoPromote:!1,autoResize:!0,boardStyle:"green",captureKeyStrokes:!0,checkBlinkingSquareColor:"#ff0000",coordinates:ht.CoordinatesPositions.Inside,darkMode:!1,diagramStyle:!0,enabled:!0,fadeSetup:0,flipped:!1,highlightColor:void 0,highlightLegalMoves:!0,highlightMoves:!0,highlightOpacity:.5,hoverSquareOutline:!0,id:generateRandomId(),moveListContextMenuEnabled:!0,moveListDisplayType:ht.MoveListDisplayTypes.Text,moveMethod:ht.MoveMethods.Drag,overlayInAnalysisMode:!1,pieceStyle:"neo",playSounds:!0,premoveDelay:200,premoveHighlightColor:"#f42a32",premoveHighlightOpacity:.5,rounded:!0,soundTheme:"default",threatSquareColor:"#ff0000",threatSquareOpacity:.8,useSharedStyleTag:!1}}var mi,gi,vi,yi,_i,bi;!function(e){!function(e){e.CreateFailure="CreateFailure"}(e.LogCodes||(e.LogCodes={}))}(mi||(mi={})),function(e){var t,n,a,l,f,p,h;(t=e.PieceStyles||(e.PieceStyles={})).Default="staunton_executive",t.Trigger="real3d",(e.CacheKeys||(e.CacheKeys={})).CameraSettings="cameraSettings",(n=e.CssClasses||(e.CssClasses={})).Board="board-webgl-3d",n.PieceDrag="piece-dragging",n.PieceHover="piece-hover",n.PromotionWindow="promotion-window-3d",n.StatisticsPanel="statistics-panel",(a=e.ObjectsRenderOrder||(e.ObjectsRenderOrder={}))[a.AnalysisOverlay=1]="AnalysisOverlay",a[a.NotationPlane=2]="NotationPlane",a[a.OverSquare=3]="OverSquare",a[a.HighligtedSquare=4]="HighligtedSquare",a[a.Hint=5]="Hint",a[a.CustomItem=6]="CustomItem",a[a.PieceShadow=7]="PieceShadow",a[a.Arrow=8]="Arrow",a[a.Effect=9]="Effect",a[a.Highest=10]="Highest",function(e){e[e.PositionY=.005]="PositionY"}(e.Arrow||(e.Arrow={})),(l=e.CustomItem||(e.CustomItem={}))[l.PositionY=.005]="PositionY",(f=e.Effect||(e.Effect={}))[f.PositionY=.005]="PositionY",(p=e.Square||(e.Square={}))[p.Size=10]="Size",p[p.HalfSize=5]="HalfSize",p[p.BorderSize=.5]="BorderSize",p[p.OverBorderSize=.5]="OverBorderSize",p[p.VisibleY=.005]="VisibleY",p[p.InvisibleY=-.2]="InvisibleY",p[p.InsideTolerance=.01]="InsideTolerance",function(e){e[e.MarginSize=4]="MarginSize",e[e.Size=88]="Size"}(e.Board||(e.Board={})),(h=e.Camera||(e.Camera={}))[h.Distance=140]="Distance",h[h.DistanceMin=50]="DistanceMin",h[h.DistanceMax=500]="DistanceMax",h[h.PanAngle=0]="PanAngle",h[h.TiltAngle=100]="TiltAngle",h[h.HorizontalPanning=0]="HorizontalPanning",h[h.VerticalPanning=-12]="VerticalPanning",h[h.ZoomIncrement=5]="ZoomIncrement"}(gi||(gi={})),function(e){e.BodyDragging="hand-pieces-dragging-body",e.Component="hand-pieces",e.Dragging="dragging",e.Flipped="flipped",e.Horizontal="horizontal",e.Piece="hand-piece",e.Pseudo3d="pseudo3d",e.Vertical="vertical",e.WithKing="with-king"}((yi=vi||(vi={})).Classes||(yi.Classes={})),(_i=yi.DataAttributes||(yi.DataAttributes={})).Dragging="data-hand-piece-dragging",_i.Selected="data-hand-piece-selected",(bi=yi.DisplayDirections||(yi.DisplayDirections={})).Horizontal="horizontal",bi.Vertical="vertical";var Ci,Si;function getColorAsNumber(e){return e===qn.ColorsAsLetters.Black||e===qn.ColorsAsWords.Black?qn.ColorsAsNumbers.Black:qn.ColorsAsNumbers.White}function getPieceBaseURL(e,t=150){return`https://images.chesscomfiles.com/chess-themes/pieces/${e}/${t}`}function getBoardURL(e,t=150){return`https://images.chesscomfiles.com/chess-themes/boards/${e}/${t}.png`}function getColorAsLetter(e){return e===qn.ColorsAsNumbers.Black?qn.ColorsAsLetters.Black:qn.ColorsAsLetters.White}function getSanFromFileRank(e){return!e||!e.file||!e.rank||e.file>8||e.rank>8||e.file<1||e.rank<1?null:`${String.fromCharCode(96+e.file)}${e.rank.toString()}`}function getUndoMoveDetails(e){const t=[{animate:e.animate,from:e.kingTo||e.to,to:e.from}];e.rookMove&&t.push(__spreadProps(__spreadValues({},e.rookMove),{from:e.rookMove.to,to:e.rookMove.from}));const n=e.captured&&e.capturedStr?{color:getOppositeColor(e.color),promoted:e.capturedPromotedPawn,square:e.EPCapturedSquare||e.to,type:e.capturedStr.toLowerCase()}:void 0;return{movedPieces:t,promotedSquare:e.promotion?e.from:void 0,restoredPiece:n}}function getArrowColor(e,t){var n,a;return null!=(a=null!=(n=e&&t[qn.Node.Marking.JCEColorsMap[e]])?n:e)?a:t.default}!function(e){e.DraggingPiece="DraggingPiece",e.Idle="Idle",e.PieceSelected="PieceSelected"}(Ci||(Ci={})),(Si||(Si={})).ResetToIdle="ResetToIdle";const ki={HEAD_HEIGHT:4.5,HEAD_WIDTH:6.5,TAIL_PADDING:4.5,WIDTH:2.75},wi=27.95084971874737,Ti=[.5,-2],Pi=[2,.5,-.5,-2];function calculateArrowLength({from:e,to:t}){return Math.sqrt((e.x-t.x)**2+(e.y-t.y)**2)}function calculateArrowRotation({from:e,to:t}){const n=calculateArrowLength({from:e,to:t}),a=e.x,l=e.y+n,f=e.x-a,p=e.y-l,h=e.x-t.x,m=e.y-t.y,g=Math.acos((f*h+p*m)/n**2),v=Math.floor(g*(180/Math.PI)*100)/100;return e.x<t.x?360-v:v}function calculateArrowSlope({from:e,to:t}){const n=(e.y-t.y)/(e.x-t.x);return Number(n.toFixed(1))}function getKnightArrowRotation({from:e,slope:t,to:n}){switch(t){case 2:return e.x>n.x?180:0;case-2:return e.x>n.x?0:180;case.5:case-.5:return e.x>n.x?90:270;default:return 0}}const Ei=/iPhone/i,Ai=/iPod/i,Mi=/iPad/i,xi=/\bAndroid(?:.+)Mobile\b/i,Oi=/Android/i,Ri=/(?:SD4930UR|\bSilk(?:.+)Mobile\b)/i,Ii=/Silk/i,Li=/Windows Phone/i,Ni=/\bWindows(?:.+)ARM\b/i,Di=/BlackBerry/i,Bi=/BB10/i,Fi=/Opera Mini/i,ji=/\b(CriOS|Chrome)(?:.+)Mobile/i,$i=/Mobile(?:.+)Firefox\b/i;function match(e,t){return e.test(t)}
/*!
 * @pixi/settings - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/settings is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var Hi=function isMobile$1(e){let t=(e=e||("undefined"!=typeof navigator?navigator.userAgent:"")).split("[FBAN");void 0!==t[1]&&(e=t[0]),t=e.split("Twitter"),void 0!==t[1]&&(e=t[0]);const n={apple:{phone:match(Ei,e)&&!match(Li,e),ipod:match(Ai,e),tablet:!match(Ei,e)&&match(Mi,e)&&!match(Li,e),device:(match(Ei,e)||match(Ai,e)||match(Mi,e))&&!match(Li,e)},amazon:{phone:match(Ri,e),tablet:!match(Ri,e)&&match(Ii,e),device:match(Ri,e)||match(Ii,e)},android:{phone:!match(Li,e)&&match(Ri,e)||!match(Li,e)&&match(xi,e),tablet:!match(Li,e)&&!match(Ri,e)&&!match(xi,e)&&(match(Ii,e)||match(Oi,e)),device:!match(Li,e)&&(match(Ri,e)||match(Ii,e)||match(xi,e)||match(Oi,e))||match(/\bokhttp\b/i,e)},windows:{phone:match(Li,e),tablet:match(Ni,e),device:match(Li,e)||match(Ni,e)},other:{blackberry:match(Di,e),blackberry10:match(Bi,e),opera:match(Fi,e),firefox:match($i,e),chrome:match(ji,e),device:match(Di,e)||match(Bi,e)||match(Fi,e)||match($i,e)||match(ji,e)},any:!1,phone:!1,tablet:!1};return n.any=n.apple.device||n.android.device||n.windows.device||n.other.device,n.phone=n.apple.phone||n.android.phone||n.windows.phone,n.tablet=n.apple.tablet||n.android.tablet||n.windows.tablet,n}();var Vi={MIPMAP_TEXTURES:1,ANISOTROPIC_LEVEL:0,RESOLUTION:1,FILTER_RESOLUTION:1,SPRITE_MAX_TEXTURES:function maxRecommendedTextures(e){var t=!0;if(Hi.tablet||Hi.phone){if(t=!1,Hi.apple.device){var n=navigator.userAgent.match(/OS (\d+)_(\d+)?/);if(n)parseInt(n[1],10)>=11&&(t=!0)}if(Hi.android.device){var a=navigator.userAgent.match(/Android\s([0-9.]*)/);if(a)parseInt(a[1],10)>=7&&(t=!0)}}return t?e:4}(32),SPRITE_BATCH_SIZE:4096,RENDER_OPTIONS:{view:null,antialias:!1,forceFXAA:!1,autoDensity:!1,transparent:!1,backgroundColor:0,clearBeforeRender:!0,preserveDrawingBuffer:!1,width:800,height:600,legacy:!1},GC_MODE:0,GC_MAX_IDLE:3600,GC_MAX_CHECK_COUNT:600,WRAP_MODE:33071,SCALE_MODE:1,PRECISION_VERTEX:"highp",PRECISION_FRAGMENT:Hi.apple.device?"highp":"mediump",CAN_UPLOAD_SAME_BUFFER:function canUploadSameBuffer(){return!Hi.apple.device}(),CREATE_IMAGE_BITMAP:!1,ROUND_PIXELS:!1},Ui={exports:{}};!function(e){var t=Object.prototype.hasOwnProperty,n="~";function Events(){}function EE(e,t,n){this.fn=e,this.context=t,this.once=n||!1}function addListener(e,t,a,l,f){if("function"!=typeof a)throw new TypeError("The listener must be a function");var p=new EE(a,l||e,f),h=n?n+t:t;return e._events[h]?e._events[h].fn?e._events[h]=[e._events[h],p]:e._events[h].push(p):(e._events[h]=p,e._eventsCount++),e}function clearEvent(e,t){0==--e._eventsCount?e._events=new Events:delete e._events[t]}function EventEmitter2(){this._events=new Events,this._eventsCount=0}Object.create&&(Events.prototype=Object.create(null),(new Events).__proto__||(n=!1)),EventEmitter2.prototype.eventNames=function eventNames(){var e,a,l=[];if(0===this._eventsCount)return l;for(a in e=this._events)t.call(e,a)&&l.push(n?a.slice(1):a);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(e)):l},EventEmitter2.prototype.listeners=function listeners(e){var t=n?n+e:e,a=this._events[t];if(!a)return[];if(a.fn)return[a.fn];for(var l=0,f=a.length,p=new Array(f);l<f;l++)p[l]=a[l].fn;return p},EventEmitter2.prototype.listenerCount=function listenerCount(e){var t=n?n+e:e,a=this._events[t];return a?a.fn?1:a.length:0},EventEmitter2.prototype.emit=function emit(e,t,a,l,f,p){var h=n?n+e:e;if(!this._events[h])return!1;var m,g,v=this._events[h],y=arguments.length;if(v.fn){switch(v.once&&this.removeListener(e,v.fn,void 0,!0),y){case 1:return v.fn.call(v.context),!0;case 2:return v.fn.call(v.context,t),!0;case 3:return v.fn.call(v.context,t,a),!0;case 4:return v.fn.call(v.context,t,a,l),!0;case 5:return v.fn.call(v.context,t,a,l,f),!0;case 6:return v.fn.call(v.context,t,a,l,f,p),!0}for(g=1,m=new Array(y-1);g<y;g++)m[g-1]=arguments[g];v.fn.apply(v.context,m)}else{var _,b=v.length;for(g=0;g<b;g++)switch(v[g].once&&this.removeListener(e,v[g].fn,void 0,!0),y){case 1:v[g].fn.call(v[g].context);break;case 2:v[g].fn.call(v[g].context,t);break;case 3:v[g].fn.call(v[g].context,t,a);break;case 4:v[g].fn.call(v[g].context,t,a,l);break;default:if(!m)for(_=1,m=new Array(y-1);_<y;_++)m[_-1]=arguments[_];v[g].fn.apply(v[g].context,m)}}return!0},EventEmitter2.prototype.on=function on(e,t,n){return addListener(this,e,t,n,!1)},EventEmitter2.prototype.once=function once(e,t,n){return addListener(this,e,t,n,!0)},EventEmitter2.prototype.removeListener=function removeListener(e,t,a,l){var f=n?n+e:e;if(!this._events[f])return this;if(!t)return clearEvent(this,f),this;var p=this._events[f];if(p.fn)p.fn!==t||l&&!p.once||a&&p.context!==a||clearEvent(this,f);else{for(var h=0,m=[],g=p.length;h<g;h++)(p[h].fn!==t||l&&!p[h].once||a&&p[h].context!==a)&&m.push(p[h]);m.length?this._events[f]=1===m.length?m[0]:m:clearEvent(this,f)}return this},EventEmitter2.prototype.removeAllListeners=function removeAllListeners(e){var t;return e?(t=n?n+e:e,this._events[t]&&clearEvent(this,t)):(this._events=new Events,this._eventsCount=0),this},EventEmitter2.prototype.off=EventEmitter2.prototype.removeListener,EventEmitter2.prototype.addListener=EventEmitter2.prototype.on,EventEmitter2.prefixed=n,EventEmitter2.EventEmitter=EventEmitter2,e.exports=EventEmitter2}(Ui);var Gi=Ui.exports,qi={exports:{}};function earcut(e,t,n){n=n||2;var a,l,f,p,h,m,g,v=t&&t.length,y=v?t[0]*n:e.length,_=linkedList(e,0,y,n,!0),b=[];if(!_||_.next===_.prev)return b;if(v&&(_=function eliminateHoles(e,t,n,a){var l,f,p,h=[];for(l=0,f=t.length;l<f;l++)(p=linkedList(e,t[l]*a,l<f-1?t[l+1]*a:e.length,a,!1))===p.next&&(p.steiner=!0),h.push(getLeftmost(p));for(h.sort(compareX),l=0;l<h.length;l++)eliminateHole(h[l],n),n=filterPoints(n,n.next);return n}(e,t,_,n)),e.length>80*n){a=f=e[0],l=p=e[1];for(var C=n;C<y;C+=n)(h=e[C])<a&&(a=h),(m=e[C+1])<l&&(l=m),h>f&&(f=h),m>p&&(p=m);g=0!==(g=Math.max(f-a,p-l))?1/g:0}return earcutLinked(_,b,n,a,l,g),b}function linkedList(e,t,n,a,l){var f,p;if(l===signedArea(e,t,n,a)>0)for(f=t;f<n;f+=a)p=insertNode(f,e[f],e[f+1],p);else for(f=n-a;f>=t;f-=a)p=insertNode(f,e[f],e[f+1],p);return p&&equals(p,p.next)&&(removeNode(p),p=p.next),p}function filterPoints(e,t){if(!e)return e;t||(t=e);var n,a=e;do{if(n=!1,a.steiner||!equals(a,a.next)&&0!==area(a.prev,a,a.next))a=a.next;else{if(removeNode(a),(a=t=a.prev)===a.next)break;n=!0}}while(n||a!==t);return t}function earcutLinked(e,t,n,a,l,f,p){if(e){!p&&f&&function indexCurve(e,t,n,a){var l=e;do{null===l.z&&(l.z=zOrder(l.x,l.y,t,n,a)),l.prevZ=l.prev,l.nextZ=l.next,l=l.next}while(l!==e);l.prevZ.nextZ=null,l.prevZ=null,function sortLinked(e){var t,n,a,l,f,p,h,m,g=1;do{for(n=e,e=null,f=null,p=0;n;){for(p++,a=n,h=0,t=0;t<g&&(h++,a=a.nextZ);t++);for(m=g;h>0||m>0&&a;)0!==h&&(0===m||!a||n.z<=a.z)?(l=n,n=n.nextZ,h--):(l=a,a=a.nextZ,m--),f?f.nextZ=l:e=l,l.prevZ=f,f=l;n=a}f.nextZ=null,g*=2}while(p>1);return e}(l)}(e,a,l,f);for(var h,m,g=e;e.prev!==e.next;)if(h=e.prev,m=e.next,f?isEarHashed(e,a,l,f):isEar(e))t.push(h.i/n),t.push(e.i/n),t.push(m.i/n),removeNode(e),e=m.next,g=m.next;else if((e=m)===g){p?1===p?earcutLinked(e=cureLocalIntersections(filterPoints(e),t,n),t,n,a,l,f,2):2===p&&splitEarcut(e,t,n,a,l,f):earcutLinked(filterPoints(e),t,n,a,l,f,1);break}}}function isEar(e){var t=e.prev,n=e,a=e.next;if(area(t,n,a)>=0)return!1;for(var l=e.next.next;l!==e.prev;){if(pointInTriangle(t.x,t.y,n.x,n.y,a.x,a.y,l.x,l.y)&&area(l.prev,l,l.next)>=0)return!1;l=l.next}return!0}function isEarHashed(e,t,n,a){var l=e.prev,f=e,p=e.next;if(area(l,f,p)>=0)return!1;for(var h=l.x<f.x?l.x<p.x?l.x:p.x:f.x<p.x?f.x:p.x,m=l.y<f.y?l.y<p.y?l.y:p.y:f.y<p.y?f.y:p.y,g=l.x>f.x?l.x>p.x?l.x:p.x:f.x>p.x?f.x:p.x,v=l.y>f.y?l.y>p.y?l.y:p.y:f.y>p.y?f.y:p.y,y=zOrder(h,m,t,n,a),_=zOrder(g,v,t,n,a),b=e.prevZ,C=e.nextZ;b&&b.z>=y&&C&&C.z<=_;){if(b!==e.prev&&b!==e.next&&pointInTriangle(l.x,l.y,f.x,f.y,p.x,p.y,b.x,b.y)&&area(b.prev,b,b.next)>=0)return!1;if(b=b.prevZ,C!==e.prev&&C!==e.next&&pointInTriangle(l.x,l.y,f.x,f.y,p.x,p.y,C.x,C.y)&&area(C.prev,C,C.next)>=0)return!1;C=C.nextZ}for(;b&&b.z>=y;){if(b!==e.prev&&b!==e.next&&pointInTriangle(l.x,l.y,f.x,f.y,p.x,p.y,b.x,b.y)&&area(b.prev,b,b.next)>=0)return!1;b=b.prevZ}for(;C&&C.z<=_;){if(C!==e.prev&&C!==e.next&&pointInTriangle(l.x,l.y,f.x,f.y,p.x,p.y,C.x,C.y)&&area(C.prev,C,C.next)>=0)return!1;C=C.nextZ}return!0}function cureLocalIntersections(e,t,n){var a=e;do{var l=a.prev,f=a.next.next;!equals(l,f)&&intersects(l,a,a.next,f)&&locallyInside(l,f)&&locallyInside(f,l)&&(t.push(l.i/n),t.push(a.i/n),t.push(f.i/n),removeNode(a),removeNode(a.next),a=e=f),a=a.next}while(a!==e);return filterPoints(a)}function splitEarcut(e,t,n,a,l,f){var p=e;do{for(var h=p.next.next;h!==p.prev;){if(p.i!==h.i&&isValidDiagonal(p,h)){var m=splitPolygon(p,h);return p=filterPoints(p,p.next),m=filterPoints(m,m.next),earcutLinked(p,t,n,a,l,f),void earcutLinked(m,t,n,a,l,f)}h=h.next}p=p.next}while(p!==e)}function compareX(e,t){return e.x-t.x}function eliminateHole(e,t){if(t=function findHoleBridge(e,t){var n,a=t,l=e.x,f=e.y,p=-1/0;do{if(f<=a.y&&f>=a.next.y&&a.next.y!==a.y){var h=a.x+(f-a.y)*(a.next.x-a.x)/(a.next.y-a.y);if(h<=l&&h>p){if(p=h,h===l){if(f===a.y)return a;if(f===a.next.y)return a.next}n=a.x<a.next.x?a:a.next}}a=a.next}while(a!==t);if(!n)return null;if(l===p)return n;var m,g=n,v=n.x,y=n.y,_=1/0;a=n;do{l>=a.x&&a.x>=v&&l!==a.x&&pointInTriangle(f<y?l:p,f,v,y,f<y?p:l,f,a.x,a.y)&&(m=Math.abs(f-a.y)/(l-a.x),locallyInside(a,e)&&(m<_||m===_&&(a.x>n.x||a.x===n.x&&sectorContainsSector(n,a)))&&(n=a,_=m)),a=a.next}while(a!==g);return n}(e,t),t){var n=splitPolygon(t,e);filterPoints(t,t.next),filterPoints(n,n.next)}}function sectorContainsSector(e,t){return area(e.prev,e,t.prev)<0&&area(t.next,e,e.next)<0}function zOrder(e,t,n,a,l){return(e=1431655765&((e=858993459&((e=252645135&((e=16711935&((e=32767*(e-n)*l)|e<<8))|e<<4))|e<<2))|e<<1))|(t=1431655765&((t=858993459&((t=252645135&((t=16711935&((t=32767*(t-a)*l)|t<<8))|t<<4))|t<<2))|t<<1))<<1}function getLeftmost(e){var t=e,n=e;do{(t.x<n.x||t.x===n.x&&t.y<n.y)&&(n=t),t=t.next}while(t!==e);return n}function pointInTriangle(e,t,n,a,l,f,p,h){return(l-p)*(t-h)-(e-p)*(f-h)>=0&&(e-p)*(a-h)-(n-p)*(t-h)>=0&&(n-p)*(f-h)-(l-p)*(a-h)>=0}function isValidDiagonal(e,t){return e.next.i!==t.i&&e.prev.i!==t.i&&!function intersectsPolygon(e,t){var n=e;do{if(n.i!==e.i&&n.next.i!==e.i&&n.i!==t.i&&n.next.i!==t.i&&intersects(n,n.next,e,t))return!0;n=n.next}while(n!==e);return!1}(e,t)&&(locallyInside(e,t)&&locallyInside(t,e)&&function middleInside(e,t){var n=e,a=!1,l=(e.x+t.x)/2,f=(e.y+t.y)/2;do{n.y>f!=n.next.y>f&&n.next.y!==n.y&&l<(n.next.x-n.x)*(f-n.y)/(n.next.y-n.y)+n.x&&(a=!a),n=n.next}while(n!==e);return a}(e,t)&&(area(e.prev,e,t.prev)||area(e,t.prev,t))||equals(e,t)&&area(e.prev,e,e.next)>0&&area(t.prev,t,t.next)>0)}function area(e,t,n){return(t.y-e.y)*(n.x-t.x)-(t.x-e.x)*(n.y-t.y)}function equals(e,t){return e.x===t.x&&e.y===t.y}function intersects(e,t,n,a){var l=sign$1(area(e,t,n)),f=sign$1(area(e,t,a)),p=sign$1(area(n,a,e)),h=sign$1(area(n,a,t));return l!==f&&p!==h||(!(0!==l||!onSegment(e,n,t))||(!(0!==f||!onSegment(e,a,t))||(!(0!==p||!onSegment(n,e,a))||!(0!==h||!onSegment(n,t,a)))))}function onSegment(e,t,n){return t.x<=Math.max(e.x,n.x)&&t.x>=Math.min(e.x,n.x)&&t.y<=Math.max(e.y,n.y)&&t.y>=Math.min(e.y,n.y)}function sign$1(e){return e>0?1:e<0?-1:0}function locallyInside(e,t){return area(e.prev,e,e.next)<0?area(e,t,e.next)>=0&&area(e,e.prev,t)>=0:area(e,t,e.prev)<0||area(e,e.next,t)<0}function splitPolygon(e,t){var n=new Node(e.i,e.x,e.y),a=new Node(t.i,t.x,t.y),l=e.next,f=t.prev;return e.next=t,t.prev=e,n.next=l,l.prev=n,a.next=n,n.prev=a,f.next=a,a.prev=f,a}function insertNode(e,t,n,a){var l=new Node(e,t,n);return a?(l.next=a.next,l.prev=a,a.next.prev=l,a.next=l):(l.prev=l,l.next=l),l}function removeNode(e){e.next.prev=e.prev,e.prev.next=e.next,e.prevZ&&(e.prevZ.nextZ=e.nextZ),e.nextZ&&(e.nextZ.prevZ=e.prevZ)}function Node(e,t,n){this.i=e,this.x=t,this.y=n,this.prev=null,this.next=null,this.z=null,this.prevZ=null,this.nextZ=null,this.steiner=!1}function signedArea(e,t,n,a){for(var l=0,f=t,p=n-a;f<n;f+=a)l+=(e[p]-e[f])*(e[f+1]+e[p+1]),p=f;return l}qi.exports=earcut,qi.exports.default=earcut,earcut.deviation=function(e,t,n,a){var l=t&&t.length,f=l?t[0]*n:e.length,p=Math.abs(signedArea(e,0,f,n));if(l)for(var h=0,m=t.length;h<m;h++){var g=t[h]*n,v=h<m-1?t[h+1]*n:e.length;p-=Math.abs(signedArea(e,g,v,n))}var y=0;for(h=0;h<a.length;h+=3){var _=a[h]*n,b=a[h+1]*n,C=a[h+2]*n;y+=Math.abs((e[_]-e[C])*(e[b+1]-e[_+1])-(e[_]-e[b])*(e[C+1]-e[_+1]))}return 0===p&&0===y?0:Math.abs((y-p)/p)},earcut.flatten=function(e){for(var t=e[0][0].length,n={vertices:[],holes:[],dimensions:t},a=0,l=0;l<e.length;l++){for(var f=0;f<e[l].length;f++)for(var p=0;p<t;p++)n.vertices.push(e[l][f][p]);l>0&&(a+=e[l-1].length,n.holes.push(a))}return n};var Wi=qi.exports,zi={},Ki={exports:{}};
/*! https://mths.be/punycode v1.3.2 by @mathias */
!function(e,t){!function(n){var a=t&&!t.nodeType&&t,l=e&&!e.nodeType&&e,f="object"==typeof x.K&&x.K;f.global!==f&&f.window!==f&&f.self!==f||(n=f);var p,h,m=2147483647,g=36,v=/^xn--/,y=/[^\x20-\x7E]/,_=/[\x2E\u3002\uFF0E\uFF61]/g,b={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},C=Math.floor,S=String.fromCharCode;function error(e){throw RangeError(b[e])}function map2(e,t){for(var n=e.length,a=[];n--;)a[n]=t(e[n]);return a}function mapDomain(e,t){var n=e.split("@"),a="";return n.length>1&&(a=n[0]+"@",e=n[1]),a+map2((e=e.replace(_,".")).split("."),t).join(".")}function ucs2decode(e){for(var t,n,a=[],l=0,f=e.length;l<f;)(t=e.charCodeAt(l++))>=55296&&t<=56319&&l<f?56320==(64512&(n=e.charCodeAt(l++)))?a.push(((1023&t)<<10)+(1023&n)+65536):(a.push(t),l--):a.push(t);return a}function ucs2encode(e){return map2(e,(function(e){var t="";return e>65535&&(t+=S((e-=65536)>>>10&1023|55296),e=56320|1023&e),t+=S(e)})).join("")}function digitToBasic(e,t){return e+22+75*(e<26)-((0!=t)<<5)}function adapt(e,t,n){var a=0;for(e=n?C(e/700):e>>1,e+=C(e/t);e>455;a+=g)e=C(e/35);return C(a+36*e/(e+38))}function decode2(e){var t,n,a,l,f,p,h,v,y,_,b,S=[],k=e.length,w=0,T=128,P=72;for((n=e.lastIndexOf("-"))<0&&(n=0),a=0;a<n;++a)e.charCodeAt(a)>=128&&error("not-basic"),S.push(e.charCodeAt(a));for(l=n>0?n+1:0;l<k;){for(f=w,p=1,h=g;l>=k&&error("invalid-input"),((v=(b=e.charCodeAt(l++))-48<10?b-22:b-65<26?b-65:b-97<26?b-97:g)>=g||v>C((m-w)/p))&&error("overflow"),w+=v*p,!(v<(y=h<=P?1:h>=P+26?26:h-P));h+=g)p>C(m/(_=g-y))&&error("overflow"),p*=_;P=adapt(w-f,t=S.length+1,0==f),C(w/t)>m-T&&error("overflow"),T+=C(w/t),w%=t,S.splice(w++,0,T)}return ucs2encode(S)}function encode2(e){var t,n,a,l,f,p,h,v,y,_,b,k,w,T,P,A=[];for(k=(e=ucs2decode(e)).length,t=128,n=0,f=72,p=0;p<k;++p)(b=e[p])<128&&A.push(S(b));for(a=l=A.length,l&&A.push("-");a<k;){for(h=m,p=0;p<k;++p)(b=e[p])>=t&&b<h&&(h=b);for(h-t>C((m-n)/(w=a+1))&&error("overflow"),n+=(h-t)*w,t=h,p=0;p<k;++p)if((b=e[p])<t&&++n>m&&error("overflow"),b==t){for(v=n,y=g;!(v<(_=y<=f?1:y>=f+26?26:y-f));y+=g)P=v-_,T=g-_,A.push(S(digitToBasic(_+P%T,0))),v=C(P/T);A.push(S(digitToBasic(v,0))),f=adapt(n,w,a==l),n=0,++a}++n,++t}return A.join("")}if(p={version:"1.3.2",ucs2:{decode:ucs2decode,encode:ucs2encode},decode:decode2,encode:encode2,toASCII:function toASCII(e){return mapDomain(e,(function(e){return y.test(e)?"xn--"+encode2(e):e}))},toUnicode:function toUnicode(e){return mapDomain(e,(function(e){return v.test(e)?decode2(e.slice(4).toLowerCase()):e}))}},a&&l)if(e.exports==a)l.exports=p;else for(h in p)p.hasOwnProperty(h)&&(a[h]=p[h]);else n.punycode=p}(x.K)}(Ki,Ki.exports);var Zi={};function hasOwnProperty(e,t){return Object.prototype.hasOwnProperty.call(e,t)}var stringifyPrimitive=function(e){switch(typeof e){case"string":return e;case"boolean":return e?"true":"false";case"number":return isFinite(e)?e:"";default:return""}};Zi.decode=Zi.parse=function(e,t,n,a){t=t||"&",n=n||"=";var l={};if("string"!=typeof e||0===e.length)return l;var f=/\+/g;e=e.split(t);var p=1e3;a&&"number"==typeof a.maxKeys&&(p=a.maxKeys);var h=e.length;p>0&&h>p&&(h=p);for(var m=0;m<h;++m){var g,v,y,_,b=e[m].replace(f,"%20"),C=b.indexOf(n);C>=0?(g=b.substr(0,C),v=b.substr(C+1)):(g=b,v=""),y=decodeURIComponent(g),_=decodeURIComponent(v),hasOwnProperty(l,y)?Array.isArray(l[y])?l[y].push(_):l[y]=[l[y],_]:l[y]=_}return l},Zi.encode=Zi.stringify=function(e,t,n,a){return t=t||"&",n=n||"=",null===e&&(e=void 0),"object"==typeof e?Object.keys(e).map((function(a){var l=encodeURIComponent(stringifyPrimitive(a))+n;return Array.isArray(e[a])?e[a].map((function(e){return l+encodeURIComponent(stringifyPrimitive(e))})).join(t):l+encodeURIComponent(stringifyPrimitive(e[a]))})).join(t):a?encodeURIComponent(stringifyPrimitive(a))+n+encodeURIComponent(stringifyPrimitive(e)):""};var Qi=Ki.exports,Xi={isString:function(e){return"string"==typeof e},isObject:function(e){return"object"==typeof e&&null!==e},isNull:function(e){return null===e},isNullOrUndefined:function(e){return null==e}},Yi=zi.parse=urlParse;function Url(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}zi.resolve=function urlResolve(e,t){return urlParse(e,!1,!0).resolve(t)},zi.resolveObject=function urlResolveObject(e,t){return e?urlParse(e,!1,!0).resolveObject(t):t},zi.format=function urlFormat(e){Xi.isString(e)&&(e=urlParse(e));return e instanceof Url?e.format():Url.prototype.format.call(e)},zi.Url=Url;var Ji,ea,ta,na,ra,oa,ia,aa,sa,ca,la,ua,da,fa,pa,ha,ma,ga,va,ya,_a,ba,Ca,Sa,ka,wa,Ta,Pa,Ea=/^([a-z0-9.+-]+:)/i,Aa=/:[0-9]*$/,Ma=/^(\/\/?(?!\/)[^\?\s]*)(\?[^\s]*)?$/,xa=["{","}","|","\\","^","`"].concat(["<",">",'"',"`"," ","\r","\n","\t"]),Oa=["'"].concat(xa),Ra=["%","/","?",";","#"].concat(Oa),Ia=["/","?","#"],La=/^[+a-z0-9A-Z_-]{0,63}$/,Na=/^([+a-z0-9A-Z_-]{0,63})(.*)$/,Da={javascript:!0,"javascript:":!0},Ba={javascript:!0,"javascript:":!0},Fa={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},ja=Zi;function urlParse(e,t,n){if(e&&Xi.isObject(e)&&e instanceof Url)return e;var a=new Url;return a.parse(e,t,n),a}Url.prototype.parse=function(e,t,n){if(!Xi.isString(e))throw new TypeError("Parameter 'url' must be a string, not "+typeof e);var a=e.indexOf("?"),l=-1!==a&&a<e.indexOf("#")?"?":"#",f=e.split(l);f[0]=f[0].replace(/\\/g,"/");var p=e=f.join(l);if(p=p.trim(),!n&&1===e.split("#").length){var h=Ma.exec(p);if(h)return this.path=p,this.href=p,this.pathname=h[1],h[2]?(this.search=h[2],this.query=t?ja.parse(this.search.substr(1)):this.search.substr(1)):t&&(this.search="",this.query={}),this}var m=Ea.exec(p);if(m){var g=(m=m[0]).toLowerCase();this.protocol=g,p=p.substr(m.length)}if(n||m||p.match(/^\/\/[^@\/]+@[^@\/]+/)){var v="//"===p.substr(0,2);!v||m&&Ba[m]||(p=p.substr(2),this.slashes=!0)}if(!Ba[m]&&(v||m&&!Fa[m])){for(var y,_,b=-1,C=0;C<Ia.length;C++){-1!==(S=p.indexOf(Ia[C]))&&(-1===b||S<b)&&(b=S)}-1!==(_=-1===b?p.lastIndexOf("@"):p.lastIndexOf("@",b))&&(y=p.slice(0,_),p=p.slice(_+1),this.auth=decodeURIComponent(y)),b=-1;for(C=0;C<Ra.length;C++){var S;-1!==(S=p.indexOf(Ra[C]))&&(-1===b||S<b)&&(b=S)}-1===b&&(b=p.length),this.host=p.slice(0,b),p=p.slice(b),this.parseHost(),this.hostname=this.hostname||"";var k="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!k)for(var w=this.hostname.split(/\./),T=(C=0,w.length);C<T;C++){var P=w[C];if(P&&!P.match(La)){for(var A="",M=0,x=P.length;M<x;M++)P.charCodeAt(M)>127?A+="x":A+=P[M];if(!A.match(La)){var O=w.slice(0,C),R=w.slice(C+1),I=P.match(Na);I&&(O.push(I[1]),R.unshift(I[2])),R.length&&(p="/"+R.join(".")+p),this.hostname=O.join(".");break}}}this.hostname.length>255?this.hostname="":this.hostname=this.hostname.toLowerCase(),k||(this.hostname=Qi.toASCII(this.hostname));var L=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+L,this.href+=this.host,k&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==p[0]&&(p="/"+p))}if(!Da[g])for(C=0,T=Oa.length;C<T;C++){var D=Oa[C];if(-1!==p.indexOf(D)){var B=encodeURIComponent(D);B===D&&(B=escape(D)),p=p.split(D).join(B)}}var F=p.indexOf("#");-1!==F&&(this.hash=p.substr(F),p=p.slice(0,F));var j=p.indexOf("?");if(-1!==j?(this.search=p.substr(j),this.query=p.substr(j+1),t&&(this.query=ja.parse(this.query)),p=p.slice(0,j)):t&&(this.search="",this.query={}),p&&(this.pathname=p),Fa[g]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){L=this.pathname||"";var $=this.search||"";this.path=L+$}return this.href=this.format(),this},Url.prototype.format=function(){var e=this.auth||"";e&&(e=(e=encodeURIComponent(e)).replace(/%3A/i,":"),e+="@");var t=this.protocol||"",n=this.pathname||"",a=this.hash||"",l=!1,f="";this.host?l=e+this.host:this.hostname&&(l=e+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(l+=":"+this.port)),this.query&&Xi.isObject(this.query)&&Object.keys(this.query).length&&(f=ja.stringify(this.query));var p=this.search||f&&"?"+f||"";return t&&":"!==t.substr(-1)&&(t+=":"),this.slashes||(!t||Fa[t])&&!1!==l?(l="//"+(l||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):l||(l=""),a&&"#"!==a.charAt(0)&&(a="#"+a),p&&"?"!==p.charAt(0)&&(p="?"+p),t+l+(n=n.replace(/[?#]/g,(function(e){return encodeURIComponent(e)})))+(p=p.replace("#","%23"))+a},Url.prototype.resolve=function(e){return this.resolveObject(urlParse(e,!1,!0)).format()},Url.prototype.resolveObject=function(e){if(Xi.isString(e)){var t=new Url;t.parse(e,!1,!0),e=t}for(var n=new Url,a=Object.keys(this),l=0;l<a.length;l++){var f=a[l];n[f]=this[f]}if(n.hash=e.hash,""===e.href)return n.href=n.format(),n;if(e.slashes&&!e.protocol){for(var p=Object.keys(e),h=0;h<p.length;h++){var m=p[h];"protocol"!==m&&(n[m]=e[m])}return Fa[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n}if(e.protocol&&e.protocol!==n.protocol){if(!Fa[e.protocol]){for(var g=Object.keys(e),v=0;v<g.length;v++){var y=g[v];n[y]=e[y]}return n.href=n.format(),n}if(n.protocol=e.protocol,e.host||Ba[e.protocol])n.pathname=e.pathname;else{for(var _=(e.pathname||"").split("/");_.length&&!(e.host=_.shift()););e.host||(e.host=""),e.hostname||(e.hostname=""),""!==_[0]&&_.unshift(""),_.length<2&&_.unshift(""),n.pathname=_.join("/")}if(n.search=e.search,n.query=e.query,n.host=e.host||"",n.auth=e.auth,n.hostname=e.hostname||e.host,n.port=e.port,n.pathname||n.search){var b=n.pathname||"",C=n.search||"";n.path=b+C}return n.slashes=n.slashes||e.slashes,n.href=n.format(),n}var S=n.pathname&&"/"===n.pathname.charAt(0),k=e.host||e.pathname&&"/"===e.pathname.charAt(0),w=k||S||n.host&&e.pathname,T=w,P=n.pathname&&n.pathname.split("/")||[],A=(_=e.pathname&&e.pathname.split("/")||[],n.protocol&&!Fa[n.protocol]);if(A&&(n.hostname="",n.port=null,n.host&&(""===P[0]?P[0]=n.host:P.unshift(n.host)),n.host="",e.protocol&&(e.hostname=null,e.port=null,e.host&&(""===_[0]?_[0]=e.host:_.unshift(e.host)),e.host=null),w=w&&(""===_[0]||""===P[0])),k)n.host=e.host||""===e.host?e.host:n.host,n.hostname=e.hostname||""===e.hostname?e.hostname:n.hostname,n.search=e.search,n.query=e.query,P=_;else if(_.length)P||(P=[]),P.pop(),P=P.concat(_),n.search=e.search,n.query=e.query;else if(!Xi.isNullOrUndefined(e.search)){if(A)n.hostname=n.host=P.shift(),(I=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=I.shift(),n.host=n.hostname=I.shift());return n.search=e.search,n.query=e.query,Xi.isNull(n.pathname)&&Xi.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!P.length)return n.pathname=null,n.search?n.path="/"+n.search:n.path=null,n.href=n.format(),n;for(var M=P.slice(-1)[0],x=(n.host||e.host||P.length>1)&&("."===M||".."===M)||""===M,O=0,R=P.length;R>=0;R--)"."===(M=P[R])?P.splice(R,1):".."===M?(P.splice(R,1),O++):O&&(P.splice(R,1),O--);if(!w&&!T)for(;O--;O)P.unshift("..");!w||""===P[0]||P[0]&&"/"===P[0].charAt(0)||P.unshift(""),x&&"/"!==P.join("/").substr(-1)&&P.push("");var I,L=""===P[0]||P[0]&&"/"===P[0].charAt(0);A&&(n.hostname=n.host=L?"":P.length?P.shift():"",(I=!!(n.host&&n.host.indexOf("@")>0)&&n.host.split("@"))&&(n.auth=I.shift(),n.host=n.hostname=I.shift()));return(w=w||n.host&&P.length)&&!L&&P.unshift(""),P.length?n.pathname=P.join("/"):(n.pathname=null,n.path=null),Xi.isNull(n.pathname)&&Xi.isNull(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=e.auth||n.auth,n.slashes=n.slashes||e.slashes,n.href=n.format(),n},Url.prototype.parseHost=function(){var e=this.host,t=Aa.exec(e);t&&(":"!==(t=t[0])&&(this.port=t.substr(1)),e=e.substr(0,e.length-t.length)),e&&(this.hostname=e)},(ea=Ji||(Ji={}))[ea.WEBGL_LEGACY=0]="WEBGL_LEGACY",ea[ea.WEBGL=1]="WEBGL",ea[ea.WEBGL2=2]="WEBGL2",(na=ta||(ta={}))[na.UNKNOWN=0]="UNKNOWN",na[na.WEBGL=1]="WEBGL",na[na.CANVAS=2]="CANVAS",(oa=ra||(ra={}))[oa.NORMAL=0]="NORMAL",oa[oa.ADD=1]="ADD",oa[oa.MULTIPLY=2]="MULTIPLY",oa[oa.SCREEN=3]="SCREEN",oa[oa.OVERLAY=4]="OVERLAY",oa[oa.DARKEN=5]="DARKEN",oa[oa.LIGHTEN=6]="LIGHTEN",oa[oa.COLOR_DODGE=7]="COLOR_DODGE",oa[oa.COLOR_BURN=8]="COLOR_BURN",oa[oa.HARD_LIGHT=9]="HARD_LIGHT",oa[oa.SOFT_LIGHT=10]="SOFT_LIGHT",oa[oa.DIFFERENCE=11]="DIFFERENCE",oa[oa.EXCLUSION=12]="EXCLUSION",oa[oa.HUE=13]="HUE",oa[oa.SATURATION=14]="SATURATION",oa[oa.COLOR=15]="COLOR",oa[oa.LUMINOSITY=16]="LUMINOSITY",oa[oa.NORMAL_NPM=17]="NORMAL_NPM",oa[oa.ADD_NPM=18]="ADD_NPM",oa[oa.SCREEN_NPM=19]="SCREEN_NPM",oa[oa.NONE=20]="NONE",oa[oa.SRC_OVER=0]="SRC_OVER",oa[oa.SRC_IN=21]="SRC_IN",oa[oa.SRC_OUT=22]="SRC_OUT",oa[oa.SRC_ATOP=23]="SRC_ATOP",oa[oa.DST_OVER=24]="DST_OVER",oa[oa.DST_IN=25]="DST_IN",oa[oa.DST_OUT=26]="DST_OUT",oa[oa.DST_ATOP=27]="DST_ATOP",oa[oa.ERASE=26]="ERASE",oa[oa.SUBTRACT=28]="SUBTRACT",oa[oa.XOR=29]="XOR",(aa=ia||(ia={}))[aa.POINTS=0]="POINTS",aa[aa.LINES=1]="LINES",aa[aa.LINE_LOOP=2]="LINE_LOOP",aa[aa.LINE_STRIP=3]="LINE_STRIP",aa[aa.TRIANGLES=4]="TRIANGLES",aa[aa.TRIANGLE_STRIP=5]="TRIANGLE_STRIP",aa[aa.TRIANGLE_FAN=6]="TRIANGLE_FAN",(ca=sa||(sa={}))[ca.RGBA=6408]="RGBA",ca[ca.RGB=6407]="RGB",ca[ca.ALPHA=6406]="ALPHA",ca[ca.LUMINANCE=6409]="LUMINANCE",ca[ca.LUMINANCE_ALPHA=6410]="LUMINANCE_ALPHA",ca[ca.DEPTH_COMPONENT=6402]="DEPTH_COMPONENT",ca[ca.DEPTH_STENCIL=34041]="DEPTH_STENCIL",(ua=la||(la={}))[ua.TEXTURE_2D=3553]="TEXTURE_2D",ua[ua.TEXTURE_CUBE_MAP=34067]="TEXTURE_CUBE_MAP",ua[ua.TEXTURE_2D_ARRAY=35866]="TEXTURE_2D_ARRAY",ua[ua.TEXTURE_CUBE_MAP_POSITIVE_X=34069]="TEXTURE_CUBE_MAP_POSITIVE_X",ua[ua.TEXTURE_CUBE_MAP_NEGATIVE_X=34070]="TEXTURE_CUBE_MAP_NEGATIVE_X",ua[ua.TEXTURE_CUBE_MAP_POSITIVE_Y=34071]="TEXTURE_CUBE_MAP_POSITIVE_Y",ua[ua.TEXTURE_CUBE_MAP_NEGATIVE_Y=34072]="TEXTURE_CUBE_MAP_NEGATIVE_Y",ua[ua.TEXTURE_CUBE_MAP_POSITIVE_Z=34073]="TEXTURE_CUBE_MAP_POSITIVE_Z",ua[ua.TEXTURE_CUBE_MAP_NEGATIVE_Z=34074]="TEXTURE_CUBE_MAP_NEGATIVE_Z",(fa=da||(da={}))[fa.UNSIGNED_BYTE=5121]="UNSIGNED_BYTE",fa[fa.UNSIGNED_SHORT=5123]="UNSIGNED_SHORT",fa[fa.UNSIGNED_SHORT_5_6_5=33635]="UNSIGNED_SHORT_5_6_5",fa[fa.UNSIGNED_SHORT_4_4_4_4=32819]="UNSIGNED_SHORT_4_4_4_4",fa[fa.UNSIGNED_SHORT_5_5_5_1=32820]="UNSIGNED_SHORT_5_5_5_1",fa[fa.FLOAT=5126]="FLOAT",fa[fa.HALF_FLOAT=36193]="HALF_FLOAT",(ha=pa||(pa={}))[ha.NEAREST=0]="NEAREST",ha[ha.LINEAR=1]="LINEAR",(ga=ma||(ma={}))[ga.CLAMP=33071]="CLAMP",ga[ga.REPEAT=10497]="REPEAT",ga[ga.MIRRORED_REPEAT=33648]="MIRRORED_REPEAT",(ya=va||(va={}))[ya.OFF=0]="OFF",ya[ya.POW2=1]="POW2",ya[ya.ON=2]="ON",(ba=_a||(_a={}))[ba.NPM=0]="NPM",ba[ba.UNPACK=1]="UNPACK",ba[ba.PMA=2]="PMA",ba[ba.NO_PREMULTIPLIED_ALPHA=0]="NO_PREMULTIPLIED_ALPHA",ba[ba.PREMULTIPLY_ON_UPLOAD=1]="PREMULTIPLY_ON_UPLOAD",ba[ba.PREMULTIPLY_ALPHA=2]="PREMULTIPLY_ALPHA",(Sa=Ca||(Ca={}))[Sa.AUTO=0]="AUTO",Sa[Sa.MANUAL=1]="MANUAL",(wa=ka||(ka={})).LOW="lowp",wa.MEDIUM="mediump",wa.HIGH="highp",(Pa=Ta||(Ta={}))[Pa.NONE=0]="NONE",Pa[Pa.SCISSOR=1]="SCISSOR",Pa[Pa.STENCIL=2]="STENCIL",Pa[Pa.SPRITE=3]="SPRITE",
/*!
 * @pixi/utils - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/utils is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
Vi.RETINA_PREFIX=/@([0-9\.]+)x/,Vi.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT=!0;var $a,Ha=!1;function hex2rgb(e,t){return(t=t||[])[0]=(e>>16&255)/255,t[1]=(e>>8&255)/255,t[2]=(255&e)/255,t}function hex2string(e){var t=e.toString(16);return"#"+(t="000000".substr(0,6-t.length)+t)}function string2hex(e){return"string"==typeof e&&"#"===e[0]&&(e=e.substr(1)),parseInt(e,16)}function rgb2hex(e){return(255*e[0]<<16)+(255*e[1]<<8)+(255*e[2]|0)}var Va=function mapPremultipliedBlendModes(){for(var e=[],t=[],n=0;n<32;n++)e[n]=n,t[n]=n;e[ra.NORMAL_NPM]=ra.NORMAL,e[ra.ADD_NPM]=ra.ADD,e[ra.SCREEN_NPM]=ra.SCREEN,t[ra.NORMAL]=ra.NORMAL_NPM,t[ra.ADD]=ra.ADD_NPM,t[ra.SCREEN]=ra.SCREEN_NPM;var a=[];return a.push(t),a.push(e),a}();function correctBlendMode(e,t){return Va[t?1:0][e]}function premultiplyRgba(e,t,n,a){return n=n||new Float32Array(4),a||void 0===a?(n[0]=e[0]*t,n[1]=e[1]*t,n[2]=e[2]*t):(n[0]=e[0],n[1]=e[1],n[2]=e[2]),n[3]=t,n}function premultiplyTint(e,t){if(1===t)return(255*t<<24)+e;if(0===t)return 0;var n=e>>16&255,a=e>>8&255,l=255&e;return(255*t<<24)+((n=n*t+.5|0)<<16)+((a=a*t+.5|0)<<8)+(l=l*t+.5|0)}function premultiplyTintToRgba(e,t,n,a){return(n=n||new Float32Array(4))[0]=(e>>16&255)/255,n[1]=(e>>8&255)/255,n[2]=(255&e)/255,(a||void 0===a)&&(n[0]*=t,n[1]*=t,n[2]*=t),n[3]=t,n}function createIndicesForQuads(e,t){void 0===t&&(t=null);var n=6*e;if((t=t||new Uint16Array(n)).length!==n)throw new Error("Out buffer length is incorrect, got "+t.length+" and expected "+n);for(var a=0,l=0;a<n;a+=6,l+=4)t[a+0]=l+0,t[a+1]=l+1,t[a+2]=l+2,t[a+3]=l+0,t[a+4]=l+2,t[a+5]=l+3;return t}function nextPow2(e){return e+=0===e?1:0,--e,e|=e>>>1,e|=e>>>2,e|=e>>>4,e|=e>>>8,(e|=e>>>16)+1}function isPow2(e){return!(e&e-1||!e)}function log2(e){var t=(e>65535?1:0)<<4,n=((e>>>=t)>255?1:0)<<3;return t|=n,t|=n=((e>>>=n)>15?1:0)<<2,(t|=n=((e>>>=n)>3?1:0)<<1)|(e>>>=n)>>1}function removeItems(e,t,n){var a,l=e.length;if(!(t>=l||0===n)){var f=l-(n=t+n>l?l-t:n);for(a=t;a<f;++a)e[a]=e[a+n];e.length=f}}function sign(e){return 0===e?0:e<0?-1:1}var Ua=0;function uid(){return++Ua}var Ga={};function deprecation(e,t,n){if(void 0===n&&(n=3),!Ga[t]){var a=(new Error).stack;void 0===a?console.warn("PixiJS Deprecation Warning: ",t+"\nDeprecated since v"+e):(a=a.split("\n").splice(n).join("\n"),console.groupCollapsed?(console.groupCollapsed("%cPixiJS Deprecation Warning: %c%s","color:#614108;background:#fffbe6","font-weight:normal;color:#614108;background:#fffbe6",t+"\nDeprecated since v"+e),console.warn(a),console.groupEnd()):(console.warn("PixiJS Deprecation Warning: ",t+"\nDeprecated since v"+e),console.warn(a))),Ga[t]=!0}}var qa,Wa={},za=Object.create(null),Ka=Object.create(null),Za=function(){function CanvasRenderTarget2(e,t,n){this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d"),this.resolution=n||Vi.RESOLUTION,this.resize(e,t)}return CanvasRenderTarget2.prototype.clear=function(){this.context.setTransform(1,0,0,1,0,0),this.context.clearRect(0,0,this.canvas.width,this.canvas.height)},CanvasRenderTarget2.prototype.resize=function(e,t){this.canvas.width=e*this.resolution,this.canvas.height=t*this.resolution},CanvasRenderTarget2.prototype.destroy=function(){this.context=null,this.canvas=null},Object.defineProperty(CanvasRenderTarget2.prototype,"width",{get:function(){return this.canvas.width},set:function(e){this.canvas.width=e},enumerable:!0,configurable:!0}),Object.defineProperty(CanvasRenderTarget2.prototype,"height",{get:function(){return this.canvas.height},set:function(e){this.canvas.height=e},enumerable:!0,configurable:!0}),CanvasRenderTarget2}();function trimCanvas(e){var t,n,a,l=e.width,f=e.height,p=e.getContext("2d"),h=p.getImageData(0,0,l,f).data,m=h.length,g={top:null,left:null,right:null,bottom:null},v=null;for(t=0;t<m;t+=4)0!==h[t+3]&&(n=t/4%l,a=~~(t/4/l),null===g.top&&(g.top=a),(null===g.left||n<g.left)&&(g.left=n),(null===g.right||g.right<n)&&(g.right=n+1),(null===g.bottom||g.bottom<a)&&(g.bottom=a));return null!==g.top&&(l=g.right-g.left,f=g.bottom-g.top+1,v=p.getImageData(g.left,g.top,l,f)),{height:f,width:l,data:v}}function getResolutionOfUrl(e,t){var n=Vi.RETINA_PREFIX.exec(e);return n?parseFloat(n[1]):void 0!==t?t:1}
/*!
 * @pixi/math - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/math is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */var Qa,Xa,Ya=function(){function Point2(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this.x=e,this.y=t}return Point2.prototype.clone=function(){return new Point2(this.x,this.y)},Point2.prototype.copyFrom=function(e){return this.set(e.x,e.y),this},Point2.prototype.copyTo=function(e){return e.set(this.x,this.y),e},Point2.prototype.equals=function(e){return e.x===this.x&&e.y===this.y},Point2.prototype.set=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=e),this.x=e,this.y=t,this},Point2}(),Ja=function(){function ObservablePoint2(e,t,n,a){void 0===n&&(n=0),void 0===a&&(a=0),this._x=n,this._y=a,this.cb=e,this.scope=t}return ObservablePoint2.prototype.clone=function(e,t){return void 0===e&&(e=this.cb),void 0===t&&(t=this.scope),new ObservablePoint2(e,t,this._x,this._y)},ObservablePoint2.prototype.set=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=e),this._x===e&&this._y===t||(this._x=e,this._y=t,this.cb.call(this.scope)),this},ObservablePoint2.prototype.copyFrom=function(e){return this._x===e.x&&this._y===e.y||(this._x=e.x,this._y=e.y,this.cb.call(this.scope)),this},ObservablePoint2.prototype.copyTo=function(e){return e.set(this._x,this._y),e},ObservablePoint2.prototype.equals=function(e){return e.x===this._x&&e.y===this._y},Object.defineProperty(ObservablePoint2.prototype,"x",{get:function(){return this._x},set:function(e){this._x!==e&&(this._x=e,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),Object.defineProperty(ObservablePoint2.prototype,"y",{get:function(){return this._y},set:function(e){this._y!==e&&(this._y=e,this.cb.call(this.scope))},enumerable:!0,configurable:!0}),ObservablePoint2}(),es=2*Math.PI,ts=180/Math.PI,ns=Math.PI/180;(Xa=Qa||(Qa={}))[Xa.POLY=0]="POLY",Xa[Xa.RECT=1]="RECT",Xa[Xa.CIRC=2]="CIRC",Xa[Xa.ELIP=3]="ELIP",Xa[Xa.RREC=4]="RREC";var rs=function(){function Matrix2(e,t,n,a,l,f){void 0===e&&(e=1),void 0===t&&(t=0),void 0===n&&(n=0),void 0===a&&(a=1),void 0===l&&(l=0),void 0===f&&(f=0),this.array=null,this.a=e,this.b=t,this.c=n,this.d=a,this.tx=l,this.ty=f}return Matrix2.prototype.fromArray=function(e){this.a=e[0],this.b=e[1],this.c=e[3],this.d=e[4],this.tx=e[2],this.ty=e[5]},Matrix2.prototype.set=function(e,t,n,a,l,f){return this.a=e,this.b=t,this.c=n,this.d=a,this.tx=l,this.ty=f,this},Matrix2.prototype.toArray=function(e,t){this.array||(this.array=new Float32Array(9));var n=t||this.array;return e?(n[0]=this.a,n[1]=this.b,n[2]=0,n[3]=this.c,n[4]=this.d,n[5]=0,n[6]=this.tx,n[7]=this.ty,n[8]=1):(n[0]=this.a,n[1]=this.c,n[2]=this.tx,n[3]=this.b,n[4]=this.d,n[5]=this.ty,n[6]=0,n[7]=0,n[8]=1),n},Matrix2.prototype.apply=function(e,t){t=t||new Ya;var n=e.x,a=e.y;return t.x=this.a*n+this.c*a+this.tx,t.y=this.b*n+this.d*a+this.ty,t},Matrix2.prototype.applyInverse=function(e,t){t=t||new Ya;var n=1/(this.a*this.d+this.c*-this.b),a=e.x,l=e.y;return t.x=this.d*n*a+-this.c*n*l+(this.ty*this.c-this.tx*this.d)*n,t.y=this.a*n*l+-this.b*n*a+(-this.ty*this.a+this.tx*this.b)*n,t},Matrix2.prototype.translate=function(e,t){return this.tx+=e,this.ty+=t,this},Matrix2.prototype.scale=function(e,t){return this.a*=e,this.d*=t,this.c*=e,this.b*=t,this.tx*=e,this.ty*=t,this},Matrix2.prototype.rotate=function(e){var t=Math.cos(e),n=Math.sin(e),a=this.a,l=this.c,f=this.tx;return this.a=a*t-this.b*n,this.b=a*n+this.b*t,this.c=l*t-this.d*n,this.d=l*n+this.d*t,this.tx=f*t-this.ty*n,this.ty=f*n+this.ty*t,this},Matrix2.prototype.append=function(e){var t=this.a,n=this.b,a=this.c,l=this.d;return this.a=e.a*t+e.b*a,this.b=e.a*n+e.b*l,this.c=e.c*t+e.d*a,this.d=e.c*n+e.d*l,this.tx=e.tx*t+e.ty*a+this.tx,this.ty=e.tx*n+e.ty*l+this.ty,this},Matrix2.prototype.setTransform=function(e,t,n,a,l,f,p,h,m){return this.a=Math.cos(p+m)*l,this.b=Math.sin(p+m)*l,this.c=-Math.sin(p-h)*f,this.d=Math.cos(p-h)*f,this.tx=e-(n*this.a+a*this.c),this.ty=t-(n*this.b+a*this.d),this},Matrix2.prototype.prepend=function(e){var t=this.tx;if(1!==e.a||0!==e.b||0!==e.c||1!==e.d){var n=this.a,a=this.c;this.a=n*e.a+this.b*e.c,this.b=n*e.b+this.b*e.d,this.c=a*e.a+this.d*e.c,this.d=a*e.b+this.d*e.d}return this.tx=t*e.a+this.ty*e.c+e.tx,this.ty=t*e.b+this.ty*e.d+e.ty,this},Matrix2.prototype.decompose=function(e){var t=this.a,n=this.b,a=this.c,l=this.d,f=-Math.atan2(-a,l),p=Math.atan2(n,t),h=Math.abs(f+p);return h<1e-5||Math.abs(es-h)<1e-5?(e.rotation=p,e.skew.x=e.skew.y=0):(e.rotation=0,e.skew.x=f,e.skew.y=p),e.scale.x=Math.sqrt(t*t+n*n),e.scale.y=Math.sqrt(a*a+l*l),e.position.x=this.tx,e.position.y=this.ty,e},Matrix2.prototype.invert=function(){var e=this.a,t=this.b,n=this.c,a=this.d,l=this.tx,f=e*a-t*n;return this.a=a/f,this.b=-t/f,this.c=-n/f,this.d=e/f,this.tx=(n*this.ty-a*l)/f,this.ty=-(e*this.ty-t*l)/f,this},Matrix2.prototype.identity=function(){return this.a=1,this.b=0,this.c=0,this.d=1,this.tx=0,this.ty=0,this},Matrix2.prototype.clone=function(){var e=new Matrix2;return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},Matrix2.prototype.copyTo=function(e){return e.a=this.a,e.b=this.b,e.c=this.c,e.d=this.d,e.tx=this.tx,e.ty=this.ty,e},Matrix2.prototype.copyFrom=function(e){return this.a=e.a,this.b=e.b,this.c=e.c,this.d=e.d,this.tx=e.tx,this.ty=e.ty,this},Object.defineProperty(Matrix2,"IDENTITY",{get:function(){return new Matrix2},enumerable:!0,configurable:!0}),Object.defineProperty(Matrix2,"TEMP_MATRIX",{get:function(){return new Matrix2},enumerable:!0,configurable:!0}),Matrix2}(),os=[1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1,0,1],as=[0,1,1,1,0,-1,-1,-1,0,1,1,1,0,-1,-1,-1],ss=[0,-1,-1,-1,0,1,1,1,0,1,1,1,0,-1,-1,-1],cs=[1,1,0,-1,-1,-1,0,1,-1,-1,0,1,1,1,0,-1],ls=[],us=[],ds=Math.sign;!function init(){for(var e=0;e<16;e++){var t=[];ls.push(t);for(var n=0;n<16;n++)for(var a=ds(os[e]*os[n]+ss[e]*as[n]),l=ds(as[e]*os[n]+cs[e]*as[n]),f=ds(os[e]*ss[n]+ss[e]*cs[n]),p=ds(as[e]*ss[n]+cs[e]*cs[n]),h=0;h<16;h++)if(os[h]===a&&as[h]===l&&ss[h]===f&&cs[h]===p){t.push(h);break}}for(e=0;e<16;e++){var m=new rs;m.set(os[e],as[e],ss[e],cs[e],0,0),us.push(m)}}();var fs={E:0,SE:1,S:2,SW:3,W:4,NW:5,N:6,NE:7,MIRROR_VERTICAL:8,MAIN_DIAGONAL:10,MIRROR_HORIZONTAL:12,REVERSE_DIAGONAL:14,uX:function(e){return os[e]},uY:function(e){return as[e]},vX:function(e){return ss[e]},vY:function(e){return cs[e]},inv:function(e){return 8&e?15&e:7&-e},add:function(e,t){return ls[e][t]},sub:function(e,t){return ls[e][fs.inv(t)]},rotate180:function(e){return 4^e},isVertical:function(e){return 2==(3&e)},byDirection:function(e,t){return 2*Math.abs(e)<=Math.abs(t)?t>=0?fs.S:fs.N:2*Math.abs(t)<=Math.abs(e)?e>0?fs.E:fs.W:t>0?e>0?fs.SE:fs.SW:e>0?fs.NE:fs.NW},matrixAppendRotationInv:function(e,t,n,a){void 0===n&&(n=0),void 0===a&&(a=0);var l=us[fs.inv(t)];l.tx=n,l.ty=a,e.append(l)}},ps=function(){function Transform2(){this.worldTransform=new rs,this.localTransform=new rs,this.position=new Ja(this.onChange,this,0,0),this.scale=new Ja(this.onChange,this,1,1),this.pivot=new Ja(this.onChange,this,0,0),this.skew=new Ja(this.updateSkew,this,0,0),this._rotation=0,this._cx=1,this._sx=0,this._cy=0,this._sy=1,this._localID=0,this._currentLocalID=0,this._worldID=0,this._parentID=0}return Transform2.prototype.onChange=function(){this._localID++},Transform2.prototype.updateSkew=function(){this._cx=Math.cos(this._rotation+this.skew.y),this._sx=Math.sin(this._rotation+this.skew.y),this._cy=-Math.sin(this._rotation-this.skew.x),this._sy=Math.cos(this._rotation-this.skew.x),this._localID++},Transform2.prototype.updateLocalTransform=function(){var e=this.localTransform;this._localID!==this._currentLocalID&&(e.a=this._cx*this.scale.x,e.b=this._sx*this.scale.x,e.c=this._cy*this.scale.y,e.d=this._sy*this.scale.y,e.tx=this.position.x-(this.pivot.x*e.a+this.pivot.y*e.c),e.ty=this.position.y-(this.pivot.x*e.b+this.pivot.y*e.d),this._currentLocalID=this._localID,this._parentID=-1)},Transform2.prototype.updateTransform=function(e){var t=this.localTransform;if(this._localID!==this._currentLocalID&&(t.a=this._cx*this.scale.x,t.b=this._sx*this.scale.x,t.c=this._cy*this.scale.y,t.d=this._sy*this.scale.y,t.tx=this.position.x-(this.pivot.x*t.a+this.pivot.y*t.c),t.ty=this.position.y-(this.pivot.x*t.b+this.pivot.y*t.d),this._currentLocalID=this._localID,this._parentID=-1),this._parentID!==e._worldID){var n=e.worldTransform,a=this.worldTransform;a.a=t.a*n.a+t.b*n.c,a.b=t.a*n.b+t.b*n.d,a.c=t.c*n.a+t.d*n.c,a.d=t.c*n.b+t.d*n.d,a.tx=t.tx*n.a+t.ty*n.c+n.tx,a.ty=t.tx*n.b+t.ty*n.d+n.ty,this._parentID=e._worldID,this._worldID++}},Transform2.prototype.setFromMatrix=function(e){e.decompose(this),this._localID++},Object.defineProperty(Transform2.prototype,"rotation",{get:function(){return this._rotation},set:function(e){this._rotation!==e&&(this._rotation=e,this.updateSkew())},enumerable:!0,configurable:!0}),Transform2.IDENTITY=new Transform2,Transform2}(),hs=function(){function Rectangle2(e,t,n,a){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===a&&(a=0),this.x=Number(e),this.y=Number(t),this.width=Number(n),this.height=Number(a),this.type=Qa.RECT}return Object.defineProperty(Rectangle2.prototype,"left",{get:function(){return this.x},enumerable:!0,configurable:!0}),Object.defineProperty(Rectangle2.prototype,"right",{get:function(){return this.x+this.width},enumerable:!0,configurable:!0}),Object.defineProperty(Rectangle2.prototype,"top",{get:function(){return this.y},enumerable:!0,configurable:!0}),Object.defineProperty(Rectangle2.prototype,"bottom",{get:function(){return this.y+this.height},enumerable:!0,configurable:!0}),Object.defineProperty(Rectangle2,"EMPTY",{get:function(){return new Rectangle2(0,0,0,0)},enumerable:!0,configurable:!0}),Rectangle2.prototype.clone=function(){return new Rectangle2(this.x,this.y,this.width,this.height)},Rectangle2.prototype.copyFrom=function(e){return this.x=e.x,this.y=e.y,this.width=e.width,this.height=e.height,this},Rectangle2.prototype.copyTo=function(e){return e.x=this.x,e.y=this.y,e.width=this.width,e.height=this.height,e},Rectangle2.prototype.contains=function(e,t){return!(this.width<=0||this.height<=0)&&(e>=this.x&&e<this.x+this.width&&t>=this.y&&t<this.y+this.height)},Rectangle2.prototype.pad=function(e,t){return void 0===e&&(e=0),void 0===t&&(t=e),this.x-=e,this.y-=t,this.width+=2*e,this.height+=2*t,this},Rectangle2.prototype.fit=function(e){var t=Math.max(this.x,e.x),n=Math.min(this.x+this.width,e.x+e.width),a=Math.max(this.y,e.y),l=Math.min(this.y+this.height,e.y+e.height);return this.x=t,this.width=Math.max(n-t,0),this.y=a,this.height=Math.max(l-a,0),this},Rectangle2.prototype.ceil=function(e,t){void 0===e&&(e=1),void 0===t&&(t=.001);var n=Math.ceil((this.x+this.width-t)*e)/e,a=Math.ceil((this.y+this.height-t)*e)/e;return this.x=Math.floor((this.x+t)*e)/e,this.y=Math.floor((this.y+t)*e)/e,this.width=n-this.x,this.height=a-this.y,this},Rectangle2.prototype.enlarge=function(e){var t=Math.min(this.x,e.x),n=Math.max(this.x+this.width,e.x+e.width),a=Math.min(this.y,e.y),l=Math.max(this.y+this.height,e.y+e.height);return this.x=t,this.width=n-t,this.y=a,this.height=l-a,this},Rectangle2}(),ms=function(){function Circle2(e,t,n){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),this.x=e,this.y=t,this.radius=n,this.type=Qa.CIRC}return Circle2.prototype.clone=function(){return new Circle2(this.x,this.y,this.radius)},Circle2.prototype.contains=function(e,t){if(this.radius<=0)return!1;var n=this.radius*this.radius,a=this.x-e,l=this.y-t;return(a*=a)+(l*=l)<=n},Circle2.prototype.getBounds=function(){return new hs(this.x-this.radius,this.y-this.radius,2*this.radius,2*this.radius)},Circle2}(),gs=function(){function Ellipse2(e,t,n,a){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===a&&(a=0),this.x=e,this.y=t,this.width=n,this.height=a,this.type=Qa.ELIP}return Ellipse2.prototype.clone=function(){return new Ellipse2(this.x,this.y,this.width,this.height)},Ellipse2.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;var n=(e-this.x)/this.width,a=(t-this.y)/this.height;return(n*=n)+(a*=a)<=1},Ellipse2.prototype.getBounds=function(){return new hs(this.x-this.width,this.y-this.height,this.width,this.height)},Ellipse2}(),vs=function(){function Polygon2(){for(var e=arguments,t=[],n=0;n<arguments.length;n++)t[n]=e[n];if(Array.isArray(t[0])&&(t=t[0]),t[0]instanceof Ya){for(var a=[],l=0,f=(t=t).length;l<f;l++)a.push(t[l].x,t[l].y);t=a}this.points=t,this.type=Qa.POLY,this.closeStroke=!0}return Polygon2.prototype.clone=function(){var e=new Polygon2(this.points.slice());return e.closeStroke=this.closeStroke,e},Polygon2.prototype.contains=function(e,t){for(var n=!1,a=this.points.length/2,l=0,f=a-1;l<a;f=l++){var p=this.points[2*l],h=this.points[2*l+1],m=this.points[2*f],g=this.points[2*f+1];h>t!=g>t&&e<(t-h)/(g-h)*(m-p)+p&&(n=!n)}return n},Polygon2}(),ys=function(){function RoundedRectangle2(e,t,n,a,l){void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=0),void 0===a&&(a=0),void 0===l&&(l=20),this.x=e,this.y=t,this.width=n,this.height=a,this.radius=l,this.type=Qa.RREC}return RoundedRectangle2.prototype.clone=function(){return new RoundedRectangle2(this.x,this.y,this.width,this.height,this.radius)},RoundedRectangle2.prototype.contains=function(e,t){if(this.width<=0||this.height<=0)return!1;if(e>=this.x&&e<=this.x+this.width&&t>=this.y&&t<=this.y+this.height){if(t>=this.y+this.radius&&t<=this.y+this.height-this.radius||e>=this.x+this.radius&&e<=this.x+this.width-this.radius)return!0;var n=e-(this.x+this.radius),a=t-(this.y+this.radius),l=this.radius*this.radius;if(n*n+a*a<=l)return!0;if((n=e-(this.x+this.width-this.radius))*n+a*a<=l)return!0;if(n*n+(a=t-(this.y+this.height-this.radius))*a<=l)return!0;if((n=e-(this.x+this.radius))*n+a*a<=l)return!0}return!1},RoundedRectangle2}();
/*!
 * @pixi/display - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/display is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
Vi.SORTABLE_CHILDREN=!1;var _s=function Bounds2(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,this.rect=null};_s.prototype.isEmpty=function isEmpty(){return this.minX>this.maxX||this.minY>this.maxY},_s.prototype.clear=function clear(){this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0},_s.prototype.getRectangle=function getRectangle(e){return this.minX>this.maxX||this.minY>this.maxY?hs.EMPTY:((e=e||new hs(0,0,1,1)).x=this.minX,e.y=this.minY,e.width=this.maxX-this.minX,e.height=this.maxY-this.minY,e)},_s.prototype.addPoint=function addPoint(e){this.minX=Math.min(this.minX,e.x),this.maxX=Math.max(this.maxX,e.x),this.minY=Math.min(this.minY,e.y),this.maxY=Math.max(this.maxY,e.y)},_s.prototype.addQuad=function addQuad(e){var t=this.minX,n=this.minY,a=this.maxX,l=this.maxY,f=e[0],p=e[1];t=f<t?f:t,n=p<n?p:n,a=f>a?f:a,l=p>l?p:l,t=(f=e[2])<t?f:t,n=(p=e[3])<n?p:n,a=f>a?f:a,l=p>l?p:l,t=(f=e[4])<t?f:t,n=(p=e[5])<n?p:n,a=f>a?f:a,l=p>l?p:l,t=(f=e[6])<t?f:t,n=(p=e[7])<n?p:n,a=f>a?f:a,l=p>l?p:l,this.minX=t,this.minY=n,this.maxX=a,this.maxY=l},_s.prototype.addFrame=function addFrame(e,t,n,a,l){this.addFrameMatrix(e.worldTransform,t,n,a,l)},_s.prototype.addFrameMatrix=function addFrameMatrix(e,t,n,a,l){var f=e.a,p=e.b,h=e.c,m=e.d,g=e.tx,v=e.ty,y=this.minX,_=this.minY,b=this.maxX,C=this.maxY,S=f*t+h*n+g,k=p*t+m*n+v;y=S<y?S:y,_=k<_?k:_,b=S>b?S:b,C=k>C?k:C,y=(S=f*a+h*n+g)<y?S:y,_=(k=p*a+m*n+v)<_?k:_,b=S>b?S:b,C=k>C?k:C,y=(S=f*t+h*l+g)<y?S:y,_=(k=p*t+m*l+v)<_?k:_,b=S>b?S:b,C=k>C?k:C,y=(S=f*a+h*l+g)<y?S:y,_=(k=p*a+m*l+v)<_?k:_,b=S>b?S:b,C=k>C?k:C,this.minX=y,this.minY=_,this.maxX=b,this.maxY=C},_s.prototype.addVertexData=function addVertexData(e,t,n){for(var a=this.minX,l=this.minY,f=this.maxX,p=this.maxY,h=t;h<n;h+=2){var m=e[h],g=e[h+1];a=m<a?m:a,l=g<l?g:l,f=m>f?m:f,p=g>p?g:p}this.minX=a,this.minY=l,this.maxX=f,this.maxY=p},_s.prototype.addVertices=function addVertices(e,t,n,a){this.addVerticesMatrix(e.worldTransform,t,n,a)},_s.prototype.addVerticesMatrix=function addVerticesMatrix(e,t,n,a,l,f){var p=e.a,h=e.b,m=e.c,g=e.d,v=e.tx,y=e.ty;l=l||0,f=f||0;for(var _=this.minX,b=this.minY,C=this.maxX,S=this.maxY,k=n;k<a;k+=2){var w=t[k],T=t[k+1],P=p*w+m*T+v,A=g*T+h*w+y;_=Math.min(_,P-l),C=Math.max(C,P+l),b=Math.min(b,A-f),S=Math.max(S,A+f)}this.minX=_,this.minY=b,this.maxX=C,this.maxY=S},_s.prototype.addBounds=function addBounds(e){var t=this.minX,n=this.minY,a=this.maxX,l=this.maxY;this.minX=e.minX<t?e.minX:t,this.minY=e.minY<n?e.minY:n,this.maxX=e.maxX>a?e.maxX:a,this.maxY=e.maxY>l?e.maxY:l},_s.prototype.addBoundsMask=function addBoundsMask(e,t){var n=e.minX>t.minX?e.minX:t.minX,a=e.minY>t.minY?e.minY:t.minY,l=e.maxX<t.maxX?e.maxX:t.maxX,f=e.maxY<t.maxY?e.maxY:t.maxY;if(n<=l&&a<=f){var p=this.minX,h=this.minY,m=this.maxX,g=this.maxY;this.minX=n<p?n:p,this.minY=a<h?a:h,this.maxX=l>m?l:m,this.maxY=f>g?f:g}},_s.prototype.addBoundsMatrix=function addBoundsMatrix(e,t){this.addFrameMatrix(t,e.minX,e.minY,e.maxX,e.maxY)},_s.prototype.addBoundsArea=function addBoundsArea(e,t){var n=e.minX>t.x?e.minX:t.x,a=e.minY>t.y?e.minY:t.y,l=e.maxX<t.x+t.width?e.maxX:t.x+t.width,f=e.maxY<t.y+t.height?e.maxY:t.y+t.height;if(n<=l&&a<=f){var p=this.minX,h=this.minY,m=this.maxX,g=this.maxY;this.minX=n<p?n:p,this.minY=a<h?a:h,this.maxX=l>m?l:m,this.maxY=f>g?f:g}},_s.prototype.pad=function pad(e,t){e=e||0,t=t||(0!==t?e:0),this.isEmpty()||(this.minX-=e,this.maxX+=e,this.minY-=t,this.maxY+=t)},_s.prototype.addFramePad=function addFramePad(e,t,n,a,l,f){e-=l,t-=f,n+=l,a+=f,this.minX=this.minX<e?this.minX:e,this.maxX=this.maxX>n?this.maxX:n,this.minY=this.minY<t?this.minY:t,this.maxY=this.maxY>a?this.maxY:a};var bs=function(e){function DisplayObject2(){e.call(this),this.tempDisplayObjectParent=null,this.transform=new ps,this.alpha=1,this.visible=!0,this.renderable=!0,this.parent=null,this.worldAlpha=1,this._lastSortedIndex=0,this._zIndex=0,this.filterArea=null,this.filters=null,this._enabledFilters=null,this._bounds=new _s,this._boundsID=0,this._lastBoundsID=-1,this._boundsRect=null,this._localBoundsRect=null,this._mask=null,this._destroyed=!1,this.isSprite=!1,this.isMask=!1}e&&(DisplayObject2.__proto__=e),DisplayObject2.prototype=Object.create(e&&e.prototype),DisplayObject2.prototype.constructor=DisplayObject2;var t={_tempDisplayObjectParent:{configurable:!0},x:{configurable:!0},y:{configurable:!0},worldTransform:{configurable:!0},localTransform:{configurable:!0},position:{configurable:!0},scale:{configurable:!0},pivot:{configurable:!0},skew:{configurable:!0},rotation:{configurable:!0},angle:{configurable:!0},zIndex:{configurable:!0},worldVisible:{configurable:!0},mask:{configurable:!0}};return DisplayObject2.mixin=function mixin(e){for(var t=Object.keys(e),n=0;n<t.length;++n){var a=t[n];Object.defineProperty(DisplayObject2.prototype,a,Object.getOwnPropertyDescriptor(e,a))}},t._tempDisplayObjectParent.get=function(){return null===this.tempDisplayObjectParent&&(this.tempDisplayObjectParent=new DisplayObject2),this.tempDisplayObjectParent},DisplayObject2.prototype.updateTransform=function updateTransform(){this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha},DisplayObject2.prototype.calculateBounds=function calculateBounds(){},DisplayObject2.prototype._recursivePostUpdateTransform=function _recursivePostUpdateTransform(){this.parent?(this.parent._recursivePostUpdateTransform(),this.transform.updateTransform(this.parent.transform)):this.transform.updateTransform(this._tempDisplayObjectParent.transform)},DisplayObject2.prototype.getBounds=function getBounds(e,t){return e||(this.parent?(this._recursivePostUpdateTransform(),this.updateTransform()):(this.parent=this._tempDisplayObjectParent,this.updateTransform(),this.parent=null)),this._boundsID!==this._lastBoundsID&&(this.calculateBounds(),this._lastBoundsID=this._boundsID),t||(this._boundsRect||(this._boundsRect=new hs),t=this._boundsRect),this._bounds.getRectangle(t)},DisplayObject2.prototype.getLocalBounds=function getLocalBounds(e){var t=this.transform,n=this.parent;this.parent=null,this.transform=this._tempDisplayObjectParent.transform,e||(this._localBoundsRect||(this._localBoundsRect=new hs),e=this._localBoundsRect);var a=this.getBounds(!1,e);return this.parent=n,this.transform=t,a},DisplayObject2.prototype.toGlobal=function toGlobal(e,t,n){return void 0===n&&(n=!1),n||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.apply(e,t)},DisplayObject2.prototype.toLocal=function toLocal(e,t,n,a){return t&&(e=t.toGlobal(e,n,a)),a||(this._recursivePostUpdateTransform(),this.parent?this.displayObjectUpdateTransform():(this.parent=this._tempDisplayObjectParent,this.displayObjectUpdateTransform(),this.parent=null)),this.worldTransform.applyInverse(e,n)},DisplayObject2.prototype.render=function render2(e){},DisplayObject2.prototype.setParent=function setParent(e){if(!e||!e.addChild)throw new Error("setParent: Argument must be a Container");return e.addChild(this),e},DisplayObject2.prototype.setTransform=function setTransform(e,t,n,a,l,f,p,h,m){return void 0===e&&(e=0),void 0===t&&(t=0),void 0===n&&(n=1),void 0===a&&(a=1),void 0===l&&(l=0),void 0===f&&(f=0),void 0===p&&(p=0),void 0===h&&(h=0),void 0===m&&(m=0),this.position.x=e,this.position.y=t,this.scale.x=n||1,this.scale.y=a||1,this.rotation=l,this.skew.x=f,this.skew.y=p,this.pivot.x=h,this.pivot.y=m,this},DisplayObject2.prototype.destroy=function destroy10(){this.parent&&this.parent.removeChild(this),this.removeAllListeners(),this.transform=null,this.parent=null,this._bounds=null,this._currentBounds=null,this._mask=null,this.filters=null,this.filterArea=null,this.hitArea=null,this.interactive=!1,this.interactiveChildren=!1,this._destroyed=!0},t.x.get=function(){return this.position.x},t.x.set=function(e){this.transform.position.x=e},t.y.get=function(){return this.position.y},t.y.set=function(e){this.transform.position.y=e},t.worldTransform.get=function(){return this.transform.worldTransform},t.localTransform.get=function(){return this.transform.localTransform},t.position.get=function(){return this.transform.position},t.position.set=function(e){this.transform.position.copyFrom(e)},t.scale.get=function(){return this.transform.scale},t.scale.set=function(e){this.transform.scale.copyFrom(e)},t.pivot.get=function(){return this.transform.pivot},t.pivot.set=function(e){this.transform.pivot.copyFrom(e)},t.skew.get=function(){return this.transform.skew},t.skew.set=function(e){this.transform.skew.copyFrom(e)},t.rotation.get=function(){return this.transform.rotation},t.rotation.set=function(e){this.transform.rotation=e},t.angle.get=function(){return this.transform.rotation*ts},t.angle.set=function(e){this.transform.rotation=e*ns},t.zIndex.get=function(){return this._zIndex},t.zIndex.set=function(e){this._zIndex=e,this.parent&&(this.parent.sortDirty=!0)},t.worldVisible.get=function(){var e=this;do{if(!e.visible)return!1;e=e.parent}while(e);return!0},t.mask.get=function(){return this._mask},t.mask.set=function(e){if(this._mask){var t=this._mask.maskObject||this._mask;t.renderable=!0,t.isMask=!1}if(this._mask=e,this._mask){var n=this._mask.maskObject||this._mask;n.renderable=!1,n.isMask=!0}},Object.defineProperties(DisplayObject2.prototype,t),DisplayObject2}(Gi);function sortChildren(e,t){return e.zIndex===t.zIndex?e._lastSortedIndex-t._lastSortedIndex:e.zIndex-t.zIndex}bs.prototype.displayObjectUpdateTransform=bs.prototype.updateTransform;var Cs,Ss,ks=function(e){function Container2(){e.call(this),this.children=[],this.sortableChildren=Vi.SORTABLE_CHILDREN,this.sortDirty=!1}e&&(Container2.__proto__=e),Container2.prototype=Object.create(e&&e.prototype),Container2.prototype.constructor=Container2;var t={width:{configurable:!0},height:{configurable:!0}};return Container2.prototype.onChildrenChange=function onChildrenChange(){},Container2.prototype.addChild=function addChild(e){var t=arguments,n=arguments.length;if(n>1)for(var a=0;a<n;a++)this.addChild(t[a]);else e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.push(e),this._boundsID++,this.onChildrenChange(this.children.length-1),this.emit("childAdded",e,this,this.children.length-1),e.emit("added",this);return e},Container2.prototype.addChildAt=function addChildAt(e,t){if(t<0||t>this.children.length)throw new Error(e+"addChildAt: The index "+t+" supplied is out of bounds "+this.children.length);return e.parent&&e.parent.removeChild(e),e.parent=this,this.sortDirty=!0,e.transform._parentID=-1,this.children.splice(t,0,e),this._boundsID++,this.onChildrenChange(t),e.emit("added",this),this.emit("childAdded",e,this,t),e},Container2.prototype.swapChildren=function swapChildren(e,t){if(e!==t){var n=this.getChildIndex(e),a=this.getChildIndex(t);this.children[n]=t,this.children[a]=e,this.onChildrenChange(n<a?n:a)}},Container2.prototype.getChildIndex=function getChildIndex(e){var t=this.children.indexOf(e);if(-1===t)throw new Error("The supplied DisplayObject must be a child of the caller");return t},Container2.prototype.setChildIndex=function setChildIndex(e,t){if(t<0||t>=this.children.length)throw new Error("The index "+t+" supplied is out of bounds "+this.children.length);var n=this.getChildIndex(e);removeItems(this.children,n,1),this.children.splice(t,0,e),this.onChildrenChange(t)},Container2.prototype.getChildAt=function getChildAt(e){if(e<0||e>=this.children.length)throw new Error("getChildAt: Index ("+e+") does not exist.");return this.children[e]},Container2.prototype.removeChild=function removeChild(e){var t=arguments,n=arguments.length;if(n>1)for(var a=0;a<n;a++)this.removeChild(t[a]);else{var l=this.children.indexOf(e);if(-1===l)return null;e.parent=null,e.transform._parentID=-1,removeItems(this.children,l,1),this._boundsID++,this.onChildrenChange(l),e.emit("removed",this),this.emit("childRemoved",e,this,l)}return e},Container2.prototype.removeChildAt=function removeChildAt(e){var t=this.getChildAt(e);return t.parent=null,t.transform._parentID=-1,removeItems(this.children,e,1),this._boundsID++,this.onChildrenChange(e),t.emit("removed",this),this.emit("childRemoved",t,this,e),t},Container2.prototype.removeChildren=function removeChildren(e,t){void 0===e&&(e=0);var n,a=e,l="number"==typeof t?t:this.children.length,f=l-a;if(f>0&&f<=l){n=this.children.splice(a,f);for(var p=0;p<n.length;++p)n[p].parent=null,n[p].transform&&(n[p].transform._parentID=-1);this._boundsID++,this.onChildrenChange(e);for(var h=0;h<n.length;++h)n[h].emit("removed",this),this.emit("childRemoved",n[h],this,h);return n}if(0===f&&0===this.children.length)return[];throw new RangeError("removeChildren: numeric values are outside the acceptable range.")},Container2.prototype.sortChildren=function sortChildren$1(){for(var e=!1,t=0,n=this.children.length;t<n;++t){var a=this.children[t];a._lastSortedIndex=t,e||0===a.zIndex||(e=!0)}e&&this.children.length>1&&this.children.sort(sortChildren),this.sortDirty=!1},Container2.prototype.updateTransform=function updateTransform(){this.sortableChildren&&this.sortDirty&&this.sortChildren(),this._boundsID++,this.transform.updateTransform(this.parent.transform),this.worldAlpha=this.alpha*this.parent.worldAlpha;for(var e=0,t=this.children.length;e<t;++e){var n=this.children[e];n.visible&&n.updateTransform()}},Container2.prototype.calculateBounds=function calculateBounds(){this._bounds.clear(),this._calculateBounds();for(var e=0;e<this.children.length;e++){var t=this.children[e];if(t.visible&&t.renderable)if(t.calculateBounds(),t._mask){var n=t._mask.maskObject||t._mask;n.calculateBounds(),this._bounds.addBoundsMask(t._bounds,n._bounds)}else t.filterArea?this._bounds.addBoundsArea(t._bounds,t.filterArea):this._bounds.addBounds(t._bounds)}this._lastBoundsID=this._boundsID},Container2.prototype._calculateBounds=function _calculateBounds(){},Container2.prototype.render=function render2(e){if(this.visible&&!(this.worldAlpha<=0)&&this.renderable)if(this._mask||this.filters&&this.filters.length)this.renderAdvanced(e);else{this._render(e);for(var t=0,n=this.children.length;t<n;++t)this.children[t].render(e)}},Container2.prototype.renderAdvanced=function renderAdvanced(e){e.batch.flush();var t=this.filters,n=this._mask;if(t){this._enabledFilters||(this._enabledFilters=[]),this._enabledFilters.length=0;for(var a=0;a<t.length;a++)t[a].enabled&&this._enabledFilters.push(t[a]);this._enabledFilters.length&&e.filter.push(this,this._enabledFilters)}n&&e.mask.push(this,this._mask),this._render(e);for(var l=0,f=this.children.length;l<f;l++)this.children[l].render(e);e.batch.flush(),n&&e.mask.pop(this,this._mask),t&&this._enabledFilters&&this._enabledFilters.length&&e.filter.pop()},Container2.prototype._render=function _render(e){},Container2.prototype.destroy=function destroy10(t){e.prototype.destroy.call(this),this.sortDirty=!1;var n="boolean"==typeof t?t:t&&t.children,a=this.removeChildren(0,this.children.length);if(n)for(var l=0;l<a.length;++l)a[l].destroy(t)},t.width.get=function(){return this.scale.x*this.getLocalBounds().width},t.width.set=function(e){var t=this.getLocalBounds().width;this.scale.x=0!==t?e/t:1,this._width=e},t.height.get=function(){return this.scale.y*this.getLocalBounds().height},t.height.set=function(e){var t=this.getLocalBounds().height;this.scale.y=0!==t?e/t:1,this._height=e},Object.defineProperties(Container2.prototype,t),Container2}(bs);ks.prototype.containerUpdateTransform=ks.prototype.updateTransform,
/*!
 * @pixi/ticker - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/ticker is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
Vi.TARGET_FPMS=.06,(Ss=Cs||(Cs={}))[Ss.INTERACTION=50]="INTERACTION",Ss[Ss.HIGH=25]="HIGH",Ss[Ss.NORMAL=0]="NORMAL",Ss[Ss.LOW=-25]="LOW",Ss[Ss.UTILITY=-50]="UTILITY";var ws=function(){function TickerListener2(e,t,n,a){void 0===t&&(t=null),void 0===n&&(n=0),void 0===a&&(a=!1),this.fn=e,this.context=t,this.priority=n,this.once=a,this.next=null,this.previous=null,this._destroyed=!1}return TickerListener2.prototype.match=function(e,t){return void 0===t&&(t=null),this.fn===e&&this.context===t},TickerListener2.prototype.emit=function(e){this.fn&&(this.context?this.fn.call(this.context,e):this.fn(e));var t=this.next;return this.once&&this.destroy(!0),this._destroyed&&(this.next=null),t},TickerListener2.prototype.connect=function(e){this.previous=e,e.next&&(e.next.previous=this),this.next=e.next,e.next=this},TickerListener2.prototype.destroy=function(e){void 0===e&&(e=!1),this._destroyed=!0,this.fn=null,this.context=null,this.previous&&(this.previous.next=this.next),this.next&&(this.next.previous=this.previous);var t=this.next;return this.next=e?null:t,this.previous=null,t},TickerListener2}(),Ts=function(){function Ticker2(){var e=this;this._head=new ws(null,null,1/0),this._requestId=null,this._maxElapsedMS=100,this._minElapsedMS=0,this.autoStart=!1,this.deltaTime=1,this.deltaMS=1/Vi.TARGET_FPMS,this.elapsedMS=1/Vi.TARGET_FPMS,this.lastTime=-1,this.speed=1,this.started=!1,this._protected=!1,this._lastFrame=-1,this._tick=function(t){e._requestId=null,e.started&&(e.update(t),e.started&&null===e._requestId&&e._head.next&&(e._requestId=requestAnimationFrame(e._tick)))}}return Ticker2.prototype._requestIfNeeded=function(){null===this._requestId&&this._head.next&&(this.lastTime=performance.now(),this._lastFrame=this.lastTime,this._requestId=requestAnimationFrame(this._tick))},Ticker2.prototype._cancelIfNeeded=function(){null!==this._requestId&&(cancelAnimationFrame(this._requestId),this._requestId=null)},Ticker2.prototype._startIfPossible=function(){this.started?this._requestIfNeeded():this.autoStart&&this.start()},Ticker2.prototype.add=function(e,t,n){return void 0===n&&(n=Cs.NORMAL),this._addListener(new ws(e,t,n))},Ticker2.prototype.addOnce=function(e,t,n){return void 0===n&&(n=Cs.NORMAL),this._addListener(new ws(e,t,n,!0))},Ticker2.prototype._addListener=function(e){var t=this._head.next,n=this._head;if(t){for(;t;){if(e.priority>t.priority){e.connect(n);break}n=t,t=t.next}e.previous||e.connect(n)}else e.connect(n);return this._startIfPossible(),this},Ticker2.prototype.remove=function(e,t){for(var n=this._head.next;n;)n=n.match(e,t)?n.destroy():n.next;return this._head.next||this._cancelIfNeeded(),this},Object.defineProperty(Ticker2.prototype,"count",{get:function(){if(!this._head)return 0;for(var e=0,t=this._head;t=t.next;)e++;return e},enumerable:!0,configurable:!0}),Ticker2.prototype.start=function(){this.started||(this.started=!0,this._requestIfNeeded())},Ticker2.prototype.stop=function(){this.started&&(this.started=!1,this._cancelIfNeeded())},Ticker2.prototype.destroy=function(){if(!this._protected){this.stop();for(var e=this._head.next;e;)e=e.destroy(!0);this._head.destroy(),this._head=null}},Ticker2.prototype.update=function(e){var t;if(void 0===e&&(e=performance.now()),e>this.lastTime){if((t=this.elapsedMS=e-this.lastTime)>this._maxElapsedMS&&(t=this._maxElapsedMS),t*=this.speed,this._minElapsedMS){var n=e-this._lastFrame|0;if(n<this._minElapsedMS)return;this._lastFrame=e-n%this._minElapsedMS}this.deltaMS=t,this.deltaTime=this.deltaMS*Vi.TARGET_FPMS;for(var a=this._head,l=a.next;l;)l=l.emit(this.deltaTime);a.next||this._cancelIfNeeded()}else this.deltaTime=this.deltaMS=this.elapsedMS=0;this.lastTime=e},Object.defineProperty(Ticker2.prototype,"FPS",{get:function(){return 1e3/this.elapsedMS},enumerable:!0,configurable:!0}),Object.defineProperty(Ticker2.prototype,"minFPS",{get:function(){return 1e3/this._maxElapsedMS},set:function(e){var t=Math.min(this.maxFPS,e),n=Math.min(Math.max(0,t)/1e3,Vi.TARGET_FPMS);this._maxElapsedMS=1/n},enumerable:!0,configurable:!0}),Object.defineProperty(Ticker2.prototype,"maxFPS",{get:function(){return this._minElapsedMS?Math.round(1e3/this._minElapsedMS):0},set:function(e){if(0===e)this._minElapsedMS=0;else{var t=Math.max(this.minFPS,e);this._minElapsedMS=1/(t/1e3)}},enumerable:!0,configurable:!0}),Object.defineProperty(Ticker2,"shared",{get:function(){if(!Ticker2._shared){var e=Ticker2._shared=new Ticker2;e.autoStart=!0,e._protected=!0}return Ticker2._shared},enumerable:!0,configurable:!0}),Object.defineProperty(Ticker2,"system",{get:function(){if(!Ticker2._system){var e=Ticker2._system=new Ticker2;e.autoStart=!0,e._protected=!0}return Ticker2._system},enumerable:!0,configurable:!0}),Ticker2}(),Ps=function(){function TickerPlugin2(){}return TickerPlugin2.init=function(e){var t=this;e=Object.assign({autoStart:!0,sharedTicker:!1},e),Object.defineProperty(this,"ticker",{set:function(e){this._ticker&&this._ticker.remove(this.render,this),this._ticker=e,e&&e.add(this.render,this,Cs.LOW)},get:function(){return this._ticker}}),this.stop=function(){t._ticker.stop()},this.start=function(){t._ticker.start()},this._ticker=null,this.ticker=e.sharedTicker?Ts.shared:new Ts,e.autoStart&&this.start()},TickerPlugin2.destroy=function(){if(this._ticker){var e=this._ticker;this.ticker=null,e.destroy()}},TickerPlugin2}(),Es=function(){function Runner2(e){this.items=[],this._name=e,this._aliasCount=0}return Runner2.prototype.emit=function(e,t,n,a,l,f,p,h){if(arguments.length>8)throw new Error("max arguments reached");var m=this,g=m.name,v=m.items;this._aliasCount++;for(var y=0,_=v.length;y<_;y++)v[y][g](e,t,n,a,l,f,p,h);return v===this.items&&this._aliasCount--,this},Runner2.prototype.ensureNonAliasedItems=function(){this._aliasCount>0&&this.items.length>1&&(this._aliasCount=0,this.items=this.items.slice(0))},Runner2.prototype.add=function(e){return e[this._name]&&(this.ensureNonAliasedItems(),this.remove(e),this.items.push(e)),this},Runner2.prototype.remove=function(e){var t=this.items.indexOf(e);return-1!==t&&(this.ensureNonAliasedItems(),this.items.splice(t,1)),this},Runner2.prototype.contains=function(e){return-1!==this.items.indexOf(e)},Runner2.prototype.removeAll=function(){return this.ensureNonAliasedItems(),this.items.length=0,this},Runner2.prototype.destroy=function(){this.removeAll(),this.items=null,this._name=null},Object.defineProperty(Runner2.prototype,"empty",{get:function(){return 0===this.items.length},enumerable:!0,configurable:!0}),Object.defineProperty(Runner2.prototype,"name",{get:function(){return this._name},enumerable:!0,configurable:!0}),Runner2}();Object.defineProperties(Es.prototype,{dispatch:{value:Es.prototype.emit},run:{value:Es.prototype.emit}});
/*!
 * @pixi/core - v5.2.1
 * Compiled Tue, 28 Jan 2020 23:33:11 UTC
 *
 * @pixi/core is licensed under the MIT License.
 * http://www.opensource.org/licenses/mit-license
 */
var As=function Resource2(e,t){void 0===e&&(e=0),void 0===t&&(t=0),this._width=e,this._height=t,this.destroyed=!1,this.internal=!1,this.onResize=new Es("setRealSize",2),this.onUpdate=new Es("update"),this.onError=new Es("onError",1)},Ms={valid:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};As.prototype.bind=function bind(e){this.onResize.add(e),this.onUpdate.add(e),this.onError.add(e),(this._width||this._height)&&this.onResize.run(this._width,this._height)},As.prototype.unbind=function unbind(e){this.onResize.remove(e),this.onUpdate.remove(e),this.onError.remove(e)},As.prototype.resize=function resize(e,t){e===this._width&&t===this._height||(this._width=e,this._height=t,this.onResize.run(e,t))},Ms.valid.get=function(){return!!this._width&&!!this._height},As.prototype.update=function update(){this.destroyed||this.onUpdate.run()},As.prototype.load=function load2(){return Promise.resolve()},Ms.width.get=function(){return this._width},Ms.height.get=function(){return this._height},As.prototype.upload=function upload(e,t,n){return!1},As.prototype.style=function style2(e,t,n){return!1},As.prototype.dispose=function dispose(){},As.prototype.destroy=function destroy(){this.destroyed||(this.destroyed=!0,this.dispose(),this.onError.removeAll(),this.onError=null,this.onResize.removeAll(),this.onResize=null,this.onUpdate.removeAll(),this.onUpdate=null)},Object.defineProperties(As.prototype,Ms);var xs=function(e){function BaseImageResource2(t){var n=t.naturalWidth||t.videoWidth||t.width,a=t.naturalHeight||t.videoHeight||t.height;e.call(this,n,a),this.source=t,this.noSubImage=!1}return e&&(BaseImageResource2.__proto__=e),BaseImageResource2.prototype=Object.create(e&&e.prototype),BaseImageResource2.prototype.constructor=BaseImageResource2,BaseImageResource2.crossOrigin=function crossOrigin(e,t,n){void 0===n&&0!==t.indexOf("data:")?e.crossOrigin=function determineCrossOrigin(e,t){if(void 0===t&&(t=window.location),0===e.indexOf("data:"))return"";t=t||window.location,qa||(qa=document.createElement("a")),qa.href=e;var n=Yi(qa.href),a=!n.port&&""===t.port||n.port===t.port;return n.hostname===t.hostname&&a&&n.protocol===t.protocol?"":"anonymous"}(t):!1!==n&&(e.crossOrigin="string"==typeof n?n:"anonymous")},BaseImageResource2.prototype.upload=function upload2(e,t,n,a){var l=e.gl,f=t.realWidth,p=t.realHeight;return a=a||this.source,l.pixelStorei(l.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===_a.UNPACK),this.noSubImage||t.target!==l.TEXTURE_2D||n.width!==f||n.height!==p?(n.width=f,n.height=p,l.texImage2D(t.target,0,t.format,t.format,t.type,a)):l.texSubImage2D(l.TEXTURE_2D,0,0,0,t.format,t.type,a),!0},BaseImageResource2.prototype.update=function update5(){if(!this.destroyed){var t=this.source.naturalWidth||this.source.videoWidth||this.source.width,n=this.source.naturalHeight||this.source.videoHeight||this.source.height;this.resize(t,n),e.prototype.update.call(this)}},BaseImageResource2.prototype.dispose=function dispose5(){this.source=null},BaseImageResource2}(As),Os=function(e){function ImageResource2(t,n){if(n=n||{},!(t instanceof HTMLImageElement)){var a=new Image;e.crossOrigin(a,t,n.crossorigin),a.src=t,t=a}e.call(this,t),!t.complete&&this._width&&this._height&&(this._width=0,this._height=0),this.url=t.src,this._process=null,this.preserveBitmap=!1,this.createBitmap=(void 0!==n.createBitmap?n.createBitmap:Vi.CREATE_IMAGE_BITMAP)&&!!window.createImageBitmap,this.alphaMode="number"==typeof n.alphaMode?n.alphaMode:null,void 0!==n.premultiplyAlpha&&(this.premultiplyAlpha=n.premultiplyAlpha),this.bitmap=null,this._load=null,!1!==n.autoLoad&&this.load()}return e&&(ImageResource2.__proto__=e),ImageResource2.prototype=Object.create(e&&e.prototype),ImageResource2.prototype.constructor=ImageResource2,ImageResource2.prototype.load=function load3(e){var t=this;return void 0!==e&&(this.createBitmap=e),this._load||(this._load=new Promise((function(e){t.url=t.source.src;var n=t.source,completed=function(){t.destroyed||(n.onload=null,n.onerror=null,t.resize(n.width,n.height),t._load=null,t.createBitmap?e(t.process()):e(t))};n.complete&&n.src?completed():(n.onload=completed,n.onerror=function(e){return t.onError.run(e)})}))),this._load},ImageResource2.prototype.process=function process(){var e=this;return null!==this._process?this._process:null===this.bitmap&&window.createImageBitmap?(this._process=window.createImageBitmap(this.source,0,0,this.source.width,this.source.height,{premultiplyAlpha:this.premultiplyAlpha===_a.UNPACK?"premultiply":"none"}).then((function(t){return e.destroyed?Promise.reject():(e.bitmap=t,e.update(),e._process=null,Promise.resolve(e))})),this._process):Promise.resolve(this)},ImageResource2.prototype.upload=function upload2(t,n,a){if("number"==typeof this.alphaMode&&(n.alphaMode=this.alphaMode),!this.createBitmap)return e.prototype.upload.call(this,t,n,a);if(!this.bitmap&&(this.process(),!this.bitmap))return!1;if(e.prototype.upload.call(this,t,n,a,this.bitmap),!this.preserveBitmap){var l=!0;for(var f in n._glTextures){var p=n._glTextures[f];if(p!==a&&p.dirtyId!==n.dirtyId){l=!1;break}}l&&(this.bitmap.close&&this.bitmap.close(),this.bitmap=null)}return!0},ImageResource2.prototype.dispose=function dispose5(){this.source.onload=null,this.source.onerror=null,e.prototype.dispose.call(this),this.bitmap&&(this.bitmap.close(),this.bitmap=null),this._process=null,this._load=null},ImageResource2}(xs),Rs=[];function autoDetectResource(e,t){if(!e)return null;var n="";if("string"==typeof e){var a=/\.(\w{3,4})(?:$|\?|#)/i.exec(e);a&&(n=a[1].toLowerCase())}for(var l=Rs.length-1;l>=0;--l){var f=Rs[l];if(f.test&&f.test(e,n))return new f(e,t)}return new Os(e,t)}var Is=function(e){function BufferResource2(t,n){var a=n||{},l=a.width,f=a.height;if(!l||!f)throw new Error("BufferResource width or height invalid");e.call(this,l,f),this.data=t}return e&&(BufferResource2.__proto__=e),BufferResource2.prototype=Object.create(e&&e.prototype),BufferResource2.prototype.constructor=BufferResource2,BufferResource2.prototype.upload=function upload2(e,t,n){var a=e.gl;return a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===_a.UNPACK),n.width===t.width&&n.height===t.height?a.texSubImage2D(t.target,0,0,0,t.width,t.height,t.format,t.type,this.data):(n.width=t.width,n.height=t.height,a.texImage2D(t.target,0,n.internalFormat,t.width,t.height,0,t.format,n.type,this.data)),!0},BufferResource2.prototype.dispose=function dispose5(){this.data=null},BufferResource2.test=function test(e){return e instanceof Float32Array||e instanceof Uint8Array||e instanceof Uint32Array},BufferResource2}(As),Ls={scaleMode:pa.NEAREST,format:sa.RGBA,alphaMode:_a.NPM},Ns=function(e){function BaseTexture2(t,n){void 0===t&&(t=null),void 0===n&&(n=null),e.call(this);var a=(n=n||{}).alphaMode,l=n.mipmap,f=n.anisotropicLevel,p=n.scaleMode,h=n.width,m=n.height,g=n.wrapMode,v=n.format,y=n.type,_=n.target,b=n.resolution,C=n.resourceOptions;!t||t instanceof As||((t=autoDetectResource(t,C)).internal=!0),this.width=h||0,this.height=m||0,this.resolution=b||Vi.RESOLUTION,this.mipmap=void 0!==l?l:Vi.MIPMAP_TEXTURES,this.anisotropicLevel=void 0!==f?f:Vi.ANISOTROPIC_LEVEL,this.wrapMode=g||Vi.WRAP_MODE,this.scaleMode=void 0!==p?p:Vi.SCALE_MODE,this.format=v||sa.RGBA,this.type=y||da.UNSIGNED_BYTE,this.target=_||la.TEXTURE_2D,this.alphaMode=void 0!==a?a:_a.UNPACK,void 0!==n.premultiplyAlpha&&(this.premultiplyAlpha=n.premultiplyAlpha),this.uid=uid(),this.touched=0,this.isPowerOfTwo=!1,this._refreshPOT(),this._glTextures={},this.dirtyId=0,this.dirtyStyleId=0,this.cacheId=null,this.valid=h>0&&m>0,this.textureCacheIds=[],this.destroyed=!1,this.resource=null,this._batchEnabled=0,this._batchLocation=0,this.setResource(t)}e&&(BaseTexture2.__proto__=e),BaseTexture2.prototype=Object.create(e&&e.prototype),BaseTexture2.prototype.constructor=BaseTexture2;var t={realWidth:{configurable:!0},realHeight:{configurable:!0}};return t.realWidth.get=function(){return Math.ceil(this.width*this.resolution-1e-4)},t.realHeight.get=function(){return Math.ceil(this.height*this.resolution-1e-4)},BaseTexture2.prototype.setStyle=function setStyle(e,t){var n;return void 0!==e&&e!==this.scaleMode&&(this.scaleMode=e,n=!0),void 0!==t&&t!==this.mipmap&&(this.mipmap=t,n=!0),n&&this.dirtyStyleId++,this},BaseTexture2.prototype.setSize=function setSize(e,t,n){return this.resolution=n||this.resolution,this.width=e,this.height=t,this._refreshPOT(),this.update(),this},BaseTexture2.prototype.setRealSize=function setRealSize(e,t,n){return this.resolution=n||this.resolution,this.width=e/this.resolution,this.height=t/this.resolution,this._refreshPOT(),this.update(),this},BaseTexture2.prototype._refreshPOT=function _refreshPOT(){this.isPowerOfTwo=isPow2(this.realWidth)&&isPow2(this.realHeight)},BaseTexture2.prototype.setResolution=function setResolution(e){var t=this.resolution;return t===e||(this.resolution=e,this.valid&&(this.width=this.width*t/e,this.height=this.height*t/e,this.emit("update",this)),this._refreshPOT()),this},BaseTexture2.prototype.setResource=function setResource(e){if(this.resource===e)return this;if(this.resource)throw new Error("Resource can be set only once");return e.bind(this),this.resource=e,this},BaseTexture2.prototype.update=function update5(){this.valid?(this.dirtyId++,this.dirtyStyleId++,this.emit("update",this)):this.width>0&&this.height>0&&(this.valid=!0,this.emit("loaded",this),this.emit("update",this))},BaseTexture2.prototype.onError=function onError(e){this.emit("error",this,e)},BaseTexture2.prototype.destroy=function destroy10(){this.resource&&(this.resource.unbind(this),this.resource.internal&&this.resource.destroy(),this.resource=null),this.cacheId&&(delete Ka[this.cacheId],delete za[this.cacheId],this.cacheId=null),this.dispose(),BaseTexture2.removeFromCache(this),this.textureCacheIds=null,this.destroyed=!0},BaseTexture2.prototype.dispose=function dispose5(){this.emit("dispose",this)},BaseTexture2.from=function from6(e,t,n){void 0===n&&(n=Vi.STRICT_TEXTURE_CACHE);var a="string"==typeof e,l=null;a?l=e:(e._pixiId||(e._pixiId="pixiid_"+uid()),l=e._pixiId);var f=Ka[l];if(a&&n&&!f)throw new Error('The cacheId "'+l+'" does not exist in BaseTextureCache.');return f||((f=new BaseTexture2(e,t)).cacheId=l,BaseTexture2.addToCache(f,l)),f},BaseTexture2.fromBuffer=function fromBuffer(e,t,n,a){e=e||new Float32Array(t*n*4);var l=new Is(e,{width:t,height:n}),f=e instanceof Float32Array?da.FLOAT:da.UNSIGNED_BYTE;return new BaseTexture2(l,Object.assign(Ls,a||{width:t,height:n,type:f}))},BaseTexture2.addToCache=function addToCache(e,t){t&&(-1===e.textureCacheIds.indexOf(t)&&e.textureCacheIds.push(t),Ka[t]&&console.warn("BaseTexture added to the cache with an id ["+t+"] that already had an entry"),Ka[t]=e)},BaseTexture2.removeFromCache=function removeFromCache(e){if("string"==typeof e){var t=Ka[e];if(t){var n=t.textureCacheIds.indexOf(e);return n>-1&&t.textureCacheIds.splice(n,1),delete Ka[e],t}}else if(e&&e.textureCacheIds){for(var a=0;a<e.textureCacheIds.length;++a)delete Ka[e.textureCacheIds[a]];return e.textureCacheIds.length=0,e}return null},Object.defineProperties(BaseTexture2.prototype,t),BaseTexture2}(Gi);Ns._globalBatch=0;var Ds=function(e){function ArrayResource2(t,n){var a;n=n||{};var l=t;Array.isArray(t)&&(a=t,l=t.length),e.call(this,n.width,n.height),this.items=[],this.itemDirtyIds=[];for(var f=0;f<l;f++){var p=new Ns;this.items.push(p),this.itemDirtyIds.push(-1)}if(this.length=l,this._load=null,a)for(var h=0;h<l;h++)this.addResourceAt(autoDetectResource(a[h],n),h)}return e&&(ArrayResource2.__proto__=e),ArrayResource2.prototype=Object.create(e&&e.prototype),ArrayResource2.prototype.constructor=ArrayResource2,ArrayResource2.prototype.dispose=function dispose5(){for(var e=0,t=this.length;e<t;e++)this.items[e].destroy();this.items=null,this.itemDirtyIds=null,this._load=null},ArrayResource2.prototype.addResourceAt=function addResourceAt(e,t){if(!this.items[t])throw new Error("Index "+t+" is out of bounds");return e.valid&&!this.valid&&this.resize(e.width,e.height),this.items[t].setResource(e),this},ArrayResource2.prototype.bind=function bind2(t){e.prototype.bind.call(this,t),t.target=la.TEXTURE_2D_ARRAY;for(var n=0;n<this.length;n++)this.items[n].on("update",t.update,t)},ArrayResource2.prototype.unbind=function unbind2(t){e.prototype.unbind.call(this,t);for(var n=0;n<this.length;n++)this.items[n].off("update",t.update,t)},ArrayResource2.prototype.load=function load3(){var e=this;if(this._load)return this._load;var t=this.items.map((function(e){return e.resource})),n=t.map((function(e){return e.load()}));return this._load=Promise.all(n).then((function(){var n=t[0],a=n.width,l=n.height;return e.resize(a,l),Promise.resolve(e)})),this._load},ArrayResource2.prototype.upload=function upload2(e,t,n){var a=this,l=a.length,f=a.itemDirtyIds,p=a.items,h=e.gl;n.dirtyId<0&&h.texImage3D(h.TEXTURE_2D_ARRAY,0,t.format,this._width,this._height,l,0,t.format,t.type,null);for(var m=0;m<l;m++){var g=p[m];f[m]<g.dirtyId&&(f[m]=g.dirtyId,g.valid&&h.texSubImage3D(h.TEXTURE_2D_ARRAY,0,0,0,m,g.resource.width,g.resource.height,1,t.format,t.type,g.resource.source))}return!0},ArrayResource2}(As),Bs=function(e){function CanvasResource2(){e.apply(this,arguments)}return e&&(CanvasResource2.__proto__=e),CanvasResource2.prototype=Object.create(e&&e.prototype),CanvasResource2.prototype.constructor=CanvasResource2,CanvasResource2.test=function test(e){var t=window.OffscreenCanvas;return!!(t&&e instanceof t)||e instanceof HTMLCanvasElement},CanvasResource2}(xs),Fs=function(e){function CubeResource2(t,n){if(n=n||{},e.call(this,t,n),this.length!==CubeResource2.SIDES)throw new Error("Invalid length. Got "+this.length+", expected 6");for(var a=0;a<CubeResource2.SIDES;a++)this.items[a].target=la.TEXTURE_CUBE_MAP_POSITIVE_X+a;!1!==n.autoLoad&&this.load()}return e&&(CubeResource2.__proto__=e),CubeResource2.prototype=Object.create(e&&e.prototype),CubeResource2.prototype.constructor=CubeResource2,CubeResource2.prototype.bind=function bind2(t){e.prototype.bind.call(this,t),t.target=la.TEXTURE_CUBE_MAP},CubeResource2.prototype.upload=function upload2(e,t,n){for(var a=this.itemDirtyIds,l=0;l<CubeResource2.SIDES;l++){var f=this.items[l];a[l]<f.dirtyId&&(a[l]=f.dirtyId,f.valid&&f.resource.upload(e,f,n))}return!0},CubeResource2}(Ds);Fs.SIDES=6;var js=function(e){function SVGResource2(t,n){n=n||{},e.call(this,document.createElement("canvas")),this._width=0,this._height=0,this.svg=t,this.scale=n.scale||1,this._overrideWidth=n.width,this._overrideHeight=n.height,this._resolve=null,this._crossorigin=n.crossorigin,this._load=null,!1!==n.autoLoad&&this.load()}return e&&(SVGResource2.__proto__=e),SVGResource2.prototype=Object.create(e&&e.prototype),SVGResource2.prototype.constructor=SVGResource2,SVGResource2.prototype.load=function load3(){var e=this;return this._load||(this._load=new Promise((function(t){if(e._resolve=function(){e.resize(e.source.width,e.source.height),t(e)},/^\<svg/.test(e.svg.trim())){if(!btoa)throw new Error("Your browser doesn't support base64 conversions.");e.svg="data:image/svg+xml;base64,"+btoa(unescape(encodeURIComponent(e.svg)))}e._loadSvg()}))),this._load},SVGResource2.prototype._loadSvg=function _loadSvg(){var t=this,n=new Image;e.crossOrigin(n,this.svg,this._crossorigin),n.src=this.svg,n.onerror=function(e){n.onerror=null,t.onError.run(e)},n.onload=function(){var e=n.width,a=n.height;if(!e||!a)throw new Error("The SVG image must have width and height defined (in pixels), canvas API needs them.");var l=e*t.scale,f=a*t.scale;(t._overrideWidth||t._overrideHeight)&&(l=t._overrideWidth||t._overrideHeight/a*e,f=t._overrideHeight||t._overrideWidth/e*a),l=Math.round(l),f=Math.round(f);var p=t.source;p.width=l,p.height=f,p._pixiId="canvas_"+uid(),p.getContext("2d").drawImage(n,0,0,e,a,0,0,l,f),t._resolve(),t._resolve=null}},SVGResource2.getSize=function getSize2(e){var t=SVGResource2.SVG_SIZE.exec(e),n={};return t&&(n[t[1]]=Math.round(parseFloat(t[3])),n[t[5]]=Math.round(parseFloat(t[7]))),n},SVGResource2.prototype.dispose=function dispose5(){e.prototype.dispose.call(this),this._resolve=null,this._crossorigin=null},SVGResource2.test=function test(e,t){return"svg"===t||"string"==typeof e&&0===e.indexOf("data:image/svg+xml;base64")||"string"==typeof e&&0===e.indexOf("<svg")},SVGResource2}(xs);js.SVG_SIZE=/<svg[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*(?:\s(width|height)=('|")(\d*(?:\.\d+)?)(?:px)?('|"))[^>]*>/i;var $s=function(e){function VideoResource2(t,n){if(n=n||{},!(t instanceof HTMLVideoElement)){var a=document.createElement("video");a.setAttribute("preload","auto"),a.setAttribute("webkit-playsinline",""),a.setAttribute("playsinline",""),"string"==typeof t&&(t=[t]),e.crossOrigin(a,t[0].src||t[0],n.crossorigin);for(var l=0;l<t.length;++l){var f=document.createElement("source"),p=t[l],h=p.src,m=p.mime,g=(h=h||t[l]).split("?").shift().toLowerCase(),v=g.substr(g.lastIndexOf(".")+1);m=m||"video/"+v,f.src=h,f.type=m,a.appendChild(f)}t=a}e.call(this,t),this.noSubImage=!0,this._autoUpdate=!0,this._isAutoUpdating=!1,this._updateFPS=n.updateFPS||0,this._msToNextUpdate=0,this.autoPlay=!1!==n.autoPlay,this._load=null,this._resolve=null,this._onCanPlay=this._onCanPlay.bind(this),this._onError=this._onError.bind(this),!1!==n.autoLoad&&this.load()}e&&(VideoResource2.__proto__=e),VideoResource2.prototype=Object.create(e&&e.prototype),VideoResource2.prototype.constructor=VideoResource2;var t={autoUpdate:{configurable:!0},updateFPS:{configurable:!0}};return VideoResource2.prototype.update=function update5(t){if(void 0===t&&(t=0),!this.destroyed){var n=Ts.shared.elapsedMS*this.source.playbackRate;this._msToNextUpdate=Math.floor(this._msToNextUpdate-n),(!this._updateFPS||this._msToNextUpdate<=0)&&(e.prototype.update.call(this,t),this._msToNextUpdate=this._updateFPS?Math.floor(1e3/this._updateFPS):0)}},VideoResource2.prototype.load=function load3(){var e=this;if(this._load)return this._load;var t=this.source;return(t.readyState===t.HAVE_ENOUGH_DATA||t.readyState===t.HAVE_FUTURE_DATA)&&t.width&&t.height&&(t.complete=!0),t.addEventListener("play",this._onPlayStart.bind(this)),t.addEventListener("pause",this._onPlayStop.bind(this)),this._isSourceReady()?this._onCanPlay():(t.addEventListener("canplay",this._onCanPlay),t.addEventListener("canplaythrough",this._onCanPlay),t.addEventListener("error",this._onError,!0)),this._load=new Promise((function(n){e.valid?n(e):(e._resolve=n,t.load())})),this._load},VideoResource2.prototype._onError=function _onError(){this.source.removeEventListener("error",this._onError,!0),this.onError.run(event)},VideoResource2.prototype._isSourcePlaying=function _isSourcePlaying(){var e=this.source;return e.currentTime>0&&!1===e.paused&&!1===e.ended&&e.readyState>2},VideoResource2.prototype._isSourceReady=function _isSourceReady(){return 3===this.source.readyState||4===this.source.readyState},VideoResource2.prototype._onPlayStart=function _onPlayStart(){this.valid||this._onCanPlay(),!this._isAutoUpdating&&this.autoUpdate&&(Ts.shared.add(this.update,this),this._isAutoUpdating=!0)},VideoResource2.prototype._onPlayStop=function _onPlayStop(){this._isAutoUpdating&&(Ts.shared.remove(this.update,this),this._isAutoUpdating=!1)},VideoResource2.prototype._onCanPlay=function _onCanPlay(){var e=this.source;e.removeEventListener("canplay",this._onCanPlay),e.removeEventListener("canplaythrough",this._onCanPlay);var t=this.valid;this.resize(e.videoWidth,e.videoHeight),!t&&this._resolve&&(this._resolve(this),this._resolve=null),this._isSourcePlaying()?this._onPlayStart():this.autoPlay&&e.play()},VideoResource2.prototype.dispose=function dispose5(){this._isAutoUpdating&&Ts.shared.remove(this.update,this),this.source&&(this.source.removeEventListener("error",this._onError,!0),this.source.pause(),this.source.src="",this.source.load()),e.prototype.dispose.call(this)},t.autoUpdate.get=function(){return this._autoUpdate},t.autoUpdate.set=function(e){e!==this._autoUpdate&&(this._autoUpdate=e,!this._autoUpdate&&this._isAutoUpdating?(Ts.shared.remove(this.update,this),this._isAutoUpdating=!1):this._autoUpdate&&!this._isAutoUpdating&&(Ts.shared.add(this.update,this),this._isAutoUpdating=!0))},t.updateFPS.get=function(){return this._updateFPS},t.updateFPS.set=function(e){e!==this._updateFPS&&(this._updateFPS=e)},VideoResource2.test=function test(e,t){return e instanceof HTMLVideoElement||VideoResource2.TYPES.indexOf(t)>-1},Object.defineProperties(VideoResource2.prototype,t),VideoResource2}(xs);$s.TYPES=["mp4","m4v","webm","ogg","ogv","h264","avi","mov"];var Hs=function(e){function ImageBitmapResource2(){e.apply(this,arguments)}return e&&(ImageBitmapResource2.__proto__=e),ImageBitmapResource2.prototype=Object.create(e&&e.prototype),ImageBitmapResource2.prototype.constructor=ImageBitmapResource2,ImageBitmapResource2.test=function test(e){return!!window.createImageBitmap&&e instanceof ImageBitmap},ImageBitmapResource2}(xs);Rs.push(Os,Hs,Bs,$s,js,Is,Fs,Ds);var Vs=function System2(e){this.renderer=e};Vs.prototype.destroy=function destroy2(){this.renderer=null};var Us=function(e){function DepthResource2(){e.apply(this,arguments)}return e&&(DepthResource2.__proto__=e),DepthResource2.prototype=Object.create(e&&e.prototype),DepthResource2.prototype.constructor=DepthResource2,DepthResource2.prototype.upload=function upload2(e,t,n){var a=e.gl;return a.pixelStorei(a.UNPACK_PREMULTIPLY_ALPHA_WEBGL,t.alphaMode===_a.UNPACK),n.width===t.width&&n.height===t.height?a.texSubImage2D(t.target,0,0,0,t.width,t.height,t.format,t.type,this.data):(n.width=t.width,n.height=t.height,a.texImage2D(t.target,0,a.DEPTH_COMPONENT16,t.width,t.height,0,t.format,t.type,this.data)),!0},DepthResource2}(Is),Gs=function Framebuffer2(e,t){this.width=Math.ceil(e||100),this.height=Math.ceil(t||100),this.stencil=!1,this.depth=!1,this.dirtyId=0,this.dirtyFormat=0,this.dirtySize=0,this.depthTexture=null,this.colorTextures=[],this.glFramebuffers={},this.disposeRunner=new Es("disposeFramebuffer",2)},qs={colorTexture:{configurable:!0}};qs.colorTexture.get=function(){return this.colorTextures[0]},Gs.prototype.addColorTexture=function addColorTexture(e,t){return void 0===e&&(e=0),this.colorTextures[e]=t||new Ns(null,{scaleMode:0,resolution:1,mipmap:!1,width:this.width,height:this.height}),this.dirtyId++,this.dirtyFormat++,this},Gs.prototype.addDepthTexture=function addDepthTexture(e){return this.depthTexture=e||new Ns(new Us(null,{width:this.width,height:this.height}),{scaleMode:0,resolution:1,width:this.width,height:this.height,mipmap:!1,format:sa.DEPTH_COMPONENT,type:da.UNSIGNED_SHORT}),this.dirtyId++,this.dirtyFormat++,this},Gs.prototype.enableDepth=function enableDepth(){return this.depth=!0,this.dirtyId++,this.dirtyFormat++,this},Gs.prototype.enableStencil=function enableStencil(){return this.stencil=!0,this.dirtyId++,this.dirtyFormat++,this},Gs.prototype.resize=function resize2(e,t){if(e=Math.ceil(e),t=Math.ceil(t),e!==this.width||t!==this.height){this.width=e,this.height=t,this.dirtyId++,this.dirtySize++;for(var n=0;n<this.colorTextures.length;n++){var a=this.colorTextures[n],l=a.resolution;a.setSize(e/l,t/l)}if(this.depthTexture){var f=this.depthTexture.resolution;this.depthTexture.setSize(e/f,t/f)}}},Gs.prototype.dispose=function dispose2(){this.disposeRunner.run(this,!1)},Object.defineProperties(Gs.prototype,qs);var Ws=function(e){function BaseRenderTexture2(t){if("number"==typeof t){var n=arguments[0],a=arguments[1],l=arguments[2],f=arguments[3];t={width:n,height:a,scaleMode:l,resolution:f}}e.call(this,null,t);var p=t||{},h=p.width,m=p.height;this.mipmap=!1,this.width=Math.ceil(h)||100,this.height=Math.ceil(m)||100,this.valid=!0,this._canvasRenderTarget=null,this.clearColor=[0,0,0,0],this.framebuffer=new Gs(this.width*this.resolution,this.height*this.resolution).addColorTexture(0,this),this.maskStack=[],this.filterStack=[{}]}return e&&(BaseRenderTexture2.__proto__=e),BaseRenderTexture2.prototype=Object.create(e&&e.prototype),BaseRenderTexture2.prototype.constructor=BaseRenderTexture2,BaseRenderTexture2.prototype.resize=function resize3(e,t){e=Math.ceil(e),t=Math.ceil(t),this.framebuffer.resize(e*this.resolution,t*this.resolution)},BaseRenderTexture2.prototype.dispose=function dispose5(){this.framebuffer.dispose(),e.prototype.dispose.call(this)},BaseRenderTexture2.prototype.destroy=function destroy10(){e.prototype.destroy.call(this,!0),this.framebuffer=null},BaseRenderTexture2}(Ns),zs=function TextureUvs2(){this.x0=0,this.y0=0,this.x1=1,this.y1=0,this.x2=1,this.y2=1,this.x3=0,this.y3=1,this.uvsFloat32=new Float32Array(8)};zs.prototype.set=function set2(e,t,n){var a=t.width,l=t.height;if(n){var f=e.width/2/a,p=e.height/2/l,h=e.x/a+f,m=e.y/l+p;n=fs.add(n,fs.NW),this.x0=h+f*fs.uX(n),this.y0=m+p*fs.uY(n),n=fs.add(n,2),this.x1=h+f*fs.uX(n),this.y1=m+p*fs.uY(n),n=fs.add(n,2),this.x2=h+f*fs.uX(n),this.y2=m+p*fs.uY(n),n=fs.add(n,2),this.x3=h+f*fs.uX(n),this.y3=m+p*fs.uY(n)}else this.x0=e.x/a,this.y0=e.y/l,this.x1=(e.x+e.width)/a,this.y1=e.y/l,this.x2=(e.x+e.width)/a,this.y2=(e.y+e.height)/l,this.x3=e.x/a,this.y3=(e.y+e.height)/l;this.uvsFloat32[0]=this.x0,this.uvsFloat32[1]=this.y0,this.uvsFloat32[2]=this.x1,this.uvsFloat32[3]=this.y1,this.uvsFloat32[4]=this.x2,this.uvsFloat32[5]=this.y2,this.uvsFloat32[6]=this.x3,this.uvsFloat32[7]=this.y3};var Ks=new zs,Zs=function(e){function Texture2(t,n,a,l,f,p){if(e.call(this),this.noFrame=!1,n||(this.noFrame=!0,n=new hs(0,0,1,1)),t instanceof Texture2&&(t=t.baseTexture),this.baseTexture=t,this._frame=n,this.trim=l,this.valid=!1,this.requiresUpdate=!1,this._uvs=Ks,this.uvMatrix=null,this.orig=a||n,this._rotate=Number(f||0),!0===f)this._rotate=2;else if(this._rotate%2!=0)throw new Error("attempt to use diamond-shaped UVs. If you are sure, set rotation manually");this.defaultAnchor=p?new Ya(p.x,p.y):new Ya(0,0),this._updateID=0,this.textureCacheIds=[],t.valid?this.noFrame?t.valid&&this.onBaseTextureUpdated(t):this.frame=n:t.once("loaded",this.onBaseTextureUpdated,this),this.noFrame&&t.on("update",this.onBaseTextureUpdated,this)}e&&(Texture2.__proto__=e),Texture2.prototype=Object.create(e&&e.prototype),Texture2.prototype.constructor=Texture2;var t={resolution:{configurable:!0},frame:{configurable:!0},rotate:{configurable:!0},width:{configurable:!0},height:{configurable:!0}};return Texture2.prototype.update=function update5(){this.baseTexture.resource&&this.baseTexture.resource.update()},Texture2.prototype.onBaseTextureUpdated=function onBaseTextureUpdated(e){if(this.noFrame){if(!this.baseTexture.valid)return;this._frame.width=e.width,this._frame.height=e.height,this.valid=!0,this.updateUvs()}else this.frame=this._frame;this.emit("update",this)},Texture2.prototype.destroy=function destroy10(e){if(this.baseTexture){if(e){var t=this.baseTexture.resource;t&&za[t.url]&&Texture2.removeFromCache(t.url),this.baseTexture.destroy()}this.baseTexture.off("update",this.onBaseTextureUpdated,this),this.baseTexture=null}this._frame=null,this._uvs=null,this.trim=null,this.orig=null,this.valid=!1,Texture2.removeFromCache(this),this.textureCacheIds=null},Texture2.prototype.clone=function clone2(){return new Texture2(this.baseTexture,this.frame,this.orig,this.trim,this.rotate,this.defaultAnchor)},Texture2.prototype.updateUvs=function updateUvs(){this._uvs===Ks&&(this._uvs=new zs),this._uvs.set(this._frame,this.baseTexture,this.rotate),this._updateID++},Texture2.from=function from6(e,t,n){void 0===t&&(t={}),void 0===n&&(n=Vi.STRICT_TEXTURE_CACHE);var a="string"==typeof e,l=null;a?l=e:(e._pixiId||(e._pixiId="pixiid_"+uid()),l=e._pixiId);var f=za[l];if(a&&n&&!f)throw new Error('The cacheId "'+l+'" does not exist in TextureCache.');return f||(t.resolution||(t.resolution=getResolutionOfUrl(e)),(f=new Texture2(new Ns(e,t))).baseTexture.cacheId=l,Ns.addToCache(f.baseTexture,l),Texture2.addToCache(f,l)),f},Texture2.fromBuffer=function fromBuffer(e,t,n,a){return new Texture2(Ns.fromBuffer(e,t,n,a))},Texture2.fromLoader=function fromLoader(e,t,n){var a=new Os(e);a.url=t;var l=new Texture2(new Ns(a,{scaleMode:Vi.SCALE_MODE,resolution:getResolutionOfUrl(t)}));return n||(n=t),Ns.addToCache(l.baseTexture,n),Texture2.addToCache(l,n),n!==t&&(Ns.addToCache(l.baseTexture,t),Texture2.addToCache(l,t)),l},Texture2.addToCache=function addToCache(e,t){t&&(-1===e.textureCacheIds.indexOf(t)&&e.textureCacheIds.push(t),za[t]&&console.warn("Texture added to the cache with an id ["+t+"] that already had an entry"),za[t]=e)},Texture2.removeFromCache=function removeFromCache(e){if("string"==typeof e){var t=za[e];if(t){var n=t.textureCacheIds.indexOf(e);return n>-1&&t.textureCacheIds.splice(n,1),delete za[e],t}}else if(e&&e.textureCacheIds){for(var a=0;a<e.textureCacheIds.length;++a)za[e.textureCacheIds[a]]===e&&delete za[e.textureCacheIds[a]];return e.textureCacheIds.length=0,e}return null},t.resolution.get=function(){return this.baseTexture.resolution},t.frame.get=function(){return this._frame},t.frame.set=function(e){this._frame=e,this.noFrame=!1;var t=e.x,n=e.y,a=e.width,l=e.height,f=t+a>this.baseTexture.width,p=n+l>this.baseTexture.height;if(f||p){var h=f&&p?"and":"or",m="X: "+t+" + "+a+" = "+(t+a)+" > "+this.baseTexture.width,g="Y: "+n+" + "+l+" = "+(n+l)+" > "+this.baseTexture.height;throw new Error("Texture Error: frame does not fit inside the base Texture dimensions: "+m+" "+h+" "+g)}this.valid=a&&l&&this.baseTexture.valid,this.trim||this.rotate||(this.orig=e),this.valid&&this.updateUvs()},t.rotate.get=function(){return this._rotate},t.rotate.set=function(e){this._rotate=e,this.valid&&this.updateUvs()},t.width.get=function(){return this.orig.width},t.height.get=function(){return this.orig.height},Object.defineProperties(Texture2.prototype,t),Texture2}(Gi);function removeAllHandlers(e){e.destroy=function _emptyDestroy(){},e.on=function _emptyOn(){},e.once=function _emptyOnce(){},e.emit=function _emptyEmit(){}}Zs.EMPTY=new Zs(new Ns),removeAllHandlers(Zs.EMPTY),removeAllHandlers(Zs.EMPTY.baseTexture),Zs.WHITE=function createWhiteTexture(){var e=document.createElement("canvas");e.width=16,e.height=16;var t=e.getContext("2d");return t.fillStyle="white",t.fillRect(0,0,16,16),new Zs(new Ns(new Bs(e)))}(),removeAllHandlers(Zs.WHITE),removeAllHandlers(Zs.WHITE.baseTexture);var Qs=function(e){function RenderTexture2(t,n){var a=null;if(!(t instanceof Ws)){var l=arguments[1],f=arguments[2],p=arguments[3],h=arguments[4];console.warn("Please use RenderTexture.create("+l+", "+f+") instead of the ctor directly."),a=arguments[0],n=null,t=new Ws({width:l,height:f,scaleMode:p,resolution:h})}e.call(this,t,n),this.legacyRenderer=a,this.valid=!0,this.filterFrame=null,this.filterPoolKey=null,this.updateUvs()}return e&&(RenderTexture2.__proto__=e),RenderTexture2.prototype=Object.create(e&&e.prototype),RenderTexture2.prototype.constructor=RenderTexture2,RenderTexture2.prototype.resize=function resize3(e,t,n){void 0===n&&(n=!0),e=Math.ceil(e),t=Math.ceil(t),this.valid=e>0&&t>0,this._frame.width=this.orig.width=e,this._frame.height=this.orig.height=t,n&&this.baseTexture.resize(e,t),this.updateUvs()},RenderTexture2.prototype.setResolution=function setResolution(e){var t=this.baseTexture;t.resolution!==e&&(t.setResolution(e),this.resize(t.width,t.height,!1))},RenderTexture2.create=function create3(e){return"number"==typeof e&&(e={width:e,height:arguments[1],scaleMode:arguments[2],resolution:arguments[3]}),new RenderTexture2(new Ws(e))},RenderTexture2}(Zs),Xs=function RenderTexturePool2(e){this.texturePool={},this.textureOptions=e||{},this.enableFullScreen=!1,this._pixelsWidth=0,this._pixelsHeight=0};Xs.prototype.createTexture=function createTexture(e,t){var n=new Ws(Object.assign({width:e,height:t,resolution:1},this.textureOptions));return new Qs(n)},Xs.prototype.getOptimalTexture=function getOptimalTexture(e,t,n){void 0===n&&(n=1);var a=Xs.SCREEN_KEY;e*=n,t*=n,this.enableFullScreen&&e===this._pixelsWidth&&t===this._pixelsHeight||(a=(65535&(e=nextPow2(e)))<<16|65535&(t=nextPow2(t))),this.texturePool[a]||(this.texturePool[a]=[]);var l=this.texturePool[a].pop();return l||(l=this.createTexture(e,t)),l.filterPoolKey=a,l.setResolution(n),l},Xs.prototype.getFilterTexture=function getFilterTexture(e,t){var n=this.getOptimalTexture(e.width,e.height,t||e.resolution);return n.filterFrame=e.filterFrame,n},Xs.prototype.returnTexture=function returnTexture(e){var t=e.filterPoolKey;e.filterFrame=null,this.texturePool[t].push(e)},Xs.prototype.returnFilterTexture=function returnFilterTexture(e){this.returnTexture(e)},Xs.prototype.clear=function clear2(e){if(e=!1!==e)for(var t in this.texturePool){var n=this.texturePool[t];if(n)for(var a=0;a<n.length;a++)n[a].destroy(!0)}this.texturePool={}},Xs.prototype.setScreenSize=function setScreenSize(e){if(e.width!==this._pixelsWidth||e.height!==this._pixelsHeight){var t=Xs.SCREEN_KEY,n=this.texturePool[t];if(this.enableFullScreen=e.width>0&&e.height>0,n)for(var a=0;a<n.length;a++)n[a].destroy(!0);this.texturePool[t]=[],this._pixelsWidth=e.width,this._pixelsHeight=e.height}},Xs.SCREEN_KEY="screen";var Ys=function Attribute2(e,t,n,a,l,f,p){void 0===n&&(n=!1),void 0===a&&(a=5126),this.buffer=e,this.size=t,this.normalized=n,this.type=a,this.stride=l,this.start=f,this.instance=p};Ys.prototype.destroy=function destroy3(){this.buffer=null},Ys.from=function from(e,t,n,a,l){return new Ys(e,t,n,a,l)};var Js=0,ec=function Buffer3(e,t,n){void 0===t&&(t=!0),void 0===n&&(n=!1),this.data=e||new Float32Array(1),this._glBuffers={},this._updateID=0,this.index=n,this.static=t,this.id=Js++,this.disposeRunner=new Es("disposeBuffer",2)};function getBufferType(e){if(4===e.BYTES_PER_ELEMENT)return e instanceof Float32Array?"Float32Array":e instanceof Uint32Array?"Uint32Array":"Int32Array";if(2===e.BYTES_PER_ELEMENT){if(e instanceof Uint16Array)return"Uint16Array"}else if(1===e.BYTES_PER_ELEMENT&&e instanceof Uint8Array)return"Uint8Array";return null}ec.prototype.update=function update2(e){this.data=e||this.data,this._updateID++},ec.prototype.dispose=function dispose3(){this.disposeRunner.run(this,!1)},ec.prototype.destroy=function destroy4(){this.dispose(),this.data=null},ec.from=function from2(e){return e instanceof Array&&(e=new Float32Array(e)),new ec(e)};var tc={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array};var nc={5126:4,5123:2,5121:1},rc=0,oc={Float32Array:Float32Array,Uint32Array:Uint32Array,Int32Array:Int32Array,Uint8Array:Uint8Array,Uint16Array:Uint16Array},ic=function Geometry2(e,t){void 0===e&&(e=[]),void 0===t&&(t={}),this.buffers=e,this.indexBuffer=null,this.attributes=t,this.glVertexArrayObjects={},this.id=rc++,this.instanced=!1,this.instanceCount=1,this.disposeRunner=new Es("disposeGeometry",2),this.refCount=0};ic.prototype.addAttribute=function addAttribute(e,t,n,a,l,f,p,h){if(void 0===a&&(a=!1),void 0===h&&(h=!1),!t)throw new Error("You must pass a buffer when creating an attribute");t.data||(t instanceof Array&&(t=new Float32Array(t)),t=new ec(t));var m=e.split("|");if(m.length>1){for(var g=0;g<m.length;g++)this.addAttribute(m[g],t,n,a,l);return this}var v=this.buffers.indexOf(t);return-1===v&&(this.buffers.push(t),v=this.buffers.length-1),this.attributes[e]=new Ys(v,n,a,l,f,p,h),this.instanced=this.instanced||h,this},ic.prototype.getAttribute=function getAttribute(e){return this.attributes[e]},ic.prototype.getBuffer=function getBuffer(e){return this.buffers[this.getAttribute(e).buffer]},ic.prototype.addIndex=function addIndex(e){return e.data||(e instanceof Array&&(e=new Uint16Array(e)),e=new ec(e)),e.index=!0,this.indexBuffer=e,-1===this.buffers.indexOf(e)&&this.buffers.push(e),this},ic.prototype.getIndex=function getIndex(){return this.indexBuffer},ic.prototype.interleave=function interleave(){if(1===this.buffers.length||2===this.buffers.length&&this.indexBuffer)return this;var e,t=[],n=[],a=new ec;for(e in this.attributes){var l=this.attributes[e],f=this.buffers[l.buffer];t.push(f.data),n.push(l.size*nc[l.type]/4),l.buffer=0}for(a.data=function interleaveTypedArrays(e,t){for(var n=0,a=0,l={},f=0;f<e.length;f++)a+=t[f],n+=e[f].length;for(var p=new ArrayBuffer(4*n),h=null,m=0,g=0;g<e.length;g++){var v=t[g],y=e[g],_=getBufferType(y);l[_]||(l[_]=new tc[_](p)),h=l[_];for(var b=0;b<y.length;b++)h[(b/v|0)*a+m+b%v]=y[b];m+=v}return new Float32Array(p)}(t,n),e=0;e<this.buffers.length;e++)this.buffers[e]!==this.indexBuffer&&this.buffers[e].destroy();return this.buffers=[a],this.indexBuffer&&this.buffers.push(this.indexBuffer),this},ic.prototype.getSize=function getSize(){for(var e in this.attributes){var t=this.attributes[e];return this.buffers[t.buffer].data.length/(t.stride/4||t.size)}return 0},ic.prototype.dispose=function dispose4(){this.disposeRunner.run(this,!1)},ic.prototype.destroy=function destroy5(){this.dispose(),this.buffers=null,this.indexBuffer=null,this.attributes=null},ic.prototype.clone=function clone(){for(var e=new ic,t=0;t<this.buffers.length;t++)e.buffers[t]=new ec(this.buffers[t].data.slice());for(var n in this.attributes){var a=this.attributes[n];e.attributes[n]=new Ys(a.buffer,a.size,a.normalized,a.type,a.stride,a.start,a.instance)}return this.indexBuffer&&(e.indexBuffer=e.buffers[this.buffers.indexOf(this.indexBuffer)],e.indexBuffer.index=!0),e},ic.merge=function merge(e){for(var t,n=new ic,a=[],l=[],f=[],p=0;p<e.length;p++){t=e[p];for(var h=0;h<t.buffers.length;h++)l[h]=l[h]||0,l[h]+=t.buffers[h].data.length,f[h]=0}for(var m=0;m<t.buffers.length;m++)a[m]=new(oc[getBufferType(t.buffers[m].data)])(l[m]),n.buffers[m]=new ec(a[m]);for(var g=0;g<e.length;g++){t=e[g];for(var v=0;v<t.buffers.length;v++)a[v].set(t.buffers[v].data,f[v]),f[v]+=t.buffers[v].data.length}if(n.attributes=t.attributes,t.indexBuffer){n.indexBuffer=n.buffers[t.buffers.indexOf(t.indexBuffer)],n.indexBuffer.index=!0;for(var y=0,_=0,b=0,C=0,S=0;S<t.buffers.length;S++)if(t.buffers[S]!==t.indexBuffer){C=S;break}for(var k in t.attributes){var w=t.attributes[k];(0|w.buffer)===C&&(_+=w.size*nc[w.type]/4)}for(var T=0;T<e.length;T++){for(var P=e[T].indexBuffer.data,A=0;A<P.length;A++)n.indexBuffer.data[A+b]+=y;y+=t.buffers[C].data.length/_,b+=P.length}}return n};var ac=function(e){function Quad2(){e.call(this),this.addAttribute("aVertexPosition",[0,0,1,0,1,1,0,1]).addIndex([0,1,3,2])}return e&&(Quad2.__proto__=e),Quad2.prototype=Object.create(e&&e.prototype),Quad2.prototype.constructor=Quad2,Quad2}(ic),sc=function(e){function QuadUv2(){e.call(this),this.vertices=new Float32Array([-1,-1,1,-1,1,1,-1,1]),this.uvs=new Float32Array([0,0,1,0,1,1,0,1]),this.vertexBuffer=new ec(this.vertices),this.uvBuffer=new ec(this.uvs),this.addAttribute("aVertexPosition",this.vertexBuffer).addAttribute("aTextureCoord",this.uvBuffer).addIndex([0,1,2,0,2,3])}return e&&(QuadUv2.__proto__=e),QuadUv2.prototype=Object.create(e&&e.prototype),QuadUv2.prototype.constructor=QuadUv2,QuadUv2.prototype.map=function map2(e,t){var n=0,a=0;return this.uvs[0]=n,this.uvs[1]=a,this.uvs[2]=n+t.width/e.width,this.uvs[3]=a,this.uvs[4]=n+t.width/e.width,this.uvs[5]=a+t.height/e.height,this.uvs[6]=n,this.uvs[7]=a+t.height/e.height,n=t.x,a=t.y,this.vertices[0]=n,this.vertices[1]=a,this.vertices[2]=n+t.width,this.vertices[3]=a,this.vertices[4]=n+t.width,this.vertices[5]=a+t.height,this.vertices[6]=n,this.vertices[7]=a+t.height,this.invalidate(),this},QuadUv2.prototype.invalidate=function invalidate(){return this.vertexBuffer._updateID++,this.uvBuffer._updateID++,this},QuadUv2}(ic),cc=0,lc=function UniformGroup2(e,t){this.uniforms=e,this.group=!0,this.syncUniforms={},this.dirtyId=0,this.id=cc++,this.static=!!t};lc.prototype.update=function update3(){this.dirtyId++},lc.prototype.add=function add(e,t,n){this.uniforms[e]=new lc(t,n)},lc.from=function from3(e,t){return new lc(e,t)};var uc=function FilterState2(){this.renderTexture=null,this.target=null,this.legacy=!1,this.resolution=1,this.sourceFrame=new hs,this.destinationFrame=new hs,this.filters=[]};uc.prototype.clear=function clear3(){this.target=null,this.filters=null,this.renderTexture=null};var dc=function(e){function FilterSystem2(t){e.call(this,t),this.defaultFilterStack=[{}],this.texturePool=new Xs,this.texturePool.setScreenSize(t.view),this.statePool=[],this.quad=new ac,this.quadUv=new sc,this.tempRect=new hs,this.activeState={},this.globalUniforms=new lc({outputFrame:this.tempRect,inputSize:new Float32Array(4),inputPixel:new Float32Array(4),inputClamp:new Float32Array(4),resolution:1,filterArea:new Float32Array(4),filterClamp:new Float32Array(4)},!0),this._pixelsWidth=t.view.width,this._pixelsHeight=t.view.height}return e&&(FilterSystem2.__proto__=e),FilterSystem2.prototype=Object.create(e&&e.prototype),FilterSystem2.prototype.constructor=FilterSystem2,FilterSystem2.prototype.push=function push(e,t){for(var n=this.renderer,a=this.defaultFilterStack,l=this.statePool.pop()||new uc,f=t[0].resolution,p=t[0].padding,h=t[0].autoFit,m=t[0].legacy,g=1;g<t.length;g++){var v=t[g];f=Math.min(f,v.resolution),p=Math.max(p,v.padding),h=h||v.autoFit,m=m||v.legacy}1===a.length&&(this.defaultFilterStack[0].renderTexture=n.renderTexture.current),a.push(l),l.resolution=f,l.legacy=m,l.target=e,l.sourceFrame.copyFrom(e.filterArea||e.getBounds(!0)),l.sourceFrame.pad(p),h&&l.sourceFrame.fit(this.renderer.renderTexture.sourceFrame),l.sourceFrame.ceil(f),l.renderTexture=this.getOptimalFilterTexture(l.sourceFrame.width,l.sourceFrame.height,f),l.filters=t,l.destinationFrame.width=l.renderTexture.width,l.destinationFrame.height=l.renderTexture.height,l.renderTexture.filterFrame=l.sourceFrame,n.renderTexture.bind(l.renderTexture,l.sourceFrame),n.renderTexture.clear()},FilterSystem2.prototype.pop=function pop(){var e=this.defaultFilterStack,t=e.pop(),n=t.filters;this.activeState=t;var a=this.globalUniforms.uniforms;a.outputFrame=t.sourceFrame,a.resolution=t.resolution;var l=a.inputSize,f=a.inputPixel,p=a.inputClamp;if(l[0]=t.destinationFrame.width,l[1]=t.destinationFrame.height,l[2]=1/l[0],l[3]=1/l[1],f[0]=l[0]*t.resolution,f[1]=l[1]*t.resolution,f[2]=1/f[0],f[3]=1/f[1],p[0]=.5*f[2],p[1]=.5*f[3],p[2]=t.sourceFrame.width*l[2]-.5*f[2],p[3]=t.sourceFrame.height*l[3]-.5*f[3],t.legacy){var h=a.filterArea;h[0]=t.destinationFrame.width,h[1]=t.destinationFrame.height,h[2]=t.sourceFrame.x,h[3]=t.sourceFrame.y,a.filterClamp=a.inputClamp}this.globalUniforms.update();var m=e[e.length-1];if(1===n.length)n[0].apply(this,t.renderTexture,m.renderTexture,!1,t),this.returnFilterTexture(t.renderTexture);else{var g=t.renderTexture,v=this.getOptimalFilterTexture(g.width,g.height,t.resolution);v.filterFrame=g.filterFrame;var y=0;for(y=0;y<n.length-1;++y){n[y].apply(this,g,v,!0,t);var _=g;g=v,v=_}n[y].apply(this,g,m.renderTexture,!1,t),this.returnFilterTexture(g),this.returnFilterTexture(v)}t.clear(),this.statePool.push(t)},FilterSystem2.prototype.applyFilter=function applyFilter(e,t,n,a){var l=this.renderer;l.renderTexture.bind(n,n?n.filterFrame:null),a&&l.renderTexture.clear(),e.uniforms.uSampler=t,e.uniforms.filterGlobals=this.globalUniforms,l.state.set(e.state),l.shader.bind(e),e.legacy?(this.quadUv.map(t._frame,t.filterFrame),l.geometry.bind(this.quadUv),l.geometry.draw(ia.TRIANGLES)):(l.geometry.bind(this.quad),l.geometry.draw(ia.TRIANGLE_STRIP))},FilterSystem2.prototype.calculateSpriteMatrix=function calculateSpriteMatrix(e,t){var n=this.activeState,a=n.sourceFrame,l=n.destinationFrame,f=t._texture.orig,p=e.set(l.width,0,0,l.height,a.x,a.y),h=t.worldTransform.copyTo(rs.TEMP_MATRIX);return h.invert(),p.prepend(h),p.scale(1/f.width,1/f.height),p.translate(t.anchor.x,t.anchor.y),p},FilterSystem2.prototype.destroy=function destroy10(){this.texturePool.clear(!1)},FilterSystem2.prototype.getOptimalFilterTexture=function getOptimalFilterTexture(e,t,n){return void 0===n&&(n=1),this.texturePool.getOptimalTexture(e,t,n)},FilterSystem2.prototype.getFilterTexture=function getFilterTexture2(e,t){if("number"==typeof e){var n=e;e=t,t=n}e=e||this.activeState.renderTexture;var a=this.texturePool.getOptimalTexture(e.width,e.height,t||e.resolution);return a.filterFrame=e.filterFrame,a},FilterSystem2.prototype.returnFilterTexture=function returnFilterTexture2(e){this.texturePool.returnTexture(e)},FilterSystem2.prototype.emptyPool=function emptyPool(){this.texturePool.clear(!0)},FilterSystem2.prototype.resize=function resize3(){this.texturePool.setScreenSize(this.renderer.view)},FilterSystem2}(Vs),fc=function ObjectRenderer2(e){this.renderer=e};fc.prototype.flush=function flush(){},fc.prototype.destroy=function destroy6(){this.renderer=null},fc.prototype.start=function start(){},fc.prototype.stop=function stop(){this.flush()},fc.prototype.render=function render(e){};var pc=function(e){function BatchSystem2(t){e.call(this,t),this.emptyRenderer=new fc(t),this.currentRenderer=this.emptyRenderer}return e&&(BatchSystem2.__proto__=e),BatchSystem2.prototype=Object.create(e&&e.prototype),BatchSystem2.prototype.constructor=BatchSystem2,BatchSystem2.prototype.setObjectRenderer=function setObjectRenderer(e){this.currentRenderer!==e&&(this.currentRenderer.stop(),this.currentRenderer=e,this.currentRenderer.start())},BatchSystem2.prototype.flush=function flush2(){this.setObjectRenderer(this.emptyRenderer)},BatchSystem2.prototype.reset=function reset2(){this.setObjectRenderer(this.emptyRenderer)},BatchSystem2.prototype.copyBoundTextures=function copyBoundTextures(e,t){for(var n=this.renderer.texture.boundTextures,a=t-1;a>=0;--a)e[a]=n[a]||null,e[a]&&(e[a]._batchLocation=a)},BatchSystem2.prototype.boundArray=function boundArray(e,t,n,a){for(var l=e.elements,f=e.ids,p=e.count,h=0,m=0;m<p;m++){var g=l[m],v=g._batchLocation;if(v>=0&&v<a&&t[v]===g)f[m]=v;else for(;h<a;){var y=t[h];if(!y||y._batchEnabled!==n||y._batchLocation!==h){f[m]=h,g._batchLocation=h,t[h]=g;break}h++}}},BatchSystem2}(Vs);Vi.PREFER_ENV=Hi.any?Ji.WEBGL:Ji.WEBGL2,Vi.STRICT_TEXTURE_CACHE=!1;var hc=0,mc=function(e){function ContextSystem2(t){e.call(this,t),this.webGLVersion=1,this.extensions={},this.handleContextLost=this.handleContextLost.bind(this),this.handleContextRestored=this.handleContextRestored.bind(this),t.view.addEventListener("webglcontextlost",this.handleContextLost,!1),t.view.addEventListener("webglcontextrestored",this.handleContextRestored,!1)}e&&(ContextSystem2.__proto__=e),ContextSystem2.prototype=Object.create(e&&e.prototype),ContextSystem2.prototype.constructor=ContextSystem2;var t={isLost:{configurable:!0}};return t.isLost.get=function(){return!this.gl||this.gl.isContextLost()},ContextSystem2.prototype.contextChange=function contextChange(e){this.gl=e,this.renderer.gl=e,this.renderer.CONTEXT_UID=hc++,e.isContextLost()&&e.getExtension("WEBGL_lose_context")&&e.getExtension("WEBGL_lose_context").restoreContext()},ContextSystem2.prototype.initFromContext=function initFromContext(e){this.gl=e,this.validateContext(e),this.renderer.gl=e,this.renderer.CONTEXT_UID=hc++,this.renderer.runners.contextChange.run(e)},ContextSystem2.prototype.initFromOptions=function initFromOptions(e){var t=this.createContext(this.renderer.view,e);this.initFromContext(t)},ContextSystem2.prototype.createContext=function createContext2(e,t){var n;if(Vi.PREFER_ENV>=Ji.WEBGL2&&(n=e.getContext("webgl2",t)),n)this.webGLVersion=2;else if(this.webGLVersion=1,!(n=e.getContext("webgl",t)||e.getContext("experimental-webgl",t)))throw new Error("This browser does not support WebGL. Try using the canvas renderer");return this.gl=n,this.getExtensions(),n},ContextSystem2.prototype.getExtensions=function getExtensions(){var e=this.gl;1===this.webGLVersion?Object.assign(this.extensions,{drawBuffers:e.getExtension("WEBGL_draw_buffers"),depthTexture:e.getExtension("WEBKIT_WEBGL_depth_texture"),loseContext:e.getExtension("WEBGL_lose_context"),vertexArrayObject:e.getExtension("OES_vertex_array_object")||e.getExtension("MOZ_OES_vertex_array_object")||e.getExtension("WEBKIT_OES_vertex_array_object"),anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),uint32ElementIndex:e.getExtension("OES_element_index_uint"),floatTexture:e.getExtension("OES_texture_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear"),textureHalfFloat:e.getExtension("OES_texture_half_float"),textureHalfFloatLinear:e.getExtension("OES_texture_half_float_linear")}):2===this.webGLVersion&&Object.assign(this.extensions,{anisotropicFiltering:e.getExtension("EXT_texture_filter_anisotropic"),colorBufferFloat:e.getExtension("EXT_color_buffer_float"),floatTextureLinear:e.getExtension("OES_texture_float_linear")})},ContextSystem2.prototype.handleContextLost=function handleContextLost(e){e.preventDefault()},ContextSystem2.prototype.handleContextRestored=function handleContextRestored(){this.renderer.runners.contextChange.run(this.gl)},ContextSystem2.prototype.destroy=function destroy10(){var e=this.renderer.view;e.removeEventListener("webglcontextlost",this.handleContextLost),e.removeEventListener("webglcontextrestored",this.handleContextRestored),this.gl.useProgram(null),this.extensions.loseContext&&this.extensions.loseContext.loseContext()},ContextSystem2.prototype.postrender=function postrender(){this.renderer.renderingToScreen&&this.gl.flush()},ContextSystem2.prototype.validateContext=function validateContext(e){e.getContextAttributes().stencil||console.warn("Provided WebGL context does not have a stencil buffer, masks may not render correctly")},Object.defineProperties(ContextSystem2.prototype,t),ContextSystem2}(Vs),gc=function(e){function FramebufferSystem2(t){e.call(this,t),this.managedFramebuffers=[],this.unknownFramebuffer=new Gs(10,10)}e&&(FramebufferSystem2.__proto__=e),FramebufferSystem2.prototype=Object.create(e&&e.prototype),FramebufferSystem2.prototype.constructor=FramebufferSystem2;var t={size:{configurable:!0}};return FramebufferSystem2.prototype.contextChange=function contextChange(){var e=this.gl=this.renderer.gl;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.current=this.unknownFramebuffer,this.viewport=new hs,this.hasMRT=!0,this.writeDepthTexture=!0,this.disposeAll(!0),1===this.renderer.context.webGLVersion){var t=this.renderer.context.extensions.drawBuffers,n=this.renderer.context.extensions.depthTexture;Vi.PREFER_ENV===Ji.WEBGL_LEGACY&&(t=null,n=null),t?e.drawBuffers=function(e){return t.drawBuffersWEBGL(e)}:(this.hasMRT=!1,e.drawBuffers=function(){}),n||(this.writeDepthTexture=!1)}},FramebufferSystem2.prototype.bind=function bind2(e,t){var n=this.gl;if(e){var a=e.glFramebuffers[this.CONTEXT_UID]||this.initFramebuffer(e);this.current!==e&&(this.current=e,n.bindFramebuffer(n.FRAMEBUFFER,a.framebuffer)),a.dirtyId!==e.dirtyId&&(a.dirtyId=e.dirtyId,a.dirtyFormat!==e.dirtyFormat?(a.dirtyFormat=e.dirtyFormat,this.updateFramebuffer(e)):a.dirtySize!==e.dirtySize&&(a.dirtySize=e.dirtySize,this.resizeFramebuffer(e)));for(var l=0;l<e.colorTextures.length;l++)e.colorTextures[l].texturePart?this.renderer.texture.unbind(e.colorTextures[l].texture):this.renderer.texture.unbind(e.colorTextures[l]);e.depthTexture&&this.renderer.texture.unbind(e.depthTexture),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,e.width,e.height)}else this.current&&(this.current=null,n.bindFramebuffer(n.FRAMEBUFFER,null)),t?this.setViewport(t.x,t.y,t.width,t.height):this.setViewport(0,0,this.renderer.width,this.renderer.height)},FramebufferSystem2.prototype.setViewport=function setViewport(e,t,n,a){var l=this.viewport;l.width===n&&l.height===a&&l.x===e&&l.y===t||(l.x=e,l.y=t,l.width=n,l.height=a,this.gl.viewport(e,t,n,a))},t.size.get=function(){return this.current?{x:0,y:0,width:this.current.width,height:this.current.height}:{x:0,y:0,width:this.renderer.width,height:this.renderer.height}},FramebufferSystem2.prototype.clear=function clear5(e,t,n,a){var l=this.gl;l.clearColor(e,t,n,a),l.clear(l.COLOR_BUFFER_BIT|l.DEPTH_BUFFER_BIT)},FramebufferSystem2.prototype.initFramebuffer=function initFramebuffer(e){var t={framebuffer:this.gl.createFramebuffer(),stencil:null,dirtyId:0,dirtyFormat:0,dirtySize:0};return e.glFramebuffers[this.CONTEXT_UID]=t,this.managedFramebuffers.push(e),e.disposeRunner.add(this),t},FramebufferSystem2.prototype.resizeFramebuffer=function resizeFramebuffer(e){var t=this.gl,n=e.glFramebuffers[this.CONTEXT_UID];n.stencil&&(t.bindRenderbuffer(t.RENDERBUFFER,n.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height));for(var a=e.colorTextures,l=0;l<a.length;l++)this.renderer.texture.bind(a[l],0);e.depthTexture&&this.renderer.texture.bind(e.depthTexture,0)},FramebufferSystem2.prototype.updateFramebuffer=function updateFramebuffer(e){var t=this.gl,n=e.glFramebuffers[this.CONTEXT_UID],a=e.colorTextures.length;t.drawBuffers||(a=Math.min(a,1));for(var l=[],f=0;f<a;f++){var p=e.colorTextures[f];p.texturePart?(this.renderer.texture.bind(p.texture,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+f,t.TEXTURE_CUBE_MAP_NEGATIVE_X+p.side,p.texture._glTextures[this.CONTEXT_UID].texture,0)):(this.renderer.texture.bind(p,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0+f,t.TEXTURE_2D,p._glTextures[this.CONTEXT_UID].texture,0)),l.push(t.COLOR_ATTACHMENT0+f)}if((l.length>1&&t.drawBuffers(l),e.depthTexture)&&this.writeDepthTexture){var h=e.depthTexture;this.renderer.texture.bind(h,0),t.framebufferTexture2D(t.FRAMEBUFFER,t.DEPTH_ATTACHMENT,t.TEXTURE_2D,h._glTextures[this.CONTEXT_UID].texture,0)}n.stencil||!e.stencil&&!e.depth||(n.stencil=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,n.stencil),t.renderbufferStorage(t.RENDERBUFFER,t.DEPTH_STENCIL,e.width,e.height),e.depthTexture||t.framebufferRenderbuffer(t.FRAMEBUFFER,t.DEPTH_STENCIL_ATTACHMENT,t.RENDERBUFFER,n.stencil))},FramebufferSystem2.prototype.disposeFramebuffer=function disposeFramebuffer(e,t){var n=e.glFramebuffers[this.CONTEXT_UID],a=this.gl;if(n){delete e.glFramebuffers[this.CONTEXT_UID];var l=this.managedFramebuffers.indexOf(e);l>=0&&this.managedFramebuffers.splice(l,1),e.disposeRunner.remove(this),t||(a.deleteFramebuffer(n.framebuffer),n.stencil&&a.deleteRenderbuffer(n.stencil))}},FramebufferSystem2.prototype.disposeAll=function disposeAll(e){var t=this.managedFramebuffers;this.managedFramebuffers=[];for(var n=0;n<t.length;n++)this.disposeFramebuffer(t[n],e)},FramebufferSystem2.prototype.forceStencil=function forceStencil(){var e=this.current;if(e){var t=e.glFramebuffers[this.CONTEXT_UID];if(t&&!t.stencil){e.enableStencil();var n=e.width,a=e.height,l=this.gl,f=l.createRenderbuffer();l.bindRenderbuffer(l.RENDERBUFFER,f),l.renderbufferStorage(l.RENDERBUFFER,l.DEPTH_STENCIL,n,a),t.stencil=f,l.framebufferRenderbuffer(l.FRAMEBUFFER,l.DEPTH_STENCIL_ATTACHMENT,l.RENDERBUFFER,f)}}},FramebufferSystem2.prototype.reset=function reset2(){this.current=this.unknownFramebuffer,this.viewport=new hs},Object.defineProperties(FramebufferSystem2.prototype,t),FramebufferSystem2}(Vs),vc=function GLBuffer2(e){this.buffer=e,this.updateID=-1,this.byteLength=-1,this.refCount=0},yc={5126:4,5123:2,5121:1},_c=function(e){function GeometrySystem2(t){e.call(this,t),this._activeGeometry=null,this._activeVao=null,this.hasVao=!0,this.hasInstance=!0,this.canUseUInt32ElementIndex=!1,this.boundBuffers={},this.managedGeometries={},this.managedBuffers={}}return e&&(GeometrySystem2.__proto__=e),GeometrySystem2.prototype=Object.create(e&&e.prototype),GeometrySystem2.prototype.constructor=GeometrySystem2,GeometrySystem2.prototype.contextChange=function contextChange(){this.disposeAll(!0);var e=this.gl=this.renderer.gl,t=this.renderer.context;if(this.CONTEXT_UID=this.renderer.CONTEXT_UID,!e.createVertexArray){var n=this.renderer.context.extensions.vertexArrayObject;Vi.PREFER_ENV===Ji.WEBGL_LEGACY&&(n=null),n?(e.createVertexArray=function(){return n.createVertexArrayOES()},e.bindVertexArray=function(e){return n.bindVertexArrayOES(e)},e.deleteVertexArray=function(e){return n.deleteVertexArrayOES(e)}):(this.hasVao=!1,e.createVertexArray=function(){},e.bindVertexArray=function(){},e.deleteVertexArray=function(){})}if(!e.vertexAttribDivisor){var a=e.getExtension("ANGLE_instanced_arrays");a?(e.vertexAttribDivisor=function(e,t){return a.vertexAttribDivisorANGLE(e,t)},e.drawElementsInstanced=function(e,t,n,l,f){return a.drawElementsInstancedANGLE(e,t,n,l,f)},e.drawArraysInstanced=function(e,t,n,l){return a.drawArraysInstancedANGLE(e,t,n,l)}):this.hasInstance=!1}this.canUseUInt32ElementIndex=2===t.webGLVersion||!!t.extensions.uint32ElementIndex},GeometrySystem2.prototype.bind=function bind2(e,t){t=t||this.renderer.shader.shader;var n=this.gl,a=e.glVertexArrayObjects[this.CONTEXT_UID];a||(this.managedGeometries[e.id]=e,e.disposeRunner.add(this),e.glVertexArrayObjects[this.CONTEXT_UID]=a={});var l=a[t.program.id]||this.initGeometryVao(e,t.program);this._activeGeometry=e,this._activeVao!==l&&(this._activeVao=l,this.hasVao?n.bindVertexArray(l):this.activateVao(e,t.program)),this.updateBuffers()},GeometrySystem2.prototype.reset=function reset2(){this.unbind()},GeometrySystem2.prototype.updateBuffers=function updateBuffers(){for(var e=this._activeGeometry,t=this.gl,n=0;n<e.buffers.length;n++){var a=e.buffers[n],l=a._glBuffers[this.CONTEXT_UID];if(a._updateID!==l.updateID){l.updateID=a._updateID;var f=a.index?t.ELEMENT_ARRAY_BUFFER:t.ARRAY_BUFFER;if(t.bindBuffer(f,l.buffer),this._boundBuffer=l,l.byteLength>=a.data.byteLength)t.bufferSubData(f,0,a.data);else{var p=a.static?t.STATIC_DRAW:t.DYNAMIC_DRAW;l.byteLength=a.data.byteLength,t.bufferData(f,a.data,p)}}}},GeometrySystem2.prototype.checkCompatibility=function checkCompatibility(e,t){var n=e.attributes,a=t.attributeData;for(var l in a)if(!n[l])throw new Error('shader and geometry incompatible, geometry missing the "'+l+'" attribute')},GeometrySystem2.prototype.getSignature=function getSignature(e,t){var n=e.attributes,a=t.attributeData,l=["g",e.id];for(var f in n)a[f]&&l.push(f);return l.join("-")},GeometrySystem2.prototype.initGeometryVao=function initGeometryVao(e,t){this.checkCompatibility(e,t);var n=this.gl,a=this.CONTEXT_UID,l=this.getSignature(e,t),f=e.glVertexArrayObjects[this.CONTEXT_UID],p=f[l];if(p)return f[t.id]=p,p;var h=e.buffers,m=e.attributes,g={},v={};for(var y in h)g[y]=0,v[y]=0;for(var _ in m)!m[_].size&&t.attributeData[_]?m[_].size=t.attributeData[_].size:m[_].size||console.warn("PIXI Geometry attribute '"+_+"' size cannot be determined (likely the bound shader does not have the attribute)"),g[m[_].buffer]+=m[_].size*yc[m[_].type];for(var b in m){var C=m[b],S=C.size;void 0===C.stride&&(g[C.buffer]===S*yc[C.type]?C.stride=0:C.stride=g[C.buffer]),void 0===C.start&&(C.start=v[C.buffer],v[C.buffer]+=S*yc[C.type])}p=n.createVertexArray(),n.bindVertexArray(p);for(var k=0;k<h.length;k++){var w=h[k];w._glBuffers[a]||(w._glBuffers[a]=new vc(n.createBuffer()),this.managedBuffers[w.id]=w,w.disposeRunner.add(this)),w._glBuffers[a].refCount++}return this.activateVao(e,t),this._activeVao=p,f[t.id]=p,f[l]=p,p},GeometrySystem2.prototype.disposeBuffer=function disposeBuffer(e,t){if(this.managedBuffers[e.id]){delete this.managedBuffers[e.id];var n=e._glBuffers[this.CONTEXT_UID],a=this.gl;e.disposeRunner.remove(this),n&&(t||a.deleteBuffer(n.buffer),delete e._glBuffers[this.CONTEXT_UID])}},GeometrySystem2.prototype.disposeGeometry=function disposeGeometry(e,t){if(this.managedGeometries[e.id]){delete this.managedGeometries[e.id];var n=e.glVertexArrayObjects[this.CONTEXT_UID],a=this.gl,l=e.buffers;if(e.disposeRunner.remove(this),n){for(var f=0;f<l.length;f++){var p=l[f]._glBuffers[this.CONTEXT_UID];p.refCount--,0!==p.refCount||t||this.disposeBuffer(l[f],t)}if(!t)for(var h in n)if("g"===h[0]){var m=n[h];this._activeVao===m&&this.unbind(),a.deleteVertexArray(m)}delete e.glVertexArrayObjects[this.CONTEXT_UID]}}},GeometrySystem2.prototype.disposeAll=function disposeAll(e){for(var t=Object.keys(this.managedGeometries),n=0;n<t.length;n++)this.disposeGeometry(this.managedGeometries[t[n]],e);t=Object.keys(this.managedBuffers);for(var a=0;a<t.length;a++)this.disposeBuffer(this.managedBuffers[t[a]],e)},GeometrySystem2.prototype.activateVao=function activateVao(e,t){var n=this.gl,a=this.CONTEXT_UID,l=e.buffers,f=e.attributes;e.indexBuffer&&n.bindBuffer(n.ELEMENT_ARRAY_BUFFER,e.indexBuffer._glBuffers[a].buffer);var p=null;for(var h in f){var m=f[h],g=l[m.buffer]._glBuffers[a];if(t.attributeData[h]){p!==g&&(n.bindBuffer(n.ARRAY_BUFFER,g.buffer),p=g);var v=t.attributeData[h].location;if(n.enableVertexAttribArray(v),n.vertexAttribPointer(v,m.size,m.type||n.FLOAT,m.normalized,m.stride,m.start),m.instance){if(!this.hasInstance)throw new Error("geometry error, GPU Instancing is not supported on this device");n.vertexAttribDivisor(v,1)}}}},GeometrySystem2.prototype.draw=function draw(e,t,n,a){var l=this.gl,f=this._activeGeometry;if(f.indexBuffer){var p=f.indexBuffer.data.BYTES_PER_ELEMENT,h=2===p?l.UNSIGNED_SHORT:l.UNSIGNED_INT;2===p||4===p&&this.canUseUInt32ElementIndex?f.instanced?l.drawElementsInstanced(e,t||f.indexBuffer.data.length,h,(n||0)*p,a||1):l.drawElements(e,t||f.indexBuffer.data.length,h,(n||0)*p):console.warn("unsupported index buffer type: uint32")}else f.instanced?l.drawArraysInstanced(e,n,t||f.getSize(),a||1):l.drawArrays(e,n,t||f.getSize());return this},GeometrySystem2.prototype.unbind=function unbind2(){this.gl.bindVertexArray(null),this._activeVao=null,this._activeGeometry=null},GeometrySystem2}(Vs),bc=function MaskData2(e){this.type=Ta.NONE,this.autoDetect=!0,this.maskObject=e||null,this.pooled=!1,this.isMaskData=!0,this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null,this._target=null};function compileProgram(e,t,n,a){var l=compileShader(e,e.VERTEX_SHADER,t),f=compileShader(e,e.FRAGMENT_SHADER,n),p=e.createProgram();if(e.attachShader(p,l),e.attachShader(p,f),a)for(var h in a)e.bindAttribLocation(p,a[h],h);return e.linkProgram(p),e.getProgramParameter(p,e.LINK_STATUS)||(e.getShaderParameter(l,e.COMPILE_STATUS)||(console.warn(t),console.error(e.getShaderInfoLog(l))),e.getShaderParameter(f,e.COMPILE_STATUS)||(console.warn(n),console.error(e.getShaderInfoLog(f))),console.error("Pixi.js Error: Could not initialize shader."),console.error("gl.VALIDATE_STATUS",e.getProgramParameter(p,e.VALIDATE_STATUS)),console.error("gl.getError()",e.getError()),""!==e.getProgramInfoLog(p)&&console.warn("Pixi.js Warning: gl.getProgramInfoLog()",e.getProgramInfoLog(p)),e.deleteProgram(p),p=null),e.deleteShader(l),e.deleteShader(f),p}function compileShader(e,t,n){var a=e.createShader(t);return e.shaderSource(a,n),e.compileShader(a),a}function defaultValue(e,t){switch(e){case"float":case"int":case"sampler2D":case"sampler2DArray":return 0;case"vec2":return new Float32Array(2*t);case"vec3":return new Float32Array(3*t);case"vec4":return new Float32Array(4*t);case"ivec2":return new Int32Array(2*t);case"ivec3":return new Int32Array(3*t);case"ivec4":return new Int32Array(4*t);case"bool":return!1;case"bvec2":return booleanArray(2*t);case"bvec3":return booleanArray(3*t);case"bvec4":return booleanArray(4*t);case"mat2":return new Float32Array([1,0,0,1]);case"mat3":return new Float32Array([1,0,0,0,1,0,0,0,1]);case"mat4":return new Float32Array([1,0,0,0,0,1,0,0,0,0,1,0,0,0,0,1])}return null}function booleanArray(e){for(var t=new Array(e),n=0;n<t.length;n++)t[n]=!1;return t}bc.prototype.reset=function reset(){this.pooled&&(this.maskObject=null,this.type=Ta.NONE,this.autoDetect=!0),this._target=null},bc.prototype.copyCountersOrReset=function copyCountersOrReset(e){e?(this._stencilCounter=e._stencilCounter,this._scissorCounter=e._scissorCounter,this._scissorRect=e._scissorRect):(this._stencilCounter=0,this._scissorCounter=0,this._scissorRect=null)};var Cc,Sc={},kc=Sc;function getTestContext(){if(kc===Sc||kc&&kc.isContextLost()){var e,t=document.createElement("canvas");Vi.PREFER_ENV>=Ji.WEBGL2&&(e=t.getContext("webgl2",{})),e||((e=t.getContext("webgl",{})||t.getContext("experimental-webgl",{}))?e.getExtension("WEBGL_draw_buffers"):e=null),kc=e}return kc}function setPrecision(e,t,n){if("precision"!==e.substring(0,9)){var a=t;return t===ka.HIGH&&n!==ka.HIGH&&(a=ka.MEDIUM),"precision "+a+" float;\n"+e}return n!==ka.HIGH&&"precision highp"===e.substring(0,15)?e.replace("precision highp","precision mediump"):e}var wc={float:1,vec2:2,vec3:3,vec4:4,int:1,ivec2:2,ivec3:3,ivec4:4,bool:1,bvec2:2,bvec3:3,bvec4:4,mat2:4,mat3:9,mat4:16,sampler2D:1};function mapSize(e){return wc[e]}var Tc=null,Pc={FLOAT:"float",FLOAT_VEC2:"vec2",FLOAT_VEC3:"vec3",FLOAT_VEC4:"vec4",INT:"int",INT_VEC2:"ivec2",INT_VEC3:"ivec3",INT_VEC4:"ivec4",BOOL:"bool",BOOL_VEC2:"bvec2",BOOL_VEC3:"bvec3",BOOL_VEC4:"bvec4",FLOAT_MAT2:"mat2",FLOAT_MAT3:"mat3",FLOAT_MAT4:"mat4",SAMPLER_2D:"sampler2D",SAMPLER_CUBE:"samplerCube",SAMPLER_2D_ARRAY:"sampler2DArray"};function mapType(e,t){if(!Tc){var n=Object.keys(Pc);Tc={};for(var a=0;a<n.length;++a){var l=n[a];Tc[e[l]]=Pc[l]}}return Tc[t]}var Ec={float:"\n    if(cv !== v)\n    {\n        cv.v = v;\n        gl.uniform1f(location, v)\n    }",vec2:"\n    if(cv[0] !== v[0] || cv[1] !== v[1])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        gl.uniform2f(location, v[0], v[1])\n    }",vec3:"\n    if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2])\n    {\n        cv[0] = v[0];\n        cv[1] = v[1];\n        cv[2] = v[2];\n\n        gl.uniform3f(location, v[0], v[1], v[2])\n    }",vec4:"gl.uniform4f(location, v[0], v[1], v[2], v[3])",int:"gl.uniform1i(location, v)",ivec2:"gl.uniform2i(location, v[0], v[1])",ivec3:"gl.uniform3i(location, v[0], v[1], v[2])",ivec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",bool:"gl.uniform1i(location, v)",bvec2:"gl.uniform2i(location, v[0], v[1])",bvec3:"gl.uniform3i(location, v[0], v[1], v[2])",bvec4:"gl.uniform4i(location, v[0], v[1], v[2], v[3])",mat2:"gl.uniformMatrix2fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",sampler2D:"gl.uniform1i(location, v)",samplerCube:"gl.uniform1i(location, v)",sampler2DArray:"gl.uniform1i(location, v)"},Ac={float:"gl.uniform1fv(location, v)",vec2:"gl.uniform2fv(location, v)",vec3:"gl.uniform3fv(location, v)",vec4:"gl.uniform4fv(location, v)",mat4:"gl.uniformMatrix4fv(location, false, v)",mat3:"gl.uniformMatrix3fv(location, false, v)",mat2:"gl.uniformMatrix2fv(location, false, v)",int:"gl.uniform1iv(location, v)",ivec2:"gl.uniform2iv(location, v)",ivec3:"gl.uniform3iv(location, v)",ivec4:"gl.uniform4iv(location, v)",bool:"gl.uniform1iv(location, v)",bvec2:"gl.uniform2iv(location, v)",bvec3:"gl.uniform3iv(location, v)",bvec4:"gl.uniform4iv(location, v)",sampler2D:"gl.uniform1iv(location, v)",samplerCube:"gl.uniform1iv(location, v)",sampler2DArray:"gl.uniform1iv(location, v)"};var Mc,xc=["precision mediump float;","void main(void){","float test = 0.1;","%forloop%","gl_FragColor = vec4(0.0);","}"].join("\n");function generateIfTestSrc(e){for(var t="",n=0;n<e;++n)n>0&&(t+="\nelse "),n<e-1&&(t+="if(test == "+n+".0){}");return t}var Oc=0,Rc={},Ic=function Program2(e,t,n){void 0===n&&(n="pixi-shader"),this.id=Oc++,this.vertexSrc=e||Program2.defaultVertexSrc,this.fragmentSrc=t||Program2.defaultFragmentSrc,this.vertexSrc=this.vertexSrc.trim(),this.fragmentSrc=this.fragmentSrc.trim(),"#version"!==this.vertexSrc.substring(0,8)&&(n=n.replace(/\s+/g,"-"),Rc[n]?(Rc[n]++,n+="-"+Rc[n]):Rc[n]=1,this.vertexSrc="#define SHADER_NAME "+n+"\n"+this.vertexSrc,this.fragmentSrc="#define SHADER_NAME "+n+"\n"+this.fragmentSrc,this.vertexSrc=setPrecision(this.vertexSrc,Vi.PRECISION_VERTEX,ka.HIGH),this.fragmentSrc=setPrecision(this.fragmentSrc,Vi.PRECISION_FRAGMENT,function getMaxFragmentPrecision(){if(!Cc){Cc=ka.MEDIUM;var e=getTestContext();if(e&&e.getShaderPrecisionFormat){var t=e.getShaderPrecisionFormat(e.FRAGMENT_SHADER,e.HIGH_FLOAT);Cc=t.precision?ka.HIGH:ka.MEDIUM}}return Cc}())),this.extractData(this.vertexSrc,this.fragmentSrc),this.glPrograms={},this.syncUniforms=null},Lc={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};Ic.prototype.extractData=function extractData(e,t){var n=getTestContext();if(n){var a=compileProgram(n,e,t);this.attributeData=this.getAttributeData(a,n),this.uniformData=this.getUniformData(a,n),n.deleteProgram(a)}else this.uniformData={},this.attributeData={}},Ic.prototype.getAttributeData=function getAttributeData(e,t){for(var n={},a=[],l=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),f=0;f<l;f++){var p=t.getActiveAttrib(e,f),h=mapType(t,p.type),m={type:h,name:p.name,size:mapSize(h),location:0};n[p.name]=m,a.push(m)}a.sort((function(e,t){return e.name>t.name?1:-1}));for(var g=0;g<a.length;g++)a[g].location=g;return n},Ic.prototype.getUniformData=function getUniformData(e,t){for(var n={},a=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),l=0;l<a;l++){var f=t.getActiveUniform(e,l),p=f.name.replace(/\[.*?\]/,""),h=f.name.match(/\[.*?\]/,""),m=mapType(t,f.type);n[p]={type:m,size:f.size,isArray:h,value:defaultValue(m,f.size)}}return n},Lc.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nvoid main(void){\n   gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n   vTextureCoord = aTextureCoord;\n}\n"},Lc.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor *= texture2D(uSampler, vTextureCoord);\n}"},Ic.from=function from4(e,t,n){var a=e+t,l=Wa[a];return l||(Wa[a]=l=new Ic(e,t,n)),l},Object.defineProperties(Ic,Lc);var Nc=function Shader2(e,t){for(var n in this.program=e,this.uniformGroup=t?t instanceof lc?t:new lc(t):new lc({}),e.uniformData)this.uniformGroup.uniforms[n]instanceof Array&&(this.uniformGroup.uniforms[n]=new Float32Array(this.uniformGroup.uniforms[n]))},Dc={uniforms:{configurable:!0}};Nc.prototype.checkUniformExists=function checkUniformExists(e,t){if(t.uniforms[e])return!0;for(var n in t.uniforms){var a=t.uniforms[n];if(a.group&&this.checkUniformExists(e,a))return!0}return!1},Nc.prototype.destroy=function destroy7(){this.uniformGroup=null},Dc.uniforms.get=function(){return this.uniformGroup.uniforms},Nc.from=function from5(e,t,n){var a=Ic.from(e,t);return new Nc(a,n)},Object.defineProperties(Nc.prototype,Dc);var Bc=function State2(){this.data=0,this.blendMode=ra.NORMAL,this.polygonOffset=0,this.blend=!0},Fc={blend:{configurable:!0},offsets:{configurable:!0},culling:{configurable:!0},depthTest:{configurable:!0},clockwiseFrontFace:{configurable:!0},blendMode:{configurable:!0},polygonOffset:{configurable:!0}};Fc.blend.get=function(){return!!(1&this.data)},Fc.blend.set=function(e){!!(1&this.data)!==e&&(this.data^=1)},Fc.offsets.get=function(){return!!(2&this.data)},Fc.offsets.set=function(e){!!(2&this.data)!==e&&(this.data^=2)},Fc.culling.get=function(){return!!(4&this.data)},Fc.culling.set=function(e){!!(4&this.data)!==e&&(this.data^=4)},Fc.depthTest.get=function(){return!!(8&this.data)},Fc.depthTest.set=function(e){!!(8&this.data)!==e&&(this.data^=8)},Fc.clockwiseFrontFace.get=function(){return!!(16&this.data)},Fc.clockwiseFrontFace.set=function(e){!!(16&this.data)!==e&&(this.data^=16)},Fc.blendMode.get=function(){return this._blendMode},Fc.blendMode.set=function(e){this.blend=e!==ra.NONE,this._blendMode=e},Fc.polygonOffset.get=function(){return this._polygonOffset},Fc.polygonOffset.set=function(e){this.offsets=!!e,this._polygonOffset=e},Bc.for2d=function for2d(){var e=new Bc;return e.depthTest=!1,e.blend=!0,e},Object.defineProperties(Bc.prototype,Fc);var jc=function(e){function Filter2(t,n,a){var l=Ic.from(t||Filter2.defaultVertexSrc,n||Filter2.defaultFragmentSrc);e.call(this,l,a),this.padding=0,this.resolution=Vi.FILTER_RESOLUTION,this.enabled=!0,this.autoFit=!0,this.legacy=!!this.program.attributeData.aTextureCoord,this.state=new Bc}e&&(Filter2.__proto__=e),Filter2.prototype=Object.create(e&&e.prototype),Filter2.prototype.constructor=Filter2;var t={blendMode:{configurable:!0}},n={defaultVertexSrc:{configurable:!0},defaultFragmentSrc:{configurable:!0}};return Filter2.prototype.apply=function apply(e,t,n,a,l){e.applyFilter(this,t,n,a,l)},t.blendMode.get=function(){return this.state.blendMode},t.blendMode.set=function(e){this.state.blendMode=e},n.defaultVertexSrc.get=function(){return"attribute vec2 aVertexPosition;\n\nuniform mat3 projectionMatrix;\n\nvarying vec2 vTextureCoord;\n\nuniform vec4 inputSize;\nuniform vec4 outputFrame;\n\nvec4 filterVertexPosition( void )\n{\n    vec2 position = aVertexPosition * max(outputFrame.zw, vec2(0.)) + outputFrame.xy;\n\n    return vec4((projectionMatrix * vec3(position, 1.0)).xy, 0.0, 1.0);\n}\n\nvec2 filterTextureCoord( void )\n{\n    return aVertexPosition * (outputFrame.zw * inputSize.zw);\n}\n\nvoid main(void)\n{\n    gl_Position = filterVertexPosition();\n    vTextureCoord = filterTextureCoord();\n}\n"},n.defaultFragmentSrc.get=function(){return"varying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\n\nvoid main(void){\n   gl_FragColor = texture2D(uSampler, vTextureCoord);\n}\n"},Object.defineProperties(Filter2.prototype,t),Object.defineProperties(Filter2,n),Filter2}(Nc);jc.SOURCE_KEY_MAP={};var $c=new rs,Hc=function TextureMatrix2(e,t){this._texture=e,this.mapCoord=new rs,this.uClampFrame=new Float32Array(4),this.uClampOffset=new Float32Array(2),this._updateID=-1,this.clampOffset=0,this.clampMargin=void 0===t?.5:t,this.isSimple=!1},Vc={texture:{configurable:!0}};Vc.texture.get=function(){return this._texture},Vc.texture.set=function(e){this._texture=e,this._updateID=-1},Hc.prototype.multiplyUvs=function multiplyUvs(e,t){void 0===t&&(t=e);for(var n=this.mapCoord,a=0;a<e.length;a+=2){var l=e[a],f=e[a+1];t[a]=l*n.a+f*n.c+n.tx,t[a+1]=l*n.b+f*n.d+n.ty}return t},Hc.prototype.update=function update4(e){var t=this._texture;if(!t||!t.valid)return!1;if(!e&&this._updateID===t._updateID)return!1;this._updateID=t._updateID;var n=t._uvs;this.mapCoord.set(n.x1-n.x0,n.y1-n.y0,n.x3-n.x0,n.y3-n.y0,n.x0,n.y0);var a=t.orig,l=t.trim;l&&($c.set(a.width/l.width,0,0,a.height/l.height,-l.x/l.width,-l.y/l.height),this.mapCoord.append($c));var f=t.baseTexture,p=this.uClampFrame,h=this.clampMargin/f.resolution,m=this.clampOffset;return p[0]=(t._frame.x+h+m)/f.width,p[1]=(t._frame.y+h+m)/f.height,p[2]=(t._frame.x+t._frame.width-h+m)/f.width,p[3]=(t._frame.y+t._frame.height-h+m)/f.height,this.uClampOffset[0]=m/f.realWidth,this.uClampOffset[1]=m/f.realHeight,this.isSimple=t._frame.width===f.width&&t._frame.height===f.height&&0===t.rotate,!0},Object.defineProperties(Hc.prototype,Vc);var Uc=function(e){function SpriteMaskFilter2(t){var n=new rs;e.call(this,"attribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\n\nuniform mat3 projectionMatrix;\nuniform mat3 otherMatrix;\n\nvarying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nvoid main(void)\n{\n    gl_Position = vec4((projectionMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vMaskCoord = ( otherMatrix * vec3( aTextureCoord, 1.0)  ).xy;\n}\n","varying vec2 vMaskCoord;\nvarying vec2 vTextureCoord;\n\nuniform sampler2D uSampler;\nuniform sampler2D mask;\nuniform float alpha;\nuniform float npmAlpha;\nuniform vec4 maskClamp;\n\nvoid main(void)\n{\n    float clip = step(3.5,\n        step(maskClamp.x, vMaskCoord.x) +\n        step(maskClamp.y, vMaskCoord.y) +\n        step(vMaskCoord.x, maskClamp.z) +\n        step(vMaskCoord.y, maskClamp.w));\n\n    vec4 original = texture2D(uSampler, vTextureCoord);\n    vec4 masky = texture2D(mask, vMaskCoord);\n    float alphaMul = 1.0 - npmAlpha * (1.0 - masky.a);\n\n    original *= (alphaMul * masky.r * alpha * clip);\n\n    gl_FragColor = original;\n}\n"),t.renderable=!1,this.maskSprite=t,this.maskMatrix=n}return e&&(SpriteMaskFilter2.__proto__=e),SpriteMaskFilter2.prototype=Object.create(e&&e.prototype),SpriteMaskFilter2.prototype.constructor=SpriteMaskFilter2,SpriteMaskFilter2.prototype.apply=function apply(e,t,n,a){var l=this.maskSprite,f=this.maskSprite.texture;f.valid&&(f.transform||(f.transform=new Hc(f,0)),f.transform.update(),this.uniforms.npmAlpha=f.baseTexture.alphaMode?0:1,this.uniforms.mask=f,this.uniforms.otherMatrix=e.calculateSpriteMatrix(this.maskMatrix,l).prepend(f.transform.mapCoord),this.uniforms.alpha=l.worldAlpha,this.uniforms.maskClamp=f.transform.uClampFrame,e.applyFilter(this,t,n,a))},SpriteMaskFilter2}(jc),Gc=function(e){function MaskSystem2(t){e.call(this,t),this.scissorRenderTarget=null,this.enableScissor=!1,this.alphaMaskPool=[],this.maskDataPool=[],this.maskStack=[],this.alphaMaskIndex=0}return e&&(MaskSystem2.__proto__=e),MaskSystem2.prototype=Object.create(e&&e.prototype),MaskSystem2.prototype.constructor=MaskSystem2,MaskSystem2.prototype.setMaskStack=function setMaskStack(e){this.maskStack=e,this.renderer.scissor.setMaskStack(e),this.renderer.stencil.setMaskStack(e)},MaskSystem2.prototype.push=function push(e,t){if(!t.isMaskData){var n=this.maskDataPool.pop()||new bc;n.pooled=!0,n.maskObject=t,t=n}switch(t.autoDetect&&this.detect(t),t.copyCountersOrReset(this.maskStack[this.maskStack.length-1]),t._target=e,t.type){case Ta.SCISSOR:this.maskStack.push(t),this.renderer.scissor.push(t);break;case Ta.STENCIL:this.maskStack.push(t),this.renderer.stencil.push(t);break;case Ta.SPRITE:t.copyCountersOrReset(null),this.pushSpriteMask(t),this.maskStack.push(t)}},MaskSystem2.prototype.pop=function pop(e){var t=this.maskStack.pop();if(t&&t._target===e){switch(t.type){case Ta.SCISSOR:this.renderer.scissor.pop();break;case Ta.STENCIL:this.renderer.stencil.pop(t.maskObject);break;case Ta.SPRITE:this.popSpriteMask()}t.reset(),t.pooled&&this.maskDataPool.push(t)}},MaskSystem2.prototype.detect=function detect(e){var t=e.maskObject;if(t.isSprite)e.type=Ta.SPRITE;else if(e.type=Ta.STENCIL,this.enableScissor&&t.isFastRect&&t.isFastRect()){var n=t.worldTransform,a=Math.atan2(n.b,n.a),l=Math.atan2(n.d,n.c);a=Math.round(a*(180/Math.PI)*100),l=((l=Math.round(l*(180/Math.PI)*100)-a)%18e3+18e3)%18e3,0===(a=(a%9e3+9e3)%9e3)&&9e3===l&&(e.type=Ta.SCISSOR)}},MaskSystem2.prototype.pushSpriteMask=function pushSpriteMask(e){var t=e.maskObject,n=e._target,a=this.alphaMaskPool[this.alphaMaskIndex];a||(a=this.alphaMaskPool[this.alphaMaskIndex]=[new Uc(t)]),a[0].resolution=this.renderer.resolution,a[0].maskSprite=t;var l=n.filterArea;n.filterArea=t.getBounds(!0),this.renderer.filter.push(n,a),n.filterArea=l,this.alphaMaskIndex++},MaskSystem2.prototype.popSpriteMask=function popSpriteMask(){this.renderer.filter.pop(),this.alphaMaskIndex--},MaskSystem2}(Vs),qc=function(e){function AbstractMaskSystem2(t){e.call(this,t),this.maskStack=[],this.glConst=0}return e&&(AbstractMaskSystem2.__proto__=e),AbstractMaskSystem2.prototype=Object.create(e&&e.prototype),AbstractMaskSystem2.prototype.constructor=AbstractMaskSystem2,AbstractMaskSystem2.prototype.getStackLength=function getStackLength(){return this.maskStack.length},AbstractMaskSystem2.prototype.setMaskStack=function setMaskStack(e){var t=this.renderer.gl,n=this.getStackLength();this.maskStack=e;var a=this.getStackLength();a!==n&&(0===a?t.disable(this.glConst):(t.enable(this.glConst),this._useCurrent()))},AbstractMaskSystem2.prototype._useCurrent=function _useCurrent(){},AbstractMaskSystem2.prototype.destroy=function destroy10(){e.prototype.destroy.call(this,this),this.maskStack=null},AbstractMaskSystem2}(Vs),Wc=function(e){function ScissorSystem2(t){e.call(this,t),this.glConst=WebGLRenderingContext.SCISSOR_TEST}return e&&(ScissorSystem2.__proto__=e),ScissorSystem2.prototype=Object.create(e&&e.prototype),ScissorSystem2.prototype.constructor=ScissorSystem2,ScissorSystem2.prototype.getStackLength=function getStackLength(){var e=this.maskStack[this.maskStack.length-1];return e?e._scissorCounter:0},ScissorSystem2.prototype.push=function push(e){var t=e.maskObject;t.renderable=!0;var n=e._scissorRect,a=t.getBounds(!0),l=this.renderer.gl;t.renderable=!1,n?a.fit(n):l.enable(l.SCISSOR_TEST),e._scissorCounter++,e._scissorRect=a,this._useCurrent()},ScissorSystem2.prototype.pop=function pop(){var e=this.renderer.gl;this.getStackLength()>0?this._useCurrent():e.disable(e.SCISSOR_TEST)},ScissorSystem2.prototype._useCurrent=function _useCurrent(){var e=this.maskStack[this.maskStack.length-1]._scissorRect,t=this.renderer.renderTexture.current,n=this.renderer.projection,a=n.transform,l=n.sourceFrame,f=n.destinationFrame,p=t?t.resolution:this.renderer.resolution,h=(e.x-l.x)*p+f.x,m=(e.y-l.y)*p+f.y,g=e.width*p,v=e.height*p;a&&(h+=a.tx*p,m+=a.ty*p),t||(m=this.renderer.height-v-m),this.renderer.gl.scissor(h,m,g,v)},ScissorSystem2}(qc),zc=function(e){function StencilSystem2(t){e.call(this,t),this.glConst=WebGLRenderingContext.STENCIL_TEST}return e&&(StencilSystem2.__proto__=e),StencilSystem2.prototype=Object.create(e&&e.prototype),StencilSystem2.prototype.constructor=StencilSystem2,StencilSystem2.prototype.getStackLength=function getStackLength(){var e=this.maskStack[this.maskStack.length-1];return e?e._stencilCounter:0},StencilSystem2.prototype.push=function push(e){var t=e.maskObject,n=this.renderer.gl,a=e._stencilCounter;0===a&&(this.renderer.framebuffer.forceStencil(),n.enable(n.STENCIL_TEST)),e._stencilCounter++,n.colorMask(!1,!1,!1,!1),n.stencilFunc(n.EQUAL,a,this._getBitwiseMask()),n.stencilOp(n.KEEP,n.KEEP,n.INCR),t.renderable=!0,t.render(this.renderer),this.renderer.batch.flush(),t.renderable=!1,this._useCurrent()},StencilSystem2.prototype.pop=function pop(e){var t=this.renderer.gl;0===this.getStackLength()?(t.disable(t.STENCIL_TEST),t.clear(t.STENCIL_BUFFER_BIT),t.clearStencil(0)):(t.colorMask(!1,!1,!1,!1),t.stencilOp(t.KEEP,t.KEEP,t.DECR),e.renderable=!0,e.render(this.renderer),this.renderer.batch.flush(),e.renderable=!1,this._useCurrent())},StencilSystem2.prototype._useCurrent=function _useCurrent(){var e=this.renderer.gl;e.colorMask(!0,!0,!0,!0),e.stencilFunc(e.EQUAL,this.getStackLength(),this._getBitwiseMask()),e.stencilOp(e.KEEP,e.KEEP,e.KEEP)},StencilSystem2.prototype._getBitwiseMask=function _getBitwiseMask(){return(1<<this.getStackLength())-1},StencilSystem2}(qc),Kc=function(e){function ProjectionSystem2(t){e.call(this,t),this.destinationFrame=null,this.sourceFrame=null,this.defaultFrame=null,this.projectionMatrix=new rs,this.transform=null}return e&&(ProjectionSystem2.__proto__=e),ProjectionSystem2.prototype=Object.create(e&&e.prototype),ProjectionSystem2.prototype.constructor=ProjectionSystem2,ProjectionSystem2.prototype.update=function update5(e,t,n,a){this.destinationFrame=e||this.destinationFrame||this.defaultFrame,this.sourceFrame=t||this.sourceFrame||e,this.calculateProjection(this.destinationFrame,this.sourceFrame,n,a),this.transform&&this.projectionMatrix.append(this.transform);var l=this.renderer;l.globalUniforms.uniforms.projectionMatrix=this.projectionMatrix,l.globalUniforms.update(),l.shader.shader&&l.shader.syncUniformGroup(l.shader.shader.uniforms.globals)},ProjectionSystem2.prototype.calculateProjection=function calculateProjection(e,t,n,a){var l=this.projectionMatrix;a?(l.a=1/e.width*2*n,l.d=-1/e.height*2*n,l.tx=-1-t.x*l.a,l.ty=1-t.y*l.d):(l.a=1/e.width*2*n,l.d=1/e.height*2*n,l.tx=-1-t.x*l.a,l.ty=-1-t.y*l.d)},ProjectionSystem2.prototype.setTransform=function setTransform(){},ProjectionSystem2}(Vs),Zc=new hs,Qc=function(e){function RenderTextureSystem2(t){e.call(this,t),this.clearColor=t._backgroundColorRgba,this.defaultMaskStack=[],this.current=null,this.sourceFrame=new hs,this.destinationFrame=new hs}return e&&(RenderTextureSystem2.__proto__=e),RenderTextureSystem2.prototype=Object.create(e&&e.prototype),RenderTextureSystem2.prototype.constructor=RenderTextureSystem2,RenderTextureSystem2.prototype.bind=function bind2(e,t,n){void 0===e&&(e=null),this.current=e;var a,l=this.renderer;if(e){var f=e.baseTexture;a=f.resolution,n||(Zc.width=f.realWidth,Zc.height=f.realHeight,n=Zc),t||(t=n),this.renderer.framebuffer.bind(f.framebuffer,n),this.renderer.projection.update(n,t,a,!1),this.renderer.mask.setMaskStack(f.maskStack)}else a=this.renderer.resolution,n||(Zc.width=l.width,Zc.height=l.height,n=Zc),t||(t=n),l.framebuffer.bind(null,n),this.renderer.projection.update(n,t,a,!0),this.renderer.mask.setMaskStack(this.defaultMaskStack);this.sourceFrame.copyFrom(t),this.destinationFrame.x=n.x/a,this.destinationFrame.y=n.y/a,this.destinationFrame.width=n.width/a,this.destinationFrame.height=n.height/a,t===n&&this.sourceFrame.copyFrom(this.destinationFrame)},RenderTextureSystem2.prototype.clear=function clear5(e){e=this.current?e||this.current.baseTexture.clearColor:e||this.clearColor,this.renderer.framebuffer.clear(e[0],e[1],e[2],e[3])},RenderTextureSystem2.prototype.resize=function resize3(){this.bind(null)},RenderTextureSystem2.prototype.reset=function reset2(){this.bind(null)},RenderTextureSystem2}(Vs),Xc=function GLProgram2(e,t){this.program=e,this.uniformData=t,this.uniformGroups={}};Xc.prototype.destroy=function destroy8(){this.uniformData=null,this.uniformGroups=null,this.program=null};var Yc=0,Jc={textureCount:0},el=function(e){function ShaderSystem2(t){e.call(this,t),this.systemCheck(),this.gl=null,this.shader=null,this.program=null,this.cache={},this.id=Yc++}return e&&(ShaderSystem2.__proto__=e),ShaderSystem2.prototype=Object.create(e&&e.prototype),ShaderSystem2.prototype.constructor=ShaderSystem2,ShaderSystem2.prototype.systemCheck=function systemCheck(){if(!function unsafeEvalSupported(){if("boolean"==typeof Mc)return Mc;try{var e=new Function("param1","param2","param3","return param1[param2] === param3;");Mc=!0===e({a:"b"},"a","b")}catch(t){Mc=!1}return Mc}())throw new Error("Current environment does not allow unsafe-eval, please use @pixi/unsafe-eval module to enable support.")},ShaderSystem2.prototype.contextChange=function contextChange(e){this.gl=e,this.reset()},ShaderSystem2.prototype.bind=function bind2(e,t){e.uniforms.globals=this.renderer.globalUniforms;var n=e.program,a=n.glPrograms[this.renderer.CONTEXT_UID]||this.generateShader(e);return this.shader=e,this.program!==n&&(this.program=n,this.gl.useProgram(a.program)),t||(Jc.textureCount=0,this.syncUniformGroup(e.uniformGroup,Jc)),a},ShaderSystem2.prototype.setUniforms=function setUniforms(e){var t=this.shader.program,n=t.glPrograms[this.renderer.CONTEXT_UID];t.syncUniforms(n.uniformData,e,this.renderer)},ShaderSystem2.prototype.syncUniformGroup=function syncUniformGroup(e,t){var n=this.getglProgram();e.static&&e.dirtyId===n.uniformGroups[e.id]||(n.uniformGroups[e.id]=e.dirtyId,this.syncUniforms(e,n,t))},ShaderSystem2.prototype.syncUniforms=function syncUniforms(e,t,n){(e.syncUniforms[this.shader.program.id]||this.createSyncGroups(e))(t.uniformData,e.uniforms,this.renderer,n)},ShaderSystem2.prototype.createSyncGroups=function createSyncGroups(e){var t=this.getSignature(e,this.shader.program.uniformData);return this.cache[t]||(this.cache[t]=function generateUniformsSync(e,t){var n="var v = null;\n    var cv = null\n    var t = 0;\n    var gl = renderer.gl\n    ";for(var a in e.uniforms){var l=t[a];l?"float"===l.type&&1===l.size?n+="\n            if(uv."+a+" !== ud."+a+".value)\n            {\n                ud."+a+".value = uv."+a+"\n                gl.uniform1f(ud."+a+".location, uv."+a+")\n            }\n":"sampler2D"!==l.type&&"samplerCube"!==l.type&&"sampler2DArray"!==l.type||1!==l.size||l.isArray?"mat3"===l.type&&1===l.size?void 0!==e.uniforms[a].a?n+="\n                gl.uniformMatrix3fv(ud."+a+".location, false, uv."+a+".toArray(true));\n                \n":n+="\n                gl.uniformMatrix3fv(ud."+a+".location, false, uv."+a+");\n                \n":"vec2"===l.type&&1===l.size?void 0!==e.uniforms[a].x?n+="\n                cv = ud."+a+".value;\n                v = uv."+a+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    gl.uniform2f(ud."+a+".location, v.x, v.y);\n                }\n":n+="\n                cv = ud."+a+".value;\n                v = uv."+a+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    gl.uniform2f(ud."+a+".location, v[0], v[1]);\n                }\n                \n":"vec4"===l.type&&1===l.size?void 0!==e.uniforms[a].width?n+="\n                cv = ud."+a+".value;\n                v = uv."+a+";\n\n                if(cv[0] !== v.x || cv[1] !== v.y || cv[2] !== v.width || cv[3] !== v.height)\n                {\n                    cv[0] = v.x;\n                    cv[1] = v.y;\n                    cv[2] = v.width;\n                    cv[3] = v.height;\n                    gl.uniform4f(ud."+a+".location, v.x, v.y, v.width, v.height)\n                }\n":n+="\n                cv = ud."+a+".value;\n                v = uv."+a+";\n\n                if(cv[0] !== v[0] || cv[1] !== v[1] || cv[2] !== v[2] || cv[3] !== v[3])\n                {\n                    cv[0] = v[0];\n                    cv[1] = v[1];\n                    cv[2] = v[2];\n                    cv[3] = v[3];\n\n                    gl.uniform4f(ud."+a+".location, v[0], v[1], v[2], v[3])\n                }\n                \n":n+="\n            cv = ud."+a+".value;\n            v = uv."+a+";\n            "+(1===l.size?Ec:Ac)[l.type].replace("location","ud."+a+".location")+";\n":n+="\n\n            t = syncData.textureCount++;\n\n            renderer.texture.bind(uv."+a+", t);\n            \n            if(ud."+a+".value !== t)\n            {\n                ud."+a+".value = t;\n                gl.uniform1i(ud."+a+".location, t);\n; // eslint-disable-line max-len\n            }\n":e.uniforms[a].group&&(n+="\n                    renderer.shader.syncUniformGroup(uv."+a+", syncData);\n                ")}return new Function("ud","uv","renderer","syncData",n)}(e,this.shader.program.uniformData)),e.syncUniforms[this.shader.program.id]=this.cache[t],e.syncUniforms[this.shader.program.id]},ShaderSystem2.prototype.getSignature=function getSignature(e,t){var n=e.uniforms,a=[];for(var l in n)a.push(l),t[l]&&a.push(t[l].type);return a.join("-")},ShaderSystem2.prototype.getglProgram=function getglProgram(){return this.shader?this.shader.program.glPrograms[this.renderer.CONTEXT_UID]:null},ShaderSystem2.prototype.generateShader=function generateShader2(e){var t=this.gl,n=e.program,a={};for(var l in n.attributeData)a[l]=n.attributeData[l].location;var f=compileProgram(t,n.vertexSrc,n.fragmentSrc,a),p={};for(var h in n.uniformData){var m=n.uniformData[h];p[h]={location:t.getUniformLocation(f,h),value:defaultValue(m.type,m.size)}}var g=new Xc(f,p);return n.glPrograms[this.renderer.CONTEXT_UID]=g,g},ShaderSystem2.prototype.reset=function reset2(){this.program=null,this.shader=null},ShaderSystem2.prototype.destroy=function destroy10(){this.destroyed=!0},ShaderSystem2}(Vs);var tl=function(e){function StateSystem2(t){e.call(this,t),this.gl=null,this.stateId=0,this.polygonOffset=0,this.blendMode=ra.NONE,this._blendEq=!1,this.map=[],this.map[0]=this.setBlend,this.map[1]=this.setOffset,this.map[2]=this.setCullFace,this.map[3]=this.setDepthTest,this.map[4]=this.setFrontFace,this.checks=[],this.defaultState=new Bc,this.defaultState.blend=!0,this.defaultState.depth=!0}return e&&(StateSystem2.__proto__=e),StateSystem2.prototype=Object.create(e&&e.prototype),StateSystem2.prototype.constructor=StateSystem2,StateSystem2.prototype.contextChange=function contextChange(e){this.gl=e,this.blendModes=function mapWebGLBlendModesToPixi(e,t){return void 0===t&&(t=[]),t[ra.NORMAL]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ra.ADD]=[e.ONE,e.ONE],t[ra.MULTIPLY]=[e.DST_COLOR,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ra.SCREEN]=[e.ONE,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ra.OVERLAY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ra.DARKEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ra.LIGHTEN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ra.COLOR_DODGE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ra.COLOR_BURN]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ra.HARD_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ra.SOFT_LIGHT]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ra.DIFFERENCE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ra.EXCLUSION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ra.HUE]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ra.SATURATION]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ra.COLOR]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ra.LUMINOSITY]=[e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ra.NONE]=[0,0],t[ra.NORMAL_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_ALPHA,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ra.ADD_NPM]=[e.SRC_ALPHA,e.ONE,e.ONE,e.ONE],t[ra.SCREEN_NPM]=[e.SRC_ALPHA,e.ONE_MINUS_SRC_COLOR,e.ONE,e.ONE_MINUS_SRC_ALPHA],t[ra.SRC_IN]=[e.DST_ALPHA,e.ZERO],t[ra.SRC_OUT]=[e.ONE_MINUS_DST_ALPHA,e.ZERO],t[ra.SRC_ATOP]=[e.DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[ra.DST_OVER]=[e.ONE_MINUS_DST_ALPHA,e.ONE],t[ra.DST_IN]=[e.ZERO,e.SRC_ALPHA],t[ra.DST_OUT]=[e.ZERO,e.ONE_MINUS_SRC_ALPHA],t[ra.DST_ATOP]=[e.ONE_MINUS_DST_ALPHA,e.SRC_ALPHA],t[ra.XOR]=[e.ONE_MINUS_DST_ALPHA,e.ONE_MINUS_SRC_ALPHA],t[ra.SUBTRACT]=[e.ONE,e.ONE,e.ONE,e.ONE,e.FUNC_REVERSE_SUBTRACT,e.FUNC_ADD],t}(e),this.set(this.defaultState),this.reset()},StateSystem2.prototype.set=function set3(e){if(e=e||this.defaultState,this.stateId!==e.data){for(var t=this.stateId^e.data,n=0;t;)1&t&&this.map[n].call(this,!!(e.data&1<<n)),t>>=1,n++;this.stateId=e.data}for(var a=0;a<this.checks.length;a++)this.checks[a](this,e)},StateSystem2.prototype.forceState=function forceState(e){e=e||this.defaultState;for(var t=0;t<this.map.length;t++)this.map[t].call(this,!!(e.data&1<<t));for(var n=0;n<this.checks.length;n++)this.checks[n](this,e);this.stateId=e.data},StateSystem2.prototype.setBlend=function setBlend(e){this.updateCheck(StateSystem2.checkBlendMode,e),this.gl[e?"enable":"disable"](this.gl.BLEND)},StateSystem2.prototype.setOffset=function setOffset(e){this.updateCheck(StateSystem2.checkPolygonOffset,e),this.gl[e?"enable":"disable"](this.gl.POLYGON_OFFSET_FILL)},StateSystem2.prototype.setDepthTest=function setDepthTest(e){this.gl[e?"enable":"disable"](this.gl.DEPTH_TEST)},StateSystem2.prototype.setCullFace=function setCullFace(e){this.gl[e?"enable":"disable"](this.gl.CULL_FACE)},StateSystem2.prototype.setFrontFace=function setFrontFace(e){this.gl.frontFace(this.gl[e?"CW":"CCW"])},StateSystem2.prototype.setBlendMode=function setBlendMode(e){if(e!==this.blendMode){this.blendMode=e;var t=this.blendModes[e],n=this.gl;2===t.length?n.blendFunc(t[0],t[1]):n.blendFuncSeparate(t[0],t[1],t[2],t[3]),6===t.length?(this._blendEq=!0,n.blendEquationSeparate(t[4],t[5])):this._blendEq&&(this._blendEq=!1,n.blendEquationSeparate(n.FUNC_ADD,n.FUNC_ADD))}},StateSystem2.prototype.setPolygonOffset=function setPolygonOffset(e,t){this.gl.polygonOffset(e,t)},StateSystem2.prototype.reset=function reset2(){this.gl.pixelStorei(this.gl.UNPACK_FLIP_Y_WEBGL,!1),this.forceState(0),this._blendEq=!0,this.blendMode=-1,this.setBlendMode(0)},StateSystem2.prototype.updateCheck=function updateCheck(e,t){var n=this.checks.indexOf(e);t&&-1===n?this.checks.push(e):t||-1===n||this.checks.splice(n,1)},StateSystem2.checkBlendMode=function checkBlendMode(e,t){e.setBlendMode(t.blendMode)},StateSystem2.checkPolygonOffset=function checkPolygonOffset(e,t){e.setPolygonOffset(t.polygonOffset,0)},StateSystem2}(Vs),nl=function(e){function TextureGCSystem2(t){e.call(this,t),this.count=0,this.checkCount=0,this.maxIdle=Vi.GC_MAX_IDLE,this.checkCountMax=Vi.GC_MAX_CHECK_COUNT,this.mode=Vi.GC_MODE}return e&&(TextureGCSystem2.__proto__=e),TextureGCSystem2.prototype=Object.create(e&&e.prototype),TextureGCSystem2.prototype.constructor=TextureGCSystem2,TextureGCSystem2.prototype.postrender=function postrender(){this.renderer.renderingToScreen&&(this.count++,this.mode!==Ca.MANUAL&&(this.checkCount++,this.checkCount>this.checkCountMax&&(this.checkCount=0,this.run())))},TextureGCSystem2.prototype.run=function run2(){for(var e=this.renderer.texture,t=e.managedTextures,n=!1,a=0;a<t.length;a++){var l=t[a];!l.framebuffer&&this.count-l.touched>this.maxIdle&&(e.destroyTexture(l,!0),t[a]=null,n=!0)}if(n){for(var f=0,p=0;p<t.length;p++)null!==t[p]&&(t[f++]=t[p]);t.length=f}},TextureGCSystem2.prototype.unload=function unload(e){var t=this.renderer.textureSystem;e._texture&&e._texture._glRenderTargets&&t.destroyTexture(e._texture);for(var n=e.children.length-1;n>=0;n--)this.unload(e.children[n])},TextureGCSystem2}(Vs),rl=function GLTexture2(e){this.texture=e,this.width=-1,this.height=-1,this.dirtyId=-1,this.dirtyStyleId=-1,this.mipmap=!1,this.wrapMode=33071,this.type=6408,this.internalFormat=5121},ol=function(e){function TextureSystem2(t){e.call(this,t),this.boundTextures=[],this.currentLocation=-1,this.managedTextures=[],this._unknownBoundTextures=!1,this.unknownTexture=new Ns}return e&&(TextureSystem2.__proto__=e),TextureSystem2.prototype=Object.create(e&&e.prototype),TextureSystem2.prototype.constructor=TextureSystem2,TextureSystem2.prototype.contextChange=function contextChange(){var e=this.gl=this.renderer.gl;this.CONTEXT_UID=this.renderer.CONTEXT_UID,this.webGLVersion=this.renderer.context.webGLVersion;var t=e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS);this.boundTextures.length=t;for(var n=0;n<t;n++)this.boundTextures[n]=null;this.emptyTextures={};var a=new rl(e.createTexture());e.bindTexture(e.TEXTURE_2D,a.texture),e.texImage2D(e.TEXTURE_2D,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,new Uint8Array(4)),this.emptyTextures[e.TEXTURE_2D]=a,this.emptyTextures[e.TEXTURE_CUBE_MAP]=new rl(e.createTexture()),e.bindTexture(e.TEXTURE_CUBE_MAP,this.emptyTextures[e.TEXTURE_CUBE_MAP].texture);for(var l=0;l<6;l++)e.texImage2D(e.TEXTURE_CUBE_MAP_POSITIVE_X+l,0,e.RGBA,1,1,0,e.RGBA,e.UNSIGNED_BYTE,null);e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MAG_FILTER,e.LINEAR),e.texParameteri(e.TEXTURE_CUBE_MAP,e.TEXTURE_MIN_FILTER,e.LINEAR);for(var f=0;f<this.boundTextures.length;f++)this.bind(null,f)},TextureSystem2.prototype.bind=function bind2(e,t){void 0===t&&(t=0);var n=this.gl;if(e){if((e=e.baseTexture||e).valid){e.touched=this.renderer.textureGC.count;var a=e._glTextures[this.CONTEXT_UID]||this.initTexture(e);this.boundTextures[t]!==e&&(this.currentLocation!==t&&(this.currentLocation=t,n.activeTexture(n.TEXTURE0+t)),n.bindTexture(e.target,a.texture)),a.dirtyId!==e.dirtyId&&(this.currentLocation!==t&&(this.currentLocation=t,n.activeTexture(n.TEXTURE0+t)),this.updateTexture(e)),this.boundTextures[t]=e}}else this.currentLocation!==t&&(this.currentLocation=t,n.activeTexture(n.TEXTURE0+t)),n.bindTexture(n.TEXTURE_2D,this.emptyTextures[n.TEXTURE_2D].texture),this.boundTextures[t]=null},TextureSystem2.prototype.reset=function reset2(){this._unknownBoundTextures=!0,this.currentLocation=-1;for(var e=0;e<this.boundTextures.length;e++)this.boundTextures[e]=this.unknownTexture},TextureSystem2.prototype.unbind=function unbind2(e){var t=this.gl,n=this.boundTextures;if(this._unknownBoundTextures){this._unknownBoundTextures=!1;for(var a=0;a<n.length;a++)n[a]===this.unknownTexture&&this.bind(null,a)}for(var l=0;l<n.length;l++)n[l]===e&&(this.currentLocation!==l&&(t.activeTexture(t.TEXTURE0+l),this.currentLocation=l),t.bindTexture(t.TEXTURE_2D,this.emptyTextures[e.target].texture),n[l]=null)},TextureSystem2.prototype.initTexture=function initTexture(e){var t=new rl(this.gl.createTexture());return t.dirtyId=-1,e._glTextures[this.CONTEXT_UID]=t,this.managedTextures.push(e),e.on("dispose",this.destroyTexture,this),t},TextureSystem2.prototype.initTextureType=function initTextureType(e,t){if(t.internalFormat=e.format,t.type=e.type,2===this.webGLVersion){var n=this.renderer.gl;e.type===n.FLOAT&&e.format===n.RGBA&&(t.internalFormat=n.RGBA32F),e.type===da.HALF_FLOAT&&(t.type=n.HALF_FLOAT),t.type===n.HALF_FLOAT&&e.format===n.RGBA&&(t.internalFormat=n.RGBA16F)}},TextureSystem2.prototype.updateTexture=function updateTexture(e){var t=e._glTextures[this.CONTEXT_UID];if(t){var n=this.renderer;if(this.initTextureType(e,t),e.resource&&e.resource.upload(n,e,t));else{var a=e.realWidth,l=e.realHeight,f=n.gl;(t.width!==a||t.height!==l||t.dirtyId<0)&&(t.width=a,t.height=l,f.texImage2D(e.target,0,t.internalFormat,a,l,0,e.format,t.type,null))}e.dirtyStyleId!==t.dirtyStyleId&&this.updateTextureStyle(e),t.dirtyId=e.dirtyId}},TextureSystem2.prototype.destroyTexture=function destroyTexture(e,t){var n=this.gl;if((e=e.baseTexture||e)._glTextures[this.CONTEXT_UID]&&(this.unbind(e),n.deleteTexture(e._glTextures[this.CONTEXT_UID].texture),e.off("dispose",this.destroyTexture,this),delete e._glTextures[this.CONTEXT_UID],!t)){var a=this.managedTextures.indexOf(e);-1!==a&&removeItems(this.managedTextures,a,1)}},TextureSystem2.prototype.updateTextureStyle=function updateTextureStyle(e){var t=e._glTextures[this.CONTEXT_UID];t&&(e.mipmap!==va.POW2&&2===this.webGLVersion||e.isPowerOfTwo?t.mipmap=e.mipmap>=1:t.mipmap=0,2===this.webGLVersion||e.isPowerOfTwo?t.wrapMode=e.wrapMode:t.wrapMode=ma.CLAMP,e.resource&&e.resource.style(this.renderer,e,t)||this.setStyle(e,t),t.dirtyStyleId=e.dirtyStyleId)},TextureSystem2.prototype.setStyle=function setStyle(e,t){var n=this.gl;if(t.mipmap&&n.generateMipmap(e.target),n.texParameteri(e.target,n.TEXTURE_WRAP_S,t.wrapMode),n.texParameteri(e.target,n.TEXTURE_WRAP_T,t.wrapMode),t.mipmap){n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode?n.LINEAR_MIPMAP_LINEAR:n.NEAREST_MIPMAP_NEAREST);var a=this.renderer.context.extensions.anisotropicFiltering;if(a&&e.anisotropicLevel>0&&e.scaleMode===pa.LINEAR){var l=Math.min(e.anisotropicLevel,n.getParameter(a.MAX_TEXTURE_MAX_ANISOTROPY_EXT));n.texParameterf(e.target,a.TEXTURE_MAX_ANISOTROPY_EXT,l)}}else n.texParameteri(e.target,n.TEXTURE_MIN_FILTER,e.scaleMode?n.LINEAR:n.NEAREST);n.texParameteri(e.target,n.TEXTURE_MAG_FILTER,e.scaleMode?n.LINEAR:n.NEAREST)},TextureSystem2}(Vs),il=new rs,al=function(e){function Renderer2(t){void 0===t&&(t={}),e.call(this,"WebGL",t),t=this.options,this.type=ta.WEBGL,this.gl=null,this.CONTEXT_UID=0,this.runners={destroy:new Es("destroy"),contextChange:new Es("contextChange",1),reset:new Es("reset"),update:new Es("update"),postrender:new Es("postrender"),prerender:new Es("prerender"),resize:new Es("resize",2)},this.globalUniforms=new lc({projectionMatrix:new rs},!0),this.addSystem(Gc,"mask").addSystem(mc,"context").addSystem(tl,"state").addSystem(el,"shader").addSystem(ol,"texture").addSystem(_c,"geometry").addSystem(gc,"framebuffer").addSystem(Wc,"scissor").addSystem(zc,"stencil").addSystem(Kc,"projection").addSystem(nl,"textureGC").addSystem(dc,"filter").addSystem(Qc,"renderTexture").addSystem(pc,"batch"),this.initPlugins(Renderer2.__plugins),t.context?this.context.initFromContext(t.context):this.context.initFromOptions({alpha:this.transparent,antialias:t.antialias,premultipliedAlpha:this.transparent&&"notMultiplied"!==this.transparent,stencil:!0,preserveDrawingBuffer:t.preserveDrawingBuffer,powerPreference:this.options.powerPreference}),this.renderingToScreen=!0,function sayHello(e){var t;if(!Ha){if(navigator.userAgent.toLowerCase().indexOf("chrome")>-1){var n=["\n %c %c %c PixiJS 5.2.1 -  "+e+"   %c  %c  http://www.pixijs.com/  %c %c %c%c \n\n","background: #ff66a5; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff66a5; background: #030307; padding:5px 0;","background: #ff66a5; padding:5px 0;","background: #ffc3dc; padding:5px 0;","background: #ff66a5; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;","color: #ff2424; background: #fff; padding:5px 0;"];(t=window.console).log.apply(t,n)}else window.console&&window.console.log("PixiJS 5.2.1 - "+e+" - http://www.pixijs.com/");Ha=!0}}(2===this.context.webGLVersion?"WebGL 2":"WebGL 1"),this.resize(this.options.width,this.options.height)}return e&&(Renderer2.__proto__=e),Renderer2.prototype=Object.create(e&&e.prototype),Renderer2.prototype.constructor=Renderer2,Renderer2.create=function create3(e){if(function isWebGLSupported(){return void 0===$a&&($a=function supported2(){var e={stencil:!0,failIfMajorPerformanceCaveat:Vi.FAIL_IF_MAJOR_PERFORMANCE_CAVEAT};try{if(!window.WebGLRenderingContext)return!1;var t=document.createElement("canvas"),n=t.getContext("webgl",e)||t.getContext("experimental-webgl",e),a=!(!n||!n.getContextAttributes().stencil);if(n){var l=n.getExtension("WEBGL_lose_context");l&&l.loseContext()}return n=null,a}catch(f){return!1}}()),$a}())return new Renderer2(e);throw new Error('WebGL unsupported in this browser, use "pixi.js-legacy" for fallback canvas2d support.')},Renderer2.prototype.addSystem=function addSystem(e,t){t||(t=e.name);var n=new e(this);if(this[t])throw new Error('Whoops! The name "'+t+'" is already in use');for(var a in this[t]=n,this.runners)this.runners[a].add(n);return this},Renderer2.prototype.render=function render2(e,t,n,a,l){if(this.renderingToScreen=!t,this.runners.prerender.run(),this.emit("prerender"),this.projection.transform=a,!this.context.isLost){if(t||(this._lastObjectRendered=e),!l){var f=e.parent;e.parent=this._tempDisplayObjectParent,e.updateTransform(),e.parent=f}this.renderTexture.bind(t),this.batch.currentRenderer.start(),(void 0!==n?n:this.clearBeforeRender)&&this.renderTexture.clear(),e.render(this),this.batch.currentRenderer.flush(),t&&t.baseTexture.update(),this.runners.postrender.run(),this.projection.transform=null,this.emit("postrender")}},Renderer2.prototype.resize=function resize3(t,n){e.prototype.resize.call(this,t,n),this.runners.resize.run(t,n)},Renderer2.prototype.reset=function reset2(){return this.runners.reset.run(),this},Renderer2.prototype.clear=function clear5(){this.framebuffer.bind(),this.framebuffer.clear()},Renderer2.prototype.destroy=function destroy10(t){for(var n in this.runners.destroy.run(),this.runners)this.runners[n].destroy();e.prototype.destroy.call(this,t),this.gl=null},Renderer2.registerPlugin=function registerPlugin(e,t){Renderer2.__plugins=Renderer2.__plugins||{},Renderer2.__plugins[e]=t},Renderer2}(function(e){function AbstractRenderer2(t,n){e.call(this),(n=Object.assign({},Vi.RENDER_OPTIONS,n)).roundPixels&&(Vi.ROUND_PIXELS=n.roundPixels,deprecation("5.0.0","Renderer roundPixels option is deprecated, please use PIXI.settings.ROUND_PIXELS",2)),this.options=n,this.type=ta.UNKNOWN,this.screen=new hs(0,0,n.width,n.height),this.view=n.view||document.createElement("canvas"),this.resolution=n.resolution||Vi.RESOLUTION,this.transparent=n.transparent,this.autoDensity=n.autoDensity||n.autoResize||!1,this.preserveDrawingBuffer=n.preserveDrawingBuffer,this.clearBeforeRender=n.clearBeforeRender,this._backgroundColor=0,this._backgroundColorRgba=[0,0,0,0],this._backgroundColorString="#000000",this.backgroundColor=n.backgroundColor||this._backgroundColor,this._tempDisplayObjectParent=new ks,this._lastObjectRendered=this._tempDisplayObjectParent,this.plugins={}}e&&(AbstractRenderer2.__proto__=e),AbstractRenderer2.prototype=Object.create(e&&e.prototype),AbstractRenderer2.prototype.constructor=AbstractRenderer2;var t={width:{configurable:!0},height:{configurable:!0},backgroundColor:{configurable:!0}};return AbstractRenderer2.prototype.initPlugins=function initPlugins(e){for(var t in e)this.plugins[t]=new e[t](this)},t.width.get=function(){return this.view.width},t.height.get=function(){return this.view.height},AbstractRenderer2.prototype.resize=function resize3(e,t){this.screen.width=e,this.screen.height=t,this.view.width=e*this.resolution,this.view.height=t*this.resolution,this.autoDensity&&(this.view.style.width=e+"px",this.view.style.height=t+"px")},AbstractRenderer2.prototype.generateTexture=function generateTexture(e,t,n,a){0===(a=a||e.getLocalBounds()).width&&(a.width=1),0===a.height&&(a.height=1);var l=Qs.create(0|a.width,0|a.height,t,n);return il.tx=-a.x,il.ty=-a.y,this.render(e,l,!1,il,!!e.parent),l},AbstractRenderer2.prototype.destroy=function destroy10(e){for(var t in this.plugins)this.plugins[t].destroy(),this.plugins[t]=null;e&&this.view.parentNode&&this.view.parentNode.removeChild(this.view),this.plugins=null,this.type=ta.UNKNOWN,this.view=null,this.screen=null,this.resolution=0,this.transparent=!1,this.autoDensity=!1,this.blendModes=null,this.options=null,this.preserveDrawingBuffer=!1,this.clearBeforeRender=!1,this._backgroundColor=0,this._backgroundColorRgba=null,this._backgroundColorString=null,this._tempDisplayObjectParent=null,this._lastObjectRendered=null},t.backgroundColor.get=function(){return this._backgroundColor},t.backgroundColor.set=function(e){this._backgroundColor=e,this._backgroundColorString=hex2string(e),hex2rgb(e,this._backgroundColorRgba)},Object.defineProperties(AbstractRenderer2.prototype,t),AbstractRenderer2}(Gi));function autoDetectRenderer(e){return al.create(e)}var sl=function BatchDrawCall2(){this.texArray=null,this.blend=0,this.type=ia.TRIANGLES,this.start=0,this.size=0,this.data=null},cl=function BatchTextureArray2(){this.elements=[],this.ids=[],this.count=0};cl.prototype.clear=function clear4(){for(var e=0;e<this.count;e++)this.elements[e]=null;this.count=0};var ll=function ViewableBuffer2(e){this.rawBinaryData=new ArrayBuffer(e),this.uint32View=new Uint32Array(this.rawBinaryData),this.float32View=new Float32Array(this.rawBinaryData)},ul={int8View:{configurable:!0},uint8View:{configurable:!0},int16View:{configurable:!0},uint16View:{configurable:!0},int32View:{configurable:!0}};ul.int8View.get=function(){return this._int8View||(this._int8View=new Int8Array(this.rawBinaryData)),this._int8View},ul.uint8View.get=function(){return this._uint8View||(this._uint8View=new Uint8Array(this.rawBinaryData)),this._uint8View},ul.int16View.get=function(){return this._int16View||(this._int16View=new Int16Array(this.rawBinaryData)),this._int16View},ul.uint16View.get=function(){return this._uint16View||(this._uint16View=new Uint16Array(this.rawBinaryData)),this._uint16View},ul.int32View.get=function(){return this._int32View||(this._int32View=new Int32Array(this.rawBinaryData)),this._int32View},ll.prototype.view=function view(e){return this[e+"View"]},ll.prototype.destroy=function destroy9(){this.rawBinaryData=null,this._int8View=null,this._uint8View=null,this._int16View=null,this._uint16View=null,this._int32View=null,this.uint32View=null,this.float32View=null},ll.sizeOf=function sizeOf(e){switch(e){case"int8":case"uint8":return 1;case"int16":case"uint16":return 2;case"int32":case"uint32":case"float32":return 4;default:throw new Error(e+" isn't a valid view type")}},Object.defineProperties(ll.prototype,ul);var dl=function(e){function AbstractBatchRenderer2(t){e.call(this,t),this.shaderGenerator=null,this.geometryClass=null,this.vertexSize=null,this.state=Bc.for2d(),this.size=4*Vi.SPRITE_BATCH_SIZE,this._vertexCount=0,this._indexCount=0,this._bufferedElements=[],this._bufferedTextures=[],this._bufferSize=0,this._shader=null,this._packedGeometries=[],this._packedGeometryPoolSize=2,this._flushId=0,this._aBuffers={},this._iBuffers={},this.MAX_TEXTURES=1,this.renderer.on("prerender",this.onPrerender,this),t.runners.contextChange.add(this),this._dcIndex=0,this._aIndex=0,this._iIndex=0,this._attributeBuffer=null,this._indexBuffer=null,this._tempBoundTextures=[]}return e&&(AbstractBatchRenderer2.__proto__=e),AbstractBatchRenderer2.prototype=Object.create(e&&e.prototype),AbstractBatchRenderer2.prototype.constructor=AbstractBatchRenderer2,AbstractBatchRenderer2.prototype.contextChange=function contextChange(){var e=this.renderer.gl;Vi.PREFER_ENV===Ji.WEBGL_LEGACY?this.MAX_TEXTURES=1:(this.MAX_TEXTURES=Math.min(e.getParameter(e.MAX_TEXTURE_IMAGE_UNITS),Vi.SPRITE_MAX_TEXTURES),this.MAX_TEXTURES=function checkMaxIfStatementsInShader(e,t){if(0===e)throw new Error("Invalid value of `0` passed to `checkMaxIfStatementsInShader`");for(var n=t.createShader(t.FRAGMENT_SHADER);;){var a=xc.replace(/%forloop%/gi,generateIfTestSrc(e));if(t.shaderSource(n,a),t.compileShader(n),t.getShaderParameter(n,t.COMPILE_STATUS))break;e=e/2|0}return e}(this.MAX_TEXTURES,e)),this._shader=this.shaderGenerator.generateShader(this.MAX_TEXTURES);for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]=new this.geometryClass;this.initFlushBuffers()},AbstractBatchRenderer2.prototype.initFlushBuffers=function initFlushBuffers(){for(var e=AbstractBatchRenderer2._drawCallPool,t=AbstractBatchRenderer2._textureArrayPool,n=this.size/4,a=Math.floor(n/this.MAX_TEXTURES)+1;e.length<n;)e.push(new sl);for(;t.length<a;)t.push(new cl);for(var l=0;l<this.MAX_TEXTURES;l++)this._tempBoundTextures[l]=null},AbstractBatchRenderer2.prototype.onPrerender=function onPrerender(){this._flushId=0},AbstractBatchRenderer2.prototype.render=function render2(e){e._texture.valid&&(this._vertexCount+e.vertexData.length/2>this.size&&this.flush(),this._vertexCount+=e.vertexData.length/2,this._indexCount+=e.indices.length,this._bufferedTextures[this._bufferSize]=e._texture.baseTexture,this._bufferedElements[this._bufferSize++]=e)},AbstractBatchRenderer2.prototype.buildTexturesAndDrawCalls=function buildTexturesAndDrawCalls(){var e=this._bufferedTextures,t=this.MAX_TEXTURES,n=AbstractBatchRenderer2._textureArrayPool,a=this.renderer.batch,l=this._tempBoundTextures,f=this.renderer.textureGC.count,p=++Ns._globalBatch,h=0,m=n[0],g=0;a.copyBoundTextures(l,t);for(var v=0;v<this._bufferSize;++v){var y=e[v];e[v]=null,y._batchEnabled!==p&&(m.count>=t&&(a.boundArray(m,l,p,t),this.buildDrawCalls(m,g,v),g=v,m=n[++h],++p),y._batchEnabled=p,y.touched=f,m.elements[m.count++]=y)}m.count>0&&(a.boundArray(m,l,p,t),this.buildDrawCalls(m,g,this._bufferSize),++h,++p);for(var _=0;_<l.length;_++)l[_]=null;Ns._globalBatch=p},AbstractBatchRenderer2.prototype.buildDrawCalls=function buildDrawCalls(e,t,n){var a=this,l=a._bufferedElements,f=a._attributeBuffer,p=a._indexBuffer,h=a.vertexSize,m=AbstractBatchRenderer2._drawCallPool,g=this._dcIndex,v=this._aIndex,y=this._iIndex,_=m[g];_.start=this._iIndex,_.texArray=e;for(var b=t;b<n;++b){var C=l[b],S=C._texture.baseTexture,k=Va[S.alphaMode?1:0][C.blendMode];l[b]=null,t<b&&_.blend!==k&&(_.size=y-_.start,t=b,(_=m[++g]).texArray=e,_.start=y),this.packInterleavedGeometry(C,f,p,v,y),v+=C.vertexData.length/2*h,y+=C.indices.length,_.blend=k}t<n&&(_.size=y-_.start,++g),this._dcIndex=g,this._aIndex=v,this._iIndex=y},AbstractBatchRenderer2.prototype.bindAndClearTexArray=function bindAndClearTexArray(e){for(var t=this.renderer.texture,n=0;n<e.count;n++)t.bind(e.elements[n],e.ids[n]),e.elements[n]=null;e.count=0},AbstractBatchRenderer2.prototype.updateGeometry=function updateGeometry(){var e=this,t=e._packedGeometries,n=e._attributeBuffer,a=e._indexBuffer;Vi.CAN_UPLOAD_SAME_BUFFER?(t[this._flushId]._buffer.update(n.rawBinaryData),t[this._flushId]._indexBuffer.update(a),this.renderer.geometry.updateBuffers()):(this._packedGeometryPoolSize<=this._flushId&&(this._packedGeometryPoolSize++,t[this._flushId]=new this.geometryClass),t[this._flushId]._buffer.update(n.rawBinaryData),t[this._flushId]._indexBuffer.update(a),this.renderer.geometry.bind(t[this._flushId]),this.renderer.geometry.updateBuffers(),this._flushId++)},AbstractBatchRenderer2.prototype.drawBatches=function drawBatches(){for(var e=this._dcIndex,t=this.renderer,n=t.gl,a=t.state,l=AbstractBatchRenderer2._drawCallPool,f=null,p=0;p<e;p++){var h=l[p],m=h.texArray,g=h.type,v=h.size,y=h.start,_=h.blend;f!==m&&(f=m,this.bindAndClearTexArray(m)),this.state.blendMode=_,a.set(this.state),n.drawElements(g,v,n.UNSIGNED_SHORT,2*y)}},AbstractBatchRenderer2.prototype.flush=function flush2(){0!==this._vertexCount&&(this._attributeBuffer=this.getAttributeBuffer(this._vertexCount),this._indexBuffer=this.getIndexBuffer(this._indexCount),this._aIndex=0,this._iIndex=0,this._dcIndex=0,this.buildTexturesAndDrawCalls(),this.updateGeometry(),this.drawBatches(),this._bufferSize=0,this._vertexCount=0,this._indexCount=0)},AbstractBatchRenderer2.prototype.start=function start2(){this.renderer.state.set(this.state),this.renderer.shader.bind(this._shader),Vi.CAN_UPLOAD_SAME_BUFFER&&this.renderer.geometry.bind(this._packedGeometries[this._flushId])},AbstractBatchRenderer2.prototype.stop=function stop2(){this.flush()},AbstractBatchRenderer2.prototype.destroy=function destroy10(){for(var t=0;t<this._packedGeometryPoolSize;t++)this._packedGeometries[t]&&this._packedGeometries[t].destroy();this.renderer.off("prerender",this.onPrerender,this),this._aBuffers=null,this._iBuffers=null,this._packedGeometries=null,this._attributeBuffer=null,this._indexBuffer=null,this._shader&&(this._shader.destroy(),this._shader=null),e.prototype.destroy.call(this)},AbstractBatchRenderer2.prototype.getAttributeBuffer=function getAttributeBuffer(e){var t=nextPow2(Math.ceil(e/8)),n=log2(t),a=8*t;this._aBuffers.length<=n&&(this._iBuffers.length=n+1);var l=this._aBuffers[a];return l||(this._aBuffers[a]=l=new ll(a*this.vertexSize*4)),l},AbstractBatchRenderer2.prototype.getIndexBuffer=function getIndexBuffer(e){var t=nextPow2(Math.ceil(e/12)),n=log2(t),a=12*t;this._iBuffers.length<=n&&(this._iBuffers.length=n+1);var l=this._iBuffers[n];return l||(this._iBuffers[n]=l=new Uint16Array(a)),l},AbstractBatchRenderer2.prototype.packInterleavedGeometry=function packInterleavedGeometry(e,t,n,a,l){for(var f=t.uint32View,p=t.float32View,h=a/this.vertexSize,m=e.uvs,g=e.indices,v=e.vertexData,y=e._texture.baseTexture._batchLocation,_=Math.min(e.worldAlpha,1),b=_<1&&e._texture.baseTexture.alphaMode?premultiplyTint(e._tintRGB,_):e._tintRGB+(255*_<<24),C=0;C<v.length;C+=2)p[a++]=v[C],p[a++]=v[C+1],p[a++]=m[C],p[a++]=m[C+1],f[a++]=b,p[a++]=y;for(var S=0;S<g.length;S++)n[l++]=h+g[S]},AbstractBatchRenderer2}(fc);dl._drawCallPool=[],dl._textureArrayPool=[];var fl=function BatchShaderGenerator2(e,t){if(this.vertexSrc=e,this.fragTemplate=t,this.programCache={},this.defaultGroupCache={},t.indexOf("%count%")<0)throw new Error('Fragment template must contain "%count%".');if(t.indexOf("%forloop%")<0)throw new Error('Fragment template must contain "%forloop%".')};fl.prototype.generateShader=function generateShader(e){if(!this.programCache[e]){for(var t=new Int32Array(e),n=0;n<e;n++)t[n]=n;this.defaultGroupCache[e]=lc.from({uSamplers:t},!0);var a=this.fragTemplate;a=(a=a.replace(/%count%/gi,""+e)).replace(/%forloop%/gi,this.generateSampleSrc(e)),this.programCache[e]=new Ic(this.vertexSrc,a)}var l={tint:new Float32Array([1,1,1,1]),translationMatrix:new rs,default:this.defaultGroupCache[e]};return new Nc(this.programCache[e],l)},fl.prototype.generateSampleSrc=function generateSampleSrc(e){var t="";t+="\n",t+="\n";for(var n=0;n<e;n++)n>0&&(t+="\nelse "),n<e-1&&(t+="if(vTextureId < "+n+".5)"),t+="\n{",t+="\n\tcolor = texture2D(uSamplers["+n+"], vTextureCoord);",t+="\n}";return t+="\n",t+="\n"};var pl=function(e){function BatchGeometry2(t){void 0===t&&(t=!1),e.call(this),this._buffer=new ec(null,t,!1),this._indexBuffer=new ec(null,t,!0),this.addAttribute("aVertexPosition",this._buffer,2,!1,da.FLOAT).addAttribute("aTextureCoord",this._buffer,2,!1,da.FLOAT).addAttribute("aColor",this._buffer,4,!0,da.UNSIGNED_BYTE).addAttribute("aTextureId",this._buffer,1,!0,da.FLOAT).addIndex(this._indexBuffer)}return e&&(BatchGeometry2.__proto__=e),BatchGeometry2.prototype=Object.create(e&&e.prototype),BatchGeometry2.prototype.constructor=BatchGeometry2,BatchGeometry2}(ic),hl="precision highp float;\nattribute vec2 aVertexPosition;\nattribute vec2 aTextureCoord;\nattribute vec4 aColor;\nattribute float aTextureId;\n\nuniform mat3 projectionMatrix;\nuniform mat3 translationMatrix;\nuniform vec4 tint;\n\nvarying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\n\nvoid main(void){\n    gl_Position = vec4((projectionMatrix * translationMatrix * vec3(aVertexPosition, 1.0)).xy, 0.0, 1.0);\n\n    vTextureCoord = aTextureCoord;\n    vTextureId = aTextureId;\n    vColor = aColor * tint;\n}\n",ml="varying vec2 vTextureCoord;\nvarying vec4 vColor;\nvarying float vTextureId;\nuniform sampler2D uSamplers[%count%];\n\nvoid main(void){\n    vec4 color;\n    %forloop%\n    gl_FragColor = color * vColor;\n}\n",gl=function BatchPluginFactory2(){},vl={defaultVertexSrc:{configurable:!0},defaultFragmentTemplate:{configurable:!0}};gl.create=function create2(e){var t=Object.assign({vertex:hl,fragment:ml,geometryClass:pl,vertexSize:6},e),n=t.vertex,a=t.fragment,l=t.vertexSize,f=t.geometryClass;return function(e){function BatchPlugin(t){e.call(this,t),this.shaderGenerator=new fl(n,a),this.geometryClass=f,this.vertexSize=l}return e&&(BatchPlugin.__proto__=e),BatchPlugin.prototype=Object.create(e&&e.prototype),BatchPlugin.prototype.constructor=BatchPlugin,BatchPlugin}(dl)},vl.defaultVertexSrc.get=function(){return hl},vl.defaultFragmentTemplate.get=function(){return ml},Object.defineProperties(gl,vl);var yl=gl.create()},5746:function(e,t,n){"use strict";n.d(t,{A:function(){return pick},B:function(){return invertObject},C:function(){return onMount},D:function(){return D},E:function(){return destroy_each},H:function(){return HtmlTag},J:function(){return h},K:function(){return a},S:function(){return Store},a:function(){return createEventEmitter},b:function(){return SvelteComponent},c:function(){return createStateMachine},d:function(){return safe_not_equal},e:function(){return enableSound},f:function(){return element},g:function(){return get},h:function(){return text},i:function(){return init},j:function(){return attr},k:function(){return insert},l:function(){return loadSound},m:function(){return append},n:function(){return null_to_empty},o:function(){return set_data},p:function(){return playSound},q:function(){return detach},r:function(){return space},s:function(){return set},t:function(){return toSelector},u:function(){return empty},v:function(){return toggle_class},w:function(){return listen},x:function(){return noop},y:function(){return run_all},z:function(){return createEventDispatcher}});var a="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{},l={exports:{}};!function(e){
/*!
   * Chess.com (c) 2020 | all rights reserved
   */
/*!
   * A distant fork of chess.js - BSD (c) 2014, Jeff Hlywa (jhlywa@gmail.com)
   */
var t,n,a,l,f;t=function(){var e=[[2637767806,863464769],[720845184,95069639],[1155203408,610415943],[2618685246,1655139042],[1971536997,1218186377],[848342074,540017087],[263957791,1627660921],[3896152207,4076560586],[226391645,1484086288],[436746274,3467632685],[2516964848,3797861296],[3491888988,3510251221],[1086189917,1248276018],[18044180,1876255637],[1572111136,1190386149],[597658413,2146900428],[97624494,2243205793],[1738507407,1854916977],[1950989311,2149575947],[2098318769,3283594736],[2194108574,2015279052],[4079062812,2500884588],[856979699,2941369318],[1270058469,3877737539],[2858720366,3170717948],[2378012835,1387254795],[2278688587,2178388503],[435406673,3555273441],[3031118064,1655806655],[2063925420,1107589828],[3376753832,436852829],[615148625,1302492416],[1285502018,1963045959],[346460119,1016137793],[2803604355,1176288659],[55085973,2968618255],[1669016372,4287873088],[164740250,1037634196],[896886403,883023163],[1935551383,2764331555],[410153072,4055711755],[533441746,1505690343],[3541084098,3466290517],[3214426080,4267541060],[2675233103,1951705124],[1374411850,3115986997],[1552073989,3684348154],[4244110986,875606593],[844343081,3115990494],[2356462440,135999605],[3116133511,377238503],[2129956651,2197966368],[299173332,3276914047],[1701379241,745972291],[1306570996,254977976],[2530644806,214138461],[1122123979,1667800879],[1831591130,3801192033],[1116211970,920967505],[1594837592,2551651254],[972591349,2046373768],[2479207924,1935030411],[1675376029,2367888248],[3960916618,3935874422],[1398143232,3265801671],[133930885,1520005442],[1351827834,2829577566],[2076951437,2723839804],[435980918,2364847828],[1668970368,3738157273],[2185864314,3993911799],[2041407829,31969768],[346864372,2004703094],[4047877822,3437142421],[3669961416,538399484],[616810829,4190688246],[3144558884,4030272234],[216165387,2513010905],[2761740594,3216997572],[3919406634,4096014649],[669429112,2434161727],[2234904640,3111407601],[1421079802,1598085235],[1924213810,310373675],[4002762044,2067865415],[2592451728,2586110625],[1890340057,4031717877],[4189625662,2577429954],[2276713138,3049850801],[2741429688,3310307512],[2924122950,3426712818],[421576781,1193704381],[2277442246,3030264553],[153237420,595540057],[4278711886,4176286928],[2380848297,4030514510],[2618700582,1303682185],[3018992701,185284845],[957243316,1291916363],[1543415220,1898408169],[504378001,531073412],[2591337657,1692896435],[1333852064,903543556],[1661259930,188168388],[561112646,2197961224],[1536910315,2632972300],[1349168372,2307429186],[411152329,2745631190],[1694697476,1081411140],[3755185459,2631660711],[4019355068,4027326706],[2066937809,3761668332],[3120395808,3878773315],[94890149,2109283191],[3045629038,358812277],[1249184265,3465901047],[3477490924,2308583306],[4114113436,3875911716],[1014604031,1434513279],[3991324799,2222416029],[2040431088,1539915569],[2253613964,4081224332],[2547464012,1611168627],[2722521980,4281500978],[71289574,213969824],[2450408597,903689630],[1894451515,364024012],[1939968537,374938813],[1447259295,3785468557],[4021046128,1664847745],[3139524504,3562928047],[1173487682,4065269608],[2467266804,3907744866],[4284945151,3486998177],[2925674454,1953016432],[3710671816,1271453948],[2129465869,1422863833],[587093076,18243356],[3373793513,2411305257],[2156648078,1791034213],[3737413652,1534461430],[468575139,2935304962],[1129551363,3603256834],[2861996892,1763494778],[2826449619,2465197654],[1704209531,1014895022],[3738359347,3402630390],[569410928,4095796581],[3021312909,2108247612],[2444777957,2664129360],[282063667,3773661258],[682545472,3188439005],[3318488457,1917822038],[1447622272,4045023041],[757420137,4038580915],[2613420942,4146703316],[4012836163,150381244],[2938127093,3428591704],[1208226490,3086335530],[2935205706,1446903363],[430957978,3830532479],[1381578755,3757172800],[4109399782,1596778224],[288855589,1954372339],[3169178148,2256716053],[2644780093,3895892303],[107966643,1071681559],[1304747544,2607225372],[1359190711,1898207171],[3229237120,3273634996],[3027167685,3863637628],[3011615298,2883984519],[564135827,978463264],[770797430,362326607],[1983662611,1907583229],[4153656423,48268960],[3609759233,720080177],[3727911466,1270989899],[200708787,2366086947],[744508026,393422515],[1213261630,65757284],[3485747185,3845951003],[2958861301,1680248217],[2598470344,3163845864],[2767997908,4233451722],[3881113485,1492930166],[1773764017,2764062206],[4189435844,2898689174],[4234838742,1267095035],[2624081078,3302114327],[2395569449,390426320],[1728307101,690284926],[3309827454,1118258254],[2028172868,3888829086],[4271523049,909051386],[146617804,942892565],[2467685867,974297806],[2483428231,503635829],[3743260573,2018222096],[1002067894,2289153437],[3535252974,3738302271],[4154611160,1002664952],[3623154244,2349656961],[3646679180,3524329383],[862933752,4282853607],[2806008282,3272780913],[2734037942,3828874677],[1328176304,2137666995],[2278785213,2780788825],[381286368,1816476193],[2074232908,2316293454],[4087773386,3651330956],[967884669,3728964514],[4239349185,3213509668],[419231360,1463788948],[1275421624,2672384707],[1088456595,436245261],[2365565249,783696577],[1758083333,845223583],[2048846183,3530914274],[2635948261,124738415],[940630937,3069598626],[839474029,1253439921],[902477345,165479306],[2836079689,2681188273],[2007115168,2093139645],[1363041891,1282466609],[1130479818,1063857938],[3644959908,1260430427],[1385135238,46497915],[1386975934,3110156681],[2635987502,4233461619],[1915744629,4117939016],[487743653,285736599],[2049219159,3960249250],[69242857,3908563670],[1511066720,1488527520],[215590039,1703564952],[1459430344,4184955468],[676103291,2642967214],[83799035,3182827979],[1949179493,476101251],[2593534694,1493478716],[2283504289,995211746],[1349412676,3449243940],[2954378677,1878813305],[249149717,3329151870],[1578231917,1483986052],[4135085182,890874990],[461755528,3505523909],[3669622373,634949665],[219487622,2914465301],[2825233742,3703631897],[2479105382,2935590907],[2582097898,3187672881],[1221328648,1843341402],[2140891889,3958868911],[1482849818,345750049],[751922730,3178831411],[3546542069,4036458902],[216179596,877293293],[444615341,3117393729],[2424254530,494454238],[1344234989,3003337991],[929188581,2760877801],[2507911009,1879899982],[980166547,1311840394],[3566535507,1790747461],[143525013,2311336672],[4181962471,4273938872],[1815842366,862009811],[911175674,1179575598],[3591335374,3694215714],[1452686093,3393294272],[385158879,2447709103],[4011414929,1264623507],[1448477120,911094312],[3971299641,2289992053],[3133647265,2234591563],[3007628400,964409938],[1708345684,3673411261],[3031964479,2843021794],[3022128657,2480338599],[118850112,473449293],[2048127371,3202109429],[3158349745,382018770],[1505327237,3807570472],[2568424029,3272693060],[1866609495,3888556537],[844703982,1852802964],[3504617058,682636099],[1448882679,3733580327],[821387540,2215744532],[3631471417,311618895],[2077838877,2383929020],[3352949096,1688694420],[2491080787,3998672444],[3368630402,4182204255],[983299419,2837414346],[3651215291,1033373924],[265429091,3988955082],[3019003608,2896212153],[2955948456,3025235588],[903690197,2266253487],[3925215275,89402958],[3959093811,3609545561],[2455088053,223552128],[3115011301,2133669107],[1765081558,673805649],[3324795129,2111392191],[3443871631,432345706],[3152559950,3425427147],[3699649406,672784944],[3129545774,7668664],[2747044893,173040075],[3925243406,852328481],[164095314,3161868591],[2234471571,1302682825],[2164784335,105893718],[159995093,536831360],[599199451,425051327],[3274759746,1680930461],[1192619331,3903085578],[2832721114,3078660237],[91404660,4030521531],[3044880024,1578375623],[3906596030,754177855],[803516785,1894094672],[288455592,2030430096],[2143232492,2317305324],[388352703,3406060288],[2521731420,3588403719],[1043041227,4028028525],[3195290851,2468913324],[4166724431,3168683191],[1228226538,968516529],[500177583,3444787306],[533367442,4252082053],[4236023256,657816314],[413575568,3367198397],[3435884549,3334062733],[1004255532,1135705894],[2859513268,4170618274],[3914086821,1251487871],[3080761716,3489067886],[3571165255,699353261],[773372954,3648014952],[769693293,2939128604],[3116440923,507748478],[1687629160,3739431776],[2489486648,3502376324],[3686847158,2878383449],[3530767427,902211375],[2121652637,2493976397],[1827477891,930064171],[2549918411,4029725732],[2071415163,844118802],[2236083679,3088894868],[2040110303,4144562891],[3489536313,1133419300],[2190878435,2301466071],[2465915458,2448602097],[1675766804,2073834499],[3329799896,1613253148],[1483966600,1348836071],[159505618,2527621997],[2674227354,1695130688],[2683539437,1927873839],[3833196123,2570082188],[3891433165,759819981],[1455453349,2179602430],[1430583255,1957776111],[2067726741,4235143439],[303380021,2998980439],[2136024795,3126725799],[2054591852,1051702291],[1029141665,489794361],[2317027384,569642164],[2068461795,624418658],[2499875684,1830645251],[1302894490,4319401],[1002663431,2406815191],[1560941298,2060652753],[2141002286,515773223],[3661248027,475092913],[3705503008,2419919909],[914567990,3496539911],[3462935583,2039034761],[2878378006,2379243316],[1133857586,1390159333],[3023618742,2140726761],[282908558,944874642],[3686955701,1148723903],[2604456805,4163675010],[3061545110,377179268],[3218002352,76459088],[2836503392,916455101],[536836808,151306053],[2886925079,404221671],[2936593041,2011015485],[453815187,1852163908],[3042568989,82176306],[3279635891,4174836410],[3282689058,2360003049],[4088968807,1516570623],[2680453086,1322680794],[1731693966,3438253771],[1842894553,1294307894],[2736377365,2964642609],[121205621,521330014],[2324595870,3005710757],[3784465521,676493813],[1958759409,2030833406],[1306150933,1016370058],[2636541290,482366508],[1950415745,1695073534],[322077955,3746046623],[3602873262,3829181504],[1211684447,1861645455],[504701736,4080111082],[2407799203,1223857855],[1925743434,1498920209],[3617596327,845198428],[2498480299,3484773806],[2680229135,2560201696],[3731399221,1536412390],[2756509305,2924710846],[2635957500,3459716133],[1372762539,769635894],[802677945,3878474636],[1707760534,3075809808],[3714687192,2872792173],[1615679922,1606381794],[1940556374,1337437342],[445390489,731124040],[2864974375,64601760],[1984806574,2141516710],[513390958,1890172555],[744398315,1475299139],[982749166,852662657],[652663695,4260736510],[1184061125,82616221],[3363191899,147951756],[1064069880,1507328085],[2138882964,547595589],[2616926846,3186935246],[2298715513,3606862940],[2414381911,811477686],[2694745228,900437726],[4202576185,2201114451],[3602305260,3323446937],[3756663274,2658490339],[3061587876,2171079416],[3390977925,2850497765],[486312941,224925241],[3515712841,3510684394],[1322319486,2647200565],[3839619171,1148450258],[392296762,1154854654],[1401523788,957405781],[1934485528,527352730],[645968162,3131215255],[696971825,3361451947],[2038689491,1946699733],[1723966113,2785859721],[2652365974,1118037185],[3988018407,3134982149],[1354171594,3053634345],[1287854075,2631782435],[1723106141,2662328866],[563845090,1878819261],[639520332,171129501],[534957223,1696062352],[3612364282,2283204027],[3109494688,1304463816],[500957989,630925278],[3477030536,2149497258],[4109750364,281719363],[951472732,564407054],[922095147,2767874048],[3946156928,829677774],[2622281253,2086286851],[2936811901,850242186],[630086272,3340782667],[2340986210,1296336989],[4107355543,3865114709],[3560210278,3968418243],[3868847493,2967450637],[611513888,2083325060],[3265390517,3025776309],[2874106961,3424470508],[1668707698,2923258228],[2778598353,24320552],[292356118,3415510793],[754567370,86994591],[185141877,1621715171],[2884558258,3722473457],[1492107531,111281805],[3336927864,4225337056],[782994598,1021838039],[346133860,18281270],[2080909533,1649329040],[3612065399,3859901127],[2151962287,284556115],[3957975594,3745718727],[52533817,3998775856],[1232633839,397383972],[2716413964,3629253960],[1531307298,3836851439],[3030137657,2500401718],[3561556693,653345841],[313061910,2945718466],[2065276,3342140708],[410498334,1470588117],[2726640512,4051654894],[2570984935,758567696],[3008987264,3462702678],[623860175,228525243],[3527183895,1829844480],[467272850,3890501742],[568376656,650516927],[990477018,4035508558],[2366955227,817792110],[4183621538,989198068],[946958343,1639184195],[3395758993,3924097558],[1690887473,3220519765],[605184237,1255270525],[275515833,1926424610],[2142902612,283494960],[2021972412,1823828440],[105373677,3448326697],[1666662384,1042433908],[1338566998,261206307],[498685668,1344755577],[3101233780,3119109371],[2733370951,3808165089],[3656512268,3449289481],[4025308119,1607880299],[778896067,1612183167],[2846510368,3674754715],[3058428120,2991822529],[1892379383,3268787440],[2565895844,4154602030],[3213117192,98999135],[2495816991,116985075],[1040203361,1785041385],[3106252493,69316595],[1639829808,2087117568],[3213709576,3799911752],[604681594,2340981536],[4236730699,2938666503],[4009938384,1878897714],[2701667332,1725918218],[2182473079,1258184],[3550198211,2760750799],[657991062,875584532],[1640976276,3380476221],[460041378,2924352091],[1972323596,2287414795],[2510248061,1350206297],[2959337826,3762681165],[1625877874,3235902929],[2070189957,1429368735],[4245163299,1839731898],[2358312347,138364248],[275739390,2179122576],[2037777210,972544338],[2766930226,1984733259],[1933485829,4209310327],[3034118011,3286589799],[2653025529,62078937],[2641780289,2679545709],[3540781195,2787026415],[1569993599,3215949659],[441337890,3947723353],[1878946792,459505587],[3724105660,920173002],[1691411102,3934795955],[148741087,3647709027],[142506469,2776440083],[3811107376,3823285243],[472209891,252266174],[1913386482,1867329194],[2960608550,482740699],[1145005292,1513558421],[1091751784,1687823886],[3625186042,3086337482],[1712140887,940065262],[1504455800,1945702563],[3896940088,2003245591],[2478191531,4197739e3],[3233871270,250924495],[3404865229,1131917964],[1462204167,429621621],[1349259705,3641608989],[3627860584,2048468319],[1244251718,1513180369],[3979211282,371413143],[3043187861,4285699810],[581894202,3060983825],[1390895705,1811317301],[2599134010,3337406128],[2488233440,2436161462],[1816641224,2208816697],[1792034756,815866116],[2779893723,2695577703],[2084952115,2951772258],[1351806869,169269771],[2469979804,86740603],[1163545420,4264616949],[1795352113,2511146232],[1796715044,3134635815],[3521170642,1538900329],[3725363621,1455009392],[1342594643,1512127734],[2618386938,662157428],[2028859350,2494504685],[1841905045,648351336],[4002935891,4033319405],[850071259,1768358867],[979915719,3876018087],[830889197,1629549437],[1744763229,2455795856],[522919199,368499868],[3063822504,2522639205],[2861636095,407686388],[4097602344,1945259027],[4215946617,1251639506],[894485042,534122652],[924809191,1807237502],[1811585710,1589663609],[3439653887,1722232],[3810997538,105152714],[2677100683,4291805514],[77233985,102407776],[4239834691,2851274395],[148802076,2006440603],[2409138150,126301601],[3048474397,3217504870],[588133437,4221603123],[1139638106,263087485],[982032635,3165674595],[562514827,1294842959],[467575086,905357513],[1405117894,3370530088],[3813285157,242912619],[3601878331,1985076606],[1586505598,2092146221],[738488098,103663229],[2970334297,321718822],[1068097019,1742926233],[235518094,420804527],[283685722,4092504887],[2666392744,3799169331],[3569817788,1256762975],[2169728352,292617248],[2444571896,2239859206],[3967907832,1066404216],[420376911,2913277294],[3046293305,2956347747],[2311278792,2477686209],[2885955184,4172514290],[3030078181,2275536480],[4212469731,4280736393],[1046900335,1773022229],[995380926,1414273529],[3892683234,2429494358],[615726237,2127712535],[3880203074,2071130305],[176180504,3070850165],[1474506861,2283723599],[1256707747,1857412043],[764236850,359687368],[3521530334,511649419],[2318567964,3992868140],[128167623,2518992858],[2220129756,1042300052],[2567608573,1349636707],[441446694,384760969],[4143447316,829506048],[817912603,2738025500],[2368091832,357934982],[1187643061,1561463042],[3438021235,3030161697],[1318922279,895468690],[434876457,1130220303],[1180291767,1132759596],[2520707785,1798553137],[1962430872,2958700157],[1510954061,3534879512],[57831539,3269538993],[3354831405,3852135009],[891783098,2698494511],[2555636406,996018997],[2881342935,3982231648],[3473267445,2894952368],[1238029452,3958679326],[2051805420,559465638],[3655936674,1186951582],[330209165,167662935],[1929681327,2450868735],[1313566811,2458925988],[4283920930,3243182650],[1438004300,4185567150],[3093439067,89876832],[3401620219,3721579956],[3673745794,2682874719],[3053321309,825410712],[822915968,3681514755],[3900685126,561657358],[553823814,1857753416],[4166295066,983949325],[128359165,3426887194],[3300989119,3884968622],[4193552686,3647722552],[452189154,1569670618],[4122259632,3537825460],[2519387887,2821594244],[74333898,2940550377],[4032631446,2173999692],[2521268686,1934310532],[2620314688,2177785789],[1378755571,2455646622],[394133753,4231198609],[734399075,2800989170],[573292462,1634883078],[1214417373,3426576256],[2110224475,2399009920],[2331215665,3224086912],[531326186,698539511],[3839443603,583861850],[2644531398,2017784332],[616620850,3070237104],[590349237,2798642861],[3582377217,3317831670],[1582708616,1596570667],[2126148205,2358511947],[173450736,3219362418],[3616831144,1323437318],[2655785577,3131359031],[401600069,2967397952],[496349349,4244179910],[2479612086,2579650653],[1710903074,2049666425],[3589924952,690291925],[3266682943,1900485231],[1496318498,3025542656],[3459221058,3389461212],[2091479615,3140389256],[663040899,1207089672],[3323704225,1105530508],[353318429,2879253542],[2674540957,941987316],[1688550857,620657353],[338551967,4286217277],[204689992,2239736295],[178008789,3940832005],[3871613304,3300636974],[1911672356,2429684487],[4055679954,1974461722],[3878217928,1009991796],[2533095482,310920740],[2174833823,3596041637],[1604814460,2939543881],[1452830254,4092397851],[2441027029,4169690209],[3524103304,3372213855]],t=[[836181454,1689436944],[2776523577,3710710688],[4049974663,3750330768],[519497435,2979405513]],n=[[1892447193,197291556],[3793382197,3742120663],[3838936,2994760034],[479846099,1018728609],[3476112862,182272649],[3504620154,1427438450],[2009473484,2679350403],[1738755500,1129731339]],a=[4174784170,2938602761],l={p:0,P:1,n:2,N:3,b:4,B:5,r:6,R:7,q:8,Q:9,k:10,K:11},f=[];f[5]=1,f[6]=0,f[9]=3,f[10]=2,f[17]=5,f[18]=4,f[33]=7,f[34]=6,f[65]=9,f[66]=8,f[129]=11,f[130]=10;var p,h=[2,5,10,20,40,80,160,64],m=["","0000000","000000","00000","0000","000","00","0",""];function to32BitHex(e){var t=e.toString(16);return m[t.length]+t}function to64BitHex(e){return to32BitHex(e[0])+to32BitHex(e[1])}function hash(f,p){var m,g,v,y,_,b,C,S,k,w,T,P,A=f.split(" "),M=A[0].split("/"),x="w"===A[1],O=0,R=Number(x),I=R?3:4;for(v=7;v>=0;v-=1)for(y=0,C=(_=M[v]).length,b=0;b<C;b+=1)S=_[b],(T=l[S])>=0&&(m=(m^(k=e[64*T+8*(7-v)+y])[0])>>>0,g=(g^k[1])>>>0,T===R&&v===I&&(O|=1<<y)),y+=Number(S)||1;return"-"!==A[2]&&((w=A[2]).indexOf("K")>-1&&(m=(m^(k=t[0])[0])>>>0,g=(g^k[1])>>>0),w.indexOf("Q")>-1&&(m=(m^(k=t[2])[0])>>>0,g=(g^k[1])>>>0),w.indexOf("k")>-1&&(m=(m^(k=t[1])[0])>>>0,g=(g^k[1])>>>0),w.indexOf("q")>-1&&(m=(m^(k=t[3])[0])>>>0,g=(g^k[1])>>>0)),A[3]&&"-"!==A[3]&&(P=A[3].charCodeAt(0)-97,h[P]&O&&(m=(m^(k=n[P])[0])>>>0,g=(g^k[1])>>>0)),x&&(m=(m^a[0])>>>0,g=(g^a[1])>>>0),p&&"hex"===p?to64BitHex([m,g]):[m,g]}function wrap(e){var t,n,a,l,f={};function parseBook(e,t){var a,l,f,p,h,m,g=n.getUint16(e+8),v=n.getUint16(e+10);return l=g>>9&7,p=g>>3&7,h=7&g,m=g>>12&7,4==(f=g>>6&7)&&t&&l===p&&"-"!==t&&(7===h&&(0===l&&t.indexOf("K")>-1||7===l&&t.indexOf("k")>-1)?h-=1:0===h&&(0===l&&t.indexOf("Q")>-1||7===l&&t.indexOf("q")>-1)&&(h+=2)),a=String.fromCharCode(f+97)+(l+1)+String.fromCharCode(h+97)+(p+1),m&&(a+="nbrq"[m-1]),{move:a,weight:v}}function query(e){return"string"==typeof e&&(e={fen:e}),t(e)}if(f={query:query,pick:function pick2(e){var t,n,a,l,f,p=0;if(function sortMoves(e){e.sort((function sorter(e,t){return t.weight-e.weight}))}(t=(e=e||{}).moves||query(e)),a=t.length){if(e.type&&1!==a&&"best"!==e.type){if("random"===e.type){for(l=Math.floor(Math.random()*t.sum)+1,f=0;f<a-1&&!(l<=(p+=t[f].weight));f+=1);return t[f].move}return"randomDisregardWeight"===e.type?t[Math.floor(Math.random()*a)].move:"worst"===e.type?t[a-1].move:((n=parseInt(e.type)||1)<0&&(n=a+n+1),n<1?n=1:n>a&&(n=a),t[n-1].move)}return t[0].move}}},e.getUint32)t=function bufferBookFind(e){var t,a,l,f,p,h=n.length||n.byteLength||0,m=e.offset||0,g=e.fen,v=e.chess960,y=e.checkAll,_=[],b=0;for(e.hash?"string"==typeof(t=e.hash)&&(t=function hex64ToDec(e){return[parseInt(e.substr(0,8),16),parseInt(e.substr(8),16)]}(t)):t=hash(g),!v&&g&&(p=g.split(" ")[2]),m=0;m<h;m+=16)if(n.getUint32(m)===t[0]&&n.getUint32(m+4)===t[1])l=parseBook(m,p),_[_.length]=l,b+=l.weight,a=!0;else if(a&&!y)break;if(_.sum=b,e.relative)for(f=_.length-1;f>=0;f-=1)_[f].relative=Math.round(_[f].weight/b*1e4);return _},n=e,f.buffer=n;else for(l in t=function jsonBookFind(e){var t,n,l,p,h,m,g=0,v=e.fen;if(f.useFen)l=v.replace(/ \d+ \d+$/,""),(t=a[l])||(p=l.replace(/[a-h][1-8]$/,"-"))!==l&&(t=a[p]);else if(e.hash||(e.hash=hash(v,"hex")),t=a[e.hash]){if(t[0]&&t[0].n&&(t=t[0]),t.n&&!t.b)return[];if(t.b)t=function decompressMoves(e){var t,n=[],a=e.b.length;for(t=0;t<a;++t)n.push({move:e.b[t],weight:e.w[t]});return n}(t);else if(!e.chess960&&v)for(m=v.split(" ")[2],n=t.length-1;n>=0;n-=1)(h=t[n].move.match(/e([18])([ah])\1/))&&("h"===h[2]&&("1"===h[1]&&m.indexOf("K")>-1||"8"===h[1]&&m.indexOf("k")>-1)?t[n]={move:"e"+h[1]+"g"+h[1],weight:t[n].weight}:"a"===h[2]&&("1"===h[1]&&m.indexOf("Q")>-1||"8"===h[1]&&m.indexOf("q")>-1)&&(t[n]={move:"e"+h[1]+"c"+h[1],weight:t[n].weight}))}if(t)for(n=t.length-1;n>=0;n-=1)g+=Number(t[n].weight);else t=[];return t.sum=g,t},a=e,f.json=a,a){f.useFen=l.indexOf(" ")>-1;break}return f}function getBook(e,t){!function ajaxLoad(e,t){var n=new XMLHttpRequest,a=e.toLowerCase().indexOf(".json")>-1;function onload(){var e;if(n.status>=200&&n.status<300||304===n.status||0===n.status||1223===n.status)if(a)try{t(null,JSON.parse(n.response))}catch(l){t(l)}else e=new DataView(n.response),t(null,e);else t(new Error("Error code: "+n.status))}n.open("GET",e,!0),a||(n.responseType="arraybuffer"),n.onload=onload,n.onerror=onload,n.send()}(e,(function onload(e,n){var a;if(n&&(a=wrap(n)),t)return t(e,a);if(e)throw e;return a}))}return{hash:hash,loadBook:(p={},function loadBook2(e,t){p[e]?p[e].book?setTimeout((function(){t(null,p[e].book)}),0):p[e].cbs.push(t):(p[e]={cbs:[t]},getBook(e,(function onload(t,n){var a=p[e].cbs;t?delete p[e]:(p[e].book=n,p[e].cbs=void 0),a.forEach((function(e){setTimeout((function(){e(t,n)}),0)}))})))}),to64BitHex:to64BitHex,zobristPiece:e,zobristCastle:t,zobristEnPassant:n,zobristTurn:a,zobristPieceValue:l,zobristPieceValueNumbers:f}}(),n=function init2(){var e,n,a,l,f={Chess:0,Chess960:1,Crazyhouse:2,"3-check":3,"King of the Hill":4,Bughouse:5,chess960:1,fischerandom:1,fischerrandom:1,fischer:1,chess9lx:1,960:1,crazyhouse:2,"three-check":3,threecheck:3,"3check":3,kingofthehill:4,koth:4,bughouse:5},p=["Chess","Chess960","Crazyhouse","3-check","King of the Hill","Bughouse"],h={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],g=0,v=0,y=0,_=-1,b=32,C=128,S=252,k=255,w=512,T=112,P=14,A=21,M=127,x="pnbrqkPNBRQK",O="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",R=[];R[5]=[-16,-17,-15],R[6]=[16,17,15],R[8]=[-18,-33,-31,-14,18,33,31,14],R[16]=[-17,-15,17,15],R[32]=[-16,1,16,-1],R[64]=[-17,-16,-15,1,17,16,15,-1],R[128]=[-17,-16,-15,1,17,16,15,-1];var I={P:5,p:6,N:9,n:10,B:17,b:18,R:33,r:34,Q:65,q:66,K:129,k:130},L={P:4,p:4,N:8,n:8,B:16,b:16,R:32,r:32,Q:64,q:64,K:128,k:128},N={5:"P",6:"p",9:"N",10:"n",17:"B",18:"b",33:"R",34:"r",65:"Q",66:"q",129:"K",130:"k"},D={9:"N",10:"N",17:"B",18:"B",33:"R",34:"R",65:"Q",66:"Q",129:"K",130:"K"},B=[80,0,0,0,0,0,0,96,0,0,0,0,0,0,80,0,0,80,0,0,0,0,0,96,0,0,0,0,0,80,0,0,0,0,80,0,0,0,0,96,0,0,0,0,80,0,0,0,0,0,0,80,0,0,0,96,0,0,0,80,0,0,0,0,0,0,0,0,80,0,0,96,0,0,80,0,0,0,0,0,0,0,0,0,0,80,8,96,8,80,0,0,0,0,0,0,0,0,0,0,0,8,212,224,212,8,0,0,0,0,0,0,96,96,96,96,96,96,224,0,224,96,96,96,96,96,96,0,0,0,0,0,0,8,212,224,212,8,0,0,0,0,0,0,0,0,0,0,0,80,8,96,8,80,0,0,0,0,0,0,0,0,0,0,80,0,0,96,0,0,80,0,0,0,0,0,0,0,0,80,0,0,0,96,0,0,0,80,0,0,0,0,0,0,80,0,0,0,0,96,0,0,0,0,80,0,0,0,0,80,0,0,0,0,0,96,0,0,0,0,0,80,0,0,80,0,0,0,0,0,0,96,0,0,0,0,0,0,80],F=[336,80,80,0,0,0,96,352,96,0,0,0,80,80,336,0,80,336,80,80,0,0,96,352,96,0,0,80,80,336,80,0,80,80,336,80,80,0,96,352,96,0,80,80,336,80,80,0,0,80,80,336,80,80,96,352,96,80,80,336,80,80,0,0,0,0,80,80,336,88,120,360,120,88,336,80,80,0,0,0,0,0,0,80,88,476,252,508,252,476,88,80,0,0,0,0,96,96,96,96,120,252,252,252,252,252,120,96,96,96,96,0,352,352,352,352,360,508,252,0,252,508,360,352,352,352,352,0,96,96,96,96,120,252,252,252,252,252,120,96,96,96,96,0,0,0,0,80,88,476,252,508,252,476,88,80,0,0,0,0,0,0,80,80,336,88,120,360,120,88,336,80,80,0,0,0,0,80,80,336,80,80,96,352,96,80,80,336,80,80,0,0,80,80,336,80,80,0,96,352,96,0,80,80,336,80,80,0,80,336,80,80,0,0,96,352,96,0,0,80,80,336,80,0,336,80,80,0,0,0,96,352,96,0,0,0,80,80,336],j=[336,80,80,0,0,0,96,352,96,96,0,0,80,80,336,0,80,336,80,80,0,0,96,352,96,96,0,80,80,336,80,0,80,80,336,80,80,0,96,352,96,96,80,80,336,80,80,0,0,80,80,336,80,80,96,352,96,112,80,336,80,80,0,0,0,0,80,80,336,88,120,360,120,120,336,80,80,0,0,0,0,0,0,80,88,476,252,508,252,508,88,80,0,0,0,0,96,96,96,96,120,252,252,252,252,252,252,104,96,96,96,0,352,352,352,352,360,508,252,0,252,508,488,352,352,352,352,0,96,96,96,96,120,252,252,252,252,252,252,104,96,96,96,0,0,0,0,80,88,476,252,508,252,508,88,80,0,0,0,0,0,0,80,80,336,88,120,360,120,120,336,80,80,0,0,0,0,80,80,336,80,80,96,352,96,112,80,336,80,80,0,0,80,80,336,80,80,0,96,352,96,96,80,80,336,80,80,0,80,336,80,80,0,0,96,352,96,96,0,80,80,336,80,0,336,80,80,0,0,0,96,352,96,96,0,0,80,80,336],$=[336,80,80,0,0,96,96,352,96,0,0,0,80,80,336,0,80,336,80,80,0,96,96,352,96,0,0,80,80,336,80,0,80,80,336,80,80,96,96,352,96,0,80,80,336,80,80,0,0,80,80,336,80,112,96,352,96,80,80,336,80,80,0,0,0,0,80,80,336,120,120,360,120,88,336,80,80,0,0,0,0,0,0,80,88,508,252,508,252,476,88,80,0,0,0,0,96,96,96,104,252,252,252,252,252,252,120,96,96,96,96,0,352,352,352,352,488,508,252,0,252,508,360,352,352,352,352,0,96,96,96,104,252,252,252,252,252,252,120,96,96,96,96,0,0,0,0,80,88,508,252,508,252,476,88,80,0,0,0,0,0,0,80,80,336,120,120,360,120,88,336,80,80,0,0,0,0,80,80,336,80,112,96,352,96,80,80,336,80,80,0,0,80,80,336,80,80,96,96,352,96,0,80,80,336,80,80,0,80,336,80,80,0,96,96,352,96,0,0,80,80,336,80,0,336,80,80,0,0,96,96,352,96,0,0,0,80,80,336],H=[336,80,80,0,0,96,96,352,96,96,0,0,80,80,336,0,80,336,80,80,0,96,96,352,96,96,0,80,80,336,80,0,80,80,336,80,80,96,96,352,96,96,80,80,336,80,80,0,0,80,80,336,80,112,96,352,96,112,80,336,80,80,0,0,0,0,80,80,336,120,120,360,120,120,336,80,80,0,0,0,0,0,0,80,88,508,252,508,252,508,88,80,0,0,0,0,96,96,96,104,252,252,252,252,252,252,252,104,96,96,96,0,352,352,352,352,488,508,252,0,252,508,488,352,352,352,352,0,96,96,96,104,252,252,252,252,252,252,252,104,96,96,96,0,0,0,0,80,88,508,252,508,252,508,88,80,0,0,0,0,0,0,80,80,336,120,120,360,120,120,336,80,80,0,0,0,0,80,80,336,80,112,96,352,96,112,80,336,80,80,0,0,80,80,336,80,80,96,96,352,96,96,80,80,336,80,80,0,80,336,80,80,0,96,96,352,96,96,0,80,80,336,80,0,336,80,80,0,0,96,96,352,96,96,0,0,80,80,336],V=[336,80,80,112,112,112,96,352,96,96,112,112,112,80,336,0,80,336,80,112,112,112,112,352,96,112,112,112,112,336,80,0,80,80,336,112,112,112,112,368,112,112,112,112,368,80,80,0,80,80,80,368,112,112,112,368,112,112,112,368,112,80,80,0,80,80,80,112,368,120,120,376,120,120,368,112,112,80,80,0,0,80,88,120,120,508,252,508,252,508,120,120,120,88,80,0,96,104,252,252,252,252,252,252,252,252,252,252,252,252,104,0,352,352,480,480,488,508,252,0,252,508,488,480,480,480,352,0,96,104,252,252,252,252,252,252,252,252,252,252,252,252,104,0,0,80,88,120,120,508,252,508,252,508,120,120,120,88,80,0,80,80,80,112,368,120,120,376,120,120,368,112,112,80,80,0,80,80,80,368,112,112,112,368,112,112,112,368,112,80,80,0,80,80,336,112,112,112,112,368,112,112,112,112,368,80,80,0,80,336,80,112,112,112,112,352,96,112,112,112,112,336,80,0,336,80,80,112,112,112,96,352,96,96,112,112,112,80,336],U=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,33,16,31,15,0,0,0,0,0,0,0,0,0,0,0,18,17,16,15,14,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,-14,-15,-16,-17,-18,0,0,0,0,0,0,0,0,0,0,0,-15,-31,-16,-33,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],G=[0,5,8,11,14],q=[31,7,7,7,63],W={P:0,p:0,N:5,n:5,B:8,b:8,R:11,r:11,Q:14,q:14},z=[4,8,16,b,64],K=["","N","B","R","Q"],Z={CAPTURE:1,BIG_PAWN:2,EP_CAPTURE:4,ANY_CAPTURE:5,PROMOTION:8,KSIDE_CASTLE:16,QSIDE_CASTLE:32,KQSIDE_CASTLE:48,DROP:64,DROP_OR_PROMOTE:72},Q=[0,6,1],X={K:119,Q:112,k:7,q:0,A:112,B:113,C:114,D:115,E:116,F:117,G:118,H:119,a:0,b:1,c:2,d:3,e:4,f:5,g:6,h:7},Y=["Event","Site","Date","Round","White","Black","Result"],J=["Event","Site","Date","Round","White","Black","Result","Variant","SetUp","FEN","WhiteA","WhiteB","BlackA","BlackB"];function rank(e){return e>>4}function file(e){return 7&e}function algebraic(e){return String.fromCharCode(file(e)+97)+(8-rank(e))}function swapColor(e){return 3-e}function hashNum(e,t){e[0]=(e[0]^t[0])>>>0,e[1]=(e[1]^t[1])>>>0}function completeFen(e){var t,n;return(t=[""," w - - 0 1"," - - 0 1"," - 0 1"," 0 1"," 1"][(n=(e=e.trim()).split(" ")).length])&&e?e+=t:"0"===n[5]&&(n[5]=1,e=n.join(" ")),e}function createVariantZobristNumbers(){t.zobristCheck=[[441249556,340005552],[1040760204,311043682],[1621584863,1749286446],[1006868636,1625552915],[1953853171,24921145],[161251506,1935545265]]}function validateFen(e,t){var n,a,l,p,h,m,g,v,y,_,b,C,S,k,w,T,P,A,M,O,R=/^(?:[A-H]{1,2}[a-h]{0,2}|[A-H]{0,2}[a-h]{1,2}|KQ?k?q?|Qk?q?|kq?|q|-)$/,I=f[t]||1*t||f[String(t).replace(/\s/g,"").toLowerCase()],L=I===f.Crazyhouse||I===f.Bughouse,N=0,D=0,B=!0,F="",j={0:0,7:0},$={0:0,7:0},H={0:"k",7:"K"},V={0:"r",7:"R"},U=I===f.Chess960;if(!e)return 1;if(I===f.Bughouse&&2===(h=e.split(" | ")).length)return 0===(m=validateFen(h[0],t))&&(m=validateFen(h[1],t)),m;if(h=e.split(/\s+/),I===f["3-check"]&&7===h.length&&(p=h.pop(),!/^\+[0-3]\+[0-3]$/.test(p)||"+3+3"===p))return 14;if(6!==h.length)return 1;if(/\D|.{7,}|^0|^$/.test(h[5]))return 2;if(/\D|.{7,}|^0.|^$/.test(h[4]))return 3;if(!/^(?:-|[abcdefgh][36])$/.test(h[3]))return 4;if(_=h[2],U){if(!R.test(_))return 12}else if(!/^(?:KQ?k?q?|Qk?q?|kq?|q|-)$/.test(_)){if(void 0!==t||!R.test(_))return 5;U=!0}if("w"!==h[1]&&"b"!==h[1])return 6;if(L&&(h[0]=h[0].replace(/~(?=.*\/)/g,"")),a=h[0].split("/"),L&&9===a.length&&(p=a.pop(),!/^[pnbrq]{0,63}$/i.test(p)))return 13;if(8!==a.length)return 7;if("3"===h[3][1]&&"w"===h[1]||"6"===h[3][1]&&"b"===h[1])return 11;for("-"!==h[3]&&(g=4==(D="3"===h[3][1]?4:3)?5:2,N=h[3].charCodeAt(0)-97,B=!1,F=4===D?"P":"p"),n=0;n<a.length;++n){for(A=0,M=!1,O=0;O<a[n].length;O++)if(+(l=a[n][O])==+l){if(M)return 8;A+=1*l,M=!0}else{if(-1===x.indexOf(l))return 9;if(B||D!==n||N!==A||F!==l||(B=!0),g===n&&N===A)return 11;n%7==0&&(l===H[n]?$[n]=1<<A:l===V[n]&&(j[n]|=1<<A)),++A,M=!1}if(8!==A)return 10}if(!B)return 11;if("-"!==_)if(U)for(C={0:0,1:0,2:252,4:248,8:240,16:224,32:192,64:128,128:0},b={0:0,1:0,2:1,4:3,8:7,16:15,32:31,64:63,128:0},P={0:[0,0],7:[0,0]},n=_.length-1;n>=0;--n){if(w=_.charCodeAt(n),T&&T>w&&T-w<8)return 15;if(75===w?S=j[k=7]&C[$[k]]:81===w?S=j[k=7]&b[$[k]]:107===w?S=j[k=0]&C[$[k]]:113===w?S=j[k=0]&b[$[k]]:(S=1<<w-((k=w>=97?0:7)?65:97),T=w),!S||0!=(S&S-1))return 15;if($[k]<2||$[k]>64||(S&j[k])!==S)return 15;if(++P[k][1*($[k]<S)]>1)return 15}else{if((v=(_.indexOf("K")>-1?128:0)|(_.indexOf("Q")>-1?1:0))&&(16!==$[7]||(v&j[7])!==v))return 15;if((y=(_.indexOf("k")>-1?128:0)|(_.indexOf("q")>-1?1:0))&&(16!==$[0]||(y&j[0])!==y))return 15}return 0}function handToString(e,t){var n,a,l="",f=0,p=t?6:0;if(e)for(;f<5;){for(n=e>>G[f]&q[f],a=0;a<n;++a)l+=x[f+p];++f}return l}function hashEP(e,n,a,l){e[a+1]!==l&&e[a-1]!==l||hashNum(n,t.zobristEnPassant[file(a)])}function addPawnMove(e,t,a,l){var f;(0===n||2&e[a+8])&&(rank(a)%7==0?(f=l|Z.PROMOTION|t<<7|a<<P,m[v++]=8388608|f,m[v++]=6291456|f,m[v++]=4194304|f,m[v++]=2097152|f):m[v++]=l|t<<7|a<<P)}function kingOfTheHillWin(e){switch(e){case 67:case 68:case 51:case 52:return!0}return!1}function canCastle960(e,t,n,a){var l,f,p,h=t+(n-t%8),m=n>t%8?1:-1;for(p=t+m;p!==h;p+=m)if(e[p])return!1;if(f=(l=1===a?1===m?118:114:1===m?6:2)-m,e[l+8]||e[l]&&l!==t&&l!==h||e[f]&&f!==t&&f!==h)return!1;if(l!==t)for(p=t+(m=l>t?1:-1);p!==l;p+=m)if(p!==h&&e[p]||e[p+8])return!1;return!0}var ee=function(){function createLine(e,t,n,a,l,p,h){var m,g,v,y,_,b,C,S,k,w,T,P=[],A="",M=!0,x=t[n],O=x.length,R="";if(x.commands)for(y in x.commands)(!p||p.indexOf(y)>-1)&&(R+="[%"+y+" "+x.commands[y]+"]");for(x.initComment&&!h&&(R=(R+" "+x.initComment.replace(/(\"|\}|\%|\\)/g,"\\$1")).trim()),R&&P.push("{"+R+"}"),g=0;g<O;++g){if(b=1===(m=x[g]).color,A="",R="",a!==f.Bughouse?(M&&!b?A=e+"...":b&&(A=e+"."),l&&(b||M)&&(A+=" ")):(P.bughouseOrder||(P.bughouseOrder=[]),P.bughouseOrder.push(m.bughouseOrder),g||(P.blackCountOffset=2===x[0].color?1:0)),A+=m.san,m.annotation&&(A+=m.annotation),m.additionalAnnotation&&(A+=" "+m.additionalAnnotation.join(" ")),M=!1,void 0===m.time||m.commands||(m.commands={clk:(k=m.time,w=void 0,T=void 0,w=Math.floor(k%36e3/600),T=Math.floor(k%36e3%600)/10,Math.floor(k/36e3)+":"+(w<10?"0":"")+w+":"+(T<10?"0":"")+T)}),m.commands)for(y in m.commands)(!p||p.indexOf(y)>-1)&&(R+="[%"+y+" "+m.commands[y]+"]");if(m.comment&&!h&&(R=(R+" "+m.comment.replace(/(\"|\}|\%|\\)/g,"\\$1")).trim()),R&&(A+=" {"+R+"}",M=!0),P.push(A),m.lines)for(C=m.lines.length,v=0;v<C;++v)t[S=m.lines[v]].length&&((_=createLine(e,t,S,a,l,p,h))[0]="("+_[0],_[_.length-1]+=")",P=P.concat(_),M=!0);b||e++}return P}function createHeader(e,t){return"["+e+' "'+String(t).replace(/(\"|\\)/g,"\\$1")+'"]'}return function generatePgn2(e,t,n,a,l,p){var h,m,g="string"==typeof e.newline?e.newline:"\n",v=void 0===e.spaceAfterPeriods||e.spaceAfterPeriods,y="";for(h in y+=createHeader("Event",t.Event)+g,y+=createHeader("Site",t.Site)+g,y+=createHeader("Date",t.Date)+g,y+=createHeader("Round",t.Round)+g,l===f.Bughouse?(y+=createHeader("WhiteA",t.WhiteA||"?")+g,y+=createHeader("BlackA",t.BlackA||"?")+g,y+=createHeader("WhiteB",t.WhiteB||"?")+g,y+=createHeader("BlackB",t.BlackB||"?")+g):(y+=createHeader("White",t.White)+g,y+=createHeader("Black",t.Black)+g),y+=createHeader("Result",t.Result)+g,l&&(y+=createHeader("Variant",t.Variant)+g),t.FEN&&t.FEN!==O&&(y+=createHeader("SetUp","1")+g,y+=createHeader("FEN",t.FEN)+g),t)-1===J.indexOf(h)&&(y+=createHeader(h,t[h])+g);if(y+=g,m=createLine(a,n,0,l,v,e.hideCommands?[]:e.restrictCommands,e.hideComments),l===f.Bughouse){if(p.isDependent)return m;m=function makeBugHousePgn(e,t,n){var a=t,l=e.siblingGame.pgn(),f=0,p=0,h=[];for(t.bughouseOrder=t.bughouseOrder||[],l.bughouseOrder=l.bughouseOrder||[];t.bughouseOrder.length||l.bughouseOrder.length;)!t.bughouseOrder.length||l.bughouseOrder.length&&t.bughouseOrder[0]>l.bughouseOrder[0]?(l.bughouseOrder.shift(),h.push("B")):(t.bughouseOrder.shift(),h.push("A"));return t=[],h.forEach((function(h){var m,g,v,y="";"A"===h?(m=a,g=++f,v=e.startingMoveNumber()):(m=l,g=++p,v=e.siblingGame.startingMoveNumber()),y=String(Math.floor((g+1)/2)+v-1),(m.blackCountOffset+g)%2?y+=h:y+=h.toLowerCase(),y+="."+(n?" ":"")+m.shift(),t.push(y)})),t}(p,m,v)}return m.push(t.Result),y+function wordWrap(e,t,n){return t<1?e:(t="number"==typeof t?t:80,e.replace(new RegExp("(.{1,"+t+"})(?: |$|\r?\n)","g"),"$1"+n).slice(0,-n.length))}(m.join(" "),e.maxWidth,g)}}(),te=function(){var e="!?~",t=/\[%(\S+)\s([^\]]+)\]/,n=/^(?:[+=~\/\-\u2212]+|T?N|RR|D)$/;function extractCommands(e){for(var n,a=e.commands||{};n=t.exec(e.value);)e.value=e.value.replace(n[0],"").trim(),a[n[1]]=n[2],e.commands=a}function isSplitGame(e,t,n,a){for(var l;++t<n;)if((l=e[t].trim())&&"%"!==l[0])return"["===l[0]&&(!a||/^\[\S+\s+".*"\]$/.test(l))}return function tokenize(t,a){var l,f,p,h,m,g,v,y="tags",_=[],b={type:y,value:""},C=0,S=[],k=!0;a=a||{},h=(l=t.split(/\r?\n/)).length;e:for(f=0;f<h;++f)if("%"!==(p=l[f].trim())[0])if(p){if(g=(p=" "+p+" ").length,m=0,k)for(;m<g;++m)if(v=p[m],"tags"===y){if("["===v)b={type:y="tagName",value:""};else if(v.trim()){b={type:y="san",value:""},k=!1;break}}else if("tagName"===y)b.value&&""===v.trim()?(_.push(b),y="tagValueStart"):" "!==v&&(b.value+=v);else if("tagValueStart"===y){if('"'===v||""===v)b={type:y="tagValue",value:""};else if(v.trim()){_.push({type:"tagValue",value:p.slice(m,-1).match(/(.*?)"?\]?$/)[1]}),b={type:y="tags",value:""};continue e}}else if("tagValue"===y)if('"'===v||""===v)if(_.push(b),"]"===p[m+1])b={type:y="tags",value:""},++m;else{if("]"===p.slice(-2,-1)){b.value+=p.substr(m).match(/(.*?)"?\s*\] $/)[1],b={type:y="tags",value:""};continue e}y="tagEnd"}else"\\"===v&&m+2<g&&(v=p[++m]),m>0&&(b.value+=v);else{if("]"!==v){if(!v.trim())continue;--m}b={type:y="tags",value:""}}for(;m<g;++m)if(v=p[m],"san"===y)if(e.indexOf(v)>-1)"!"===v||"?"===v||e.indexOf(v)<6&&(v=["!!","??","!?","?!"][e.indexOf(v)-2])?(b.value&&_.push(b),b={type:"a",value:v},"!"!==p[m+1]&&"?"!==p[m+1]||(b.value+=p[++m]),_.push(b),b={type:"san",value:""}):(""===v&&"=/"===b.value?(b.type="aa",b.value+=v):(b.value&&(n.test(b.value)&&("--"!==b.value||a.rejectNullMoves)&&(b.type="aa"),_.push(b)),b={type:"aa",value:v},""===v&&""===p[m+1]&&(b.value="",++m)),_.push(b),b={type:"san",value:""});else if(" "===v||"\t"===v||"\r"===v||"{"===v||"("===v||")"===v){if(b.value){if("$"===b.value[0])b.type="nag";else if("*"===b.value||"1-0"===b.value||"0-1"===b.value||"1/2-1/2"===b.value||"-"===b.value){if(!(C||m+1<g)){if(b.type="result","-"===b.value&&(b.value="1/2-1/2"),_.push(b),S.push(_),f+1===h||f+2===h&&!l[f+1])return S;k=!0,b={type:y="tags",value:""},_=[];break}b.type="*"===b.value?"cont":"comment"}n.test(b.value)&&("--"!==b.value||a.rejectNullMoves)&&(b.type="aa"),_.push(b),b={type:y,value:""}}if(" "===v||"\t"===v||"\r"===v)y="san";else if("{"===v)y="comment",_.length&&"comment"===_[_.length-1].type&&((b=_.pop()).value+=" ");else if("("===v)y="san",_.push({type:"variationStart",value:++C});else{if(C<1){if(!a.commentErrors)return!1}else _.push({type:"variationEnd",value:C--});y="san"}b.type=y}else if("."===v||!b.value&&+v==+v&&"-"!==p[m+1]&&"/"!==p[m+1]){if(+v==+v)switch(b.number||(b.number=""),b.number+=v,p[m+1]){case"A":case"a":case"B":case"b":b.number+=p[++m],_.push({type:"number",value:b.number}),delete b.number}}else b.value+=v;else 0===m&&(b.value=b.value.trim()),"}"!==v?("\\"===v&&m+2<g&&(v=p[++m]),b.value+=v):(b.value=b.value.trim(),b.value.indexOf("[")>-1&&extractCommands(b),_.push(b),b={type:y="san",value:""})}else _.length&&("tags"===y?(y="san",k=!1):"tagValueStart"!==y&&isSplitGame(l,f,h,C||"comment"===y)&&("comment"===y&&_.push(b),"tagValue"!==_[_.length-1].type&&(S.push(_),_=[]),y="tags",k=!0,C=0));return b.value&&_.push(b),!_.length&&S.length||S.push(_),S}}();function Chess2(J,ne){var re,oe,ie=0,ae=!0,se=[],ce=1,le=[],ue=_,de=0,fe=1,pe=1,he=[],me=[he],ge=0;he.id=ge;var ve={},ye=[],_e=!1,be=!1,Ce=makeMoveChess,moveToSan=function(e,t){var n,a,l,f,p,h,_="";return e&Z.KQSIDE_CASTLE?_=e&Z.KSIDE_CASTLE?"O-O":"O-O-O":e&Z.DROP?((n=e>>A)&&(_+=K[n]),_+="@"+algebraic(l=e>>P&M)):(l=e>>P&M,4&(f=oe[a=e>>7&M])?(e&Z.ANY_CAPTURE&&(_+=String.fromCharCode(file(a)+97)+"x"),_+=algebraic(l),e&Z.PROMOTION&&(_+="="+K[n=e>>A])):(_+=D[f&k],y>1&&(_+=function getDisambiguator(e,t,n){var a,l,f,p,h,g;if(v<2)return"";for(e&=S,g=0;g<v;++g)if(n===(a=m[g])>>P&&(f=a>>7&M)!==t&&oe[f]&e){if(l=!0,rank(t)===rank(f)){if(p)return algebraic(t);h=!0}if(file(t)===file(f)){if(h)return algebraic(t);p=!0}}return l?p?String(8-rank(t)):String.fromCharCode(file(t)+97):""}(f,a,l)),e&Z.ANY_CAPTURE&&(_+="x"),_+=algebraic(l))),t||(e&Z.KQSIDE_CASTLE?(a=e>>7&M,l=e>>P&M):e&Z.DROP_OR_PROMOTE&&(f=z[n]+ce),inCheckAfterMove(f,a,l,e)&&(Ce(e,a,l,n),p=g,g=v,h=y,ie&&isVariantWin()||generateMoves()===g?_+="#":_+="+",v=g,g=p,y=h,reverseMove(he.pop()))),_};function hashPosition(){var e,n,a,l=1===ce?[4174784170,2938602761]:[0,0];for(a=0;a<120;++a)136&a&&(a+=8),(e=oe[a])&&hashNum(l,t.zobristPiece[64*t.zobristPieceValueNumbers[e&k]+8*(7-rank(a))+file(a)]);if(be)for(n=1;n<3;++n)le[n]&&(0!=(le[n]&le[n]-1)?(hashNum(l,t.zobristCastle[n-1]),hashNum(l,t.zobristCastle[n+1])):le[n]>1<<file(se[n])?hashNum(l,t.zobristCastle[n-1]):hashNum(l,t.zobristCastle[n+1]));else{for(n=1;n<3;++n)le[n]&&(le[n]&Z.KSIDE_CASTLE&&hashNum(l,t.zobristCastle[n-1]),le[n]&Z.QSIDE_CASTLE&&hashNum(l,t.zobristCastle[n+1]));_e?function hashHand(e,n){var a,l,f,p,h,m,g,v=0;for(a=1;a<3;++a){if(l=n[a])for(f=0;f<5;){for(h=v+63*f,p=l>>G[f]&q[f],m=0;m<p;++m)hashNum(e,[31*(g=t.zobristPiece[h++])[0]>>>0,17*g[1]>>>0]);++f}v=315}}(l,re._hand):ie===f["3-check"]&&function hash3Check(e,n){n[1]&&hashNum(e,t.zobristCheck[n[1]-1]),n[2]&&hashNum(e,t.zobristCheck[n[2]+2])}(l,ye)}return ue!==_&&hashEP(oe,l,ue+(1===ce?16:-16),4|ce),l}function getCurrentHash(){var e;return he.length?e=he[he.length-1].hash:(he.hash||(he.hash=hashPosition()),e=he.hash),[e[0],e[1]]}function bughouseify(e){function fixBughouseSan(e){return/#/.test(e)&&checkIsPotentiallyBlockable()&&(e=e.replace("#","+")),e}function bughouseFunc(t,n){var a=e(t,n);return a&&("string"==typeof a?a=fixBughouseSan(a):(a.san=fixBughouseSan(a.san),he[he.length-1].san=a.san)),a}return bughouseFunc._isBughouseified=!0,bughouseFunc._orig=e,bughouseFunc}function setVariant(e,t){ie!==(ie=e?f[e]||1*e||f[String(e).replace(/\s/g,"").toLowerCase()]||f.Chess:0)&&(ie===f.Bughouse?(_e=!0,re.isDependent||(re.siblingGame=Chess2(),re.siblingGame.hashing(ae),re.siblingGame.isDependent=!0,re.siblingGame.siblingGame=re,re.siblingGame.header({Variant:"Bughouse"})),createVariantZobristNumbers(),Ce=makeMoveVariant,moveToSan=bughouseify(moveToSan),re.move=bughouseify(re.move)):(delete re.siblingGame,_e=ie===f.Crazyhouse,be=ie===f.Chess960,ie?(createVariantZobristNumbers(),Ce=makeMoveVariant):Ce=makeMoveChess,moveToSan._isBughouseified&&(moveToSan=moveToSan._orig,re.move=re.move._orig)),t||updateSetup(generateFen()))}function disambiguate960Rook(e,t){for(var n,a,l=e>7?1:2;!(136&e);){if((n=oe[e])&l)if(n&b){if(a)return;a=e%8+(1===l?65:97)}else if(n&C)return a;e+=t}}function clear(e,t,n){oe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ce=1,se[1]=_,se[2]=_,le[1]=0,le[2]=0,re._hand[1]=0,re._hand[2]=0,ye[1]=0,ye[2]=0,ue=_,de=0,fe=1,t||(me=[he=[]],ge=0,he.id=ge,ve={Event:"?",Site:"?",Date:"????.??.??",Round:"?",White:"?",Black:"?",Result:"*"},e?setHeader(["Variant",e]):setVariant(!1,n),n||updateSetup(generateFen()))}function reset(){clear(0,!1,!0),he.hash=[1178310168,378666140],oe=[34,10,18,66,130,18,10,34,0,0,0,0,0,0,0,0,6,6,6,6,6,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,33,9,17,65,129,17,9,33,0,0,0,0,0,0,0,0],pe=1,se[1]=116,se[2]=4,le[1]=48,le[2]=48}function load(e,t,n,a){var l,m,g,v,y,S,k,T,P,A,M,x,O=0;if(a?(x=(l=e.split(" "))[3],M=l[2]):(x=(l=e.trim().split(/\s+/))[3]||"-",M=l[2]||"-"),void 0===t?(31&M.charCodeAt(0))<9&&setVariant(f.Chess960,!0):setVariant(t,!0),m=l[0],!a&&!(m=function fixFenPieces(e,t){var n,a,l=e.length,p=0,h=0,m=t&&(t===f.Crazyhouse||t===f.Bughouse);for(n=0;n<l;++n)if(+(a=e[n])!=+a)if("/"===a){if(8!==h&&(e=e.substr(0,n)+(8-h)+e.substr(n),++n,++l),h=0,++p>7){if(!m&&n<l-1||!/^[pnbrq]{0,63}$/i.test(e.substr(n+1)))return!1;break}}else if(I[a]){if(++h>8)return!1}else{if("~"!==a)return!1;m&&n&&/[nbrq]/i.test(e[n-1])||(e=e.substr(0,n)+e.substr(n+1),--n,--l)}else(h+=1*a)>8&&(e=e.substr(0,n)+(a-(h-8))+e.substr(n+1),h=8);return e}(m,ie)))return!1;if(v=m.length,clear(p[ie],n,!0),_e){if(ie===f.Bughouse&&!re.isDependent&&(S=e.split(" | "),!re.siblingGame.load(1===S.length?e:S[1],t,n,a)))return reset(),!1;for(y=0;y<v;++y)if(+(k=m[y])!=+k)if("/"===k){if(O>111){for(++y;y<v;++y)k=m[y],re._hand[k<"a"?1:2]+=1<<W[k]>>>0;break}O+=8}else oe[O]=I[k],"~"===m[y+1]&&(++y,oe[O]|=w),oe[O]&C&&(se[3&oe[O]]=O),++O;else O+=1*k}else for(y=0;y<v;++y)+(k=m[y])!=+k?"/"===k?O+=8:(oe[O]=I[k],oe[O]&C&&(se[3&oe[O]]=O),++O):O+=1*k;if(ce="b"===l[1]?2:1,"-"!==M)if(be){for(P={1:[0,0],2:[0,0]},y=M.length-1;y>=0;--y)75===(g=M.charCodeAt(y))?g=disambiguate960Rook(119,-1):81===g?g=disambiguate960Rook(112,1):107===g?g=disambiguate960Rook(7,-1):113===g&&(g=disambiguate960Rook(0,1)),T=g<97?1:2,A=X[String.fromCharCode(g)],(a||oe[A]===(b|T))&&(g>=97?se[T]>=1&&se[T]<=6&&(le[T]|=1<<A):se[T]>=113&&se[T]<=118&&(le[T]|=1<<A-112),++P[T][1*(se[T]<A)]);(P[1][0]>1||P[1][1]>1)&&(le[1]=0),(P[2][0]>1||P[2][1]>1)&&(le[2]=0)}else{if(!a)for(y=M.length-1;y>=0;--y)T=M.charCodeAt(y)<97?1:2,oe[X[M[y]]]===(b|T)&&se[T]===(1===T?116:4)||(M=M.substr(0,y)+M.substr(y+1));for(y=M.length-1;y>=0;--y)switch(M[y]){case"K":le[1]|=Z.KSIDE_CASTLE;break;case"Q":le[1]|=Z.QSIDE_CASTLE;break;case"k":le[2]|=Z.KSIDE_CASTLE;break;case"q":le[2]|=Z.QSIDE_CASTLE}}return!a&&(2!==x.length||1===ce&&"6"!==x[1]||2===ce&&"3"!==x[1]||oe[x.charCodeAt(0)-97+16*(8-("3"===x[1]?4:5))]!==(4|swapColor(ce))||oe[h[x]])&&(x="-"),ue="-"===x?_:h[x],de=1*l[4]||0,fe=1*l[5]||1,ie===f["3-check"]&&(l[6]&&"+3+3"!==l[6]&&(S=l[6].match(/^\+([0-3])\+([0-3])$/)),S=S||[0,0,0],ye[1]=1*S[1],ye[2]=1*S[2]),n||(pe=fe,updateSetup(generateFen())),!0}function generateFen(){return ie?function generateVariantFen(){var e,t,n,a=0,l="",p="";for(e=0;e<120;++e)136&e&&(a&&(l+=a),l+="/",a=0,e+=8),(n=oe[e])?(a&&(l+=a,a=0),l+=N[n&k],_e&&n&w&&(l+="~")):++a;if(a&&(l+=a),_e&&(l+="/"+handToString(re._hand[1],!0)+handToString(re._hand[2])),be){for(t=le[2],e=0;t;)1&t&&(p=String.fromCharCode(e+97)+p),t>>=1,++e;for(t=le[1],e=0;t;)1&t&&(p=String.fromCharCode(e+65)+p),t>>=1,++e}else le[1]&Z.KSIDE_CASTLE&&(p+="K"),le[1]&Z.QSIDE_CASTLE&&(p+="Q"),le[2]&Z.KSIDE_CASTLE&&(p+="k"),le[2]&Z.QSIDE_CASTLE&&(p+="q");return l+=" "+(1===ce?"w":"b")+" "+(p||"-")+" "+(ue===_?"-":algebraic(ue))+" "+de+" "+fe,ie===f["3-check"]?l+=" +"+ye[1]+"+"+ye[2]:ie!==f.Bughouse||re.isDependent||(l+=" | "+re.siblingGame.fen()),l}():function generateStandardFen(){var e,t,n=0,a="",l="";for(e=0;e<120;++e)136&e&&(n&&(a+=n),a+="/",n=0,e+=8),(t=oe[e])?(n&&(a+=n,n=0),a+=N[t&k]):++n;return n&&(a+=n),le[1]&Z.KSIDE_CASTLE&&(l+="K"),le[1]&Z.QSIDE_CASTLE&&(l+="Q"),le[2]&Z.KSIDE_CASTLE&&(l+="k"),le[2]&Z.QSIDE_CASTLE&&(l+="q"),a+" "+(1===ce?"w":"b")+" "+(l||"-")+" "+(ue===_?"-":algebraic(ue))+" "+de+" "+fe}()}function setHeader(e){var t,n,a;for(t=0;t<e.length;t+=2)n=e[t],a=e[t+1],n&&("Variant"===n&&(setVariant(a),a=ie?p[ie]:void 0),"Result"===n&&"*"!==a&&"1-0"!==a&&"0-1"!==a&&"1/2-1/2"!==a&&(a="*"),void 0!==a?ve[n]=String(a):Y.indexOf(n)>-1?ve[n]="Date"===n?"????.??.??":"?":delete ve[n]);return ve}function updateSetup(e){he.length>0||ge||(e!==O?(ve.SetUp="1",ve.FEN=e,he.hash=null):(delete ve.SetUp,delete ve.FEN,he.hash=[1178310168,378666140]))}function get2(e){var t=oe[h[e]];return t?{type:N[t&S|2],color:3&t,promoted:0!=(t&w)}:null}function calculateLegalMoveInfo(t,f){var p,h,m,g,v,y,b,C,k,w,P,A,M,x=ce,O=oe;if(e=[],n=0,a=0,l=0,O[8]=O[9]=O[10]=O[11]=O[12]=O[13]=O[14]=O[15]=O[24]=O[25]=O[26]=O[27]=O[28]=O[29]=O[30]=O[31]=O[40]=O[41]=O[42]=O[43]=O[44]=O[45]=O[46]=O[47]=O[56]=O[57]=O[58]=O[59]=O[60]=O[61]=O[62]=O[63]=O[72]=O[73]=O[74]=O[75]=O[76]=O[77]=O[78]=O[79]=O[88]=O[89]=O[90]=O[91]=O[92]=O[93]=O[94]=O[95]=O[104]=O[105]=O[106]=O[107]=O[108]=O[109]=O[110]=O[111]=O[120]=O[121]=O[122]=O[123]=O[124]=O[125]=O[126]=O[127]=0,f!==_){for(A=function chooseKingThreats(e,t){return be&&le[e]?V:le[e]&Z.KSIDE_CASTLE&&!oe[t+1]&&!oe[t+2]?le[e]&Z.QSIDE_CASTLE&&!oe[t-1]&&!oe[t-2]&&!oe[t-3]?(l=Z.KQSIDE_CASTLE,H):(l=Z.KSIDE_CASTLE,j):le[e]&Z.QSIDE_CASTLE&&!oe[t-1]&&!oe[t-2]&&!oe[t-3]?(l=Z.QSIDE_CASTLE,$):F}(x,f),p=0;p<120;++p)if(136&p&&(p+=8),g=oe[p])if(g&x)(!t||(0|g)&t)&&e.push(p);else if(0!=((M=A[p-f+119])&g))if(4&g)for(k=R[g],h=1;h<3;++h)136&(b=p+k[h])||(O[b+8]|=1,b===f&&(++n,O[p+8]|=2));else{C=(k=R[g&S]).length,P=g&T;e:for(h=0;h<C;++h)if(w=k[h],!(f>(b=p)&&w<0&&f-b>16||f<b&&w>0&&b-f>16))for(;0==(136&(b+=w));){if(O[b+8]|=1,v=oe[b]){if(v&x)if(b===f){for(m=b-w;m!==p;m-=w)O[m+8]|=2;O[p+8]|=2,++n,P&&0==(136&(b+=w))&&(O[b+8]|=1)}else if(P&&256&M){for(y=b;(y+=w)!==f;)if(136&y||oe[y])continue e;O[b+8]|=4+(Math.abs(w)<<3),++a}break}if(!P)break}}n>1&&(e=[f])}else e=function getPieces(e,t){var n,a,l=[];for(n=0;n<120;++n)136&n&&(n+=8),(a=e[n])&&(a&t)===t&&l.push(n);return l}(oe,x|t)}function validateEnPassant(e,t){var a,l,f,p=t+16*(1===ce?1:-1);return(1!==n||0!=(2&oe[t+8])||0!=(2&oe[p+8]))&&(a=oe[e],oe[t]=a,oe[e]=0,l=oe[p],oe[p]=0,f=inCheck(),oe[e]=a,oe[t]=0,oe[p]=l,!f)}function addCastlingMoves(e){var t,n,a;if(be){if(le[e])for(n=(t=se[e])%8,a=0;a<8;++a)le[e]&1<<a&&canCastle960(oe,t,a,e)&&(m[v++]=(a>n?Z.KSIDE_CASTLE:Z.QSIDE_CASTLE)+(t<<7)+(t+(a-n)<<P),++a)}else l&Z.KSIDE_CASTLE&&(n=(t=se[e])+2,0===oe[t+9]&&0===oe[t+10]&&(m[v++]=Z.KSIDE_CASTLE+(t<<7)+(n<<P))),l&Z.QSIDE_CASTLE&&(n=(t=se[e])-2,0===oe[t+7]&&0===oe[t+6]&&(m[v++]=Z.QSIDE_CASTLE+(t<<7)+(n<<P)))}function generateMoves(t,l){var f,p,h,_,b,C,k,w,M,x,O=ce,I=swapColor(O),L=se[O];for(calculateLegalMoveInfo(t,L),y=e.length,v=g,M=0;M<y;++M)if(f=e[M],_=oe[f],!(n&&a&&4&oe[f+8]))if(4&_)for(C=R[_],0!==a&&0!=(4&oe[f+8])&&oe[f+8]>>3!=16||(b=f+C[0],0===oe[b]&&(addPawnMove(oe,f,b,0),Q[O]===rank(f)&&(b+=C[0],oe[b]||addPawnMove(oe,f,b,Z.BIG_PAWN)))),p=1;p<3;++p)136&(b=f+(k=C[p]))||a&&4&oe[f+8]&&oe[f+8]>>3!==Math.abs(k)||(oe[b]&I?addPawnMove(oe,f,b,Z.CAPTURE):b===ue&&validateEnPassant(f,b)&&(m[v++]=Z.EP_CAPTURE|f<<7|b<<P));else{if(a&&4&oe[f+8]){if(8&_)continue;if(!(B[f-se[O]+119]&_))continue;C=[k=oe[f+8]>>3,-k]}else C=R[_&S];if(x=f<<7,f===L){for(p=0;p<8;++p)0==(136&(b=f+(k=C[p])))&&(oe[b]?oe[b]&I&&0==(1&oe[b+8])&&(m[v++]=Z.CAPTURE|x|b<<P):0==(1&oe[b+8])&&(m[v++]=x|b<<P));0===n&&addCastlingMoves(O)}else for(h=C.length,w=_&T,p=0;p<h;++p)for(k=C[p],b=f;!(136&(b+=k));){if(oe[b]){oe[b]&I&&(0===n||2&oe[b+8])&&(m[v++]=Z.CAPTURE|x|b<<P);break}if((0===n||2&oe[b+8])&&(m[v++]=x|b<<P),!w)break}}return ie&&(_e?function drop(e,t,a){var l,f,p,h,g;if(!e)for(t&&(t>>=26),h=0;h<5;++h)if((!t||(0|t)==1<<h)&&re._hand[a]&q[h]<<G[h]){for(0===h?(l=16,f=103,p=Z.DROP):(l=0,f=119,p=Z.DROP|h<<A),g=l;g<=f;++g)136&g&&(g+=8),oe[g]||(0===n||1===n&&2&oe[g+8])&&(m[v++]=p|g<<P);if(t)return}}(l,t,O):!be&&isVariantWin()&&(v=g)),v}function inCheckAfterMove(e,t,n,a){var l,p,h,m,g,v,y,S;if(ie===f["King of the Hill"]&&e&C&&kingOfTheHillWin(n))return!0;if(a&Z.KQSIDE_CASTLE&&(n=1===ce?a&Z.KSIDE_CASTLE?117:115:a&Z.KSIDE_CASTLE?5:3,e=b,S=!0),(l=se[swapColor(ce)])===_)return!1;if(0==(e&C)&&B[n-l+119]&e)for(g=e&T,m=n+(h=U[n-l+119]);0==(136&m);){if(m===l){if(4&e){if(1==(3&e)?l-n<0:l-n>0)return!0;break}return!0}if(m!==t&&oe[m]||!g)break;m+=h}if(!S){if((p=B[t-l+119])&T&&(h=U[t-l+119])!==U[n-l+119])for(m=l-h;0==(136&m);){if(m!==t&&(v=oe[m])){if(v&ce&&p&v&&v&T)return!0;break}m-=h}if(a&Z.EP_CAPTURE&&(p=B[(y=n+16*(1===ce?1:-1))-l+119])&T)for(m=l-(h=U[y-l+119]);0==(136&m);){if(m!==t&&m!==y){if(m===n)break;if(v=oe[m]){if(v&ce&&p&v&&v&T)return!0;break}}m-=h}}return!1}function attacked(e,t){var n,a,l,f,p=R[8],h=8|e;for(n=0;n<8;++n)if(0==(136&(l=t+p[n]))&&((a=oe[l])&h)===h)return!0;for(p=R[128],n=0;n<8;++n)for(l=t+(f=p[n]);0==(136&l);){if(a=oe[l]){if(a&e&&B[t-l+119]&a){if(!(4&a))return!0;if(1===e?t-l<0:t-l>0)return!0}break}l+=f}return!1}function kingAttacked(e){return se[e]!==_&&attacked(swapColor(e),se[e])}function inCheck(){return kingAttacked(ce)}function checkIsPotentiallyBlockable(){var e,t,n,a=1<<G[4];return re._hand[ce]+=a,e=g,g=v,t=y,n=generateMoves()!==g,v=g,g=e,y=t,re._hand[ce]-=a,n}function inCheckmate(){return inCheck()&&(m[0]=0)===generateMoves()&&!m[0]&&(ie!==f.Bughouse||!checkIsPotentiallyBlockable())}function inStalemate(){var e=!inCheck()&&(m[0]=0)===generateMoves()&&!m[0];return e&&ie===f.Bughouse&&!re.isDependent&&(e=re.siblingGame.inStalemate()),e&&se[ce]!==_}function insufficientMaterial(e){var t,n,a=0,l=0,f=0;for(n=0;n<120;++n)if(136&n&&(n+=8),t=oe[n]){if(e&&0==(t&e))continue;if(100&t)return!1;if(8&t){if(l||a++)return!1}else if(16&t){if(a)return!1;if(++l,(rank(n)+n)%2&&++f,f&&l!==f)return!1}}return!0}function inThreefoldRepetition(){if(de<8)return!1;for(var e,t=getCurrentHash(),n=!1,a=de,l=!1,f=he,p=f.length-1;;){if((p-=2)<0){if(f.id){p=f.atMoveNode+p+2,f=me[f.parentId];continue}if(-2===p)return!1;e=f.hash,l=!0}else e=f[p].hash,f[p].halfMoves>a||a<2?l=!0:a=f[p].halfMoves;if(e[0]===t[0]&&e[1]===t[1]){if(n)return!0;n=!0}if(l)return!1}}function modifyHand(e){var n,a,l,p,h,m,g,v,y,_=e.move;if(ie===f.Crazyhouse||_&Z.DROP?(a=re._hand,h=e.hash,y=e.color):(a=re.siblingGame._hand,e.handSibling=!0,ae&&((m=re.siblingGame._history()).length?h=m[m.length-1].hash:(m.hash||(m.hash=re.siblingGame._hashPosition()),h=m.hash)),y=swapColor(e.color)),e.captured){switch((e.captured&w?4:e.captured&S)&S){case 4:g=0;break;case 8:g=1;break;case 16:g=2;break;case b:g=3;break;default:g=4}n=1<<G[g],ae&&(p=a[y]>>G[g]&q[g],v=t.zobristPiece[p+63*g+(1===y?0:315)])}else n=-1<<G[l=_>>A],ae&&(p=a[y]>>G[l]&q[l],v=t.zobristPiece[p-1+63*l+(1===y?0:315)]);a[y]+=n,e.handChange=n,ae&&hashNum(h,[31*v[0]>>>0,17*v[1]>>>0])}function makeMoveChess(e,n,a,l){var f,p,h,m,g,v,y,S,T=ce,P=swapColor(T),A={move:e,epSquare:ue,halfMoves:de,castlingW:le[1],castlingB:le[2],color:T},M=1===T;ae&&(m=getCurrentHash(),A.hash=m,hashNum(m,t.zobristTurn),ue!==_&&hashEP(oe,m,ue+(M?16:-16),4|T)),0==(e&Z.KQSIDE_CASTLE)?_e&&e&Z.DROP?(oe[a]=z[l]|T,ae&&hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[oe[a]]+8*(7-rank(a))+file(a)]),modifyHand(A),y=0):(y=oe[n],(S=oe[a])&&(A.captured=S,ae&&hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[oe[a]&k]+8*(7-rank(a))+file(a)]),S&b&&le[P]&&(be?rank(a)===(M?0:7)&&(h=1<<file(a),le[P]&h&&(le[P]^=h,ae&&(h>1<<file(se[T])?hashNum(m,t.zobristCastle[P-1]):hashNum(m,t.zobristCastle[P+1])))):a===(M?7:119)?le[P]&Z.KSIDE_CASTLE&&(le[P]^=Z.KSIDE_CASTLE,ae&&hashNum(m,t.zobristCastle[P-1])):a===(M?0:112)&&le[P]&Z.QSIDE_CASTLE&&(le[P]^=Z.QSIDE_CASTLE,ae&&hashNum(m,t.zobristCastle[P+1])))),oe[a]=e&Z.PROMOTION?z[l]|T|w:oe[n],oe[n]=0,ae&&(hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[y&k]+8*(7-rank(n))+file(n)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[oe[a]&k]+8*(7-rank(a))+file(a)]))):y=C,e&Z.EP_CAPTURE?(M?(v=a+16,g=6):(v=a-16,g=8),A.captured=4|P,oe[v]=0,ae&&hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[4|P]+8*(g-rank(a))+file(a)])):y&C?(be?(e&Z.KQSIDE_CASTLE&&(oe[a]=0,oe[n]=0,e&Z.KSIDE_CASTLE?M?(f=118,p=117):(f=6,p=5):M?(f=114,p=115):(f=2,p=3),oe[f]=T|C,oe[p]=T|b,ae&&(hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[C|T]+8*(7-rank(n))+file(n)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[b|T]+8*(7-rank(a))+file(a)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[C|T]+8*(7-rank(f))+file(f)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[b|T]+8*(7-rank(p))+file(p)]))),ae&&(0!=(le[T]&le[T]-1)?(hashNum(m,t.zobristCastle[T-1]),hashNum(m,t.zobristCastle[T+1])):le[T]>1<<file(se[T])?hashNum(m,t.zobristCastle[T-1]):hashNum(m,t.zobristCastle[T+1])),se[T]=f||a):(e&Z.KQSIDE_CASTLE&&(oe[a]=oe[n],oe[n]=0,e&Z.KSIDE_CASTLE?(f=a-1,p=a+1):(f=a+1,p=a-2),oe[f]=oe[p],oe[p]=0,ae&&(hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[C|T]+8*(7-rank(n))+file(n)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[b|T]+8*(7-rank(p))+file(p)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[C|T]+8*(7-rank(a))+file(a)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[b|T]+8*(7-rank(f))+file(f)]))),ae&&(le[T]&Z.KSIDE_CASTLE&&hashNum(m,t.zobristCastle[T-1]),le[T]&Z.QSIDE_CASTLE&&hashNum(m,t.zobristCastle[T+1])),se[T]=a),le[T]=0):y&b&&le[T]&&(be?rank(n)===(M?7:0)&&(h=1<<file(n),le[T]&h&&(le[T]^=h,ae&&(h>1<<file(se[T])?hashNum(m,t.zobristCastle[T-1]):hashNum(m,t.zobristCastle[T+1])))):n===(M?119:7)?le[T]&Z.KSIDE_CASTLE&&(le[T]^=Z.KSIDE_CASTLE,ae&&hashNum(m,t.zobristCastle[T-1])):n===(M?112:0)&&le[T]&Z.QSIDE_CASTLE&&(le[T]^=Z.QSIDE_CASTLE,ae&&hashNum(m,t.zobristCastle[T+1]))),e&Z.BIG_PAWN?(ue=M?a+16:a-16,ae&&hashEP(oe,m,a,4|P)):ue=_,4&y||e&Z.ANY_CAPTURE?de=0:de++,ce=P,he.push(A)}function makeMoveVariant(e,n,a,l){var p,h=ce;makeMoveChess(e,n,a,l),p=he[he.length-1],_e?(de=p.halfMoves+1,p.captured&&modifyHand(p),ie===f.Bughouse&&(p.bughouseOrder=re.moveCount()-1+re.siblingGame.moveCount())):ie===f["3-check"]&&kingAttacked(ce)&&(p.checked=!0,ae&&ye[h]&&hashNum(p.hash,t.zobristCheck[ye[h]+(1===h?-1:2)]),++ye[h],ae&&hashNum(p.hash,t.zobristCheck[ye[h]+(1===h?-1:2)]))}function reverseMove(e){var t,n,a=ce,l=swapColor(a),p=e.move,h=p>>P&M,m=p>>7&M;if(ce=l,le[2]=e.castlingB,le[1]=e.castlingW,ue=e.epSquare,de=e.halfMoves,ie){if(be&&p&Z.KQSIDE_CASTLE)return p&Z.KSIDE_CASTLE?1===l?(n=118,t=117):(n=6,t=5):1===l?(n=114,t=115):(n=2,t=3),oe[n]=0,oe[t]=0,oe[m]=l|C,oe[h]=l|b,void(se[l]=m);if(e.handChange&&(ie!==f.Crazyhouse&&e.handSibling?re.siblingGame._hand[swapColor(l)]-=e.handChange:re._hand[l]-=e.handChange),p&Z.DROP)return void(oe[h]=0);e.checked&&--ye[l]}p&Z.PROMOTION?(oe[m]=4|l,oe[h]=p&Z.CAPTURE?e.captured:0):(oe[m]=oe[h],p&Z.KQSIDE_CASTLE?(oe[h]=0,p&Z.KSIDE_CASTLE?(t=h+1,n=h-1):(t=h-2,n=h+1),oe[t]=l|b,oe[n]=0,se[l]=m):(h===se[l]&&(se[l]=m),p&Z.CAPTURE?oe[h]=e.captured:(oe[h]=0,p&Z.EP_CAPTURE&&(oe[h-(1===l?-16:16)]=4|a))))}function beautifyMove(e,t,n){var a,l,f=e>>P&M,p={color:ce,to:algebraic(f),flags:e&M};return _e&&0!=(e&Z.DROP)?(l=e>>A,p.drop=l,p.piece=z[l]+ce):(a=e>>7&M,p.from=algebraic(a),p.piece=oe[a],e&Z.PROMOTION&&(l=e>>A,p.promotion=z[l]+ce),e&Z.CAPTURE?p.captured=oe[f]:e&Z.EP_CAPTURE&&(p.captured=4|swapColor(ce))),p.san=t||moveToSan(e,n),p}function isVariantWin(){return ie===f["3-check"]?3===ye[swapColor(ce)]:ie===f["King of the Hill"]?kingOfTheHillWin(se[swapColor(ce)]):void 0}function isBughouseWin(){if(ie===f.Bughouse)return re.siblingGame.inCheckmate()}function createVariation(){var e=[],t=generateFen(),n=he.length-1,a=he[n];return!!a&&(e.parentId=ge,e.id=me.length,he.curFen=t,a.lines||(a.lines=[]),a.lines.push(e.id),a.move?reverseMove(a):(ue=a.epSquare,--de,ce=swapColor(ce)),2===ce&&--fe,e.atMoveNode=n,e.hash=n?he[n-1].hash:he.hash,ge=e.id,me.push(e),he=e,!0)}function selectLine(e){var t=generateFen();he.curFen=t,he=me[e],ge=e,load(he.curFen,ie,!0,!0)}return re={WHITE:1,BLACK:2,PAWN:4,KNIGHT:8,BISHOP:16,ROOK:b,QUEEN:64,KING:C,FLAGS:Z,load:load,reset:reset,moves:function(e){var t,n,a,l=[],f=moveToSan;for(e&&(e.verbose&&(f=beautifyMove),e.type&&(n=e.type|e.type<<24),a=e.noDrop),generateMoves(n,a),t=0;t<v;++t)l.push(f(m[t]));return l},inCheck:inCheck,inCheckmate:inCheckmate,inStalemate:inStalemate,isBughouseWin:isBughouseWin,in50MoveRule:function(){return de>=100},inDraw:function(){return de>=100||inStalemate()||insufficientMaterial()||inThreefoldRepetition()||Boolean(function isBughouseDraw(){if(ie===f.Bughouse)return re.siblingGame.in50MoveRule()||re.siblingGame.inThreefoldRepetition()}())},insufficientMaterial:insufficientMaterial,inThreefoldRepetition:inThreefoldRepetition,isVariantWin:isVariantWin,gameOver:function(){return re.inDraw()||inCheckmate()||Boolean(isVariantWin())||Boolean(isBughouseWin())},isPositionValid:function(e){var t,n,a,l=0;if(!1!==(e=e||{}).pawns)for(t=0;t<=119;){if(4&(a=oe[t]))return!1;8==++t&&(t=112)}if(!1!==e.kings){for(t=0;t<=119;++t)if(136&t&&(t+=8),(a=oe[t])&C){if(++l>2)return!1;if(n&&n&a)return!1;n=3&a}if(2!==l)return!1}return!1===e.check||!1===e.kings&&se[swapColor(ce)]===_||!kingAttacked(swapColor(ce))},validateFen:validateFen,fen:generateFen,pgn:function(e){return(e=e||{}).useResultHeader||ge||(isVariantWin()||inCheckmate()?ve.Result=2===ce?"1-0":"0-1":re.inStalemate()?ve.Result="1/2-1/2":isBughouseWin()&&(ve.Result=1===re.siblingGame.turn()?"1-0":"0-1")),ee(e,ve,me,pe,ie,re)},loadPgn:function(e,t,n){var a,l,f,p,h,m,g,v,y,_={},b=0;if("number"!=typeof t&&(n=n||t,t=0),n=n||{},"string"==typeof e&&(n.singleGame&&(e=e.replace(/(?:\r?\n\s*){2,}/g,"\n")),e=re.tokenizePgn(e,n)),t<0&&(t=e.length+t),!(p=e[t]))return!1;for(reset(),l=p.length,a=0;a<l&&"tagName"===(f=p[a]).type;++a){if(!p[a+1]||"tagValue"!==p[a+1].type)return!1;++a,"FEN"===f.value?g=completeFen(p[a].value):_[f.value]=p[a].value}if(n.variant&&(_.Variant=n.variant),_.Variant&&!g&&(g=O),g||"1"===_.SetUp)if("0"===_.SetUp)_.FEN=g;else if(!g||!load(g,_.Variant))return!1;for(re.header(_),m=(h=re)._history();a<l;++a)if("san"===(f=p[a]).type&&0===b){if(!h.move(f.value)&&("Z0"!==f.value&&"<>"!==f.value||n.rejectNullMoves||!h.move("--")))if(n.commentErrors)m.length?m[m.length-1].comment=((m[m.length-1].comment||"")+" "+f.value).trim():m.initComment=((m.initComment||"")+" "+f.value).trim();else{if(!n.skipBadLines||!(0!==ge||he.length&&n.allowBadMainLine))return reset(),!1;b=1}}else if("result"===f.type&&"*"===ve.Result)setHeader(["Result",f.value]);else if("a"===f.type&&0===b&&m[m.length-1])m[m.length-1].annotation=f.value;else if("nag"!==f.type&&"aa"!==f.type||0!==b||!m[m.length-1])if("comment"===f.type&&0===b)m.length?(f.value&&(m[m.length-1].comment=f.value),f.commands&&(m[m.length-1].commands=f.commands,f.commands.clk&&(m[m.length-1].time=(v=f.commands.clk,y=void 0,10*(3600*(y=v.split(":"))[0]+60*y[1]+1*y[2]))))):(m.initComment=String(f.value),f.commands&&(m.commands=f.commands));else if("variationStart"===f.type){if(b>0)++b;else if(!createVariation())return reset(),!1;m=h._history()}else if("variationEnd"===f.type)b>0&&--b,0===b&&(selectLine(m.parentId),m=h._history());else if("number"===f.type){if(!(h=/b/i.test(f.value.slice(-1))?re.siblingGame:re))return!1;m=h._history()}else"cont"===f.type&&ge&&!m.length&&h.move(h._lines()[m.parentId][m.atMoveNode].san);else m[m.length-1].additionalAnnotation||(m[m.length-1].additionalAnnotation=[]),-1===m[m.length-1].additionalAnnotation.indexOf(f.value)&&m[m.length-1].additionalAnnotation.push(f.value);return!0},header:function(e){return Array.isArray(e)?setHeader(e):"object"==typeof e?(Object.keys(e).forEach((function(t){setHeader([t,e[t]])})),ve):ve},turn:function(e){return 1!==e&&2!==e||(ce=e),ce},move:function playMove(e){var n,a,l,f,p,g,y,b,k,T,O,R,I;if("string"==typeof e){switch(e[f=e.length-1]){case"+":case"#":e=e.substr(0,f)}for(k=x.indexOf(e[0])>6?L[e[0]]:"O"===e[0]?C:4,_e&&(-1===e.indexOf("@")?T=!0:(T=!1,k<<=24)),generateMoves(k,T),f=0;f<v;++f)if(e===(g=moveToSan(m[f],!0))){a=m[f];break}if(!a){if("--"===e)return function makeNullMove(){var e,n={color:ce,san:"--",epSquare:ue},a={color:ce,san:"--"};return ae&&(e=getCurrentHash(),n.hash=e,hashNum(e,t.zobristTurn),ue!==_&&hashEP(oe,e,ue+(1===ce?16:-16),4|ce)),ue=_,de++,1===(ce=swapColor(ce))&&++fe,he.push(n),a}();if(e=re.fixMove(e))try{return playMove(e)}catch(N){}return null}y=a>>7&M,b=a>>P&M,l=a>>A}else{if(e.drop){switch(e.drop){case"p":l=0;break;case"n":l=1;break;case"b":l=2;break;case"r":l=3;break;case"q":l=4;break;default:return null}k=1<<26+l}else{if(e.promotion)switch(e.promotion){case"q":l=4;break;case"n":l=1;break;case"r":l=3;break;case"b":l=2;break;default:return null}y=h[e.from],T=!0,k=oe[y]&S}for(b=h[e.to],n=((l?l<<A:0)|b<<P)>>7|y,generateMoves(k,T),f=0;f<v;++f)if(m[f]>>7===n){a=m[f];break}if(!a)return(e=re.fixMove(e))?playMove(e):null}return I=a&Z.DROP_OR_PROMOTE?z[l]+ce:oe[y],p=beautifyMove(a,g,!0),O=inCheckAfterMove(I,y,b,a),Ce(a,y,b,l),O&&(ie&&isVariantWin()||0===generateMoves()?p.san+="#":p.san+="+"),(R=he[he.length-1]).san=p.san,p.piece&w&&(R.promoted=!0),1===ce&&++fe,p},undo:function(e){var t=he.pop();return t?(1===ce&&--fe,t.move?(reverseMove(t),!!e||beautifyMove(t.move,t.san)):(ue=t.epSquare,--de,ce=swapColor(ce),!!e||{san:"--",color:t.color})):null},clear:function(e){clear(e)},put:function(e,t,n){var a,l=h[t],f=!1,p=oe[l],m=3&p,g=e.color;if(isNaN(l)||!e.type||!g||-1===x.indexOf(e.type))return!1;if(oe[l]=L[e.type]|g|(e.promoted?w:0),oe[l]&C&&(se[g]=l),p&&oe[se[m]]&&oe[se[m]]!==(C|m)){for(a=0;a<120;++a)136&a&&(a+=8),oe[a]===(C|m)&&(se[m]=a,f=!0);f||(se[m]=_)}return n||load(generateFen(),ie,!1,!1),!0},get:get2,remove:function(e,t){var n,a=oe[h[e]],l=get2(e),f=3&a;if(oe[h[e]]=0,a&C)for(se[f]=_,le[f]=0,n=0;n<120;++n)if(136&n&&(n+=8),oe[n]===(C|f)){se[a.color]=n;break}return t||load(generateFen(),ie,!0,!1),l},history:function(e,t){for(var n,a=[],l=he,f=l.length;;){if(-1==--f){if(l.id&&!t){f=l.atMoveNode,l=me[l.parentId];continue}break}e?((n=beautifyMove(l[f].move,l[f].san)).color=l[f].color,!f&&l.initComment&&(n.firstComment=l.initComment),void 0!==l[f].comment&&(n.comment=l[f].comment),void 0!==l[f].time&&(n.time=l[f].time),void 0!==l[f].annotation&&(n.annotation=l[f].annotation),void 0!==l[f].additionalAnnotation&&(n.additionalAnnotation=l[f].additionalAnnotation),void 0!==l[f].commands&&(n.commands=l[f].commands),void 0!==l[f].captured&&(n.captured=l[f].captured),void 0!==l[f].promoted&&(n.promoted=l[f].promoted),void 0!==l[f].lines&&(n.lines=l[f].lines),void 0!==l[f].bughouseOrder&&(n.bughouseOrder=l[f].bughouseOrder),x.indexOf(l[f].san[0])>6?n.piece=L[l[f].san[0]]:"O"===l[f].san[0]?n.piece=C:n.piece=4,n.piece|=n.color,a.unshift(n)):a.unshift(l[f].san)}return a},hashes:function(){for(var e=[],t=he,n=t.length;;){if(-1==--n){if(t.id){n=t.atMoveNode,t=me[t.parentId];continue}t.hash||getCurrentHash(),e.unshift(t.hash);break}e.unshift(t[n].hash)}return e},moveCount:function(){return he.length},startingMoveNumber:function(){return pe},completeFen:completeFen,createVariation:createVariation,selectLine:selectLine,hash:function(){var e=getCurrentHash();return ie!==f.Bughouse||re.isDependent?e:[e,re.siblingGame.hash()]},hashing:function(e){ae=e,ie!==f.Bughouse||re.isDependent||re.siblingGame.hashing(ae)},hand:function(){if(_e)return handToString(re._hand[1],!0)+handToString(re._hand[2])},checks:function(){if(ie===f["3-check"])return[ye[1],ye[2]]},threats:function(){var e,t,l,f,p,h,y,b=ce,C=swapColor(b),k=[],w=[],T=[],x=[],O=[],R=ue;if(calculateLegalMoveInfo(0,se[b]),n||a)for(e=0;e<120;++e)136&e&&(e+=8),2&oe[e+8]&&oe[e]?T.push(algebraic(e)):4&oe[e+8]&&k.push(algebraic(e));for(ce=C,ue=_,generateMoves(),e=v;e--;){if(p=(t=m[e])>>P&M,h=t>>7&M,t&Z.DROP_OR_PROMOTE){if(f=z[y=t>>A]|C,t&Z.PROMOTION&&y%3!=1)continue}else f=oe[h],y=0;if(inCheckAfterMove(f,h,p,t)&&(Ce(t,h,p,y),g=e,(ie&&isVariantWin()||generateMoves()===e)&&w.push((t&Z.DROP?N[f].toLowerCase()+"@":algebraic(h))+algebraic(p)),reverseMove(he.pop()),t&Z.CAPTURE)){for(l=0,e=v;e>g;)if((m[--e]>>P&M)===p){l=1,e=g;break}if(!l){x.push(algebraic(h)+algebraic(p));continue}}t&Z.CAPTURE&&1!==y&&(l=124&oe[p])&&(attacked(b,p)?l>(f=oe[h]&S)&&l-f!=8&&O.push(algebraic(h)+algebraic(p)):x.push(algebraic(h)+algebraic(p)))}return g=0,ce=b,ue=R,{pins:k,checkers:T,mates:w,undefended:x,underdefended:O}},tokenizePgn:te,fixMove:function(e){var t,n,a;if("string"==typeof e){if(/0|[?!+#]$|[18][QNRB]$|^P/i.test(e))return e.replace(/[?!+#]+$/,"").replace(/0/g,"O").replace(/([18])([QNRB])$/i,"$1=$2").replace(/^P+/i,"");if(n=e.indexOf("=")>0?-4:-2,"number"==typeof(t=h[e.substr(n,2)])){if(oe[t]&swapColor(ce)||/^[a-h]x?[a-h][36]$/.test(e)){if(-1===e.indexOf("x"))return e.slice(0,n)+"x"+e.substr(n)}else if(e.indexOf("x")>-1)return e.replace(/x/g,"");if(a=e.match(/^([KQNRB]?)([a-h][1-8]?|[1-8])x?([a-h][1-8])=?(.?)$/)){if(oe[h[a[2]]])return{from:a[2],to:a[3],promotion:a[4].toLowerCase()};if(/^\d$/.test(a[2])){for(e=0,generateMoves(L[a[1]],!0),n=0;n<v;++n)if(m[n]>>P===t&&rank(m[n]>>7&M)===8-a[2]){if(e)return;e=m[n]}if(e)return moveToSan(e,!0)}return a[1]+a[3]+a[4]}}}else if(oe[h[e.from]]===(C|ce)&&e.to&&e.from[1]===e.to[1]){if(e.from<e.to)return"O-O";if(e.from>e.to)return"O-O-O"}},_hand:[],_history:function(e){return e&&(ge=(he=e).id),he},_lines:function(){return me},_hashPosition:hashPosition,_board:function(){return oe}},J&&load(J,ne)||reset(),re}return Chess2.variants=p,Chess2}(),a={addOptions:function(e,t){for(var n in t)void 0!==t[n]&&e.push("setoption name "+n+" value "+t[n]);return e},addVariations:function(e,t){var n,a;t=t||[];for(var l=0;l<t.length;++l)(n=t[l]).pv=Array.isArray(n.pv)&&n.pv.join(" ")||n.pv||"",a="variation "+n.pv,"number"==typeof n.mateIn?a+=" mate "+n.mateIn:"number"==typeof n.mate?a+=" mate "+n.mate:a+=" cp "+n.cp,e.push(a);return e},addPush:function(e,t){var n;return"string"==typeof t&&(t={moveLan:t}),n="push "+t.moveLan,t.isBook&&(n+=" isBook"),e.push(n),e},addPosition:function(e,t){return e.push("position fen "+t),e},addVariant:function(e,t){return"chess960"===String(t).toLowerCase().replace(/ |-/g,"")?(e.push("setoption name UCI_Variant value chess"),e.push("setoption name UCI_Chess960 value "+!0)):(e.push("setoption name UCI_Variant value chess"),e.push("setoption name UCI_Chess960 value "+!1)),e}},l=function(e){var n=["bench","d","eval","flip","isready","ponderhit","stop","uci","ucinewgame"],l=[{cmd:"position",args:["fen","startpos","moves","continuation"]},{cmd:"go",args:["binc","btime","confidence","depth","infinite","mate","mindepth","mintime","maxdepth","maxtime","movestogo","movetime","ponder","searchmoves","shallow","winc","wtime"]}],f=["moves","searchmoves"],p=["ponder","infinite","startpos"],h={depth:1,seldepth:1,time:1,nodes:1,multipv:1,cp:1,mate:1,currmovenumber:1,hashfull:1,nps:1,tbhits:1,sbhits:1,cpuload:1,bmc:1,score:2,lowerbound:2,upperbound:2,bestmove:3,ponder:3,baseTurn:3,bestmoveSan:3,ponderSan:3,pv:4,pvSan:4,string:4,refutation:4,currline:4},m=/(?:Total|Final) Evaluation[\s\S]+\n$/i;function createWebWorker(e,t,n){var a=new Worker(e||"stockfish.js"),l={terminate:function terminate(){a.terminate()},postMessage:function postMessage(e){a.postMessage(e)}};function requeue(e){var t=e.concat();e.length=0,t.forEach((function(e){e.cmd?"go"!==e.cmd.substr(0,2)&&n.send(e.cmd,e.cb,e.stream):(clearTimeout(e.timer),n.getBestMove(e.args,e.cb,e.stream))}))}return a.onmessage=function(e){"string"==typeof e.data&&l.onmessage(e.data)},a.onerror=function(f){if(n.fallbackPath&&n.fallbackPath!==e){try{f.preventDefault()}catch(p){}try{a.terminate()}catch(p){}return(a=createWebWorker(n.fallbackPath,t,n)).onmessage=function(e){l.onmessage(e)},requeue(n._activeCommands()),requeue(n._bestMoveQueue()),!1}if(t.onError)return t.onError(f)},l}function createWorker(t,n){var a;return function getSupportedEngines(t,n){n.fallbackPath=t.pathToNonWasmEngine,n.path=t.enginePath||t.pathToEngineWorker,n.wasmPath=t.pathToWasmEngine,t.engines&&(t.engines.multiThreaded&&e.supportsMultithreading()?(n.path=t.engines.multiThreaded.loader,n.wasmPath=t.engines.multiThreaded.engine):t.engines.singleThreaded&&(n.path=t.engines.singleThreaded.loader,n.wasmPath=t.engines.singleThreaded.engine),n.fallbackPath=t.engines.asm||n.fallbackPath)}(t,n),a=n.path,(n.fallbackPath&&"undefined"==typeof WebAssembly||!a)&&(a=n.fallbackPath),n.wasmPath&&(a+="#"+n.wasmPath),createWebWorker(a,t,n)}function parseSearchLine(e){for(var t,n,a=e.split(" "),l=a.length,f="info"===a[0]?1:0,p={mtype:a[0]};f<l;++f)if(n=a[f])if(1===(t=h[n])){for(;!a[++f]&&f<l;);p[n]=Number(a[f])}else if(2===t)p[n]=!0;else if(3===t){for(;!a[++f]&&f<l;);p[n]=a[f]}else for(p[n]=[],++f;f<l;++f){if(h[a[f]]){--f;break}a[f]&&p[n].push(a[f])}return"(none)"!==p.bestmove&&"0000"!==p.bestmove||(p.bestmove=void 0,p.bestmoveSan=void 0),"(none)"!==p.ponder&&"0000"!==p.ponder||(p.ponder=void 0,p.ponderSan=void 0),p}function getFirstWord(e){var t=e.indexOf(" ");return-1===t?e:e.substr(0,t)}return function loadEngine(h,g){var v,y,_,b={},C=[],S=[],k=null;function bestMoveSearch(){var t,n,a,l,f,p=1,h=[],m=[],g=null,v=S[0].args,_=S[0].cb,C=S[0].stream,k=1,w=[],T=loadEngine._previousCP;function convertpv(e){var t=[],n=m[e]||createSanPv(h[e]);return h[e].forEach((function oneach(e,a){t.push({moveSan:n[a],moveLan:e})})),t}function getpv(e,t,n,a){var l;for(l=h.length-1;l>=0;l-=1)if(h[l][0]===e)return convertpv(l);return n?[{moveSan:t,moveLan:e},{moveSan:a,moveLan:n}]:t?[{moveSan:t,moveLan:e}]:[]}function convertScore(e){0===e.mate?(e.mateIn=0,e.cp=-31800*k):(e.mateIn=Number(e.mate*k)||null,"number"!=typeof e.mateIn||isNaN(e.mateIn)||"number"==typeof e.cp?(e.cp*=k,9===Math.abs(e.cp)&&(e.cp=0),v.normalize&&e.depth<=14&&"number"==typeof T&&1===e.multipv&&function normalize(e){var t=.03*Math.pow(32,e.depth/14);e.cp=T+(e.cp-T)*t}(e)):e.cp=31800*k*(e.mate/Math.abs(e.mate))),e.score=e.cp/100}function addBestMoveProps(f){var h;f.baseTurn=a,f.cp=t,f.score=t/100,f.mate=n,f.mateIn=g,f.depth=p,f.moveLan=f.bestmove,f.moveLan&&(f.move=e.uciToObj(f.moveLan)[0],(h=l.move(f.move))&&(f.moveSan=f.bestmoveSan=h.san,f.ponder&&(h=l.move(e.uciToObj(f.ponder)[0]))&&(f.ponderSan=h.san,l.undo(!0)),l.undo(!0)))}function createSanPv(t){var n,a,f=t.length,p=[];for(n=0;n<f&&(a=l.move(e.uciToObj(t[n])[0]));++n)p.push(a.san);for(;n>0;--n)l.undo(!0);return p}function createTimeout(){v.timeout&&(clearTimeout(y),S[0].timer=y=setTimeout((function(){b.stop(),_&&(_(),_=void 0)}),v.timeout))}S[0].started=!0,loadEngine._previousCP=null,v.difficulty>=0&&v.difficulty<20?(b.setoption("Skill Level",v.difficulty),v.maximumError>=0&&v.maximumError<=4999&&b.setoption("Skill Level Maximum Error",v.maximumError),v.errorProbability>=1&&v.errorProbability<=128&&b.setoption("Skill Level Probability",v.errorProbability)):b.setoption("Skill Level",20),void 0!==v.contempt?b.setoption("Contempt",v.contempt):b.setoption("Contempt","0"),v.multiPv>1?b.setoption("MultiPV",v.multiPv):b.setoption("MultiPV",1),v.movetime||v.wtime&&v.btime||v.depth||(v.btime=v.btime||72e3,v.wtime=v.wtime||72e3),!v.startpos&&v.fen||v.moves||v.variant?(l=e.createGame({fen:v.fen?(f=v.fen,(f+"").replace(/\[([qrbnp]*)\]/i,"/$1").replace(/([0-3])\+([0-3]) (\d+ \d+)/,(function(e,t,n,a){return a+" +"+(3-t)+"+"+(3-n)}))):"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",moves:v.moves,variant:v.variant,disableHashing:!0})).turn()===l.WHITE?a="w":(a="b",k=-1):(a="w",l=e.createGame({disableHashing:!0})),b.setVariant(v.variant),b.position(v),b.go(v,(function returnBestMove(e){var n=parseSearchLine(e);if(addBestMoveProps(n),p>14&&t<5e3&&t>-5e3&&(loadEngine._previousCP=t),n.pv=getpv(n.moveLan,n.moveSan),1===n.pv.length&&n.ponder&&(n.pv=getpv(n.moveLan,n.moveSan,n.ponder,n.ponderSan)),w.length>1)w.splice(w.indexOf(n.moveLan),1),v.searchmoves=w,v.getNextBest=0,queueBestMoveSearch(v,(function done(){_(n)}),(function streamer(e){C&&(e.multipv=2,C(e))}));else if(_)try{_(n)}catch(a){console.error(a)}S.shift(),clearTimeout(y),S.length>0&&bestMoveSearch()}),(function streamInfo(e){var l=parseSearchLine(e);l.score&&(l.baseTurn=a,convertScore(l),!l.multipv&&l.depth&&(l.multipv=1),1!==l.multipv&&0!==l.depth||(t=l.cp,n=l.mate,g=l.mateIn)),l.pv&&C&&(l.pvSan=createSanPv(l.pv)),!l.pv||l.lowerbound||l.upperbound||(h.push(l.pv),C&&m.push(l.pvSan)),l.depth>p?p=l.depth:"bestmove"===l.mtype&&addBestMoveProps(l),!C||0===l.mateIn&&l.pv||C(l),createTimeout()})),v.getNextBest&&_&&l.moves({verbose:!0}).forEach((function toLan(t){t=e.normalizeMoveObj(t),w.push(t.from+t.to+(t.promotion||""))})),createTimeout()}function queueBestMoveSearch(e,t,n){S.push({args:e,cb:t,stream:n}),1===S.length&&bestMoveSearch()}function cbIfReady(){b.ready&&(b.bookLoaded||!b.pathToBook)&&g&&g(b)}return b.send=function(t,n,a){var l;"ucinewgame"!==(t=String(t).trim())&&"flip"!==t&&"stop"!==t&&"ponderhit"!==t&&0!==t.indexOf("position")&&0!==t.indexOf("setoption")?C[C.length]={cmd:t,cb:n,stream:a}:l=!0,v&&(e.log&&console.log("stdin: "+t),v.postMessage(t),l&&n&&setTimeout(n,0))},b._activeCommands=function(){return C},b._bestMoveQueue=function(){return S},b.quit=function(){v&&v.terminate&&(v.terminate(),v=null,b.ready=void 0),clearTimeout(y)},n.forEach((function oneach(e){b[e]=function makeSCmd(t,n){b.send(e,t,n)}})),l.forEach((function oneach(e){b[e.cmd]=function makeCCmd(t,n,a){var l=[e.cmd];_&&t.fen&&(t.fen=function convertStockfishVariantFen(e){return(e+"").replace(/^([^/]+)((?:\/[^/]+){7})\/([qrbnp]*)/i,"$1$2[$3]").replace(/( \d+ \d+) \+([0-3])\+([0-3])/,(function(e,t,n,a){return" "+(3-n)+"+"+(3-a)+t}))}(t.fen)),e.args.forEach((function oneach2(e){if(t[e]||0===t[e]){if(f.indexOf(e)>-1){if(!t[e]||!t[e].length)return;Array.isArray(t[e])&&(t[e]=t[e].join(" "))}l.push(e),-1===p.indexOf(e)&&l.push(t[e])}})),b.send(l.join(" "),n,a)}})),b.setoption=function(e,t){b.send("setoption name "+e+" value "+t)},b.setVariant=function(e){var t;e!==_&&(t=String(e).toLowerCase().replace(/ |-/g,""),e&&"chess"!==t?"chess960"===t?(b.setoption("UCI_Variant","chess"),b.setoption("UCI_Chess960","true")):("threecheck"===t&&(t="3check"),b.setoption("UCI_Variant",t),b.setoption("UCI_Chess960","false")):(t=void 0,b.setoption("UCI_Variant","chess"),b.setoption("UCI_Chess960","false")),_=t)},b.loadBook=function(e,n){b.pathToBook=e,t.loadBook(e,(function onload(e,t){b.book=t,b.bookLoaded=!0,e&&(console.error("Error loading opening book."),console.error(e),b.pathToBook=null,b.bookLoaded=!1),n()}))},b.getBestMove=function(t,n,a){var l;if((t=t||{}).fen=t.fen||t.baseFen,t.is960&&(t.variant="Chess960"),b.bookLoaded&&t.useBook&&(l=function getBookMove(t){var n=e.createGame(t),a=b.book.pick({fen:n.fen(),type:void 0!==t.bookPick?t.bookPick:"random",chess960:"Chess960"===n.header().Variant}),l=a&&n.move(a);if(l)return{moveSan:l.san,moveLan:a,move:{from:l.from,to:l.to,promotion:l.promotion||null},baseTurn:1===n.turn()?"b":"w",pv:[{moveSan:l.san,moveLan:a}],depth:null,score:null,mateIn:null,isBookMove:!0}}(t),l))return setTimeout((function(){l.mtype="bestmove",n(l)}),0);queueBestMoveSearch(t,n,a)},b.stopAll=function(t){var n,a=C.length,l=0;function ondiscard(){0==(l-=1)&&t()}for(S=[],n=0;n<a;n+=1)e.log&&console.log("debug (stop_moves): "+n,getFirstWord(C[n].cmd)),"go"!==getFirstWord(C[n].cmd)||C[n].discard||(b.stop(),C[n].discard=!0,t&&(l+=1,C[n].ondiscard=ondiscard));t&&!l&&b.isready(t)},b.restartEngine=function(e){return b.stopAll(),b.quit(),C=[],S=[],b.bookLoaded&&!h.book&&((h=JSON.parse(JSON.stringify(h))).book=b.book),loadEngine(h,e)},b.stopFast=function(e,t){var n;b.stopAll((function(){clearTimeout(n),e(b)})),n=setTimeout((function(){b.restartEngine(e)}),t||5e3)},"undefined"!=typeof Worker&&(h.ceeMode&&(function addCeeInterface(t,n){var l,f,p=1e3,h=0;function createInterruptHook(e){function interruptHook(e){var t=interruptHook.callbacks;for(var n in interruptHook.callbacks={},interruptHook.original&&interruptHook.original(e),t)t[n](e)}return interruptHook.callbacks={},interruptHook.original=e,interruptHook}function analyze(n,a,m,g){var v,y=Date.now(),_=!1,b=++h;function cleanup(){clearTimeout(v),delete l.callbacks[b],delete f.callbacks[b],_=!0}function handleError(e){_||(cleanup(),g({data:e,action:a,uci:n},n))}function onProcessCrash(t){handleError({msg:"CEE process crashed unexpectedly",code:e.ERROR_CODES.CRASH,exitCode:t,err:new Error("CEE process exited with "+t)})}l.callbacks[b]=onProcessCrash,f.callbacks[b]=onProcessCrash,v=setTimeout((function(){handleError({msg:"CEE timed out",code:e.ERROR_CODES.TIMEOUT,timeout:p,duration:Date.now()-y,err:new Error("CEE timed out")})}),p);for(var C=0;C<n.length;++C)t.send(n[C]);t.send("fetch "+a,(function onFetchDone(e){_||(cleanup(),m(e,n))}),(function onFetchStream(n){n.indexOf("info string CEEError")>=0?handleError({msg:"CEE crashed with error code",code:e.ERROR_CODES.ERROR,err:new Error(n.match(/info string CEEError\s*(.*)/)[1])}):t.ceeDebug&&n.indexOf("not recognized")>=0&&handleError({msg:"CEE received unknown UCI option (engine.ceeDebug mode on)",option:n,code:e.ERROR_CODES.NONFATAL_ERROR,err:new Error(n)})}))}n.onError=l=createInterruptHook(n.onError),n.onSignal=f=createInterruptHook(n.onSignal),t.fetch=function(e,t,n){var l,f;l=(e=e||[]).action||"analysis",Array.isArray(e)?f=e:e.uciCommands?f=e.uciCommands:(e.startFen||e.moves||e.evals)&&(f=[],e.startFen&&(e.options=e.options||{},void 0===e.options.ScoreWhiteToMove&&(e.options.ScoreWhiteToMove=!0),void 0===e.options.SerializeLikeCEAC&&(e.options.SerializeLikeCEAC=!0),a.addOptions(f,e.options),a.addVariant(f,e.variant),a.addPosition(f,e.startFen)),a.addVariations(f,e.evals&&e.evals[0]),(e.moves||[]).forEach((function(t,n){var l=n+1;a.addPush(f,t),a.addVariations(f,e.evals&&e.evals[l])}))),Array.isArray(f)?analyze(f,l,t,n):setTimeout((function(){n({data:"Could not determine UCI commands for fetch call",action:l,uci:f},f)}),0)},t.fetch.setTimeout=function(e){p=e},e.ERROR_CODES={TIMEOUT:1,CRASH:2,ERROR:3,NONFATAL_ERROR:4}}(b,h),b.ceeVersion=function(){return JSON.parse(JSON.stringify(k))}),(v=createWorker(h,b)).onmessage=function onmessage(t){var n,a,l,f,p;if(t.indexOf("\n")>-1)for(f=t.split("\n"),p=0;p<f.length;p+=1)onmessage(f[p]);else if(e.log&&console.log("debug (onmessage): "+t),b.stream&&b.stream(t),C.length&&0!==t.indexOf("No such option")&&0!==t.indexOf("Stockfish")&&0!==t.indexOf("Komodo")&&0!==t.indexOf("Explanation Engine")&&0!==t.indexOf("info string variant")){if(a=function determineQueueNum(e,t){var n,a,l,f,p=getFirstWord(e);for(n="uciok"===p||"option"===p?"uci":"readyok"===p||"ready"===p?"isready":"json"===p||e.indexOf("info string CEEError")>=0?"fetch":"bestmove"===p||"info"===p?"go":"other",f=t.length,l=0;l<f;l+=1)if((a=getFirstWord(t[l].cmd))===n||"other"===n&&("d"===a||"eval"===a))return l;return 0}(t,C),(l=C[a]).stream&&!l.discard&&l.stream(t),void 0===l.message?l.message="":""!==l.message&&(l.message+="\n"),l.message+=t,0===t.indexOf("uciok"))b.name=function parseEngineName(e){var t=e.match(/id name ((\S+) ([\d.a-z]+).*)/i);if(t)return{all:t[1].trim(),short:t[2],version:t[3],full:t[2]+" "+t[3],wasm:/ wasm/i.test(e),multithreaded:/ multithreaded/i.test(e)}}(l.message),n=!0;else if(0===t.indexOf("ready"))n=!0;else if(0!==t.indexOf("bestmove")&&"bestmove"!==getFirstWord(t)||"bench"===l.cmd)if("d"===l.cmd)0!==t.indexOf("Legal uci moves")&&0!==t.indexOf("Key is")||(l.done=!0,n=!0);else if(0===l.cmd.indexOf("fetch"))try{0===l.message.indexOf("json ")&&(l.message=JSON.parse(l.message.replace(/^json /gm,"").replace(/\n/g,""))),n=!0}catch(v){}else"eval"===l.cmd?m.test(l.message)&&(n=!0):(0===t.indexOf("pawn key")||0===t.indexOf("Nodes/second")||0===t.indexOf("Unknown command"))&&(n=!0);else n=!0,l.message=t;n&&(C.splice(a,1),l.cb&&!l.discard?l.cb(l.message):l.ondiscard&&l.ondiscard())}else if(h.ceeMode&&0===t.indexOf("Explanation Engine")){var g=t.match(/Explanation Engine\s*([0-9]+)\.([0-9]+)/);k={date:g[1],increment:g[2]}}},h.book&&(b.book=h.book,b.bookLoaded=!0,b.pathToBook=h.pathToBook),b.getFenFromMoves=e.getFenFromMoves,b.getLegalMoves=e.getLegalMoves,b.getPositionInfo=e.getPositionInfo,b.isFenValid=e.isFenValid,b.ready=!1,function startUp(){b.uci((function onstart(){h.settings&&Object.keys(h.settings).forEach((function oneach(e){b.setoption(e,h.settings[e])})),b.ready=!0,cbIfReady()}))}(),!b.book&&h.pathToBook&&b.loadBook(h.pathToBook,cbIfReady),b)}},f=function(){var e,a=n(),f="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",p=252,h={4:"p",5:"P",6:"p",8:"n",9:"N",10:"n",16:"b",17:"B",18:"b",32:"r",33:"R",34:"r",64:"q",65:"Q",66:"q",128:"k",129:"K",130:"k"},m=512,g="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!?{~}(^)[_]@#$,./&-*++=",v="qnrbkp";function decodeTCN(e){var t,n,a,l,f=e.length,p=[];for(t=0;t<f;t+=2)l={},n=g.indexOf(e[t]),(a=g.indexOf(e[t+1]))>63&&(l.promotion=v[Math.floor((a-64)/3)],a=n+(n<16?-8:8)+(a-1)%3-1),n>75?l.drop=v[n-79]:l.from=g[n%8]+(Math.floor(n/8)+1),l.to=g[a%8]+(Math.floor(a/8)+1),p.push(l);return p}function uciToObj(e){var t,n,a=e.split(" "),l=a.length,f=[];if(e)for(t=0;t<l;++t)4===(n=a[t]).length?"@"===n[1]?f.push({drop:n[0].toLowerCase(),to:n.substr(2,2)}):f.push({from:n.substr(0,2),to:n.substr(2,2)}):f.push({from:n.substr(0,2),to:n.substr(2,2),promotion:n[4]});return f}function isSameMove(e,t){return!(e.san!==t.san&&(e.to!==t.to||e.from!==t.from&&(e.from||t.from)||e.promotion!==t.promotion&&(e.promotion||t.promotion)||e.drop!==t.drop&&(e.drop||t.drop)))}function getPremoves(e,t,a){var l,f,p,h,m,g,v,y,_,b,C=[],S=1,k=8,w=1,T=8,P={verbose:!0};for(_=3-(b=e.turn()),(h=n("/",t)).turn(_),a&&(S=k=+a[1],w=T=a.charCodeAt(0)-96),l=S;l<=k;++l)for(f=w;f<=T;++f)m=String.fromCharCode(f+96)+l,(p=e.get(m))&&p.color===_&&(h.put(p,m,!0),"p"===p.type?(g=String.fromCharCode(f-1+96)+(l+(1===_?1:-1)),v=String.fromCharCode(f+1+96)+(l+(1===_?1:-1)),h.put({type:"n",color:b},g,!0),h.put({type:"n",color:b},v,!0)):"k"===p.type&&"-"!==(y=e.fen().split(" ")[2])&&h.load(h.fen().replace(/^(\S+\s\S\s)(\S+)/,"$1"+y),t,!0,!0),C=C.concat(h.moves(P)),h.remove(m,!0),"p"===p.type&&(h.remove(g,!0),h.remove(v,!0)));return t&&e.hand()&&(h._hand[_]=18721,C=C.concat(h.moves({verbose:!0}).filter((function(e){return!a||e.to===a})))),C.forEach((function(e){normalizeMoveObj(e)})),C}function makePremove(e,t){var n,l,f,p,h,m=e.header().Variant,g=getPremoves(e,m,t.from),v=3-e.turn();for(n=g.length-1;n>=0;--n)if(isSameMove(l=g[n],t)){f=!0;break}return f?(l.drop?e.put({type:l.drop,color:v},l.to):(p=e.remove(l.from,!0),l.flags===a.FLAGS.KSIDE_CASTLE?(h=e.remove("Chess960"===m?l.to:"h"+l.from[1],!0),e.put(p,"g"+l.from[1],!0),e.put(h,"f"+l.from[1])):l.flags===a.FLAGS.QSIDE_CASTLE?(h=e.remove("Chess960"===m?l.to:"a"+l.from[1],!0),e.put(p,"c"+l.from[1],!0),e.put(h,"d"+l.from[1])):(l.promotion&&(p.type=l.promotion,p.promoted=!0),h=e.get(l.to),e.put(p,l.to,"k"!==p.type&&"r"!==p.type&&(!h||h.color!==v||"r"!==h.type)))),l):t.from&&(e.turn(v),t=e.fixMove(t),e.turn(3-v),t)?makePremove(e,{san:t,from:t.from}):void 0}function getPieces(e,t){var n,a,l,f=t?{}:[],v=e._board();if(t)for(n=112;n>=0;++n)136&n&&(n-=24),(a=v[n])&&(f[l=g[7&n]+(8-(n>>4))]={type:h[a&p],color:3&a,promoted:0!=(a&m),square:l});else for(n=112;n>=0;++n)136&n&&(n-=24),(a=v[n])&&f.push({type:h[a&p],color:3&a,promoted:0!=(a&m),rank:8-(n>>4),file:1+(7&n)});return f}function makeMoves(e,t,n,a){var l,f,p,h,m,g,v,y,_,b;for(n=n||{},"string"==typeof t&&(t=t.trim().split(" ")),p=t.length,l=0;l<p;l+=1){if(m="b"===t[l].board||"B"===t[l].board?e.siblingGame:e,g="string"==typeof t[l]?uciToObj(t[l])[0]:t[l].san?t[l].san:t[l],!m.move(g)){if(!n.autoPromote){if(n.skipBadLines)break;return!1}if(!0===n.autoPromote?g.promotion="q":g.promotion=n.autoPromote,!m.move(g)){if(n.skipBadLines)break;return!1}}if(y=(v=m._history())[v.length-1],a&&(_=parseInt(a[l],10)),("number"!=typeof _||isNaN(_))&&(_=parseInt(t[l].time,10)),"number"!=typeof _||isNaN(_)||(y.time=_,_=void 0),t[l].firstComment&&(v.initComment=t[l].firstComment),t[l].comment&&(y.comment=t[l].comment),t[l].annotation&&(y.annotation=t[l].annotation),t[l].additionalAnnotation&&(y.additionalAnnotation=t[l].additionalAnnotation),t[l].commands&&(y.commands=t[l].commands),t[l].lines)for(h=t[l].lines.length,f=0;f<h;++f){if(b=e._history().id,e.createVariation(),!makeMoves(e,t[l].lines[f],n)&&!n.skipBadLines)return!1;e.selectLine(b)}}return!0}function extendChess(e){var t,l,p,h,m=-1,g=0;function swapMoveAttributes(e,t){var n={moveTime:e.moveTime,firstComment:e.firstComment,comment:e.comment,annotation:e.annotation,additionalAnnotation:e.additionalAnnotation,commands:e.commands};Object.keys(n).forEach((function(a){e[a]=t[a],t[a]=n[a]}))}e.extended||(e.extended=!0,t={header:e.header,load:e.load,loadPgn:e.loadPgn,createVariation:e.createVariation,undo:e.undo,pgn:e.pgn},e._move=e.move,e.undo=function(){return e.siblingGame?e.deleteBughouseMove(e.curBughouseMove()):e.deletePosition(m,g)},e.getMove=function(n){return n&&("string"==typeof n||n.to&&(n.from||n.drop))&&e._move(n)&&normalizeMoveObj(t.undo())||null},e.premove={queue:h=[],move:function(t){var a;return!(a=makePremove(p=p||n(e.fen(),e.header().Variant),t))||g||m!==e._history().length-1?(h.length||(p=void 0),null):(h.push(a),a)},consume:function(){var t,a,l,f=h.shift();if(f){if(t=e.move(f)){if(p=void 0,a=h.length)for(p=n(e.fen(),e.header().Variant),l=0;l<a;++l)makePremove(p,h[l]);return t}e.premove.cancel()}},moves:function(t){return!g&&m===e._history().length-1&&getPremoves(p||e,e.header().Variant,t)},getPieces:function(t){return getPieces(p||e,t)},fen:function(){return(p||e).fen()},cancel:function(){h.length=0,p=void 0}},e.getPieces=function(t){return getPieces(e,t)},e.material=function(){var t,n,a,l=e.getPieces(),f={imbalance:0,white:{p:8,n:2,b:2,r:2,q:1,count:0},black:{p:8,n:2,b:2,r:2,q:1,count:0}},p={p:1,n:3,b:3,r:5,q:9,k:0};for(t=l.length-1;t>=0;--t)1===l[t].color?(n=f.white,a=f.black):(n=f.black,a=f.white),a[l[t].type]&&--a[l[t].type],n.count+=p[l[t].type];return f.imbalance=f.white.count-f.black.count,f},e.origHistory=e.history,e.history=function(t,n){var a,l,f,p=[],h=e._history(),m=h.length,g=e._lines();for("boolean"==typeof t&&(t={verbose:t}),t=t||{},n&&(t.noParentLines=n),t.toCurrent&&(m=e.ids().move+1);;){if(-1==--m){if(h.id&&!t.noParentLines){m=h.atMoveNode,h=g[h.parentId];continue}break}if(t.verbose){for(l in a={},h[m])if(h[m][l]&&"object"==typeof h[m][l])for(f in a[l]=h[m][l].constructor===Array?[]:{},h[m][l])a[l][f]=h[m][l][f];else a[l]=h[m][l];p.unshift(a)}else p.unshift(h[m].san)}return p},e._getPos=function(n,a){var l,p,h;return"number"!=typeof n&&(n=m),"number"!=typeof a&&(a=g),l=(p=e._lines())[a],n>=0?l[n]:l.id?l.atMoveNode?p[l.parentId][l.atMoveNode-1]:e._getPos(l.atMoveNode-1,l.parentId):(h={fen:t.header().FEN||f,hash:l.hash,initial:!0,ids:{move:-1,line:0}},e.siblingGame&&(h.bughouseOrder=-1),h)},e.move=function(t,n){var a,l,f,p,h=e._history();if(t&&("string"==typeof t||t.to&&(t.from||t.drop))){if(g===h.id&&m<h.length-1||n){if(e.moveForward(n,t))return!0;m<h.length-1&&(e.selectPosition(m+1),e.createVariation(),h=e._history())}e.siblingGame&&(f=e.isDependent?e.siblingGame.fen():e.fen()),(a=e._move(t))&&(normalizeMoveObj(a),g=h.id,l=h[m=h.length-1],p=e._getPos(m-1),e.siblingGame?(l.fen=e.isDependent?e.siblingGame.fen():e.fen(),l.beforeFen=f,l.siblingIds=e.siblingGame.ids()):(l.fen=e.fen(),l.beforeFen=p.fen),p.initial?(l.moveNumber=0,l.previous=null):(l.moveNumber=p.moveNumber+1,l.previous=p.ids),g&&0===m&&e._lines()[h.parentId][h.atMoveNode].move===l.move&&(l.isContinuation=!0),l.flags=a.flags,l.to=a.to,l.from=a.from,l.drop=a.drop,l.capturedStr=a.captured,l.promotion=a.promotion,l.piece=a.piece,a.promoted&&(l.promoted=!0),a.capturedPromotedPawn&&(l.capturedPromotedPawn=!0),l.ids={move:m,line:g})}return a},e.moveDetails=function(t){return(t=t||e._history()[m])&&(t.lines=t.lines||null,t.flags===a.FLAGS.KSIDE_CASTLE?(t.rookFrom="Chess960"===e.header().Variant?t.to:"h"+t.to[1],t.rookTo="f"+t.to[1],t.kingTo="g"+t.to[1]):t.flags===a.FLAGS.QSIDE_CASTLE?(t.rookFrom="Chess960"===e.header().Variant?t.to:"a"+t.to[1],t.rookTo="d"+t.to[1],t.kingTo="c"+t.to[1]):t.flags===a.FLAGS.EP_CAPTURE&&(t.epCapture=t.to[0]+t.from[1])),t},e.header=e.headers=function(n){var a=t.header(n);return e.siblingGame&&extendChess(e.siblingGame),a},e.load=function(n,a,l,f){var p=t.load(n,a,l,f);return e.siblingGame&&extendChess(e.siblingGame),p&&!l&&(m=-1,g=0),p},e.removeEmptyLines=function(){var t,n,a=e._lines();for(t=a.length-1;t>0;--t)a[t].length||(a[t]=void 0,n=!0);n&&e.reorderLines()},e.loadPgn=function(n,a,l){var f=t.loadPgn(n,a,l),p=e._history();return e.removeEmptyLines(),m=p.length-1,(g=p.id)&&e.selectLine(0),f},e.ids=function(){return{move:m,line:g}},e.selectLine=function(t){e.selectPosition(null,t)},e.curBughouseMove=function(){return Math.max(e._getPos().bughouseOrder,e.siblingGame._getPos().bughouseOrder)},e.deleteBughouseMove=function(t){var n,a,l,f=e.curBughouseMove(),p=!1,h=e;if(t>=0)for(f>=t&&e.selectBughouseMove(t-1);;){for(a=(n=h._history()).length,l=0;l<a;++l)if(n[l].bughouseOrder>=t){n.length=l,p=!0;break}if(h===e.siblingGame)break;h=e.siblingGame}return p},e.selectBughouseMove=function(t){var n,a,l=e.isDependent?e.siblingGame:e,f=l;if(-1===t)return f.selectPosition(-1,0,!0),f.siblingGame.selectPosition(-1,0,!0),l.load(l.header().FEN,"Bughouse",!0,!0);for(;;){for(a=(n=f._history()).length-1;a>=0;--a)if(n[a].bughouseOrder===t)return f.selectPosition(n[a].ids.move,0,!0),f.siblingGame.selectPosition(n[a].siblingIds.move,0,!0),l.load(n[a].fen,"Bughouse",!0,!0);if(f===l.siblingGame)return!1;f=l.siblingGame}},e.moveBackward=function(t){var n;if(e.siblingGame)return e.selectBughouseMove(e.curBughouseMove()-1);if(m<=1)if(0===g){if(-1===m)return!1;e.selectPosition(m-1)}else(n=e._getPos(m-1,g)).isContinuation&&!t&&(n=e._getPos(n.ids.move-1,n.ids.line),n=e._getPos(n.ids.move+1,n.ids.line)),e.selectPosition(n.ids.move,n.ids.line);else e.selectPosition(m-1);return!0},e.moveForward=function(t,n){var a,l,f,p,h,v,y=e._lines();if(e.siblingGame)return e.selectBughouseMove(e.curBughouseMove()+1);if("string"==typeof n&&(n={san:n}),!(a=y[g][m+1])||n&&!isSameMove(n,a)){if(n&&a&&a.lines)for(h=a.lines.length,p=0;p<h;++p)if((f=y[a.lines[p]][0])&&isSameMove(n,f)){a=f,v=!0;break}if(!v&&t&&(l=y[g][m])&&l.lines)for(h=l.lines.length,p=0;p<h;++p)if((f=y[l.lines[p]][0])&&f.isContinuation&&(f=y[l.lines[p]][1])&&(!n||isSameMove(n,f))){a=f,v=!0;break}if(!v){try{if(n&&n.san&&(n=e.fixMove(n.san))||n&&n.to&&n.from&&Math.abs(n.to.charCodeAt(0)-n.from.charCodeAt(0))>1&&(n=e.fixMove(n)))return e.moveForward(t,n)}catch(_){}return!1}}return e.selectPosition(a.ids.move,a.ids.line)},e.moveVariation=function(t,n){var a,l,f,p=e._lines(),h=p[t];if(h&&h.id)for(l=(a=p[h.parentId][h.atMoveNode].lines).length-1;l>=0;--l)if(a[l]===t&&a[f=l-(n?1:-1)])return a[l]=a[f],a[f]=t,e.reorderLines(),!0;return!1},e.promoteVariation=function(t,n){for(var a,l,f,p,h,v,y=e._lines(),_=y[t];_&&_[0]&&_.id&&(-1!==n||_.parentId);){for(a=y[f=_.parentId],p=_.atMoveNode,_[0].lines=a[p].lines.concat(_[0].lines||[]),a[p].lines=void 0,v=a.length-p,l=a.splice(p,v),h=0;h<v;++h)l[h].ids.line=t,l[h].ids.move=h;for(l.id=t,l.parentId=f,l.atMoveNode=p,l.hash=_.hash,0===p?(l.initComment=a.initComment,a.initComment=_.initComment):_.initComment&&(a[p-1].comment=((a[p-1].comment||"")+" "+_.initComment).trim()),y[t]=l,v=_.length,h=0;h<v;++h)_[h].ids.line=f,_[h].ids.move=h+p,a.push(_[h]);for(l[0].isContinuation=!!_[0].isContinuation,a[p].isContinuation=!p&&"number"==typeof a.parentId&&y[a.parentId][a.atMoveNode].move===a[0].move,v=a[p].lines.length,h=0;h<v;++h)y[a[p].lines[h]].atMoveNode=p,y[a[p].lines[h]][0]&&(y[a[p].lines[h]][0].isContinuation=y[a[p].lines[h]][0].move===a[p].move);if(g===t?(g=f,m+=p):g===f&&m>=p&&(g=t,m-=p),1===n)break;_=y[t=f]}return void 0!==a&&(e._history(y[g]),e.reorderLines(),!m&&y[g][0].isContinuation&&e.selectPosition(y[g].atMoveNode,y[g].parentId),!0)},e.reorderLines=function(t,n){var a,f,p,h,m,v,y,_,b,C,S=e._lines(),k=!1;for(t?b=n.length-1:(t=0,n=[S[0]],b=0,l=!1),p=(a=S[t]).length,f=0;f<p;++f)if((h=a[f]).ids.line!==b&&(k=!0,h.ids.line=b),h.lines)for(m=h.lines.length,v=0;v<m;++v)(_=S[y=h.lines[v]])?(_.atMoveNode=f,C=n.length,h.lines[v]=C,_.parentId=b,l||y!==g||(l=!0,g=C),n.push(_),k=e.reorderLines(y,n)||k):(1===h.lines.length?delete h.lines:h.lines.splice(v,1),--v,--m);return t||e.saveLines(n,!0),k},e.createVariation=function(){var n,a,l,f=e._history(),p=e._lines();return m===f.length-1?(n=t.createVariation(),f=e._history(),m=f.length-1,g=f.id,n):-1!==m&&(a=[],l=f[m],a.parentId=f.id,a.id=p.length,l.lines||(l.lines=[]),l.lines.push(a.id),a.hash=e._getPos(m-1).hash,a.atMoveNode=m,p.push(a),e.selectPosition(-1,a.id))},e.selectLineEnd=function(t){return e.siblingGame?e.selectBughouseMove(e._history().length+e.siblingGame._history().length-1):("number"!=typeof t&&(t=g),(t!==g||m<e._history().length-1)&&e.selectPosition(null,t,!0))},e.selectLineStart=function(){var t,n;return e.siblingGame?e.selectBughouseMove(-1):g?(m>1||1===m&&!e._getPos(0).isContinuation?t=e._history():(n=e._getPos(-1),t=e._lines()[n.ids.line]),e.selectPosition(t.id?t[1]&&t[0].isContinuation?1:0:-1,t.id)):-1!==m&&e.selectPosition(-1,0)},e.selectPosition=function(n,a,l){var f=e._lines(),p=e._history();if("number"==typeof a&&(a!==g||l)){if(a<0||a>=f.length)return!1;if(p=f[a],"number"!=typeof n)n=p.length-1;else if(n<-1||n>=p.length)return!1;g=a,e._history(p),l=!0}if("number"==typeof n&&(n!==m||l)){if(n<-1||n>=p.length)return!1;t.load(e._getPos(n).fen,t.header().Variant,!0,!0),m=n}return!0},e.resetToMainLine=function(){var t=e._lines();e.selectLineEnd(0),t.length>1&&(t.length=1,e.reorderLines())},e.updateNode=function(t,n,a){var l,f,p=e._lines();for(f in n="number"==typeof n?n:m,l=p[a="number"==typeof a?a:g][n]||p[a],t)l[f]=t[f]},e.updateLineComment=function(t,n){e.updateNode({initComment:t},-1,n)},e.saveLines=function(t,n){var a,l,f,p=e._lines(),h=t.length;for(t!==p&&(p.length=0),l=0;l<h;++l){if(a=t[l],l&&"number"!=typeof a.parentId)return!1;t!==p&&p.push(a),a.id=l}return e._history(e._history()),n||(f=e.ids(),e.selectPosition(-1,0,!0),e.selectPosition(f.move,f.line)),!0},e.deletePosition=function(t,n){var a,l,f=e._lines();return!(!f[n]||!(f[n][t]||-1===t&&0!==n))&&(n&&(0===t||1===t&&f[n][0].isContinuation)&&(t=-1),g>0&&n!==g?(a=function descendsFromMove(e,t,n){for(var a,l=e[t];"number"==typeof(a=l.parentId);){if(a===n)return l.atMoveNode;l=e[a]}return!1}(f,g,n),l=!1!==a&&a>=t):l=n===g&&t<=m,l&&(t>1?e.selectPosition(t-1,n):(e.selectPosition((f[n][0].isContinuation||1===t)&&f[n][1]?1:0,n),e.moveBackward())),t>0?f[n].length=t:n?f[n]=null:f[0].length=0,e.reorderLines(),e.ids())},e.mark=function(t,n){var a=m<0?e._lines()[g]:e._lines()[g][m],l=t.type,f=1;t.color&&("arrow"===l?e.mark({key:t.color+t.key,type:"cal"},n):"square"===l&&e.mark({key:t.color+t.key,type:"csl"},n)),"cal"!==l&&"csl"!==l&&(l="c_"+l,f=0),a.commands&&a.commands[l]&&(a.commands[l]=a.commands[l].split(",").filter((function rm(e){return e.slice(f).split(";")[0]!==t.key.slice(f)})).join(","),a.commands[l]||delete a.commands[l]),n||(a.commands||(a.commands={}),a.commands[l]=(a.commands[l]?a.commands[l]+",":"")+t.key+(t.data?";"+t.data.join(";"):""))},e.markings=function(){var t,n,a,l,f,p,h,v,y={},_=m<0?e._lines()[g]:e._lines()[g][m],b={cal:"arrow",csl:"square"};for(n in _.commands){if(a=_.commands[n],b[n])n=b[n],l=0;else{if("c_"!==n.substr(0,2))continue;n=n.slice(2),l=1}for(y[n]=y[n]||{},p=(f=a.split(",")).length,t=0;t<p;++t)l?(v=(h=f[t].split(";")).shift(),y[n][v]=y[n][v]||{type:n,key:v},y[n][v].data=h):(v=f[t].slice(1),y[n][v]=y[n][v]||{type:n,key:v},y[n][v].color=f[t][0])}return y},e.clearMarkings=function(){var t,n=m<0?e._lines()[g]:e._lines()[g][m];for(t in n.commands)/^c[sa]l$|^c_/.test(t)&&delete n.commands[t]},e.pgn=function(n){var a,l=e.ids();return e.selectLineEnd(0),a=t.pgn(n),e.selectPosition(l.move,l.line),a},e.loadMoves=function(t,n){var a,l,f,p,h;if(n=n||{},"string"==typeof t&&(t=decodeTCN(t)),t){for(n.atCurrent||e.selectPosition(-1,0),f=g,l=t.length,a=0;a<l;++a){if(!((p=e.move(t[a],!0))||(t[a].promotion=!0===n.autoPromote?"q":n.autoPromote,p=e.move(t[a],!0))))return!1;g!==f&&"merge"!==n.method&&(e.promoteVariation(g,1),"promote"!==n.method&&(e._history()[m].lines=void 0,e.reorderLines()),f=g)}if("promote"===n.method){if(l){for(e._history()[m+1]&&(p=e._history()[m],e.createVariation(),e.move(p),swapMoveAttributes(e._history()[0],p),e.promoteVariation(g,1)),a=(h=e._lines()).length-1;a>=0;--a)1===h[a].length&&h[a][0].isContinuation&&(swapMoveAttributes(h[a][0],h[h[a].parentId][h[a].atMoveNode]),h[a].length=0);e.removeEmptyLines()}}else"merge"!==n.method&&e.deletePosition(m+1,g)}return!0})}function createGame(e){var t,a;if((e=e||{}).game)return e.game;if(t=n(),e.analysis&&extendChess(t),e.disableHashing&&t.hashing(!1),e.pgn){if(!(t.loadPgn(e.pgn,e.index,e.options)||"detect"===e.variant&&n.variants.some((function(n){return e.options=e.options||{},e.options.variant=n,t.loadPgn(e.pgn,e.index,e.options)}))))return!1}else{if(e.headers&&(e.variant=e.headers.Variant||e.variant,e.fen||(e.fen=e.headers.FEN)),"detect"===e.variant&&e.fen&&(e.fen.indexOf("|")>-1?e.variant="Bughouse":9===e.fen.split("/").length?e.variant="Crazyhouse":e.fen.indexOf("+")>-1?e.variant="3-check":e.variant=void 0),(e.fen||e.variant)&&!t.load(e.fen||f,e.variant))return!1;e.headers&&"object"==typeof e.headers&&!Array.isArray(e.headers)&&t.header(e.headers)}if(e.tcn)if("object"==typeof e.tcn){if(!function playBughouseTCN(e,t,n){var a,l,f,p=[decodeTCN(t[0]),decodeTCN(t[1])],h=[0,0],m=[0,0],g=p[0].length+p[1].length,v=Math.max(0|n[0][0],0|n[0][1],0|n[1][0],0|n[1][1]),y=[0,0],_=[0,0];for(a=[[v+=600-v%600,v],[v,v]];g--;){if(_[0]=y[0]+a[0][m[0]]-n[0][h[0]]||0,_[1]=y[1]+a[1][m[1]]-n[1][h[1]]||0,p[l=_[0]<=_[1]?0:1][h[l]]||(l^=1),(!(f=l?e.siblingGame:e).move(p[l][h[l]])||g&&f.inCheckmate()&&f.undo(!0))&&!(f=(l^=1)?e.siblingGame:e).move(p[l][h[l]]))return!1;f._history()[h[l]].time=n[l][h[l]],a[l][m[l]]=n[l][h[l]],y[l]=_[l],m[l]^=1,++h[l]}return!0}(t,e.tcn,e.timestamps||[[],[]]))return!1}else a=decodeTCN(e.tcn);else a=e.moves;return!(a&&!makeMoves(t,a,e,e.timestamps))&&t}function normalizeMoveObj(e){return e&&(e.piece&m&&(e.promoted=!0),e.piece=h[e.piece&p],e.captured&&(e.captured&m&&(e.capturedPromotedPawn=!0),e.captured=h[255&e.captured]),e.promotion&&(e.promotion=h[e.promotion&p]),void 0!==e.drop&&(e.drop="pnbrq"[e.drop])),e}function normalizeHistory(e){var t,n,a,l,f,p,h,m=e.history(!0,!0);if(e.siblingGame){for(t=e.siblingGame.history(!0,!0),a=m.length+t.length,n=[],l=0;l<a;++l)!m.length||t.length&&t[0].bughouseOrder<m[0].bughouseOrder?(f=t.shift()).board="b":(f=m.shift()).board="a",n.push(f);m=n}for(a=m.length,l=0;l<a;++l)if((p=m[l]).fen||normalizeMoveObj(p),p.lines)for(h=p.lines.length-1;h>=0;--h)e.selectLine(p.lines[h]),p.lines[h]=normalizeHistory(e).moves;return{moves:m}}function getLegalMoves(e,t){var n,l,f,p;if("string"==typeof e){if((l=a).reset(),!l.load(e,t))return null}else l=createGame(e);for(p=(n=l.moves({verbose:!0})).length,f=0;f<p;++f)normalizeMoveObj(n[f]);return n}function jce(t,n){return(e=e||l(jce))(t,n)}return jce.supportsMultithreading=function(){var e,t=Boolean(jce._hasThreads);if("boolean"!=typeof jce._hasThreads){try{(e=new Worker("data:application/javascript,")).postMessage(new SharedArrayBuffer(1)),t=!0}catch(n){}try{e.terminate()}catch(n){}jce._hasThreads=t}return t},jce.gameFingerprints=function gameFingerprints(e){var n,a,l,p,h,m,g,v,y,_=createGame(e),b=[""],C=[];if(!_)return!1;for(y=(v=_.header()).Variant||"",m=_.hashes(),n="function"==typeof _.origHistory?_.origHistory(!0):_.history(!0),h=m.length,a=[m[0][0],m[0][1]],C.push(t.to64BitHex(a)+y),m[0]=t.to64BitHex(m[0]),l=1;l<h;++l)a[0]=(a[0]^m[l][0]*(l+58465))>>>0,a[1]=(a[1]^m[l][1]*(l+984))>>>0,m[l]=t.to64BitHex(m[l]),C.push(t.to64BitHex(a)+y),normalizeMoveObj(n[p=l-1]),g=(n[p].from?n[p].from:n[p].drop.toUpperCase()+"@")+n[p].to+(n[p].promotion||""),p&&(g=b[p]+" "+g),b.push(g);return{startingFen:v.FEN||f,hashes:m,fingerprints:C,moves:b,variant:v.Variant}},jce.getFenFromMoves=function getFenFromMoves(e,t,n){return a.reset(),a.load(e,n),!(t&&!makeMoves(a,t))&&a.fen()},jce.getLegalMoves=getLegalMoves,jce.getPositionInfo=function getPositionInfo(e,t,n){var l,f,p={gameOver:!1,check:!1,checkmate:!1,draw:!1,stalemate:!1,threefold:!1,insufficient:!1};if(Array.isArray(t)||(n=t,t=null),"boolean"==typeof n?(l=n,n={}):l=(n=n||{}).variant,"string"==typeof e){if((f=a).reset(),0!==f.validateFen(e,l)||!f.load(e,l))return!1}else f=createGame(e);return!(t&&!makeMoves(f,t))&&(n.getLegalMoves&&(p.legalMoves=getLegalMoves({game:f})),f.inCheck()?(p.check=!0,p.checkmate=f.inCheckmate()):p.stalemate=f.inStalemate(),p.threefold=f.inThreefoldRepetition(),p.insufficient=f.insufficientMaterial(n.color),p.fiftyMoveRule=f.in50MoveRule(),p.draw=p.stalemate||p.threefold||p.insufficient||p.fiftyMoveRule||f.inDraw(),n.skipValidation||(p.isValid=f.isPositionValid(n)),l&&(p.variantWin=f.isVariantWin(),void 0===p.variantWin&&(p.variantWin=f.isBughouseWin())),p.gameOver=p.checkmate||p.draw||Boolean(p.variantWin),p)},jce.isFenValid=function isFenValid(e,t){return 0===a.validateFen(e,t)},jce.encodeTCN=function encodeTCN(e){var t,n,a,l,f="";for(Array.isArray(e)||(e=[e]),n=e.length,t=0;t<n;t+=1)a=e[t].drop?79+v.indexOf(e[t].drop):g.indexOf(e[t].from[0])+8*(e[t].from[1]-1),l=g.indexOf(e[t].to[0])+8*(e[t].to[1]-1),e[t].promotion&&(l=3*v.indexOf(e[t].promotion)+64+(l<a?9+l-a:l-a-7)),f+=g[a]+g[l];return f},jce.decodeTCN=decodeTCN,jce.uciToObj=uciToObj,jce.generatePgn=function generatePgn(e){var t;return(e=e||{}).disableHashing=!0,!!(t=createGame(e))&&t.pgn(e)},jce.pgnToFen=function pgnToFen(e,t){var n,l,f=[];if(a.reset(),!a.loadPgn(e))return!1;if(n=a.moveCount(),"number"==typeof t){for(t<0&&(t=n+t+1),l=n-1;l>=t&&l>=0;l-=1)a.undo();return a.fen()}for(l=0;l<=n;l+=1)f.unshift(a.fen()),a.undo();return f},jce.pgnToJson=function pgnToJson(e,t,n){var l,f=[],p=a;return"number"!=typeof t&&(n=t,t=void 0),l=p.tokenizePgn(e,n),t<0&&(t=l.length+t),!!l&&(n&&n.includeFen&&(p=createGame({analysis:!0})),l.forEach((function(e,a){var l,h;a===t||void 0===t?p.loadPgn([e],0,n)?(h=normalizeHistory(p),l=p.header(),f.push({headers:l,moves:h.moves})):f.push(!1):f.push(void 0)})),"number"==typeof t?f[t]:f)},jce.sanToObj=function sanToObj(e,t,n){return a.reset(),!!a.load(t,n)&&normalizeMoveObj(a.move(e))},jce.completeFen=a.completeFen,jce.shortenFen=function shortenFen(e,t){return a.completeFen(e).split(" ").slice(0,t||4).join(" ")},jce.createGame=createGame,jce.getPositionDetails=function getPositionDetails(e,t){var n,a,l,f;if((e=e||{}).disableHashing=!0,!(n=createGame(e)))return null;if(t){if(!(l=n.move(t)))return null;n.extended||normalizeMoveObj(l)}return f=n.fen(),e.skipValidation||n.isPositionValid(e)?(a=f.split(" "),{fen:f,pieces:getPieces(n),sideToMove:n.turn(),castling:a[2],epSquare:"-"===a[3]?null:a[3],halfMoves:+a[4],moveNumber:+a[5],move:l,hand:n.hand(),checks:n.checks()}):null},jce.predict=function predict(e,t){var n=Math.min(Math.max(.20773843*Math.atan(2.49085889*e/100-2.47841945*t/100)+.02262979*e/100-.02256839*t/100+.52239679,0),1),a=Math.min(Math.max(-.20720905*Math.atan(2.49626837*e/100-2.48220286*t/100)+-.02352551*e/100+.02172627*t/100+.49443923,0),1),l=Math.min(Math.max(Math.exp(.037043456*e/100+.178106427*t/100-8.069742932)+.004823544*Math.exp(-1.364136591*Math.pow(e/100-t/100,2))+-.001625539,0),1),f=n+a+l;return{w:n/f,b:a/f,d:l/f}},jce.normalizeMoveObj=normalizeMoveObj,jce.FLAGS=a.FLAGS,jce.loadECO=function loadECO(e,n){t.loadBook(e,(function onload(e,a){if(!a||!a.json)return n(e||new Error("Invalid book"));n(e,(function queryECO(e){var n,l,f,p,h,m,g,v,y;if(e.hash)l="string"==typeof e.hash?[t.hex64ToDec(e.hash)]:[e.hash],p=1;else{if(!(n=createGame(e)))return!1;p=(l=n.hashes()).length}for(f=0;f<p;++f)if(h=a.json[t.to64BitHex(l[f])]){if(h.constructor===Array)if(m&&-1===h[0].m.indexOf(m.m)){for(v=h.length-1;v>=0;--v)if(!v||-1!==h[v].m.indexOf(m.m)){(y=h[v]).e=h[0].e,y.s=h[0].s,y.mate=h[0].mate,y.v=h[0].v,y.h=h[0].h,y.n=y.n||h[0].n,y.u=y.u||h[0].u,y.c=y.c||h[0].c;break}}else y=h[0];else y=h;(y.n||e.allowNameless)&&(m=y)}else e.mustEndInBook&&(m=void 0);if(m)return g={name:m.n},m.m&&(g.moves=m.m),void 0!==m.d&&(g.sdiff=m.d/100),m.c&&(g.code=m.c,g.url=m.u||m.n.replace(/[\u00e1-\u00e5]/g,"a").replace(/[\u0107\u010d]/g,"c").replace(/[\u00e9\u00e8\u0117\u0113]/g,"e").replace(/[\u00f3\u00f6\u00f8]/g,"o").replace(/[\u016f\u00fc]/g,"u").replace(/['+,]/g,"").replace(/[^a-z0-9.]+/gi,"-").replace(/(with-\d|St)\.+-?/,"$1-")),m.e?(g.eval=m.e,g.depth=m.h,g.score=m.e[0].cp/100,void 0!==m.e[0].mate&&(g.mate=m.e[0].mate)):(g.score=m.s/100,void 0!==m.mate&&(g.mate=m.mate)),m.v&&(g.bad=!0),g}),a.json)}))},jce}(),e.exports=f}(l);var f,p,h=l.exports;function createEventEmitter(){const e=[];return{emit:function emit(t,n){let a;for(a of e)a.type!==t&&"all"!==a.type||a.handler(n)},listeners:e,off:off,offAll:function offAll(e){return off({handler:e,type:"all"})},offMany:function offMany(e=[]){e.forEach((e=>off(e)))},on:on,onAll:function onAll(e){on("all",e)},onMany:function onMany(e=[],t){e.forEach((e=>on(e,t)))},once:function once(t,n){const a={handler:(...e)=>{off(a),n(...e)},type:t};e.push(a)}};function off(t){const n=e.findIndex((e=>t.type===e.type&&t.handler===e.handler));-1!==n&&e.splice(n,1)}function on(t,n){const a={handler:n,type:t};e.push(a)}}function createStateMachine({data:e,initialState:t,states:n},a=createEventEmitter()){let l=t;return Object.assign(Object.assign({},a),{getCurrentState:function getCurrentState(){return l},getData:function getData(){return Object.assign({},e)},transition:function transition(t,p){if(!n[l][t])return a.emit(f.Event.Types.NoTransition,{action:t,data:e,state:l}),!1;const h=n[l][t](p),m="string"==typeof h?h:h.nextState,buildEvent=n=>({action:t,currentState:l,data:e,event:n,nextState:m,params:p});l!==m&&a.emit(f.Event.Types.OnExit,buildEvent(f.Event.Types.OnExit));h.data&&Object.assign(e,h.data);l!==m&&a.emit(f.Event.Types.OnEnter,buildEvent(f.Event.Types.OnEnter));l===m?a.emit(f.Event.Types.OnReEnter,buildEvent(f.Event.Types.OnReEnter)):l=m;return!0}})}(function(e){var t;(t=e.Types||(e.Types={})).NoTransition="NoTransition",t.OnEnter="Enter",t.OnExit="Exit",t.OnReEnter="ReEnter"})((p=f||(f={})).Event||(p.Event={}));const m=["mousedown","keydown","touchstart","touchend"];let g=!1;const v=window.chesscom||{},y=window.AudioContext||window.webkitAudioContext;let _=Boolean(y);function isSuspended(){return _}function resumeAudio(e){if(y){if(v.audioContext||(v.audioContext=function newAudioContext(){try{return new y}catch(e){return null}}()),!v.audioContext||!v.audioContext.resume)return _=!1,void e();v.audioContext.resume().then((()=>{_=!1,e()}))}}var b="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{};
/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
var C,S,k=function createCommonjsModule(e){var t={exports:{}};return e(t,t.exports),t.exports}((function(e,t){!function(){var HowlerGlobal2=function(){this.init()};HowlerGlobal2.prototype={init:function(){var t=this||e;return t._counter=1e3,t._html5AudioPool=[],t.html5PoolSize=10,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.autoUnlock=!0,t._setup(),t},volume:function(t){var n=this||e;if(t=parseFloat(t),n.ctx||setupAudioContext(),void 0!==t&&t>=0&&t<=1){if(n._volume=t,n._muted)return n;n.usingWebAudio&&n.masterGain.gain.setValueAtTime(t,e.ctx.currentTime);for(var a=0;a<n._howls.length;a++)if(!n._howls[a]._webAudio)for(var l=n._howls[a]._getSoundIds(),f=0;f<l.length;f++){var p=n._howls[a]._soundById(l[f]);p&&p._node&&(p._node.volume=p._volume*t)}return n}return n._volume},mute:function(t){var n=this||e;n.ctx||setupAudioContext(),n._muted=t,n.usingWebAudio&&n.masterGain.gain.setValueAtTime(t?0:n._volume,e.ctx.currentTime);for(var a=0;a<n._howls.length;a++)if(!n._howls[a]._webAudio)for(var l=n._howls[a]._getSoundIds(),f=0;f<l.length;f++){var p=n._howls[a]._soundById(l[f]);p&&p._node&&(p._node.muted=!!t||p._muted)}return n},stop:function(){for(var t=this||e,n=0;n<t._howls.length;n++)t._howls[n].stop();return t},unload:function(){for(var t=this||e,n=t._howls.length-1;n>=0;n--)t._howls[n].unload();return t.usingWebAudio&&t.ctx&&void 0!==t.ctx.close&&(t.ctx.close(),t.ctx=null,setupAudioContext()),t},codecs:function(t){return(this||e)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||e;if(t.state=t.ctx&&t.ctx.state||"suspended",t._autoSuspend(),!t.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(t._canPlayEvent="canplay")}catch(n){t.noAudio=!0}else t.noAudio=!0;try{(new Audio).muted&&(t.noAudio=!0)}catch(n){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var t=this||e,n=null;try{n="undefined"!=typeof Audio?new Audio:null}catch(v){return t}if(!n||"function"!=typeof n.canPlayType)return t;var a=n.canPlayType("audio/mpeg;").replace(/^no$/,""),l=t._navigator?t._navigator.userAgent:"",f=l.match(/OPR\/([0-6].)/g),p=f&&parseInt(f[0].split("/")[1],10)<33,h=-1!==l.indexOf("Safari")&&-1===l.indexOf("Chrome"),m=l.match(/Version\/(.*?) /),g=h&&m&&parseInt(m[1],10)<15;return t._codecs={mp3:!(p||!a&&!n.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!a,opus:!!n.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(n.canPlayType('audio/wav; codecs="1"')||n.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!n.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!n.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(n.canPlayType("audio/x-m4a;")||n.canPlayType("audio/m4a;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(n.canPlayType("audio/x-m4b;")||n.canPlayType("audio/m4b;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(n.canPlayType("audio/x-mp4;")||n.canPlayType("audio/mp4;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(g||!n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(g||!n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!n.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(n.canPlayType("audio/x-flac;")||n.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_unlockAudio:function(){var t=this||e;if(!t._audioUnlocked&&t.ctx){t._audioUnlocked=!1,t.autoUnlock=!1,t._mobileUnloaded||44100===t.ctx.sampleRate||(t._mobileUnloaded=!0,t.unload()),t._scratchBuffer=t.ctx.createBuffer(1,1,22050);var unlock=function(e){for(;t._html5AudioPool.length<t.html5PoolSize;)try{var n=new Audio;n._unlocked=!0,t._releaseHtml5Audio(n)}catch(m){t.noAudio=!0;break}for(var a=0;a<t._howls.length;a++)if(!t._howls[a]._webAudio)for(var l=t._howls[a]._getSoundIds(),f=0;f<l.length;f++){var p=t._howls[a]._soundById(l[f]);p&&p._node&&!p._node._unlocked&&(p._node._unlocked=!0,p._node.load())}t._autoResume();var h=t.ctx.createBufferSource();h.buffer=t._scratchBuffer,h.connect(t.ctx.destination),void 0===h.start?h.noteOn(0):h.start(0),"function"==typeof t.ctx.resume&&t.ctx.resume(),h.onended=function(){h.disconnect(0),t._audioUnlocked=!0,document.removeEventListener("touchstart",unlock,!0),document.removeEventListener("touchend",unlock,!0),document.removeEventListener("click",unlock,!0),document.removeEventListener("keydown",unlock,!0);for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("unlock")}};return document.addEventListener("touchstart",unlock,!0),document.addEventListener("touchend",unlock,!0),document.addEventListener("click",unlock,!0),document.addEventListener("keydown",unlock,!0),t}},_obtainHtml5Audio:function(){var t=this||e;if(t._html5AudioPool.length)return t._html5AudioPool.pop();var n=(new Audio).play();return n&&"undefined"!=typeof Promise&&(n instanceof Promise||"function"==typeof n.then)&&n.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(t){var n=this||e;return t._unlocked&&n._html5AudioPool.push(t),n},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&void 0!==t.ctx.suspend&&e.usingWebAudio){for(var n=0;n<t._howls.length;n++)if(t._howls[n]._webAudio)for(var a=0;a<t._howls[n]._sounds.length;a++)if(!t._howls[n]._sounds[a]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout((function(){if(t.autoSuspend){t._suspendTimer=null,t.state="suspending";var handleSuspension=function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())};t.ctx.suspend().then(handleSuspension,handleSuspension)}}),3e4),t}},_autoResume:function(){var t=this;if(t.ctx&&void 0!==t.ctx.resume&&e.usingWebAudio)return"running"===t.state&&"interrupted"!==t.ctx.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state||"running"===t.state&&"interrupted"===t.ctx.state?(t.ctx.resume().then((function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")})),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};var e=new HowlerGlobal2,Howl2=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};Howl2.prototype={init:function(t){var n=this;return e.ctx||setupAudioContext(),n._autoplay=t.autoplay||!1,n._format="string"!=typeof t.format?t.format:[t.format],n._html5=t.html5||!1,n._muted=t.mute||!1,n._loop=t.loop||!1,n._pool=t.pool||5,n._preload="boolean"!=typeof t.preload&&"metadata"!==t.preload||t.preload,n._rate=t.rate||1,n._sprite=t.sprite||{},n._src="string"!=typeof t.src?t.src:[t.src],n._volume=void 0!==t.volume?t.volume:1,n._xhr={method:t.xhr&&t.xhr.method?t.xhr.method:"GET",headers:t.xhr&&t.xhr.headers?t.xhr.headers:null,withCredentials:!(!t.xhr||!t.xhr.withCredentials)&&t.xhr.withCredentials},n._duration=0,n._state="unloaded",n._sounds=[],n._endTimers={},n._queue=[],n._playLock=!1,n._onend=t.onend?[{fn:t.onend}]:[],n._onfade=t.onfade?[{fn:t.onfade}]:[],n._onload=t.onload?[{fn:t.onload}]:[],n._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],n._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],n._onpause=t.onpause?[{fn:t.onpause}]:[],n._onplay=t.onplay?[{fn:t.onplay}]:[],n._onstop=t.onstop?[{fn:t.onstop}]:[],n._onmute=t.onmute?[{fn:t.onmute}]:[],n._onvolume=t.onvolume?[{fn:t.onvolume}]:[],n._onrate=t.onrate?[{fn:t.onrate}]:[],n._onseek=t.onseek?[{fn:t.onseek}]:[],n._onunlock=t.onunlock?[{fn:t.onunlock}]:[],n._onresume=[],n._webAudio=e.usingWebAudio&&!n._html5,void 0!==e.ctx&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(n),n._autoplay&&n._queue.push({event:"play",action:function(){n.play()}}),n._preload&&"none"!==n._preload&&n.load(),n},load:function(){var t=this,n=null;if(e.noAudio)t._emit("loaderror",null,"No audio support.");else{"string"==typeof t._src&&(t._src=[t._src]);for(var a=0;a<t._src.length;a++){var l,f;if(t._format&&t._format[a])l=t._format[a];else{if("string"!=typeof(f=t._src[a])){t._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(l=/^data:audio\/([^;,]+);/i.exec(f))||(l=/\.([^.]+)$/.exec(f.split("?",1)[0])),l&&(l=l[1].toLowerCase())}if(l||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),l&&e.codecs(l)){n=t._src[a];break}}if(n)return t._src=n,t._state="loading","https:"===window.location.protocol&&"http:"===n.slice(0,5)&&(t._html5=!0,t._webAudio=!1),new Sound2(t),t._webAudio&&loadBuffer(t),t;t._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(t,n){var a=this,l=null;if("number"==typeof t)l=t,t=null;else{if("string"==typeof t&&"loaded"===a._state&&!a._sprite[t])return null;if(void 0===t&&(t="__default",!a._playLock)){for(var f=0,p=0;p<a._sounds.length;p++)a._sounds[p]._paused&&!a._sounds[p]._ended&&(f++,l=a._sounds[p]._id);1===f?t=null:l=null}}var h=l?a._soundById(l):a._inactiveSound();if(!h)return null;if(l&&!t&&(t=h._sprite||"__default"),"loaded"!==a._state){h._sprite=t,h._ended=!1;var m=h._id;return a._queue.push({event:"play",action:function(){a.play(m)}}),m}if(l&&!h._paused)return n||a._loadQueue("play"),h._id;a._webAudio&&e._autoResume();var g=Math.max(0,h._seek>0?h._seek:a._sprite[t][0]/1e3),v=Math.max(0,(a._sprite[t][0]+a._sprite[t][1])/1e3-g),y=1e3*v/Math.abs(h._rate),_=a._sprite[t][0]/1e3,b=(a._sprite[t][0]+a._sprite[t][1])/1e3;h._sprite=t,h._ended=!1;var setParams=function(){h._paused=!1,h._seek=g,h._start=_,h._stop=b,h._loop=!(!h._loop&&!a._sprite[t][2])};if(!(g>=b)){var C=h._node;if(a._webAudio){var playWebAudio=function(){a._playLock=!1,setParams(),a._refreshBuffer(h);var t=h._muted||a._muted?0:h._volume;C.gain.setValueAtTime(t,e.ctx.currentTime),h._playStart=e.ctx.currentTime,void 0===C.bufferSource.start?h._loop?C.bufferSource.noteGrainOn(0,g,86400):C.bufferSource.noteGrainOn(0,g,v):h._loop?C.bufferSource.start(0,g,86400):C.bufferSource.start(0,g,v),y!==1/0&&(a._endTimers[h._id]=setTimeout(a._ended.bind(a,h),y)),n||setTimeout((function(){a._emit("play",h._id),a._loadQueue()}),0)};"running"===e.state&&"interrupted"!==e.ctx.state?playWebAudio():(a._playLock=!0,a.once("resume",playWebAudio),a._clearTimer(h._id))}else{var playHtml5=function(){C.currentTime=g,C.muted=h._muted||a._muted||e._muted||C.muted,C.volume=h._volume*e.volume(),C.playbackRate=h._rate;try{var l=C.play();if(l&&"undefined"!=typeof Promise&&(l instanceof Promise||"function"==typeof l.then)?(a._playLock=!0,setParams(),l.then((function(){a._playLock=!1,C._unlocked=!0,n?a._loadQueue():a._emit("play",h._id)})).catch((function(){a._playLock=!1,a._emit("playerror",h._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),h._ended=!0,h._paused=!0}))):n||(a._playLock=!1,setParams(),a._emit("play",h._id)),C.playbackRate=h._rate,C.paused)return void a._emit("playerror",h._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==t||h._loop?a._endTimers[h._id]=setTimeout(a._ended.bind(a,h),y):(a._endTimers[h._id]=function(){a._ended(h),C.removeEventListener("ended",a._endTimers[h._id],!1)},C.addEventListener("ended",a._endTimers[h._id],!1))}catch(f){a._emit("playerror",h._id,f)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===C.src&&(C.src=a._src,C.load());var S=window&&window.ejecta||!C.readyState&&e._navigator.isCocoonJS;if(C.readyState>=3||S)playHtml5();else{a._playLock=!0,a._state="loading";var listener=function(){a._state="loaded",playHtml5(),C.removeEventListener(e._canPlayEvent,listener,!1)};C.addEventListener(e._canPlayEvent,listener,!1),a._clearTimer(h._id)}}return h._id}a._ended(h)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var n=t._getSoundIds(e),a=0;a<n.length;a++){t._clearTimer(n[a]);var l=t._soundById(n[a]);if(l&&!l._paused&&(l._seek=t.seek(n[a]),l._rateSeek=0,l._paused=!0,t._stopFade(n[a]),l._node))if(t._webAudio){if(!l._node.bufferSource)continue;void 0===l._node.bufferSource.stop?l._node.bufferSource.noteOff(0):l._node.bufferSource.stop(0),t._cleanBuffer(l._node)}else isNaN(l._node.duration)&&l._node.duration!==1/0||l._node.pause();arguments[1]||t._emit("pause",l?l._id:null)}return t},stop:function(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var a=n._getSoundIds(e),l=0;l<a.length;l++){n._clearTimer(a[l]);var f=n._soundById(a[l]);f&&(f._seek=f._start||0,f._rateSeek=0,f._paused=!0,f._ended=!0,n._stopFade(a[l]),f._node&&(n._webAudio?f._node.bufferSource&&(void 0===f._node.bufferSource.stop?f._node.bufferSource.noteOff(0):f._node.bufferSource.stop(0),n._cleanBuffer(f._node)):isNaN(f._node.duration)&&f._node.duration!==1/0||(f._node.currentTime=f._start||0,f._node.pause(),f._node.duration===1/0&&n._clearSound(f._node))),t||n._emit("stop",f._id))}return n},mute:function(t,n){var a=this;if("loaded"!==a._state||a._playLock)return a._queue.push({event:"mute",action:function(){a.mute(t,n)}}),a;if(void 0===n){if("boolean"!=typeof t)return a._muted;a._muted=t}for(var l=a._getSoundIds(n),f=0;f<l.length;f++){var p=a._soundById(l[f]);p&&(p._muted=t,p._interval&&a._stopFade(p._id),a._webAudio&&p._node?p._node.gain.setValueAtTime(t?0:p._volume,e.ctx.currentTime):p._node&&(p._node.muted=!!e._muted||t),a._emit("mute",p._id))}return a},volume:function(){var t,n,a,l=this,f=arguments;if(0===f.length)return l._volume;if(1===f.length||2===f.length&&void 0===f[1]){var p=l._getSoundIds(),h=p.indexOf(f[0]);h>=0?n=parseInt(f[0],10):t=parseFloat(f[0])}else f.length>=2&&(t=parseFloat(f[0]),n=parseInt(f[1],10));if(!(void 0!==t&&t>=0&&t<=1))return(a=n?l._soundById(n):l._sounds[0])?a._volume:0;if("loaded"!==l._state||l._playLock)return l._queue.push({event:"volume",action:function(){l.volume.apply(l,f)}}),l;void 0===n&&(l._volume=t),n=l._getSoundIds(n);for(var m=0;m<n.length;m++)(a=l._soundById(n[m]))&&(a._volume=t,f[2]||l._stopFade(n[m]),l._webAudio&&a._node&&!a._muted?a._node.gain.setValueAtTime(t,e.ctx.currentTime):a._node&&!a._muted&&(a._node.volume=t*e.volume()),l._emit("volume",a._id));return l},fade:function(t,n,a,l){var f=this;if("loaded"!==f._state||f._playLock)return f._queue.push({event:"fade",action:function(){f.fade(t,n,a,l)}}),f;t=Math.min(Math.max(0,parseFloat(t)),1),n=Math.min(Math.max(0,parseFloat(n)),1),a=parseFloat(a),f.volume(t,l);for(var p=f._getSoundIds(l),h=0;h<p.length;h++){var m=f._soundById(p[h]);if(m){if(l||f._stopFade(p[h]),f._webAudio&&!m._muted){var g=e.ctx.currentTime,v=g+a/1e3;m._volume=t,m._node.gain.setValueAtTime(t,g),m._node.gain.linearRampToValueAtTime(n,v)}f._startFadeInterval(m,t,n,a,p[h],void 0===l)}}return f},_startFadeInterval:function(e,t,n,a,l,f){var p=this,h=t,m=n-t,g=Math.abs(m/.01),v=Math.max(4,g>0?a/g:a),y=Date.now();e._fadeTo=n,e._interval=setInterval((function(){var l=(Date.now()-y)/a;y=Date.now(),h+=m*l,h=Math.round(100*h)/100,h=m<0?Math.max(n,h):Math.min(n,h),p._webAudio?e._volume=h:p.volume(h,e._id,!0),f&&(p._volume=h),(n<t&&h<=n||n>t&&h>=n)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,p.volume(n,e._id),p._emit("fade",e._id))}),v)},_stopFade:function(t){var n=this,a=n._soundById(t);return a&&a._interval&&(n._webAudio&&a._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(a._interval),a._interval=null,n.volume(a._fadeTo,t),a._fadeTo=null,n._emit("fade",t)),n},loop:function(){var e,t,n,a=this,l=arguments;if(0===l.length)return a._loop;if(1===l.length){if("boolean"!=typeof l[0])return!!(n=a._soundById(parseInt(l[0],10)))&&n._loop;e=l[0],a._loop=e}else 2===l.length&&(e=l[0],t=parseInt(l[1],10));for(var f=a._getSoundIds(t),p=0;p<f.length;p++)(n=a._soundById(f[p]))&&(n._loop=e,a._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=e,e&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop,a.playing(f[p])&&(a.pause(f[p],!0),a.play(f[p],!0)))));return a},rate:function(){var t,n,a,l=this,f=arguments;if(0===f.length)n=l._sounds[0]._id;else if(1===f.length){var p=l._getSoundIds(),h=p.indexOf(f[0]);h>=0?n=parseInt(f[0],10):t=parseFloat(f[0])}else 2===f.length&&(t=parseFloat(f[0]),n=parseInt(f[1],10));if("number"!=typeof t)return(a=l._soundById(n))?a._rate:l._rate;if("loaded"!==l._state||l._playLock)return l._queue.push({event:"rate",action:function(){l.rate.apply(l,f)}}),l;void 0===n&&(l._rate=t),n=l._getSoundIds(n);for(var m=0;m<n.length;m++)if(a=l._soundById(n[m])){l.playing(n[m])&&(a._rateSeek=l.seek(n[m]),a._playStart=l._webAudio?e.ctx.currentTime:a._playStart),a._rate=t,l._webAudio&&a._node&&a._node.bufferSource?a._node.bufferSource.playbackRate.setValueAtTime(t,e.ctx.currentTime):a._node&&(a._node.playbackRate=t);var g=l.seek(n[m]),v=(l._sprite[a._sprite][0]+l._sprite[a._sprite][1])/1e3-g,y=1e3*v/Math.abs(a._rate);!l._endTimers[n[m]]&&a._paused||(l._clearTimer(n[m]),l._endTimers[n[m]]=setTimeout(l._ended.bind(l,a),y)),l._emit("rate",a._id)}return l},seek:function(){var t,n,a=this,l=arguments;if(0===l.length)a._sounds.length&&(n=a._sounds[0]._id);else if(1===l.length){var f=a._getSoundIds(),p=f.indexOf(l[0]);p>=0?n=parseInt(l[0],10):a._sounds.length&&(n=a._sounds[0]._id,t=parseFloat(l[0]))}else 2===l.length&&(t=parseFloat(l[0]),n=parseInt(l[1],10));if(void 0===n)return 0;if("number"==typeof t&&("loaded"!==a._state||a._playLock))return a._queue.push({event:"seek",action:function(){a.seek.apply(a,l)}}),a;var h=a._soundById(n);if(h){if(!("number"==typeof t&&t>=0)){if(a._webAudio){var m=a.playing(n)?e.ctx.currentTime-h._playStart:0,g=h._rateSeek?h._rateSeek-h._seek:0;return h._seek+(g+m*Math.abs(h._rate))}return h._node.currentTime}var v=a.playing(n);v&&a.pause(n,!0),h._seek=t,h._ended=!1,a._clearTimer(n),a._webAudio||!h._node||isNaN(h._node.duration)||(h._node.currentTime=t);var seekAndEmit=function(){v&&a.play(n,!0),a._emit("seek",n)};if(v&&!a._webAudio){var emitSeek=function(){a._playLock?setTimeout(emitSeek,0):seekAndEmit()};setTimeout(emitSeek,0)}else seekAndEmit()}return a},playing:function(e){var t=this;if("number"==typeof e){var n=t._soundById(e);return!!n&&!n._paused}for(var a=0;a<t._sounds.length;a++)if(!t._sounds[a]._paused)return!0;return!1},duration:function(e){var t=this,n=t._duration,a=t._soundById(e);return a&&(n=t._sprite[a._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var t=this,a=t._sounds,l=0;l<a.length;l++)a[l]._paused||t.stop(a[l]._id),t._webAudio||(t._clearSound(a[l]._node),a[l]._node.removeEventListener("error",a[l]._errorFn,!1),a[l]._node.removeEventListener(e._canPlayEvent,a[l]._loadFn,!1),a[l]._node.removeEventListener("ended",a[l]._endFn,!1),e._releaseHtml5Audio(a[l]._node)),delete a[l]._node,t._clearTimer(a[l]._id);var f=e._howls.indexOf(t);f>=0&&e._howls.splice(f,1);var p=!0;for(l=0;l<e._howls.length;l++)if(e._howls[l]._src===t._src||t._src.indexOf(e._howls[l]._src)>=0){p=!1;break}return n&&p&&delete n[t._src],e.noAudio=!1,t._state="unloaded",t._sounds=[],t=null,null},on:function(e,t,n,a){var l=this["_on"+e];return"function"==typeof t&&l.push(a?{id:n,fn:t,once:a}:{id:n,fn:t}),this},off:function(e,t,n){var a=this,l=a["_on"+e],f=0;if("number"==typeof t&&(n=t,t=null),t||n)for(f=0;f<l.length;f++){var p=n===l[f].id;if(t===l[f].fn&&p||!t&&p){l.splice(f,1);break}}else if(e)a["_on"+e]=[];else{var h=Object.keys(a);for(f=0;f<h.length;f++)0===h[f].indexOf("_on")&&Array.isArray(a[h[f]])&&(a[h[f]]=[])}return a},once:function(e,t,n){return this.on(e,t,n,1),this},_emit:function(e,t,n){for(var a=this,l=a["_on"+e],f=l.length-1;f>=0;f--)l[f].id&&l[f].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,n)}.bind(a,l[f].fn),0),l[f].once&&a.off(e,l[f].fn,l[f].id));return a._loadQueue(e),a},_loadQueue:function(e){var t=this;if(t._queue.length>0){var n=t._queue[0];n.event===e&&(t._queue.shift(),t._loadQueue()),e||n.action()}return t},_ended:function(t){var n=this,a=t._sprite;if(!n._webAudio&&t._node&&!t._node.paused&&!t._node.ended&&t._node.currentTime<t._stop)return setTimeout(n._ended.bind(n,t),100),n;var l=!(!t._loop&&!n._sprite[a][2]);if(n._emit("end",t._id),!n._webAudio&&l&&n.stop(t._id,!0).play(t._id),n._webAudio&&l){n._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=e.ctx.currentTime;var f=1e3*(t._stop-t._start)/Math.abs(t._rate);n._endTimers[t._id]=setTimeout(n._ended.bind(n,t),f)}return n._webAudio&&!l&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,n._clearTimer(t._id),n._cleanBuffer(t._node),e._autoSuspend()),n._webAudio||l||n.stop(t._id,!0),n},_clearTimer:function(e){var t=this;if(t._endTimers[e]){if("function"!=typeof t._endTimers[e])clearTimeout(t._endTimers[e]);else{var n=t._soundById(e);n&&n._node&&n._node.removeEventListener("ended",t._endTimers[e],!1)}delete t._endTimers[e]}return t},_soundById:function(e){for(var t=this,n=0;n<t._sounds.length;n++)if(e===t._sounds[n]._id)return t._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new Sound2(e)},_drain:function(){var e=this,t=e._pool,n=0,a=0;if(!(e._sounds.length<t)){for(a=0;a<e._sounds.length;a++)e._sounds[a]._ended&&n++;for(a=e._sounds.length-1;a>=0;a--){if(n<=t)return;e._sounds[a]._ended&&(e._webAudio&&e._sounds[a]._node&&e._sounds[a]._node.disconnect(0),e._sounds.splice(a,1),n--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],n=0;n<this._sounds.length;n++)t.push(this._sounds[n]._id);return t}return[e]},_refreshBuffer:function(t){return t._node.bufferSource=e.ctx.createBufferSource(),t._node.bufferSource.buffer=n[this._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop||0),t._node.bufferSource.playbackRate.setValueAtTime(t._rate,e.ctx.currentTime),this},_cleanBuffer:function(t){var n=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(e._scratchBuffer&&t.bufferSource&&(t.bufferSource.onended=null,t.bufferSource.disconnect(0),n))try{t.bufferSource.buffer=e._scratchBuffer}catch(a){}return t.bufferSource=null,this},_clearSound:function(t){/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent)||(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var Sound2=function(e){this._parent=e,this.init()};Sound2.prototype={init:function(){var t=this,n=t._parent;return t._muted=n._muted,t._loop=n._loop,t._volume=n._volume,t._rate=n._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++e._counter,n._sounds.push(t),t.create(),t},create:function(){var t=this,n=t._parent,a=e._muted||t._muted||t._parent._muted?0:t._volume;return n._webAudio?(t._node=void 0===e.ctx.createGain?e.ctx.createGainNode():e.ctx.createGain(),t._node.gain.setValueAtTime(a,e.ctx.currentTime),t._node.paused=!0,t._node.connect(e.masterGain)):e.noAudio||(t._node=e._obtainHtml5Audio(),t._errorFn=t._errorListener.bind(t),t._node.addEventListener("error",t._errorFn,!1),t._loadFn=t._loadListener.bind(t),t._node.addEventListener(e._canPlayEvent,t._loadFn,!1),t._endFn=t._endListener.bind(t),t._node.addEventListener("ended",t._endFn,!1),t._node.src=n._src,t._node.preload=!0===n._preload?"auto":n._preload,t._node.volume=a*e.volume(),t._node.load()),t},reset:function(){var t=this,n=t._parent;return t._muted=n._muted,t._loop=n._loop,t._volume=n._volume,t._rate=n._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++e._counter,t},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var t=this,n=t._parent;n._duration=Math.ceil(10*t._node.duration)/10,0===Object.keys(n._sprite).length&&(n._sprite={__default:[0,1e3*n._duration]}),"loaded"!==n._state&&(n._state="loaded",n._emit("load"),n._loadQueue()),t._node.removeEventListener(e._canPlayEvent,t._loadFn,!1)},_endListener:function(){var e=this,t=e._parent;t._duration===1/0&&(t._duration=Math.ceil(10*e._node.duration)/10,t._sprite.__default[1]===1/0&&(t._sprite.__default[1]=1e3*t._duration),t._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var n={},loadBuffer=function(e){var t=e._src;if(n[t])return e._duration=n[t].duration,void loadSound2(e);if(/^data:[^;]+;base64,/.test(t)){for(var a=atob(t.split(",")[1]),l=new Uint8Array(a.length),f=0;f<a.length;++f)l[f]=a.charCodeAt(f);decodeAudioData(l.buffer,e)}else{var p=new XMLHttpRequest;p.open(e._xhr.method,t,!0),p.withCredentials=e._xhr.withCredentials,p.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach((function(t){p.setRequestHeader(t,e._xhr.headers[t])})),p.onload=function(){var t=(p.status+"")[0];"0"===t||"2"===t||"3"===t?decodeAudioData(p.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+p.status+".")},p.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete n[t],e.load())},safeXhrSend(p)}},safeXhrSend=function(e){try{e.send()}catch(t){e.onerror()}},decodeAudioData=function(t,a){var error=function(){a._emit("loaderror",null,"Decoding audio data failed.")},success=function(e){e&&a._sounds.length>0?(n[a._src]=e,loadSound2(a,e)):error()};"undefined"!=typeof Promise&&1===e.ctx.decodeAudioData.length?e.ctx.decodeAudioData(t).then(success).catch(error):e.ctx.decodeAudioData(t,success,error)},loadSound2=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},setupAudioContext=function(){if(e.usingWebAudio){try{"undefined"!=typeof AudioContext?e.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch(f){e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var t=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),n=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),a=n?parseInt(n[1],10):null;if(t&&a&&a<9){var l=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!l&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=void 0===e.ctx.createGain?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};t.Howler=e,t.Howl=Howl2,void 0!==b?(b.HowlerGlobal=HowlerGlobal2,b.Howler=e,b.Howl=Howl2,b.Sound=Sound2):"undefined"!=typeof window&&(window.HowlerGlobal=HowlerGlobal2,window.Howler=e,window.Howl=Howl2,window.Sound=Sound2)}(),
/*!
   *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
   *  
   *  howler.js v2.2.3
   *  howlerjs.com
   *
   *  (c) 2013-2020, James Simpson of GoldFire Studios
   *  goldfirestudios.com
   *
   *  MIT License
   */
function(){var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var n=t._howls.length-1;n>=0;n--)t._howls[n].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,n){var a=this;return a.ctx&&a.ctx.listener?(t="number"!=typeof t?a._pos[1]:t,n="number"!=typeof n?a._pos[2]:n,"number"!=typeof e?a._pos:(a._pos=[e,t,n],void 0!==a.ctx.listener.positionX?(a.ctx.listener.positionX.setTargetAtTime(a._pos[0],Howler.ctx.currentTime,.1),a.ctx.listener.positionY.setTargetAtTime(a._pos[1],Howler.ctx.currentTime,.1),a.ctx.listener.positionZ.setTargetAtTime(a._pos[2],Howler.ctx.currentTime,.1)):a.ctx.listener.setPosition(a._pos[0],a._pos[1],a._pos[2]),a)):a},HowlerGlobal.prototype.orientation=function(e,t,n,a,l,f){var p=this;if(!p.ctx||!p.ctx.listener)return p;var h=p._orientation;return t="number"!=typeof t?h[1]:t,n="number"!=typeof n?h[2]:n,a="number"!=typeof a?h[3]:a,l="number"!=typeof l?h[4]:l,f="number"!=typeof f?h[5]:f,"number"!=typeof e?h:(p._orientation=[e,t,n,a,l,f],void 0!==p.ctx.listener.forwardX?(p.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),p.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),p.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),p.ctx.listener.upX.setTargetAtTime(a,Howler.ctx.currentTime,.1),p.ctx.listener.upY.setTargetAtTime(l,Howler.ctx.currentTime,.1),p.ctx.listener.upZ.setTargetAtTime(f,Howler.ctx.currentTime,.1)):p.ctx.listener.setOrientation(e,t,n,a,l,f),p)},Howl.prototype.init=(e=Howl.prototype.init,function(t){var n=this;return n._orientation=t.orientation||[1,0,0],n._stereo=t.stereo||null,n._pos=t.pos||null,n._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},n._onstereo=t.onstereo?[{fn:t.onstereo}]:[],n._onpos=t.onpos?[{fn:t.onpos}]:[],n._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,t){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"stereo",action:function(){n.stereo(e,t)}}),n;var a=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===t){if("number"!=typeof e)return n._stereo;n._stereo=e,n._pos=[e,0,0]}for(var l=n._getSoundIds(t),f=0;f<l.length;f++){var p=n._soundById(l[f]);if(p){if("number"!=typeof e)return p._stereo;p._stereo=e,p._pos=[e,0,0],p._node&&(p._pannerAttr.panningModel="equalpower",p._panner&&p._panner.pan||setupPanner(p,a),"spatial"===a?void 0!==p._panner.positionX?(p._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),p._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),p._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):p._panner.setPosition(e,0,0):p._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),n._emit("stereo",p._id)}}return n},Howl.prototype.pos=function(e,t,n,a){var l=this;if(!l._webAudio)return l;if("loaded"!==l._state)return l._queue.push({event:"pos",action:function(){l.pos(e,t,n,a)}}),l;if(t="number"!=typeof t?0:t,n="number"!=typeof n?-.5:n,void 0===a){if("number"!=typeof e)return l._pos;l._pos=[e,t,n]}for(var f=l._getSoundIds(a),p=0;p<f.length;p++){var h=l._soundById(f[p]);if(h){if("number"!=typeof e)return h._pos;h._pos=[e,t,n],h._node&&(h._panner&&!h._panner.pan||setupPanner(h,"spatial"),void 0!==h._panner.positionX?(h._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(t,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):h._panner.setPosition(e,t,n)),l._emit("pos",h._id)}}return l},Howl.prototype.orientation=function(e,t,n,a){var l=this;if(!l._webAudio)return l;if("loaded"!==l._state)return l._queue.push({event:"orientation",action:function(){l.orientation(e,t,n,a)}}),l;if(t="number"!=typeof t?l._orientation[1]:t,n="number"!=typeof n?l._orientation[2]:n,void 0===a){if("number"!=typeof e)return l._orientation;l._orientation=[e,t,n]}for(var f=l._getSoundIds(a),p=0;p<f.length;p++){var h=l._soundById(f[p]);if(h){if("number"!=typeof e)return h._orientation;h._orientation=[e,t,n],h._node&&(h._panner||(h._pos||(h._pos=l._pos||[0,0,-.5]),setupPanner(h,"spatial")),void 0!==h._panner.orientationX?(h._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),h._panner.orientationY.setValueAtTime(t,Howler.ctx.currentTime),h._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):h._panner.setOrientation(e,t,n)),l._emit("orientation",h._id)}}return l},Howl.prototype.pannerAttr=function(){var e,t,n,a=this,l=arguments;if(!a._webAudio)return a;if(0===l.length)return a._pannerAttr;if(1===l.length){if("object"!=typeof l[0])return(n=a._soundById(parseInt(l[0],10)))?n._pannerAttr:a._pannerAttr;e=l[0],void 0===t&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),a._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:a._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:a._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:a._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:a._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:a._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:a._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:a._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:a._panningModel})}else 2===l.length&&(e=l[0],t=parseInt(l[1],10));for(var f=a._getSoundIds(t),p=0;p<f.length;p++)if(n=a._soundById(f[p])){var h=n._pannerAttr;h={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:h.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:h.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:h.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:h.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:h.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:h.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:h.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:h.panningModel};var m=n._panner;m?(m.coneInnerAngle=h.coneInnerAngle,m.coneOuterAngle=h.coneOuterAngle,m.coneOuterGain=h.coneOuterGain,m.distanceModel=h.distanceModel,m.maxDistance=h.maxDistance,m.refDistance=h.refDistance,m.rolloffFactor=h.rolloffFactor,m.panningModel=h.panningModel):(n._pos||(n._pos=a._pos||[0,0,-.5]),setupPanner(n,"spatial"))}return a},Sound.prototype.init=function(e){return function(){var t=this,n=t._parent;t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,e.call(this),t._stereo?n.stereo(t._stereo):t._pos&&n.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,n=t._parent;return t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,t._stereo?n.stereo(t._stereo):t._pos?n.pos(t._pos[0],t._pos[1],t._pos[2],t._id):t._panner&&(t._panner.disconnect(0),t._panner=void 0,n._refreshBuffer(t)),e.call(this)}}(Sound.prototype.reset);var setupPanner=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}()}));class Sound$1{constructor(e,t=0,n=!1){this.howler=null,this.tags=[],this.assets=e,this.maxTags=t,this.useHowler=n}load(){this.unload(),this.useHowler?this.howler||(this.howler=new k.Howl({src:this.assets})):this.addTag()}addTag(){const e=document.createElement("audio");e.setAttribute("preload","auto"),this.assets.forEach((t=>{const n=t.split(".").pop(),a="mp3"===n?"audio/mpeg":`audio/${n}`,l=document.createElement("source");l.setAttribute("src",t),l.setAttribute("type",a),e.appendChild(l)})),document.body.appendChild(e),e.pause&&e.pause(),this.tags.push(e)}unload(){var e;if(this.useHowler)null===(e=this.howler)||void 0===e||e.unload();else for(;this.tags.length;){const e=this.tags.shift();(null==e?void 0:e.parentNode)&&e.parentNode.removeChild(e)}}play(){var e;if(this.useHowler)this.howler||this.load(),null===(e=this.howler)||void 0===e||e.play();else{const e=this.tags.find((e=>e.paused||e.ended));if(!e){if(this.tags.length>=this.maxTags)return;return this.addTag(),void this.play()}const t=e.play();t&&t.catch((()=>{}))}}}(S=C||(C={})).Suspended="web-ui-sound-suspended",S.Enabled="web-ui-sound-enabled";let w,T=0,P=!1;function whenEnabled(e){!function waitMessage(e,t){window.addEventListener("message",(function listener(n){var a;(null===(a=null==n?void 0:n.data)||void 0===a?void 0:a.key)===e&&(t(),window.removeEventListener("message",listener))}))}(C.Enabled,e)}function enableSound(){isSuspended()&&resumeAudio((()=>{window.postMessage({key:C.Enabled},window.location.origin),function removeWindowEvents(e){g&&(g=!1,m.forEach((t=>window.removeEventListener(t,e))))}(enableSound)}))}function loadSound(e,t=5,n=!1){const a=new Sound$1(e,t,n);return isSuspended()?(!function addWindowEvents(e){g||(g=!0,m.forEach((t=>window.addEventListener(t,e))))}(enableSound),whenEnabled((()=>a.load()))):a.load(),a}function playSound(e){isSuspended()?!P&&T>3?(T=0,P=!0,window.postMessage({key:C.Suspended},window.location.origin)):P||(T++,enableSound(),whenEnabled((()=>e.play()))):e.play()}class Store{constructor(e="keyval-store",t="keyval"){this.storeName=t,this._dbp=new Promise(((n,a)=>{const l=indexedDB.open(e,1);l.onerror=()=>a(l.error),l.onsuccess=()=>n(l.result),l.onupgradeneeded=()=>{l.result.createObjectStore(t)}}))}_withIDBStore(e,t){return this._dbp.then((n=>new Promise(((a,l)=>{const f=n.transaction(this.storeName,e);f.oncomplete=()=>a(),f.onabort=f.onerror=()=>l(f.error),t(f.objectStore(this.storeName))}))))}}function getDefaultStore(){return w||(w=new Store),w}function get(e,t=getDefaultStore()){let n;return t._withIDBStore("readonly",(t=>{n=t.get(e)})).then((()=>n.result))}function set(e,t,n=getDefaultStore()){return n._withIDBStore("readwrite",(n=>{n.put(t,e)}))}var A,M,x,O,R,I;function toSelector(e,t="."){return`${t}${e}`}function noop(){}function run(e){return e()}function blank_object(){return Object.create(null)}function run_all(e){e.forEach(run)}function is_function(e){return"function"==typeof e}function safe_not_equal(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function null_to_empty(e){return null==e?"":e}function append(e,t){e.appendChild(t)}function insert(e,t,n){e.insertBefore(t,n||null)}function detach(e){e.parentNode.removeChild(e)}function destroy_each(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function element(e){return document.createElement(e)}function text(e){return document.createTextNode(e)}function space(){return text(" ")}function empty(){return text("")}function listen(e,t,n,a){return e.addEventListener(t,n,a),()=>e.removeEventListener(t,n,a)}function attr(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function set_data(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function toggle_class(e,t,n){e.classList[n?"add":"remove"](t)}M=A||(A={}),(x=M.Classes||(M.Classes={})).Hidden="hidden",x.Invisible="invisible",R=O||(O={}),(I=R.KeyCodes||(R.KeyCodes={}))[I.Backspace=8]="Backspace",I[I.Delete=46]="Delete",I[I.DownArrow=40]="DownArrow",I[I.Enter=13]="Enter",I[I.Escape=27]="Escape",I[I.LeftArrow=37]="LeftArrow",I[I.RightArrow=39]="RightArrow",I[I.Spacebar=32]="Spacebar",I[I.Stop=137]="Stop",I[I.Tab=9]="Tab",I[I.UpArrow=38]="UpArrow";class HtmlTag{constructor(){this.e=this.n=null}c(e){this.h(e)}m(e,t,n=null){this.e||(this.e=element(t.nodeName),this.t=t,this.c(e)),this.i(n)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)insert(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(detach)}}let L;function set_current_component(e){L=e}function get_current_component(){if(!L)throw new Error("Function called outside component initialization");return L}function onMount(e){get_current_component().$$.on_mount.push(e)}function createEventDispatcher(){const e=get_current_component();return(t,n)=>{const a=e.$$.callbacks[t];if(a){const l=function custom_event(e,t,n=!1){const a=document.createEvent("CustomEvent");return a.initCustomEvent(e,n,!1,t),a}(t,n);a.slice().forEach((t=>{t.call(e,l)}))}}}const N=[],D=[],B=[],F=[],j=Promise.resolve();let $=!1;function add_render_callback(e){B.push(e)}let H=!1;const V=new Set;function flush(){if(!H){H=!0;do{for(let e=0;e<N.length;e+=1){const t=N[e];set_current_component(t),update(t.$$)}for(set_current_component(null),N.length=0;D.length;)D.pop()();for(let e=0;e<B.length;e+=1){const t=B[e];V.has(t)||(V.add(t),t())}B.length=0}while(N.length);for(;F.length;)F.pop()();$=!1,H=!1,V.clear()}}function update(e){if(null!==e.fragment){e.update(),run_all(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(add_render_callback)}}const U=new Set;function transition_in(e,t){e&&e.i&&(U.delete(e),e.i(t))}function make_dirty(e,t){-1===e.$$.dirty[0]&&(N.push(e),function schedule_update(){$||($=!0,j.then(flush))}(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function init(e,t,n,a,l,f,p,h=[-1]){const m=L;set_current_component(e);const g=e.$$={fragment:null,ctx:null,props:f,update:noop,not_equal:l,bound:blank_object(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(m?m.$$.context:t.context||[]),callbacks:blank_object(),dirty:h,skip_bound:!1,root:t.target||m.$$.root};p&&p(g.root);let v=!1;if(g.ctx=n?n(e,t.props||{},((t,n,...a)=>{const f=a.length?a[0]:n;return g.ctx&&l(g.ctx[t],g.ctx[t]=f)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](f),v&&make_dirty(e,t)),n})):[],g.update(),v=!0,run_all(g.before_update),g.fragment=!!a&&a(g.ctx),t.target){if(t.hydrate){const e=function children(e){return Array.from(e.childNodes)}(t.target);g.fragment&&g.fragment.l(e),e.forEach(detach)}else g.fragment&&g.fragment.c();t.intro&&transition_in(e.$$.fragment),function mount_component(e,t,n,a){const{fragment:l,on_mount:f,on_destroy:p,after_update:h}=e.$$;l&&l.m(t,n),a||add_render_callback((()=>{const t=f.map(run).filter(is_function);p?p.push(...t):run_all(t),e.$$.on_mount=[]})),h.forEach(add_render_callback)}(e,t.target,t.anchor,t.customElement),flush()}set_current_component(m)}class SvelteComponent{$destroy(){!function destroy_component(e,t){const n=e.$$;null!==n.fragment&&(run_all(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=noop}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!function is_empty(e){return 0===Object.keys(e).length}(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function invertObject(e){return Object.keys(e).reduce(((t,n)=>Object.assign(Object.assign({},t),{[e[n]]:n})),{})}function pick(e,t){return t.reduce(((t,n)=>(Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]),t)),{})}},7104:function(e,t,n){"use strict";n.d(t,{$l:function(){return a.B},QY:function(){return a.t},lA:function(){return a.G},iB:function(){return a.J},th:function(){return a.a0},Wc:function(){return a.a1},gb:function(){return a.ai},qU:function(){return a.ao},Kh:function(){return a.aq},YP:function(){return a.ar},dz:function(){return a.aN},rF:function(){return a.av},Mo:function(){return a.ax},sC:function(){return a.aG},q4:function(){return a.aH},NQ:function(){return a.aI},NE:function(){return a.f},dR:function(){return a.H},jw:function(){return a.Z},SH:function(){return a.D},ZD:function(){return a.aR},n8:function(){return a.aU},C8:function(){return a.a6},o9:function(){return a.a7},jd:function(){return a.a_},nT:function(){return a.a8}});var a=n(7144)},7144:function(e,t,n){"use strict";n.d(t,{A:function(){return Et},B:function(){return ht},C:function(){return Yi},D:function(){return getOppositeColor},E:function(){return Rn},F:function(){return getTuckPosition},G:function(){return rr},H:function(){return getColorAsLetter},I:function(){return easeLinear},J:function(){return B},K:function(){return getBoardURL},L:function(){return getPieceBaseURL},M:function(){return pr},N:function(){return Dt},O:function(){return ur},P:function(){return Er},Q:function(){return Tt},R:function(){return Mt},S:function(){return createExternallyResolvablePromise},T:function(){return Ft},U:function(){return setPositionBySquare},V:function(){return pe},W:function(){return F},X:function(){return createCollection},Y:function(){return getColorAsNumber},Z:function(){return getDefaultOptions},a:function(){return getColorAsWord},a0:function(){return dt},a1:function(){return hi},a6:function(){return ji},a7:function(){return Ni},a8:function(){return Hi},aG:function(){return createReportingPlugin},aH:function(){return createSoundsPlugin},aI:function(){return createStandardPlugins},aN:function(){return createGame},aR:function(){return getPGNForDownload},aU:function(){return mergePlugins},a_:function(){return jn},ai:function(){return createBoardImagesPlugin},ao:function(){return createCustomItemsPlugin},aq:function(){return createEcoPlugin},ar:function(){return createEffectsPlugin},av:function(){return createHandPiecesPlugin},ax:function(){return createHorizontalMoveListPlugin},b:function(){return $t},c:function(){return ChessError},d:function(){return So},e:function(){return createEventEmitter},f:function(){return dr},g:function(){return getSanFromFileRank},h:function(){return fr},i:function(){return Wt},j:function(){return createAnimator},k:function(){return getFileRankFromSan$1},l:function(){return limitNumberWithinRange},m:function(){return makeSvgIcon},n:function(){return isCastle},o:function(){return isCapture},p:function(){return rgbaToOpacity},q:function(){return createCoreEvent},r:function(){return rgbToHex},s:function(){return setTestData},t:function(){return _},u:function(){return getXYFromEvent},v:function(){return isTouchEvent},w:function(){return isRightButton},x:function(){return Ar},y:function(){return Mr},z:function(){return Wn}});var a=Object.defineProperty,l=Object.defineProperties,f=Object.getOwnPropertyDescriptors,p=Object.getOwnPropertySymbols,h=Object.prototype.hasOwnProperty,m=Object.prototype.propertyIsEnumerable,__defNormalProp=(e,t,n)=>t in e?a(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n,__spreadValues=(e,t)=>{for(var n in t||(t={}))h.call(t,n)&&__defNormalProp(e,n,t[n]);if(p)for(var n of p(t))m.call(t,n)&&__defNormalProp(e,n,t[n]);return e},__spreadProps=(e,t)=>l(e,f(t)),g={exports:{}};!function(e){
/*!
   * Chess.com (c) 2020 | all rights reserved
   */
/*!
   * A distant fork of chess.js - BSD (c) 2014, Jeff Hlywa (jhlywa@gmail.com)
   */
var t,n,a,l,f;t=function(){var e=[[2637767806,863464769],[720845184,95069639],[1155203408,610415943],[2618685246,1655139042],[1971536997,1218186377],[848342074,540017087],[263957791,1627660921],[3896152207,4076560586],[226391645,1484086288],[436746274,3467632685],[2516964848,3797861296],[3491888988,3510251221],[1086189917,1248276018],[18044180,1876255637],[1572111136,1190386149],[597658413,2146900428],[97624494,2243205793],[1738507407,1854916977],[1950989311,2149575947],[2098318769,3283594736],[2194108574,2015279052],[4079062812,2500884588],[856979699,2941369318],[1270058469,3877737539],[2858720366,3170717948],[2378012835,1387254795],[2278688587,2178388503],[435406673,3555273441],[3031118064,1655806655],[2063925420,1107589828],[3376753832,436852829],[615148625,1302492416],[1285502018,1963045959],[346460119,1016137793],[2803604355,1176288659],[55085973,2968618255],[1669016372,4287873088],[164740250,1037634196],[896886403,883023163],[1935551383,2764331555],[410153072,4055711755],[533441746,1505690343],[3541084098,3466290517],[3214426080,4267541060],[2675233103,1951705124],[1374411850,3115986997],[1552073989,3684348154],[4244110986,875606593],[844343081,3115990494],[2356462440,135999605],[3116133511,377238503],[2129956651,2197966368],[299173332,3276914047],[1701379241,745972291],[1306570996,254977976],[2530644806,214138461],[1122123979,1667800879],[1831591130,3801192033],[1116211970,920967505],[1594837592,2551651254],[972591349,2046373768],[2479207924,1935030411],[1675376029,2367888248],[3960916618,3935874422],[1398143232,3265801671],[133930885,1520005442],[1351827834,2829577566],[2076951437,2723839804],[435980918,2364847828],[1668970368,3738157273],[2185864314,3993911799],[2041407829,31969768],[346864372,2004703094],[4047877822,3437142421],[3669961416,538399484],[616810829,4190688246],[3144558884,4030272234],[216165387,2513010905],[2761740594,3216997572],[3919406634,4096014649],[669429112,2434161727],[2234904640,3111407601],[1421079802,1598085235],[1924213810,310373675],[4002762044,2067865415],[2592451728,2586110625],[1890340057,4031717877],[4189625662,2577429954],[2276713138,3049850801],[2741429688,3310307512],[2924122950,3426712818],[421576781,1193704381],[2277442246,3030264553],[153237420,595540057],[4278711886,4176286928],[2380848297,4030514510],[2618700582,1303682185],[3018992701,185284845],[957243316,1291916363],[1543415220,1898408169],[504378001,531073412],[2591337657,1692896435],[1333852064,903543556],[1661259930,188168388],[561112646,2197961224],[1536910315,2632972300],[1349168372,2307429186],[411152329,2745631190],[1694697476,1081411140],[3755185459,2631660711],[4019355068,4027326706],[2066937809,3761668332],[3120395808,3878773315],[94890149,2109283191],[3045629038,358812277],[1249184265,3465901047],[3477490924,2308583306],[4114113436,3875911716],[1014604031,1434513279],[3991324799,2222416029],[2040431088,1539915569],[2253613964,4081224332],[2547464012,1611168627],[2722521980,4281500978],[71289574,213969824],[2450408597,903689630],[1894451515,364024012],[1939968537,374938813],[1447259295,3785468557],[4021046128,1664847745],[3139524504,3562928047],[1173487682,4065269608],[2467266804,3907744866],[4284945151,3486998177],[2925674454,1953016432],[3710671816,1271453948],[2129465869,1422863833],[587093076,18243356],[3373793513,2411305257],[2156648078,1791034213],[3737413652,1534461430],[468575139,2935304962],[1129551363,3603256834],[2861996892,1763494778],[2826449619,2465197654],[1704209531,1014895022],[3738359347,3402630390],[569410928,4095796581],[3021312909,2108247612],[2444777957,2664129360],[282063667,3773661258],[682545472,3188439005],[3318488457,1917822038],[1447622272,4045023041],[757420137,4038580915],[2613420942,4146703316],[4012836163,150381244],[2938127093,3428591704],[1208226490,3086335530],[2935205706,1446903363],[430957978,3830532479],[1381578755,3757172800],[4109399782,1596778224],[288855589,1954372339],[3169178148,2256716053],[2644780093,3895892303],[107966643,1071681559],[1304747544,2607225372],[1359190711,1898207171],[3229237120,3273634996],[3027167685,3863637628],[3011615298,2883984519],[564135827,978463264],[770797430,362326607],[1983662611,1907583229],[4153656423,48268960],[3609759233,720080177],[3727911466,1270989899],[200708787,2366086947],[744508026,393422515],[1213261630,65757284],[3485747185,3845951003],[2958861301,1680248217],[2598470344,3163845864],[2767997908,4233451722],[3881113485,1492930166],[1773764017,2764062206],[4189435844,2898689174],[4234838742,1267095035],[2624081078,3302114327],[2395569449,390426320],[1728307101,690284926],[3309827454,1118258254],[2028172868,3888829086],[4271523049,909051386],[146617804,942892565],[2467685867,974297806],[2483428231,503635829],[3743260573,2018222096],[1002067894,2289153437],[3535252974,3738302271],[4154611160,1002664952],[3623154244,2349656961],[3646679180,3524329383],[862933752,4282853607],[2806008282,3272780913],[2734037942,3828874677],[1328176304,2137666995],[2278785213,2780788825],[381286368,1816476193],[2074232908,2316293454],[4087773386,3651330956],[967884669,3728964514],[4239349185,3213509668],[419231360,1463788948],[1275421624,2672384707],[1088456595,436245261],[2365565249,783696577],[1758083333,845223583],[2048846183,3530914274],[2635948261,124738415],[940630937,3069598626],[839474029,1253439921],[902477345,165479306],[2836079689,2681188273],[2007115168,2093139645],[1363041891,1282466609],[1130479818,1063857938],[3644959908,1260430427],[1385135238,46497915],[1386975934,3110156681],[2635987502,4233461619],[1915744629,4117939016],[487743653,285736599],[2049219159,3960249250],[69242857,3908563670],[1511066720,1488527520],[215590039,1703564952],[1459430344,4184955468],[676103291,2642967214],[83799035,3182827979],[1949179493,476101251],[2593534694,1493478716],[2283504289,995211746],[1349412676,3449243940],[2954378677,1878813305],[249149717,3329151870],[1578231917,1483986052],[4135085182,890874990],[461755528,3505523909],[3669622373,634949665],[219487622,2914465301],[2825233742,3703631897],[2479105382,2935590907],[2582097898,3187672881],[1221328648,1843341402],[2140891889,3958868911],[1482849818,345750049],[751922730,3178831411],[3546542069,4036458902],[216179596,877293293],[444615341,3117393729],[2424254530,494454238],[1344234989,3003337991],[929188581,2760877801],[2507911009,1879899982],[980166547,1311840394],[3566535507,1790747461],[143525013,2311336672],[4181962471,4273938872],[1815842366,862009811],[911175674,1179575598],[3591335374,3694215714],[1452686093,3393294272],[385158879,2447709103],[4011414929,1264623507],[1448477120,911094312],[3971299641,2289992053],[3133647265,2234591563],[3007628400,964409938],[1708345684,3673411261],[3031964479,2843021794],[3022128657,2480338599],[118850112,473449293],[2048127371,3202109429],[3158349745,382018770],[1505327237,3807570472],[2568424029,3272693060],[1866609495,3888556537],[844703982,1852802964],[3504617058,682636099],[1448882679,3733580327],[821387540,2215744532],[3631471417,311618895],[2077838877,2383929020],[3352949096,1688694420],[2491080787,3998672444],[3368630402,4182204255],[983299419,2837414346],[3651215291,1033373924],[265429091,3988955082],[3019003608,2896212153],[2955948456,3025235588],[903690197,2266253487],[3925215275,89402958],[3959093811,3609545561],[2455088053,223552128],[3115011301,2133669107],[1765081558,673805649],[3324795129,2111392191],[3443871631,432345706],[3152559950,3425427147],[3699649406,672784944],[3129545774,7668664],[2747044893,173040075],[3925243406,852328481],[164095314,3161868591],[2234471571,1302682825],[2164784335,105893718],[159995093,536831360],[599199451,425051327],[3274759746,1680930461],[1192619331,3903085578],[2832721114,3078660237],[91404660,4030521531],[3044880024,1578375623],[3906596030,754177855],[803516785,1894094672],[288455592,2030430096],[2143232492,2317305324],[388352703,3406060288],[2521731420,3588403719],[1043041227,4028028525],[3195290851,2468913324],[4166724431,3168683191],[1228226538,968516529],[500177583,3444787306],[533367442,4252082053],[4236023256,657816314],[413575568,3367198397],[3435884549,3334062733],[1004255532,1135705894],[2859513268,4170618274],[3914086821,1251487871],[3080761716,3489067886],[3571165255,699353261],[773372954,3648014952],[769693293,2939128604],[3116440923,507748478],[1687629160,3739431776],[2489486648,3502376324],[3686847158,2878383449],[3530767427,902211375],[2121652637,2493976397],[1827477891,930064171],[2549918411,4029725732],[2071415163,844118802],[2236083679,3088894868],[2040110303,4144562891],[3489536313,1133419300],[2190878435,2301466071],[2465915458,2448602097],[1675766804,2073834499],[3329799896,1613253148],[1483966600,1348836071],[159505618,2527621997],[2674227354,1695130688],[2683539437,1927873839],[3833196123,2570082188],[3891433165,759819981],[1455453349,2179602430],[1430583255,1957776111],[2067726741,4235143439],[303380021,2998980439],[2136024795,3126725799],[2054591852,1051702291],[1029141665,489794361],[2317027384,569642164],[2068461795,624418658],[2499875684,1830645251],[1302894490,4319401],[1002663431,2406815191],[1560941298,2060652753],[2141002286,515773223],[3661248027,475092913],[3705503008,2419919909],[914567990,3496539911],[3462935583,2039034761],[2878378006,2379243316],[1133857586,1390159333],[3023618742,2140726761],[282908558,944874642],[3686955701,1148723903],[2604456805,4163675010],[3061545110,377179268],[3218002352,76459088],[2836503392,916455101],[536836808,151306053],[2886925079,404221671],[2936593041,2011015485],[453815187,1852163908],[3042568989,82176306],[3279635891,4174836410],[3282689058,2360003049],[4088968807,1516570623],[2680453086,1322680794],[1731693966,3438253771],[1842894553,1294307894],[2736377365,2964642609],[121205621,521330014],[2324595870,3005710757],[3784465521,676493813],[1958759409,2030833406],[1306150933,1016370058],[2636541290,482366508],[1950415745,1695073534],[322077955,3746046623],[3602873262,3829181504],[1211684447,1861645455],[504701736,4080111082],[2407799203,1223857855],[1925743434,1498920209],[3617596327,845198428],[2498480299,3484773806],[2680229135,2560201696],[3731399221,1536412390],[2756509305,2924710846],[2635957500,3459716133],[1372762539,769635894],[802677945,3878474636],[1707760534,3075809808],[3714687192,2872792173],[1615679922,1606381794],[1940556374,1337437342],[445390489,731124040],[2864974375,64601760],[1984806574,2141516710],[513390958,1890172555],[744398315,1475299139],[982749166,852662657],[652663695,4260736510],[1184061125,82616221],[3363191899,147951756],[1064069880,1507328085],[2138882964,547595589],[2616926846,3186935246],[2298715513,3606862940],[2414381911,811477686],[2694745228,900437726],[4202576185,2201114451],[3602305260,3323446937],[3756663274,2658490339],[3061587876,2171079416],[3390977925,2850497765],[486312941,224925241],[3515712841,3510684394],[1322319486,2647200565],[3839619171,1148450258],[392296762,1154854654],[1401523788,957405781],[1934485528,527352730],[645968162,3131215255],[696971825,3361451947],[2038689491,1946699733],[1723966113,2785859721],[2652365974,1118037185],[3988018407,3134982149],[1354171594,3053634345],[1287854075,2631782435],[1723106141,2662328866],[563845090,1878819261],[639520332,171129501],[534957223,1696062352],[3612364282,2283204027],[3109494688,1304463816],[500957989,630925278],[3477030536,2149497258],[4109750364,281719363],[951472732,564407054],[922095147,2767874048],[3946156928,829677774],[2622281253,2086286851],[2936811901,850242186],[630086272,3340782667],[2340986210,1296336989],[4107355543,3865114709],[3560210278,3968418243],[3868847493,2967450637],[611513888,2083325060],[3265390517,3025776309],[2874106961,3424470508],[1668707698,2923258228],[2778598353,24320552],[292356118,3415510793],[754567370,86994591],[185141877,1621715171],[2884558258,3722473457],[1492107531,111281805],[3336927864,4225337056],[782994598,1021838039],[346133860,18281270],[2080909533,1649329040],[3612065399,3859901127],[2151962287,284556115],[3957975594,3745718727],[52533817,3998775856],[1232633839,397383972],[2716413964,3629253960],[1531307298,3836851439],[3030137657,2500401718],[3561556693,653345841],[313061910,2945718466],[2065276,3342140708],[410498334,1470588117],[2726640512,4051654894],[2570984935,758567696],[3008987264,3462702678],[623860175,228525243],[3527183895,1829844480],[467272850,3890501742],[568376656,650516927],[990477018,4035508558],[2366955227,817792110],[4183621538,989198068],[946958343,1639184195],[3395758993,3924097558],[1690887473,3220519765],[605184237,1255270525],[275515833,1926424610],[2142902612,283494960],[2021972412,1823828440],[105373677,3448326697],[1666662384,1042433908],[1338566998,261206307],[498685668,1344755577],[3101233780,3119109371],[2733370951,3808165089],[3656512268,3449289481],[4025308119,1607880299],[778896067,1612183167],[2846510368,3674754715],[3058428120,2991822529],[1892379383,3268787440],[2565895844,4154602030],[3213117192,98999135],[2495816991,116985075],[1040203361,1785041385],[3106252493,69316595],[1639829808,2087117568],[3213709576,3799911752],[604681594,2340981536],[4236730699,2938666503],[4009938384,1878897714],[2701667332,1725918218],[2182473079,1258184],[3550198211,2760750799],[657991062,875584532],[1640976276,3380476221],[460041378,2924352091],[1972323596,2287414795],[2510248061,1350206297],[2959337826,3762681165],[1625877874,3235902929],[2070189957,1429368735],[4245163299,1839731898],[2358312347,138364248],[275739390,2179122576],[2037777210,972544338],[2766930226,1984733259],[1933485829,4209310327],[3034118011,3286589799],[2653025529,62078937],[2641780289,2679545709],[3540781195,2787026415],[1569993599,3215949659],[441337890,3947723353],[1878946792,459505587],[3724105660,920173002],[1691411102,3934795955],[148741087,3647709027],[142506469,2776440083],[3811107376,3823285243],[472209891,252266174],[1913386482,1867329194],[2960608550,482740699],[1145005292,1513558421],[1091751784,1687823886],[3625186042,3086337482],[1712140887,940065262],[1504455800,1945702563],[3896940088,2003245591],[2478191531,4197739e3],[3233871270,250924495],[3404865229,1131917964],[1462204167,429621621],[1349259705,3641608989],[3627860584,2048468319],[1244251718,1513180369],[3979211282,371413143],[3043187861,4285699810],[581894202,3060983825],[1390895705,1811317301],[2599134010,3337406128],[2488233440,2436161462],[1816641224,2208816697],[1792034756,815866116],[2779893723,2695577703],[2084952115,2951772258],[1351806869,169269771],[2469979804,86740603],[1163545420,4264616949],[1795352113,2511146232],[1796715044,3134635815],[3521170642,1538900329],[3725363621,1455009392],[1342594643,1512127734],[2618386938,662157428],[2028859350,2494504685],[1841905045,648351336],[4002935891,4033319405],[850071259,1768358867],[979915719,3876018087],[830889197,1629549437],[1744763229,2455795856],[522919199,368499868],[3063822504,2522639205],[2861636095,407686388],[4097602344,1945259027],[4215946617,1251639506],[894485042,534122652],[924809191,1807237502],[1811585710,1589663609],[3439653887,1722232],[3810997538,105152714],[2677100683,4291805514],[77233985,102407776],[4239834691,2851274395],[148802076,2006440603],[2409138150,126301601],[3048474397,3217504870],[588133437,4221603123],[1139638106,263087485],[982032635,3165674595],[562514827,1294842959],[467575086,905357513],[1405117894,3370530088],[3813285157,242912619],[3601878331,1985076606],[1586505598,2092146221],[738488098,103663229],[2970334297,321718822],[1068097019,1742926233],[235518094,420804527],[283685722,4092504887],[2666392744,3799169331],[3569817788,1256762975],[2169728352,292617248],[2444571896,2239859206],[3967907832,1066404216],[420376911,2913277294],[3046293305,2956347747],[2311278792,2477686209],[2885955184,4172514290],[3030078181,2275536480],[4212469731,4280736393],[1046900335,1773022229],[995380926,1414273529],[3892683234,2429494358],[615726237,2127712535],[3880203074,2071130305],[176180504,3070850165],[1474506861,2283723599],[1256707747,1857412043],[764236850,359687368],[3521530334,511649419],[2318567964,3992868140],[128167623,2518992858],[2220129756,1042300052],[2567608573,1349636707],[441446694,384760969],[4143447316,829506048],[817912603,2738025500],[2368091832,357934982],[1187643061,1561463042],[3438021235,3030161697],[1318922279,895468690],[434876457,1130220303],[1180291767,1132759596],[2520707785,1798553137],[1962430872,2958700157],[1510954061,3534879512],[57831539,3269538993],[3354831405,3852135009],[891783098,2698494511],[2555636406,996018997],[2881342935,3982231648],[3473267445,2894952368],[1238029452,3958679326],[2051805420,559465638],[3655936674,1186951582],[330209165,167662935],[1929681327,2450868735],[1313566811,2458925988],[4283920930,3243182650],[1438004300,4185567150],[3093439067,89876832],[3401620219,3721579956],[3673745794,2682874719],[3053321309,825410712],[822915968,3681514755],[3900685126,561657358],[553823814,1857753416],[4166295066,983949325],[128359165,3426887194],[3300989119,3884968622],[4193552686,3647722552],[452189154,1569670618],[4122259632,3537825460],[2519387887,2821594244],[74333898,2940550377],[4032631446,2173999692],[2521268686,1934310532],[2620314688,2177785789],[1378755571,2455646622],[394133753,4231198609],[734399075,2800989170],[573292462,1634883078],[1214417373,3426576256],[2110224475,2399009920],[2331215665,3224086912],[531326186,698539511],[3839443603,583861850],[2644531398,2017784332],[616620850,3070237104],[590349237,2798642861],[3582377217,3317831670],[1582708616,1596570667],[2126148205,2358511947],[173450736,3219362418],[3616831144,1323437318],[2655785577,3131359031],[401600069,2967397952],[496349349,4244179910],[2479612086,2579650653],[1710903074,2049666425],[3589924952,690291925],[3266682943,1900485231],[1496318498,3025542656],[3459221058,3389461212],[2091479615,3140389256],[663040899,1207089672],[3323704225,1105530508],[353318429,2879253542],[2674540957,941987316],[1688550857,620657353],[338551967,4286217277],[204689992,2239736295],[178008789,3940832005],[3871613304,3300636974],[1911672356,2429684487],[4055679954,1974461722],[3878217928,1009991796],[2533095482,310920740],[2174833823,3596041637],[1604814460,2939543881],[1452830254,4092397851],[2441027029,4169690209],[3524103304,3372213855]],t=[[836181454,1689436944],[2776523577,3710710688],[4049974663,3750330768],[519497435,2979405513]],n=[[1892447193,197291556],[3793382197,3742120663],[3838936,2994760034],[479846099,1018728609],[3476112862,182272649],[3504620154,1427438450],[2009473484,2679350403],[1738755500,1129731339]],a=[4174784170,2938602761],l={p:0,P:1,n:2,N:3,b:4,B:5,r:6,R:7,q:8,Q:9,k:10,K:11},f=[];f[5]=1,f[6]=0,f[9]=3,f[10]=2,f[17]=5,f[18]=4,f[33]=7,f[34]=6,f[65]=9,f[66]=8,f[129]=11,f[130]=10;var p,h=[2,5,10,20,40,80,160,64],m=["","0000000","000000","00000","0000","000","00","0",""];function to32BitHex(e){var t=e.toString(16);return m[t.length]+t}function to64BitHex(e){return to32BitHex(e[0])+to32BitHex(e[1])}function hash(f,p){var m,g,v,y,_,b,C,S,k,w,T,P,A=f.split(" "),M=A[0].split("/"),x="w"===A[1],O=0,R=Number(x),I=R?3:4;for(v=7;v>=0;v-=1)for(y=0,C=(_=M[v]).length,b=0;b<C;b+=1)S=_[b],(T=l[S])>=0&&(m=(m^(k=e[64*T+8*(7-v)+y])[0])>>>0,g=(g^k[1])>>>0,T===R&&v===I&&(O|=1<<y)),y+=Number(S)||1;return"-"!==A[2]&&((w=A[2]).indexOf("K")>-1&&(m=(m^(k=t[0])[0])>>>0,g=(g^k[1])>>>0),w.indexOf("Q")>-1&&(m=(m^(k=t[2])[0])>>>0,g=(g^k[1])>>>0),w.indexOf("k")>-1&&(m=(m^(k=t[1])[0])>>>0,g=(g^k[1])>>>0),w.indexOf("q")>-1&&(m=(m^(k=t[3])[0])>>>0,g=(g^k[1])>>>0)),A[3]&&"-"!==A[3]&&(P=A[3].charCodeAt(0)-97,h[P]&O&&(m=(m^(k=n[P])[0])>>>0,g=(g^k[1])>>>0)),x&&(m=(m^a[0])>>>0,g=(g^a[1])>>>0),p&&"hex"===p?to64BitHex([m,g]):[m,g]}function wrap(e){var t,n,a,l,f={};function parseBook(e,t){var a,l,f,p,h,m,g=n.getUint16(e+8),v=n.getUint16(e+10);return l=g>>9&7,p=g>>3&7,h=7&g,m=g>>12&7,4==(f=g>>6&7)&&t&&l===p&&"-"!==t&&(7===h&&(0===l&&t.indexOf("K")>-1||7===l&&t.indexOf("k")>-1)?h-=1:0===h&&(0===l&&t.indexOf("Q")>-1||7===l&&t.indexOf("q")>-1)&&(h+=2)),a=String.fromCharCode(f+97)+(l+1)+String.fromCharCode(h+97)+(p+1),m&&(a+="nbrq"[m-1]),{move:a,weight:v}}function query(e){return"string"==typeof e&&(e={fen:e}),t(e)}if(f={query:query,pick:function pick2(e){var t,n,a,l,f,p=0;if(function sortMoves(e){e.sort((function sorter(e,t){return t.weight-e.weight}))}(t=(e=e||{}).moves||query(e)),a=t.length){if(e.type&&1!==a&&"best"!==e.type){if("random"===e.type){for(l=Math.floor(Math.random()*t.sum)+1,f=0;f<a-1&&!(l<=(p+=t[f].weight));f+=1);return t[f].move}return"randomDisregardWeight"===e.type?t[Math.floor(Math.random()*a)].move:"worst"===e.type?t[a-1].move:((n=parseInt(e.type)||1)<0&&(n=a+n+1),n<1?n=1:n>a&&(n=a),t[n-1].move)}return t[0].move}}},e.getUint32)t=function bufferBookFind(e){var t,a,l,f,p,h=n.length||n.byteLength||0,m=e.offset||0,g=e.fen,v=e.chess960,y=e.checkAll,_=[],b=0;for(e.hash?"string"==typeof(t=e.hash)&&(t=function hex64ToDec(e){return[parseInt(e.substr(0,8),16),parseInt(e.substr(8),16)]}(t)):t=hash(g),!v&&g&&(p=g.split(" ")[2]),m=0;m<h;m+=16)if(n.getUint32(m)===t[0]&&n.getUint32(m+4)===t[1])l=parseBook(m,p),_[_.length]=l,b+=l.weight,a=!0;else if(a&&!y)break;if(_.sum=b,e.relative)for(f=_.length-1;f>=0;f-=1)_[f].relative=Math.round(_[f].weight/b*1e4);return _},n=e,f.buffer=n;else for(l in t=function jsonBookFind(e){var t,n,l,p,h,m,g=0,v=e.fen;if(f.useFen)l=v.replace(/ \d+ \d+$/,""),(t=a[l])||(p=l.replace(/[a-h][1-8]$/,"-"))!==l&&(t=a[p]);else if(e.hash||(e.hash=hash(v,"hex")),t=a[e.hash]){if(t[0]&&t[0].n&&(t=t[0]),t.n&&!t.b)return[];if(t.b)t=function decompressMoves(e){var t,n=[],a=e.b.length;for(t=0;t<a;++t)n.push({move:e.b[t],weight:e.w[t]});return n}(t);else if(!e.chess960&&v)for(m=v.split(" ")[2],n=t.length-1;n>=0;n-=1)(h=t[n].move.match(/e([18])([ah])\1/))&&("h"===h[2]&&("1"===h[1]&&m.indexOf("K")>-1||"8"===h[1]&&m.indexOf("k")>-1)?t[n]={move:"e"+h[1]+"g"+h[1],weight:t[n].weight}:"a"===h[2]&&("1"===h[1]&&m.indexOf("Q")>-1||"8"===h[1]&&m.indexOf("q")>-1)&&(t[n]={move:"e"+h[1]+"c"+h[1],weight:t[n].weight}))}if(t)for(n=t.length-1;n>=0;n-=1)g+=Number(t[n].weight);else t=[];return t.sum=g,t},a=e,f.json=a,a){f.useFen=l.indexOf(" ")>-1;break}return f}function getBook(e,t){!function ajaxLoad(e,t){var n=new XMLHttpRequest,a=e.toLowerCase().indexOf(".json")>-1;function onload(){var e;if(n.status>=200&&n.status<300||304===n.status||0===n.status||1223===n.status)if(a)try{t(null,JSON.parse(n.response))}catch(l){t(l)}else e=new DataView(n.response),t(null,e);else t(new Error("Error code: "+n.status))}n.open("GET",e,!0),a||(n.responseType="arraybuffer"),n.onload=onload,n.onerror=onload,n.send()}(e,(function onload(e,n){var a;if(n&&(a=wrap(n)),t)return t(e,a);if(e)throw e;return a}))}return{hash:hash,loadBook:(p={},function loadBook2(e,t){p[e]?p[e].book?setTimeout((function(){t(null,p[e].book)}),0):p[e].cbs.push(t):(p[e]={cbs:[t]},getBook(e,(function onload(t,n){var a=p[e].cbs;t?delete p[e]:(p[e].book=n,p[e].cbs=void 0),a.forEach((function(e){setTimeout((function(){e(t,n)}),0)}))})))}),to64BitHex:to64BitHex,zobristPiece:e,zobristCastle:t,zobristEnPassant:n,zobristTurn:a,zobristPieceValue:l,zobristPieceValueNumbers:f}}(),n=function init2(){var e,n,a,l,f={Chess:0,Chess960:1,Crazyhouse:2,"3-check":3,"King of the Hill":4,Bughouse:5,chess960:1,fischerandom:1,fischerrandom:1,fischer:1,chess9lx:1,960:1,crazyhouse:2,"three-check":3,threecheck:3,"3check":3,kingofthehill:4,koth:4,bughouse:5},p=["Chess","Chess960","Crazyhouse","3-check","King of the Hill","Bughouse"],h={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],g=0,v=0,y=0,_=-1,b=32,C=128,S=252,k=255,w=512,T=112,P=14,A=21,M=127,x="pnbrqkPNBRQK",O="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",R=[];R[5]=[-16,-17,-15],R[6]=[16,17,15],R[8]=[-18,-33,-31,-14,18,33,31,14],R[16]=[-17,-15,17,15],R[32]=[-16,1,16,-1],R[64]=[-17,-16,-15,1,17,16,15,-1],R[128]=[-17,-16,-15,1,17,16,15,-1];var I={P:5,p:6,N:9,n:10,B:17,b:18,R:33,r:34,Q:65,q:66,K:129,k:130},L={P:4,p:4,N:8,n:8,B:16,b:16,R:32,r:32,Q:64,q:64,K:128,k:128},N={5:"P",6:"p",9:"N",10:"n",17:"B",18:"b",33:"R",34:"r",65:"Q",66:"q",129:"K",130:"k"},D={9:"N",10:"N",17:"B",18:"B",33:"R",34:"R",65:"Q",66:"Q",129:"K",130:"K"},B=[80,0,0,0,0,0,0,96,0,0,0,0,0,0,80,0,0,80,0,0,0,0,0,96,0,0,0,0,0,80,0,0,0,0,80,0,0,0,0,96,0,0,0,0,80,0,0,0,0,0,0,80,0,0,0,96,0,0,0,80,0,0,0,0,0,0,0,0,80,0,0,96,0,0,80,0,0,0,0,0,0,0,0,0,0,80,8,96,8,80,0,0,0,0,0,0,0,0,0,0,0,8,212,224,212,8,0,0,0,0,0,0,96,96,96,96,96,96,224,0,224,96,96,96,96,96,96,0,0,0,0,0,0,8,212,224,212,8,0,0,0,0,0,0,0,0,0,0,0,80,8,96,8,80,0,0,0,0,0,0,0,0,0,0,80,0,0,96,0,0,80,0,0,0,0,0,0,0,0,80,0,0,0,96,0,0,0,80,0,0,0,0,0,0,80,0,0,0,0,96,0,0,0,0,80,0,0,0,0,80,0,0,0,0,0,96,0,0,0,0,0,80,0,0,80,0,0,0,0,0,0,96,0,0,0,0,0,0,80],F=[336,80,80,0,0,0,96,352,96,0,0,0,80,80,336,0,80,336,80,80,0,0,96,352,96,0,0,80,80,336,80,0,80,80,336,80,80,0,96,352,96,0,80,80,336,80,80,0,0,80,80,336,80,80,96,352,96,80,80,336,80,80,0,0,0,0,80,80,336,88,120,360,120,88,336,80,80,0,0,0,0,0,0,80,88,476,252,508,252,476,88,80,0,0,0,0,96,96,96,96,120,252,252,252,252,252,120,96,96,96,96,0,352,352,352,352,360,508,252,0,252,508,360,352,352,352,352,0,96,96,96,96,120,252,252,252,252,252,120,96,96,96,96,0,0,0,0,80,88,476,252,508,252,476,88,80,0,0,0,0,0,0,80,80,336,88,120,360,120,88,336,80,80,0,0,0,0,80,80,336,80,80,96,352,96,80,80,336,80,80,0,0,80,80,336,80,80,0,96,352,96,0,80,80,336,80,80,0,80,336,80,80,0,0,96,352,96,0,0,80,80,336,80,0,336,80,80,0,0,0,96,352,96,0,0,0,80,80,336],j=[336,80,80,0,0,0,96,352,96,96,0,0,80,80,336,0,80,336,80,80,0,0,96,352,96,96,0,80,80,336,80,0,80,80,336,80,80,0,96,352,96,96,80,80,336,80,80,0,0,80,80,336,80,80,96,352,96,112,80,336,80,80,0,0,0,0,80,80,336,88,120,360,120,120,336,80,80,0,0,0,0,0,0,80,88,476,252,508,252,508,88,80,0,0,0,0,96,96,96,96,120,252,252,252,252,252,252,104,96,96,96,0,352,352,352,352,360,508,252,0,252,508,488,352,352,352,352,0,96,96,96,96,120,252,252,252,252,252,252,104,96,96,96,0,0,0,0,80,88,476,252,508,252,508,88,80,0,0,0,0,0,0,80,80,336,88,120,360,120,120,336,80,80,0,0,0,0,80,80,336,80,80,96,352,96,112,80,336,80,80,0,0,80,80,336,80,80,0,96,352,96,96,80,80,336,80,80,0,80,336,80,80,0,0,96,352,96,96,0,80,80,336,80,0,336,80,80,0,0,0,96,352,96,96,0,0,80,80,336],$=[336,80,80,0,0,96,96,352,96,0,0,0,80,80,336,0,80,336,80,80,0,96,96,352,96,0,0,80,80,336,80,0,80,80,336,80,80,96,96,352,96,0,80,80,336,80,80,0,0,80,80,336,80,112,96,352,96,80,80,336,80,80,0,0,0,0,80,80,336,120,120,360,120,88,336,80,80,0,0,0,0,0,0,80,88,508,252,508,252,476,88,80,0,0,0,0,96,96,96,104,252,252,252,252,252,252,120,96,96,96,96,0,352,352,352,352,488,508,252,0,252,508,360,352,352,352,352,0,96,96,96,104,252,252,252,252,252,252,120,96,96,96,96,0,0,0,0,80,88,508,252,508,252,476,88,80,0,0,0,0,0,0,80,80,336,120,120,360,120,88,336,80,80,0,0,0,0,80,80,336,80,112,96,352,96,80,80,336,80,80,0,0,80,80,336,80,80,96,96,352,96,0,80,80,336,80,80,0,80,336,80,80,0,96,96,352,96,0,0,80,80,336,80,0,336,80,80,0,0,96,96,352,96,0,0,0,80,80,336],H=[336,80,80,0,0,96,96,352,96,96,0,0,80,80,336,0,80,336,80,80,0,96,96,352,96,96,0,80,80,336,80,0,80,80,336,80,80,96,96,352,96,96,80,80,336,80,80,0,0,80,80,336,80,112,96,352,96,112,80,336,80,80,0,0,0,0,80,80,336,120,120,360,120,120,336,80,80,0,0,0,0,0,0,80,88,508,252,508,252,508,88,80,0,0,0,0,96,96,96,104,252,252,252,252,252,252,252,104,96,96,96,0,352,352,352,352,488,508,252,0,252,508,488,352,352,352,352,0,96,96,96,104,252,252,252,252,252,252,252,104,96,96,96,0,0,0,0,80,88,508,252,508,252,508,88,80,0,0,0,0,0,0,80,80,336,120,120,360,120,120,336,80,80,0,0,0,0,80,80,336,80,112,96,352,96,112,80,336,80,80,0,0,80,80,336,80,80,96,96,352,96,96,80,80,336,80,80,0,80,336,80,80,0,96,96,352,96,96,0,80,80,336,80,0,336,80,80,0,0,96,96,352,96,96,0,0,80,80,336],V=[336,80,80,112,112,112,96,352,96,96,112,112,112,80,336,0,80,336,80,112,112,112,112,352,96,112,112,112,112,336,80,0,80,80,336,112,112,112,112,368,112,112,112,112,368,80,80,0,80,80,80,368,112,112,112,368,112,112,112,368,112,80,80,0,80,80,80,112,368,120,120,376,120,120,368,112,112,80,80,0,0,80,88,120,120,508,252,508,252,508,120,120,120,88,80,0,96,104,252,252,252,252,252,252,252,252,252,252,252,252,104,0,352,352,480,480,488,508,252,0,252,508,488,480,480,480,352,0,96,104,252,252,252,252,252,252,252,252,252,252,252,252,104,0,0,80,88,120,120,508,252,508,252,508,120,120,120,88,80,0,80,80,80,112,368,120,120,376,120,120,368,112,112,80,80,0,80,80,80,368,112,112,112,368,112,112,112,368,112,80,80,0,80,80,336,112,112,112,112,368,112,112,112,112,368,80,80,0,80,336,80,112,112,112,112,352,96,112,112,112,112,336,80,0,336,80,80,112,112,112,96,352,96,96,112,112,112,80,336],U=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,33,16,31,15,0,0,0,0,0,0,0,0,0,0,0,18,17,16,15,14,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,-14,-15,-16,-17,-18,0,0,0,0,0,0,0,0,0,0,0,-15,-31,-16,-33,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],G=[0,5,8,11,14],q=[31,7,7,7,63],W={P:0,p:0,N:5,n:5,B:8,b:8,R:11,r:11,Q:14,q:14},z=[4,8,16,b,64],K=["","N","B","R","Q"],Z={CAPTURE:1,BIG_PAWN:2,EP_CAPTURE:4,ANY_CAPTURE:5,PROMOTION:8,KSIDE_CASTLE:16,QSIDE_CASTLE:32,KQSIDE_CASTLE:48,DROP:64,DROP_OR_PROMOTE:72},Q=[0,6,1],X={K:119,Q:112,k:7,q:0,A:112,B:113,C:114,D:115,E:116,F:117,G:118,H:119,a:0,b:1,c:2,d:3,e:4,f:5,g:6,h:7},Y=["Event","Site","Date","Round","White","Black","Result"],J=["Event","Site","Date","Round","White","Black","Result","Variant","SetUp","FEN","WhiteA","WhiteB","BlackA","BlackB"];function rank(e){return e>>4}function file(e){return 7&e}function algebraic(e){return String.fromCharCode(file(e)+97)+(8-rank(e))}function swapColor(e){return 3-e}function hashNum(e,t){e[0]=(e[0]^t[0])>>>0,e[1]=(e[1]^t[1])>>>0}function completeFen(e){var t,n;return(t=[""," w - - 0 1"," - - 0 1"," - 0 1"," 0 1"," 1"][(n=(e=e.trim()).split(" ")).length])&&e?e+=t:"0"===n[5]&&(n[5]=1,e=n.join(" ")),e}function createVariantZobristNumbers(){t.zobristCheck=[[441249556,340005552],[1040760204,311043682],[1621584863,1749286446],[1006868636,1625552915],[1953853171,24921145],[161251506,1935545265]]}function validateFen(e,t){var n,a,l,p,h,m,g,v,y,_,b,C,S,k,w,T,P,A,M,O,R=/^(?:[A-H]{1,2}[a-h]{0,2}|[A-H]{0,2}[a-h]{1,2}|KQ?k?q?|Qk?q?|kq?|q|-)$/,I=f[t]||1*t||f[String(t).replace(/\s/g,"").toLowerCase()],L=I===f.Crazyhouse||I===f.Bughouse,N=0,D=0,B=!0,F="",j={0:0,7:0},$={0:0,7:0},H={0:"k",7:"K"},V={0:"r",7:"R"},U=I===f.Chess960;if(!e)return 1;if(I===f.Bughouse&&2===(h=e.split(" | ")).length)return 0===(m=validateFen(h[0],t))&&(m=validateFen(h[1],t)),m;if(h=e.split(/\s+/),I===f["3-check"]&&7===h.length&&(p=h.pop(),!/^\+[0-3]\+[0-3]$/.test(p)||"+3+3"===p))return 14;if(6!==h.length)return 1;if(/\D|.{7,}|^0|^$/.test(h[5]))return 2;if(/\D|.{7,}|^0.|^$/.test(h[4]))return 3;if(!/^(?:-|[abcdefgh][36])$/.test(h[3]))return 4;if(_=h[2],U){if(!R.test(_))return 12}else if(!/^(?:KQ?k?q?|Qk?q?|kq?|q|-)$/.test(_)){if(void 0!==t||!R.test(_))return 5;U=!0}if("w"!==h[1]&&"b"!==h[1])return 6;if(L&&(h[0]=h[0].replace(/~(?=.*\/)/g,"")),a=h[0].split("/"),L&&9===a.length&&(p=a.pop(),!/^[pnbrq]{0,63}$/i.test(p)))return 13;if(8!==a.length)return 7;if("3"===h[3][1]&&"w"===h[1]||"6"===h[3][1]&&"b"===h[1])return 11;for("-"!==h[3]&&(g=4==(D="3"===h[3][1]?4:3)?5:2,N=h[3].charCodeAt(0)-97,B=!1,F=4===D?"P":"p"),n=0;n<a.length;++n){for(A=0,M=!1,O=0;O<a[n].length;O++)if(+(l=a[n][O])==+l){if(M)return 8;A+=1*l,M=!0}else{if(-1===x.indexOf(l))return 9;if(B||D!==n||N!==A||F!==l||(B=!0),g===n&&N===A)return 11;n%7==0&&(l===H[n]?$[n]=1<<A:l===V[n]&&(j[n]|=1<<A)),++A,M=!1}if(8!==A)return 10}if(!B)return 11;if("-"!==_)if(U)for(C={0:0,1:0,2:252,4:248,8:240,16:224,32:192,64:128,128:0},b={0:0,1:0,2:1,4:3,8:7,16:15,32:31,64:63,128:0},P={0:[0,0],7:[0,0]},n=_.length-1;n>=0;--n){if(w=_.charCodeAt(n),T&&T>w&&T-w<8)return 15;if(75===w?S=j[k=7]&C[$[k]]:81===w?S=j[k=7]&b[$[k]]:107===w?S=j[k=0]&C[$[k]]:113===w?S=j[k=0]&b[$[k]]:(S=1<<w-((k=w>=97?0:7)?65:97),T=w),!S||0!=(S&S-1))return 15;if($[k]<2||$[k]>64||(S&j[k])!==S)return 15;if(++P[k][1*($[k]<S)]>1)return 15}else{if((v=(_.indexOf("K")>-1?128:0)|(_.indexOf("Q")>-1?1:0))&&(16!==$[7]||(v&j[7])!==v))return 15;if((y=(_.indexOf("k")>-1?128:0)|(_.indexOf("q")>-1?1:0))&&(16!==$[0]||(y&j[0])!==y))return 15}return 0}function handToString(e,t){var n,a,l="",f=0,p=t?6:0;if(e)for(;f<5;){for(n=e>>G[f]&q[f],a=0;a<n;++a)l+=x[f+p];++f}return l}function hashEP(e,n,a,l){e[a+1]!==l&&e[a-1]!==l||hashNum(n,t.zobristEnPassant[file(a)])}function addPawnMove(e,t,a,l){var f;(0===n||2&e[a+8])&&(rank(a)%7==0?(f=l|Z.PROMOTION|t<<7|a<<P,m[v++]=8388608|f,m[v++]=6291456|f,m[v++]=4194304|f,m[v++]=2097152|f):m[v++]=l|t<<7|a<<P)}function kingOfTheHillWin(e){switch(e){case 67:case 68:case 51:case 52:return!0}return!1}function canCastle960(e,t,n,a){var l,f,p,h=t+(n-t%8),m=n>t%8?1:-1;for(p=t+m;p!==h;p+=m)if(e[p])return!1;if(f=(l=1===a?1===m?118:114:1===m?6:2)-m,e[l+8]||e[l]&&l!==t&&l!==h||e[f]&&f!==t&&f!==h)return!1;if(l!==t)for(p=t+(m=l>t?1:-1);p!==l;p+=m)if(p!==h&&e[p]||e[p+8])return!1;return!0}var ee=function(){function createLine(e,t,n,a,l,p,h){var m,g,v,y,_,b,C,S,k,w,T,P=[],A="",M=!0,x=t[n],O=x.length,R="";if(x.commands)for(y in x.commands)(!p||p.indexOf(y)>-1)&&(R+="[%"+y+" "+x.commands[y]+"]");for(x.initComment&&!h&&(R=(R+" "+x.initComment.replace(/(\"|\}|\%|\\)/g,"\\$1")).trim()),R&&P.push("{"+R+"}"),g=0;g<O;++g){if(b=1===(m=x[g]).color,A="",R="",a!==f.Bughouse?(M&&!b?A=e+"...":b&&(A=e+"."),l&&(b||M)&&(A+=" ")):(P.bughouseOrder||(P.bughouseOrder=[]),P.bughouseOrder.push(m.bughouseOrder),g||(P.blackCountOffset=2===x[0].color?1:0)),A+=m.san,m.annotation&&(A+=m.annotation),m.additionalAnnotation&&(A+=" "+m.additionalAnnotation.join(" ")),M=!1,void 0===m.time||m.commands||(m.commands={clk:(k=m.time,w=void 0,T=void 0,w=Math.floor(k%36e3/600),T=Math.floor(k%36e3%600)/10,Math.floor(k/36e3)+":"+(w<10?"0":"")+w+":"+(T<10?"0":"")+T)}),m.commands)for(y in m.commands)(!p||p.indexOf(y)>-1)&&(R+="[%"+y+" "+m.commands[y]+"]");if(m.comment&&!h&&(R=(R+" "+m.comment.replace(/(\"|\}|\%|\\)/g,"\\$1")).trim()),R&&(A+=" {"+R+"}",M=!0),P.push(A),m.lines)for(C=m.lines.length,v=0;v<C;++v)t[S=m.lines[v]].length&&((_=createLine(e,t,S,a,l,p,h))[0]="("+_[0],_[_.length-1]+=")",P=P.concat(_),M=!0);b||e++}return P}function createHeader(e,t){return"["+e+' "'+String(t).replace(/(\"|\\)/g,"\\$1")+'"]'}return function generatePgn2(e,t,n,a,l,p){var h,m,g="string"==typeof e.newline?e.newline:"\n",v=void 0===e.spaceAfterPeriods||e.spaceAfterPeriods,y="";for(h in y+=createHeader("Event",t.Event)+g,y+=createHeader("Site",t.Site)+g,y+=createHeader("Date",t.Date)+g,y+=createHeader("Round",t.Round)+g,l===f.Bughouse?(y+=createHeader("WhiteA",t.WhiteA||"?")+g,y+=createHeader("BlackA",t.BlackA||"?")+g,y+=createHeader("WhiteB",t.WhiteB||"?")+g,y+=createHeader("BlackB",t.BlackB||"?")+g):(y+=createHeader("White",t.White)+g,y+=createHeader("Black",t.Black)+g),y+=createHeader("Result",t.Result)+g,l&&(y+=createHeader("Variant",t.Variant)+g),t.FEN&&t.FEN!==O&&(y+=createHeader("SetUp","1")+g,y+=createHeader("FEN",t.FEN)+g),t)-1===J.indexOf(h)&&(y+=createHeader(h,t[h])+g);if(y+=g,m=createLine(a,n,0,l,v,e.hideCommands?[]:e.restrictCommands,e.hideComments),l===f.Bughouse){if(p.isDependent)return m;m=function makeBugHousePgn(e,t,n){var a=t,l=e.siblingGame.pgn(),f=0,p=0,h=[];for(t.bughouseOrder=t.bughouseOrder||[],l.bughouseOrder=l.bughouseOrder||[];t.bughouseOrder.length||l.bughouseOrder.length;)!t.bughouseOrder.length||l.bughouseOrder.length&&t.bughouseOrder[0]>l.bughouseOrder[0]?(l.bughouseOrder.shift(),h.push("B")):(t.bughouseOrder.shift(),h.push("A"));return t=[],h.forEach((function(h){var m,g,v,y="";"A"===h?(m=a,g=++f,v=e.startingMoveNumber()):(m=l,g=++p,v=e.siblingGame.startingMoveNumber()),y=String(Math.floor((g+1)/2)+v-1),(m.blackCountOffset+g)%2?y+=h:y+=h.toLowerCase(),y+="."+(n?" ":"")+m.shift(),t.push(y)})),t}(p,m,v)}return m.push(t.Result),y+function wordWrap(e,t,n){return t<1?e:(t="number"==typeof t?t:80,e.replace(new RegExp("(.{1,"+t+"})(?: |$|\r?\n)","g"),"$1"+n).slice(0,-n.length))}(m.join(" "),e.maxWidth,g)}}(),te=function(){var e="!?~",t=/\[%(\S+)\s([^\]]+)\]/,n=/^(?:[+=~\/\-\u2212]+|T?N|RR|D)$/;function extractCommands(e){for(var n,a=e.commands||{};n=t.exec(e.value);)e.value=e.value.replace(n[0],"").trim(),a[n[1]]=n[2],e.commands=a}function isSplitGame(e,t,n,a){for(var l;++t<n;)if((l=e[t].trim())&&"%"!==l[0])return"["===l[0]&&(!a||/^\[\S+\s+".*"\]$/.test(l))}return function tokenize(t,a){var l,f,p,h,m,g,v,y="tags",_=[],b={type:y,value:""},C=0,S=[],k=!0;a=a||{},h=(l=t.split(/\r?\n/)).length;e:for(f=0;f<h;++f)if("%"!==(p=l[f].trim())[0])if(p){if(g=(p=" "+p+" ").length,m=0,k)for(;m<g;++m)if(v=p[m],"tags"===y){if("["===v)b={type:y="tagName",value:""};else if(v.trim()){b={type:y="san",value:""},k=!1;break}}else if("tagName"===y)b.value&&""===v.trim()?(_.push(b),y="tagValueStart"):" "!==v&&(b.value+=v);else if("tagValueStart"===y){if('"'===v||""===v)b={type:y="tagValue",value:""};else if(v.trim()){_.push({type:"tagValue",value:p.slice(m,-1).match(/(.*?)"?\]?$/)[1]}),b={type:y="tags",value:""};continue e}}else if("tagValue"===y)if('"'===v||""===v)if(_.push(b),"]"===p[m+1])b={type:y="tags",value:""},++m;else{if("]"===p.slice(-2,-1)){b.value+=p.substr(m).match(/(.*?)"?\s*\] $/)[1],b={type:y="tags",value:""};continue e}y="tagEnd"}else"\\"===v&&m+2<g&&(v=p[++m]),m>0&&(b.value+=v);else{if("]"!==v){if(!v.trim())continue;--m}b={type:y="tags",value:""}}for(;m<g;++m)if(v=p[m],"san"===y)if(e.indexOf(v)>-1)"!"===v||"?"===v||e.indexOf(v)<6&&(v=["!!","??","!?","?!"][e.indexOf(v)-2])?(b.value&&_.push(b),b={type:"a",value:v},"!"!==p[m+1]&&"?"!==p[m+1]||(b.value+=p[++m]),_.push(b),b={type:"san",value:""}):(""===v&&"=/"===b.value?(b.type="aa",b.value+=v):(b.value&&(n.test(b.value)&&("--"!==b.value||a.rejectNullMoves)&&(b.type="aa"),_.push(b)),b={type:"aa",value:v},""===v&&""===p[m+1]&&(b.value="",++m)),_.push(b),b={type:"san",value:""});else if(" "===v||"\t"===v||"\r"===v||"{"===v||"("===v||")"===v){if(b.value){if("$"===b.value[0])b.type="nag";else if("*"===b.value||"1-0"===b.value||"0-1"===b.value||"1/2-1/2"===b.value||"-"===b.value){if(!(C||m+1<g)){if(b.type="result","-"===b.value&&(b.value="1/2-1/2"),_.push(b),S.push(_),f+1===h||f+2===h&&!l[f+1])return S;k=!0,b={type:y="tags",value:""},_=[];break}b.type="*"===b.value?"cont":"comment"}n.test(b.value)&&("--"!==b.value||a.rejectNullMoves)&&(b.type="aa"),_.push(b),b={type:y,value:""}}if(" "===v||"\t"===v||"\r"===v)y="san";else if("{"===v)y="comment",_.length&&"comment"===_[_.length-1].type&&((b=_.pop()).value+=" ");else if("("===v)y="san",_.push({type:"variationStart",value:++C});else{if(C<1){if(!a.commentErrors)return!1}else _.push({type:"variationEnd",value:C--});y="san"}b.type=y}else if("."===v||!b.value&&+v==+v&&"-"!==p[m+1]&&"/"!==p[m+1]){if(+v==+v)switch(b.number||(b.number=""),b.number+=v,p[m+1]){case"A":case"a":case"B":case"b":b.number+=p[++m],_.push({type:"number",value:b.number}),delete b.number}}else b.value+=v;else 0===m&&(b.value=b.value.trim()),"}"!==v?("\\"===v&&m+2<g&&(v=p[++m]),b.value+=v):(b.value=b.value.trim(),b.value.indexOf("[")>-1&&extractCommands(b),_.push(b),b={type:y="san",value:""})}else _.length&&("tags"===y?(y="san",k=!1):"tagValueStart"!==y&&isSplitGame(l,f,h,C||"comment"===y)&&("comment"===y&&_.push(b),"tagValue"!==_[_.length-1].type&&(S.push(_),_=[]),y="tags",k=!0,C=0));return b.value&&_.push(b),!_.length&&S.length||S.push(_),S}}();function Chess2(J,ne){var re,oe,ie=0,ae=!0,se=[],ce=1,le=[],ue=_,de=0,fe=1,pe=1,he=[],me=[he],ge=0;he.id=ge;var ve={},ye=[],_e=!1,be=!1,Ce=makeMoveChess,moveToSan=function(e,t){var n,a,l,f,p,h,_="";return e&Z.KQSIDE_CASTLE?_=e&Z.KSIDE_CASTLE?"O-O":"O-O-O":e&Z.DROP?((n=e>>A)&&(_+=K[n]),_+="@"+algebraic(l=e>>P&M)):(l=e>>P&M,4&(f=oe[a=e>>7&M])?(e&Z.ANY_CAPTURE&&(_+=String.fromCharCode(file(a)+97)+"x"),_+=algebraic(l),e&Z.PROMOTION&&(_+="="+K[n=e>>A])):(_+=D[f&k],y>1&&(_+=function getDisambiguator(e,t,n){var a,l,f,p,h,g;if(v<2)return"";for(e&=S,g=0;g<v;++g)if(n===(a=m[g])>>P&&(f=a>>7&M)!==t&&oe[f]&e){if(l=!0,rank(t)===rank(f)){if(p)return algebraic(t);h=!0}if(file(t)===file(f)){if(h)return algebraic(t);p=!0}}return l?p?String(8-rank(t)):String.fromCharCode(file(t)+97):""}(f,a,l)),e&Z.ANY_CAPTURE&&(_+="x"),_+=algebraic(l))),t||(e&Z.KQSIDE_CASTLE?(a=e>>7&M,l=e>>P&M):e&Z.DROP_OR_PROMOTE&&(f=z[n]+ce),inCheckAfterMove(f,a,l,e)&&(Ce(e,a,l,n),p=g,g=v,h=y,ie&&isVariantWin()||generateMoves()===g?_+="#":_+="+",v=g,g=p,y=h,reverseMove(he.pop()))),_};function hashPosition(){var e,n,a,l=1===ce?[4174784170,2938602761]:[0,0];for(a=0;a<120;++a)136&a&&(a+=8),(e=oe[a])&&hashNum(l,t.zobristPiece[64*t.zobristPieceValueNumbers[e&k]+8*(7-rank(a))+file(a)]);if(be)for(n=1;n<3;++n)le[n]&&(0!=(le[n]&le[n]-1)?(hashNum(l,t.zobristCastle[n-1]),hashNum(l,t.zobristCastle[n+1])):le[n]>1<<file(se[n])?hashNum(l,t.zobristCastle[n-1]):hashNum(l,t.zobristCastle[n+1]));else{for(n=1;n<3;++n)le[n]&&(le[n]&Z.KSIDE_CASTLE&&hashNum(l,t.zobristCastle[n-1]),le[n]&Z.QSIDE_CASTLE&&hashNum(l,t.zobristCastle[n+1]));_e?function hashHand(e,n){var a,l,f,p,h,m,g,v=0;for(a=1;a<3;++a){if(l=n[a])for(f=0;f<5;){for(h=v+63*f,p=l>>G[f]&q[f],m=0;m<p;++m)hashNum(e,[31*(g=t.zobristPiece[h++])[0]>>>0,17*g[1]>>>0]);++f}v=315}}(l,re._hand):ie===f["3-check"]&&function hash3Check(e,n){n[1]&&hashNum(e,t.zobristCheck[n[1]-1]),n[2]&&hashNum(e,t.zobristCheck[n[2]+2])}(l,ye)}return ue!==_&&hashEP(oe,l,ue+(1===ce?16:-16),4|ce),l}function getCurrentHash(){var e;return he.length?e=he[he.length-1].hash:(he.hash||(he.hash=hashPosition()),e=he.hash),[e[0],e[1]]}function bughouseify(e){function fixBughouseSan(e){return/#/.test(e)&&checkIsPotentiallyBlockable()&&(e=e.replace("#","+")),e}function bughouseFunc(t,n){var a=e(t,n);return a&&("string"==typeof a?a=fixBughouseSan(a):(a.san=fixBughouseSan(a.san),he[he.length-1].san=a.san)),a}return bughouseFunc._isBughouseified=!0,bughouseFunc._orig=e,bughouseFunc}function setVariant(e,t){ie!==(ie=e?f[e]||1*e||f[String(e).replace(/\s/g,"").toLowerCase()]||f.Chess:0)&&(ie===f.Bughouse?(_e=!0,re.isDependent||(re.siblingGame=Chess2(),re.siblingGame.hashing(ae),re.siblingGame.isDependent=!0,re.siblingGame.siblingGame=re,re.siblingGame.header({Variant:"Bughouse"})),createVariantZobristNumbers(),Ce=makeMoveVariant,moveToSan=bughouseify(moveToSan),re.move=bughouseify(re.move)):(delete re.siblingGame,_e=ie===f.Crazyhouse,be=ie===f.Chess960,ie?(createVariantZobristNumbers(),Ce=makeMoveVariant):Ce=makeMoveChess,moveToSan._isBughouseified&&(moveToSan=moveToSan._orig,re.move=re.move._orig)),t||updateSetup(generateFen()))}function disambiguate960Rook(e,t){for(var n,a,l=e>7?1:2;!(136&e);){if((n=oe[e])&l)if(n&b){if(a)return;a=e%8+(1===l?65:97)}else if(n&C)return a;e+=t}}function clear(e,t,n){oe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ce=1,se[1]=_,se[2]=_,le[1]=0,le[2]=0,re._hand[1]=0,re._hand[2]=0,ye[1]=0,ye[2]=0,ue=_,de=0,fe=1,t||(me=[he=[]],ge=0,he.id=ge,ve={Event:"?",Site:"?",Date:"????.??.??",Round:"?",White:"?",Black:"?",Result:"*"},e?setHeader(["Variant",e]):setVariant(!1,n),n||updateSetup(generateFen()))}function reset(){clear(0,!1,!0),he.hash=[1178310168,378666140],oe=[34,10,18,66,130,18,10,34,0,0,0,0,0,0,0,0,6,6,6,6,6,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,33,9,17,65,129,17,9,33,0,0,0,0,0,0,0,0],pe=1,se[1]=116,se[2]=4,le[1]=48,le[2]=48}function load2(e,t,n,a){var l,m,g,v,y,S,k,T,P,A,M,x,O=0;if(a?(x=(l=e.split(" "))[3],M=l[2]):(x=(l=e.trim().split(/\s+/))[3]||"-",M=l[2]||"-"),void 0===t?(31&M.charCodeAt(0))<9&&setVariant(f.Chess960,!0):setVariant(t,!0),m=l[0],!a&&!(m=function fixFenPieces(e,t){var n,a,l=e.length,p=0,h=0,m=t&&(t===f.Crazyhouse||t===f.Bughouse);for(n=0;n<l;++n)if(+(a=e[n])!=+a)if("/"===a){if(8!==h&&(e=e.substr(0,n)+(8-h)+e.substr(n),++n,++l),h=0,++p>7){if(!m&&n<l-1||!/^[pnbrq]{0,63}$/i.test(e.substr(n+1)))return!1;break}}else if(I[a]){if(++h>8)return!1}else{if("~"!==a)return!1;m&&n&&/[nbrq]/i.test(e[n-1])||(e=e.substr(0,n)+e.substr(n+1),--n,--l)}else(h+=1*a)>8&&(e=e.substr(0,n)+(a-(h-8))+e.substr(n+1),h=8);return e}(m,ie)))return!1;if(v=m.length,clear(p[ie],n,!0),_e){if(ie===f.Bughouse&&!re.isDependent&&(S=e.split(" | "),!re.siblingGame.load(1===S.length?e:S[1],t,n,a)))return reset(),!1;for(y=0;y<v;++y)if(+(k=m[y])!=+k)if("/"===k){if(O>111){for(++y;y<v;++y)k=m[y],re._hand[k<"a"?1:2]+=1<<W[k]>>>0;break}O+=8}else oe[O]=I[k],"~"===m[y+1]&&(++y,oe[O]|=w),oe[O]&C&&(se[3&oe[O]]=O),++O;else O+=1*k}else for(y=0;y<v;++y)+(k=m[y])!=+k?"/"===k?O+=8:(oe[O]=I[k],oe[O]&C&&(se[3&oe[O]]=O),++O):O+=1*k;if(ce="b"===l[1]?2:1,"-"!==M)if(be){for(P={1:[0,0],2:[0,0]},y=M.length-1;y>=0;--y)75===(g=M.charCodeAt(y))?g=disambiguate960Rook(119,-1):81===g?g=disambiguate960Rook(112,1):107===g?g=disambiguate960Rook(7,-1):113===g&&(g=disambiguate960Rook(0,1)),T=g<97?1:2,A=X[String.fromCharCode(g)],(a||oe[A]===(b|T))&&(g>=97?se[T]>=1&&se[T]<=6&&(le[T]|=1<<A):se[T]>=113&&se[T]<=118&&(le[T]|=1<<A-112),++P[T][1*(se[T]<A)]);(P[1][0]>1||P[1][1]>1)&&(le[1]=0),(P[2][0]>1||P[2][1]>1)&&(le[2]=0)}else{if(!a)for(y=M.length-1;y>=0;--y)T=M.charCodeAt(y)<97?1:2,oe[X[M[y]]]===(b|T)&&se[T]===(1===T?116:4)||(M=M.substr(0,y)+M.substr(y+1));for(y=M.length-1;y>=0;--y)switch(M[y]){case"K":le[1]|=Z.KSIDE_CASTLE;break;case"Q":le[1]|=Z.QSIDE_CASTLE;break;case"k":le[2]|=Z.KSIDE_CASTLE;break;case"q":le[2]|=Z.QSIDE_CASTLE}}return!a&&(2!==x.length||1===ce&&"6"!==x[1]||2===ce&&"3"!==x[1]||oe[x.charCodeAt(0)-97+16*(8-("3"===x[1]?4:5))]!==(4|swapColor(ce))||oe[h[x]])&&(x="-"),ue="-"===x?_:h[x],de=1*l[4]||0,fe=1*l[5]||1,ie===f["3-check"]&&(l[6]&&"+3+3"!==l[6]&&(S=l[6].match(/^\+([0-3])\+([0-3])$/)),S=S||[0,0,0],ye[1]=1*S[1],ye[2]=1*S[2]),n||(pe=fe,updateSetup(generateFen())),!0}function generateFen(){return ie?function generateVariantFen(){var e,t,n,a=0,l="",p="";for(e=0;e<120;++e)136&e&&(a&&(l+=a),l+="/",a=0,e+=8),(n=oe[e])?(a&&(l+=a,a=0),l+=N[n&k],_e&&n&w&&(l+="~")):++a;if(a&&(l+=a),_e&&(l+="/"+handToString(re._hand[1],!0)+handToString(re._hand[2])),be){for(t=le[2],e=0;t;)1&t&&(p=String.fromCharCode(e+97)+p),t>>=1,++e;for(t=le[1],e=0;t;)1&t&&(p=String.fromCharCode(e+65)+p),t>>=1,++e}else le[1]&Z.KSIDE_CASTLE&&(p+="K"),le[1]&Z.QSIDE_CASTLE&&(p+="Q"),le[2]&Z.KSIDE_CASTLE&&(p+="k"),le[2]&Z.QSIDE_CASTLE&&(p+="q");return l+=" "+(1===ce?"w":"b")+" "+(p||"-")+" "+(ue===_?"-":algebraic(ue))+" "+de+" "+fe,ie===f["3-check"]?l+=" +"+ye[1]+"+"+ye[2]:ie!==f.Bughouse||re.isDependent||(l+=" | "+re.siblingGame.fen()),l}():function generateStandardFen(){var e,t,n=0,a="",l="";for(e=0;e<120;++e)136&e&&(n&&(a+=n),a+="/",n=0,e+=8),(t=oe[e])?(n&&(a+=n,n=0),a+=N[t&k]):++n;return n&&(a+=n),le[1]&Z.KSIDE_CASTLE&&(l+="K"),le[1]&Z.QSIDE_CASTLE&&(l+="Q"),le[2]&Z.KSIDE_CASTLE&&(l+="k"),le[2]&Z.QSIDE_CASTLE&&(l+="q"),a+" "+(1===ce?"w":"b")+" "+(l||"-")+" "+(ue===_?"-":algebraic(ue))+" "+de+" "+fe}()}function setHeader(e){var t,n,a;for(t=0;t<e.length;t+=2)n=e[t],a=e[t+1],n&&("Variant"===n&&(setVariant(a),a=ie?p[ie]:void 0),"Result"===n&&"*"!==a&&"1-0"!==a&&"0-1"!==a&&"1/2-1/2"!==a&&(a="*"),void 0!==a?ve[n]=String(a):Y.indexOf(n)>-1?ve[n]="Date"===n?"????.??.??":"?":delete ve[n]);return ve}function updateSetup(e){he.length>0||ge||(e!==O?(ve.SetUp="1",ve.FEN=e,he.hash=null):(delete ve.SetUp,delete ve.FEN,he.hash=[1178310168,378666140]))}function get2(e){var t=oe[h[e]];return t?{type:N[t&S|2],color:3&t,promoted:0!=(t&w)}:null}function calculateLegalMoveInfo(t,f){var p,h,m,g,v,y,b,C,k,w,P,A,M,x=ce,O=oe;if(e=[],n=0,a=0,l=0,O[8]=O[9]=O[10]=O[11]=O[12]=O[13]=O[14]=O[15]=O[24]=O[25]=O[26]=O[27]=O[28]=O[29]=O[30]=O[31]=O[40]=O[41]=O[42]=O[43]=O[44]=O[45]=O[46]=O[47]=O[56]=O[57]=O[58]=O[59]=O[60]=O[61]=O[62]=O[63]=O[72]=O[73]=O[74]=O[75]=O[76]=O[77]=O[78]=O[79]=O[88]=O[89]=O[90]=O[91]=O[92]=O[93]=O[94]=O[95]=O[104]=O[105]=O[106]=O[107]=O[108]=O[109]=O[110]=O[111]=O[120]=O[121]=O[122]=O[123]=O[124]=O[125]=O[126]=O[127]=0,f!==_){for(A=function chooseKingThreats(e,t){return be&&le[e]?V:le[e]&Z.KSIDE_CASTLE&&!oe[t+1]&&!oe[t+2]?le[e]&Z.QSIDE_CASTLE&&!oe[t-1]&&!oe[t-2]&&!oe[t-3]?(l=Z.KQSIDE_CASTLE,H):(l=Z.KSIDE_CASTLE,j):le[e]&Z.QSIDE_CASTLE&&!oe[t-1]&&!oe[t-2]&&!oe[t-3]?(l=Z.QSIDE_CASTLE,$):F}(x,f),p=0;p<120;++p)if(136&p&&(p+=8),g=oe[p])if(g&x)(!t||(0|g)&t)&&e.push(p);else if(0!=((M=A[p-f+119])&g))if(4&g)for(k=R[g],h=1;h<3;++h)136&(b=p+k[h])||(O[b+8]|=1,b===f&&(++n,O[p+8]|=2));else{C=(k=R[g&S]).length,P=g&T;e:for(h=0;h<C;++h)if(w=k[h],!(f>(b=p)&&w<0&&f-b>16||f<b&&w>0&&b-f>16))for(;0==(136&(b+=w));){if(O[b+8]|=1,v=oe[b]){if(v&x)if(b===f){for(m=b-w;m!==p;m-=w)O[m+8]|=2;O[p+8]|=2,++n,P&&0==(136&(b+=w))&&(O[b+8]|=1)}else if(P&&256&M){for(y=b;(y+=w)!==f;)if(136&y||oe[y])continue e;O[b+8]|=4+(Math.abs(w)<<3),++a}break}if(!P)break}}n>1&&(e=[f])}else e=function getPieces(e,t){var n,a,l=[];for(n=0;n<120;++n)136&n&&(n+=8),(a=e[n])&&(a&t)===t&&l.push(n);return l}(oe,x|t)}function validateEnPassant(e,t){var a,l,f,p=t+16*(1===ce?1:-1);return(1!==n||0!=(2&oe[t+8])||0!=(2&oe[p+8]))&&(a=oe[e],oe[t]=a,oe[e]=0,l=oe[p],oe[p]=0,f=inCheck(),oe[e]=a,oe[t]=0,oe[p]=l,!f)}function addCastlingMoves(e){var t,n,a;if(be){if(le[e])for(n=(t=se[e])%8,a=0;a<8;++a)le[e]&1<<a&&canCastle960(oe,t,a,e)&&(m[v++]=(a>n?Z.KSIDE_CASTLE:Z.QSIDE_CASTLE)+(t<<7)+(t+(a-n)<<P),++a)}else l&Z.KSIDE_CASTLE&&(n=(t=se[e])+2,0===oe[t+9]&&0===oe[t+10]&&(m[v++]=Z.KSIDE_CASTLE+(t<<7)+(n<<P))),l&Z.QSIDE_CASTLE&&(n=(t=se[e])-2,0===oe[t+7]&&0===oe[t+6]&&(m[v++]=Z.QSIDE_CASTLE+(t<<7)+(n<<P)))}function generateMoves(t,l){var f,p,h,_,b,C,k,w,M,x,O=ce,I=swapColor(O),L=se[O];for(calculateLegalMoveInfo(t,L),y=e.length,v=g,M=0;M<y;++M)if(f=e[M],_=oe[f],!(n&&a&&4&oe[f+8]))if(4&_)for(C=R[_],0!==a&&0!=(4&oe[f+8])&&oe[f+8]>>3!=16||(b=f+C[0],0===oe[b]&&(addPawnMove(oe,f,b,0),Q[O]===rank(f)&&(b+=C[0],oe[b]||addPawnMove(oe,f,b,Z.BIG_PAWN)))),p=1;p<3;++p)136&(b=f+(k=C[p]))||a&&4&oe[f+8]&&oe[f+8]>>3!==Math.abs(k)||(oe[b]&I?addPawnMove(oe,f,b,Z.CAPTURE):b===ue&&validateEnPassant(f,b)&&(m[v++]=Z.EP_CAPTURE|f<<7|b<<P));else{if(a&&4&oe[f+8]){if(8&_)continue;if(!(B[f-se[O]+119]&_))continue;C=[k=oe[f+8]>>3,-k]}else C=R[_&S];if(x=f<<7,f===L){for(p=0;p<8;++p)0==(136&(b=f+(k=C[p])))&&(oe[b]?oe[b]&I&&0==(1&oe[b+8])&&(m[v++]=Z.CAPTURE|x|b<<P):0==(1&oe[b+8])&&(m[v++]=x|b<<P));0===n&&addCastlingMoves(O)}else for(h=C.length,w=_&T,p=0;p<h;++p)for(k=C[p],b=f;!(136&(b+=k));){if(oe[b]){oe[b]&I&&(0===n||2&oe[b+8])&&(m[v++]=Z.CAPTURE|x|b<<P);break}if((0===n||2&oe[b+8])&&(m[v++]=x|b<<P),!w)break}}return ie&&(_e?function drop(e,t,a){var l,f,p,h,g;if(!e)for(t&&(t>>=26),h=0;h<5;++h)if((!t||(0|t)==1<<h)&&re._hand[a]&q[h]<<G[h]){for(0===h?(l=16,f=103,p=Z.DROP):(l=0,f=119,p=Z.DROP|h<<A),g=l;g<=f;++g)136&g&&(g+=8),oe[g]||(0===n||1===n&&2&oe[g+8])&&(m[v++]=p|g<<P);if(t)return}}(l,t,O):!be&&isVariantWin()&&(v=g)),v}function inCheckAfterMove(e,t,n,a){var l,p,h,m,g,v,y,S;if(ie===f["King of the Hill"]&&e&C&&kingOfTheHillWin(n))return!0;if(a&Z.KQSIDE_CASTLE&&(n=1===ce?a&Z.KSIDE_CASTLE?117:115:a&Z.KSIDE_CASTLE?5:3,e=b,S=!0),(l=se[swapColor(ce)])===_)return!1;if(0==(e&C)&&B[n-l+119]&e)for(g=e&T,m=n+(h=U[n-l+119]);0==(136&m);){if(m===l){if(4&e){if(1==(3&e)?l-n<0:l-n>0)return!0;break}return!0}if(m!==t&&oe[m]||!g)break;m+=h}if(!S){if((p=B[t-l+119])&T&&(h=U[t-l+119])!==U[n-l+119])for(m=l-h;0==(136&m);){if(m!==t&&(v=oe[m])){if(v&ce&&p&v&&v&T)return!0;break}m-=h}if(a&Z.EP_CAPTURE&&(p=B[(y=n+16*(1===ce?1:-1))-l+119])&T)for(m=l-(h=U[y-l+119]);0==(136&m);){if(m!==t&&m!==y){if(m===n)break;if(v=oe[m]){if(v&ce&&p&v&&v&T)return!0;break}}m-=h}}return!1}function attacked(e,t){var n,a,l,f,p=R[8],h=8|e;for(n=0;n<8;++n)if(0==(136&(l=t+p[n]))&&((a=oe[l])&h)===h)return!0;for(p=R[128],n=0;n<8;++n)for(l=t+(f=p[n]);0==(136&l);){if(a=oe[l]){if(a&e&&B[t-l+119]&a){if(!(4&a))return!0;if(1===e?t-l<0:t-l>0)return!0}break}l+=f}return!1}function kingAttacked(e){return se[e]!==_&&attacked(swapColor(e),se[e])}function inCheck(){return kingAttacked(ce)}function checkIsPotentiallyBlockable(){var e,t,n,a=1<<G[4];return re._hand[ce]+=a,e=g,g=v,t=y,n=generateMoves()!==g,v=g,g=e,y=t,re._hand[ce]-=a,n}function inCheckmate(){return inCheck()&&(m[0]=0)===generateMoves()&&!m[0]&&(ie!==f.Bughouse||!checkIsPotentiallyBlockable())}function inStalemate(){var e=!inCheck()&&(m[0]=0)===generateMoves()&&!m[0];return e&&ie===f.Bughouse&&!re.isDependent&&(e=re.siblingGame.inStalemate()),e&&se[ce]!==_}function insufficientMaterial(e){var t,n,a=0,l=0,f=0;for(n=0;n<120;++n)if(136&n&&(n+=8),t=oe[n]){if(e&&0==(t&e))continue;if(100&t)return!1;if(8&t){if(l||a++)return!1}else if(16&t){if(a)return!1;if(++l,(rank(n)+n)%2&&++f,f&&l!==f)return!1}}return!0}function inThreefoldRepetition(){if(de<8)return!1;for(var e,t=getCurrentHash(),n=!1,a=de,l=!1,f=he,p=f.length-1;;){if((p-=2)<0){if(f.id){p=f.atMoveNode+p+2,f=me[f.parentId];continue}if(-2===p)return!1;e=f.hash,l=!0}else e=f[p].hash,f[p].halfMoves>a||a<2?l=!0:a=f[p].halfMoves;if(e[0]===t[0]&&e[1]===t[1]){if(n)return!0;n=!0}if(l)return!1}}function modifyHand(e){var n,a,l,p,h,m,g,v,y,_=e.move;if(ie===f.Crazyhouse||_&Z.DROP?(a=re._hand,h=e.hash,y=e.color):(a=re.siblingGame._hand,e.handSibling=!0,ae&&((m=re.siblingGame._history()).length?h=m[m.length-1].hash:(m.hash||(m.hash=re.siblingGame._hashPosition()),h=m.hash)),y=swapColor(e.color)),e.captured){switch((e.captured&w?4:e.captured&S)&S){case 4:g=0;break;case 8:g=1;break;case 16:g=2;break;case b:g=3;break;default:g=4}n=1<<G[g],ae&&(p=a[y]>>G[g]&q[g],v=t.zobristPiece[p+63*g+(1===y?0:315)])}else n=-1<<G[l=_>>A],ae&&(p=a[y]>>G[l]&q[l],v=t.zobristPiece[p-1+63*l+(1===y?0:315)]);a[y]+=n,e.handChange=n,ae&&hashNum(h,[31*v[0]>>>0,17*v[1]>>>0])}function makeMoveChess(e,n,a,l){var f,p,h,m,g,v,y,S,T=ce,P=swapColor(T),A={move:e,epSquare:ue,halfMoves:de,castlingW:le[1],castlingB:le[2],color:T},M=1===T;ae&&(m=getCurrentHash(),A.hash=m,hashNum(m,t.zobristTurn),ue!==_&&hashEP(oe,m,ue+(M?16:-16),4|T)),0==(e&Z.KQSIDE_CASTLE)?_e&&e&Z.DROP?(oe[a]=z[l]|T,ae&&hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[oe[a]]+8*(7-rank(a))+file(a)]),modifyHand(A),y=0):(y=oe[n],(S=oe[a])&&(A.captured=S,ae&&hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[oe[a]&k]+8*(7-rank(a))+file(a)]),S&b&&le[P]&&(be?rank(a)===(M?0:7)&&(h=1<<file(a),le[P]&h&&(le[P]^=h,ae&&(h>1<<file(se[T])?hashNum(m,t.zobristCastle[P-1]):hashNum(m,t.zobristCastle[P+1])))):a===(M?7:119)?le[P]&Z.KSIDE_CASTLE&&(le[P]^=Z.KSIDE_CASTLE,ae&&hashNum(m,t.zobristCastle[P-1])):a===(M?0:112)&&le[P]&Z.QSIDE_CASTLE&&(le[P]^=Z.QSIDE_CASTLE,ae&&hashNum(m,t.zobristCastle[P+1])))),oe[a]=e&Z.PROMOTION?z[l]|T|w:oe[n],oe[n]=0,ae&&(hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[y&k]+8*(7-rank(n))+file(n)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[oe[a]&k]+8*(7-rank(a))+file(a)]))):y=C,e&Z.EP_CAPTURE?(M?(v=a+16,g=6):(v=a-16,g=8),A.captured=4|P,oe[v]=0,ae&&hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[4|P]+8*(g-rank(a))+file(a)])):y&C?(be?(e&Z.KQSIDE_CASTLE&&(oe[a]=0,oe[n]=0,e&Z.KSIDE_CASTLE?M?(f=118,p=117):(f=6,p=5):M?(f=114,p=115):(f=2,p=3),oe[f]=T|C,oe[p]=T|b,ae&&(hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[C|T]+8*(7-rank(n))+file(n)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[b|T]+8*(7-rank(a))+file(a)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[C|T]+8*(7-rank(f))+file(f)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[b|T]+8*(7-rank(p))+file(p)]))),ae&&(0!=(le[T]&le[T]-1)?(hashNum(m,t.zobristCastle[T-1]),hashNum(m,t.zobristCastle[T+1])):le[T]>1<<file(se[T])?hashNum(m,t.zobristCastle[T-1]):hashNum(m,t.zobristCastle[T+1])),se[T]=f||a):(e&Z.KQSIDE_CASTLE&&(oe[a]=oe[n],oe[n]=0,e&Z.KSIDE_CASTLE?(f=a-1,p=a+1):(f=a+1,p=a-2),oe[f]=oe[p],oe[p]=0,ae&&(hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[C|T]+8*(7-rank(n))+file(n)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[b|T]+8*(7-rank(p))+file(p)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[C|T]+8*(7-rank(a))+file(a)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[b|T]+8*(7-rank(f))+file(f)]))),ae&&(le[T]&Z.KSIDE_CASTLE&&hashNum(m,t.zobristCastle[T-1]),le[T]&Z.QSIDE_CASTLE&&hashNum(m,t.zobristCastle[T+1])),se[T]=a),le[T]=0):y&b&&le[T]&&(be?rank(n)===(M?7:0)&&(h=1<<file(n),le[T]&h&&(le[T]^=h,ae&&(h>1<<file(se[T])?hashNum(m,t.zobristCastle[T-1]):hashNum(m,t.zobristCastle[T+1])))):n===(M?119:7)?le[T]&Z.KSIDE_CASTLE&&(le[T]^=Z.KSIDE_CASTLE,ae&&hashNum(m,t.zobristCastle[T-1])):n===(M?112:0)&&le[T]&Z.QSIDE_CASTLE&&(le[T]^=Z.QSIDE_CASTLE,ae&&hashNum(m,t.zobristCastle[T+1]))),e&Z.BIG_PAWN?(ue=M?a+16:a-16,ae&&hashEP(oe,m,a,4|P)):ue=_,4&y||e&Z.ANY_CAPTURE?de=0:de++,ce=P,he.push(A)}function makeMoveVariant(e,n,a,l){var p,h=ce;makeMoveChess(e,n,a,l),p=he[he.length-1],_e?(de=p.halfMoves+1,p.captured&&modifyHand(p),ie===f.Bughouse&&(p.bughouseOrder=re.moveCount()-1+re.siblingGame.moveCount())):ie===f["3-check"]&&kingAttacked(ce)&&(p.checked=!0,ae&&ye[h]&&hashNum(p.hash,t.zobristCheck[ye[h]+(1===h?-1:2)]),++ye[h],ae&&hashNum(p.hash,t.zobristCheck[ye[h]+(1===h?-1:2)]))}function reverseMove(e){var t,n,a=ce,l=swapColor(a),p=e.move,h=p>>P&M,m=p>>7&M;if(ce=l,le[2]=e.castlingB,le[1]=e.castlingW,ue=e.epSquare,de=e.halfMoves,ie){if(be&&p&Z.KQSIDE_CASTLE)return p&Z.KSIDE_CASTLE?1===l?(n=118,t=117):(n=6,t=5):1===l?(n=114,t=115):(n=2,t=3),oe[n]=0,oe[t]=0,oe[m]=l|C,oe[h]=l|b,void(se[l]=m);if(e.handChange&&(ie!==f.Crazyhouse&&e.handSibling?re.siblingGame._hand[swapColor(l)]-=e.handChange:re._hand[l]-=e.handChange),p&Z.DROP)return void(oe[h]=0);e.checked&&--ye[l]}p&Z.PROMOTION?(oe[m]=4|l,oe[h]=p&Z.CAPTURE?e.captured:0):(oe[m]=oe[h],p&Z.KQSIDE_CASTLE?(oe[h]=0,p&Z.KSIDE_CASTLE?(t=h+1,n=h-1):(t=h-2,n=h+1),oe[t]=l|b,oe[n]=0,se[l]=m):(h===se[l]&&(se[l]=m),p&Z.CAPTURE?oe[h]=e.captured:(oe[h]=0,p&Z.EP_CAPTURE&&(oe[h-(1===l?-16:16)]=4|a))))}function beautifyMove(e,t,n){var a,l,f=e>>P&M,p={color:ce,to:algebraic(f),flags:e&M};return _e&&0!=(e&Z.DROP)?(l=e>>A,p.drop=l,p.piece=z[l]+ce):(a=e>>7&M,p.from=algebraic(a),p.piece=oe[a],e&Z.PROMOTION&&(l=e>>A,p.promotion=z[l]+ce),e&Z.CAPTURE?p.captured=oe[f]:e&Z.EP_CAPTURE&&(p.captured=4|swapColor(ce))),p.san=t||moveToSan(e,n),p}function isVariantWin(){return ie===f["3-check"]?3===ye[swapColor(ce)]:ie===f["King of the Hill"]?kingOfTheHillWin(se[swapColor(ce)]):void 0}function isBughouseWin(){if(ie===f.Bughouse)return re.siblingGame.inCheckmate()}function createVariation(){var e=[],t=generateFen(),n=he.length-1,a=he[n];return!!a&&(e.parentId=ge,e.id=me.length,he.curFen=t,a.lines||(a.lines=[]),a.lines.push(e.id),a.move?reverseMove(a):(ue=a.epSquare,--de,ce=swapColor(ce)),2===ce&&--fe,e.atMoveNode=n,e.hash=n?he[n-1].hash:he.hash,ge=e.id,me.push(e),he=e,!0)}function selectLine(e){var t=generateFen();he.curFen=t,he=me[e],ge=e,load2(he.curFen,ie,!0,!0)}return re={WHITE:1,BLACK:2,PAWN:4,KNIGHT:8,BISHOP:16,ROOK:b,QUEEN:64,KING:C,FLAGS:Z,load:load2,reset:reset,moves:function(e){var t,n,a,l=[],f=moveToSan;for(e&&(e.verbose&&(f=beautifyMove),e.type&&(n=e.type|e.type<<24),a=e.noDrop),generateMoves(n,a),t=0;t<v;++t)l.push(f(m[t]));return l},inCheck:inCheck,inCheckmate:inCheckmate,inStalemate:inStalemate,isBughouseWin:isBughouseWin,in50MoveRule:function(){return de>=100},inDraw:function(){return de>=100||inStalemate()||insufficientMaterial()||inThreefoldRepetition()||Boolean(function isBughouseDraw(){if(ie===f.Bughouse)return re.siblingGame.in50MoveRule()||re.siblingGame.inThreefoldRepetition()}())},insufficientMaterial:insufficientMaterial,inThreefoldRepetition:inThreefoldRepetition,isVariantWin:isVariantWin,gameOver:function(){return re.inDraw()||inCheckmate()||Boolean(isVariantWin())||Boolean(isBughouseWin())},isPositionValid:function(e){var t,n,a,l=0;if(!1!==(e=e||{}).pawns)for(t=0;t<=119;){if(4&(a=oe[t]))return!1;8==++t&&(t=112)}if(!1!==e.kings){for(t=0;t<=119;++t)if(136&t&&(t+=8),(a=oe[t])&C){if(++l>2)return!1;if(n&&n&a)return!1;n=3&a}if(2!==l)return!1}return!1===e.check||!1===e.kings&&se[swapColor(ce)]===_||!kingAttacked(swapColor(ce))},validateFen:validateFen,fen:generateFen,pgn:function(e){return(e=e||{}).useResultHeader||ge||(isVariantWin()||inCheckmate()?ve.Result=2===ce?"1-0":"0-1":re.inStalemate()?ve.Result="1/2-1/2":isBughouseWin()&&(ve.Result=1===re.siblingGame.turn()?"1-0":"0-1")),ee(e,ve,me,pe,ie,re)},loadPgn:function(e,t,n){var a,l,f,p,h,m,g,v,y,_={},b=0;if("number"!=typeof t&&(n=n||t,t=0),n=n||{},"string"==typeof e&&(n.singleGame&&(e=e.replace(/(?:\r?\n\s*){2,}/g,"\n")),e=re.tokenizePgn(e,n)),t<0&&(t=e.length+t),!(p=e[t]))return!1;for(reset(),l=p.length,a=0;a<l&&"tagName"===(f=p[a]).type;++a){if(!p[a+1]||"tagValue"!==p[a+1].type)return!1;++a,"FEN"===f.value?g=completeFen(p[a].value):_[f.value]=p[a].value}if(n.variant&&(_.Variant=n.variant),_.Variant&&!g&&(g=O),g||"1"===_.SetUp)if("0"===_.SetUp)_.FEN=g;else if(!g||!load2(g,_.Variant))return!1;for(re.header(_),m=(h=re)._history();a<l;++a)if("san"===(f=p[a]).type&&0===b){if(!h.move(f.value)&&("Z0"!==f.value&&"<>"!==f.value||n.rejectNullMoves||!h.move("--")))if(n.commentErrors)m.length?m[m.length-1].comment=((m[m.length-1].comment||"")+" "+f.value).trim():m.initComment=((m.initComment||"")+" "+f.value).trim();else{if(!n.skipBadLines||!(0!==ge||he.length&&n.allowBadMainLine))return reset(),!1;b=1}}else if("result"===f.type&&"*"===ve.Result)setHeader(["Result",f.value]);else if("a"===f.type&&0===b&&m[m.length-1])m[m.length-1].annotation=f.value;else if("nag"!==f.type&&"aa"!==f.type||0!==b||!m[m.length-1])if("comment"===f.type&&0===b)m.length?(f.value&&(m[m.length-1].comment=f.value),f.commands&&(m[m.length-1].commands=f.commands,f.commands.clk&&(m[m.length-1].time=(v=f.commands.clk,y=void 0,10*(3600*(y=v.split(":"))[0]+60*y[1]+1*y[2]))))):(m.initComment=String(f.value),f.commands&&(m.commands=f.commands));else if("variationStart"===f.type){if(b>0)++b;else if(!createVariation())return reset(),!1;m=h._history()}else if("variationEnd"===f.type)b>0&&--b,0===b&&(selectLine(m.parentId),m=h._history());else if("number"===f.type){if(!(h=/b/i.test(f.value.slice(-1))?re.siblingGame:re))return!1;m=h._history()}else"cont"===f.type&&ge&&!m.length&&h.move(h._lines()[m.parentId][m.atMoveNode].san);else m[m.length-1].additionalAnnotation||(m[m.length-1].additionalAnnotation=[]),-1===m[m.length-1].additionalAnnotation.indexOf(f.value)&&m[m.length-1].additionalAnnotation.push(f.value);return!0},header:function(e){return Array.isArray(e)?setHeader(e):"object"==typeof e?(Object.keys(e).forEach((function(t){setHeader([t,e[t]])})),ve):ve},turn:function(e){return 1!==e&&2!==e||(ce=e),ce},move:function playMove(e){var n,a,l,f,p,g,y,b,k,T,O,R,I;if("string"==typeof e){switch(e[f=e.length-1]){case"+":case"#":e=e.substr(0,f)}for(k=x.indexOf(e[0])>6?L[e[0]]:"O"===e[0]?C:4,_e&&(-1===e.indexOf("@")?T=!0:(T=!1,k<<=24)),generateMoves(k,T),f=0;f<v;++f)if(e===(g=moveToSan(m[f],!0))){a=m[f];break}if(!a){if("--"===e)return function makeNullMove(){var e,n={color:ce,san:"--",epSquare:ue},a={color:ce,san:"--"};return ae&&(e=getCurrentHash(),n.hash=e,hashNum(e,t.zobristTurn),ue!==_&&hashEP(oe,e,ue+(1===ce?16:-16),4|ce)),ue=_,de++,1===(ce=swapColor(ce))&&++fe,he.push(n),a}();if(e=re.fixMove(e))try{return playMove(e)}catch(N){}return null}y=a>>7&M,b=a>>P&M,l=a>>A}else{if(e.drop){switch(e.drop){case"p":l=0;break;case"n":l=1;break;case"b":l=2;break;case"r":l=3;break;case"q":l=4;break;default:return null}k=1<<26+l}else{if(e.promotion)switch(e.promotion){case"q":l=4;break;case"n":l=1;break;case"r":l=3;break;case"b":l=2;break;default:return null}y=h[e.from],T=!0,k=oe[y]&S}for(b=h[e.to],n=((l?l<<A:0)|b<<P)>>7|y,generateMoves(k,T),f=0;f<v;++f)if(m[f]>>7===n){a=m[f];break}if(!a)return(e=re.fixMove(e))?playMove(e):null}return I=a&Z.DROP_OR_PROMOTE?z[l]+ce:oe[y],p=beautifyMove(a,g,!0),O=inCheckAfterMove(I,y,b,a),Ce(a,y,b,l),O&&(ie&&isVariantWin()||0===generateMoves()?p.san+="#":p.san+="+"),(R=he[he.length-1]).san=p.san,p.piece&w&&(R.promoted=!0),1===ce&&++fe,p},undo:function(e){var t=he.pop();return t?(1===ce&&--fe,t.move?(reverseMove(t),!!e||beautifyMove(t.move,t.san)):(ue=t.epSquare,--de,ce=swapColor(ce),!!e||{san:"--",color:t.color})):null},clear:function(e){clear(e)},put:function(e,t,n){var a,l=h[t],f=!1,p=oe[l],m=3&p,g=e.color;if(isNaN(l)||!e.type||!g||-1===x.indexOf(e.type))return!1;if(oe[l]=L[e.type]|g|(e.promoted?w:0),oe[l]&C&&(se[g]=l),p&&oe[se[m]]&&oe[se[m]]!==(C|m)){for(a=0;a<120;++a)136&a&&(a+=8),oe[a]===(C|m)&&(se[m]=a,f=!0);f||(se[m]=_)}return n||load2(generateFen(),ie,!1,!1),!0},get:get2,remove:function(e,t){var n,a=oe[h[e]],l=get2(e),f=3&a;if(oe[h[e]]=0,a&C)for(se[f]=_,le[f]=0,n=0;n<120;++n)if(136&n&&(n+=8),oe[n]===(C|f)){se[a.color]=n;break}return t||load2(generateFen(),ie,!0,!1),l},history:function(e,t){for(var n,a=[],l=he,f=l.length;;){if(-1==--f){if(l.id&&!t){f=l.atMoveNode,l=me[l.parentId];continue}break}e?((n=beautifyMove(l[f].move,l[f].san)).color=l[f].color,!f&&l.initComment&&(n.firstComment=l.initComment),void 0!==l[f].comment&&(n.comment=l[f].comment),void 0!==l[f].time&&(n.time=l[f].time),void 0!==l[f].annotation&&(n.annotation=l[f].annotation),void 0!==l[f].additionalAnnotation&&(n.additionalAnnotation=l[f].additionalAnnotation),void 0!==l[f].commands&&(n.commands=l[f].commands),void 0!==l[f].captured&&(n.captured=l[f].captured),void 0!==l[f].promoted&&(n.promoted=l[f].promoted),void 0!==l[f].lines&&(n.lines=l[f].lines),void 0!==l[f].bughouseOrder&&(n.bughouseOrder=l[f].bughouseOrder),x.indexOf(l[f].san[0])>6?n.piece=L[l[f].san[0]]:"O"===l[f].san[0]?n.piece=C:n.piece=4,n.piece|=n.color,a.unshift(n)):a.unshift(l[f].san)}return a},hashes:function(){for(var e=[],t=he,n=t.length;;){if(-1==--n){if(t.id){n=t.atMoveNode,t=me[t.parentId];continue}t.hash||getCurrentHash(),e.unshift(t.hash);break}e.unshift(t[n].hash)}return e},moveCount:function(){return he.length},startingMoveNumber:function(){return pe},completeFen:completeFen,createVariation:createVariation,selectLine:selectLine,hash:function(){var e=getCurrentHash();return ie!==f.Bughouse||re.isDependent?e:[e,re.siblingGame.hash()]},hashing:function(e){ae=e,ie!==f.Bughouse||re.isDependent||re.siblingGame.hashing(ae)},hand:function(){if(_e)return handToString(re._hand[1],!0)+handToString(re._hand[2])},checks:function(){if(ie===f["3-check"])return[ye[1],ye[2]]},threats:function(){var e,t,l,f,p,h,y,b=ce,C=swapColor(b),k=[],w=[],T=[],x=[],O=[],R=ue;if(calculateLegalMoveInfo(0,se[b]),n||a)for(e=0;e<120;++e)136&e&&(e+=8),2&oe[e+8]&&oe[e]?T.push(algebraic(e)):4&oe[e+8]&&k.push(algebraic(e));for(ce=C,ue=_,generateMoves(),e=v;e--;){if(p=(t=m[e])>>P&M,h=t>>7&M,t&Z.DROP_OR_PROMOTE){if(f=z[y=t>>A]|C,t&Z.PROMOTION&&y%3!=1)continue}else f=oe[h],y=0;if(inCheckAfterMove(f,h,p,t)&&(Ce(t,h,p,y),g=e,(ie&&isVariantWin()||generateMoves()===e)&&w.push((t&Z.DROP?N[f].toLowerCase()+"@":algebraic(h))+algebraic(p)),reverseMove(he.pop()),t&Z.CAPTURE)){for(l=0,e=v;e>g;)if((m[--e]>>P&M)===p){l=1,e=g;break}if(!l){x.push(algebraic(h)+algebraic(p));continue}}t&Z.CAPTURE&&1!==y&&(l=124&oe[p])&&(attacked(b,p)?l>(f=oe[h]&S)&&l-f!=8&&O.push(algebraic(h)+algebraic(p)):x.push(algebraic(h)+algebraic(p)))}return g=0,ce=b,ue=R,{pins:k,checkers:T,mates:w,undefended:x,underdefended:O}},tokenizePgn:te,fixMove:function(e){var t,n,a;if("string"==typeof e){if(/0|[?!+#]$|[18][QNRB]$|^P/i.test(e))return e.replace(/[?!+#]+$/,"").replace(/0/g,"O").replace(/([18])([QNRB])$/i,"$1=$2").replace(/^P+/i,"");if(n=e.indexOf("=")>0?-4:-2,"number"==typeof(t=h[e.substr(n,2)])){if(oe[t]&swapColor(ce)||/^[a-h]x?[a-h][36]$/.test(e)){if(-1===e.indexOf("x"))return e.slice(0,n)+"x"+e.substr(n)}else if(e.indexOf("x")>-1)return e.replace(/x/g,"");if(a=e.match(/^([KQNRB]?)([a-h][1-8]?|[1-8])x?([a-h][1-8])=?(.?)$/)){if(oe[h[a[2]]])return{from:a[2],to:a[3],promotion:a[4].toLowerCase()};if(/^\d$/.test(a[2])){for(e=0,generateMoves(L[a[1]],!0),n=0;n<v;++n)if(m[n]>>P===t&&rank(m[n]>>7&M)===8-a[2]){if(e)return;e=m[n]}if(e)return moveToSan(e,!0)}return a[1]+a[3]+a[4]}}}else if(oe[h[e.from]]===(C|ce)&&e.to&&e.from[1]===e.to[1]){if(e.from<e.to)return"O-O";if(e.from>e.to)return"O-O-O"}},_hand:[],_history:function(e){return e&&(ge=(he=e).id),he},_lines:function(){return me},_hashPosition:hashPosition,_board:function(){return oe}},J&&load2(J,ne)||reset(),re}return Chess2.variants=p,Chess2}(),a={addOptions:function(e,t){for(var n in t)void 0!==t[n]&&e.push("setoption name "+n+" value "+t[n]);return e},addVariations:function(e,t){var n,a;t=t||[];for(var l=0;l<t.length;++l)(n=t[l]).pv=Array.isArray(n.pv)&&n.pv.join(" ")||n.pv||"",a="variation "+n.pv,"number"==typeof n.mateIn?a+=" mate "+n.mateIn:"number"==typeof n.mate?a+=" mate "+n.mate:a+=" cp "+n.cp,e.push(a);return e},addPush:function(e,t){var n;return"string"==typeof t&&(t={moveLan:t}),n="push "+t.moveLan,t.isBook&&(n+=" isBook"),e.push(n),e},addPosition:function(e,t){return e.push("position fen "+t),e},addVariant:function(e,t){return"chess960"===String(t).toLowerCase().replace(/ |-/g,"")?(e.push("setoption name UCI_Variant value chess"),e.push("setoption name UCI_Chess960 value "+!0)):(e.push("setoption name UCI_Variant value chess"),e.push("setoption name UCI_Chess960 value "+!1)),e}},l=function(e){var n=["bench","d","eval","flip","isready","ponderhit","stop","uci","ucinewgame"],l=[{cmd:"position",args:["fen","startpos","moves","continuation"]},{cmd:"go",args:["binc","btime","confidence","depth","infinite","mate","mindepth","mintime","maxdepth","maxtime","movestogo","movetime","ponder","searchmoves","shallow","winc","wtime"]}],f=["moves","searchmoves"],p=["ponder","infinite","startpos"],h={depth:1,seldepth:1,time:1,nodes:1,multipv:1,cp:1,mate:1,currmovenumber:1,hashfull:1,nps:1,tbhits:1,sbhits:1,cpuload:1,bmc:1,score:2,lowerbound:2,upperbound:2,bestmove:3,ponder:3,baseTurn:3,bestmoveSan:3,ponderSan:3,pv:4,pvSan:4,string:4,refutation:4,currline:4},m=/(?:Total|Final) Evaluation[\s\S]+\n$/i;function createWebWorker(e,t,n){var a=new Worker(e||"stockfish.js"),l={terminate:function terminate(){a.terminate()},postMessage:function postMessage(e){a.postMessage(e)}};function requeue(e){var t=e.concat();e.length=0,t.forEach((function(e){e.cmd?"go"!==e.cmd.substr(0,2)&&n.send(e.cmd,e.cb,e.stream):(clearTimeout(e.timer),n.getBestMove(e.args,e.cb,e.stream))}))}return a.onmessage=function(e){"string"==typeof e.data&&l.onmessage(e.data)},a.onerror=function(f){if(n.fallbackPath&&n.fallbackPath!==e){try{f.preventDefault()}catch(p){}try{a.terminate()}catch(p){}return(a=createWebWorker(n.fallbackPath,t,n)).onmessage=function(e){l.onmessage(e)},requeue(n._activeCommands()),requeue(n._bestMoveQueue()),!1}if(t.onError)return t.onError(f)},l}function createWorker(t,n){var a;return function getSupportedEngines(t,n){n.fallbackPath=t.pathToNonWasmEngine,n.path=t.enginePath||t.pathToEngineWorker,n.wasmPath=t.pathToWasmEngine,t.engines&&(t.engines.multiThreaded&&e.supportsMultithreading()?(n.path=t.engines.multiThreaded.loader,n.wasmPath=t.engines.multiThreaded.engine):t.engines.singleThreaded&&(n.path=t.engines.singleThreaded.loader,n.wasmPath=t.engines.singleThreaded.engine),n.fallbackPath=t.engines.asm||n.fallbackPath)}(t,n),a=n.path,(n.fallbackPath&&"undefined"==typeof WebAssembly||!a)&&(a=n.fallbackPath),n.wasmPath&&(a+="#"+n.wasmPath),createWebWorker(a,t,n)}function parseSearchLine(e){for(var t,n,a=e.split(" "),l=a.length,f="info"===a[0]?1:0,p={mtype:a[0]};f<l;++f)if(n=a[f])if(1===(t=h[n])){for(;!a[++f]&&f<l;);p[n]=Number(a[f])}else if(2===t)p[n]=!0;else if(3===t){for(;!a[++f]&&f<l;);p[n]=a[f]}else for(p[n]=[],++f;f<l;++f){if(h[a[f]]){--f;break}a[f]&&p[n].push(a[f])}return"(none)"!==p.bestmove&&"0000"!==p.bestmove||(p.bestmove=void 0,p.bestmoveSan=void 0),"(none)"!==p.ponder&&"0000"!==p.ponder||(p.ponder=void 0,p.ponderSan=void 0),p}function getFirstWord(e){var t=e.indexOf(" ");return-1===t?e:e.substr(0,t)}return function loadEngine(h,g){var v,y,_,b={},C=[],S=[],k=null;function bestMoveSearch(){var t,n,a,l,f,p=1,h=[],m=[],g=null,v=S[0].args,_=S[0].cb,C=S[0].stream,k=1,w=[],T=loadEngine._previousCP;function convertpv(e){var t=[],n=m[e]||createSanPv(h[e]);return h[e].forEach((function oneach(e,a){t.push({moveSan:n[a],moveLan:e})})),t}function getpv(e,t,n,a){var l;for(l=h.length-1;l>=0;l-=1)if(h[l][0]===e)return convertpv(l);return n?[{moveSan:t,moveLan:e},{moveSan:a,moveLan:n}]:t?[{moveSan:t,moveLan:e}]:[]}function convertScore(e){0===e.mate?(e.mateIn=0,e.cp=-31800*k):(e.mateIn=Number(e.mate*k)||null,"number"!=typeof e.mateIn||isNaN(e.mateIn)||"number"==typeof e.cp?(e.cp*=k,9===Math.abs(e.cp)&&(e.cp=0),v.normalize&&e.depth<=14&&"number"==typeof T&&1===e.multipv&&function normalize(e){var t=.03*Math.pow(32,e.depth/14);e.cp=T+(e.cp-T)*t}(e)):e.cp=31800*k*(e.mate/Math.abs(e.mate))),e.score=e.cp/100}function addBestMoveProps(f){var h;f.baseTurn=a,f.cp=t,f.score=t/100,f.mate=n,f.mateIn=g,f.depth=p,f.moveLan=f.bestmove,f.moveLan&&(f.move=e.uciToObj(f.moveLan)[0],(h=l.move(f.move))&&(f.moveSan=f.bestmoveSan=h.san,f.ponder&&(h=l.move(e.uciToObj(f.ponder)[0]))&&(f.ponderSan=h.san,l.undo(!0)),l.undo(!0)))}function createSanPv(t){var n,a,f=t.length,p=[];for(n=0;n<f&&(a=l.move(e.uciToObj(t[n])[0]));++n)p.push(a.san);for(;n>0;--n)l.undo(!0);return p}function createTimeout(){v.timeout&&(clearTimeout(y),S[0].timer=y=setTimeout((function(){b.stop(),_&&(_(),_=void 0)}),v.timeout))}S[0].started=!0,loadEngine._previousCP=null,v.difficulty>=0&&v.difficulty<20?(b.setoption("Skill Level",v.difficulty),v.maximumError>=0&&v.maximumError<=4999&&b.setoption("Skill Level Maximum Error",v.maximumError),v.errorProbability>=1&&v.errorProbability<=128&&b.setoption("Skill Level Probability",v.errorProbability)):b.setoption("Skill Level",20),void 0!==v.contempt?b.setoption("Contempt",v.contempt):b.setoption("Contempt","0"),v.multiPv>1?b.setoption("MultiPV",v.multiPv):b.setoption("MultiPV",1),v.movetime||v.wtime&&v.btime||v.depth||(v.btime=v.btime||72e3,v.wtime=v.wtime||72e3),!v.startpos&&v.fen||v.moves||v.variant?(l=e.createGame({fen:v.fen?(f=v.fen,(f+"").replace(/\[([qrbnp]*)\]/i,"/$1").replace(/([0-3])\+([0-3]) (\d+ \d+)/,(function(e,t,n,a){return a+" +"+(3-t)+"+"+(3-n)}))):"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",moves:v.moves,variant:v.variant,disableHashing:!0})).turn()===l.WHITE?a="w":(a="b",k=-1):(a="w",l=e.createGame({disableHashing:!0})),b.setVariant(v.variant),b.position(v),b.go(v,(function returnBestMove(e){var n=parseSearchLine(e);if(addBestMoveProps(n),p>14&&t<5e3&&t>-5e3&&(loadEngine._previousCP=t),n.pv=getpv(n.moveLan,n.moveSan),1===n.pv.length&&n.ponder&&(n.pv=getpv(n.moveLan,n.moveSan,n.ponder,n.ponderSan)),w.length>1)w.splice(w.indexOf(n.moveLan),1),v.searchmoves=w,v.getNextBest=0,queueBestMoveSearch(v,(function done(){_(n)}),(function streamer(e){C&&(e.multipv=2,C(e))}));else if(_)try{_(n)}catch(a){console.error(a)}S.shift(),clearTimeout(y),S.length>0&&bestMoveSearch()}),(function streamInfo(e){var l=parseSearchLine(e);l.score&&(l.baseTurn=a,convertScore(l),!l.multipv&&l.depth&&(l.multipv=1),1!==l.multipv&&0!==l.depth||(t=l.cp,n=l.mate,g=l.mateIn)),l.pv&&C&&(l.pvSan=createSanPv(l.pv)),!l.pv||l.lowerbound||l.upperbound||(h.push(l.pv),C&&m.push(l.pvSan)),l.depth>p?p=l.depth:"bestmove"===l.mtype&&addBestMoveProps(l),!C||0===l.mateIn&&l.pv||C(l),createTimeout()})),v.getNextBest&&_&&l.moves({verbose:!0}).forEach((function toLan(t){t=e.normalizeMoveObj(t),w.push(t.from+t.to+(t.promotion||""))})),createTimeout()}function queueBestMoveSearch(e,t,n){S.push({args:e,cb:t,stream:n}),1===S.length&&bestMoveSearch()}function cbIfReady(){b.ready&&(b.bookLoaded||!b.pathToBook)&&g&&g(b)}return b.send=function(t,n,a){var l;"ucinewgame"!==(t=String(t).trim())&&"flip"!==t&&"stop"!==t&&"ponderhit"!==t&&0!==t.indexOf("position")&&0!==t.indexOf("setoption")?C[C.length]={cmd:t,cb:n,stream:a}:l=!0,v&&(e.log&&console.log("stdin: "+t),v.postMessage(t),l&&n&&setTimeout(n,0))},b._activeCommands=function(){return C},b._bestMoveQueue=function(){return S},b.quit=function(){v&&v.terminate&&(v.terminate(),v=null,b.ready=void 0),clearTimeout(y)},n.forEach((function oneach(e){b[e]=function makeSCmd(t,n){b.send(e,t,n)}})),l.forEach((function oneach(e){b[e.cmd]=function makeCCmd(t,n,a){var l=[e.cmd];_&&t.fen&&(t.fen=function convertStockfishVariantFen(e){return(e+"").replace(/^([^/]+)((?:\/[^/]+){7})\/([qrbnp]*)/i,"$1$2[$3]").replace(/( \d+ \d+) \+([0-3])\+([0-3])/,(function(e,t,n,a){return" "+(3-n)+"+"+(3-a)+t}))}(t.fen)),e.args.forEach((function oneach2(e){if(t[e]||0===t[e]){if(f.indexOf(e)>-1){if(!t[e]||!t[e].length)return;Array.isArray(t[e])&&(t[e]=t[e].join(" "))}l.push(e),-1===p.indexOf(e)&&l.push(t[e])}})),b.send(l.join(" "),n,a)}})),b.setoption=function(e,t){b.send("setoption name "+e+" value "+t)},b.setVariant=function(e){var t;e!==_&&(t=String(e).toLowerCase().replace(/ |-/g,""),e&&"chess"!==t?"chess960"===t?(b.setoption("UCI_Variant","chess"),b.setoption("UCI_Chess960","true")):("threecheck"===t&&(t="3check"),b.setoption("UCI_Variant",t),b.setoption("UCI_Chess960","false")):(t=void 0,b.setoption("UCI_Variant","chess"),b.setoption("UCI_Chess960","false")),_=t)},b.loadBook=function(e,n){b.pathToBook=e,t.loadBook(e,(function onload(e,t){b.book=t,b.bookLoaded=!0,e&&(console.error("Error loading opening book."),console.error(e),b.pathToBook=null,b.bookLoaded=!1),n()}))},b.getBestMove=function(t,n,a){var l;if((t=t||{}).fen=t.fen||t.baseFen,t.is960&&(t.variant="Chess960"),b.bookLoaded&&t.useBook&&(l=function getBookMove(t){var n=e.createGame(t),a=b.book.pick({fen:n.fen(),type:void 0!==t.bookPick?t.bookPick:"random",chess960:"Chess960"===n.header().Variant}),l=a&&n.move(a);if(l)return{moveSan:l.san,moveLan:a,move:{from:l.from,to:l.to,promotion:l.promotion||null},baseTurn:1===n.turn()?"b":"w",pv:[{moveSan:l.san,moveLan:a}],depth:null,score:null,mateIn:null,isBookMove:!0}}(t),l))return setTimeout((function(){l.mtype="bestmove",n(l)}),0);queueBestMoveSearch(t,n,a)},b.stopAll=function(t){var n,a=C.length,l=0;function ondiscard(){0==(l-=1)&&t()}for(S=[],n=0;n<a;n+=1)e.log&&console.log("debug (stop_moves): "+n,getFirstWord(C[n].cmd)),"go"!==getFirstWord(C[n].cmd)||C[n].discard||(b.stop(),C[n].discard=!0,t&&(l+=1,C[n].ondiscard=ondiscard));t&&!l&&b.isready(t)},b.restartEngine=function(e){return b.stopAll(),b.quit(),C=[],S=[],b.bookLoaded&&!h.book&&((h=JSON.parse(JSON.stringify(h))).book=b.book),loadEngine(h,e)},b.stopFast=function(e,t){var n;b.stopAll((function(){clearTimeout(n),e(b)})),n=setTimeout((function(){b.restartEngine(e)}),t||5e3)},"undefined"!=typeof Worker&&(h.ceeMode&&(function addCeeInterface(t,n){var l,f,p=1e3,h=0;function createInterruptHook(e){function interruptHook(e){var t=interruptHook.callbacks;for(var n in interruptHook.callbacks={},interruptHook.original&&interruptHook.original(e),t)t[n](e)}return interruptHook.callbacks={},interruptHook.original=e,interruptHook}function analyze(n,a,m,g){var v,y=Date.now(),_=!1,b=++h;function cleanup(){clearTimeout(v),delete l.callbacks[b],delete f.callbacks[b],_=!0}function handleError(e){_||(cleanup(),g({data:e,action:a,uci:n},n))}function onProcessCrash(t){handleError({msg:"CEE process crashed unexpectedly",code:e.ERROR_CODES.CRASH,exitCode:t,err:new Error("CEE process exited with "+t)})}l.callbacks[b]=onProcessCrash,f.callbacks[b]=onProcessCrash,v=setTimeout((function(){handleError({msg:"CEE timed out",code:e.ERROR_CODES.TIMEOUT,timeout:p,duration:Date.now()-y,err:new Error("CEE timed out")})}),p);for(var C=0;C<n.length;++C)t.send(n[C]);t.send("fetch "+a,(function onFetchDone(e){_||(cleanup(),m(e,n))}),(function onFetchStream(n){n.indexOf("info string CEEError")>=0?handleError({msg:"CEE crashed with error code",code:e.ERROR_CODES.ERROR,err:new Error(n.match(/info string CEEError\s*(.*)/)[1])}):t.ceeDebug&&n.indexOf("not recognized")>=0&&handleError({msg:"CEE received unknown UCI option (engine.ceeDebug mode on)",option:n,code:e.ERROR_CODES.NONFATAL_ERROR,err:new Error(n)})}))}n.onError=l=createInterruptHook(n.onError),n.onSignal=f=createInterruptHook(n.onSignal),t.fetch=function(e,t,n){var l,f;l=(e=e||[]).action||"analysis",Array.isArray(e)?f=e:e.uciCommands?f=e.uciCommands:(e.startFen||e.moves||e.evals)&&(f=[],e.startFen&&(e.options=e.options||{},void 0===e.options.ScoreWhiteToMove&&(e.options.ScoreWhiteToMove=!0),void 0===e.options.SerializeLikeCEAC&&(e.options.SerializeLikeCEAC=!0),a.addOptions(f,e.options),a.addVariant(f,e.variant),a.addPosition(f,e.startFen)),a.addVariations(f,e.evals&&e.evals[0]),(e.moves||[]).forEach((function(t,n){var l=n+1;a.addPush(f,t),a.addVariations(f,e.evals&&e.evals[l])}))),Array.isArray(f)?analyze(f,l,t,n):setTimeout((function(){n({data:"Could not determine UCI commands for fetch call",action:l,uci:f},f)}),0)},t.fetch.setTimeout=function(e){p=e},e.ERROR_CODES={TIMEOUT:1,CRASH:2,ERROR:3,NONFATAL_ERROR:4}}(b,h),b.ceeVersion=function(){return JSON.parse(JSON.stringify(k))}),(v=createWorker(h,b)).onmessage=function onmessage(t){var n,a,l,f,p;if(t.indexOf("\n")>-1)for(f=t.split("\n"),p=0;p<f.length;p+=1)onmessage(f[p]);else if(e.log&&console.log("debug (onmessage): "+t),b.stream&&b.stream(t),C.length&&0!==t.indexOf("No such option")&&0!==t.indexOf("Stockfish")&&0!==t.indexOf("Komodo")&&0!==t.indexOf("Explanation Engine")&&0!==t.indexOf("info string variant")){if(a=function determineQueueNum(e,t){var n,a,l,f,p=getFirstWord(e);for(n="uciok"===p||"option"===p?"uci":"readyok"===p||"ready"===p?"isready":"json"===p||e.indexOf("info string CEEError")>=0?"fetch":"bestmove"===p||"info"===p?"go":"other",f=t.length,l=0;l<f;l+=1)if((a=getFirstWord(t[l].cmd))===n||"other"===n&&("d"===a||"eval"===a))return l;return 0}(t,C),(l=C[a]).stream&&!l.discard&&l.stream(t),void 0===l.message?l.message="":""!==l.message&&(l.message+="\n"),l.message+=t,0===t.indexOf("uciok"))b.name=function parseEngineName(e){var t=e.match(/id name ((\S+) ([\d.a-z]+).*)/i);if(t)return{all:t[1].trim(),short:t[2],version:t[3],full:t[2]+" "+t[3],wasm:/ wasm/i.test(e),multithreaded:/ multithreaded/i.test(e)}}(l.message),n=!0;else if(0===t.indexOf("ready"))n=!0;else if(0!==t.indexOf("bestmove")&&"bestmove"!==getFirstWord(t)||"bench"===l.cmd)if("d"===l.cmd)0!==t.indexOf("Legal uci moves")&&0!==t.indexOf("Key is")||(l.done=!0,n=!0);else if(0===l.cmd.indexOf("fetch"))try{0===l.message.indexOf("json ")&&(l.message=JSON.parse(l.message.replace(/^json /gm,"").replace(/\n/g,""))),n=!0}catch(v){}else"eval"===l.cmd?m.test(l.message)&&(n=!0):(0===t.indexOf("pawn key")||0===t.indexOf("Nodes/second")||0===t.indexOf("Unknown command"))&&(n=!0);else n=!0,l.message=t;n&&(C.splice(a,1),l.cb&&!l.discard?l.cb(l.message):l.ondiscard&&l.ondiscard())}else if(h.ceeMode&&0===t.indexOf("Explanation Engine")){var g=t.match(/Explanation Engine\s*([0-9]+)\.([0-9]+)/);k={date:g[1],increment:g[2]}}},h.book&&(b.book=h.book,b.bookLoaded=!0,b.pathToBook=h.pathToBook),b.getFenFromMoves=e.getFenFromMoves,b.getLegalMoves=e.getLegalMoves,b.getPositionInfo=e.getPositionInfo,b.isFenValid=e.isFenValid,b.ready=!1,function startUp(){b.uci((function onstart(){h.settings&&Object.keys(h.settings).forEach((function oneach(e){b.setoption(e,h.settings[e])})),b.ready=!0,cbIfReady()}))}(),!b.book&&h.pathToBook&&b.loadBook(h.pathToBook,cbIfReady),b)}},f=function(){var e,a=n(),f="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",p=252,h={4:"p",5:"P",6:"p",8:"n",9:"N",10:"n",16:"b",17:"B",18:"b",32:"r",33:"R",34:"r",64:"q",65:"Q",66:"q",128:"k",129:"K",130:"k"},m=512,g="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!?{~}(^)[_]@#$,./&-*++=",v="qnrbkp";function decodeTCN(e){var t,n,a,l,f=e.length,p=[];for(t=0;t<f;t+=2)l={},n=g.indexOf(e[t]),(a=g.indexOf(e[t+1]))>63&&(l.promotion=v[Math.floor((a-64)/3)],a=n+(n<16?-8:8)+(a-1)%3-1),n>75?l.drop=v[n-79]:l.from=g[n%8]+(Math.floor(n/8)+1),l.to=g[a%8]+(Math.floor(a/8)+1),p.push(l);return p}function uciToObj(e){var t,n,a=e.split(" "),l=a.length,f=[];if(e)for(t=0;t<l;++t)4===(n=a[t]).length?"@"===n[1]?f.push({drop:n[0].toLowerCase(),to:n.substr(2,2)}):f.push({from:n.substr(0,2),to:n.substr(2,2)}):f.push({from:n.substr(0,2),to:n.substr(2,2),promotion:n[4]});return f}function isSameMove(e,t){return!(e.san!==t.san&&(e.to!==t.to||e.from!==t.from&&(e.from||t.from)||e.promotion!==t.promotion&&(e.promotion||t.promotion)||e.drop!==t.drop&&(e.drop||t.drop)))}function getPremoves(e,t,a){var l,f,p,h,m,g,v,y,_,b,C=[],S=1,k=8,w=1,T=8,P={verbose:!0};for(_=3-(b=e.turn()),(h=n("/",t)).turn(_),a&&(S=k=+a[1],w=T=a.charCodeAt(0)-96),l=S;l<=k;++l)for(f=w;f<=T;++f)m=String.fromCharCode(f+96)+l,(p=e.get(m))&&p.color===_&&(h.put(p,m,!0),"p"===p.type?(g=String.fromCharCode(f-1+96)+(l+(1===_?1:-1)),v=String.fromCharCode(f+1+96)+(l+(1===_?1:-1)),h.put({type:"n",color:b},g,!0),h.put({type:"n",color:b},v,!0)):"k"===p.type&&"-"!==(y=e.fen().split(" ")[2])&&h.load(h.fen().replace(/^(\S+\s\S\s)(\S+)/,"$1"+y),t,!0,!0),C=C.concat(h.moves(P)),h.remove(m,!0),"p"===p.type&&(h.remove(g,!0),h.remove(v,!0)));return t&&e.hand()&&(h._hand[_]=18721,C=C.concat(h.moves({verbose:!0}).filter((function(e){return!a||e.to===a})))),C.forEach((function(e){normalizeMoveObj(e)})),C}function makePremove(e,t){var n,l,f,p,h,m=e.header().Variant,g=getPremoves(e,m,t.from),v=3-e.turn();for(n=g.length-1;n>=0;--n)if(isSameMove(l=g[n],t)){f=!0;break}return f?(l.drop?e.put({type:l.drop,color:v},l.to):(p=e.remove(l.from,!0),l.flags===a.FLAGS.KSIDE_CASTLE?(h=e.remove("Chess960"===m?l.to:"h"+l.from[1],!0),e.put(p,"g"+l.from[1],!0),e.put(h,"f"+l.from[1])):l.flags===a.FLAGS.QSIDE_CASTLE?(h=e.remove("Chess960"===m?l.to:"a"+l.from[1],!0),e.put(p,"c"+l.from[1],!0),e.put(h,"d"+l.from[1])):(l.promotion&&(p.type=l.promotion,p.promoted=!0),h=e.get(l.to),e.put(p,l.to,"k"!==p.type&&"r"!==p.type&&(!h||h.color!==v||"r"!==h.type)))),l):t.from&&(e.turn(v),t=e.fixMove(t),e.turn(3-v),t)?makePremove(e,{san:t,from:t.from}):void 0}function getPieces(e,t){var n,a,l,f=t?{}:[],v=e._board();if(t)for(n=112;n>=0;++n)136&n&&(n-=24),(a=v[n])&&(f[l=g[7&n]+(8-(n>>4))]={type:h[a&p],color:3&a,promoted:0!=(a&m),square:l});else for(n=112;n>=0;++n)136&n&&(n-=24),(a=v[n])&&f.push({type:h[a&p],color:3&a,promoted:0!=(a&m),rank:8-(n>>4),file:1+(7&n)});return f}function makeMoves(e,t,n,a){var l,f,p,h,m,g,v,y,_,b;for(n=n||{},"string"==typeof t&&(t=t.trim().split(" ")),p=t.length,l=0;l<p;l+=1){if(m="b"===t[l].board||"B"===t[l].board?e.siblingGame:e,g="string"==typeof t[l]?uciToObj(t[l])[0]:t[l].san?t[l].san:t[l],!m.move(g)){if(!n.autoPromote){if(n.skipBadLines)break;return!1}if(!0===n.autoPromote?g.promotion="q":g.promotion=n.autoPromote,!m.move(g)){if(n.skipBadLines)break;return!1}}if(y=(v=m._history())[v.length-1],a&&(_=parseInt(a[l],10)),("number"!=typeof _||isNaN(_))&&(_=parseInt(t[l].time,10)),"number"!=typeof _||isNaN(_)||(y.time=_,_=void 0),t[l].firstComment&&(v.initComment=t[l].firstComment),t[l].comment&&(y.comment=t[l].comment),t[l].annotation&&(y.annotation=t[l].annotation),t[l].additionalAnnotation&&(y.additionalAnnotation=t[l].additionalAnnotation),t[l].commands&&(y.commands=t[l].commands),t[l].lines)for(h=t[l].lines.length,f=0;f<h;++f){if(b=e._history().id,e.createVariation(),!makeMoves(e,t[l].lines[f],n)&&!n.skipBadLines)return!1;e.selectLine(b)}}return!0}function extendChess(e){var t,l,p,h,m=-1,g=0;function swapMoveAttributes(e,t){var n={moveTime:e.moveTime,firstComment:e.firstComment,comment:e.comment,annotation:e.annotation,additionalAnnotation:e.additionalAnnotation,commands:e.commands};Object.keys(n).forEach((function(a){e[a]=t[a],t[a]=n[a]}))}e.extended||(e.extended=!0,t={header:e.header,load:e.load,loadPgn:e.loadPgn,createVariation:e.createVariation,undo:e.undo,pgn:e.pgn},e._move=e.move,e.undo=function(){return e.siblingGame?e.deleteBughouseMove(e.curBughouseMove()):e.deletePosition(m,g)},e.getMove=function(n){return n&&("string"==typeof n||n.to&&(n.from||n.drop))&&e._move(n)&&normalizeMoveObj(t.undo())||null},e.premove={queue:h=[],move:function(t){var a;return!(a=makePremove(p=p||n(e.fen(),e.header().Variant),t))||g||m!==e._history().length-1?(h.length||(p=void 0),null):(h.push(a),a)},consume:function(){var t,a,l,f=h.shift();if(f){if(t=e.move(f)){if(p=void 0,a=h.length)for(p=n(e.fen(),e.header().Variant),l=0;l<a;++l)makePremove(p,h[l]);return t}e.premove.cancel()}},moves:function(t){return!g&&m===e._history().length-1&&getPremoves(p||e,e.header().Variant,t)},getPieces:function(t){return getPieces(p||e,t)},fen:function(){return(p||e).fen()},cancel:function(){h.length=0,p=void 0}},e.getPieces=function(t){return getPieces(e,t)},e.material=function(){var t,n,a,l=e.getPieces(),f={imbalance:0,white:{p:8,n:2,b:2,r:2,q:1,count:0},black:{p:8,n:2,b:2,r:2,q:1,count:0}},p={p:1,n:3,b:3,r:5,q:9,k:0};for(t=l.length-1;t>=0;--t)1===l[t].color?(n=f.white,a=f.black):(n=f.black,a=f.white),a[l[t].type]&&--a[l[t].type],n.count+=p[l[t].type];return f.imbalance=f.white.count-f.black.count,f},e.origHistory=e.history,e.history=function(t,n){var a,l,f,p=[],h=e._history(),m=h.length,g=e._lines();for("boolean"==typeof t&&(t={verbose:t}),t=t||{},n&&(t.noParentLines=n),t.toCurrent&&(m=e.ids().move+1);;){if(-1==--m){if(h.id&&!t.noParentLines){m=h.atMoveNode,h=g[h.parentId];continue}break}if(t.verbose){for(l in a={},h[m])if(h[m][l]&&"object"==typeof h[m][l])for(f in a[l]=h[m][l].constructor===Array?[]:{},h[m][l])a[l][f]=h[m][l][f];else a[l]=h[m][l];p.unshift(a)}else p.unshift(h[m].san)}return p},e._getPos=function(n,a){var l,p,h;return"number"!=typeof n&&(n=m),"number"!=typeof a&&(a=g),l=(p=e._lines())[a],n>=0?l[n]:l.id?l.atMoveNode?p[l.parentId][l.atMoveNode-1]:e._getPos(l.atMoveNode-1,l.parentId):(h={fen:t.header().FEN||f,hash:l.hash,initial:!0,ids:{move:-1,line:0}},e.siblingGame&&(h.bughouseOrder=-1),h)},e.move=function(t,n){var a,l,f,p,h=e._history();if(t&&("string"==typeof t||t.to&&(t.from||t.drop))){if(g===h.id&&m<h.length-1||n){if(e.moveForward(n,t))return!0;m<h.length-1&&(e.selectPosition(m+1),e.createVariation(),h=e._history())}e.siblingGame&&(f=e.isDependent?e.siblingGame.fen():e.fen()),(a=e._move(t))&&(normalizeMoveObj(a),g=h.id,l=h[m=h.length-1],p=e._getPos(m-1),e.siblingGame?(l.fen=e.isDependent?e.siblingGame.fen():e.fen(),l.beforeFen=f,l.siblingIds=e.siblingGame.ids()):(l.fen=e.fen(),l.beforeFen=p.fen),p.initial?(l.moveNumber=0,l.previous=null):(l.moveNumber=p.moveNumber+1,l.previous=p.ids),g&&0===m&&e._lines()[h.parentId][h.atMoveNode].move===l.move&&(l.isContinuation=!0),l.flags=a.flags,l.to=a.to,l.from=a.from,l.drop=a.drop,l.capturedStr=a.captured,l.promotion=a.promotion,l.piece=a.piece,a.promoted&&(l.promoted=!0),a.capturedPromotedPawn&&(l.capturedPromotedPawn=!0),l.ids={move:m,line:g})}return a},e.moveDetails=function(t){return(t=t||e._history()[m])&&(t.lines=t.lines||null,t.flags===a.FLAGS.KSIDE_CASTLE?(t.rookFrom="Chess960"===e.header().Variant?t.to:"h"+t.to[1],t.rookTo="f"+t.to[1],t.kingTo="g"+t.to[1]):t.flags===a.FLAGS.QSIDE_CASTLE?(t.rookFrom="Chess960"===e.header().Variant?t.to:"a"+t.to[1],t.rookTo="d"+t.to[1],t.kingTo="c"+t.to[1]):t.flags===a.FLAGS.EP_CAPTURE&&(t.epCapture=t.to[0]+t.from[1])),t},e.header=e.headers=function(n){var a=t.header(n);return e.siblingGame&&extendChess(e.siblingGame),a},e.load=function(n,a,l,f){var p=t.load(n,a,l,f);return e.siblingGame&&extendChess(e.siblingGame),p&&!l&&(m=-1,g=0),p},e.removeEmptyLines=function(){var t,n,a=e._lines();for(t=a.length-1;t>0;--t)a[t].length||(a[t]=void 0,n=!0);n&&e.reorderLines()},e.loadPgn=function(n,a,l){var f=t.loadPgn(n,a,l),p=e._history();return e.removeEmptyLines(),m=p.length-1,(g=p.id)&&e.selectLine(0),f},e.ids=function(){return{move:m,line:g}},e.selectLine=function(t){e.selectPosition(null,t)},e.curBughouseMove=function(){return Math.max(e._getPos().bughouseOrder,e.siblingGame._getPos().bughouseOrder)},e.deleteBughouseMove=function(t){var n,a,l,f=e.curBughouseMove(),p=!1,h=e;if(t>=0)for(f>=t&&e.selectBughouseMove(t-1);;){for(a=(n=h._history()).length,l=0;l<a;++l)if(n[l].bughouseOrder>=t){n.length=l,p=!0;break}if(h===e.siblingGame)break;h=e.siblingGame}return p},e.selectBughouseMove=function(t){var n,a,l=e.isDependent?e.siblingGame:e,f=l;if(-1===t)return f.selectPosition(-1,0,!0),f.siblingGame.selectPosition(-1,0,!0),l.load(l.header().FEN,"Bughouse",!0,!0);for(;;){for(a=(n=f._history()).length-1;a>=0;--a)if(n[a].bughouseOrder===t)return f.selectPosition(n[a].ids.move,0,!0),f.siblingGame.selectPosition(n[a].siblingIds.move,0,!0),l.load(n[a].fen,"Bughouse",!0,!0);if(f===l.siblingGame)return!1;f=l.siblingGame}},e.moveBackward=function(t){var n;if(e.siblingGame)return e.selectBughouseMove(e.curBughouseMove()-1);if(m<=1)if(0===g){if(-1===m)return!1;e.selectPosition(m-1)}else(n=e._getPos(m-1,g)).isContinuation&&!t&&(n=e._getPos(n.ids.move-1,n.ids.line),n=e._getPos(n.ids.move+1,n.ids.line)),e.selectPosition(n.ids.move,n.ids.line);else e.selectPosition(m-1);return!0},e.moveForward=function(t,n){var a,l,f,p,h,v,y=e._lines();if(e.siblingGame)return e.selectBughouseMove(e.curBughouseMove()+1);if("string"==typeof n&&(n={san:n}),!(a=y[g][m+1])||n&&!isSameMove(n,a)){if(n&&a&&a.lines)for(h=a.lines.length,p=0;p<h;++p)if((f=y[a.lines[p]][0])&&isSameMove(n,f)){a=f,v=!0;break}if(!v&&t&&(l=y[g][m])&&l.lines)for(h=l.lines.length,p=0;p<h;++p)if((f=y[l.lines[p]][0])&&f.isContinuation&&(f=y[l.lines[p]][1])&&(!n||isSameMove(n,f))){a=f,v=!0;break}if(!v){try{if(n&&n.san&&(n=e.fixMove(n.san))||n&&n.to&&n.from&&Math.abs(n.to.charCodeAt(0)-n.from.charCodeAt(0))>1&&(n=e.fixMove(n)))return e.moveForward(t,n)}catch(_){}return!1}}return e.selectPosition(a.ids.move,a.ids.line)},e.moveVariation=function(t,n){var a,l,f,p=e._lines(),h=p[t];if(h&&h.id)for(l=(a=p[h.parentId][h.atMoveNode].lines).length-1;l>=0;--l)if(a[l]===t&&a[f=l-(n?1:-1)])return a[l]=a[f],a[f]=t,e.reorderLines(),!0;return!1},e.promoteVariation=function(t,n){for(var a,l,f,p,h,v,y=e._lines(),_=y[t];_&&_[0]&&_.id&&(-1!==n||_.parentId);){for(a=y[f=_.parentId],p=_.atMoveNode,_[0].lines=a[p].lines.concat(_[0].lines||[]),a[p].lines=void 0,v=a.length-p,l=a.splice(p,v),h=0;h<v;++h)l[h].ids.line=t,l[h].ids.move=h;for(l.id=t,l.parentId=f,l.atMoveNode=p,l.hash=_.hash,0===p?(l.initComment=a.initComment,a.initComment=_.initComment):_.initComment&&(a[p-1].comment=((a[p-1].comment||"")+" "+_.initComment).trim()),y[t]=l,v=_.length,h=0;h<v;++h)_[h].ids.line=f,_[h].ids.move=h+p,a.push(_[h]);for(l[0].isContinuation=!!_[0].isContinuation,a[p].isContinuation=!p&&"number"==typeof a.parentId&&y[a.parentId][a.atMoveNode].move===a[0].move,v=a[p].lines.length,h=0;h<v;++h)y[a[p].lines[h]].atMoveNode=p,y[a[p].lines[h]][0]&&(y[a[p].lines[h]][0].isContinuation=y[a[p].lines[h]][0].move===a[p].move);if(g===t?(g=f,m+=p):g===f&&m>=p&&(g=t,m-=p),1===n)break;_=y[t=f]}return void 0!==a&&(e._history(y[g]),e.reorderLines(),!m&&y[g][0].isContinuation&&e.selectPosition(y[g].atMoveNode,y[g].parentId),!0)},e.reorderLines=function(t,n){var a,f,p,h,m,v,y,_,b,C,S=e._lines(),k=!1;for(t?b=n.length-1:(t=0,n=[S[0]],b=0,l=!1),p=(a=S[t]).length,f=0;f<p;++f)if((h=a[f]).ids.line!==b&&(k=!0,h.ids.line=b),h.lines)for(m=h.lines.length,v=0;v<m;++v)(_=S[y=h.lines[v]])?(_.atMoveNode=f,C=n.length,h.lines[v]=C,_.parentId=b,l||y!==g||(l=!0,g=C),n.push(_),k=e.reorderLines(y,n)||k):(1===h.lines.length?delete h.lines:h.lines.splice(v,1),--v,--m);return t||e.saveLines(n,!0),k},e.createVariation=function(){var n,a,l,f=e._history(),p=e._lines();return m===f.length-1?(n=t.createVariation(),f=e._history(),m=f.length-1,g=f.id,n):-1!==m&&(a=[],l=f[m],a.parentId=f.id,a.id=p.length,l.lines||(l.lines=[]),l.lines.push(a.id),a.hash=e._getPos(m-1).hash,a.atMoveNode=m,p.push(a),e.selectPosition(-1,a.id))},e.selectLineEnd=function(t){return e.siblingGame?e.selectBughouseMove(e._history().length+e.siblingGame._history().length-1):("number"!=typeof t&&(t=g),(t!==g||m<e._history().length-1)&&e.selectPosition(null,t,!0))},e.selectLineStart=function(){var t,n;return e.siblingGame?e.selectBughouseMove(-1):g?(m>1||1===m&&!e._getPos(0).isContinuation?t=e._history():(n=e._getPos(-1),t=e._lines()[n.ids.line]),e.selectPosition(t.id?t[1]&&t[0].isContinuation?1:0:-1,t.id)):-1!==m&&e.selectPosition(-1,0)},e.selectPosition=function(n,a,l){var f=e._lines(),p=e._history();if("number"==typeof a&&(a!==g||l)){if(a<0||a>=f.length)return!1;if(p=f[a],"number"!=typeof n)n=p.length-1;else if(n<-1||n>=p.length)return!1;g=a,e._history(p),l=!0}if("number"==typeof n&&(n!==m||l)){if(n<-1||n>=p.length)return!1;t.load(e._getPos(n).fen,t.header().Variant,!0,!0),m=n}return!0},e.resetToMainLine=function(){var t=e._lines();e.selectLineEnd(0),t.length>1&&(t.length=1,e.reorderLines())},e.updateNode=function(t,n,a){var l,f,p=e._lines();for(f in n="number"==typeof n?n:m,l=p[a="number"==typeof a?a:g][n]||p[a],t)l[f]=t[f]},e.updateLineComment=function(t,n){e.updateNode({initComment:t},-1,n)},e.saveLines=function(t,n){var a,l,f,p=e._lines(),h=t.length;for(t!==p&&(p.length=0),l=0;l<h;++l){if(a=t[l],l&&"number"!=typeof a.parentId)return!1;t!==p&&p.push(a),a.id=l}return e._history(e._history()),n||(f=e.ids(),e.selectPosition(-1,0,!0),e.selectPosition(f.move,f.line)),!0},e.deletePosition=function(t,n){var a,l,f=e._lines();return!(!f[n]||!(f[n][t]||-1===t&&0!==n))&&(n&&(0===t||1===t&&f[n][0].isContinuation)&&(t=-1),g>0&&n!==g?(a=function descendsFromMove(e,t,n){for(var a,l=e[t];"number"==typeof(a=l.parentId);){if(a===n)return l.atMoveNode;l=e[a]}return!1}(f,g,n),l=!1!==a&&a>=t):l=n===g&&t<=m,l&&(t>1?e.selectPosition(t-1,n):(e.selectPosition((f[n][0].isContinuation||1===t)&&f[n][1]?1:0,n),e.moveBackward())),t>0?f[n].length=t:n?f[n]=null:f[0].length=0,e.reorderLines(),e.ids())},e.mark=function(t,n){var a=m<0?e._lines()[g]:e._lines()[g][m],l=t.type,f=1;t.color&&("arrow"===l?e.mark({key:t.color+t.key,type:"cal"},n):"square"===l&&e.mark({key:t.color+t.key,type:"csl"},n)),"cal"!==l&&"csl"!==l&&(l="c_"+l,f=0),a.commands&&a.commands[l]&&(a.commands[l]=a.commands[l].split(",").filter((function rm(e){return e.slice(f).split(";")[0]!==t.key.slice(f)})).join(","),a.commands[l]||delete a.commands[l]),n||(a.commands||(a.commands={}),a.commands[l]=(a.commands[l]?a.commands[l]+",":"")+t.key+(t.data?";"+t.data.join(";"):""))},e.markings=function(){var t,n,a,l,f,p,h,v,y={},_=m<0?e._lines()[g]:e._lines()[g][m],b={cal:"arrow",csl:"square"};for(n in _.commands){if(a=_.commands[n],b[n])n=b[n],l=0;else{if("c_"!==n.substr(0,2))continue;n=n.slice(2),l=1}for(y[n]=y[n]||{},p=(f=a.split(",")).length,t=0;t<p;++t)l?(v=(h=f[t].split(";")).shift(),y[n][v]=y[n][v]||{type:n,key:v},y[n][v].data=h):(v=f[t].slice(1),y[n][v]=y[n][v]||{type:n,key:v},y[n][v].color=f[t][0])}return y},e.clearMarkings=function(){var t,n=m<0?e._lines()[g]:e._lines()[g][m];for(t in n.commands)/^c[sa]l$|^c_/.test(t)&&delete n.commands[t]},e.pgn=function(n){var a,l=e.ids();return e.selectLineEnd(0),a=t.pgn(n),e.selectPosition(l.move,l.line),a},e.loadMoves=function(t,n){var a,l,f,p,h;if(n=n||{},"string"==typeof t&&(t=decodeTCN(t)),t){for(n.atCurrent||e.selectPosition(-1,0),f=g,l=t.length,a=0;a<l;++a){if(!((p=e.move(t[a],!0))||(t[a].promotion=!0===n.autoPromote?"q":n.autoPromote,p=e.move(t[a],!0))))return!1;g!==f&&"merge"!==n.method&&(e.promoteVariation(g,1),"promote"!==n.method&&(e._history()[m].lines=void 0,e.reorderLines()),f=g)}if("promote"===n.method){if(l){for(e._history()[m+1]&&(p=e._history()[m],e.createVariation(),e.move(p),swapMoveAttributes(e._history()[0],p),e.promoteVariation(g,1)),a=(h=e._lines()).length-1;a>=0;--a)1===h[a].length&&h[a][0].isContinuation&&(swapMoveAttributes(h[a][0],h[h[a].parentId][h[a].atMoveNode]),h[a].length=0);e.removeEmptyLines()}}else"merge"!==n.method&&e.deletePosition(m+1,g)}return!0})}function createGame2(e){var t,a;if((e=e||{}).game)return e.game;if(t=n(),e.analysis&&extendChess(t),e.disableHashing&&t.hashing(!1),e.pgn){if(!(t.loadPgn(e.pgn,e.index,e.options)||"detect"===e.variant&&n.variants.some((function(n){return e.options=e.options||{},e.options.variant=n,t.loadPgn(e.pgn,e.index,e.options)}))))return!1}else{if(e.headers&&(e.variant=e.headers.Variant||e.variant,e.fen||(e.fen=e.headers.FEN)),"detect"===e.variant&&e.fen&&(e.fen.indexOf("|")>-1?e.variant="Bughouse":9===e.fen.split("/").length?e.variant="Crazyhouse":e.fen.indexOf("+")>-1?e.variant="3-check":e.variant=void 0),(e.fen||e.variant)&&!t.load(e.fen||f,e.variant))return!1;e.headers&&"object"==typeof e.headers&&!Array.isArray(e.headers)&&t.header(e.headers)}if(e.tcn)if("object"==typeof e.tcn){if(!function playBughouseTCN(e,t,n){var a,l,f,p=[decodeTCN(t[0]),decodeTCN(t[1])],h=[0,0],m=[0,0],g=p[0].length+p[1].length,v=Math.max(0|n[0][0],0|n[0][1],0|n[1][0],0|n[1][1]),y=[0,0],_=[0,0];for(a=[[v+=600-v%600,v],[v,v]];g--;){if(_[0]=y[0]+a[0][m[0]]-n[0][h[0]]||0,_[1]=y[1]+a[1][m[1]]-n[1][h[1]]||0,p[l=_[0]<=_[1]?0:1][h[l]]||(l^=1),(!(f=l?e.siblingGame:e).move(p[l][h[l]])||g&&f.inCheckmate()&&f.undo(!0))&&!(f=(l^=1)?e.siblingGame:e).move(p[l][h[l]]))return!1;f._history()[h[l]].time=n[l][h[l]],a[l][m[l]]=n[l][h[l]],y[l]=_[l],m[l]^=1,++h[l]}return!0}(t,e.tcn,e.timestamps||[[],[]]))return!1}else a=decodeTCN(e.tcn);else a=e.moves;return!(a&&!makeMoves(t,a,e,e.timestamps))&&t}function normalizeMoveObj(e){return e&&(e.piece&m&&(e.promoted=!0),e.piece=h[e.piece&p],e.captured&&(e.captured&m&&(e.capturedPromotedPawn=!0),e.captured=h[255&e.captured]),e.promotion&&(e.promotion=h[e.promotion&p]),void 0!==e.drop&&(e.drop="pnbrq"[e.drop])),e}function normalizeHistory(e){var t,n,a,l,f,p,h,m=e.history(!0,!0);if(e.siblingGame){for(t=e.siblingGame.history(!0,!0),a=m.length+t.length,n=[],l=0;l<a;++l)!m.length||t.length&&t[0].bughouseOrder<m[0].bughouseOrder?(f=t.shift()).board="b":(f=m.shift()).board="a",n.push(f);m=n}for(a=m.length,l=0;l<a;++l)if((p=m[l]).fen||normalizeMoveObj(p),p.lines)for(h=p.lines.length-1;h>=0;--h)e.selectLine(p.lines[h]),p.lines[h]=normalizeHistory(e).moves;return{moves:m}}function getLegalMoves(e,t){var n,l,f,p;if("string"==typeof e){if((l=a).reset(),!l.load(e,t))return null}else l=createGame2(e);for(p=(n=l.moves({verbose:!0})).length,f=0;f<p;++f)normalizeMoveObj(n[f]);return n}function jce(t,n){return(e=e||l(jce))(t,n)}return jce.supportsMultithreading=function(){var e,t=Boolean(jce._hasThreads);if("boolean"!=typeof jce._hasThreads){try{(e=new Worker("data:application/javascript,")).postMessage(new SharedArrayBuffer(1)),t=!0}catch(n){}try{e.terminate()}catch(n){}jce._hasThreads=t}return t},jce.gameFingerprints=function gameFingerprints(e){var n,a,l,p,h,m,g,v,y,_=createGame2(e),b=[""],C=[];if(!_)return!1;for(y=(v=_.header()).Variant||"",m=_.hashes(),n="function"==typeof _.origHistory?_.origHistory(!0):_.history(!0),h=m.length,a=[m[0][0],m[0][1]],C.push(t.to64BitHex(a)+y),m[0]=t.to64BitHex(m[0]),l=1;l<h;++l)a[0]=(a[0]^m[l][0]*(l+58465))>>>0,a[1]=(a[1]^m[l][1]*(l+984))>>>0,m[l]=t.to64BitHex(m[l]),C.push(t.to64BitHex(a)+y),normalizeMoveObj(n[p=l-1]),g=(n[p].from?n[p].from:n[p].drop.toUpperCase()+"@")+n[p].to+(n[p].promotion||""),p&&(g=b[p]+" "+g),b.push(g);return{startingFen:v.FEN||f,hashes:m,fingerprints:C,moves:b,variant:v.Variant}},jce.getFenFromMoves=function getFenFromMoves(e,t,n){return a.reset(),a.load(e,n),!(t&&!makeMoves(a,t))&&a.fen()},jce.getLegalMoves=getLegalMoves,jce.getPositionInfo=function getPositionInfo(e,t,n){var l,f,p={gameOver:!1,check:!1,checkmate:!1,draw:!1,stalemate:!1,threefold:!1,insufficient:!1};if(Array.isArray(t)||(n=t,t=null),"boolean"==typeof n?(l=n,n={}):l=(n=n||{}).variant,"string"==typeof e){if((f=a).reset(),0!==f.validateFen(e,l)||!f.load(e,l))return!1}else f=createGame2(e);return!(t&&!makeMoves(f,t))&&(n.getLegalMoves&&(p.legalMoves=getLegalMoves({game:f})),f.inCheck()?(p.check=!0,p.checkmate=f.inCheckmate()):p.stalemate=f.inStalemate(),p.threefold=f.inThreefoldRepetition(),p.insufficient=f.insufficientMaterial(n.color),p.fiftyMoveRule=f.in50MoveRule(),p.draw=p.stalemate||p.threefold||p.insufficient||p.fiftyMoveRule||f.inDraw(),n.skipValidation||(p.isValid=f.isPositionValid(n)),l&&(p.variantWin=f.isVariantWin(),void 0===p.variantWin&&(p.variantWin=f.isBughouseWin())),p.gameOver=p.checkmate||p.draw||Boolean(p.variantWin),p)},jce.isFenValid=function isFenValid(e,t){return 0===a.validateFen(e,t)},jce.encodeTCN=function encodeTCN(e){var t,n,a,l,f="";for(Array.isArray(e)||(e=[e]),n=e.length,t=0;t<n;t+=1)a=e[t].drop?79+v.indexOf(e[t].drop):g.indexOf(e[t].from[0])+8*(e[t].from[1]-1),l=g.indexOf(e[t].to[0])+8*(e[t].to[1]-1),e[t].promotion&&(l=3*v.indexOf(e[t].promotion)+64+(l<a?9+l-a:l-a-7)),f+=g[a]+g[l];return f},jce.decodeTCN=decodeTCN,jce.uciToObj=uciToObj,jce.generatePgn=function generatePgn(e){var t;return(e=e||{}).disableHashing=!0,!!(t=createGame2(e))&&t.pgn(e)},jce.pgnToFen=function pgnToFen(e,t){var n,l,f=[];if(a.reset(),!a.loadPgn(e))return!1;if(n=a.moveCount(),"number"==typeof t){for(t<0&&(t=n+t+1),l=n-1;l>=t&&l>=0;l-=1)a.undo();return a.fen()}for(l=0;l<=n;l+=1)f.unshift(a.fen()),a.undo();return f},jce.pgnToJson=function pgnToJson(e,t,n){var l,f=[],p=a;return"number"!=typeof t&&(n=t,t=void 0),l=p.tokenizePgn(e,n),t<0&&(t=l.length+t),!!l&&(n&&n.includeFen&&(p=createGame2({analysis:!0})),l.forEach((function(e,a){var l,h;a===t||void 0===t?p.loadPgn([e],0,n)?(h=normalizeHistory(p),l=p.header(),f.push({headers:l,moves:h.moves})):f.push(!1):f.push(void 0)})),"number"==typeof t?f[t]:f)},jce.sanToObj=function sanToObj(e,t,n){return a.reset(),!!a.load(t,n)&&normalizeMoveObj(a.move(e))},jce.completeFen=a.completeFen,jce.shortenFen=function shortenFen(e,t){return a.completeFen(e).split(" ").slice(0,t||4).join(" ")},jce.createGame=createGame2,jce.getPositionDetails=function getPositionDetails(e,t){var n,a,l,f;if((e=e||{}).disableHashing=!0,!(n=createGame2(e)))return null;if(t){if(!(l=n.move(t)))return null;n.extended||normalizeMoveObj(l)}return f=n.fen(),e.skipValidation||n.isPositionValid(e)?(a=f.split(" "),{fen:f,pieces:getPieces(n),sideToMove:n.turn(),castling:a[2],epSquare:"-"===a[3]?null:a[3],halfMoves:+a[4],moveNumber:+a[5],move:l,hand:n.hand(),checks:n.checks()}):null},jce.predict=function predict(e,t){var n=Math.min(Math.max(.20773843*Math.atan(2.49085889*e/100-2.47841945*t/100)+.02262979*e/100-.02256839*t/100+.52239679,0),1),a=Math.min(Math.max(-.20720905*Math.atan(2.49626837*e/100-2.48220286*t/100)+-.02352551*e/100+.02172627*t/100+.49443923,0),1),l=Math.min(Math.max(Math.exp(.037043456*e/100+.178106427*t/100-8.069742932)+.004823544*Math.exp(-1.364136591*Math.pow(e/100-t/100,2))+-.001625539,0),1),f=n+a+l;return{w:n/f,b:a/f,d:l/f}},jce.normalizeMoveObj=normalizeMoveObj,jce.FLAGS=a.FLAGS,jce.loadECO=function loadECO(e,n){t.loadBook(e,(function onload(e,a){if(!a||!a.json)return n(e||new Error("Invalid book"));n(e,(function queryECO(e){var n,l,f,p,h,m,g,v,y;if(e.hash)l="string"==typeof e.hash?[t.hex64ToDec(e.hash)]:[e.hash],p=1;else{if(!(n=createGame2(e)))return!1;p=(l=n.hashes()).length}for(f=0;f<p;++f)if(h=a.json[t.to64BitHex(l[f])]){if(h.constructor===Array)if(m&&-1===h[0].m.indexOf(m.m)){for(v=h.length-1;v>=0;--v)if(!v||-1!==h[v].m.indexOf(m.m)){(y=h[v]).e=h[0].e,y.s=h[0].s,y.mate=h[0].mate,y.v=h[0].v,y.h=h[0].h,y.n=y.n||h[0].n,y.u=y.u||h[0].u,y.c=y.c||h[0].c;break}}else y=h[0];else y=h;(y.n||e.allowNameless)&&(m=y)}else e.mustEndInBook&&(m=void 0);if(m)return g={name:m.n},m.m&&(g.moves=m.m),void 0!==m.d&&(g.sdiff=m.d/100),m.c&&(g.code=m.c,g.url=m.u||m.n.replace(/[\u00e1-\u00e5]/g,"a").replace(/[\u0107\u010d]/g,"c").replace(/[\u00e9\u00e8\u0117\u0113]/g,"e").replace(/[\u00f3\u00f6\u00f8]/g,"o").replace(/[\u016f\u00fc]/g,"u").replace(/['+,]/g,"").replace(/[^a-z0-9.]+/gi,"-").replace(/(with-\d|St)\.+-?/,"$1-")),m.e?(g.eval=m.e,g.depth=m.h,g.score=m.e[0].cp/100,void 0!==m.e[0].mate&&(g.mate=m.e[0].mate)):(g.score=m.s/100,void 0!==m.mate&&(g.mate=m.mate)),m.v&&(g.bad=!0),g}),a.json)}))},jce}(),e.exports=f}(g);var v,y,_,b,C,S,k,w,T,P,A,M,x,O,R,I,L,N,D,B=g.exports;function is(e){return function isType2(t){return e===t.type}}function createAccessibilityPlugin(e=v.DefaultRightClickModifierKey){return{beforeState:[{condition:is(_.UserEvents.PointerdownLeft),handler:function convertToPointerdownRightIfModifierKeyPressed(t,n){const{api:a,queue:l,run:f}=n;if(a.keys.isPressed(e))return l.add(f,__spreadProps(__spreadValues({},t),{type:_.UserEvents.PointerdownRight})),!1;return!0}}],name:v.Plugin.Name,requires:["keys"]}}function isOneOf(e){const t=new Set(Array.isArray(e)?e:Object.values(e));return function isType2(e){return t.has(e.type)}}function createAnalysisOverlayPlugin(){let e;return{destroy:function destroy(){null==e||e.removeAnalysisOverlay()},match:[{condition:isOneOf([_.APIEvents.Load,_.OptionsEvents.Update,_.InstanceEvents.ModeChanged,_.InstanceEvents.RendererSet]),handler:function updateAnalysisOverlay(t,n){const{options:a,renderer:l}=n;!e&&l&&(e=l);a.overlayInAnalysisMode?null==e||e.addAnalysisOverlay():null==e||e.removeAnalysisOverlay()}}],name:A.Plugin.Name}}(y=v||(v={})).DefaultRightClickModifierKey="a",(y.Plugin||(y.Plugin={})).Name="accessibility",b=_||(_={}),(C=b.LogCodes||(b.LogCodes={})).Event="Event",C.State="State",(S=b.State||(b.State={})).DraggingPiece="draggingPiece",S.HideHoverSquare="hideHoverSquare",S.MachineState="machineState",S.PromotionMove="promotionMove",S.SoundPlayed="soundPlayed",S.SelectedPiece="selectedPiece",(k=b.APIEvents||(b.APIEvents={})).AddMove="AddMove",k.BlinkHighlight="BlinkHighlight",k.ClearMarkings="ClearMarkings",k.CreateContinuation="CreateContinuation",k.CreateGame="CreateGame",k.DeletePosition="DeletePosition",k.DrawAgreed="DrawAgreed",k.DrawClaimed="DrawClaimed",k.GameResigned="GameResigned",k.IllegalMove="IllegalMove",k.LineCommentUpdated="LineCommentUpdated",k.LineUpdated="LineUpdated",k.Load="Load",k.Mark="Mark",k.Move="Move",k.MoveBackward="MoveBackward",k.MoveForward="MoveForward",k.MoveVariation="MoveVariation",k.NodeUpdated="NodeUpdated",k.OutOfTime="OutOfTime",k.PromoteVariation="PromoteVariation",k.Reload="Reload",k.ResetGame="ResetGame",k.ResetToMainLine="ResetToMainLine",k.SelectLineEnd="SelectLineEnd",k.SelectNode="SelectNode",k.SelectLineStart="SelectLineStart",k.SetBoardPosition="SetBoardPosition",k.SetPlayingAs="SetPlayingAs",k.TurnSet="TurnSet",k.Undo="Undo",k.Unmark="Unmark",k.UpdatePGNHeaders="UpdatePGNHeaders",(w=b.BoardEvents||(b.BoardEvents={})).PromotionAreaClosePointerdown="PromotionAreaClosePointerdown",w.PromotionPiecePointerdown="PromotionPiecePointerdown",(T=b.InstanceEvents||(b.InstanceEvents={})).Create="Create",T.Destroy="Destroy",T.ModeChanged="ModeChanged",T.RendererSet="RendererSet",(b.OptionsEvents||(b.OptionsEvents={})).Update="UpdateOptions",(b.SoundEvents||(b.SoundEvents={})).Play="PlaySound",(b.UIEvents||(b.UIEvents={})).Resize="Resize",(P=b.UserEvents||(b.UserEvents={})).MousedownLeft="MousedownLeft",P.MousedownRight="MousedownRight",P.PointerdownLeft="PointerdownLeft",P.PointerdownRight="PointerdownRight",P.Pointermove="Pointermove",P.Pointerup="Pointerup",P.Wheel="Wheel",((M=A||(A={})).Plugin||(M.Plugin={})).Name="analysis-overlay",((O=x||(x={})).Plugin||(O.Plugin={})).Name="cheatDetection",I=R||(R={}),(L=I.Units||(I.Units={})).Milliseconds="Milliseconds",L.Deciseconds="Deciseconds",L.Seconds="Seconds",((D=N||(N={})).Plugin||(D.Plugin={})).Name="highlights";const F="highlight";var j,$,H,V,U;(($=j||(j={})).Plugin||($.Plugin={})).Name="arrowKeys",(H=$.Arrow||($.Arrow={})).Left="arrowleft",H.Up="arrowup",H.Right="arrowright",H.Down="arrowdown",((U=V||(V={})).Plugin||(U.Plugin={})).Name="arrows";const G="arrow";var q,W,z,K,Z,Q,X,Y,J,ee,te,ne,re,oe,ie,ae,se,ce,le,ue,de;((W=q||(q={})).Plugin||(W.Plugin={})).Name="assets",((K=z||(z={})).Plugin||(K.Plugin={})).Name="blinking-highlight",((Q=Z||(Z={})).Plugin||(Q.Plugin={})).Name="blinking-highlight",((Y=X||(X={})).Plugin||(Y.Plugin={})).Name="board-size",(ee=J||(J={})).DefaultKeyToOpenWindow="e",(ee.Plugin||(ee.Plugin={})).Name="boardImages",((ne=te||(te={})).Plugin||(ne.Plugin={})).Name="bughouse-api",((oe=re||(re={})).Plugin||(oe.Plugin={})).Name="bughouse-sibling-board",((ae=ie||(ie={})).Plugin||(ae.Plugin={})).Name="clocks",(se=ae.TimeControlTypes||(ae.TimeControlTypes={})).Blitz="blitz",se.Bullet="bullet",se.Rapid="rapid",((le=ce||(ce={})).Plugin||(le.Plugin={})).Name="coordinates",((de=ue||(ue={})).Plugin||(de.Plugin={})).Name="custom-items",(de.Classes||(de.Classes={})).Root="custom-item";const fe="customItem";var pe,he,me,ge,ve,ye,_e,be,Ce,Se,ke,we,Te;he=pe||(pe={}),(me=he.Targets||(he.Targets={})).Arrows="arrows",me.Effects="effects",me.Pieces="pieces",(ge=he.Positions||(he.Positions={})).Above="above",ge.Below="below",(ye=ve||(ve={})).Image="Image",ye.Star="Star",ye.TextBox="TextBox",((be=_e||(_e={})).Plugin||(be.Plugin={})).Name="debug",(Se=Ce||(Ce={})).Name="eco",(Se.Events||(Se.Events={})).Update="UpdateECO",((ke=Se.Config||(Se.Config={})).Codes||(ke.Codes={})).StartingPosition="A00",ke.InitialFen="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",((Te=we||(we={})).Plugin||(Te.Plugin={})).Name="effects";const Pe="effect";var Ee,Ae,Me,xe,Oe,Re,Ie,Le,Ne,De,Be,Fe,je,$e,He,Ve,Ue,Ge,qe,We,ze,Ke,Ze,Qe,Xe,Ye,Je,et,tt,nt,rt,ot,it,at,st,ct;(Ae=Ee||(Ee={})).Alternative="Alternative",Ae.BestMove="BestMove",Ae.Blunder="Blunder",Ae.Book="Book",Ae.Brilliant="Brilliant",Ae.CheckmateBlack="CheckmateBlack",Ae.CheckmateWhite="CheckmateWhite",Ae.Correct="Correct",Ae.Critical="Critical",Ae.DrawBlack="DrawBlack",Ae.DrawWhite="DrawWhite",Ae.Excellent="Excellent",Ae.FastWin="FastWin",Ae.Forced="Forced",Ae.FreePiece="FreePiece",Ae.Gamechanger="Gamechanger",Ae.Good="Good",Ae.GreatFind="GreatFind",Ae.Inaccuracy="Inaccuracy",Ae.Incorrect="Incorrect",Ae.Mate="Mate",Ae.MissedWin="MissedWin",Ae.Mistake="Mistake",Ae.ResignBlack="ResignBlack",Ae.ResignWhite="ResignWhite",Ae.Sharp="Sharp",Ae.Takeback="Takeback",Ae.Threat="Threat",Ae.TimeoutBlack="TimeoutBlack",Ae.TimeoutWhite="TimeoutWhite",Ae.Undo="Undo",Ae.Winner="Winner",Ae.WinnerWhite="WinnerWhite",Ae.Interesting="Interesting",Ae.Warning="Warning",Ae.Equal="Equal",((xe=Me||(Me={})).Plugin||(xe.Plugin={})).Name="fade-setup",((Re=Oe||(Oe={})).Plugin||(Re.Plugin={})).Name="handPieces",(Re.Events||(Re.Events={})).SetHand="SetHand",((Le=Ie||(Ie={})).Plugin||(Le.Plugin={})).Name="hml",((De=Ne||(Ne={})).Plugin||(De.Plugin={})).Name="hover-square",((Fe=Be||(Be={})).Plugin||(Fe.Plugin={})).Name="move-hints",(($e=je||(je={})).Plugin||($e.Plugin={})).Name="pieces",((Ve=He||(He={})).Plugin||(Ve.Plugin={})).Name="pregame",((Ge=Ue||(Ue={})).Events||(Ge.Events={})).Premove="Premove",(Ge.Plugin||(Ge.Plugin={})).Name="premoves",((We=qe||(qe={})).Plugin||(We.Plugin={})).Name="reporting",((Ke=ze||(ze={})).Plugin||(Ke.Plugin={})).Name="sounds",(Ze=Ke.BoardSounds||(Ke.BoardSounds={})).GameStart="game-start",Ze.GameEnd="game-end",Ze.Capture="capture",Ze.Castle="castle",Ze.Premove="premove",Ze.MoveSelf="move-self",Ze.MoveCheck="move-check",Ze.MoveOpponent="move-opponent",Ze.Promote="promote",Ze.Notify="notify",Ze.TenSeconds="tenseconds",Ze.Illegal="illegal",Ke.maxTagsPerSound=5,((Xe=Qe||(Qe={})).Events||(Xe.Events={})).Updated="ThreatsUpdated",(Xe.Plugin||(Xe.Plugin={})).Name="threats",((Je=Ye||(Ye={})).Plugin||(Je.Plugin={})).Name="timeControl",function(e){e.Blitz="blitz",e.Bullet="bullet",e.Rapid="rapid"}(Je.Types||(Je.Types={})),(et=Je.Header||(Je.Header={})).Null="-",et.Separator="+",et.TimePerMove="/",et.Unset="?",nt=tt||(tt={}),(rt=nt.Actions||(nt.Actions={})).Reset="Reset",rt.Start="Start",rt.Stop="Stop",rt.Tick="Tick",(ot=nt.Events||(nt.Events={})).End="End",ot.Reset="Reset",ot.Start="Start",ot.Stop="Stop",ot.Tick="Tick",ot.TimeAdded="TimeAdded",(it=nt.States||(nt.States={})).Ended="Ended",it.Going="Going",it.Initial="Initial",it.Stopped="Stopped",function(e){let t;(e.Plugin||(e.Plugin={})).Name="validate",(t=e.ErrorCodes||(e.ErrorCodes={})).InvalidPosition="InvalidPosition",e.ErrorMessages={[t.InvalidPosition]:"Board position does not match the FEN from JCE"}}(at||(at={})),function(e){e.Ready="Ready",e.ResultNodeSelected="ResultNodeSelected",e.Updated="Updated"}((ct=st||(st={})).Events||(ct.Events={})),(ct.Plugin||(ct.Plugin={})).Name="vml";var lt,ut,dt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",get CheatDetection(){return x},get CustomTimestamps(){return R},get Highlights(){return N},get AnalysisOverlay(){return A},get ArrowKeys(){return j},get Arrows(){return V},get Assets(){return q},get BlinkingHighlight(){return z},get BlinkingSquare(){return Z},get BoardSize(){return X},get BoardImages(){return J},get BughouseAPI(){return te},get BughouseSiblingBoard(){return re},get Clocks(){return ie},get Coordinates(){return ce},get CustomItems(){return ue},get Debug(){return _e},get ECO(){return Ce},get Effects(){return we},get FadeSetup(){return Me},get HandPieces(){return Oe},get HML(){return Ie},get HoverSquare(){return Ne},get MoveHints(){return Be},get Pieces(){return je},get Pregame(){return He},get Premoves(){return Ue},get Reporting(){return qe},get Sounds(){return ze},get Threats(){return Qe},get TimeControl(){return Ye},get Timer(){return tt},get Validate(){return at},get VML(){return st}});function createArrowKeysPlugin(e){let t;return{api:()=>({setKeys:setKeys,resetKeys:resetKeys}),create:function create2(n){t=n,setKeys(e)},destroy:function destroy(){t.api.keys.removeCallbacks([{key:j.Arrow.Up},{key:j.Arrow.Down},{key:j.Arrow.Left},{key:j.Arrow.Right}])},name:j.Plugin.Name};function setKeys(e){const n=getCallbacks(e);t.api.keys.setCallbacks(n)}function resetKeys(){const e=getCallbacks();t.api.keys.setCallbacks(e)}function getCallbacks(e={}){return[{key:j.Arrow.Up,callback:t=>{var n;return null!=(n=e[j.Arrow.Up])?n:t.selectLineStart}},{key:j.Arrow.Down,callback:t=>{var n;return null!=(n=e[j.Arrow.Down])?n:t.selectLineEnd}},{key:j.Arrow.Left,callback:t=>{var n;return null!=(n=e[j.Arrow.Left])?n:t.moveBackward}},{key:j.Arrow.Right,callback:t=>{var n;return null!=(n=e[j.Arrow.Right])?n:t.moveForward}}]}}function createKeyedArrow({options:e,rawArrow:t}){var n,a;const{data:{color:l,keyPressed:f,from:p,opacity:h,to:m},key:g,type:v}=t;return{data:{color:null!=(a=null!=(n=getArrowColor(f,e))?n:l)?a:e.arrowColors.default,from:p,opacity:null!=h?h:e.analysisHighlightOpacity,to:m},key:g,type:v}}function getArrowColor(e,t){const{arrowColors:n}=t;switch(e){case lt.Alt:return n.alt;case lt.Ctrl:return n.ctrl;case lt.Shift:return n.shift;case lt.None:return n.default;default:return}}function isMark(e){return function isMarkingOfType(t){var n,a;return is(_.APIEvents.Mark)(t)&&(null==(a=(n=t.data).find)?void 0:a.call(n,(t=>t.type===e)))}}function isType(e){return function markingIsType(t){return t.type===e}}function isUnmark(e){return function isMarkingOfType(t){var n,a;return is(_.APIEvents.Unmark)(t)&&(null==(a=(n=t.data).find)?void 0:a.call(n,(t=>t.type===e)))}}function createArrowsPlugin(){return{match:[{condition:isMark(G),handler:function markArrow(e,t){const{options:n,renderer:a}=t,{data:l}=e,f=l.filter(isType(G)).map((e=>createKeyedArrow({rawArrow:e,options:n})));null==a||a.addArrows(f,t)}},{condition:isUnmark(G),handler:function unmarkArrow(e,t){const{options:n,renderer:a}=t,{data:l}=e,f=l.filter(isType(G)).map((e=>createKeyedArrow({rawArrow:e,options:n})));null==a||a.removeArrows(f,t)}},{condition:is(_.InstanceEvents.RendererSet),handler:function init2(e,t){const{api:n,options:a,renderer:l}=t,f=n.markings,p=(a.allowMarkings?f.getAllWhere({types:[G]}):[]).map((e=>createKeyedArrow({rawArrow:e,options:a})));null==l||l.addArrows(p,t)}}],name:V.Plugin.Name}}function createAssetsPlugin(){let e,t;return{match:[{condition:isOneOf([_.InstanceEvents.RendererSet,_.OptionsEvents.Update]),handler:function updateAssets(n,a){const{options:l,renderer:f}=a;if(!f)return;l.boardStyle!==e&&(e=l.boardStyle,f.updateBoardImage(a));l.pieceStyle!==t&&(t=l.pieceStyle,f.updatePieceBaseImage(a))}}],name:q.Plugin.Name}}function createBlinkingHighlightPlugin(){return{match:[{condition:is(_.APIEvents.BlinkHighlight),handler:function blinkHighlight(e,t){const{renderer:n}=t;null==n||n.blinkHighlights(e.data,t)}}],name:z.Plugin.Name}}(ut=lt||(lt={})).Alt="alt",ut.Ctrl="ctrl",ut.None="none",ut.Shift="shift";var ft,pt,ht,mt,gt,vt,yt,_t,bt,Ct,St,kt,wt,Tt,Pt,Et,At,Mt,xt,Ot,Rt;function createBoardDisabledPlugin(){return{create:function create2(e){e.el.classList.toggle(Tt.Disabled,!e.options.enabled)},match:[{condition:is(_.OptionsEvents.Update),handler:function handleEnabledOption(e,t){const{data:n}=e,{el:a,renderer:l}=t;"enabled"in n&&(a.classList.toggle(Tt.Disabled,!n.enabled),null==l||l.setBoardEnabled(n.enabled))}}],name:ft.Plugin.Name}}function createBoardSizePlugin(){return{match:[{condition:isOneOf([_.UIEvents.Resize,_.InstanceEvents.RendererSet]),handler:function resize(e,t){const{renderer:n}=t;null==n||n.resize(t)}}],name:X.Plugin.Name}}function createEventEmitter(){const e=[];return{emit:function emit(t,n){let a;for(a of e)a.type!==t&&"all"!==a.type||a.handler(n)},listeners:e,off:off,offAll:function offAll(e){return off({handler:e,type:"all"})},offMany:function offMany(e=[]){e.forEach((e=>off(e)))},on:on,onAll:function onAll(e){on("all",e)},onMany:function onMany(e=[],t){e.forEach((e=>on(e,t)))},once:function once(t,n){const a={handler:(...e)=>{off(a),n(...e)},type:t};e.push(a)}};function off(t){const n=e.findIndex((e=>t.type===e.type&&t.handler===e.handler));-1!==n&&e.splice(n,1)}function on(t,n){const a={handler:n,type:t};e.push(a)}}function createStateMachine({data:e,initialState:t,states:n},a=createEventEmitter()){let l=t;return Object.assign(Object.assign({},a),{getCurrentState:function getCurrentState(){return l},getData:function getData(){return Object.assign({},e)},transition:function transition(t,f){if(!n[l][t])return a.emit(Ot.Event.Types.NoTransition,{action:t,data:e,state:l}),!1;const p=n[l][t](f),h="string"==typeof p?p:p.nextState,buildEvent=n=>({action:t,currentState:l,data:e,event:n,nextState:h,params:f});l!==h&&a.emit(Ot.Event.Types.OnExit,buildEvent(Ot.Event.Types.OnExit));p.data&&Object.assign(e,p.data);l!==h&&a.emit(Ot.Event.Types.OnEnter,buildEvent(Ot.Event.Types.OnEnter));l===h?a.emit(Ot.Event.Types.OnReEnter,buildEvent(Ot.Event.Types.OnReEnter)):l=h;return!0}})}((pt=ft||(ft={})).Plugin||(pt.Plugin={})).Name="board-disabled",mt=ht||(ht={}),function(e){e.Arcade="arcade",e.Default="default",e.Fast="fast",e.Natural="natural",e.None="none",e.Slow="slow"}((gt=mt.Animation||(mt.Animation={})).Types||(gt.Types={})),(vt=gt.Speeds||(gt.Speeds={}))[vt.Default=180]="Default",vt[vt.Fast=100]="Fast",vt[vt.Slow=500]="Slow",(yt=mt.HighlightColors||(mt.HighlightColors={})).Selected="#ffff00",yt.Blue="#52b0dc",yt.Green="#acce59",yt.Orange="#ffaa00",yt.Red="#eb6150",(_t=mt.HighlightTypes||(mt.HighlightTypes={})).Analysis="analysis",_t.Move="move",_t.Selected="selected",(bt=mt.HighlightedArrowColors||(mt.HighlightedArrowColors={})).Blue="rgba(72, 193, 249, 0.8)",bt.Green="rgba(159, 207, 63, 0.8)",bt.Orange="rgba(255, 170, 0, 0.8)",bt.Red="rgba(248, 85, 63, 0.8)",(Ct=mt.CoordinatesPositions||(mt.CoordinatesPositions={})).Inside="inside",Ct.Off="off",Ct.Outside="outside",(St=mt.MoveMethods||(mt.MoveMethods={})).Click="click",St.Drag="drag",St.DragOnly="drag-only",(kt=mt.MoveListDisplayTypes||(mt.MoveListDisplayTypes={})).Figurine="figurine",kt.Text="text",(mt.BooleanOptions||(mt.BooleanOptions={})).HoverSquareOutline="hoverSquareOutline",(wt=mt.SaveableOptions||(mt.SaveableOptions={})).AnimationType="animationType",wt.BoardStyle="boardStyle",wt.Coordinates="coordinates",wt.DarkMode="darkMode",wt.EvaluationBarType="evaluationBarType",wt.HighlightLegalMoves="highlightLegalMoves",wt.HighlightMoves="highlightMoves",wt.MoveListDisplayType="moveListDisplayType",wt.PieceStyle="pieceStyle",wt.SoundTheme="soundTheme",wt.PlaySounds="playSounds",(Pt=Tt||(Tt={})).Pseudo3d="pseudo3d",Pt.Disabled="board-disabled",Pt.Flipped="flipped",(At=Et||(Et={})).All="All",At.Move="Move",function(e){e.Default="default",e.WebGL2D="webgl-2d",e.WebGL3D="webgl-3d"}((xt=Mt||(Mt={})).Types||(xt.Types={})),xt.TriggerOptions=[ht.SaveableOptions.AnimationType,ht.SaveableOptions.PieceStyle],function(e){!function(e){e.NoTransition="NoTransition",e.OnEnter="Enter",e.OnExit="Exit",e.OnReEnter="ReEnter"}(e.Types||(e.Types={}))}((Rt=Ot||(Ot={})).Event||(Rt.Event={}));const It=createStateMachine({data:{chosenPiece:"",didChangePieces:!1,mouseCoords:[],moveHoldTimes:[],tentativeMouseCoords:{x:0,y:0}},initialState:"idle",states:{changedPiece:{load:load,move:()=>({data:{chosenPiece:void 0,didChangePieces:!0,mouseCoords:[...It.getData().mouseCoords,It.getData().tentativeMouseCoords],moveHoldTimes:[...It.getData().moveHoldTimes,Date.now()-It.getData().moveHoldTimeStart]},nextState:"idle"})},chosenPiece:{choosePiece:({tentativeMouseCoords:e,moveHoldTimeStart:t})=>({data:{moveHoldTimeStart:t,tentativeMouseCoords:e},nextState:"changedPiece"}),load:load,move:()=>({data:{chosenPiece:void 0,mouseCoords:[...It.getData().mouseCoords,It.getData().tentativeMouseCoords],moveHoldTimes:[...It.getData().moveHoldTimes,Date.now()-It.getData().moveHoldTimeStart]},nextState:"idle"})},idle:{choosePiece:({chosenPiece:e,moveHoldTimeStart:t,tentativeMouseCoords:n})=>({data:{chosenPiece:e,didChangePieces:!1,moveHoldTimeStart:t,tentativeMouseCoords:n},nextState:"chosenPiece"}),load:load}}});function load(){return{data:{chosenPiece:"",didChangePieces:!1,mouseCoords:[],moveHoldTimes:[],tentativeMouseCoords:{x:0,y:0}},nextState:"idle"}}var Lt,Nt;function didUseCheatMouse(e){const t={},n=e.mouseCoords.length/2;return e.mouseCoords.some((e=>{const a=`${e.x}-${e.y}`;return void 0===t[a]?t[a]=0:t[a]+=1,t[a]>=n}),{})}function createCheatDetectionPlugin(){return{api:()=>function createCheatDetectionAPI({machine:e}){return{get:function get2(){const t=e.getData();return{didChangePieces:t.didChangePieces,didUseCheatMouse:didUseCheatMouse(t),moveHoldTimes:t.moveHoldTimes}}}}({machine:It}),match:[{condition:isOneOf([_.UserEvents.PointerdownLeft,_.UserEvents.Pointerup]),handler:function choosePiece(e,t){const{mode:n,state:a}=t;if(a.get(_.State.MachineState)===Lt.States.PromotionAreaShowing||!e.data||!n.isAllowedToMove())return;const l=a.get(_.State.SelectedPiece)||a.get(_.State.DraggingPiece);l&&l!==It.getData().chosenPiece&&It.transition("choosePiece",{chosenPiece:l,moveHoldTimeStart:Date.now(),tentativeMouseCoords:e.data.coordsInsideSquare})}},{condition:is(_.APIEvents.Load),handler:function handleAPILoad(){It.transition("load")}},{condition:is(_.APIEvents.Move),handler:function handleAPIMove(){It.transition("move")}}],name:x.Plugin.Name}}function createCoordinatesPlugin(){let e,t=!1;return{match:[{condition:isOneOf([_.InstanceEvents.RendererSet,_.OptionsEvents.Update]),handler:function updateCoordinates(n,a){const{options:l,renderer:f}=a;if(!f)return;l.coordinates===e&&l.flipped===t&&n.type!==_.InstanceEvents.RendererSet||f.setCoordinates({flipped:l.flipped,position:l.coordinates},a);e=l.coordinates,t=l.flipped}}],name:ce.Plugin.Name}}function createCustomItemsAPI(e){return function createAPI2(){return function createCustomItems(e){return{getDefaultStarColor:function getDefaultStarColor(){return e}}}(e)}}!function(e){!function(e){e.AddingMarkings="AddingMarkings",e.Idle="Idle",e.PieceDragging="PieceDragging",e.PieceSelected="PieceSelected",e.PromotionAreaShowing="PomotionAreaShowing"}(e.States||(e.States={}))}(Lt||(Lt={})),(Nt||(Nt={})).Name="core";var Dt,Bt,Ft,jt,$t,Ht;function easeLinear(e){return e}function createAnimation(e){const{data:t,keyframes:n,repeat:a,target:l,onEnd:f}=e,p=function getAnimatedProps(e){if(!e)return{};if(!e[0])throw new Error("The animation keyframes must contain values at `0` percentage.");return __spreadValues({},e[0])}(n),h=function getAnimatedPropsKeyframes(e,t){if(!t)return{};const n=Object.keys(e),a={};return n.forEach((e=>a[e]=[])),Object.keys(t).sort(((e,t)=>parseInt(e,10)-parseInt(t,10))).forEach((e=>{n.forEach((n=>{void 0!==t[e][n]&&a[n].push(parseInt(e,10))}))})),a}(p,n),m={animatedProps:p,animatedPropsKeyframes:h,data:__spreadValues({},t),endCallbacks:[],ended:!1,endTime:0,forcedEnd:!1,frameInfo:{deltaTime:0,elapsedInterval:0,elapsedPercentage:0},isTargetHTMLElement:l instanceof HTMLElement,onEnd:e=>m.endCallbacks.push(e),params:e,repeatCount:a||1,started:!1,startTime:0,keptAlive:!1};return f&&m.endCallbacks.push(f),m}function createAnimator(e=!1){const t=[];let n=0,a=0;return{end:end,endAll:function endAll(){[...t].forEach(end)},play:function play(l){const f=createAnimation(l);t.push(f),n||e||function startAnimationLoop(){a=performance.now(),n=requestAnimationFrame(animationLoop)}();return f},playingAnimationsCount:()=>t.length,update:function update2(e){animationLoop(e)}};function animationLoop(l){const f=.001*(l-a);t.forEach((e=>{if(e.startTime>l)return;const t=e.frameInfo;t.deltaTime=f,(e.started||function onAnimationStart(e,t){const{duration:n,delay:a,onStart:l}=e.params;e.startTime||(e.startTime=t+(a||0),n&&n!==1/0&&(e.endTime=e.startTime+n));if(e.startTime>t)return!1;return e.started=!0,null==l||l(e),!0}(e,l))&&(e.endTime&&(t.elapsedInterval=(l-e.startTime)/(e.endTime-e.startTime),t.elapsedInterval>1&&(t.elapsedInterval=1),t.elapsedPercentage=Math.round(100*t.elapsedInterval)),onAnimationUpdate(e),e.endTime&&e.endTime<=l&&onAnimationEnd(e))})),a=l,t.length&&!e&&(n=requestAnimationFrame(animationLoop))}function end(e){e.ended||t.indexOf(e)<0||(e.frameInfo.elapsedInterval=1,e.frameInfo.elapsedPercentage=100,onAnimationUpdate(e),onAnimationEnd(e,!0))}function onAnimationEnd(a,l=!1){const{duration:f,keepAlive:p,repeatDelay:h}=a.params;if(a.repeatCount--,a.forcedEnd=l,!l&&a.repeatCount>0&&f&&f!==1/0)return a.startTime=a.endTime+(h||0),void(a.endTime=a.startTime+f);l||!p?(a.ended=!0,a.endCallbacks.forEach((e=>e(a))),function removeAnimation(a){const l=t.indexOf(a);l>=0&&t.splice(l,1);t.length||e||function stopAnimationLoop(){n&&cancelAnimationFrame(n);n=0}()}(a)):a.keptAlive=!0}function onAnimationUpdate(e){const{onUpdate:t}=e.params;!function updateAnimatedProperties(e){const{animatedProps:t,animatedPropsKeyframes:n,frameInfo:a,isTargetHTMLElement:l,params:f}=e,{keyframes:p,target:h}=f,{elapsedPercentage:m}=a,g=f.easing||easeLinear;if(!p)return;let v,y,_,b,C;Object.keys(t).forEach((e=>{for(let t=1;t<n[e].length;t++)if(_=n[e][t-1],b=n[e][t],m>=_&&m<=b){v=p[_][e],y=p[b][e];break}C=(m-_)/(b-_),C=g(C),t[e]=v+(y-v)*C,h&&!l&&(h[e]=t[e])}))}(e),null==t||t(e)}}function createCollection(e={}){const t=e;return{deleteItem:function deleteItem(e){delete t[e]},get:function get2(e){if(void 0===t[e])throw new Error(`Requested object at key ${e} is undefined.`);return t[e]},getCollection:function getCollection(){return t},isDefined:function isDefined(e){return void 0!==t[e]},keys:function keys(){return Object.keys(t)},set:function set2(e,n){t[e]=n}}}function getFileRankFromSan$1(e){return{file:e.toLowerCase().charCodeAt(0)-96,rank:Number(e.charAt(1))}}function setPositionBySquare({square:e,el:t}){const n=getFileRankFromSan$1(e);n&&(t.className=function removeClassNamesStartingWith(e,t){return e.split(" ").filter((e=>!e.startsWith(t))).join(" ").trim()}(t.className,"square-"),t.classList.add(`square-${n.file}${n.rank}`),t.style.transform="")}function setTestData(e,t){return!!e&&(Object.entries(t).forEach((([t,n])=>{const a=`${t.charAt(0).toUpperCase()}${t.slice(1)}`;void 0===n?delete e.dataset[`test${a}`]:e.dataset[`test${a}`]=n})),!0)}(Bt=Dt||(Dt={})).Arrows="arrows",Bt.BlinkingHighlights="blinking-highlights",Bt.CaptureHints="capture-hints",Bt.Coordinates="coordinates",Bt.Effects="effects",Bt.FadeSetup="fade-setup",Bt.HoverSquare="hover-square",Bt.MoveHints="move-hints",Bt.Pieces="pieces",Bt.PromotionWindow="promotion-window",Bt.Squares="squares",(jt=Ft||(Ft={})).Anchor="anchor",jt.Blinking="blinking",jt.Color="color",jt.Dragging="dragging",jt.Editable="editable",jt.Element="element",jt.EnPassant="enPassant",jt.File="file",jt.Figurine="figurine",jt.Flipped="flipped",jt.Inside="inside",jt.Interval="interval",jt.LeadingFigurine="leadingFigurine",jt.Opacity="opacity",jt.Outside="outside",jt.Position="position",jt.Rank="rank",jt.Selected="selected",jt.ShortString="shortstring",jt.Square="square",jt.Star="star",jt.TextColor="textColor",jt.TextValue="textValue",jt.Times="times",jt.TrailingFigurine="trailingFigurine",jt.Type="type",jt.WholeMoveNumber="wholeMoveNumber",jt.X="x",jt.Y="y",(Ht=$t||($t={})).Arrow="arrow",Ht.BlinkingHighlight="blinking-highlight",Ht.Board="board",Ht.CommentLink="comment-link",Ht.Coordinates="coordinates",Ht.CustomItem="custom-item",Ht.Effect="effect",Ht.FadeInOverlay="fade-in-overlay",Ht.GameResult="game-result",Ht.HalfMove="half-move",Ht.Highlight="highlight",Ht.Hint="hint",Ht.HoverSquare="hover-square",Ht.Move="move",Ht.Piece="piece",Ht.PotentialCapture="capture-hint",Ht.PromotionCloseButton="promotion-close-button",Ht.PromotionPiece="promotion-piece",Ht.PromotionWindow="promotion-window",Ht.Square="square",Ht.SiblingBoard="sibling-board";var Vt,Ut,Gt,qt,Wt=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",Image:'\n<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <image x="7.5" y="7.5" width="25" height="25" />\n</svg>\n',Star:'\n  <svg xmlns="http://www.w3.org/2000/svg" style="fill: #ffa704" viewBox="0 0 40 40">\n    <path\n      d="M23.12,17.84H16.4a1.11,1.11,0,0,1-1.06-1.43L18.7,5.21a1.11,1.11,0,0,1,2.13,0l3.36,11.2A1.11,1.11,0,0,1,23.12,17.84Z" />\n    <path\n      d="M27.21,34.11,4.35,16.88a1.11,1.11,0,0,1,.67-2l17.89,0a1.11,1.11,0,0,1,1.06.8l5,17.19A1.11,1.11,0,0,1,27.21,34.11Z" />\n    <path\n      d="M35.17,16.88,12.31,34.11a1.11,1.11,0,0,1-1.74-1.2l5-17.19a1.11,1.11,0,0,1,1.06-.8l17.89,0A1.11,1.11,0,0,1,35.17,16.88Z" />\n  </svg>\n',TextBox:'\n<svg viewBox="0 0 40 40" fill="none" xmlns="http://www.w3.org/2000/svg">\n  <rect x="5" y="12.5" width="30" height="15" rx="3" fill="inherit" />\n  <text fill="#676767" font-size="0.8rem" x="20.5" y="20.5" dominant-baseline="middle" text-anchor="middle"></text>\n</svg>\n'});function createCustomItemsMethods({board:e,el:t,options:n}){const a=createCollection(),l=createCollection(),f=createAnimator(),p=createCollection(),h=document.createComment("/Custom Items");return e.addToDom({el:h,insertAfter:!0,type:Dt.Pieces}),{addCustomItems:function addCustomItems(m){m.forEach((m=>{const{data:{color:g,image:v,opacity:y,text:_,type:b,visualOrder:C,frame:S,removalClass:k,square:w}}=m;l.isDefined(w)&&function flushAnimatingCustomItem(e,t="captured"){const n=a.get(e);n&&n.classList.contains(t)&&(removeCustomItemElement(n,e),clearTimeout(l.get(e)),l.deleteItem(e))}(w,k),p.isDefined(w)&&f.end(p.get(w));const T=document.createElement("div");if(T.classList.add(ue.Classes.Root),S){T.classList.add("custom-item__frame"),S.imageAnimated&&T.classList.add("custom-item__frame--animated");const e=function createCustomItemFrame(e){if(!e)return;const t=document.createElement("div"),{imageURL:n,imageAnimated:a,positionRatioX:l,positionRatioY:f,widthRatio:p,heightRatio:h}=e,m=l/p/(1/p-1)*100,g=f/h/(1/h-1)*100,v=a?"auto 100%":`${1/p*100}% ${1/h*100}%`;return t.style.backgroundImage=`url(${n})`,t.style.backgroundSize=v,t.style.backgroundPositionX=`${m}%`,t.style.backgroundPositionY=`${g}%`,t}(S);e&&T.appendChild(e)}else T.innerHTML=Wt[b],function assignSVGAttributes(){const e=T.querySelector("svg");if(!e)return;g&&(e.style.fill=g);y&&(e.style.opacity=String(y));if(v){const t=e.querySelector("image");if(!t)return;if(t.setAttribute("href",v.url),v.percentOfSquare){const{width:n}=e.viewBox.baseVal,a=n*v.percentOfSquare*.01,l=(n-a)/2;Object.assign(t.style,{height:a,width:a,x:l,y:l})}}if(_){const t=e.querySelector("text");if(!t)return;t.innerHTML=_.value,_.color&&(t.style.fill=_.color)}}();setPositionBySquare({el:T,square:w}),n.test&&setTestData(T,{[Ft.Color]:g,[Ft.Element]:$t.CustomItem,[Ft.Opacity]:y,[Ft.Square]:w,[Ft.Type]:b});const P=function getDOMTarget(e){if(!e)return null;const t=e.position===pe.Positions.Below;return e.target===pe.Targets.Arrows?{insertBefore:t,type:Dt.Arrows}:e.target===pe.Targets.Effects?{insertBefore:t,type:Dt.Effects}:e.target===pe.Targets.Pieces?{insertBefore:!t,type:t?Dt.Effects:Dt.Pieces}:null}(C);P?e.addToDom(__spreadValues({el:T},P)):t.insertBefore(T,h),a.set(w,T)}))},removeCustomItems:function removeCustomItems(e){e.forEach((e=>{const{data:t}=e,{frame:n,removalClass:h="captured",removalTimeout:m=250,square:g}=t,v=a.get(g);v&&((null==n?void 0:n.imageAnimated)?function animateCustomItemImage({customItemElement:e,imageURL:t,square:n,onAnimationEnd:a}){const l=e.querySelector("div");if(!l)return void a();const h=new Image;h.src=t,h.onload=()=>{const t=e.clientHeight,m=Math.ceil(h.naturalWidth/h.naturalHeight),g=1/m,v=f.play({duration:m/24*1e3,data:{currentFrame:1},onUpdate:()=>{const{data:e,frameInfo:n}=v;g*e.currentFrame<n.elapsedInterval&&(l.style.backgroundPositionX=`-${t*e.currentFrame}px`,e.currentFrame++)},onEnd:a});p.set(n,v)}}({customItemElement:v,imageURL:n.imageURL,square:g,onAnimationEnd:()=>{p.isDefined(g)&&p.deleteItem(g),removeCustomItemElement(v,g)}}):(v.classList.add(h),l.set(g,window.setTimeout((()=>{l.isDefined(g)&&l.deleteItem(g),v&&removeCustomItemElement(v,g)}),m))))}))}};function removeCustomItemElement(e,n){t.removeChild(e),a.deleteItem(n)}}function createCustomItemsEventHandlers(){return[{condition:isMark(fe),handler:function markCustomItem(e,t){const{api:n,renderer:a}=t,l=n["custom-items"],f=e.data.filter(isType(fe)).map((e=>e.data.color?e:function withDataProp(e,t,n){const a=__spreadValues({},e);return a.data[t]=n,a}(e,"color",l.getDefaultStarColor())));null==a||a.addCustomItems(f,t)}},{condition:isUnmark(fe),handler:function unmarkCustomItem(e,t){const{api:n,queue:a,renderer:l}=t,f=e.data.filter(isType(fe));f.forEach((e=>{const t=e.data.removalSound;t&&a.add(n.playSound,t)})),null==l||l.removeCustomItems(f,t)}},{condition:is(_.InstanceEvents.RendererSet),handler:function init2(e,t){const{api:n,options:a,renderer:l}=t,f=n.markings;null==l||l.extendRenderer(createCustomItemsMethods);const p=a.allowMarkings?f.getAllWhere({types:[fe]}):[];null==l||l.addCustomItems(p,t)}}]}function createCustomItemsPlugin({defaultStarColor:e=Vt.DefaultSquareColor}={}){return{api:createCustomItemsAPI(e),match:createCustomItemsEventHandlers(),name:ue.Plugin.Name}}function createDebugPlugin(){let e,t;return{create:function create2(e){const{api:{logger:t}}=e;t.on(Ut.Events.EntryAdded,logToConsole)},name:_e.Plugin.Name};function logToConsole(n){void 0===n.code||n.code===_.LogCodes.State&&JSON.stringify(n.data)===e||n.code===_.LogCodes.Event&&n.data.type===_.UserEvents.Pointermove&&t===_.UserEvents.Pointermove||n.code===_.LogCodes.Event&&n.data.type===_.UIEvents.Resize&&t===_.UIEvents.Resize||(n.code===_.LogCodes.State&&(e=JSON.stringify(n.data)),n.code===_.LogCodes.Event&&(t=n.data.type),console.group(n.code),n.level===Ut.Levels.Error?console.error(n.data):console.log(n.data),console.groupEnd())}}(Vt||(Vt={})).DefaultSquareColor="#ffa704",function(e){e.EntryAdded="EntryAdded"}((Gt=Ut||(Ut={})).Events||(Gt.Events={})),(qt=Gt.Levels||(Gt.Levels={})).Debug="Debug",qt.Error="Error",qt.None="None";var zt;!function(e){var t;(t=e.ClassNames||(e.ClassNames={})).Background="icon-background",t.Component="icon-component",t.ComponentShadow="icon-component-shadow",t.Shadow="icon-shadow"}(zt||(zt={}));const Kt=`<g id="alternative">\n    <g>\n      <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <path class="${zt.ClassNames.Background}" fill="#96af8b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    </g>\n    <g>\n      <g class="${zt.ClassNames.ComponentShadow}" opacity="0.2">\n        <path d="M14.57,4.71l-4.42.2a.2.2,0,0,0-.11,0A.16.16,0,0,0,10,5a.21.21,0,0,0,0,.11.31.31,0,0,0,0,.1l1.4,1.4L8.92,9.13,6.5,6.71,8,5.24a.19.19,0,0,0,0-.1A.14.14,0,0,0,8,5,.15.15,0,0,0,8,4.94a.21.21,0,0,0-.11,0L3.42,4.71l-.08,0-.06,0a.18.18,0,0,0,0,.07.19.19,0,0,0,0,.08l.19,4.42a.15.15,0,0,0,0,.11.18.18,0,0,0,.08.07.25.25,0,0,0,.12,0,.18.18,0,0,0,.09-.06L5.21,8l2.55,2.56v4.49a.29.29,0,0,0,0,.09l0,.07.08,0,.09,0H9.85l.09,0a.18.18,0,0,0,.07,0l.05-.07a.29.29,0,0,0,0-.09V10.57l2.63-2.63,1.55,1.54a.16.16,0,0,0,.09,0,.17.17,0,0,0,.12,0,.18.18,0,0,0,.08-.07.13.13,0,0,0,0-.1l.19-4.43a.19.19,0,0,0,0-.08.18.18,0,0,0,0-.07l-.07,0Z"></path>\n      </g>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M14.57,4.21l-4.42.2a.2.2,0,0,0-.11,0,.16.16,0,0,0-.07.09.21.21,0,0,0,0,.11.31.31,0,0,0,0,.1l1.4,1.4L8.92,8.63,6.5,6.21,8,4.74a.19.19,0,0,0,0-.1.14.14,0,0,0,0-.11A.15.15,0,0,0,8,4.44a.21.21,0,0,0-.11,0L3.42,4.21l-.08,0-.06,0a.18.18,0,0,0,0,.07.19.19,0,0,0,0,.08l.19,4.42a.15.15,0,0,0,0,.11A.18.18,0,0,0,3.53,9a.25.25,0,0,0,.12,0A.18.18,0,0,0,3.74,9L5.21,7.51l2.55,2.56v4.49a.29.29,0,0,0,0,.09l0,.07.08,0,.09,0H9.85l.09,0a.18.18,0,0,0,.07,0l.05-.07a.29.29,0,0,0,0-.09V10.07l2.63-2.63L14.26,9a.16.16,0,0,0,.09,0,.17.17,0,0,0,.12,0A.18.18,0,0,0,14.55,9a.13.13,0,0,0,0-.1l.19-4.43a.19.19,0,0,0,0-.08.18.18,0,0,0,0-.07l-.07,0Z"></path>\n    </g>\n  </g>`,Zt=`<g id="best">\n    <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${zt.ClassNames.Background}" fill="#96bc4b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <path class="${zt.ClassNames.ComponentShadow}" opacity="0.2" d="M9,3.43a.5.5,0,0,0-.27.08.46.46,0,0,0-.17.22L7.24,7.17l-3.68.19a.52.52,0,0,0-.26.1.53.53,0,0,0-.16.23.45.45,0,0,0,0,.28.44.44,0,0,0,.15.23l2.86,2.32-1,3.56a.45.45,0,0,0,0,.28.46.46,0,0,0,.17.22.41.41,0,0,0,.26.09.43.43,0,0,0,.27-.08l3.09-2,3.09,2a.46.46,0,0,0,.53,0,.46.46,0,0,0,.17-.22.53.53,0,0,0,0-.28l-1-3.56L14.71,8.2A.44.44,0,0,0,14.86,8a.45.45,0,0,0,0-.28.53.53,0,0,0-.16-.23.52.52,0,0,0-.26-.1l-3.68-.2L9.44,3.73a.46.46,0,0,0-.17-.22A.5.5,0,0,0,9,3.43Z"></path>\n    <path class="${zt.ClassNames.Component}" fill="#fff" d="M9,2.93A.5.5,0,0,0,8.73,3a.46.46,0,0,0-.17.22L7.24,6.67l-3.68.19A.52.52,0,0,0,3.3,7a.53.53,0,0,0-.16.23.45.45,0,0,0,0,.28.44.44,0,0,0,.15.23L6.15,10l-1,3.56a.45.45,0,0,0,0,.28.46.46,0,0,0,.17.22.41.41,0,0,0,.26.09.43.43,0,0,0,.27-.08l3.09-2,3.09,2a.46.46,0,0,0,.53,0,.46.46,0,0,0,.17-.22.53.53,0,0,0,0-.28l-1-3.56L14.71,7.7a.44.44,0,0,0,.15-.23.45.45,0,0,0,0-.28A.53.53,0,0,0,14.7,7a.52.52,0,0,0-.26-.1l-3.68-.2L9.44,3.23A.46.46,0,0,0,9.27,3,.5.5,0,0,0,9,2.93Z"></path>\n  </g>`,Qt=`<g id="blunder">\n    <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${zt.ClassNames.Background}" fill="#ca3431" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g class="${zt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M14.74,5.45A2.58,2.58,0,0,0,14,4.54,3.76,3.76,0,0,0,12.89,4a4.07,4.07,0,0,0-1.2-.19A3.92,3.92,0,0,0,10.51,4a5.87,5.87,0,0,0-.9.37,3,3,0,0,0-.32.2,3.46,3.46,0,0,1,.42.63,3.29,3.29,0,0,1,.36,1.47.31.31,0,0,0,.19-.06l.11-.08a2.9,2.9,0,0,1,.29-.19,3.89,3.89,0,0,1,.41-.17,1.55,1.55,0,0,1,.48-.07,1.1,1.1,0,0,1,.72.24.72.72,0,0,1,.23.26.8.8,0,0,1,.07.34,1,1,0,0,1-.25.67,7.71,7.71,0,0,1-.65.63,6.2,6.2,0,0,0-.48.43,2.93,2.93,0,0,0-.45.54,2.55,2.55,0,0,0-.33.66,2.62,2.62,0,0,0-.13.83V11a.24.24,0,0,0,0,.12.35.35,0,0,0,.17.17l.12,0h1.71l.12,0a.23.23,0,0,0,.1-.07.21.21,0,0,0,.06-.1.27.27,0,0,0,0-.12V10.8a1,1,0,0,1,.26-.7q.27-.28.66-.63A5.79,5.79,0,0,0,14.05,9a4.51,4.51,0,0,0,.48-.6,2.56,2.56,0,0,0,.36-.72,2.81,2.81,0,0,0,.14-1A2.66,2.66,0,0,0,14.74,5.45Z"></path>\n      <path d="M12.38,12.65H10.5l-.12,0a.34.34,0,0,0-.18.29v1.82a.36.36,0,0,0,.08.23.23.23,0,0,0,.1.07l.12,0h1.88a.24.24,0,0,0,.12,0,.26.26,0,0,0,.11-.07.36.36,0,0,0,.07-.1.28.28,0,0,0,0-.13V13a.27.27,0,0,0,0-.12.61.61,0,0,0-.07-.1A.32.32,0,0,0,12.38,12.65Z"></path>\n      <path d="M6.79,12.65H4.91l-.12,0a.34.34,0,0,0-.18.29v1.82a.36.36,0,0,0,.08.23.23.23,0,0,0,.1.07l.12,0H6.79a.24.24,0,0,0,.12,0A.26.26,0,0,0,7,15a.36.36,0,0,0,.07-.1.28.28,0,0,0,0-.13V13a.27.27,0,0,0,0-.12.61.61,0,0,0-.07-.1A.32.32,0,0,0,6.79,12.65Z"></path>\n      <path d="M8.39,4.54A3.76,3.76,0,0,0,7.3,4a4.07,4.07,0,0,0-1.2-.19A3.92,3.92,0,0,0,4.92,4a5.87,5.87,0,0,0-.9.37,3.37,3.37,0,0,0-.55.38l-.21.19a.32.32,0,0,0,0,.41l1,1.2a.26.26,0,0,0,.2.12.48.48,0,0,0,.24-.06l.11-.08a2.9,2.9,0,0,1,.29-.19l.4-.17A1.66,1.66,0,0,1,6,6.06a1.1,1.1,0,0,1,.72.24.72.72,0,0,1,.23.26A.77.77,0,0,1,7,6.9a1,1,0,0,1-.26.67,7.6,7.6,0,0,1-.64.63,6.28,6.28,0,0,0-.49.43,2.93,2.93,0,0,0-.45.54,2.72,2.72,0,0,0-.33.66,2.62,2.62,0,0,0-.13.83V11a.43.43,0,0,0,0,.12.39.39,0,0,0,.08.1.18.18,0,0,0,.1.07.21.21,0,0,0,.12,0H6.72l.12,0a.23.23,0,0,0,.1-.07.36.36,0,0,0,.07-.1A.5.5,0,0,0,7,11V10.8a1,1,0,0,1,.27-.7A8,8,0,0,1,8,9.47c.18-.15.35-.31.52-.48A7,7,0,0,0,9,8.39a3.23,3.23,0,0,0,.36-.72,3.07,3.07,0,0,0,.13-1,2.66,2.66,0,0,0-.29-1.27A2.58,2.58,0,0,0,8.39,4.54Z"></path>\n    </g>\n    <g>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M14.74,5A2.58,2.58,0,0,0,14,4a3.76,3.76,0,0,0-1.09-.56,4.07,4.07,0,0,0-1.2-.19,3.92,3.92,0,0,0-1.18.17,5.87,5.87,0,0,0-.9.37,3,3,0,0,0-.32.2,3.46,3.46,0,0,1,.42.63,3.29,3.29,0,0,1,.36,1.47.31.31,0,0,0,.19-.06L10.37,6a2.9,2.9,0,0,1,.29-.19,3.89,3.89,0,0,1,.41-.17,1.55,1.55,0,0,1,.48-.07,1.1,1.1,0,0,1,.72.24.72.72,0,0,1,.23.26.8.8,0,0,1,.07.34,1,1,0,0,1-.25.67,7.71,7.71,0,0,1-.65.63,6.2,6.2,0,0,0-.48.43,2.93,2.93,0,0,0-.45.54,2.55,2.55,0,0,0-.33.66,2.62,2.62,0,0,0-.13.83v.35a.24.24,0,0,0,0,.12.35.35,0,0,0,.17.17l.12,0h1.71l.12,0a.23.23,0,0,0,.1-.07.21.21,0,0,0,.06-.1.27.27,0,0,0,0-.12V10.3a1,1,0,0,1,.26-.7q.27-.28.66-.63a5.79,5.79,0,0,0,.51-.48,4.51,4.51,0,0,0,.48-.6,2.56,2.56,0,0,0,.36-.72,2.81,2.81,0,0,0,.14-1A2.66,2.66,0,0,0,14.74,5Z"></path>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M12.38,12.15H10.5l-.12,0a.34.34,0,0,0-.18.29v1.82a.36.36,0,0,0,.08.23.23.23,0,0,0,.1.07l.12,0h1.88a.24.24,0,0,0,.12,0,.26.26,0,0,0,.11-.07.36.36,0,0,0,.07-.1.28.28,0,0,0,0-.13V12.46a.27.27,0,0,0,0-.12.61.61,0,0,0-.07-.1A.32.32,0,0,0,12.38,12.15Z"></path>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M6.79,12.15H4.91l-.12,0a.34.34,0,0,0-.18.29v1.82a.36.36,0,0,0,.08.23.23.23,0,0,0,.1.07l.12,0H6.79a.24.24,0,0,0,.12,0A.26.26,0,0,0,7,14.51a.36.36,0,0,0,.07-.1.28.28,0,0,0,0-.13V12.46a.27.27,0,0,0,0-.12.61.61,0,0,0-.07-.1A.32.32,0,0,0,6.79,12.15Z"></path>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M8.39,4A3.76,3.76,0,0,0,7.3,3.48a4.07,4.07,0,0,0-1.2-.19,3.92,3.92,0,0,0-1.18.17,5.87,5.87,0,0,0-.9.37,3.37,3.37,0,0,0-.55.38l-.21.19a.32.32,0,0,0,0,.41l1,1.2a.26.26,0,0,0,.2.12.48.48,0,0,0,.24-.06L4.78,6a2.9,2.9,0,0,1,.29-.19l.4-.17A1.66,1.66,0,0,1,6,5.56a1.1,1.1,0,0,1,.72.24.72.72,0,0,1,.23.26A.77.77,0,0,1,7,6.4a1,1,0,0,1-.26.67,7.6,7.6,0,0,1-.64.63,6.28,6.28,0,0,0-.49.43,2.93,2.93,0,0,0-.45.54,2.72,2.72,0,0,0-.33.66,2.62,2.62,0,0,0-.13.83v.35a.43.43,0,0,0,0,.12.39.39,0,0,0,.08.1.18.18,0,0,0,.1.07.21.21,0,0,0,.12,0H6.72l.12,0a.23.23,0,0,0,.1-.07.36.36,0,0,0,.07-.1.5.5,0,0,0,0-.12V10.3a1,1,0,0,1,.27-.7A8,8,0,0,1,8,9c.18-.15.35-.31.52-.48A7,7,0,0,0,9,7.89a3.23,3.23,0,0,0,.36-.72,3.07,3.07,0,0,0,.13-1A2.66,2.66,0,0,0,9.15,5,2.58,2.58,0,0,0,8.39,4Z"></path>\n    </g>\n  </g>`,Xt=`<g id="book">\n    <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${zt.ClassNames.Background}" fill="#a88865" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g>\n      <path class="${zt.ClassNames.ComponentShadow}" opacity="0.3" isolation="isolate" d="M8.45,5.9c-1-.75-2.51-1.09-4.83-1.09H2.54v8.71H3.62a8.16,8.16,0,0,1,4.83,1.17Z"></path>\n      <path class="${zt.ClassNames.ComponentShadow}" opacity="0.3" isolation="isolate" d="M9.54,14.69a8.14,8.14,0,0,1,4.84-1.17h1.08V4.81H14.38c-2.31,0-3.81.34-4.84,1.09Z"></path>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M8.45,5.4c-1-.75-2.51-1.09-4.83-1.09H3V13h.58a8.09,8.09,0,0,1,4.83,1.17Z"></path>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M9.54,14.19A8.14,8.14,0,0,1,14.38,13H15V4.31h-.58c-2.31,0-3.81.34-4.84,1.09Z"></path>\n    </g>\n  </g>`,Yt=`<g id="Brilliant">\n    <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${zt.ClassNames.Background}" fill="#1bada6" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g class="${zt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M12.57,14.6a.51.51,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0h-2l-.13,0L10,14.84A.41.41,0,0,1,10,14.6V12.7a.32.32,0,0,1,.09-.23.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13Zm-.12-3.93a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H10.35a.31.31,0,0,1-.34-.31L9.86,3.9A.36.36,0,0,1,10,3.66a.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0H12.3a.32.32,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>\n      <path d="M8.07,14.6a.51.51,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0h-2l-.13,0-.11-.08a.41.41,0,0,1-.08-.24V12.7a.27.27,0,0,1,0-.13.36.36,0,0,1,.07-.1.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13ZM8,10.67a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H5.85a.31.31,0,0,1-.34-.31L5.36,3.9a.36.36,0,0,1,.09-.24.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0H7.8a.35.35,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>\n    </g>\n    <g>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M12.57,14.1a.51.51,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0h-2l-.13,0L10,14.34A.41.41,0,0,1,10,14.1V12.2A.32.32,0,0,1,10,12a.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13Zm-.12-3.93a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H10.35a.31.31,0,0,1-.34-.31L9.86,3.4A.36.36,0,0,1,10,3.16a.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0H12.3a.32.32,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M8.07,14.1a.51.51,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0h-2l-.13,0-.11-.08a.41.41,0,0,1-.08-.24V12.2a.27.27,0,0,1,0-.13.36.36,0,0,1,.07-.1.39.39,0,0,1,.1-.08l.13,0h2A.31.31,0,0,1,8,12a.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13ZM8,10.17a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H5.85a.31.31,0,0,1-.34-.31L5.36,3.4a.36.36,0,0,1,.09-.24.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0H7.8a.35.35,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>\n    </g>\n  </g>`,Jt=`<g id="checkmate_black">\n    <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${zt.ClassNames.Background}" fill="#312e2b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <path d="M11.44,8.41h1.74l.1-1.55H11.54l.18-2.78H10.17L10,6.86H8.31l.18-2.78H6.94L6.76,6.86H5l-.1,1.55H6.66l-.11,1.68H4.82l-.1,1.55H6.46l-.18,2.78H7.83L8,11.64H9.69l-.18,2.78h1.55l.18-2.78H13l.1-1.55H11.34ZM8.11,10.09l.1-1.68H9.89l-.1,1.68Z"></path>\n    <path class="${zt.ClassNames.ComponentShadow}" fill="#fff" d="M11.44,7.91h1.74l.1-1.55H11.54l.18-2.78H10.17L10,6.36H8.31l.18-2.78H6.94L6.76,6.36H5l-.1,1.55H6.66L6.55,9.59H4.82l-.1,1.55H6.46l-.18,2.78H7.83L8,11.14H9.69l-.18,2.78h1.55l.18-2.78H13l.1-1.55H11.34ZM8.11,9.59l.1-1.68H9.89l-.1,1.68Z"></path>\n  </g>`,en=`<g id="checkmate_white">\n    <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <circle class="${zt.ClassNames.Background}" fill="#f8f8f8" cx="9" cy="9" r="8.5"></circle>\n    <path class="${zt.ClassNames.ComponentShadow}" fill="#e8e8e8" d="M9,1A8,8,0,1,1,1,9,8,8,0,0,1,9,1M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <path d="M11.44,8.11h1.74l.1-1.55H11.54l.18-2.78H10.17L10,6.56H8.31l.18-2.78H6.94L6.76,6.56H5l-.1,1.55H6.66L6.55,9.79H4.82l-.1,1.55H6.46l-.18,2.78H7.83L8,11.34H9.69l-.18,2.78h1.55l.18-2.78H13l.1-1.55H11.34ZM8.11,9.79l.1-1.68H9.89l-.1,1.68Z"></path>\n  </g>`,tn=`<g id="correct">\n    <g>\n      <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <path class="${zt.ClassNames.Background}" fill="#96bc4b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    </g>\n    <g>\n      <path class="${zt.ClassNames.ComponentShadow}" opacity="0.2" d="M15.11,6.81,9.45,12.47,7.79,14.13a.39.39,0,0,1-.28.11.39.39,0,0,1-.27-.11L2.89,9.78a.39.39,0,0,1-.11-.28.39.39,0,0,1,.11-.27L4.28,7.85a.34.34,0,0,1,.12-.09l.15,0a.37.37,0,0,1,.15,0,.38.38,0,0,1,.13.09l2.69,2.68,5.65-5.65a.38.38,0,0,1,.13-.09.37.37,0,0,1,.15,0,.4.4,0,0,1,.15,0,.34.34,0,0,1,.12.09l1.39,1.38a.41.41,0,0,1,.08.13.33.33,0,0,1,0,.15.4.4,0,0,1,0,.15A.5.5,0,0,1,15.11,6.81Z"></path>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M15.11,6.31,9.45,12,7.79,13.63a.39.39,0,0,1-.28.11.39.39,0,0,1-.27-.11L2.89,9.28A.39.39,0,0,1,2.78,9a.39.39,0,0,1,.11-.27L4.28,7.35a.34.34,0,0,1,.12-.09l.15,0a.37.37,0,0,1,.15,0,.38.38,0,0,1,.13.09L7.52,10l5.65-5.65a.38.38,0,0,1,.13-.09.37.37,0,0,1,.15,0,.4.4,0,0,1,.15,0,.34.34,0,0,1,.12.09l1.39,1.38a.41.41,0,0,1,.08.13.33.33,0,0,1,0,.15.4.4,0,0,1,0,.15A.5.5,0,0,1,15.11,6.31Z"></path>\n    </g>\n  </g>`,nn=`<g id="critical">\n    <g class="${zt.ClassNames.Shadow}" opacity="0.3">\n      <path d="M17.68,5.2,11.06,16.67a2.37,2.37,0,0,1-4.11,0L.32,5.2A2.38,2.38,0,0,1,2.38,1.64H15.62A2.38,2.38,0,0,1,17.68,5.2Z"></path>\n    </g>\n    <path class="${zt.ClassNames.Background}" fill="#ad5b8c" d="M17.68,4.7,11.06,16.17a2.37,2.37,0,0,1-4.11,0L.32,4.7A2.38,2.38,0,0,1,2.38,1.14H15.62A2.38,2.38,0,0,1,17.68,4.7Z"></path>\n    <g class="${zt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M8.67,3.22,5.9,9.92V10a.14.14,0,0,0,0,.06l0,0,0,0H8.4a.1.1,0,0,1,.09,0,.09.09,0,0,1,0,.08l0,5c0,.11.17.17.21.07L12.1,8V7.92a.14.14,0,0,0,0-.06.09.09,0,0,0-.05,0l-.06,0H9.32a.11.11,0,0,1-.08,0,.12.12,0,0,1,0-.09l-.32-4.4C8.87,3.18,8.71,3.12,8.67,3.22Z"></path>\n    </g>\n    <path class="${zt.ClassNames.Component}" fill="#fff" d="M8.67,2.72,5.9,9.42v.05a.14.14,0,0,0,0,.06l0,0,0,0H8.4a.1.1,0,0,1,.09,0,.09.09,0,0,1,0,.08l0,5c0,.11.17.17.21.07l3.4-7.24V7.42a.14.14,0,0,0,0-.06.09.09,0,0,0-.05,0l-.06,0H9.32a.11.11,0,0,1-.08,0,.12.12,0,0,1,0-.09l-.32-4.4C8.87,2.68,8.71,2.62,8.67,2.72Z"></path>\n  </g>`,rn=`<g id="draw_black">\n    <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${zt.ClassNames.Background}" fill="#312e2b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <path d="M2.92,7V5.84c.81,0,1.75-.28,1.8-1.22H6.14v5.5H4.34V7Zm8.87-2.39L7,13.88H5l4.8-9.26ZM9.85,13.88c-.08-1.54,1.38-2.19,2.57-2.89.33-.17.78-.4.78-.78a.66.66,0,0,0-.68-.7c-.69,0-.94.58-.92,1.16H10a2.17,2.17,0,0,1,.64-1.79,2.74,2.74,0,0,1,1.91-.62C14.1,8.26,15,8.78,15,10c0,1.82-2.66,2.18-2.66,2.5h2.73v1.38Z"></path>\n    <path class="${zt.ClassNames.ComponentShadow}" fill="#fff" d="M2.92,6.51V5.34c.81,0,1.75-.28,1.8-1.22H6.14v5.5H4.34V6.51Zm8.87-2.39L7,13.38H5l4.8-9.26ZM9.85,13.38c-.08-1.54,1.38-2.19,2.57-2.89.33-.17.78-.4.78-.78a.66.66,0,0,0-.68-.7c-.69,0-.94.58-.92,1.16H10a2.17,2.17,0,0,1,.64-1.79,2.74,2.74,0,0,1,1.91-.62C14.1,7.76,15,8.28,15,9.5c0,1.82-2.66,2.18-2.66,2.5h2.73v1.38Z"></path>\n  </g>`,an=`<g id="draw_white">\n    <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <circle class="${zt.ClassNames.Background}" fill="#f8f8f8" cx="9" cy="9" r="8.5"></circle>\n    <path class="${zt.ClassNames.ComponentShadow}" fill="#e8e8e8" d="M9,1A8,8,0,1,1,1,9,8,8,0,0,1,9,1M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <path d="M2.92,6.61V5.44c.81,0,1.75-.28,1.8-1.22H6.14v5.5H4.34V6.61Zm8.87-2.39L7,13.48H5l4.8-9.26ZM9.85,13.48c-.08-1.54,1.38-2.19,2.57-2.89.33-.17.78-.4.78-.78a.66.66,0,0,0-.68-.7c-.69,0-.94.58-.92,1.16H10a2.17,2.17,0,0,1,.64-1.79,2.74,2.74,0,0,1,1.91-.62C14.1,7.86,15,8.38,15,9.6c0,1.82-2.66,2.18-2.66,2.5h2.73v1.38Z"></path>\n  </g>`,sn=`<g id="excellent">\n    <g>\n      <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <path class="${zt.ClassNames.Background}" fill="#96bc4b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    </g>\n    <g class="${zt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M13.79,11.34c0-.2.4-.53.4-.94S14,9.72,14,9.58a2.06,2.06,0,0,0,.18-.83,1,1,0,0,0-.3-.69,1.13,1.13,0,0,0-.55-.2,10.29,10.29,0,0,1-2.07,0c-.37-.23,0-1.18.18-1.7S11.9,4,10.62,3.7c-.69-.17-.66.37-.78.9-.05.21-.09.43-.13.57A5,5,0,0,1,7.05,8.23a1.57,1.57,0,0,1-.42.18v4.94A7.23,7.23,0,0,1,8,13.53c.52.12.91.25,1.44.33A11.11,11.11,0,0,0,11,14a6.65,6.65,0,0,0,1.18,0,1.09,1.09,0,0,0,1-.59.66.66,0,0,0,.06-.2,1.63,1.63,0,0,1,.07-.3c.13-.28.37-.3.5-.68S13.74,11.53,13.79,11.34Z"></path>\n      <path d="M5.49,8.09H4.31a.5.5,0,0,0-.5.5v4.56a.5.5,0,0,0,.5.5H5.49a.5.5,0,0,0,.5-.5V8.59A.5.5,0,0,0,5.49,8.09Z"></path>\n    </g>\n    <g>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M13.79,10.84c0-.2.4-.53.4-.94S14,9.22,14,9.08a2.06,2.06,0,0,0,.18-.83,1,1,0,0,0-.3-.69,1.13,1.13,0,0,0-.55-.2,10.29,10.29,0,0,1-2.07,0c-.37-.23,0-1.18.18-1.7s.51-2.12-.77-2.43c-.69-.17-.66.37-.78.9-.05.21-.09.43-.13.57A5,5,0,0,1,7.05,7.73a1.57,1.57,0,0,1-.42.18v4.94A7.23,7.23,0,0,1,8,13c.52.12.91.25,1.44.33a11.11,11.11,0,0,0,1.62.16,6.65,6.65,0,0,0,1.18,0,1.09,1.09,0,0,0,1-.59.66.66,0,0,0,.06-.2,1.63,1.63,0,0,1,.07-.3c.13-.28.37-.3.5-.68S13.74,11,13.79,10.84Z"></path>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M5.49,7.59H4.31a.5.5,0,0,0-.5.5v4.56a.5.5,0,0,0,.5.5H5.49a.5.5,0,0,0,.5-.5V8.09A.5.5,0,0,0,5.49,7.59Z"></path>\n    </g>\n  </g>`,cn=`<g id="fast_win">\n    <g>\n      <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <path class="${zt.ClassNames.Background}" fill="#96af8b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    </g>\n    <g class="${zt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M4.85,4.7,9.67,9.19a.18.18,0,0,1,.05.07.21.21,0,0,1,0,.18l-.05.07L4.85,14a.24.24,0,0,1-.11.06.3.3,0,0,1-.13,0A.23.23,0,0,1,4.52,14a.28.28,0,0,1,0-.12v-9a.28.28,0,0,1,0-.12.23.23,0,0,1,.09-.08.3.3,0,0,1,.13,0A.24.24,0,0,1,4.85,4.7Z"></path>\n      <path d="M10,4.7l4.82,4.49a.18.18,0,0,1,.05.07.21.21,0,0,1,0,.18l-.05.07L10,14a.24.24,0,0,1-.11.06.27.27,0,0,1-.13,0A.18.18,0,0,1,9.7,14a.19.19,0,0,1,0-.12v-9a.19.19,0,0,1,0-.12.18.18,0,0,1,.09-.08.27.27,0,0,1,.13,0A.24.24,0,0,1,10,4.7Z"></path>\n    </g>\n    <g>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M4.85,4.2,9.67,8.69a.18.18,0,0,1,.05.07.21.21,0,0,1,0,.18L9.67,9,4.85,13.5a.24.24,0,0,1-.11.06.3.3,0,0,1-.13,0,.23.23,0,0,1-.09-.08.28.28,0,0,1,0-.12v-9a.28.28,0,0,1,0-.12.23.23,0,0,1,.09-.08.3.3,0,0,1,.13,0A.24.24,0,0,1,4.85,4.2Z"></path>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M10,4.2l4.82,4.49a.18.18,0,0,1,.05.07.21.21,0,0,1,0,.18L14.85,9,10,13.5a.24.24,0,0,1-.11.06.27.27,0,0,1-.13,0,.18.18,0,0,1-.09-.08.19.19,0,0,1,0-.12v-9a.19.19,0,0,1,0-.12.18.18,0,0,1,.09-.08.27.27,0,0,1,.13,0A.24.24,0,0,1,10,4.2Z"></path>\n    </g>\n  </g>`,ln=`<g id="free_piece">\n    <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${zt.ClassNames.Background}" fill="#ec6250" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g class="${zt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M9.76,9.66h3.89v4.19a.68.68,0,0,1-.68.68H9.76Z"></path>\n      <path d="M4.35,9.66H8.24v4.87H5a.58.58,0,0,1-.26-.06.6.6,0,0,1-.36-.36.58.58,0,0,1,0-.26V9.66Z"></path>\n      <path d="M13.39,7H10.13l2-1a.78.78,0,0,0,.29-.25.78.78,0,0,0,.13-.36A.82.82,0,0,0,12.53,5a.87.87,0,0,0-.23-.31l-1.15-1a.76.76,0,0,0-.34-.16.74.74,0,0,0-.39,0,.94.94,0,0,0-.33.2.84.84,0,0,0-.19.33L9.08,7H9l-.83-2.9A.73.73,0,0,0,8,3.81a.79.79,0,0,0-.33-.2.7.7,0,0,0-.38,0,.75.75,0,0,0-.35.16l-1.14,1A.87.87,0,0,0,5.54,5a.71.71,0,0,0,0,.38.78.78,0,0,0,.13.36A.71.71,0,0,0,5.91,6l2,1H4.61a.46.46,0,0,0-.49.44v.87a.47.47,0,0,0,.49.45h8.78a.47.47,0,0,0,.49-.45V7.48A.47.47,0,0,0,13.39,7Z"></path>\n    </g>\n    <g>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M9.76,14H13a.71.71,0,0,0,.48-.19.72.72,0,0,0,.2-.48V9.16H9.76Z"></path>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M4.36,13.35a.58.58,0,0,0,0,.26.6.6,0,0,0,.36.36A.58.58,0,0,0,5,14H8.24V9.16H4.36Z"></path>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M13.39,6.54H10.13l2-1a.78.78,0,0,0,.29-.25.78.78,0,0,0,.13-.36.82.82,0,0,0-.05-.38.87.87,0,0,0-.23-.31l-1.15-1a.76.76,0,0,0-.34-.16.74.74,0,0,0-.39,0,.94.94,0,0,0-.33.2.84.84,0,0,0-.19.33l-.82,2.9H9l-.83-2.9A.73.73,0,0,0,8,3.31a.79.79,0,0,0-.33-.2.7.7,0,0,0-.38,0,.75.75,0,0,0-.35.16l-1.14,1a.87.87,0,0,0-.23.31.71.71,0,0,0,0,.38.78.78,0,0,0,.13.36.71.71,0,0,0,.29.25l2,1H4.61A.46.46,0,0,0,4.12,7v.87a.47.47,0,0,0,.49.45h8.78a.47.47,0,0,0,.49-.45V7A.47.47,0,0,0,13.39,6.54Z"></path>\n    </g>\n  </g>`,un=`<path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n<path class="${zt.ClassNames.Background}" fill="#7979a1" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n<g class="${zt.ClassNames.ComponentShadow}" opacity="0.1">\n    <polygon points="11.29 11.34 11.29 8.56 7.79 11.3 7.79 11.34 5.39 11.34 9.54 16.5 13.73 11.34 11.29 11.34"></polygon>\n    <polygon points="7.83 7.51 7.83 10.32 11.33 7.58 11.33 7.5 13.73 7.5 9.58 2.35 5.39 7.51 7.83 7.51"></polygon>\n  </g>\n<g>\n    <polygon class="${zt.ClassNames.Component}" fill="#fff" points="10.9 10.92 10.9 8.13 7.4 10.87 7.4 10.92 5 10.92 9.15 16.07 13.34 10.92 10.9 10.92"></polygon>\n    <polygon class="${zt.ClassNames.Component}" fill="#fff" points="7.44 7.08 7.44 9.9 10.94 7.16 10.94 7.08 13.34 7.08 9.19 1.93 5 7.08 7.44 7.08"></polygon>\n  </g>`,dn=`<g id="great_find">\n    <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${zt.ClassNames.Background}" fill="#5c8bb0" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g>\n      <g class="${zt.ClassNames.ComponentShadow}" opacity="0.2">\n        <path d="M10.32,14.6a.27.27,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0H8l-.13,0-.11-.08a.41.41,0,0,1-.08-.24V12.7a.27.27,0,0,1,0-.13.36.36,0,0,1,.07-.1.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13Zm-.12-3.93a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H8.1a.31.31,0,0,1-.34-.31L7.61,3.9a.36.36,0,0,1,.09-.24.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0h2.11a.32.32,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>\n      </g>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M10.32,14.1a.27.27,0,0,1,0,.13.44.44,0,0,1-.08.11l-.11.08-.13,0H8l-.13,0-.11-.08a.41.41,0,0,1-.08-.24V12.2a.27.27,0,0,1,0-.13.36.36,0,0,1,.07-.1.39.39,0,0,1,.1-.08l.13,0h2a.31.31,0,0,1,.24.1.39.39,0,0,1,.08.1.51.51,0,0,1,0,.13Zm-.12-3.93a.17.17,0,0,1,0,.12.41.41,0,0,1-.07.11.4.4,0,0,1-.23.08H8.1a.31.31,0,0,1-.34-.31L7.61,3.4a.36.36,0,0,1,.09-.24.23.23,0,0,1,.11-.08.27.27,0,0,1,.13,0h2.11a.32.32,0,0,1,.25.1.36.36,0,0,1,.09.24Z"></path>\n    </g>\n  </g>`,fn=`<g id="forced">\n    <g id="fast_win">\n      <g>\n        <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n        <path class="${zt.ClassNames.Background}" fill="#96af8b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n      </g>\n    </g>\n    <g class="${zt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M14.39,9.07,9,4.31a.31.31,0,0,0-.3,0,.32.32,0,0,0-.13.1.29.29,0,0,0,0,.16V7.42H3.9a.58.58,0,0,0-.19,0,.5.5,0,0,0-.17.11.91.91,0,0,0-.11.16.63.63,0,0,0,0,.19v3.41a.58.58,0,0,0,0,.19.64.64,0,0,0,.11.16.39.39,0,0,0,.17.11.41.41,0,0,0,.19,0H8.5v2.74a.26.26,0,0,0,.16.26.3.3,0,0,0,.16,0A.34.34,0,0,0,9,14.79L14.39,10a.69.69,0,0,0,.16-.22.7.7,0,0,0,0-.52A.69.69,0,0,0,14.39,9.07Z"></path>\n    </g>\n    <path class="${zt.ClassNames.Component}" fill="#fff" d="M14.39,8.57,9,3.81a.31.31,0,0,0-.3,0,.32.32,0,0,0-.13.1A.29.29,0,0,0,8.5,4V6.92H3.9a.58.58,0,0,0-.19,0,.5.5,0,0,0-.17.11.91.91,0,0,0-.11.16.63.63,0,0,0,0,.19v3.41a.58.58,0,0,0,0,.19.64.64,0,0,0,.11.16.39.39,0,0,0,.17.11.41.41,0,0,0,.19,0H8.5v2.74a.26.26,0,0,0,.16.26.3.3,0,0,0,.16,0A.34.34,0,0,0,9,14.29l5.42-4.76a.69.69,0,0,0,.16-.22.7.7,0,0,0,0-.52A.69.69,0,0,0,14.39,8.57Z"></path>\n  </g>`,pn=`<g id="good">\n    <g>\n      <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <path class="${zt.ClassNames.Background}" fill="#96af8b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    </g>\n    <g>\n      <path class="${zt.ClassNames.ComponentShadow}" opacity="0.2" d="M15.11,6.81,9.45,12.47,7.79,14.13a.39.39,0,0,1-.28.11.39.39,0,0,1-.27-.11L2.89,9.78a.39.39,0,0,1-.11-.28.39.39,0,0,1,.11-.27L4.28,7.85a.34.34,0,0,1,.12-.09l.15,0a.37.37,0,0,1,.15,0,.38.38,0,0,1,.13.09l2.69,2.68,5.65-5.65a.38.38,0,0,1,.13-.09.37.37,0,0,1,.15,0,.4.4,0,0,1,.15,0,.34.34,0,0,1,.12.09l1.39,1.38a.41.41,0,0,1,.08.13.33.33,0,0,1,0,.15.4.4,0,0,1,0,.15A.5.5,0,0,1,15.11,6.81Z"></path>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M15.11,6.31,9.45,12,7.79,13.63a.39.39,0,0,1-.28.11.39.39,0,0,1-.27-.11L2.89,9.28A.39.39,0,0,1,2.78,9a.39.39,0,0,1,.11-.27L4.28,7.35a.34.34,0,0,1,.12-.09l.15,0a.37.37,0,0,1,.15,0,.38.38,0,0,1,.13.09L7.52,10l5.65-5.65a.38.38,0,0,1,.13-.09.37.37,0,0,1,.15,0,.4.4,0,0,1,.15,0,.34.34,0,0,1,.12.09l1.39,1.38a.41.41,0,0,1,.08.13.33.33,0,0,1,0,.15.4.4,0,0,1,0,.15A.5.5,0,0,1,15.11,6.31Z"></path>\n    </g>\n  </g>`,hn=`<g id="inaccuracy">\n    <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${zt.ClassNames.Background}" fill="#f7c045" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g class="${zt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M13.66,14.8a.28.28,0,0,1,0,.13.23.23,0,0,1-.08.11.28.28,0,0,1-.11.08l-.12,0h-2l-.13,0a.27.27,0,0,1-.1-.08A.36.36,0,0,1,11,14.8V12.9a.59.59,0,0,1,0-.13.36.36,0,0,1,.07-.1l.1-.08.13,0h2a.33.33,0,0,1,.23.1.39.39,0,0,1,.08.1.28.28,0,0,1,0,.13Zm-.12-3.93a.31.31,0,0,1,0,.13.3.3,0,0,1-.07.1.3.3,0,0,1-.23.08H11.43a.31.31,0,0,1-.34-.31L10.94,4.1A.5.5,0,0,1,11,3.86l.11-.08.13,0h2.11a.35.35,0,0,1,.26.1.41.41,0,0,1,.08.24Z"></path>\n      <path d="M7.65,14.82a.27.27,0,0,1,0,.12.26.26,0,0,1-.07.11l-.1.07-.13,0H5.43a.25.25,0,0,1-.12,0,.27.27,0,0,1-.1-.08.31.31,0,0,1-.09-.22V13a.36.36,0,0,1,.09-.23l.1-.07.12,0H7.32a.32.32,0,0,1,.23.09.3.3,0,0,1,.07.1.28.28,0,0,1,0,.13Zm2.2-7.17a3.1,3.1,0,0,1-.36.73A5.58,5.58,0,0,1,9,9a4.85,4.85,0,0,1-.52.49,8,8,0,0,0-.65.63,1,1,0,0,0-.27.7V11a.21.21,0,0,1,0,.12.17.17,0,0,1-.06.1.23.23,0,0,1-.1.07l-.12,0H5.53a.21.21,0,0,1-.12,0,.18.18,0,0,1-.1-.07.2.2,0,0,1-.08-.1.37.37,0,0,1,0-.12v-.35a2.68,2.68,0,0,1,.13-.84,2.91,2.91,0,0,1,.33-.66,3.38,3.38,0,0,1,.45-.55c.16-.15.33-.29.49-.42a7.84,7.84,0,0,0,.65-.64,1,1,0,0,0,.25-.67.77.77,0,0,0-.07-.34.67.67,0,0,0-.23-.27A1.16,1.16,0,0,0,6.49,6,1.61,1.61,0,0,0,6,6.11a3,3,0,0,0-.41.18,1.75,1.75,0,0,0-.29.18l-.11.09A.5.5,0,0,1,5,6.62a.31.31,0,0,1-.21-.13l-1-1.21a.3.3,0,0,1,0-.4A1.36,1.36,0,0,1,4,4.68a3.07,3.07,0,0,1,.56-.38,5.49,5.49,0,0,1,.9-.37,3.69,3.69,0,0,1,1.19-.17,3.92,3.92,0,0,1,2.3.75,2.85,2.85,0,0,1,.77.92A2.82,2.82,0,0,1,10,6.71,3,3,0,0,1,9.85,7.65Z"></path>\n    </g>\n    <g>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M13.66,14.3a.28.28,0,0,1,0,.13.23.23,0,0,1-.08.11.28.28,0,0,1-.11.08l-.12,0h-2l-.13,0a.27.27,0,0,1-.1-.08A.36.36,0,0,1,11,14.3V12.4a.59.59,0,0,1,0-.13.36.36,0,0,1,.07-.1l.1-.08.13,0h2a.33.33,0,0,1,.23.1.39.39,0,0,1,.08.1.28.28,0,0,1,0,.13Zm-.12-3.93a.31.31,0,0,1,0,.13.3.3,0,0,1-.07.1.3.3,0,0,1-.23.08H11.43a.31.31,0,0,1-.34-.31L10.94,3.6A.5.5,0,0,1,11,3.36l.11-.08.13,0h2.11a.35.35,0,0,1,.26.1.41.41,0,0,1,.08.24Z"></path>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M7.65,14.32a.27.27,0,0,1,0,.12.26.26,0,0,1-.07.11l-.1.07-.13,0H5.43a.25.25,0,0,1-.12,0,.27.27,0,0,1-.1-.08.31.31,0,0,1-.09-.22V12.49a.36.36,0,0,1,.09-.23l.1-.07.12,0H7.32a.32.32,0,0,1,.23.09.3.3,0,0,1,.07.1.28.28,0,0,1,0,.13Zm2.2-7.17a3.1,3.1,0,0,1-.36.73,5.58,5.58,0,0,1-.49.6A4.85,4.85,0,0,1,8.48,9a8,8,0,0,0-.65.63,1,1,0,0,0-.27.7v.22a.21.21,0,0,1,0,.12.17.17,0,0,1-.06.1.23.23,0,0,1-.1.07l-.12,0H5.53a.21.21,0,0,1-.12,0,.18.18,0,0,1-.1-.07.2.2,0,0,1-.08-.1.37.37,0,0,1,0-.12v-.35a2.68,2.68,0,0,1,.13-.84,2.91,2.91,0,0,1,.33-.66,3.38,3.38,0,0,1,.45-.55c.16-.15.33-.29.49-.42a7.84,7.84,0,0,0,.65-.64,1,1,0,0,0,.25-.67.77.77,0,0,0-.07-.34.67.67,0,0,0-.23-.27,1.16,1.16,0,0,0-.72-.24A1.61,1.61,0,0,0,6,5.61a3,3,0,0,0-.41.18A1.75,1.75,0,0,0,5.3,6l-.11.09A.5.5,0,0,1,5,6.12.31.31,0,0,1,4.74,6l-1-1.21a.3.3,0,0,1,0-.4A1.36,1.36,0,0,1,4,4.18a3.07,3.07,0,0,1,.56-.38,5.49,5.49,0,0,1,.9-.37,3.69,3.69,0,0,1,1.19-.17A3.92,3.92,0,0,1,8.93,4a2.85,2.85,0,0,1,.77.92A2.82,2.82,0,0,1,10,6.21,3,3,0,0,1,9.85,7.15Z"></path>\n    </g>\n  </g>`,mn=`<g id="incorrect">\n    <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${zt.ClassNames.Background}" fill="#ca3431" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g class="${zt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M14,12.51a.57.57,0,0,1,.08.13.39.39,0,0,1,0,.3.5.5,0,0,1-.08.12l-1.38,1.38a.5.5,0,0,1-.12.08l-.15,0-.15,0a.57.57,0,0,1-.13-.08L9,11.37,5.94,14.44a.57.57,0,0,1-.13.08l-.15,0-.15,0a.36.36,0,0,1-.12-.08L4,13.06a.39.39,0,0,1-.11-.27A.41.41,0,0,1,4,12.51L7.07,9.45,4,6.39a.43.43,0,0,1-.11-.28A.39.39,0,0,1,4,5.84L5.39,4.46a.39.39,0,0,1,.27-.11.43.43,0,0,1,.28.11L9,7.52l3.06-3.06a.41.41,0,0,1,.28-.11.39.39,0,0,1,.27.11L14,5.84a.36.36,0,0,1,.08.12.39.39,0,0,1,0,.3.57.57,0,0,1-.08.13L10.92,9.45Z"></path>\n    </g>\n    <path class="${zt.ClassNames.Component}" fill="#f1f2f2" d="M14,12a.57.57,0,0,1,.08.13.39.39,0,0,1,0,.3.5.5,0,0,1-.08.12l-1.38,1.38a.5.5,0,0,1-.12.08l-.15,0-.15,0a.57.57,0,0,1-.13-.08L9,10.87,5.94,13.94a.57.57,0,0,1-.13.08l-.15,0-.15,0a.36.36,0,0,1-.12-.08L4,12.56a.39.39,0,0,1-.11-.27A.41.41,0,0,1,4,12L7.07,9,4,5.89a.43.43,0,0,1-.11-.28A.39.39,0,0,1,4,5.34L5.39,4a.39.39,0,0,1,.27-.11A.43.43,0,0,1,5.94,4L9,7,12.06,4a.41.41,0,0,1,.28-.11.39.39,0,0,1,.27.11L14,5.34a.36.36,0,0,1,.08.12.39.39,0,0,1,0,.3.57.57,0,0,1-.08.13L10.92,9Z"></path>\n  </g>`,gn=`<g id="mate">\n    <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${zt.ClassNames.Background}" fill="#ec6250" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g>\n      <g class="${zt.ClassNames.ComponentShadow}" opacity="0.2">\n        <path d="M11.44,8.61h1.74l.1-1.55H11.54l.18-2.78H10.17L10,7.06H8.31l.18-2.78H6.94L6.76,7.06H5l-.1,1.55H6.66l-.11,1.68H4.82l-.1,1.55H6.46l-.18,2.78H7.83L8,11.84H9.69l-.18,2.78h1.55l.18-2.78H13l.1-1.55H11.34ZM8.11,10.29l.1-1.68H9.89l-.1,1.68Z"></path>\n      </g>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M11.44,8.11h1.74l.1-1.55H11.54l.18-2.78H10.17L10,6.56H8.31l.18-2.78H6.94L6.76,6.56H5l-.1,1.55H6.66L6.55,9.79H4.82l-.1,1.55H6.46l-.18,2.78H7.83L8,11.34H9.69l-.18,2.78h1.55l.18-2.78H13l.1-1.55H11.34ZM8.11,9.79l.1-1.68H9.89l-.1,1.68Z"></path>\n    </g>\n  </g>`,vn=`<g id="missed_win">\n    <g>\n      <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <path class="${zt.ClassNames.Background}" fill="#dbac16" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    </g>\n    <g>\n      <g class="${zt.ClassNames.ComponentShadow}" opacity="0.2">\n        <rect x="2.74" y="8.1" width="12.51" height="3.11" rx="0.36"></rect>\n      </g>\n      <rect class="${zt.ClassNames.Component}" fill="#fff" x="2.74" y="7.6" width="12.51" height="3.11" rx="0.36"></rect>\n    </g>\n  </g>`,yn=`<g id="mistake">\n    <g>\n      <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <path class="${zt.ClassNames.Background}" fill="#e58f2a" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    </g>\n    <g>\n      <g class="${zt.ClassNames.ComponentShadow}" opacity="0.2">\n        <path d="M9.92,15a.27.27,0,0,1,0,.12.41.41,0,0,1-.07.11.32.32,0,0,1-.23.09H7.7a.25.25,0,0,1-.12,0,.27.27,0,0,1-.1-.08A.31.31,0,0,1,7.39,15V13.19A.32.32,0,0,1,7.48,13l.1-.07.12,0H9.59a.32.32,0,0,1,.23.09.61.61,0,0,1,.07.1.28.28,0,0,1,0,.13Zm2.2-7.17a3.1,3.1,0,0,1-.36.73,5.58,5.58,0,0,1-.49.6,6,6,0,0,1-.52.49,8,8,0,0,0-.65.63,1,1,0,0,0-.27.7v.22a.24.24,0,0,1,0,.12.17.17,0,0,1-.06.1.3.3,0,0,1-.1.07l-.12,0H7.79l-.12,0a.3.3,0,0,1-.1-.07.26.26,0,0,1-.07-.1.37.37,0,0,1,0-.12v-.35A2.42,2.42,0,0,1,7.61,10a2.55,2.55,0,0,1,.33-.66,3.38,3.38,0,0,1,.45-.55c.16-.15.33-.29.49-.42a7.73,7.73,0,0,0,.64-.64,1,1,0,0,0,.26-.67.77.77,0,0,0-.07-.34.75.75,0,0,0-.23-.27,1.16,1.16,0,0,0-.72-.24,1.61,1.61,0,0,0-.49.07,3,3,0,0,0-.41.18,1.41,1.41,0,0,0-.29.18l-.11.09a.5.5,0,0,1-.24.06A.31.31,0,0,1,7,6.69L6,5.48a.29.29,0,0,1,0-.4,1.36,1.36,0,0,1,.21-.2,3.07,3.07,0,0,1,.56-.38,5.38,5.38,0,0,1,.89-.37A3.75,3.75,0,0,1,8.9,4a4.07,4.07,0,0,1,1.2.19,4,4,0,0,1,1.09.56,2.76,2.76,0,0,1,.78.92,2.82,2.82,0,0,1,.28,1.28A3,3,0,0,1,12.12,7.85Z"></path>\n      </g>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M9.92,14.52a.27.27,0,0,1,0,.12.41.41,0,0,1-.07.11.32.32,0,0,1-.23.09H7.7a.25.25,0,0,1-.12,0,.27.27,0,0,1-.1-.08.31.31,0,0,1-.09-.22V12.69a.32.32,0,0,1,.09-.23l.1-.07.12,0H9.59a.32.32,0,0,1,.23.09.61.61,0,0,1,.07.1.28.28,0,0,1,0,.13Zm2.2-7.17a3.1,3.1,0,0,1-.36.73,5.58,5.58,0,0,1-.49.6,6,6,0,0,1-.52.49,8,8,0,0,0-.65.63,1,1,0,0,0-.27.7v.22a.24.24,0,0,1,0,.12.17.17,0,0,1-.06.1.3.3,0,0,1-.1.07l-.12,0H7.79l-.12,0a.3.3,0,0,1-.1-.07.26.26,0,0,1-.07-.1.37.37,0,0,1,0-.12v-.35a2.42,2.42,0,0,1,.13-.84,2.55,2.55,0,0,1,.33-.66,3.38,3.38,0,0,1,.45-.55c.16-.15.33-.29.49-.42a7.73,7.73,0,0,0,.64-.64,1,1,0,0,0,.26-.67.77.77,0,0,0-.07-.34A.75.75,0,0,0,9.48,6a1.16,1.16,0,0,0-.72-.24,1.61,1.61,0,0,0-.49.07A3,3,0,0,0,7.86,6a1.41,1.41,0,0,0-.29.18l-.11.09a.5.5,0,0,1-.24.06A.31.31,0,0,1,7,6.19L6,5a.29.29,0,0,1,0-.4,1.36,1.36,0,0,1,.21-.2A3.07,3.07,0,0,1,6.81,4a5.38,5.38,0,0,1,.89-.37,3.75,3.75,0,0,1,1.2-.17,4.07,4.07,0,0,1,1.2.19,4,4,0,0,1,1.09.56,2.76,2.76,0,0,1,.78.92,2.82,2.82,0,0,1,.28,1.28A3,3,0,0,1,12.12,7.35Z"></path>\n    </g>\n  </g>`,_n=`<g id="resign_black">\n    <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${zt.ClassNames.Background}" fill="#312e2b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g>\n      <path d="M4.94,6.34H4.89a.63.63,0,0,0-.44.77l2.16,8.09a.63.63,0,0,0,.77.45l0,0a.62.62,0,0,0,.44-.76L5.7,6.78A.62.62,0,0,0,4.94,6.34Z"></path>\n      <path d="M12.33,4.48c-2,2.29-3.83-.41-6,1.52a.54.54,0,0,0-.15.25.48.48,0,0,0,0,.29c.22.89.87,3.3,1.12,4.15a.15.15,0,0,0,.26.07c1.92-2.65,4,.27,6.11-1.69a.46.46,0,0,0,.12-.44c-.21-.78-.8-3-1.1-4.05C12.62,4.44,12.42,4.36,12.33,4.48Z"></path>\n    </g>\n    <g>\n      <path class="${zt.ClassNames.ComponentShadow}" fill="#fff" d="M4.94,5.74H4.89a.63.63,0,0,0-.44.77l2.16,8.09a.63.63,0,0,0,.77.45l0,0a.62.62,0,0,0,.44-.76L5.7,6.18A.62.62,0,0,0,4.94,5.74Z"></path>\n      <path class="${zt.ClassNames.ComponentShadow}" fill="#fff" d="M12.33,3.88c-2,2.29-3.83-.41-6,1.52a.54.54,0,0,0-.15.25.48.48,0,0,0,0,.29c.22.89.87,3.3,1.12,4.15a.15.15,0,0,0,.26.07c1.92-2.65,4,.27,6.11-1.69A.46.46,0,0,0,13.76,8c-.21-.78-.8-3-1.1-4C12.62,3.84,12.42,3.76,12.33,3.88Z"></path>\n    </g>\n  </g>`,bn=`<g id="resign_white">\n    <g>\n      <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <circle class="${zt.ClassNames.Background}" fill="#f8f8f8" cx="9" cy="9" r="8.5"></circle>\n      <g>\n        <path d="M4.94,5.74H4.89a.63.63,0,0,0-.44.77l2.16,8.09a.63.63,0,0,0,.77.45l0,0a.62.62,0,0,0,.44-.76L5.7,6.18A.62.62,0,0,0,4.94,5.74Z"></path>\n        <path d="M12.33,3.88c-2,2.29-3.83-.41-6,1.52a.54.54,0,0,0-.15.25.48.48,0,0,0,0,.29c.22.89.87,3.3,1.12,4.15a.15.15,0,0,0,.26.07c1.92-2.65,4,.27,6.11-1.69A.46.46,0,0,0,13.76,8c-.21-.78-.8-3-1.1-4C12.62,3.84,12.42,3.76,12.33,3.88Z"></path>\n      </g>\n    </g>\n    <path class="${zt.ClassNames.ComponentShadow}" fill="#e8e8e8" d="M9,1A8,8,0,1,1,1,9,8,8,0,0,1,9,1M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n  </g>`,Cn=`<g id="sharp">\n    <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${zt.ClassNames.Background}" fill="#ad5b8c" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g class="${zt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M13.37,11.74,9.25,2.81a.22.22,0,0,0-.1-.11.27.27,0,0,0-.28,0,.18.18,0,0,0-.1.11L4.63,11.74a.26.26,0,0,0,0,.15.25.25,0,0,0,.08.14l2.67,2.29.07.09a.3.3,0,0,1,0,.1v1.08a.25.25,0,0,0,.08.18.24.24,0,0,0,.18.07h2.57a.26.26,0,0,0,.18-.07.25.25,0,0,0,.08-.18V14.51a.16.16,0,0,1,0-.1.47.47,0,0,1,.06-.09L13.31,12a.25.25,0,0,0,.08-.14A.26.26,0,0,0,13.37,11.74ZM9,5v8.73a.24.24,0,0,1-.38.17L5.91,11.76a.3.3,0,0,1-.09-.13.22.22,0,0,1,0-.16L8.84,5a.08.08,0,0,1,0,0h.06A.09.09,0,0,1,9,5S9,5,9,5Z"></path>\n    </g>\n    <path class="${zt.ClassNames.Component}" fill="#fff" d="M13.37,11.24,9.25,2.31a.22.22,0,0,0-.1-.11.26.26,0,0,0-.28,0,.18.18,0,0,0-.1.11L4.63,11.24a.26.26,0,0,0,0,.15.25.25,0,0,0,.08.14l2.67,2.29.07.09a.3.3,0,0,1,0,.1v1.08a.25.25,0,0,0,.08.18.24.24,0,0,0,.18.07h2.57a.26.26,0,0,0,.18-.07.25.25,0,0,0,.08-.18V14a.16.16,0,0,1,0-.1.47.47,0,0,1,.06-.09l2.67-2.29a.25.25,0,0,0,.08-.14A.26.26,0,0,0,13.37,11.24ZM9,4.51v8.73a.24.24,0,0,1-.38.17L5.91,11.26a.3.3,0,0,1-.09-.13.22.22,0,0,1,0-.16l3-6.49a.08.08,0,0,1,0,0h.06a.09.09,0,0,1,.05,0S9,4.49,9,4.51Z"></path>\n  </g>`,Sn=`<g id="take_back">\n    <g>\n      <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <path class="${zt.ClassNames.Background}" fill="#96af8b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    </g>\n    <g class="${zt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M3.67,10.38a.25.25,0,0,1,.24-.31L5,9.93a.49.49,0,0,1,.2.05.26.26,0,0,1,.1.2,3.77,3.77,0,0,0,1.26,2.34,3.87,3.87,0,0,0,2.52.94,3.53,3.53,0,0,0,1.47-.31,3.72,3.72,0,0,0,1.22-.81,4.13,4.13,0,0,0,.82-1.2,3.74,3.74,0,0,0,0-3A3.94,3.94,0,0,0,11.77,7a3.72,3.72,0,0,0-1.22-.81,3.53,3.53,0,0,0-1.47-.31,3.43,3.43,0,0,0-1.23.22,3.07,3.07,0,0,0-1.09.6L7.85,7.75c.16.14.22.29.16.38s-.18.16-.4.16H4.45a.33.33,0,0,1-.19,0,1,1,0,0,1-.17-.1A.57.57,0,0,1,4,8a.46.46,0,0,1,0-.21V4.6a.4.4,0,0,1,.16-.38c.11,0,.26,0,.42.17L5.6,5.49a5.93,5.93,0,0,1,1.63-1,5.42,5.42,0,0,1,4,.11A5.17,5.17,0,0,1,12.93,5.8a5.48,5.48,0,0,1,1.16,1.73,5.17,5.17,0,0,1,.44,2.12,5,5,0,0,1-.44,2.12,5.54,5.54,0,0,1-2.88,2.91,5.77,5.77,0,0,1-2.13.42,5.39,5.39,0,0,1-1.94-.37,5.36,5.36,0,0,1-2.85-2.48A5.43,5.43,0,0,1,3.67,10.38Z"></path>\n    </g>\n    <path class="${zt.ClassNames.Component}" fill="#fff" d="M3.67,9.88a.25.25,0,0,1,.24-.31L5,9.43a.49.49,0,0,1,.2.05.26.26,0,0,1,.1.2A3.77,3.77,0,0,0,6.56,12,3.87,3.87,0,0,0,9.08,13a3.53,3.53,0,0,0,1.47-.31,3.72,3.72,0,0,0,1.22-.81,4.13,4.13,0,0,0,.82-1.2,3.74,3.74,0,0,0,0-3,3.94,3.94,0,0,0-.82-1.2,3.72,3.72,0,0,0-1.22-.81,3.53,3.53,0,0,0-1.47-.31,3.43,3.43,0,0,0-1.23.22,3.07,3.07,0,0,0-1.09.6L7.85,7.25c.16.14.22.29.16.38s-.18.16-.4.16H4.45a.33.33,0,0,1-.19,0,1,1,0,0,1-.17-.1A.57.57,0,0,1,4,7.47a.46.46,0,0,1,0-.21V4.1a.4.4,0,0,1,.16-.38c.11-.05.26,0,.42.17L5.6,5A5.93,5.93,0,0,1,7.23,4a5.42,5.42,0,0,1,4,.11A5.17,5.17,0,0,1,12.93,5.3,5.48,5.48,0,0,1,14.09,7a5.17,5.17,0,0,1,.44,2.12,5,5,0,0,1-.44,2.12,5.54,5.54,0,0,1-2.88,2.91,5.77,5.77,0,0,1-2.13.42,5.39,5.39,0,0,1-1.94-.37,5.63,5.63,0,0,1-1.65-1,5.59,5.59,0,0,1-1.2-1.5A5.43,5.43,0,0,1,3.67,9.88Z"></path>\n  </g>`,kn=`<g id="threat">\n    <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n    <path class="${zt.ClassNames.Background}" fill="#ec6250" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    <g class="${zt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path d="M15.12,9.65a6.14,6.14,0,0,1-3.78,5.65,6.19,6.19,0,0,1-3.53.35A6.15,6.15,0,0,1,3,10.84,6.11,6.11,0,0,1,9,3.53a6.15,6.15,0,0,1,6.12,6.12ZM5,9.65a4,4,0,0,0,.67,2.22,4.09,4.09,0,0,0,1.79,1.47,4,4,0,0,0,5.22-5.22A4,4,0,0,0,5,9.65Z"></path>\n      <path d="M6.75,9.65a2.24,2.24,0,0,0,.38,1.25,2.27,2.27,0,0,0,1,.83,2.22,2.22,0,0,0,1.3.12,2.22,2.22,0,0,0,1.76-1.76,2.22,2.22,0,0,0-.13-1.3,2.25,2.25,0,0,0-4.32.86Z"></path>\n    </g>\n    <g>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M15.12,9.15a6.14,6.14,0,0,1-3.78,5.65,6.19,6.19,0,0,1-3.53.35A6.15,6.15,0,0,1,3,10.34,6.11,6.11,0,0,1,9,3a6.15,6.15,0,0,1,6.12,6.12ZM5,9.15a4,4,0,0,0,.67,2.22,4.09,4.09,0,0,0,1.79,1.47,4,4,0,0,0,5.22-5.22A4,4,0,0,0,5,9.15Z"></path>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M6.75,9.15a2.24,2.24,0,0,0,.38,1.25,2.27,2.27,0,0,0,1,.83,2.22,2.22,0,0,0,1.3.12A2.22,2.22,0,0,0,11.2,9.59a2.22,2.22,0,0,0-.13-1.3,2.25,2.25,0,0,0-4.32.86Z"></path>\n    </g>\n  </g>`,wn=`<path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n<path class="${zt.ClassNames.Background}" fill="#312e2b" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n<path d="M8.57,7.26,8.11,10l.89.86L9.89,10,9.45,7.26ZM9,12.86A3.35,3.35,0,1,1,12.36,9.5,3.34,3.34,0,0,1,9,12.86Zm.7-8.29V4.12h.82V2.79h-3V4.12H8.3v.45a5,5,0,1,0,1.4,0Z"></path>\n<path class="${zt.ClassNames.ComponentShadow}" fill="#fff" d="M8.57,6.76,8.11,9.48l.89.86.89-.86L9.45,6.76ZM9,12.36A3.35,3.35,0,1,1,12.36,9,3.34,3.34,0,0,1,9,12.36Zm.7-8.29V3.62h.82V2.29h-3V3.62H8.3v.45a5,5,0,1,0,1.4,0Z"></path>`,Tn=`<path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n<circle class="${zt.ClassNames.Background}" fill="#f8f8f8" cx="9" cy="9" r="8.5"></circle>\n<path class="${zt.ClassNames.ComponentShadow}" fill="#e8e8e8" d="M9,1A8,8,0,1,1,1,9,8,8,0,0,1,9,1M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n<path d="M8.57,6.76,8.11,9.48l.89.86.89-.86L9.45,6.76ZM9,12.36A3.35,3.35,0,1,1,12.36,9,3.34,3.34,0,0,1,9,12.36Zm.7-8.29V3.62h.82V2.29h-3V3.62H8.3v.45a5,5,0,1,0,1.4,0Z"></path>`,Pn=`\n  <path\n    class="${zt.ClassNames.Shadow}"\n    d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"\n    opacity=".3"></path>\n  <path\n    class="${zt.ClassNames.Background}"\n    d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"\n    fill="#8a8886"></path>\n  <path\n    d="M3.59,10.23a.25.25,0,0,1,.24-.31l1.08-.15a.49.49,0,0,1,.2.06.25.25,0,0,1,.11.2,3.58,3.58,0,0,0,.42,1.28,3.68,3.68,0,0,0,.84,1.06,3.76,3.76,0,0,0,1.16.69A3.9,3.9,0,0,0,9,13.31,3.58,3.58,0,0,0,10.47,13a3.94,3.94,0,0,0,1.22-.81A4.09,4.09,0,0,0,12.5,11a3.74,3.74,0,0,0,0-3,4.09,4.09,0,0,0-.81-1.2A3.94,3.94,0,0,0,10.47,6,3.65,3.65,0,0,0,9,5.69a3.61,3.61,0,0,0-1.23.21,3.23,3.23,0,0,0-1.09.6L7.77,7.59c.16.15.21.29.16.38s-.18.17-.4.17H4.37a.36.36,0,0,1-.2,0A.76.76,0,0,1,4,8a.52.52,0,0,1-.17-.38V4.45c0-.2.06-.33.17-.38s.25,0,.41.16L5.51,5.34a5.83,5.83,0,0,1,1.64-1A5.19,5.19,0,0,1,9,4.05a5.3,5.3,0,0,1,2.12.44,5,5,0,0,1,1.73,1.16A5.59,5.59,0,0,1,14,7.38a5.23,5.23,0,0,1,.44,2.12A5.16,5.16,0,0,1,14,11.62a5.59,5.59,0,0,1-1.16,1.73,5.32,5.32,0,0,1-1.73,1.18A5.64,5.64,0,0,1,9,15a5.23,5.23,0,0,1-1.94-.37A5.27,5.27,0,0,1,4.21,12.1,5.1,5.1,0,0,1,3.59,10.23Z"\n    class="${zt.ClassNames.ComponentShadow}"\n    opacity=".3"></path>\n  <path\n    d="M3.59,9.73a.25.25,0,0,1,.24-.31l1.08-.15a.49.49,0,0,1,.2.06.25.25,0,0,1,.11.2,3.58,3.58,0,0,0,.42,1.28,3.68,3.68,0,0,0,.84,1.06,3.76,3.76,0,0,0,1.16.69A3.9,3.9,0,0,0,9,12.81a3.58,3.58,0,0,0,1.47-.31,3.94,3.94,0,0,0,1.22-.81,4.09,4.09,0,0,0,.81-1.2,3.74,3.74,0,0,0,0-3,4.09,4.09,0,0,0-.81-1.2,3.94,3.94,0,0,0-1.22-.81A3.65,3.65,0,0,0,9,5.19a3.61,3.61,0,0,0-1.23.21A3.23,3.23,0,0,0,6.68,6L7.77,7.09c.16.15.21.29.16.38s-.18.17-.4.17H4.37a.36.36,0,0,1-.2,0A.76.76,0,0,1,4,7.49a.52.52,0,0,1-.17-.38V4c0-.2.06-.33.17-.38s.25,0,.41.16L5.51,4.84a5.83,5.83,0,0,1,1.64-1A5.19,5.19,0,0,1,9,3.55,5.3,5.3,0,0,1,11.12,4a5,5,0,0,1,1.73,1.16A5.59,5.59,0,0,1,14,6.88,5.23,5.23,0,0,1,14.45,9,5.16,5.16,0,0,1,14,11.12a5.59,5.59,0,0,1-1.16,1.73A5.32,5.32,0,0,1,11.12,14,5.64,5.64,0,0,1,9,14.45a5.23,5.23,0,0,1-1.94-.37A5.27,5.27,0,0,1,4.21,11.6,5.1,5.1,0,0,1,3.59,9.73Z"\n    class="${zt.ClassNames.Component}"\n    fill="#ffffff"></path>\n`,En=`<g id="winner">\n    <g>\n      <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <path class="${zt.ClassNames.Background}" fill="#dbac16" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    </g>\n    <g class="${zt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path class="cls-4" d="M4.35,12.66,2.86,7.72a.37.37,0,0,1,0-.21A.35.35,0,0,1,3,7.34a.31.31,0,0,1,.2-.07.3.3,0,0,1,.21.05L6.27,9.15l.14,0h.14a.31.31,0,0,0,.13-.06A.48.48,0,0,0,6.77,9L8.69,5.54a.4.4,0,0,1,.13-.13.37.37,0,0,1,.18,0,.36.36,0,0,1,.31.18L11.22,9a.52.52,0,0,0,.1.11.31.31,0,0,0,.13.06h.14l.13,0,2.89-1.83a.3.3,0,0,1,.21-.05.31.31,0,0,1,.2.07.35.35,0,0,1,.12.17.37.37,0,0,1,0,.21l-1.49,4.94a.34.34,0,0,1-.13.18.31.31,0,0,1-.21.07H4.69a.31.31,0,0,1-.21-.07A.34.34,0,0,1,4.35,12.66Z"></path>\n    </g>\n    <path class="undefined" fill-rule="evenodd" d="M4.35,12.06,2.86,7.12a.37.37,0,0,1,0-.21A.35.35,0,0,1,3,6.74a.31.31,0,0,1,.2-.07.3.3,0,0,1,.21,0L6.27,8.55l.14,0h.14a.31.31,0,0,0,.13-.06.48.48,0,0,0,.09-.11L8.69,4.94a.4.4,0,0,1,.13-.13.37.37,0,0,1,.18,0,.36.36,0,0,1,.31.18l1.91,3.48a.52.52,0,0,0,.1.11.31.31,0,0,0,.13.06h.14l.13,0,2.89-1.83a.3.3,0,0,1,.21,0,.31.31,0,0,1,.2.07.35.35,0,0,1,.12.17.38.38,0,0,1,0,.21l-1.49,4.94a.34.34,0,0,1-.13.18.31.31,0,0,1-.21.07H4.69a.31.31,0,0,1-.21-.07A.34.34,0,0,1,4.35,12.06Z"></path>\n  </g>`,An=`<g id="winner-white" fill="#fff">\n    <g>\n      <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"></path>\n      <path class="${zt.ClassNames.Background}" fill="#dbac16" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"></path>\n    </g>\n    <g class="${zt.ClassNames.ComponentShadow}" opacity="0.2">\n      <path class="cls-4" d="M4.35,12.66,2.86,7.72a.37.37,0,0,1,0-.21A.35.35,0,0,1,3,7.34a.31.31,0,0,1,.2-.07.3.3,0,0,1,.21.05L6.27,9.15l.14,0h.14a.31.31,0,0,0,.13-.06A.48.48,0,0,0,6.77,9L8.69,5.54a.4.4,0,0,1,.13-.13.37.37,0,0,1,.18,0,.36.36,0,0,1,.31.18L11.22,9a.52.52,0,0,0,.1.11.31.31,0,0,0,.13.06h.14l.13,0,2.89-1.83a.3.3,0,0,1,.21-.05.31.31,0,0,1,.2.07.35.35,0,0,1,.12.17.37.37,0,0,1,0,.21l-1.49,4.94a.34.34,0,0,1-.13.18.31.31,0,0,1-.21.07H4.69a.31.31,0,0,1-.21-.07A.34.34,0,0,1,4.35,12.66Z"></path>\n    </g>\n    <path class="undefined" fill-rule="evenodd" d="M4.35,12.06,2.86,7.12a.37.37,0,0,1,0-.21A.35.35,0,0,1,3,6.74a.31.31,0,0,1,.2-.07.3.3,0,0,1,.21,0L6.27,8.55l.14,0h.14a.31.31,0,0,0,.13-.06.48.48,0,0,0,.09-.11L8.69,4.94a.4.4,0,0,1,.13-.13.37.37,0,0,1,.18,0,.36.36,0,0,1,.31.18l1.91,3.48a.52.52,0,0,0,.1.11.31.31,0,0,0,.13.06h.14l.13,0,2.89-1.83a.3.3,0,0,1,.21,0,.31.31,0,0,1,.2.07.35.35,0,0,1,.12.17.38.38,0,0,1,0,.21l-1.49,4.94a.34.34,0,0,1-.13.18.31.31,0,0,1-.21.07H4.69a.31.31,0,0,1-.21-.07A.34.34,0,0,1,4.35,12.06Z"></path>\n  </g>`,Mn=`<g id="interesting">\n    <path class="${zt.ClassNames.Shadow}" d="m9 .5a9 9 0 1 0 9 9 9 9 0 0 0 -9-9z" opacity="0.3"></path>\n    <path  class="${zt.ClassNames.Background}" d="m0 9a9 9 0 1 0 9-9 9 9 0 0 0 -9 9z" fill="#7979a1"></path>\n    <g  class="${zt.ClassNames.Component}" opacity=".2">\n      <path d="m4.75 12.9a.28.28 0 0 1 0-.13.25.25 0 0 1 .08-.1.33.33 0 0 1 .23-.1h2 .12l.11.08a.36.36 0 0 1 .07.1.59.59 0 0 1 0 .13v1.9a.36.36 0 0 1 -.09.24.27.27 0 0 1 -.1.08h-.13-2-.12a.44.44 0 0 1 -.19-.19.28.28 0 0 1 0-.13zm-.06-8.8a.41.41 0 0 1 .08-.24.35.35 0 0 1 .23-.1h2.14.13l.11.08a.5.5 0 0 1 .09.24l-.15 6.77c0 .21-.15.31-.34.31h-1.78a.3.3 0 0 1 -.2-.06.3.3 0 0 1 -.1-.1.31.31 0 0 1 0-.13z"/><path d="m12.39 14.82a.25.25 0 0 1 0 .12.28.28 0 0 1 -.08.11l-.1.07h-.12-1.91a.27.27 0 0 1 -.13 0 .39.39 0 0 1 -.05-.12.35.35 0 0 1 -.08-.22v-1.78a.32.32 0 0 1 .09-.23l.1-.07h.12 1.89a.33.33 0 0 1 .23.09.61.61 0 0 1 .07.1.27.27 0 0 1 0 .13zm2.2-7.17a2.49 2.49 0 0 1 -.36.73 4.51 4.51 0 0 1 -.48.6 6 6 0 0 1 -.52.49q-.39.34-.66.63a1 1 0 0 0 -.27.7v.2a.22.22 0 0 1 0 .12.35.35 0 0 1 -.17.17.2.2 0 0 1 -.11 0h-1.75-.12a.23.23 0 0 1 -.1-.07.26.26 0 0 1 -.07-.1.22.22 0 0 1 .02-.12v-.35a2.41 2.41 0 0 1 .12-.84 2.91 2.91 0 0 1 .33-.66 3.38 3.38 0 0 1 .45-.55l.49-.42a6.55 6.55 0 0 0 .61-.62 1 1 0 0 0 .26-.67.66.66 0 0 0 -.08-.34.64.64 0 0 0 -.18-.27 1.18 1.18 0 0 0 -.77-.28 1.66 1.66 0 0 0 -.49.07 3 3 0 0 0 -.41.18 2.29 2.29 0 0 0 -.29.18l-.1.09a.53.53 0 0 1 -.24.06c-.12 0-.19-.07-.21-.13l-1-1.21a.29.29 0 0 1 0-.4 1.36 1.36 0 0 1 .21-.2 3 3 0 0 1 .55-.38 5.87 5.87 0 0 1 .9-.37 3.75 3.75 0 0 1 1.2-.17 4.12 4.12 0 0 1 1.2.19 4 4 0 0 1 1.09.56 2.73 2.73 0 0 1 .77.92 2.7 2.7 0 0 1 .29 1.28 2.72 2.72 0 0 1 -.11.98z"/></g><g fill="#fff"><path d="m4.75 12.4a.28.28 0 0 1 0-.13.25.25 0 0 1 .08-.1.33.33 0 0 1 .23-.1h2 .12l.11.08a.36.36 0 0 1 .07.1.59.59 0 0 1 0 .13v1.9a.36.36 0 0 1 -.09.24.27.27 0 0 1 -.1.08h-.13-2-.12a.44.44 0 0 1 -.19-.19.28.28 0 0 1 0-.13zm-.06-8.8a.41.41 0 0 1 .08-.24.35.35 0 0 1 .23-.1h2.14.13l.11.08a.5.5 0 0 1 .09.24l-.15 6.77c0 .21-.15.31-.34.31h-1.78a.3.3 0 0 1 -.2-.06.3.3 0 0 1 -.07-.1.31.31 0 0 1 0-.13z"/><path d="m12.39 14.32a.25.25 0 0 1 0 .12.28.28 0 0 1 -.08.11l-.1.07h-.12-1.91a.27.27 0 0 1 -.13 0 .39.39 0 0 1 -.1-.08.35.35 0 0 1 -.08-.22v-1.83a.32.32 0 0 1 .09-.23l.1-.07h.12 1.89a.33.33 0 0 1 .23.09.61.61 0 0 1 .07.1.27.27 0 0 1 0 .13zm2.2-7.17a2.49 2.49 0 0 1 -.36.73 4.51 4.51 0 0 1 -.48.6 6 6 0 0 1 -.52.49q-.39.34-.66.63a1 1 0 0 0 -.27.7v.22a.22.22 0 0 1 0 .12.35.35 0 0 1 -.17.17.2.2 0 0 1 -.11 0h-1.75-.12a.23.23 0 0 1 -.1-.07.26.26 0 0 1 -.07-.1.22.22 0 0 1 0-.12v-.35a2.41 2.41 0 0 1 .12-.84 2.91 2.91 0 0 1 .33-.66 3.38 3.38 0 0 1 .45-.55l.49-.42a6.55 6.55 0 0 0 .63-.64 1 1 0 0 0 .26-.67.66.66 0 0 0 -.08-.34.64.64 0 0 0 -.18-.27 1.18 1.18 0 0 0 -.73-.24 1.66 1.66 0 0 0 -.49.07 3 3 0 0 0 -.41.18 2.29 2.29 0 0 0 -.37.21l-.1.09a.53.53 0 0 1 -.24.06c-.12 0-.19-.07-.21-.13l-1-1.21a.29.29 0 0 1 0-.4 1.36 1.36 0 0 1 .21-.2 3 3 0 0 1 .55-.38 5.87 5.87 0 0 1 .9-.37 3.75 3.75 0 0 1 1.2-.17 4.12 4.12 0 0 1 1.2.19 4 4 0 0 1 1.16.52 2.73 2.73 0 0 1 .77.92 2.7 2.7 0 0 1 .29 1.28 2.72 2.72 0 0 1 -.14.95z"/>\n    </g>\n  </g>`,xn=`<g id="warning">\n    <g>\n      <g class="${zt.ClassNames.Shadow}" opacity="0.3">\n        <path d="M.32,14.3,6.94,2.83a2.37,2.37,0,0,1,4.11,0L17.68,14.3a2.38,2.38,0,0,1-2.06,3.56H2.38A2.38,2.38,0,0,1,.32,14.3Z"></path>\n      </g>\n      <path class="${zt.ClassNames.Background}" fill="#ec6250" d="M.32,13.8,6.94,2.33a2.37,2.37,0,0,1,4.11,0L17.68,13.8a2.38,2.38,0,0,1-2.06,3.56H2.38A2.38,2.38,0,0,1,.32,13.8Z"></path>\n    </g>\n    <g>\n      <g class="${zt.ClassNames.ComponentShadow}" opacity="0.2">\n        <path d="M10.21,15.19a.5.5,0,0,1,0,.12.26.26,0,0,1-.07.1.31.31,0,0,1-.22.09H8.1a.25.25,0,0,1-.12,0,.31.31,0,0,1-.09-.07.35.35,0,0,1-.08-.22V13.45a.29.29,0,0,1,.09-.21A.22.22,0,0,1,8,13.17l.11,0H9.9a.31.31,0,0,1,.22.09.27.27,0,0,1,.09.21ZM10.1,11.6a.22.22,0,0,1,0,.11.23.23,0,0,1-.07.1.27.27,0,0,1-.21.07H8.18a.29.29,0,0,1-.31-.28L7.73,5.41a.35.35,0,0,1,.08-.22.23.23,0,0,1,.1-.07A.25.25,0,0,1,8,5.1H10a.32.32,0,0,1,.23.09.35.35,0,0,1,.08.22Z"></path>\n      </g>\n      <path class="${zt.ClassNames.Component}" fill="#fff" d="M10.21,14.69a.5.5,0,0,1,0,.12.26.26,0,0,1-.07.1A.31.31,0,0,1,9.9,15H8.1A.25.25,0,0,1,8,15a.31.31,0,0,1-.09-.07.35.35,0,0,1-.08-.22V13a.29.29,0,0,1,.09-.21A.22.22,0,0,1,8,12.67l.11,0H9.9a.31.31,0,0,1,.22.09.27.27,0,0,1,.09.21ZM10.1,11.1a.22.22,0,0,1,0,.11.23.23,0,0,1-.07.1.27.27,0,0,1-.21.07H8.18a.29.29,0,0,1-.31-.28L7.73,4.91a.35.35,0,0,1,.08-.22.23.23,0,0,1,.1-.07A.25.25,0,0,1,8,4.6H10a.32.32,0,0,1,.23.09.35.35,0,0,1,.08.22Z"></path>\n    </g>\n  </g>`,On=`<g id="equal">\n    <path class="${zt.ClassNames.Shadow}" opacity="0.3" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"/>\n    <path class="${zt.ClassNames.Background}" fill="#a88865" d="M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"/>\n    <g class="${zt.ClassNames.ComponentShadow}" opacity="0.4">\n      <path d="M5.31,8.36l-.15,0A.57.57,0,0,1,5,8.25.57.57,0,0,1,5,8.12a.4.4,0,0,1,0-.15V6a.38.38,0,0,1,.39-.39h7.38a.38.38,0,0,1,.39.39V8a.4.4,0,0,1,0,.15.57.57,0,0,1-.08.13.57.57,0,0,1-.13.08l-.15,0Z"/>\n      <path d="M5.31,13.36l-.15,0A.57.57,0,0,1,5,13.25.57.57,0,0,1,5,13.12a.4.4,0,0,1,0-.15V11a.38.38,0,0,1,.39-.39h7.38a.38.38,0,0,1,.39.39V13a.4.4,0,0,1,0,.15.33.33,0,0,1-.21.21l-.15,0Z"/>\n    </g>\n    <g>\n      <path class="${zt.ClassNames.Component}" fill="#f1f2f2" d="M5.31,7.86l-.15,0A.57.57,0,0,1,5,7.75.57.57,0,0,1,5,7.62a.4.4,0,0,1,0-.15V5.53a.38.38,0,0,1,.39-.39h7.38a.38.38,0,0,1,.39.39V7.47a.4.4,0,0,1,0,.15.57.57,0,0,1-.08.13.57.57,0,0,1-.13.08l-.15,0Z"/>\n      <path class="${zt.ClassNames.Component}" fill="#f1f2f2" d="M5.31,12.86l-.15,0A.57.57,0,0,1,5,12.75.57.57,0,0,1,5,12.62a.4.4,0,0,1,0-.15V10.53a.38.38,0,0,1,.39-.39h7.38a.38.38,0,0,1,.39.39v1.94a.4.4,0,0,1,0,.15.33.33,0,0,1-.21.21l-.15,0Z"/>\n    </g>\n  </g>`,Rn={[Ee.Alternative]:Kt,[Ee.BestMove]:Zt,[Ee.Blunder]:Qt,[Ee.Book]:Xt,[Ee.Brilliant]:Yt,[Ee.CheckmateBlack]:Jt,[Ee.CheckmateWhite]:en,[Ee.Correct]:tn,[Ee.Critical]:nn,[Ee.DrawBlack]:rn,[Ee.DrawWhite]:an,[Ee.Excellent]:sn,[Ee.FastWin]:cn,[Ee.Forced]:fn,[Ee.FreePiece]:ln,[Ee.Gamechanger]:un,[Ee.Good]:pn,[Ee.GreatFind]:dn,[Ee.Inaccuracy]:hn,[Ee.Incorrect]:mn,[Ee.Mate]:gn,[Ee.MissedWin]:vn,[Ee.Mistake]:yn,[Ee.ResignBlack]:_n,[Ee.ResignWhite]:bn,[Ee.Sharp]:Cn,[Ee.Takeback]:Sn,[Ee.Threat]:kn,[Ee.TimeoutBlack]:wn,[Ee.TimeoutWhite]:Tn,[Ee.Undo]:Pn,[Ee.Winner]:En,[Ee.WinnerWhite]:An,[Ee.Interesting]:Mn,[Ee.Warning]:xn,[Ee.Equal]:On};function makeSvgIcon({className:e="",path:t="",size:n="24",viewBox:a="0 0 18 19"}){return`\n    <svg xmlns="http://www.w3.org/2000/svg" class="${e}" width="${n}" height="${n}" viewBox="${a}">\n      ${t}\n    </svg>\n  `}function getTuckPosition(e,t){const n={top:t?"1":"8",right:t?"a":"h"};return{top:e.includes(n.top),right:e.includes(n.right)}}function createEffectsMethods({board:e,el:t,options:n}){const a=document.createComment("/Effects");e.addToDom({el:a,insertAfter:!0,type:Dt.HoverSquare});const l=new Map;return{addEffects:function addEffects(f){f.forEach((f=>{const{data:{square:p,type:h},key:m}=f,g=document.createElement("div");g.classList.add("effect"),g.innerHTML=makeSvgIcon({path:Rn[h],size:"100%"}),setPositionBySquare({el:g,square:p}),n.test&&setTestData(g,{[Ft.Element]:$t.Effect,[Ft.Square]:p,[Ft.Type]:h}),function isEdgeSquare(e){if(!e)return!1;let t=!1;return["a","h","1","8"].forEach((n=>{e.includes(n)&&(t=!0)})),t}(p)&&function tuckMarking({square:e,isFlipped:t,effectEl:n}){const a=getTuckPosition(e,t);a.top&&n.classList.add("tuck-top"),a.right&&n.classList.add("tuck-right")}({square:p,isFlipped:e.el.classList.contains("flipped"),effectEl:g});const v=l.get(m);v&&e.el.removeChild(v),t.insertBefore(g,a),l.set(m,g)}))},removeEffects:function removeEffects(t){t.forEach((t=>{const{key:n}=t,a=l.get(n);a&&(e.el.removeChild(a),l.delete(n))}))}}}function createEffectsPlugin(){return{create:e=>function init$1(e){const{api:t,options:n,renderer:a}=e,l=t.markings;null==a||a.extendRenderer(createEffectsMethods);const f=n.allowMarkings?l.getAllWhere({types:[Pe]}):[];null==a||a.addEffects(f,e)}(e),match:[{condition:isMark(Pe),handler:function markEffect(e,t){const{renderer:n}=t,a=e.data.filter(isType(Pe));null==n||n.addEffects(a,t)}},{condition:isUnmark(Pe),handler:function unmarkEffect(e,t){const{renderer:n}=t,a=e.data.filter(isType(Pe));null==n||n.removeEffects(a,t)}},{condition:is(_.InstanceEvents.RendererSet),handler:function init2(e,t){const{api:n,options:a,renderer:l}=t,f=n.markings;null==l||l.extendRenderer(createEffectsMethods);const p=a.allowMarkings?f.getAllWhere({types:[Pe]}):[];null==l||l.addEffects(p,t)}}],name:we.Plugin.Name}}function createFadeSetupPlugin(){return{match:[{condition:isOneOf([_.InstanceEvents.RendererSet,_.APIEvents.Load]),handler:function fadeSetup(e,t){var n;null==(n=null==t?void 0:t.renderer)||n.fadeSetup(t)}}],name:Me.Plugin.Name}}var In,Ln,Nn,Dn,Bn,Fn;function createFlipBoardPlugin(e=In.FlipBoardModifierKey){let t;return{match:[{condition:isOneOf([_.InstanceEvents.Create,_.InstanceEvents.RendererSet,_.OptionsEvents.Update]),handler:function runFlipBoardPlugin(e,n){const{options:a,renderer:l,state:f}=n;if(!l)return;if(a.flipped!==t){l.flipBoard(a.flipped,n);const e=f.get(_.State.PromotionMove);e&&l.openPromotionWindow(e,n)}t=a.flipped}},{condition:is(Nn.Events.Keydown),handler:function onKeydown(t,n){const{api:a,options:l,queue:f}=n;if(t.data!==e)return;f.add(a.setOptions,{flipped:!l.flipped})}}],name:In.Plugin.Name}}function excludeIntersection(e,t,{isDuplicateWhen:n}={}){const a=new Set(e);return t.forEach((t=>{if(function isObject(e){return"[object Object]"===Object.prototype.toString.call(e)}(t)&&n){const l=e.find((e=>n(e,t)));l&&a.delete(l)}else a.delete(t)})),[...a]}function highlightsHaveSameKeyAndColor(e,t){return e.key===t.key&&e.data.color===t.data.color}function createHighlightsAPI(e){return function createAPI2(){return function createHighlights(e){const t=new Set(e),n=new Map;return __spreadProps(__spreadValues({},t),{addModule:function addModule(e){return t.add(e)},getModules:getAllModulesAsArray,removeModule:function removeModule(e){return t.delete(e)},getAll:getAll,update:function update2(...e){const t=getAll();n.clear();const a=Array.from(getAllModulesAsArray().reduce(((t,n)=>(n(...e).forEach((e=>{t.set(e.data.square,e)})),t)),new Map).values());a.forEach((e=>n.set(e.data.square,e)));return{toAdd:excludeIntersection(a,t,{isDuplicateWhen:highlightsHaveSameKeyAndColor}),toRemove:excludeIntersection(t,a,{isDuplicateWhen:highlightsHaveSameKeyAndColor})}}});function getAll(){return Array.from(n.values())}function getAllModulesAsArray(){return Array.from(t)}}(e)}}function isNot(e){return function isType2(t){return e!==t.type}}function createHighlightsPlugin(e){return{api:createHighlightsAPI(e),destroy:function destroy(e){const{api:t,renderer:n}=e,a=t.highlights;null==n||n.removeHighlights(a.getAll(),e)},match:[{condition:isNot(_.UserEvents.Pointermove),handler:function updateHighlights(e,t){const{api:n,renderer:a}=t;if(!a)return;const l=n.highlights,{toAdd:f,toRemove:p}=l.update(e,t);a.removeHighlights(p,t),a.addHighlights(f,t)}}],name:N.Plugin.Name}}function isNotOneOf(e){const t=new Set(Array.isArray(e)?e:Object.values(e));return function isType2(e){return!t.has(e.type)}}function pipeConditions(...e){return function checkMultipleConditions(t,n){return e.every((e=>e(t,n)))}}function createHoverSquarePlugin(){const e=createStateMachine({data:{square:void 0},initialState:"hidden",states:{hidden:{dragPiece:e=>({data:{square:e},nextState:"showing"})},showing:{dragPiece:e=>({data:{square:e},nextState:"showing"}),dropPiece:()=>({nextState:"hidden"}),setOptionToFalse:()=>({nextState:"hidden"})}}});return{match:[{condition:pipeConditions((t=ht.BooleanOptions.HoverSquareOutline,function optionValueIsTruthy(e,n){var a,l;return Boolean(null==(l=null==(a=n.api)?void 0:a.getOptions)?void 0:l.call(a)[t])}),isNotOneOf([_.APIEvents.ClearMarkings,tt.Events.Tick])),handler:function updateHoverSquare(t,n){const{options:a,renderer:l,state:f}=n,p=!0!==f.get(_.State.HideHoverSquare)&&f.get(_.State.MachineState)!==Lt.States.PromotionAreaShowing&&f.get(_.State.DraggingPiece),h=t.data&&(t.data.square||t.data.squareInsideBoard||e.getData().square||p);let m=!1;m=a.highlightMoves?p?e.transition("dragPiece",h):e.transition("dropPiece"):e.transition("setOptionToFalse");if(!m||!l)return;"hidden"===e.getCurrentState()?l.hideHoverSquare(n):l.showHoverSquare(e.getData().square,n)}}],name:Ne.Plugin.Name};var t}function convertMarkingFromJCE(e){const{color:t,data:n,type:a}=e,l=function stringArrayToObject(e){return e.reduce(((e,t,n,a)=>(n%2==0||(e[a[n-1]]=t),e)),{})}(n);Object.keys(l).forEach((e=>{l[e]=decodeURIComponent(l[e])}));const f=l,{persistent:g}=f,v=((e,t)=>{var n={};for(var a in e)h.call(e,a)&&t.indexOf(a)<0&&(n[a]=e[a]);if(null!=e&&p)for(var a of p(e))t.indexOf(a)<0&&m.call(e,a)&&(n[a]=e[a]);return n})(f,["persistent"]),y={key:fromJCEKey(e.key,e.type),node:!0,data:__spreadProps(__spreadValues({},v),{keyPressed:fromJCEColor(t)}),type:a};return void 0!==g&&(y.persistent="true"===g),y}function fromJCEKey(e,t){return`${t}|${e}`}function fromJCEColor(e){switch(e){case Bn.Alt:return lt.Alt;case Bn.Default:return lt.None;case Bn.Shift:return lt.Shift;case Bn.Ctrl:return lt.Ctrl;default:return}}function convertMarkingToJCE(e){const{data:t,persistent:n}=e,a=void 0!==n?__spreadProps(__spreadValues({},t),{persistent:n}):t,l=function toJCEColor(e){switch(e){case lt.Alt:return Bn.Alt;case lt.None:return Bn.Default;case lt.Shift:return Bn.Shift;case lt.Ctrl:return Bn.Ctrl;default:return Bn.Custom}}(t.keyPressed),f=l===Bn.Custom?a:function omit(e,...t){const n=__spreadValues({},e);return t.forEach((e=>{delete n[e]})),n}(a,"color");return Object.keys(f).forEach((e=>{f[e]=encodeURIComponent(f[e])})),{color:l!==Bn.Custom?l:void 0,data:(p=f,Object.entries(p).reduce(((e,[t,n])=>(void 0===n||e.push(t,n.toString()),e)),[])),key:toJCEKey(e),type:e.type};var p}function toJCEKey(e){const{data:{from:t,square:n,to:a},key:l}=e;return n||(t&&a?`${t}${a}`:l)}function getMarkingsFromJCE(e,t){const n=[],a=null!=t?t:e.markings();return Object.values(a).forEach((e=>{Object.values(e).forEach((e=>{n.push(convertMarkingFromJCE(e))}))})),n}function JCENodeHasMarking(e,t,n){const{key:a}=t,l=getMarkingsFromJCE(e,n);return Boolean(l.find((e=>e.key===a)))}(Ln=In||(In={})).FlipBoardModifierKey="x",function(e){e.Name="flip-board"}(Ln.Plugin||(Ln.Plugin={})),function(e){e.Name="keys"}((Dn=Nn||(Nn={})).Plugin||(Dn.Plugin={})),function(e){e.Keydown="Keydown",e.Keyup="Keyup"}(Dn.Events||(Dn.Events={})),(Fn=Bn||(Bn={})).Alt="a",Fn.Ctrl="l",Fn.Custom="c",Fn.Default="d",Fn.Shift="s";const jn=[_.APIEvents.CreateGame,_.APIEvents.DeletePosition,_.APIEvents.Load,_.APIEvents.Move,_.APIEvents.MoveBackward,_.APIEvents.MoveForward,_.APIEvents.MoveVariation,_.APIEvents.PromoteVariation,_.APIEvents.SelectLineEnd,_.APIEvents.SelectLineStart,_.APIEvents.SelectNode,_.APIEvents.Reload,_.APIEvents.ResetToMainLine,_.APIEvents.Undo];function removeFromJCENode(e,t){const n=convertMarkingToJCE(t);e.mark(n,!0)}function createEventHandlers$2(){return[{condition:isOneOf(jn),handler:function handlePositionChange(e,t){const{api:n,queue:a}=t;if(0===e.data.plyDiff)return;a.add((function refreshMarkings(){const{game:e}=n.getContext(),t=n.markings;t.removeAllWhere({node:!0}),t.addMany(getMarkingsFromJCE(e))}))}},{condition:is(_.APIEvents.Mark),handler:function handleMark(e,t){const{api:n}=t,{data:a}=e,{game:l}=n.getContext();(Array.isArray(a)?a:[a]).forEach((e=>{e.node&&!JCENodeHasMarking(l,e)&&function addToJCENode(e,t){const n=convertMarkingToJCE(t);e.mark(n)}(l,e)}))}},{condition:is(_.APIEvents.Unmark),handler:function handleUnmark(e,t){const{api:n}=t,{data:a}=e,{game:l}=n.getContext();(Array.isArray(a)?a:[a]).forEach((e=>{e.node&&JCENodeHasMarking(l,e)&&removeFromJCENode(l,e)}))}}]}function intersection(...e){if(1===e.length)return e[0];const t=new Set;for(const n of e)for(const a of n)e.every((e=>e.has(a)))&&t.add(a);return t}function createTaggedMap({batchCallbacks:e=!0,onEntryAdded:t,onEntryRemoved:n,primaryKey:a="id"}={primaryKey:"id"}){const l=new Map,f=new Map,{flush:p,isBatching:h,stack:m,startBatching:g}=function createStacks(e){let t=!1;const n=new Map;return Object.entries(e).forEach((([e,t])=>{t&&n.set(e,{callback:t,entries:new Set})})),{flush:function flushEntries(){n.forEach((e=>{var n;const a=Array.from(e.entries.values());a.length&&(null==(n=e.callback)||n.call(e,a),e.entries.clear()),t=!1}))},isBatching:()=>t,stack:function stackEntry(e){return function entryModified(t){var a;null==(a=n.get(e))||a.entries.add(t)}},startBatching:function startBatchingEntries(){t=!0}}}({added:t,removed:n});function entryAddedCallback(n){return e&&h()?m("added")(n):null==t?void 0:t(n)}function entryRemovedCallback(t){return e&&h()?m("removed")(t):null==n?void 0:n(t)}return{addOne:addOne,addMany:batch((function addMany(e,t){return e.map(((e,n)=>addOne(e,null==t?void 0:t[n])))})),batch:batch,getAll:function getAll(){return Array.from(l.values())},getManyByTags:function getManyByTags(e,t={}){return getMatchingKeys(e,t).map((e=>l.get(e))).filter((e=>void 0!==e))},getMatchingKeys:getMatchingKeys,getMap:function getMap(){return l},getMany:function getMany(e){return e.map((e=>l.get(e))).filter((e=>void 0!==e))},getOne:function getOne(e){return l.get(e)},removeAll:batch((function removeAll(){for(const[e,t]of l.entries())null==entryRemovedCallback||entryRemovedCallback(t);return l.clear(),f.clear(),!0})),removeMany:batch((function removeMany(e){return e.every(removeOne)})),removeManyByTags:batch((function removeManyByTags(e,t={}){return getMatchingKeys(e,t).every((e=>removeOne(e)))})),removeOne:removeOne};function batch(e){return(...t)=>{g();const n=e(...t);return p(),n}}function addOne(e,t){const n=e[a],p=l.get(n);return p&&(l.delete(n),null==entryRemovedCallback||entryRemovedCallback(p)),null==t||t.forEach((e=>{var t;f.get(e)||f.set(e,new Set),null==(t=f.get(e))||t.add(n)})),l.set(n,e),null==entryAddedCallback||entryAddedCallback(e),n}function getMatchingKeys(e,t={}){const{matchAll:n}=t,a=e.map((e=>f.get(e))).filter((e=>void 0!==e));let l;return l=n?Array.from(intersection(...a)):Array.from(function union(...e){const t=new Set;for(const n of e)for(const e of n)t.add(e);return t}(...a)),l}function removeOne(e){var t;const n=l.get(e);n&&(l.delete(e),null==entryRemovedCallback||entryRemovedCallback(n));const a=f.entries();for(const[l,p]of a)p.has(e)&&p.delete(e),0===(null==(t=f.get(l))?void 0:t.size)&&f.delete(l);return!0}}function isBoardSquare(e){return/^([a-h][1-8])$/.test(e)}function toArray(e){return Array.isArray(e)?e:[e]}function createMarkings({generateKey:e=generatePrimaryKey,onMarkingAdded:t,onMarkingRemoved:n}={}){const a=createTaggedMap({batchCallbacks:!0,onEntryAdded:t,onEntryRemoved:n,primaryKey:"key"});return{addOne:addOne,addMany:function addMany(e){return function addManyWithoutBatching(e){return e.map(addOne)}(e)},getMany:a.getMany,getAll:a.getAll,getAllWhere:function getAllWhere(e={}){return getKeysWhere(e).map((e=>a.getMap().get(e))).filter(Boolean)},getOne:a.getOne,removeAll:a.removeAll,removeAllWhere:function removeAllWhere(e={}){var t;0===(null==(t=e.types)?void 0:t.length)&&(e.types=void 0);return a.removeMany(getKeysWhere(e))},removeOne:a.removeOne,removeMany:a.removeMany,toggleMany:function toggleMany(e){return e.map(toggleOne)},toggleOne:toggleOne};function addOne(e){if(!function markingHasValidSquareOrFromTo(e){const{from:t,square:n,to:a}=e.data,l=n?[n]:[t,a];for(const f of l)if(!isBoardSquare(f))return!1;return!0}(e))return null;const t=function getMarkingTags(e){const{node:t,persistent:n,tags:a=[],type:l}=e;return[t?"node":"board",n?"persistent":"temporary",...a,l]}(e);return a.addOne(withKey(e),t)}function getKeysWhere(e={}){const{node:t,persistent:n,tags:l,types:f}=e;let p,h;void 0!==t&&(p=t?"node":"board"),void 0!==n&&(h=n?"persistent":"temporary");const m=[p,h,l,f].filter((e=>void 0!==e));if(!m.length)return Array.from(a.getMap().keys());const g=m.map(toArray).map((e=>new Set(a.getMatchingKeys(e))));return Array.from(intersection(...g))}function toggleOne(e){const t=withKey(e),n=a.getOne(t.key);return n&&function objectsAreShallowEqual(e,t){const n={a:Object.getOwnPropertyNames(e),b:Object.getOwnPropertyNames(t)};return n.a.length===n.b.length&&n.a.every((n=>e[n]===t[n]))}(n.data,t.data)?a.removeOne(t.key):addOne(t)}function withKey(t){return __spreadProps(__spreadValues({},t),{key:t.key||e(t)})}}function generatePrimaryKey(e){const{data:{from:t,square:n,to:a},type:l}=e;if(!(n||t&&a))throw new Error('Markings that do not have a "square" property must provide a "from" and "to"');return`${l}|${n||`${t}${a}`}`}function createMarkingsAPI(e){const{respond:t}=e;return createMarkings({onMarkingAdded:function onMarkingAdded(e){t(_.APIEvents.Mark,toArray(e))},onMarkingRemoved:function onMarkingRemoved(e){t(_.APIEvents.Unmark,toArray(e))}})}var $n,Hn,Vn,Un,Gn,qn;function createMarkingsPlugin(){return{api:createMarkingsAPI,match:createEventHandlers$2(),name:$n.Plugin.Name}}function createMoveHintsPlugin(){let e=[];return{match:[{condition:isNotOneOf([_.UserEvents.Pointermove,tt.Events.Tick]),handler:updateMoveHints},{condition:is(_.InstanceEvents.RendererSet),handler:function resetMoveHints(t,n){e=[],updateMoveHints(t,n)}}],name:Be.Plugin.Name};function updateMoveHints(t,n){const{renderer:a}=n;a&&(e=function updateHints({addMoveHints:e,addCaptureHints:t,context:n,currentHints:a,getNextHints:l,removeHints:f}){let p=a;const{api:h,mode:m,options:g,state:v}=n;if(!g||!g.highlightLegalMoves||!m.isAllowedToMove())return f([...a],n),p.length=0,p;const y=v.get(_.State.SelectedPiece)||v.get(_.State.DraggingPiece);if(!y)return p.length&&(f(p,n),p=[]),p;const b=v.get(_.State.MachineState)===Lt.States.PromotionAreaShowing?[]:h.getLegalMovesForSquare(y),C=p.filter((e=>!b.includes(e)));f(C,n);const S=l(b),k=[],w=[],T=h.getPieces().keys();return S.forEach((e=>{t&&T.includes(e)?w.push(e):k.push(e)})),k.length&&e(k,n),w.length&&(null==t||t(w,n)),p.filter((e=>!C.includes(e))).concat(S)}({addMoveHints:a.addMoveHints,addCaptureHints:a.addCaptureHints,context:n,currentHints:e,getNextHints:t=>t.filter((t=>!e.includes(t))),removeHints:a.removeHints}))}}function createPiecesPlugin(){return{match:[{condition:isOneOf(_.APIEvents),handler:function updatePieces(e,t){const{renderer:n}=t;if(!n)return;if(e.type===_.APIEvents.IllegalMove)return void n.illegalMove(!1,t);const{plyDiff:a,move:l,pieces:f}=e.data;if(f)return void n.loadPieces({pieces:f},t);if(l&&-1===a)return void("--"!==l.san&&n.undoMove(l,t));l&&n.makeMove(l,t)}},{condition:is(_.InstanceEvents.RendererSet),handler:function reloadPieces(e,t){const{api:n,renderer:a}=t;null==a||a.loadPieces({pieces:n.getPieces()},t)}}],name:je.Plugin.Name}}function createRendererErrorCatcherPlugin(){let e={};return{create:create2,destroy:function destroy(t){const{renderer:n}=t;if(!n)return;Object.keys(e).forEach((t=>{n[t]=e[t]})),e={}},match:[{condition:is(_.InstanceEvents.RendererSet),handler:(e,t)=>create2(t)}],name:Vn.Plugin.Name};function create2(t){const{options:n,renderer:a}=t;a&&!n.test&&["dragPiece","dropPiece","makeMove","removePiece","undoMove"].forEach((n=>{const l=function reloadOnError({context:e,method:t}){return function wrappedRendererMethod(...n){try{return t(...n)}catch(a){const{api:t,renderer:n}=e;console.error("Board position reloaded due to game and renderer state desynchronisation:\n",a),t.logger.log({code:Vn.ErrorCodes.StateDesynchronisation,data:a,level:Ut.Levels.Error}),null==n||n.loadPieces({pieces:t.getPieces(),reloadAll:!0},e)}}}({context:t,method:a[n]});e[n]=a[n],a[n]=l}))}}function createScrollThroughMovesPlugin(){let e;return{create:create2,match:[{condition:is(_.InstanceEvents.RendererSet),handler:function handleRendererChange(e,t){create2(t)}}],destroy:destroy,name:Gn.Plugin.Name};function create2(t){const{api:n,el:a}=t;destroy(t),e||(e=function createHandleOnWheel(e){return function onWheel(t){t.preventDefault(),t.deltaY<0?e.moveBackward():e.moveForward()}}(n)),a.addEventListener("wheel",e)}function destroy(t){const{el:n}=t;n.removeEventListener("wheel",e)}}(function(e){e.Name="markings"})((Hn=$n||($n={})).Plugin||(Hn.Plugin={})),((Un=Vn||(Vn={})).ErrorCodes||(Un.ErrorCodes={})).StateDesynchronisation="StateDesynchronisation",function(e){e.Name="rendererErrorCatcher"}(Un.Plugin||(Un.Plugin={})),function(e){e.Name="scroll-through-moves"}((qn=Gn||(Gn={})).Plugin||(qn.Plugin={}));const Wn={enPassant:"https://www.chess.com/article/view/how-to-capture-en-passant",soundsDefault:"https://www.chess.com/bundles/web/sounds",soundsTheme:"https://images.chesscomfiles.com/chess-themes/sounds/",webglAssetPaths:"__CHESSCOM_WEBGL_ASSET_PATHS__",webglDataUrl:"https://betacssjs.chesscomfiles.com/bundles/web/images/webgl_data",webglDataUrlDev:"static/webgl_data"};function getThemeUrls(e,t){return["webm","ogg","mp3","wav"].map((n=>function getThemeUrl({theme:e="default",type:t,format:n}){return`${Wn.soundsTheme}_${n.toUpperCase()}_/${e}/${t}.${n}`}({format:n,theme:e,type:t})))}const zn=["mousedown","keydown","touchstart","touchend"];let Kn=!1;const Zn=window.chesscom||{},Qn=window.AudioContext||window.webkitAudioContext;let Xn=Boolean(Qn);function isSuspended(){return Xn}function resumeAudio(e){if(Qn){if(Zn.audioContext||(Zn.audioContext=function newAudioContext(){try{return new Qn}catch(e){return null}}()),!Zn.audioContext||!Zn.audioContext.resume)return Xn=!1,void e();Zn.audioContext.resume().then((()=>{Xn=!1,e()}))}}class Sound{constructor(e,t){this.tags=[],this.assets=e,this.maxTags=t}load(){this.unload(),this.addTag()}addTag(){const e=document.createElement("audio");e.setAttribute("preload","auto"),this.assets.forEach((t=>{const n=t.split(".").pop(),a="mp3"===n?"audio/mpeg":`audio/${n}`,l=document.createElement("source");l.setAttribute("src",t),l.setAttribute("type",a),e.appendChild(l)})),document.body.appendChild(e),e.pause&&e.pause(),this.tags.push(e)}unload(){for(;this.tags.length;){const e=this.tags.shift();(null==e?void 0:e.parentNode)&&e.parentNode.removeChild(e)}}play(){const e=this.tags.find((e=>e.paused||e.ended));if(!e){if(this.tags.length>=this.maxTags)return;return this.addTag(),void this.play()}const t=e.play();t&&t.catch((()=>{}))}}var Yn,Jn;(Jn=Yn||(Yn={})).Suspended="web-ui-sound-suspended",Jn.Enabled="web-ui-sound-enabled";let er=0,tr=!1;function whenEnabled(e){!function waitMessage(e,t){window.addEventListener("message",(function listener(n){var a;(null===(a=null==n?void 0:n.data)||void 0===a?void 0:a.key)===e&&(t(),window.removeEventListener("message",listener))}))}(Yn.Enabled,e)}function enableSound(){isSuspended()&&resumeAudio((()=>{window.postMessage({key:Yn.Enabled},window.location.origin),function removeWindowEvents(e){Kn&&(Kn=!1,zn.forEach((t=>window.removeEventListener(t,e))))}(enableSound)}))}function loadSound(e,t=5){const n=new Sound(e,t);return isSuspended()?(!function addWindowEvents(e){Kn||(Kn=!0,zn.forEach((t=>window.addEventListener(t,e))))}(enableSound),whenEnabled((()=>n.load()))):n.load(),n}const nr=[ze.BoardSounds.GameStart,ze.BoardSounds.GameEnd,ze.BoardSounds.Capture,ze.BoardSounds.Castle,ze.BoardSounds.Premove,ze.BoardSounds.MoveSelf,ze.BoardSounds.MoveCheck,ze.BoardSounds.MoveOpponent,ze.BoardSounds.Promote,ze.BoardSounds.Notify,ze.BoardSounds.TenSeconds,ze.BoardSounds.Illegal];function createSounds(e){let t,n=nr,a="default";e&&(n=e.codes,a=e.theme);let l=a;return load2({codes:n,theme:a}),{destroy:function destroy(){Object.keys(t).forEach((e=>{t[e].unload()}))},getSounds:function getSounds(){return t},getTheme:function getTheme2(){return l},load:load2,loadExtra:function loadExtra(e){const n=e.codes.reduce(((t,n)=>(t[n]=loadSound(function getExtraSoundUrls(e,t){return["webm","ogg","mp3","wav"].map((n=>`${e}/${n}/${t}.${n}`))}(e.baseURL,n)),t)),{});Object.keys(n).forEach((e=>{var a;null==(a=t[e])||a.unload(),t[e]=n[e]})),enableSound()},play:function play(e){const n=t[e];if(!n)return null;try{return function playSound(e){isSuspended()?!tr&&er>3?(er=0,tr=!0,window.postMessage({key:Yn.Suspended},window.location.origin)):tr||(er++,enableSound(),whenEnabled((()=>e.play()))):e.play()}(n)}catch(a){return null}}};function load2(e){l=e.theme,t=(e.codes||nr).reduce(((e,t)=>(e[t]=loadSound(getThemeUrls(l,t),ze.maxTagsPerSound),e)),{}),enableSound()}}var rr,ir,ar,sr;function isCapture(e){return void 0!==e.flags&&(Boolean(1==(1&e.flags))||e.flags===rr.Move.Flags.EPCapture)}function isCastle(e){return e.flags===rr.Move.Flags.AnyCastle||e.flags===rr.Move.Flags.KingsideCastle||e.flags===rr.Move.Flags.QueensideCastle}function isPromotion(e){return e.flags===rr.Move.Flags.Promotion||e.flags===rr.Move.Flags.CapturePromotion}function createSoundsPlugin(e){let t=e;return{api:()=>({getSoundsInstance:()=>t}),match:[{condition:isNot(_.UserEvents.Pointermove),handler:function runPlaySoundPlugin(e,n){var a;if(!t)return;const{api:l,options:f,state:p}=n;if(e.type===_.OptionsEvents.Update&&f.soundTheme!==t.getTheme())return t.destroy(),void t.load({theme:f.soundTheme});if(e.type===_.SoundEvents.Play)return t.play(e.data.sound),void p.set({soundPlayed:e.data.sound});if(!f.playSounds||!(null==(a=e.data)?void 0:a.plyDiff))return;let h=l.getSelectedNode();e.type===_.APIEvents.MoveBackward&&(h=e.data.move);if(!h)return;const m=l.getPlayingAs(),g=Boolean(m&&m!==h.color),v=function getSoundType(e,t){if(!e||!e.san)return null;let n;return n=function isCheck(e){return!(!e||!e.san)&&["+","#"].includes(e.san.slice(-1))}(e)?ze.BoardSounds.MoveCheck:e.isPremove?ze.BoardSounds.Premove:isPromotion(e)?ze.BoardSounds.Promote:isCapture(e)?ze.BoardSounds.Capture:isCastle(e)?ze.BoardSounds.Castle:t?ze.BoardSounds.MoveOpponent:ze.BoardSounds.MoveSelf,n}(h,g);v&&(t.play(v),p.set({soundPlayed:v}))}}],name:ze.Plugin.Name,create:function create2(e){t||(t=createSounds({theme:e.options.soundTheme}))}}}!function(e){var t;let n;var a,l,f,p,h,m,g,v,y,_,b,C,S,k,w,T,P;(t=e.ColorsAsNumbers||(e.ColorsAsNumbers={}))[t.White=1]="White",t[t.Black=2]="Black",(a=n=e.Variants||(e.Variants={})).Bughouse="bughouse",a.Chess="chess",a.Chess960="chess960",a.Crazyhouse="crazyhouse",a.KingOfTheHill="kingofthehill",a.ThreeCheck="threecheck",e.JCEVariantTypes={[n.Bughouse]:"Bughouse",[n.Chess]:"Chess",[n.Chess960]:"Chess960",[n.Crazyhouse]:"Crazyhouse",[n.ThreeCheck]:"3-check",[n.KingOfTheHill]:"King of the Hill"},(l=e.ColorsAsLetters||(e.ColorsAsLetters={})).White="w",l.Black="b",(f=e.ColorsAsWords||(e.ColorsAsWords={})).White="white",f.Black="black",e.DefaultTimeControl=5,(p=e.EmptyPGNHeaders||(e.EmptyPGNHeaders={})).Black="?",p.Event="?",p.Date="????.??.??",p.Site="?",p.Value="?",p.Result="*",p.Round="?",p.White="?",h=e.Move||(e.Move={}),(m=h.Flags||(h.Flags={}))[m.Capture=1]="Capture",m[m.BigPawn=2]="BigPawn",m[m.EPCapture=4]="EPCapture",m[m.AnyCapture=5]="AnyCapture",m[m.Promotion=8]="Promotion",m[m.CapturePromotion=9]="CapturePromotion",m[m.KingsideCastle=16]="KingsideCastle",m[m.QueensideCastle=32]="QueensideCastle",m[m.AnyCastle=48]="AnyCastle",m[m.Drop=64]="Drop",m[m.DropOrCapture=69]="DropOrCapture",m[m.DropOrPromote=72]="DropOrPromote",function(e){e[e.Capture=0]="Capture",e[e.Castle=1]="Castle",e[e.Check=2]="Check",e[e.Checkmate=3]="Checkmate",e[e.Normal=4]="Normal",e[e.Premove=5]="Premove",e[e.Promotion=6]="Promotion"}(h.Types||(h.Types={})),g=e.Node||(e.Node={}),v=g.Marking||(g.Marking={}),function(e){!function(e){e.Arrows="arrows",e.Effects="effects",e.Pieces="pieces"}(e.Targets||(e.Targets={})),function(e){e.Above="above",e.Below="below"}(e.Positions||(e.Positions={}))}((y=v.CustomItem||(v.CustomItem={})).VisualOrder||(y.VisualOrder={})),(_=y.Types||(y.Types={})).Image="Image",_.Star="Star",_.TextBox="TextBox",(b=v.ColorKeys||(v.ColorKeys={})).alt="a",b.custom="c",b.default="d",b.shift="s",b.ctrl="l",(C=v.JCEColorsMap||(v.JCEColorsMap={})).a="alt",C.c="custom",C.d="default",C.s="shift",C.l="ctrl",function(e){e.Arrow="arrow",e.Effect="effect",e.Square="square",e.CustomItem="customItem"}(v.Types||(v.Types={})),S=e.Piece||(e.Piece={}),(k=S.Names||(S.Names={})).p="pawn",k.n="knight",k.b="bishop",k.r="rook",k.q="queen",k.k="king",function(e){e.Pawn="p",e.Knight="n",e.Bishop="b",e.Rook="r",e.Queen="q",e.King="k"}(S.Types||(S.Types={})),w=e.Highlight||(e.Highlight={}),(T=w.Defaults||(w.Defaults={})).Color="#ffff00",T[T.Opacity=.5]="Opacity",function(e){e.Analysis="analysis",e.Move="move",e.Premove="premove",e.Selection="selection"}(w.Types||(w.Types={})),function(e){e.Blitz="blitz",e.Bullet="bullet",e.Rapid="rapid"}(e.TimeControlTypes||(e.TimeControlTypes={})),(P=e.Results||(e.Results={})).Black="0-1",P.Draw="1/2-1/2",P.None="*",P.White="1-0"}(rr||(rr={})),ar=ir||(ir={}),(sr=ar.Modifiers||(ar.Modifiers={})).Shift="Shift",sr.Control="Control",sr.Alt="Alt",sr.Meta="Meta";const cr=["Escape","Tab","Backspace","Enter","Backlash","Period","Slash","Comma","Space","Delete","Home","End","PageUp","PageDown","ArrowDown","ArrowUp","ArrowLeft","ArrowRight"],lr=[ir.Modifiers.Meta.toLowerCase(),ir.Modifiers.Alt.toLowerCase(),ir.Modifiers.Control.toLowerCase()];function convertCodeToKey(e){let t;return e.includes("Digit")?t=e.replace("Digit",""):e.includes("Numpad")?t=e.replace("Numpad",""):e.includes("Key")?t=e.replace("Key",""):e.includes(ir.Modifiers.Control)?t=ir.Modifiers.Control:e.includes(ir.Modifiers.Shift)?t=ir.Modifiers.Shift:e.includes(ir.Modifiers.Alt)?t=ir.Modifiers.Alt:e.includes(ir.Modifiers.Meta)?t=ir.Modifiers.Meta:cr.includes(e)&&(t=e),null==t?void 0:t.toLowerCase()}function createKeysService({onKeydown:e,onKeyup:t}={}){let n=!0;const a=new Set;return document.addEventListener("keydown",onKeydownHandler),document.addEventListener("keyup",onKeyupHandler),window.addEventListener("blur",clearPressedKeys),window.addEventListener("contextmenu",clearPressedKeys),{isPressed:function isPressed(e){return a.has(e.toLowerCase())},getPressedKeys:function getPressedKeys(){return[...a].sort()},disable:function disable(){n=!1,a.clear()},enable:function enable(){n=!0},destroy:function destroy(){document.removeEventListener("keydown",onKeydownHandler),document.removeEventListener("keyup",onKeyupHandler),window.removeEventListener("blur",clearPressedKeys),window.removeEventListener("contextmenu",clearPressedKeys),a.clear()}};function onKeydownHandler(t){const l=document.activeElement;if(!n||function isElementBlacklisted(e){return Boolean(!e||e.isContentEditable||["INPUT","TEXTAREA"].includes(e.tagName))}(l))return;const f=convertCodeToKey(t.code);f&&(a.add(f),null==e||e(f))}function onKeyupHandler(e){const n=convertCodeToKey(e.code);n&&(lr.includes(n)&&a.clear(),a.delete(n),null==t||t(n))}function clearPressedKeys(){a.clear()}}function createCoreEvent(e,t){return{data:t||{},type:e}}function createKeysPlugin(){let e;const t=createKeysService({onKeydown:createEmitter(Nn.Events.Keydown),onKeyup:createEmitter(Nn.Events.Keyup)}),n={[Nn.Events.Keydown]:{},[Nn.Events.Keyup]:{}};return{api:()=>({isPressed:t.isPressed,getPressedKeys:t.getPressedKeys,setCallbacks:setCallbacks,removeCallbacks:removeCallbacks}),create:function create2(t){e=t.run},destroy:function destroy(){t.destroy()},match:[{condition:is(_.OptionsEvents.Update),handler:function updateKeysPlugin(e,n){const{options:a}=n;a.captureKeyStrokes?t.enable():t.disable()}},{condition:is(Nn.Events.Keydown),handler:queueKeyCallback},{condition:is(Nn.Events.Keyup),handler:queueKeyCallback}],name:Nn.Plugin.Name};function createEmitter(t){return function emit(n){null==e||e(createCoreEvent(t,n))}}function queueKeyCallback(e,t){const{type:a,data:l}=e,f=n[a][l];f&&t.queue.add(f(t.api))}function setCallbacks(e){e.forEach((({key:e,callback:t,trigger:a=Nn.Events.Keydown})=>{n[a][e]=t}))}function removeCallbacks(e){e.forEach((({trigger:e=Nn.Events.Keydown,key:t})=>{delete n[e][t]}))}}function createKeyedHighlight({color:e,type:t,opacity:n,square:a,turn:l}){return{data:{color:e,opacity:n,square:a,turn:l,type:t},key:`${t}|${a}`,type:"highlight"}}function getHighlightColorFromKeyPressed(e,t){switch(e){case lt.Alt:return t.analysisHighlightColors.alt;case lt.Ctrl:return t.analysisHighlightColors.ctrl;case lt.Shift:return t.analysisHighlightColors.shift;case lt.None:return t.analysisHighlightColors.default;default:return}}function getAnalysisHighlights(e,t){const{api:n,options:a}=t;return a&&a.allowMarkings?n.markings.getAllWhere({types:[F]}).map((({data:{color:e,keyPressed:t,opacity:n,square:l}})=>{var f,p;return createKeyedHighlight({color:null!=(p=null!=(f=getHighlightColorFromKeyPressed(t,a))?f:e)?p:a.analysisHighlightColors.default,opacity:null!=n?n:a.analysisHighlightOpacity,square:l,type:"analysis"})})):[]}function isLine(e){return void 0!==e.id}const ur=["wp","wn","wb","wr","wq","wk","bp","bn","bb","br","bq","bk"],dr={"8_bit":["#6a9b41","#f3f3f4","8_bit",".png","#ffff00"],bases:["#c26b38","#efcca1","bases",".jpg","#f5cc2a"],blackwhite:["#667188","#282f3f","translucent",".png","#5b91b3"],blue:["#4D6D92","#ECECD7","blue",".png","#00a5ff"],brown:["#B58863","#F0D9B5","brown",".png","#ffff00"],bubblegum:["#f9cdd3","#fff3f3","bubblegum",".png","#de5d6f"],burled_wood:["#895132","#d9b088","burled_wood",".jpg","#ee9016"],dark_wood:["#8d675e","#e7cdb2","dark_wood",".jpg","#cc9122"],dash:["#6b3a27","#bd9257","dash",".jpg","#eca722"],default:["#779952","#edeed1","green",".png","#ffff00"],glass:["#282f3f","#667188","glass",".png","#5b91b3"],graffiti:["#b96f18","#aeaeae","graffiti",".jpg","#f39011"],green:["#779952","#edeed1","green",".png","#ffff00"],grey:["#aaaaaa","#dcdcdc","light",".png","#a4b8c4"],icy_sea:["#7a9db2","#c5d5dc","icy_sea",".jpg","#5ed7f1"],light:["#aaaaaa","#dcdcdc","light",".png","#a4b8c4"],lolz:["#909898","#e0e9e9","lolz",".jpg","#a3becd"],marble:["#706b66","#c7bdaa","marble",".jpg","#f0db86"],marbleblue:["#c2d7e2","#efefef","marbleblue",".jpg","#65daf7"],marblebrown:["#b96f18","#aeaeae","graffiti",".jpg","#f39011"],marblegreen:["#706b66","#c7bdaa","marblegreen",".jpg","#f0db86"],metal:["#6e6e6e","#c9c9c9","metal",".jpg","#a3becd"],natural:["#D08B18","#FCE4B2","tan",".png","#f0e464"],nature:["#8c976e","#c3d1a4","translucent",".png","#eef396"],neon:["#636363","#b9b9b9","neon",".png","#6d90a6"],newspaper:["#5a5956","#5a5956","newspaper",".jpg","#99976e"],orange:["#D08B18","#FCE4B2","orange",".png","#ffff00"],overlay:["#789ebd","#4878a0","overlay",".png","#0d9acf"],parchment:["#B58863","#F0D9B5","parchment",".jpg","#d8cc66"],pink:["#f9cdd3","#fff3f3","bubblegum",".png","#de5d6f"],purple:["#8877B7","#EFEFEF","purple",".png","#7dacc9"],red:["#BA5546","#F0D8BF","red",".png","#f8f893"],sand:["#b8a590","#e5d3c4","sand",".jpg","#e2bc87"],sky:["#c2d7e2","#efefef","sky",".png","#65daf7"],stone:["#666463","#c8c3bd","stone",".jpg","#36525f"],tan:["#D08B18","#FCE4B2","tan",".png","#f7d84a"],tournament:["#316549","#ebece8","tournament",".jpg","#a4c25b"],translucent:["#667188","#282f3f","translucent",".png","#5b91b3"],walnut:["#835f42","#c0a684","walnut",".jpg","#d1a52d"],winboard:["#316549","#ebece8","tournament",".jpg","#a4c25b"],wood:["#8d675e","#e7cdb2","dark_wood",".jpg","#cc9122"],wooddark:["#895132","#d9b088","burled_wood",".jpg","#ee9016"],woodlight:["#B58863","#F0D9B5","parchment",".jpg","#d8cc66"],woodmid:["#8d675e","#e7cdb2","dark_wood",".jpg","#cc9122"],woodolive:["#6e6e6e","#c9c9c9","woodolive",".jpg","#a3becd"]},fr={"3d_staunton":{format:"png",isPseudo3d:!0,path:"3d_staunton"},"3dchesskid":{format:"png",isPseudo3d:!0,path:"3d_chesskid"},"3dplastic":{format:"png",isPseudo3d:!0,path:"3d_plastic"},"3dwood":{format:"png",isPseudo3d:!0,path:"3d_wood"},"8_bit":{format:"png",path:"8_bit"},alpha:{format:"png",path:"alpha"},bases:{format:"png",path:"bases"},blindfold:{format:"png",path:"blindfold"},book:{format:"png",path:"book"},bubblegum:{format:"png",path:"bubblegum"},cases:{format:"png",path:"cases"},classic:{format:"png",path:"classic"},club:{format:"png",path:"club"},condal:{format:"png",path:"condal"},dash:{format:"png",path:"dash"},game_room:{format:"png",path:"game_room"},glass:{format:"png",path:"glass"},gothic:{format:"png",path:"gothic"},graffiti:{format:"png",path:"graffiti"},icy_sea:{format:"png",path:"icy_sea"},light:{format:"png",path:"light"},lolz:{format:"png",path:"lolz"},marble:{format:"png",path:"marble"},maya:{format:"png",path:"maya"},metal:{format:"png",path:"metal"},modern2:{format:"png",path:"modern"},nature:{format:"png",path:"nature"},neo:{format:"png",path:"neo"},neo_wood:{format:"png",path:"neo_wood"},neon:{format:"png",path:"neon"},newspaper:{format:"png",path:"newspaper"},ocean:{format:"png",path:"ocean"},real3d:{format:"png",path:"neo"},sky:{format:"png",path:"sky"},space:{format:"png",path:"space"},tigers:{format:"png",path:"tigers"},tournament:{format:"png",path:"tournament"},vintage:{format:"png",path:"vintage"},wood:{format:"png",path:"wood"}};function getTheme(e){const t=dr[e];if(!t)return null;const[n,a,l,f,p]=t;return{darkSquareColor:n,lightSquareColor:a,path:l,extension:f,highlightColor:p}}const pr="move";function getMoveHighlights(e,t){const{api:n,options:a}=t,l=[];if(!a||!a.highlightMoves)return l;const f=n.getSelectedNode();return!f||isLine(f)||[f.from,f.to].forEach((e=>{var t,n,p;if(!e)return;const h=createKeyedHighlight({color:null!=(p=null!=(n=a.highlightColor)?n:null==(t=getTheme(a.boardStyle))?void 0:t.highlightColor)?p:ht.HighlightColors.Selected,opacity:a.highlightOpacity,square:e,turn:f.color,type:pr});l.push(h)})),l}function getSelectionSquare(e,t){var n,a;const{options:l,state:f}=t;if(!l||!l.highlightMoves)return[];const p=f.get(_.State.SelectedPiece)||f.get(_.State.DraggingPiece);if(!p)return[];return[createKeyedHighlight({color:null!=(a=null==(n=getTheme(l.boardStyle))?void 0:n.highlightColor)?a:ht.HighlightColors.Selected,opacity:l.highlightOpacity,square:p,type:"SelectionHiglight"})]}class Store{constructor(e="keyval-store",t="keyval"){this.storeName=t,this._dbp=new Promise(((n,a)=>{const l=indexedDB.open(e,1);l.onerror=()=>a(l.error),l.onsuccess=()=>n(l.result),l.onupgradeneeded=()=>{l.result.createObjectStore(t)}}))}_withIDBStore(e,t){return this._dbp.then((n=>new Promise(((a,l)=>{const f=n.transaction(this.storeName,e);f.oncomplete=()=>a(),f.onabort=f.onerror=()=>l(f.error),t(f.objectStore(this.storeName))}))))}}let hr;function getDefaultStore(){return hr||(hr=new Store),hr}function get(e,t=getDefaultStore()){let n;return t._withIDBStore("readonly",(t=>{n=t.get(e)})).then((()=>n.result))}function set(e,t,n=getDefaultStore()){return n._withIDBStore("readwrite",(n=>{n.put(t,e)}))}let mr;const gr="IS_POPULATED",vr="VERSION";function getDB(){return mr}async function initDB({ecoPath:e,http:t}){const n="0d4797b6b8a20d1546c98f8c37c24593",a=await async function storeIsPopulated(){return get(gr,mr).then(Boolean)}(),l=await async function getVersion(){return get(vr,mr).then(String)}();if(!a||!l||l!==n)return function setVersion(e){return set(vr,e,mr)}(n),async function populateStore({ecoPath:e,http:t}){return t.get(e).then((e=>{var t,n;!function setMany(e,t){return t._withIDBStore("readwrite",(t=>{e.forEach((e=>{t.put(e,e.f)}))}))}(null!=(n=(null==(t=null==e?void 0:e.data)?void 0:t.positions)?e.data.positions:e.data)?n:e,mr)}))}({ecoPath:e,http:t}).then(setPopulated)}function setPopulated(){return set(gr,!0,mr)}async function getECO({ecoPath:e,fens:t,http:n}){const a=function formatFENsForECOLookup(e){return e.reverse().map((e=>e.split(" ").slice(0,3).join(" ")))}(t);await initDB({ecoPath:e,http:n});return(await function getECOValuesFromDB(e){return Promise.all(e.map((e=>get(e,getDB()))))}(a)).find(Boolean)}var yr,_r;(yr||(yr={})).ECO="chesscom_eco",(_r||(_r={})).ECO="eco";const br={get:e=>fetch(e,{method:"GET"}).then((e=>e.json()))};function createEcoPlugin({ecoPath:e="",http:t=br,storeData:n={name:yr.ECO,table:_r.ECO}}={}){if(!("indexedDB"in window))return{name:Ce.Name};return{api:n=>function createECOAPI(e,t){let n;return{get:()=>n,update:async function update2(){const{api:a,respond:l}=e;n=await getECO(__spreadProps(__spreadValues({},t),{fens:a.getHistoryFENs()})),l(Ce.Events.Update,n)}}}(n,{ecoPath:e,http:t}),create:function create2(e){getDB()||function createDB({name:e,table:t}){mr=new Store(e,t)}(__spreadValues({},n)),updateECO(null,e)},match:[{condition:isOneOf(jn),handler:updateECO}],name:Ce.Name};function updateECO(e,t){t.api.eco.update()}}function createCancelPremoves(e,t){return function cancelPremoves(...n){e.premoves.cancel(),t(...n)}}function createPremoveAPIOverrides(){return{agreeDraw:({api:e})=>createCancelPremoves(e,e.agreeDraw),deletePosition:({api:e})=>createCancelPremoves(e,e.deletePosition),getLegalMovesForSquare:({api:e})=>function createGetLegalMovesForSquare$2(e){const t=e.getLegalMovesForSquare;return function getLegalMovesForSquare(n){return e.getPlayingAs()!==e.getTurn()?e.premoves.getLegalMovesForSquare(n):t(n)}}(e),getMove:({api:e})=>function createGetMove$4(e){const t=e.getMove;return function getMove(n){return e.getPlayingAs()!==e.getTurn()?e.premoves.getMove(n):t(n)}}(e),getPieces:({api:e})=>function createGetPieces$2(e){const t=e.getPieces;return function getPieces(){return e.premoves.getQueue().length?e.premoves.getPieces():t()}}(e),load:({api:e})=>function createReloadPremoves(e,t){return function reloadPremoves(...n){var a;e.premoves.cancel();const l=null==(a=n[0])?void 0:a.premoves;if(l){const t=e.getContext().game;l.forEach((e=>{t.premove.move(e)})),e.premoves.loadQueue(l),n[0].pieces=e.premoves.getPieces()}t(...n)}}(e,e.load),move:({api:e})=>function createMove$9(e){const t=e.move;return function move(n){const{respond:a}=e.getContext();if(e.getPlayingAs()===e.getTurn())return t(n);if(n.userGenerated)return e.premoves.move(n);const l=e.premoves.getQueue().length>0;l&&e.premoves.reload();const f=t(n);return l&&a(_.APIEvents.SetBoardPosition,{pieces:e.premoves.getPieces(),holdSelectedPiece:!0}),f}}(e),moveBackward:({api:e})=>createCancelPremoves(e,e.moveBackward),moveForward:({api:e})=>createCancelPremoves(e,e.moveForward),outOfTime:({api:e})=>createCancelPremoves(e,e.outOfTime),resign:({api:e})=>createCancelPremoves(e,e.resign),selectLineEnd:({api:e})=>createCancelPremoves(e,e.selectLineEnd),selectLineStart:({api:e})=>createCancelPremoves(e,e.selectLineStart),selectNode:({api:e})=>createCancelPremoves(e,e.selectNode),undo:({api:e})=>createCancelPremoves(e,e.undo)}}function isAllowedToMoveInPlayingMode({api:e,canMoveWhenNotPlayerTurn:t,modeOptions:n}){const{canAddMovesToMainLine:a,canMoveWhenGameIsOver:l,canModifyExistingMovesOnMainLine:f}=n;return Boolean((l||!e.isGameOver())&&(a&&e.isAtEndOfLine()||f)&&(t||e.getPlayingAs()===e.getTurn()))}function createIsAllowedToMove(e,t){return function isAllowedToMove(){return isAllowedToMoveInPlayingMode({api:t,canMoveWhenNotPlayerTurn:!0,modeOptions:e.getOptions()})}}function createCancel(e){return function cancel(){const{api:t,game:n}=e;return t.premoves.getQueue().length?(n.premove.cancel(),t.reload()):null}}function setTimestampOnNode({api:e,node:t,timestamp:n}){var a;const{game:l,respond:f}=e.getContext(),{line:p,move:h}=t.ids;if(null===n)return(null==(a=t.commands)?void 0:a.timestamp)&&delete t.commands.timestamp,f(_.APIEvents.NodeUpdated,{changes:{timestamp:n,node:t}});t.commands||(t.commands={}),l.updateNode({commands:Object.assign(t.commands,{timestamp:`${n}`})},h,p)}function millisecondsToDeciseconds(e){return Math.round(e/100)}function isNode(e){return void 0!==(null==e?void 0:e.ids)}function getPreviousNodeOfSameColor({api:e,node:t}){const n=e.getNodeByIds({move:t.ids.move-2,line:t.ids.line});return isNode(n)?n:null}function addTimeToConsumedPremove({api:e,timeControl:t}){const n=e.getLine(0);if(!n)return null;const a=n[n.length-1],l=getPreviousNodeOfSameColor({api:e,node:a}),{baseTime:f,increment:p}=t,h=function getGameTimeLeft({baseTime:e,increment:t,lastNodeTime:n}){return getStartingTime()-1;function getStartingTime(){return n?n+t:e}}({baseTime:millisecondsToDeciseconds(f),increment:millisecondsToDeciseconds(p),lastNodeTime:null==l?void 0:l.time});return h&&a&&(a.time=h),h}function createConsumeNext(e){return function consumeNext(){const{api:t,game:n,mutateGame:a}=e;if(!t.premoves.getQueue().length)return null;if(t.isGameOver())return t.premoves.cancel();t.premoves.reload();const l=a((function consume(){n.premove.consume()}));if(!l||0===l.plyDiff)return null;if(l.consumedPremove=!0,t.premoves.getQueue().length&&(l.pieces=t.premoves.getPieces()),l.move){const e=t.timeControl.get();e&&(addTimeToConsumedPremove({api:t,timeControl:e}),setTimestampOnNode({api:t,node:l.move,timestamp:1})),Object.assign(l.move,{animate:!1,userGenerated:!0})}return l.result&&t.setResult(l.result),l}}function createGetLegalMovesForSquare$1(e){return function getLegalMovesForSquare(t){const{game:n}=e,a=n.premove.moves(t);return a?a.filter((e=>void 0===t||e.from===t)).map((e=>e.to)).filter(((e,t,n)=>n.indexOf(e)===t)):[]}}function createGetMove$3(e){return function getMove(t){const{game:n}=e,a=n.premove.moves(t.from),l=a?a.find((e=>e.to===t.to)):null;return l?n.moveDetails(__spreadValues({},l)):null}}function createGetPieces$1(e){return function getPieces(){const{game:t}=e;return createCollection(t.premove.getPieces(!0))}}function createGetQueue(e){return function getQueue(){const{game:t}=e;return t.premove.queue}}function createIsLegalMove$1(e){return function isLegalMove(t){const{game:n}=e;return!!n.premove.move(t)&&(n.undo(),!0)}}function createLoadQueue(e){return function loadQueue(t){const{game:n}=e;n.premove.queue.length=0,n.premove.queue.push(...t)}}function createMove$8(e){return function move(t){const{api:n,game:a,respond:l}=e;return a.premove.move(t)?(n.getOptions().playSounds&&l(_.SoundEvents.Play,{sound:ze.BoardSounds.Premove}),l(_.APIEvents.SetBoardPosition,{pieces:n.premoves.getPieces()})):null}}function createReload$1(e){return function reload(){const{api:t}=e;if(t.premoves.getQueue().length){const e=[...t.premoves.getQueue()];t.reload(),t.premoves.loadQueue(e)}else t.reload()}}const Cr="premove";function getPremoveHighlights(e,t){var n;const{api:a,options:l}=t,f=null==(n=a.premoves)?void 0:n.getQueue();if(!l||!l.allowMarkings||!f.length)return[];const p=[];return f.forEach((e=>{if(e.from){const t=createKeyedHighlight({color:l.premoveHighlightColor,opacity:l.premoveHighlightOpacity,square:e.from,type:Cr});p.push(t)}const t=createKeyedHighlight({color:l.premoveHighlightColor,opacity:l.premoveHighlightOpacity,square:e.kingTo||e.to,type:Cr});p.push(t)})),p}function createReportingPlugin({onAll:e,onDebug:t,onError:n}){return{create:function create2(a){if(!e&&!t&&!n)return;const{api:{logger:l}}=a;l.on(Ut.Events.EntryAdded,(a=>function handleLogEntry(a,l){const f=l.get();e&&runCallback({callback:e,entry:a,previousLogs:f});t&&a.level===Ut.Levels.Debug&&runCallback({callback:t,entry:a,previousLogs:f});n&&a.level===Ut.Levels.Error&&runCallback({callback:n,entry:a,previousLogs:f})}(a,l)))},name:qe.Plugin.Name};function runCallback({callback:e,entry:t,previousLogs:n}){!function requestIdleCallback(e,t){const{requestIdleCallback:n}=window;n?n(e,t):function fallback(e){const t=Date.now();setTimeout((function run2(){e({didTimeout:!1,timeRemaining:()=>Math.max(0,50-(Date.now()-t))})}),1)}(e)}((()=>e(t,n)))}}const noop$1=()=>{};function createQueue(e=!0){const t=[];let n=!1;return{add:function add(a,...l){let f=noop$1,p=noop$1;const h=new Promise(((e,t)=>{p=e,f=t}));t.push({fn:a,params:l,reject:f,resolve:p}),e&&!1===n&&flush2();return h},clear:function clear(){n=!1,t.length=0},flush:flush2,getEntries:function getEntries(){return t}};async function flush2(){const e=t.shift();if(e){n=!0;try{const t=await e.fn(...e.params);return e.resolve(t),flush2()}catch(a){throw e.reject(a),a}}else n=!1}}function createExternallyResolvablePromise(){let e,t;return{promise:new Promise(((n,a)=>{e=n,t=a})),reject:t,resolve:e}}var Sr,kr,wr,Tr,Pr;function addCustomColor(e,t){Object.values(Sr.CssVariables).forEach((function setVariable(n){!function setCSSVariable({el:e,value:t,variable:n}){if(void 0!==t)return e.style.setProperty(n,t);e.style.removeProperty(n)}({el:e,value:t,variable:n})}))}kr=Sr||(Sr={}),(wr=kr.Classes||(kr.Classes={})).EnPassant="circle-info",wr.EnPassantMoveIcon="en-passant-move-icon",wr.IconFont="icon-font-chess",wr.MoveList="move-list",(kr.Tags||(kr.Tags={})).EnPassantIcon="span",(kr.CssVariables||(kr.CssVariables={})).Color="--nodeCustomColor",(Pr=Tr||(Tr={})).Mousedown="mousedown",Pr.MouseMove="mousemove",Pr.Mouseup="mouseup",Pr.PointerDown="pointerdown",Pr.PointerMove="pointermove",Pr.PointerUp="pointerup",Pr.Touchstart="touchstart",Pr.Touchmove="touchmove",Pr.Touchend="touchend";const{Pointerdown:Er,Pointermove:Ar,Pointerup:Mr}=function getPointerEvents(){const e="onpointerdown"in window,t="ontouchstart"in window;let n,a,l;e?(n=Tr.PointerDown,a=Tr.PointerMove,l=Tr.PointerUp):t?(n=Tr.Touchstart,a=Tr.Touchmove,l=Tr.Touchend):(n=Tr.Mousedown,a=Tr.MouseMove,l=Tr.Mouseup);return{Pointerdown:n,Pointermove:a,Pointerup:l}}();function toFigurine(e,t){return e.toUpperCase()===e?function getFigurineHTML(e,t){return`<span class="icon-font-chess ${function getPieceName(e){return rr.Piece.Names[e.toLowerCase()]}(e)}-${t}" data-figurine="${e}"></span>`}(e,t):e}function formatText({color:e,moveListDisplayType:t,san:n,translations:a}){return n.split("").map((n=>"NBRQK".includes(n)?t===ht.MoveListDisplayTypes.Figurine?toFigurine(n,e):a[n]():n)).join("")}function getColorAsWord(e){return e===rr.ColorsAsNumbers.Black?rr.ColorsAsWords.Black:rr.ColorsAsWords.White}function isEPCapture(e){return e===rr.Move.Flags.EPCapture}function toClassString(e){return`.${e}`}var xr,Or,Rr,Ir,Lr,Nr;function scrollToNode$1({containerEl:e,moveListEl:t,nodeEl:n}){if(!t||!n)return;const a=e||t,l=a.getBoundingClientRect(),f=n.getBoundingClientRect(),p=(l.bottom-l.top)/2,h=l.top-f.top+p;a.scrollTop-=h}function createVMLDOM(e){const{el:t,resultNodeIsSelectable:n,toggleTimestamps:a}=e,l=[],f=function createState(e={}){const t=__spreadValues({},e);return{get:function get2(){return t},set:function set2(e){Object.assign(t,e)}}}(e);return{addMove:addMove,addNode:function addNode(e){const{color:t,flags:n,ids:a,ply:l,san:f,wholeMoveNumber:p}=e;if(!t||!l||!f||!p||getNodeElement(l))return;let h=getMoveElement2(p);h||(h=addMove(p));const m=createNodeElement({color:getColorAsWord(t),moveId:a.move,isEPCapture:!!n&&isEPCapture(n),ply:l,san:f});if(!m)return;e.ply&&Object.prototype.hasOwnProperty.call(e,"customColor")&&addCustomColor(m,e.customColor);return h.appendChild(m)},addTimestamp:function addTimestamp({baseTime:e,node:t,timestamp:n,title:a,value:l}){const{color:f,ply:p,wholeMoveNumber:h}=t;if(!f||!p||!h)return;const m=getMoveElement2(h);if(!m)return;const g=getTimestampElement(p);g&&m.removeChild(g);const v=function createTimestampElement(e){const t=document.createElement("div");return t.setAttribute(xr.DOM.Attributes.Ply,e.toString()),t.setAttribute(xr.DOM.Attributes.VMLElement,xr.DOM.ElementTypes.Timestamp),t}(p);a&&function setTimestampElementTitle(e,t){t.title=e}(a,v);return setTimestampElementColor(f,v),setTimestampValue({baseTime:e,ply:p,timestamp:n,value:l},v),m.appendChild(v),v},clearList:function clearList(){destroyList(),createList()},createList:createList,deselectNode:function deselectNode(e){const t=e?getNodeElement(e):getSelectedNodeElement();if(!t)return;deselectNodeElement(t)},destroyList:destroyList,enableColors:function enableColors(e){const{colorsEnabled:n}=f.get();if(n===e)return;f.set({colorsEnabled:e}),t.classList[e?"add":"remove"](xr.DOM.ClassNames.ColorsEnabled)},getLastPly:getLastPly,getParams:f.get,getResult:function getResult(){const e=getResultNodeElement();if(!e)return rr.Results.None;return e.innerText},getResultNodeElement:getResultNodeElement,getTimestamp:function getTimestamp2(e){const t=getTimestampElement(e);if(!t)return null;const n=t.getAttribute(xr.DOM.Attributes.Time);if(0===(null==n?void 0:n.length))return null;return parseFloat(n)},hasResultNode:function hasResultNode(){return Boolean(t.querySelector(toClassString(xr.DOM.ClassNames.GameResult)))},isResultNodeSelected:function isResultNodeSelected(){var e;return Boolean(null==(e=t.querySelector(toClassString(xr.DOM.ClassNames.GameResult)))?void 0:e.classList.contains(xr.DOM.ClassNames.Selected))},removeTimestamp:function removeTimestamp(e){const t=getTimestampElement(e);if(!t)return;t.parentNode.removeChild(t)},scrollToSelectedNode:function scrollToSelectedNode(){const{scrollContainer:e}=f.get(),n=getSelectedNodeElement(),a=e||t;if(!n)return void(a.scrollTop=0);scrollToNode$1({containerEl:a,moveListEl:t,nodeEl:n})},selectNode:function selectNode2(e){const t=getNodeElement(e);if(!t)return;selectNodeElement(t)},selectNodeElement:selectNodeElement,selectResultNode:function selectResultNode(){const e=getResultNodeElement();e&&(selectNodeElement(e),t.dispatchEvent(new CustomEvent(xr.Events.SelectResultNode)))},setResultNode:function setResultNode(e){const a=getResultNodeElement();if(null!==a){const e=a.parentNode;if(!e)return;e.removeChild(a),0===e.childNodes.length&&e.parentNode.removeChild(e)}if(e===rr.Results.None)return;const l=getNodeElements().slice(-1)[0],f=l&&function getNodeElementColor(e){return e.classList.contains(rr.ColorsAsWords.Black)?rr.ColorsAsNumbers.Black:rr.ColorsAsNumbers.White}(l)!==rr.ColorsAsNumbers.Black?rr.ColorsAsWords.Black:rr.ColorsAsWords.White,p=f===rr.ColorsAsWords.White?addMove():function getMoveElements(){return Array.from(t.querySelectorAll(`${toClassString(xr.DOM.ClassNames.Move)}`))}().slice(-1)[0];let h;if(n){const t=getLastPly()||2;h=createNodeElement({color:f,isEPCapture:!1,moveId:getNodeElements().length-1,ply:t,san:e,isResultNode:!0}),h.classList.add(f,xr.DOM.ClassNames.GameResult)}else h=function createResultNodeElement(e,t){const n=document.createElement("span");return n.innerHTML=e,n.classList.add(t,xr.DOM.ClassNames.GameResult),n}(e,f);p.appendChild(h)},setTimestampValue:setTimestampValue,setParams:f.set,updateNodeColor:function updateNodeColor(e,t){const n=getNodeElement(e);if(!n)return;addCustomColor(n,t)}};function addMove(e){const n=document.createElement("div");return n.classList.add(xr.DOM.ClassNames.Move),e&&(n.setAttribute(xr.DOM.Attributes.WholeMoveNumber,`${e}`),n.innerHTML=`${e}.`),t.appendChild(n),n}function createList(){destroyList(),t.classList.add(xr.DOM.ClassNames.List),a&&t.classList.add(xr.DOM.ClassNames.ToggleTimestamps)}function createNodeElement({color:e,isEPCapture:n,isResultNode:a,moveId:p,ply:h,san:m}){const{EPIconInfoPath:g,moveListDisplayType:v,translations:y}=f.get(),_=document.createElement("div");if(_.setAttribute(xr.DOM.Attributes.Ply,h.toString()),_.classList.add(e,xr.DOM.ClassNames.Node),_.innerHTML=formatText({color:e,moveListDisplayType:v,san:m,translations:y}),n){const{el:e,listener:t}=function createEPIcon(e){const t=document.createElement(Sr.Tags.EnPassantIcon);return t.classList.add(Sr.Classes.IconFont,Sr.Classes.EnPassant,Sr.Classes.EnPassantMoveIcon),t.addEventListener(Er,EPIconPointerdownHandler),{el:t,listener:{el:t,eventName:Er,handler:EPIconPointerdownHandler}};function EPIconPointerdownHandler(t){t.stopPropagation(),window.open(e,"_blank")}}(g);_.appendChild(e),l.push({el:e,eventName:Er,handler:t.handler})}return _.addEventListener(Er,halfMovePointerdownHandler),l.push({eventName:Er,handler:halfMovePointerdownHandler}),_;function halfMovePointerdownHandler(){t.dispatchEvent(new CustomEvent(xr.Events.SelectNode,{detail:{ids:{move:p,line:0},ply:h,isResultNode:a}}))}}function deselectNodeElement(e){e.classList.remove(xr.DOM.ClassNames.Selected)}function destroyList(){l.forEach((e=>{t.removeEventListener(e.eventName,e.handler)})),t.classList.remove(xr.DOM.ClassNames.List),t.innerHTML=""}function getLastPly(){const e=getNodeElements();if(!e.length)return;const t=function getNodeElementPly(e){const t=e.getAttribute(xr.DOM.Attributes.Ply);return t?parseInt(t,10):null}(e[e.length-1]);return t||void 0}function getMoveElement2(e){return t.querySelector(`[${xr.DOM.Attributes.WholeMoveNumber}="${e}"]`)}function getNodeElement(e){return t.querySelector(`${toClassString(xr.DOM.ClassNames.Node)}[${xr.DOM.Attributes.Ply}="${e}"]`)}function getNodeElements(){return Array.from(t.querySelectorAll(`${toClassString(xr.DOM.ClassNames.Node)}`))}function getResultNodeElement(){return t.querySelector(toClassString(xr.DOM.ClassNames.GameResult))}function getTimestampElement(e){return t.querySelector(`[${xr.DOM.Attributes.VMLElement}="${xr.DOM.ElementTypes.Timestamp}"][${xr.DOM.Attributes.Ply}="${e}"]`)}function getSelectedNodeElement(){return t.querySelector(toClassString(xr.DOM.ClassNames.Selected))}function selectNodeElement(e){const t=getSelectedNodeElement();e!==t&&(t&&deselectNodeElement(t),e.classList.add(xr.DOM.ClassNames.Selected))}function setMaxMoveTimeTaken(e){null!==e?t.style.setProperty(xr.DOM.CSSVariables.MaxMoveTimeTaken,e.toString()):t.style.removeProperty(xr.DOM.CSSVariables.MaxMoveTimeTaken)}function setTimestampElementColor(e,t){t.classList.add(function getTimestampClass(e){return`time-${e}`}(getColorAsWord(e)))}function setTimestampValue({baseTime:e,ply:n,value:a,timestamp:l},f){const p=f||getTimestampElement(n);if(!p)return;const h=function getTimestampWidth(){const e=t.style.getPropertyValue(xr.DOM.CSSVariables.TimestampWidth);return e.length?parseFloat(e):null}(),m=function getMaxMoveTimeTaken(){const e=t.style.getPropertyValue(xr.DOM.CSSVariables.MaxMoveTimeTaken);return e.length?parseFloat(e):null}();if(p.setAttribute(xr.DOM.Attributes.Time,l.toString()),p.style.setProperty(xr.DOM.CSSVariables.TimeValue,l.toString()),p.innerHTML=a,(!h||7*a.length>h)&&function setTimestampWidth(e){const n=7*e;t.style.setProperty(xr.DOM.CSSVariables.TimestampWidth,`${n}px`)}(a.length),e){const n=function getBarWidth(e,t){const n=e/(t/40);return 130/Math.PI*Math.atan(n/3)}(l,millisecondsToDeciseconds(e));return p.style.setProperty(xr.DOM.CSSVariables.TimeBarWidth,`${n}px`),t.classList.add(xr.DOM.ClassNames.WithBaseTime),void(m&&setMaxMoveTimeTaken(null))}t.classList.remove(xr.DOM.ClassNames.WithBaseTime),(!m||l>m)&&setMaxMoveTimeTaken(l)}}!function(e){var t,n,a,l;t=e.DOM||(e.DOM={}),(n=t.Attributes||(t.Attributes={})).Ply="data-ply",n.Time="data-time",n.WholeMoveNumber="data-whole-move-number",n.VMLElement="data-vml-element",(a=t.CSSVariables||(t.CSSVariables={})).TimeBarWidth="--timeBarWidth",a.TimeValue="--timeValue",a.MaxMoveTimeTaken="--timeMaxValue",a.TimestampWidth="--timestampWidth",(l=t.ClassNames||(t.ClassNames={})).ColorsEnabled="movelist-colored",l.List="vertical-move-list",l.GameResult="game-result",l.Move="move",l.Node="node",l.Selected="selected",l.WithBaseTime="timestamps-with-base-time",l.ToggleTimestamps="toggle-timestamps",(t.ElementTypes||(t.ElementTypes={})).Timestamp="timestamp",function(e){e.SelectNode="SelectNode",e.SelectResultNode="SelectResultNode"}(e.Events||(e.Events={}))}(xr||(xr={})),Rr=Or||(Or={}),function(e){e.ClearAllAnalysis="Clear All Analysis",e.DeleteCommentAfter="Delete Comment After",e.DeleteCommentBefore="Delete Comment Before",e.DeleteLine="Delete Entire Variation",e.DeleteMove="Delete Move",e.InsertCommentAfter="Comment After",e.InsertCommentBefore="Comment Before",e.InsertContinuation="Insert Continuation",e.MoveVariationDown="Move Variation Down",e.MoveVariationUp="Move Variation Up",e.Promote="Promote",e.RemoveAnnotation="Remove Annotation",e.RemoveBegin="Remove Begin",e.RemoveEnd="Remove End",e.RemoveEvaluationAnnotation="Remove Evaluation Annotation",e.RemoveFocus="Remove Focus",e.SetBegin="Set Begin",e.SetEnd="Set End",e.SetFocus="Set Focus"}((Ir=Rr.Translation||(Rr.Translation={})).Actions||(Ir.Actions={})),(Lr=Ir.Annotations||(Ir.Annotations={})).BadMove="Bad move",Lr.BlackHasDecisiveAdvantage="Black has a decisive advantage",Lr.BlackHasModerateAdvantage="Black has a moderate advantage",Lr.BlackHasSlightAdvantage="Black has a slight advantage",Lr.Blunder="Blunder",Lr.Drawish="Drawish",Lr.DubiousMove="Dubious move",Lr.ExcellentMove="Excellent move",Lr.GoodMove="Good move",Lr.Novelty="Novelty",Lr.Unclear="Unclear",Lr.PositionInZuqZwang="The position is in zugzwang",Lr.SpeculativeMove="Speculative move",Lr.WhiteHasSlightAdvantage="White has a slight advantage",Lr.WhiteHasModerateAdvantage="White has a moderate advantage",Lr.WhiteHasDecisiveAdvantage="White has a decisive advantage",Lr.WithInitiative="With initiative",Lr.WithCompensation="With compensation",Lr.WithAttack="With an attack",function(e){e.B="B",e.K="K",e.N="N",e.P="P",e.Q="Q",e.R="R"}(Ir.Pieces||(Ir.Pieces={})),(Nr=Ir.Plural||(Ir.Plural={})).NumberOfDays="numberOfDays",Nr.NumberOfHours="numberOfHours",Nr.NumberOfMinutes="numberOfMinutes",(Ir.Prompt||(Ir.Prompt={})).AddComment="Add Comment...",function(e){e.HML="hml",e.VML="vml"}(Rr.Types||(Rr.Types={}));const Dr={[Or.Translation.Prompt.AddComment]:()=>Or.Translation.Prompt.AddComment,[Or.Translation.Annotations.BadMove]:()=>Or.Translation.Annotations.BadMove,[Or.Translation.Annotations.BlackHasDecisiveAdvantage]:()=>Or.Translation.Annotations.BlackHasDecisiveAdvantage,[Or.Translation.Annotations.BlackHasModerateAdvantage]:()=>Or.Translation.Annotations.BlackHasModerateAdvantage,[Or.Translation.Annotations.BlackHasSlightAdvantage]:()=>Or.Translation.Annotations.BlackHasSlightAdvantage,[Or.Translation.Annotations.Blunder]:()=>Or.Translation.Annotations.Blunder,[Or.Translation.Actions.ClearAllAnalysis]:()=>Or.Translation.Actions.ClearAllAnalysis,[Or.Translation.Actions.DeleteCommentAfter]:()=>Or.Translation.Actions.DeleteCommentAfter,[Or.Translation.Actions.DeleteCommentBefore]:()=>Or.Translation.Actions.DeleteCommentBefore,[Or.Translation.Actions.DeleteLine]:()=>Or.Translation.Actions.DeleteLine,[Or.Translation.Actions.DeleteMove]:()=>Or.Translation.Actions.DeleteMove,[Or.Translation.Annotations.Drawish]:()=>Or.Translation.Annotations.Drawish,[Or.Translation.Annotations.DubiousMove]:()=>Or.Translation.Annotations.DubiousMove,[Or.Translation.Annotations.ExcellentMove]:()=>Or.Translation.Annotations.ExcellentMove,[Or.Translation.Annotations.GoodMove]:()=>Or.Translation.Annotations.GoodMove,[Or.Translation.Actions.InsertCommentAfter]:()=>Or.Translation.Actions.InsertCommentAfter,[Or.Translation.Actions.InsertCommentBefore]:()=>Or.Translation.Actions.InsertCommentBefore,[Or.Translation.Actions.InsertContinuation]:()=>Or.Translation.Actions.InsertContinuation,[Or.Translation.Actions.MoveVariationDown]:()=>Or.Translation.Actions.MoveVariationDown,[Or.Translation.Actions.MoveVariationUp]:()=>Or.Translation.Actions.MoveVariationUp,[Or.Translation.Annotations.Novelty]:()=>Or.Translation.Annotations.Novelty,[Or.Translation.Pieces.B]:()=>Or.Translation.Pieces.B,[Or.Translation.Pieces.K]:()=>Or.Translation.Pieces.K,[Or.Translation.Pieces.N]:()=>Or.Translation.Pieces.N,[Or.Translation.Pieces.P]:()=>Or.Translation.Pieces.P,[Or.Translation.Pieces.Q]:()=>Or.Translation.Pieces.Q,[Or.Translation.Pieces.R]:()=>Or.Translation.Pieces.R,[Or.Translation.Actions.Promote]:()=>Or.Translation.Actions.Promote,[Or.Translation.Actions.RemoveAnnotation]:()=>Or.Translation.Actions.RemoveAnnotation,[Or.Translation.Actions.RemoveBegin]:()=>Or.Translation.Actions.RemoveBegin,[Or.Translation.Actions.RemoveEnd]:()=>Or.Translation.Actions.RemoveEnd,[Or.Translation.Actions.RemoveEvaluationAnnotation]:()=>Or.Translation.Actions.RemoveEvaluationAnnotation,[Or.Translation.Actions.RemoveFocus]:()=>Or.Translation.Actions.RemoveFocus,[Or.Translation.Actions.SetBegin]:()=>Or.Translation.Actions.SetBegin,[Or.Translation.Actions.SetEnd]:()=>Or.Translation.Actions.SetEnd,[Or.Translation.Actions.SetFocus]:()=>Or.Translation.Actions.SetFocus,[Or.Translation.Annotations.SpeculativeMove]:()=>Or.Translation.Annotations.SpeculativeMove,[Or.Translation.Annotations.PositionInZuqZwang]:()=>Or.Translation.Annotations.PositionInZuqZwang,[Or.Translation.Annotations.Unclear]:()=>Or.Translation.Annotations.Unclear,[Or.Translation.Annotations.WhiteHasDecisiveAdvantage]:()=>Or.Translation.Annotations.WhiteHasDecisiveAdvantage,[Or.Translation.Annotations.WhiteHasModerateAdvantage]:()=>Or.Translation.Annotations.WhiteHasModerateAdvantage,[Or.Translation.Annotations.WhiteHasSlightAdvantage]:()=>Or.Translation.Annotations.WhiteHasSlightAdvantage,[Or.Translation.Annotations.WithAttack]:()=>Or.Translation.Annotations.WithAttack,[Or.Translation.Annotations.WithCompensation]:()=>Or.Translation.Annotations.WithCompensation,[Or.Translation.Annotations.WithInitiative]:()=>Or.Translation.Annotations.WithInitiative,[Or.Translation.Plural.NumberOfDays]:e=>1===e?`${e} day`:`${e} days`,[Or.Translation.Plural.NumberOfHours]:e=>1===e?`${e} hr`:`${e} hrs`,[Or.Translation.Plural.NumberOfMinutes]:e=>1===e?`${e} min`:`${e} mins`};var Br,Fr,jr,$r,Hr,Vr,Ur,Gr,qr;function decisecondsToDaysHoursMinutesObject(e){const t=Math.ceil(e/10);let n=Math.floor(t/86400),a=Math.floor(t%86400/3600),l=Math.ceil(t%3600/60);return 60===l&&(l=0,a+=1),24===a&&(a=0,n+=1),{days:n,hours:a,minutes:l}}function decisecondsToDaysHoursMinutesString(e,t){const{days:n,hours:a,minutes:l}=decisecondsToDaysHoursMinutesObject(e),f=a>0||l>0?", ":"",p=l>0?", ":"";return`${n>0?`${t[Or.Translation.Plural.NumberOfDays](n)}${f}`:""}${a>0?`${t[Or.Translation.Plural.NumberOfHours](a)}${p}`:""}${l>0?`${t[Or.Translation.Plural.NumberOfMinutes](l)}`:""}`}function decisecondsToHumanReadableFormat(e,t){const{days:n,hours:a,minutes:l}=decisecondsToDaysHoursMinutesObject(e);return n?n>0?`${t[Or.Translation.Plural.NumberOfDays](n)}`:"":a?a>0?`${t[Or.Translation.Plural.NumberOfHours](a)}`:"":l>0?`${t[Or.Translation.Plural.NumberOfMinutes](l)}`:""}function formatDecisecondsAsClockString(e){const t=Math.floor(e/600),n=((e-600*t)/10).toFixed(1);if(0===t)return n;return`${t}:${`0${n}`.substr(-4)}`}function getTimestampElementParameters({formatTimestampAsHumanReadable:e,timestamp:t,translations:n}){return{title:e?decisecondsToDaysHoursMinutesString(t,n):void 0,value:e?decisecondsToHumanReadableFormat(t,n):formatDecisecondsAsClockString(t)}}function getTimestampFromNode(e){var t;return(null==(t=e.commands)?void 0:t.timestamp)?parseInt(e.commands.timestamp,10):null}function createVMLAPIOverrides({resultNodeIsSelectable:e}){return{moveBackward:({api:e})=>function createMoveBackward$2({api:e}){const t=e.moveBackward;return function moveBackward(){e.vml.getMoveList().isResultNodeSelected()?e.selectLineEnd(0):t()}}({api:e}),moveForward:({api:t})=>function createMoveForward$1({api:e,resultNodeIsSelectable:t}){const n=e.moveForward;return function moveForward(){var a;if(!t)return void n();const l=e.vml.getMoveList(),f=e.getFEN(),p=null==(a=e.getLastMove())?void 0:a.fen;l.isResultNodeSelected()||(p===f?l.selectResultNode():n())}}({api:t,resultNodeIsSelectable:e})}}function selectNode({node:e,lines:t}){return function getMachineStateForSelectedNode(e,t){return!e||isLine(e)?qr.StartingPosition:e.ids.move===Object.keys(t[e.ids.line]).length-1?qr.EndOfLineSelected:qr.MiddleOfLineSelected}(e,t)}function createHMLStateMachine(){return createStateMachine(function getStateMachine$1(){return{initialState:qr.StartingPosition,states:{[qr.StartingPosition]:{[_.APIEvents.SelectNode]:selectNode,[_.APIEvents.Move]:function makeMove({component:e,event:t}){const{api:n,dom:a}=e;return n.getMoveNode({line:t.ids.line,move:t.ids.move})?(n.selectNode({line:t.ids.line,move:t.ids.move}),qr.MiddleOfLineSelected):0!==t.ids.line?(a.insertVariation({node:t}),qr.EndOfLineSelected):(a.insertNode({node:t}),qr.EndOfLineSelected)}},[qr.EndOfLineSelected]:{[_.APIEvents.SelectNode]:selectNode,[_.APIEvents.Move]:function makeMove({component:e,event:t}){const{api:n,dom:a}=e;return a.insertNode({node:t,nodeToInsertAfter:n.getSelectedNode()}),qr.EndOfLineSelected}},[qr.MiddleOfLineSelected]:{[_.APIEvents.SelectNode]:selectNode,[_.APIEvents.Move]:function makeMove({component:e,event:t}){const{api:n,dom:a}=e;return n.getMoveNode({line:t.ids.line,move:t.ids.move})?(n.selectNode({line:t.ids.line,move:t.ids.move}),qr.MiddleOfLineSelected):(a.insertVariation({node:t}),qr.EndOfLineSelected)}}}}}())}(function(e){e.AddMove="AddMove",e.AnalysisEnd="AnalysisEnd",e.AnalysisStart="AnalysisStart"})((Fr=Br||(Br={})).APIEvents||(Fr.APIEvents={})),function(e){e.Name="observing"}(Fr.Plugin||(Fr.Plugin={})),$r=jr||(jr={}),(Hr=$r.Placeholders||($r.Placeholders={})).GameResult="game-result",Hr.Moves="moves",(Vr=$r.ClassNames||($r.ClassNames={})).Component="horizontal-move-list",Vr.MainLine="main",Vr.Variation="variation",$r.ComponentIdentifier="data-id",function(e){e.Copy="copy"}($r.Events||($r.Events={})),(Ur=$r.VariationParenthesis||($r.VariationParenthesis={})).Before="(",Ur.After=")",(Gr=$r.NodeLimitTypes||($r.NodeLimitTypes={})).Begin="begin",Gr.Focus="focus",Gr.End="end",function(e){e.EndOfLineSelected="EndOfLineSelected",e.MiddleOfLineSelected="MiddleOfLineSelected",e.StartingPosition="StartingPosition"}(qr||(qr={}));const Wr={condition:function condition$a({event:e}){return function match(){return e.type===_.APIEvents.AddMove}},handler:function handler$a({context:e,event:t}){const{moveList:n}=e,{listMove:a}=t.data;if(!(null==a?void 0:a.ids))return;const l=n.api.getMoveNode({line:0,move:a.ids.move-1});n.dom.insertNode({node:a,nodeToInsertAfter:l})}};const zr={condition:function condition$9({event:e}){return function match(){return e.type===_.APIEvents.CreateContinuation}},handler:function handler$9({context:e,event:t,selectedNode:n}){const{moveList:a,methods:{selectCurrentPosition:l}}=e;if(a.dom.insertVariation({node:t.data.node}),a.api.getMoveNode(t.data.node.ids))return void a.api.selectNode(t.data.node.ids);l(n)}};const Kr={condition:function condition$8({event:e}){return function match(){return _.APIEvents.UpdatePGNHeaders===e.type&&e.data.Result}},handler:function handler$8({context:e,coreContext:t}){const{moveList:n}=e;n.dom.setResultNode(t.api.getResult())}};var Zr,Qr,Xr,Yr,Jr,eo,to,ro;function isEditingComment(e){return Boolean(e.getElement().querySelector(function toSelector(e,t="."){return`${t}${e}`}(Zr.Classes.Component)))}(function(e){e.FocusOut="comment-field-focus-out",e.CommentChanged="comment-has-changed"})((Qr=Zr||(Zr={})).Events||(Qr.Events={})),function(e){e.Component="editable-comment"}(Qr.Classes||(Qr.Classes={})),function(e){e[e.CommentUpdateDelay=500]="CommentUpdateDelay"}(Qr.Constants||(Qr.Constants={})),Yr=Xr||(Xr={}),(Jr=Yr.Classes||(Yr.Classes={})).Hidden="hidden",Jr.Invisible="invisible",to=eo||(eo={}),(ro=to.KeyCodes||(to.KeyCodes={}))[ro.Backspace=8]="Backspace",ro[ro.Delete=46]="Delete",ro[ro.DownArrow=40]="DownArrow",ro[ro.Enter=13]="Enter",ro[ro.Escape=27]="Escape",ro[ro.LeftArrow=37]="LeftArrow",ro[ro.RightArrow=39]="RightArrow",ro[ro.Spacebar=32]="Spacebar",ro[ro.Stop=137]="Stop",ro[ro.Tab=9]="Tab",ro[ro.UpArrow=38]="UpArrow";const oo={condition:function condition$7({event:e}){return function match(){return e.type===_.APIEvents.LineCommentUpdated}},handler:function handler$7({context:e,event:t}){const{moveList:n}=e,{data:a}=t;if(isEditingComment(n.dom))return;n.dom.updateLineComponent(a.lineId,{initComment:a.comment})}};const io={condition:function condition$6({event:e}){return function match(){return[_.APIEvents.CreateGame,_.APIEvents.CreateContinuation,_.APIEvents.DeletePosition,_.APIEvents.Load,_.APIEvents.MoveVariation,_.APIEvents.PromoteVariation,_.APIEvents.ResetToMainLine].includes(e.type)||e.data.linesReordered}},handler:function handler$6({context:e,coreContext:t}){const{moveList:n,methods:{destroyContextMenu:a},queue:l}=e,{api:f}=t;a(),l.flush(),n.dom.load(),n.dom.setResultNode(f.getResult())}};const ao={condition:function condition$5({event:e}){return function match(){return e.type===_.APIEvents.Move}},handler:function handler$5({context:e,event:t,selectedNode:n}){const{moveList:a,stateMachine:l,methods:{selectCurrentPosition:f}}=e;if(a.api.getMoveNode(t.data.move.ids))return void a.api.selectNode(t.data.move.ids);l.transition(_.APIEvents.Move,{component:a,event:t.data.move,selectedNode:n}),f(n)}};const so={condition:function condition$4({event:e}){return function match(){return e.type===_.APIEvents.NodeUpdated}},handler:function handler$4({context:e,event:t}){const{moveList:n}=e,{data:a}=t;if(isEditingComment(n.dom))return;if(!a.ids)return;n.dom.updateMoveNodeComponent(a.ids,a.changes)}};const co={condition:function condition$3({event:e}){return function match(){return[_.APIEvents.ResetToMainLine].includes(e.type)}},handler:function handler$3({context:e}){const{moveList:t}=e;t.dom.load()}};const lo={condition:function condition$2({event:e}){return function match(){return e.type===_.OptionsEvents.Update}},handler:function handler$2({coreContext:e,context:t,event:n}){const{el:a,moveList:l,methods:{destroyContextMenu:f}}=t,p=e.api.getOptions();l.api.setOptions(n.data),p.test&&setTestData(a,{[Ft.Editable]:n.data.moveListContextMenuEnabled});!1===n.data.moveListContextMenuEnabled&&f()}};const uo={condition:function condition$1({event:e}){return function match(){return e.type===_.APIEvents.MoveForward||e.type===_.APIEvents.MoveBackward||e.type===_.APIEvents.SelectLineEnd||e.type===_.APIEvents.SelectLineStart||e.type===_.APIEvents.SelectNode||e.type===_.APIEvents.ResetToMainLine}},handler:function handler$1({context:e,selectedNode:t}){const{methods:{selectCurrentPosition:n}}=e;n(t)}};var fo,po,ho,mo,go,vo,yo,_o,bo,Co,So,ko,wo,To;(function(e){e.ClearAnalysis="ClearAnalysis",e.DeleteComment="DeleteComment",e.DeleteCommentBefore="DeleteCommentBefore",e.DeleteMove="DeleteMove",e.DeleteVariation="DeleteVariation",e.InsertComment="InsertComment",e.InsertCommentBefore="InsertCommentBefore",e.InsertContinuation="InsertContinuation",e.MoveVariationDown="MoveVariationDown",e.MoveVariationUp="MoveVariationUp",e.PromoteVariation="PromoteVariation",e.RemoveAnnotation="RemoveAnnotation",e.RemoveBegin="RemoveBegin",e.RemoveEnd="RemoveEnd",e.RemoveAdditionalAnnotation="RemoveAdditionalAnnotation",e.RemoveFocus="RemoveFocus",e.SetBegin="SetBegin",e.SetEnd="SetEnd",e.SetFocus="SetFocus"})((po=fo||(fo={})).Actions||(po.Actions={})),(ho=po.AnnotationActions||(po.AnnotationActions={})).AddAnnotation="AddAnnotation",ho.AddAdditionalAnnotation="AddAdditionalAnnotation",function(e){e.Actions="actions",e.Translations="translations"}(po.Keys||(po.Keys={})),function(e){e.ActionClicked="action-clicked",e.AnnotationClicked="annotation-clicked",e.Close="close-context-menu"}(po.Events||(po.Events={})),function(e){e.Name="contextMenu"}(po.Plugin||(po.Plugin={})),function(e){e.ActionName="action-name",e.Annotation="annotation",e.AnnotationsContainer="annotations-container",e.Component="move-node-context-menu",e.Divider="divider"}((go=mo||(mo={})).Classes||(go.Classes={})),function(e){e.Annotation="annotation",e.CustomColor="customColor",e.id="id",e.MoveNumber="moveNumber",e.San="san",e.Selected="selected"}((yo=vo||(vo={})).Keys||(yo.Keys={})),(_o=yo.TouchableKeys||(yo.TouchableKeys={})).Annotation="annotation",_o.CustomColor="customColor",_o.MoveNumber="moveNumber",_o.San="san",function(e){e.Comment="comment",e.GameResultNode="game-result-node",e.IconFont="icon-font-chess",e.MoveNode="move-node",e.MoveNumber="move-number",e.MoveText="move-text",e.Selected="selected",e.StaticComment="static-comment"}((Co=bo||(bo={})).Classes||(Co.Classes={})),function(e){e[e.TouchDelay=500]="TouchDelay"}(Co.Constants||(Co.Constants={})),function(e){e.Click="click",e.OpenContextMenu="contextmenu"}(Co.Events||(Co.Events={}));class ChessError extends Error{constructor({code:e,message:t,data:n}){super(t),this.code=e,this.data=n,this.message=t,this.name="ChessError"}}(ko=So||(So={})).BadData="Bad Data",ko.BeforeStateHooksConflict="Before State hooks conflict",ko.DOMDoesNotMatchJCE="DOM Does Not Match JCE",ko.ElementAlreadyExists="Element Already Exists",ko.ElementNotFound="Element Not Found",ko.IllegalJCECall="Illegal JCE Call",ko.IncorrectMode="Incorrect Mode",ko.InvalidStateMachine="Invalid State Machine",ko.MissingPluginDependency="Missing Plugin Dependency",(To=wo||(wo={}))[To.MainLine=0]="MainLine",To[To.MainLineChild=-1]="MainLineChild",To[To.Parent=1]="Parent";const Po={[fo.Actions.InsertCommentBefore]:function createInsertCommentBeforeAction(){return{action:fo.Actions.InsertCommentBefore,handler:function handler2(e,{moveList:t,context:n}){const{game:a}=n;let l=e;const f=a.getLine(e.ids.line);l=0===e.ids.move&&f?f:a.getNodeByIds(e.previous);t.dom.insertEditableComment(l)},isVisible:function isVisible({api:e,node:t}){if(0===t.ids.move){const n=e.getLine(t.ids.line);return!n||!n.initComment}const n=e.getNodeByIds(t.previous);return isNode(n)&&!n.comment},name:Or.Translation.Actions.InsertCommentBefore}}(),[fo.Actions.InsertComment]:function createInsertCommentAction(){return{action:fo.Actions.InsertComment,handler:function handler2(e,{moveList:t}){t.dom.insertEditableComment(e)},isVisible:function isVisible({node:e}){return void 0===e.comment},name:Or.Translation.Actions.InsertCommentAfter}}(),[fo.Actions.DeleteCommentBefore]:function createDeleteCommentBeforeAction(){return{action:fo.Actions.DeleteCommentBefore,handler:function handler2(e,{context:{game:t},moveList:n,moveNodeComponent:a}){let l=e;const f=t.getLine(e.ids.line);f&&0===e.ids.move?(l=f,t.updateLineComment(void 0,f.id)):(l=t.getNodeByIds(e.previous),t.updateNode(l.ids,{comment:void 0}),a.touch(vo.TouchableKeys.MoveNumber));n.dom.removeComment(l)},isVisible:function isVisible({api:e,node:t}){if(0===t.ids.move){const n=e.getLine(t.ids.line);return Boolean(n&&n.initComment)}const n=e.getNodeByIds(t.previous);return isNode(n)&&Boolean(n.comment)},name:Or.Translation.Actions.DeleteCommentBefore}}(),[fo.Actions.DeleteComment]:function createDeleteCommentAction(){return{action:fo.Actions.DeleteComment,handler:function handler2(e,{context:{game:t},moveList:n,moveNodeComponent:a}){t.updateNode(e.ids,{comment:void 0}),n.dom.removeComment(e),a.touchNextNode()},isVisible:function isVisible({node:e}){return"string"==typeof e.comment},name:Or.Translation.Actions.DeleteCommentAfter}}(),[fo.Actions.RemoveAnnotation]:function createRemoveAnnotationAction(){return{action:fo.Actions.RemoveAnnotation,handler:function handler2(e,{context:{game:t},moveNodeComponent:n}){t.updateNode(e.ids,{annotation:void 0}),n.touch(vo.TouchableKeys.Annotation)},isVisible:function isVisible({node:e}){return Boolean(e.annotation)},name:Or.Translation.Actions.RemoveAnnotation}}(),[fo.Actions.RemoveAdditionalAnnotation]:function createRemoveAdditionalAnnotationAction(){return{action:fo.Actions.RemoveAdditionalAnnotation,handler:function handler2(e,{context:{game:t},moveNodeComponent:n}){t.updateNode(e.ids,{additionalAnnotation:void 0}),n.touch(vo.TouchableKeys.Annotation)},isVisible:function isVisible({node:e}){return Boolean(e.additionalAnnotation&&e.additionalAnnotation.length>0)},name:Or.Translation.Actions.RemoveEvaluationAnnotation}}(),[fo.Actions.DeleteVariation]:function createDeleteVariationAction(){return{action:fo.Actions.DeleteVariation,handler:function handler2(e,{context:{game:t},moveList:n}){t.deletePosition(-1,e.ids.line),n.dom.load()},isVisible:function isVisible({node:e}){return 0!==e.ids.line},name:Or.Translation.Actions.DeleteLine}}(),[fo.Actions.DeleteMove]:function createDeleteMoveAction(){return{action:fo.Actions.DeleteMove,handler:function handler2(e,{context:{game:t}}){t.deletePosition(e.ids.move,e.ids.line)},isVisible:function isVisible({api:e,node:t}){if(0===t.ids.line)return e.getMode().getOptions().canModifyExistingMovesOnMainLine;return!0},name:Or.Translation.Actions.DeleteMove}}(),[fo.Actions.PromoteVariation]:function createPromoteVariationAction(){return{action:fo.Actions.PromoteVariation,handler:function handler2(e,{context:{game:t}}){t.promoteVariation(e.ids.line,wo.Parent)},isVisible:function isVisible({api:e,node:t}){const n=t.ids.line;if(0===n)return!1;const a=e.getLine(n);if(!a)return!1;if(0===a.parentId){const{canAddMovesToMainLine:t,canModifyExistingMovesOnMainLine:n}=e.getMode().getOptions();return t&&n}return!0},name:Or.Translation.Actions.Promote}}(),[fo.Actions.MoveVariationDown]:function createMoveVariationDownAction(){return{action:fo.Actions.MoveVariationDown,handler:function handler2(e,{context:{game:t}}){t.moveVariation(e.ids.line,!1)},isVisible:function isVisible({api:e,node:t}){if(0===t.ids.line)return!1;const n=e.getLine(t.ids.line);if(!n)return!1;const a=e.getNodeByIds({line:n.parentId,move:n.atMoveNode});if(a.lines&&a.lines.length>1)return!function isOnLastLineOfParentNode(e,t){return!!t.lines&&e.ids.line===t.lines[t.lines.length-1]}(t,a);return!1},name:Or.Translation.Actions.MoveVariationDown}}(),[fo.Actions.MoveVariationUp]:function createMoveVariationUpAction(){return{action:fo.Actions.MoveVariationUp,handler:function handler2(e,{context:{game:t}}){t.moveVariation(e.ids.line,!0)},isVisible:function isVisible({api:e,node:t}){if(0===t.ids.line)return!1;const n=e.getLine(t.ids.line);if(!n)return!1;const a=e.getNodeByIds({line:n.parentId,move:n.atMoveNode});if(a.lines&&a.lines.length>1)return!function isOnFirstLineOfParentNode(e,t){return!!t.lines&&e.ids.line===t.lines[0]}(t,a);return!1},name:Or.Translation.Actions.MoveVariationUp}}(),[fo.Actions.InsertContinuation]:function createInsertContinuationAction(){return{action:fo.Actions.InsertContinuation,handler:function handler2(e,{context:{game:t}}){t.createContinuation()},isVisible:function isVisible({api:e,node:t}){const n=e.getRawLines();return t.ids.move===n[t.ids.line].length-1},name:Or.Translation.Actions.InsertContinuation}}(),[fo.Actions.ClearAnalysis]:function createClearAnalysisAction(){return{action:fo.Actions.ClearAnalysis,handler:function handler2(e,{context:{game:t},event:n,moveList:a}){t.hml.contextMenu.requestConfirmation({action:function onConfirmation(){const n=Object.keys(a.api.getNodes()),l=t.getLine(0);if(!l)return;const f={};if(n.length>1)for(let e=n.length-1;e>0;e--){const n=t.getLine(e);if(!n)return;a.dom.removeLine(n),0===n.parentId&&(f[n.atMoveNode]=!0)}Object.keys(a.api.getComments()).forEach((e=>{a.api.getComments()[e].destroy()})),t.resetToMainLine(),l.forEach((n=>{var l,p;const h=[];let m=!1;if(f[n.ids.move]&&h.push(vo.TouchableKeys.MoveNumber),(n.annotation||n.additionalAnnotation)&&h.push(vo.TouchableKeys.Annotation),n.comment&&n.color===rr.ColorsAsNumbers.White&&(m=!0),t.updateNode(n.ids,{additionalAnnotation:void 0,annotation:void 0,comment:void 0}),null==(l=e.commands)||delete l.href,null==(p=e.commands)||delete p.text,Object.keys(h).length>0||m){const t=a.api.getMoveNode(n.ids);if(!t)throw new ChessError({code:So.ElementNotFound,data:e,message:"No move node found."});h.forEach((e=>{t.touch(e)})),t.touchNextNode()}})),l.initComment&&t.updateLineComment(void 0,l.id)},data:{event:n},text:"Are you sure you want to clear all analysis?",type:fo.Actions.ClearAnalysis})},isVisible:()=>!0,name:Or.Translation.Actions.ClearAllAnalysis}}()};function createContextMenuAPI(e){return function createConfirmations(e){const t=new Map;let n=e;return{cancelConfirmation:cancelConfirmation,cancelAllConfirmations:function cancelAllConfirmations(){t.clear()},confirmAction:confirmAction,registerConfirmationCallback:function registerConfirmationCallback(e){n=e},requestConfirmation:async function requestConfirmation(e){const{action:a,data:l,text:f,type:p}=e;return t.set(p,a),n?await n({data:l,text:f,type:p})?confirmAction(p):cancelConfirmation(p):window.confirm(f)?confirmAction(p):void cancelConfirmation(p)}};function cancelConfirmation(e){t.delete(e)}function confirmAction(e){var n;null==(n=t.get(e))||n(),t.delete(e)}}(e)}function createContextMenuPlugin(e){return{api:()=>createContextMenuAPI(e),destroy:function destroy(e){if(!e)return;e.game.hml.contextMenu.cancelAllConfirmations()},name:fo.Plugin.Name}}function createGetContextMenuActions(e){return function getContextMenuActions(t){const{contextMenuActions:n,game:a}=e,l=a.getNodeByIds(t);if(!isNode(l))throw new ChessError({code:So.BadData,data:t,message:"No move node found"});const f=[];return Object.values(n).forEach((t=>{if(!t)return;t.isVisible({api:a,node:l,options:a.getOptions(),state:e.state})&&f.push(t)})),f}}function createGetMoveNodeMethod(e){return function getMoveNode({line:t,move:n}){const{state:a}=e;return a.nodes[t]&&e.state.nodes[t][n]}}function createResetSelectedNode(e){return function resetSelectedNode(){const{state:t}=e;t.selectedNode&&(t.selectedNode.set({[vo.Keys.Selected]:!1}),t.selectedNode=void 0)}}function createSelectLineStart$1(e){return function selectLineStart(t){const{api:n,stateMachine:a}=e;n.resetSelectedNode(),a.transition(_.APIEvents.SelectNode,{lines:n.getNodes(),node:t})}}function getLineElement(e,t){return t.querySelector(`[${jr.ComponentIdentifier}="line-${e}"]`)}function forceNextFrame(e,t=[]){requestAnimationFrame((()=>{requestAnimationFrame((()=>{e(...t)}))}))}function createSelectNodeMethod(e){return function selectNode2({line:t,move:n}){const{api:a,el:l,scrollContainer:f,state:p,stateMachine:h}=e;if(void 0===t||void 0===n)return;a.resetSelectedNode();const m=a.getMoveNode({line:t,move:n});m&&(m.set({[vo.Keys.Selected]:!0}),p.selectedNode=m,h.transition(_.APIEvents.SelectNode,{lines:a.getNodes(),node:p.selectedNode.getNodeData()}),forceNextFrame((()=>{l.classList.contains(jr.ClassNames.Component)&&(0===m.ids.line||getLineElement(m.ids.line,l))&&function scrollToNode({containerEl:e,moveNode:t,moveListEl:n}){let a;try{a=t.getElement()}catch(l){}a&&scrollToNode$1({containerEl:e,moveListEl:n,nodeEl:a})}({containerEl:f,moveListEl:l,moveNode:m})})))}}function setMoveListDisplayType(e){!function forEachNode(e,t){Object.keys(e).forEach((n=>{(Object.keys(e[n])||[]).forEach((a=>{t(e[n][a])}))}))}(e.api.getNodes(),(function touchSan2(e){e.touch(vo.TouchableKeys.San)}))}function setMoveListContextMenuEnabled(e){const t=e.state.comments;Object.keys(t).forEach((n=>{t[n][e.options.moveListContextMenuEnabled?"registerClickListeners":"deregisterClickListeners"]()}))}function createSetOptionsMethod(e){const t={moveListContextMenuEnabled:setMoveListContextMenuEnabled,moveListDisplayType:setMoveListDisplayType};return function setOptions(n){Object.keys(e.options).forEach((a=>{if(!(a in n))return;const l=e.options[a]!==n[a];e.options[a]=n[a],l&&t[a]&&t[a](e)}))}}function noop(){}function run$1(e){return e()}function blank_object(){return Object.create(null)}function run_all(e){e.forEach(run$1)}function is_function(e){return"function"==typeof e}function safe_not_equal(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function null_to_empty(e){return null==e?"":e}function append(e,t){e.appendChild(t)}function insert(e,t,n){e.insertBefore(t,n||null)}function detach(e){e.parentNode.removeChild(e)}function destroy_each(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function element(e){return document.createElement(e)}function text(e){return document.createTextNode(e)}function space(){return text(" ")}function listen(e,t,n,a){return e.addEventListener(t,n,a),()=>e.removeEventListener(t,n,a)}function attr(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function set_data(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}function toggle_class(e,t,n){e.classList[n?"add":"remove"](t)}class HtmlTag{constructor(){this.e=this.n=null}c(e){this.h(e)}m(e,t,n=null){this.e||(this.e=element(t.nodeName),this.t=t,this.c(e)),this.i(n)}h(e){this.e.innerHTML=e,this.n=Array.from(this.e.childNodes)}i(e){for(let t=0;t<this.n.length;t+=1)insert(this.t,this.n[t],e)}p(e){this.d(),this.h(e),this.i(this.a)}d(){this.n.forEach(detach)}}let Eo;function set_current_component(e){Eo=e}function get_current_component(){if(!Eo)throw new Error("Function called outside component initialization");return Eo}function createEventDispatcher(){const e=get_current_component();return(t,n)=>{const a=e.$$.callbacks[t];if(a){const l=function custom_event(e,t,n=!1){const a=document.createEvent("CustomEvent");return a.initCustomEvent(e,n,!1,t),a}(t,n);a.slice().forEach((t=>{t.call(e,l)}))}}}const Ao=[],Mo=[],xo=[],Oo=[],Ro=Promise.resolve();let Io=!1;function add_render_callback(e){xo.push(e)}let Lo=!1;const No=new Set;function flush(){if(!Lo){Lo=!0;do{for(let e=0;e<Ao.length;e+=1){const t=Ao[e];set_current_component(t),update(t.$$)}for(set_current_component(null),Ao.length=0;Mo.length;)Mo.pop()();for(let e=0;e<xo.length;e+=1){const t=xo[e];No.has(t)||(No.add(t),t())}xo.length=0}while(Ao.length);for(;Oo.length;)Oo.pop()();Io=!1,Lo=!1,No.clear()}}function update(e){if(null!==e.fragment){e.update(),run_all(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(add_render_callback)}}const Do=new Set;function transition_in(e,t){e&&e.i&&(Do.delete(e),e.i(t))}function destroy_block(e,t){e.d(1),t.delete(e.key)}function make_dirty(e,t){-1===e.$$.dirty[0]&&(Ao.push(e),function schedule_update(){Io||(Io=!0,Ro.then(flush))}(),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function init(e,t,n,a,l,f,p,h=[-1]){const m=Eo;set_current_component(e);const g=e.$$={fragment:null,ctx:null,props:f,update:noop,not_equal:l,bound:blank_object(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(m?m.$$.context:t.context||[]),callbacks:blank_object(),dirty:h,skip_bound:!1,root:t.target||m.$$.root};p&&p(g.root);let v=!1;if(g.ctx=n?n(e,t.props||{},((t,n,...a)=>{const f=a.length?a[0]:n;return g.ctx&&l(g.ctx[t],g.ctx[t]=f)&&(!g.skip_bound&&g.bound[t]&&g.bound[t](f),v&&make_dirty(e,t)),n})):[],g.update(),v=!0,run_all(g.before_update),g.fragment=!!a&&a(g.ctx),t.target){if(t.hydrate){const e=function children(e){return Array.from(e.childNodes)}(t.target);g.fragment&&g.fragment.l(e),e.forEach(detach)}else g.fragment&&g.fragment.c();t.intro&&transition_in(e.$$.fragment),function mount_component(e,t,n,a){const{fragment:l,on_mount:f,on_destroy:p,after_update:h}=e.$$;l&&l.m(t,n),a||add_render_callback((()=>{const t=f.map(run$1).filter(is_function);p?p.push(...t):run_all(t),e.$$.on_mount=[]})),h.forEach(add_render_callback)}(e,t.target,t.anchor,t.customElement),flush()}set_current_component(m)}class SvelteComponent{$destroy(){!function destroy_component(e,t){const n=e.$$;null!==n.fragment&&(run_all(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}(this,1),this.$destroy=noop}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){this.$$set&&!function is_empty(e){return 0===Object.keys(e).length}(e)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}var Bo;function create_if_block$1(e){let t,n,a;return{c(){t=element("span"),n=text(e[2]),attr(t,"class",a=null_to_empty(bo.Classes.MoveNumber)+" svelte-10qut0i")},m(e,a){insert(e,t,a),append(t,n)},p(e,t){4&t&&set_data(n,e[2])},d(e){e&&detach(t)}}}function create_fragment$3(e){let t,n,a,l,f,p,h,m,g=(e[4]||"")+"",v=e[2]&&create_if_block$1(e);return{c(){t=element("span"),v&&v.c(),n=space(),a=element("span"),l=new HtmlTag,f=function empty(){return text("")}(),p=new HtmlTag,l.a=f,p.a=null,attr(a,"class",null_to_empty(bo.Classes.MoveText)+" svelte-10qut0i"),attr(t,"data-id",e[1]),attr(t,"class",null_to_empty(bo.Classes.MoveNode)+" svelte-10qut0i"),toggle_class(t,"customColor",e[0]),toggle_class(t,"selected",e[5])},m(y,_){insert(y,t,_),v&&v.m(t,null),append(t,n),append(t,a),l.m(e[3],a),append(a,f),p.m(g,a),h||(m=[listen(t,"click",e[7]),listen(t,"contextmenu",e[6]),listen(t,"touchstart",e[8]),listen(t,"touchend",e[9],{passive:!0})],h=!0)},p(e,[a]){e[2]?v?v.p(e,a):(v=create_if_block$1(e),v.c(),v.m(t,n)):v&&(v.d(1),v=null),8&a&&l.p(e[3]),16&a&&g!==(g=(e[4]||"")+"")&&p.p(g),2&a&&attr(t,"data-id",e[1]),1&a&&toggle_class(t,"customColor",e[0]),32&a&&toggle_class(t,"selected",e[5])},i:noop,o:noop,d(e){e&&detach(t),v&&v.d(),h=!1,run_all(m)}}}function instance$3(e,t,n){const a=createEventDispatcher();let l,{customColor:f}=t,{id:p}=t,{moveListEl:h}=t,{moveNumber:m}=t,{san:g}=t,{annotation:v}=t,{selected:y}=t;function dispatchContextMenu(e){e.preventDefault(),a(bo.Events.OpenContextMenu)}function handleNodeClick(e){a(bo.Events.Click)}return e.$$set=e=>{"customColor"in e&&n(0,f=e.customColor),"id"in e&&n(1,p=e.id),"moveListEl"in e&&n(10,h=e.moveListEl),"moveNumber"in e&&n(2,m=e.moveNumber),"san"in e&&n(3,g=e.san),"annotation"in e&&n(4,v=e.annotation),"selected"in e&&n(5,y=e.selected)},e.$$.update=()=>{1&e.$$.dirty&&function updateNodeColorVariables(e){const t=h.querySelector(`[${jr.ComponentIdentifier}="${p}"]`);t&&addCustomColor(t,e)}(f)},[f,p,m,g,v,y,dispatchContextMenu,handleNodeClick,function handleTouchStart(e){handleNodeClick(),l=setTimeout((()=>{dispatchContextMenu(e),l=null}),bo.Constants.TouchDelay)},function handleTouchEnd(){l&&clearTimeout(l)},h]}class Move_node extends SvelteComponent{constructor(e){super(),init(this,e,instance$3,create_fragment$3,safe_not_equal,{customColor:0,id:1,moveListEl:10,moveNumber:2,san:3,annotation:4,selected:5})}}function createSvelteComponent({ComponentType:e,methods:t,options:n,replaceContainer:a=!0}){const l=a?function replaceContainer(e,t){const n=document.createDocumentFragment(),a=new e(Object.assign({},t,{target:n}));return t.target.replaceWith(n),a}(e,n):new e(n),f={destroy:function destroy(){l.$destroy()},el:n.target,get:function get2(e){if("string"==typeof e)return l.$$.ctx[e];return function pick(e,t){return t.reduce(((t,n)=>(Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]),t)),{})}(l.$$.ctx,e)},instance:l,on:function on(e,t){l.$on(e,t)},set:function set2(e){l.$set(e)}};return t&&t.length&&t.forEach((e=>{f[e]=l[e]})),f}!function(e){var t,n;(t=e.Nags||(e.Nags={})).$1="$1",t.$2="$2",t.$3="$3",t.$4="$4",t.$5="$5",t.$6="$6",t.$10="$10",t.$11="$11",t.$12="$12",t.$13="$13",t.$14="$14",t.$15="$15",t.$16="$16",t.$17="$17",t.$18="$18",t.$19="$19",t.$22="$22",t.$36="$36",t.$40="$40",t.$146="$146",t.$256="$256",(n=e.Values||(e.Values={})).$1="!",n.$2="?",n.$3="!!",n.$4="??",n.$5="!?",n.$6="?!",n.$10="=",n.$11="=",n.$12="=",n.$13="",n.$14="",n.$15="",n.$16="",n.$17="",n.$18="+-",n.$19="-+",n.$22="",n.$40="",n.$146="N",n.$256="=/"}(Bo||(Bo={}));const Fo={$1:"!",$2:"?",$3:"!!",$4:"??",$5:"!?",$6:"?!",$10:"=",$11:"=",$12:"=",$13:"",$14:"",$15:"",$16:"",$17:"",$18:"+-",$19:"-+",$22:"",$23:"",$32:"",$33:"",$36:"",$37:"",$40:"",$41:"",$44:"/=",$45:"=/",$132:"",$133:"",$146:"N",$256:"=/"},jo={"??":"?\\?","!?":"!\\?","-+":"-\\+","/=":"\\/\\=","=/":"=\\/\\","=":"s=",N:"N\\b"},$o=["!","?","!!","??","!?","?!","="],Ho=function invertObject(e){return Object.keys(e).reduce(((t,n)=>Object.assign(Object.assign({},t),{[e[n]]:n})),{})}(Fo),Vo=[{action:fo.AnnotationActions.AddAnnotation,code:Bo.Nags.$1,display:Fo.$1,meaning:Or.Translation.Annotations.GoodMove},{action:fo.AnnotationActions.AddAnnotation,code:Bo.Nags.$2,display:Fo.$2,meaning:Or.Translation.Annotations.BadMove},{action:fo.AnnotationActions.AddAnnotation,code:Bo.Nags.$3,display:Fo.$3,meaning:Or.Translation.Annotations.ExcellentMove},{action:fo.AnnotationActions.AddAnnotation,code:Bo.Nags.$4,display:Fo.$4,meaning:Or.Translation.Annotations.Blunder},{action:fo.AnnotationActions.AddAnnotation,code:Bo.Nags.$5,display:Fo.$5,meaning:Or.Translation.Annotations.SpeculativeMove},{action:fo.AnnotationActions.AddAnnotation,code:Bo.Nags.$6,display:Fo.$6,meaning:Or.Translation.Annotations.DubiousMove},{action:fo.AnnotationActions.AddAdditionalAnnotation,code:Bo.Nags.$10,display:Fo.$10,meaning:Or.Translation.Annotations.Drawish},{action:fo.AnnotationActions.AddAdditionalAnnotation,code:Bo.Nags.$13,display:Fo.$13,meaning:Or.Translation.Annotations.Unclear},{action:fo.AnnotationActions.AddAdditionalAnnotation,code:Bo.Nags.$14,display:Fo.$14,meaning:Or.Translation.Annotations.WhiteHasSlightAdvantage},{action:fo.AnnotationActions.AddAdditionalAnnotation,code:Bo.Nags.$15,display:Fo.$15,meaning:Or.Translation.Annotations.BlackHasSlightAdvantage},{action:fo.AnnotationActions.AddAdditionalAnnotation,code:Bo.Nags.$16,display:Fo.$16,meaning:Or.Translation.Annotations.WhiteHasModerateAdvantage},{action:fo.AnnotationActions.AddAdditionalAnnotation,code:Bo.Nags.$17,display:Fo.$17,meaning:Or.Translation.Annotations.BlackHasModerateAdvantage},{action:fo.AnnotationActions.AddAdditionalAnnotation,code:Bo.Nags.$18,display:Fo.$18,meaning:Or.Translation.Annotations.WhiteHasDecisiveAdvantage},{action:fo.AnnotationActions.AddAdditionalAnnotation,code:Bo.Nags.$19,display:Fo.$19,meaning:Or.Translation.Annotations.BlackHasDecisiveAdvantage},{action:fo.AnnotationActions.AddAdditionalAnnotation,code:Bo.Nags.$22,display:Fo.$22,meaning:Or.Translation.Annotations.PositionInZuqZwang},{action:fo.AnnotationActions.AddAdditionalAnnotation,code:Bo.Nags.$36,display:Fo.$36,meaning:Or.Translation.Annotations.WithInitiative},{action:fo.AnnotationActions.AddAdditionalAnnotation,code:Bo.Nags.$40,display:Fo.$40,meaning:Or.Translation.Annotations.WithCompensation},{action:fo.AnnotationActions.AddAdditionalAnnotation,code:Bo.Nags.$146,display:Fo.$146,meaning:Or.Translation.Annotations.Novelty},{action:fo.AnnotationActions.AddAdditionalAnnotation,code:Bo.Nags.$256,display:Fo.$256,meaning:Or.Translation.Annotations.WithAttack}];function normalizeAnnotation(e){return e&&(Object.prototype.hasOwnProperty.call(Fo,e)||Object.prototype.hasOwnProperty.call(Ho,e))?function isNagFormat(e){return Boolean(e&&"$"===e.charAt(0))}(e)?Fo[e]:normalizeAnnotation(Ho[e]):e||""}function generateAnnotationString(e){let t="";return e.annotation&&(t=`${t}${normalizeAnnotation(e.annotation)}`),e.additionalAnnotation&&e.additionalAnnotation[0]&&(t=`${t}&nbsp;${normalizeAnnotation(e.additionalAnnotation[0])}`),t}function getNodeDisplayNumber({node:e,previous:t,startingMoveNumber:n=1}){let a="";if(!e)return a;const l=function getMoveNumber$1({color:e,ply:t,startingMoveNumber:n=1}){let a;return a=e===rr.ColorsAsNumbers.White?Math.ceil(t/2+1):Math.floor(t/2+1),a+(n-1)}({color:e.color,ply:e.moveNumber,startingMoveNumber:n});return function shouldShowDisplayNumber(e,t){return Boolean(e.color===rr.ColorsAsNumbers.White||e.ids&&0===e.ids.move||t&&"string"==typeof t.comment||t&&t.lines&&t.lines.length)}(e,t)&&(a+=`${l}.`,function shouldShowEllipsisOnBlackMoveNumber(e,t){return Boolean(e.color===rr.ColorsAsNumbers.Black&&(t&&"string"==typeof t.comment||t&&t.lines&&t.lines.length||e.ids&&0===e.ids.move))}(e,t)&&(a+="..")),a}const Uo={[vo.Keys.MoveNumber]:function touchMoveNumber({game:e,node:t}){return getNodeDisplayNumber({node:t,previous:(null==t?void 0:t.previous)?e.getNodeByIds(t.previous):void 0,startingMoveNumber:e.getStartingMoveNumber()})},[vo.Keys.Annotation]:function touchAnnotations({node:e}){return generateAnnotationString(e)},[vo.Keys.CustomColor]:function touchCustomColor({node:e}){return e.customColor},[vo.Keys.San]:function touchSan({moveList:e,node:t,translations:n}){return formatText({color:getColorAsWord(null==t?void 0:t.color),moveListDisplayType:e.getOptions().moveListDisplayType,san:null==t?void 0:t.san,translations:n})}};function createMoveNode({moveList:e,game:t,node:n,options:a,emitter:l,translations:f}){if(isLine(n))throw new ChessError({code:So.BadData,data:n,message:"Invalid move ids."});const p=function createMoveNodeComponent(e,{anchor:t,props:n}){return createSvelteComponent({ComponentType:Move_node,options:{anchor:t,props:n,target:e},replaceContainer:!1})}(a.target,{anchor:a.anchor,props:{annotation:generateAnnotationString(n),id:getId(),moveListEl:e.dom.getElement(),moveNumber:Uo[vo.Keys.MoveNumber](createTouchContext()),san:Uo[vo.Keys.San](createTouchContext()),selected:!1}}),h={addNodeStyles:function addNodeStyles(e){const t=getElement();e&&Object.assign(t.style,e)},destroy:p.destroy,getElement:getElement,getId:getId,getNodeData:getNodeData,ids:n.ids,insertBeforeNode:function insertBeforeNode(e){const t=getElement();t.parentNode&&t.parentNode.insertBefore(e,t)},insertAfterNode:function insertAfterNode(t){const n=e.dom.getElement(),a=getElement();a.nextElementSibling?n.insertBefore(t,a.nextElementSibling):n.appendChild(t)},removeNodeStyles:function removeNodeStyles(){getElement().removeAttribute("style")},set:p.set,touch:function touch(e){p.set({[e]:Uo[e](createTouchContext())})},touchNextNode:function touchNextNode(t=[vo.TouchableKeys.MoveNumber]){const a=e.api.getMoveNode({line:n.ids.line,move:n.ids.move+1});a&&t.forEach((e=>a.touch(e)))}};return function registerComponentListeners(){p.on(bo.Events.Click,(function selectNode2(){t.selectNode(n.ids.line,n.ids.move)})),p.on(bo.Events.OpenContextMenu,(function emitContextMenuOpen(){e.api.getOptions().moveListContextMenuEnabled&&(t.selectNode(n.ids.line,n.ids.move),l.emit(bo.Events.OpenContextMenu,{node:n}))}))}(),h;function createTouchContext(){return{game:{getNodeByIds:t.getNodeByIds,getStartingMoveNumber:t.getStartingMoveNumber},moveList:{getOptions:e.api.getOptions},node:getNodeData(),translations:f}}function getElement(){var t;const a=e.dom.getElement(),l=`[${jr.ComponentIdentifier}="${getId()}"]`,f=null!=(t=a.querySelector(l))?t:p.el.querySelector(l);if(!f)throw new ChessError({code:So.ElementNotFound,data:n.ids,message:`Move node element was not found for ${n.ids.line}-${n.ids.move}.`});return f}function getId(){const e=n.ids;return`move-node-${e.line}-${e.move}`}function getNodeData(){return t.getNodeByIds(n.ids)}}function createAddNodeMethod(e){return function addNode(t,n){var a;const{game:l,getComponent:f,state:p,stateMachine:h,translations:m}=e,g=t.ids;return void 0===p.nodes[g.line]&&(p.nodes[g.line]={}),void 0!==p.nodes[g.line][g.move]&&p.nodes[g.line][g.move].destroy(),p.nodes[g.line][g.move]=createMoveNode({emitter:h,game:l,moveList:null!=(a=f())?a:e.el,node:t,options:n,translations:m}),p.nodes[g.line][g.move]}}function disableContextMenu(e){e.preventDefault()}function createDestroyMethod(e){return function destroy(){const{dom:t,el:n,queue:a}=e;n.classList.remove(jr.ClassNames.Component),n.removeEventListener("contextmenu",disableContextMenu),t.reset(),a.clear()}}function stripHTMLTags(e,t){if(t){const t=["br"],n=t.map((e=>`\\/${e}`)),a=t.concat(n).join("|"),l=new RegExp(`<(?!${a}s*/?)[^>]+>`,"g");return e.replace(l,"")}return e.replace(/<\/?[^>]+(>|$)/g,"")}function cleanCommentString(e){let t;return t=function decodeHTMLEntities(e){const t=document.createElement("textarea");return t.innerHTML=e.replace(/&nbsp;/g," "),t.value}(stripHTMLTags(e))," "===t&&(t=""),t}function create_fragment$2(e){let t,n,a,l,f;return{c(){t=element("span"),n=text(e[2]),attr(t,"class",null_to_empty(Zr.Classes.Component)+" svelte-17mydln"),attr(t,"contenteditable","true"),attr(t,"placeholder",a=e[0]["Add Comment..."]())},m(a,p){insert(a,t,p),append(t,n),e[7](t),l||(f=[listen(t,"focusin",e[3]),listen(t,"focusout",e[4]),listen(t,"input",e[5])],l=!0)},p(e,[l]){4&l&&set_data(n,e[2]),1&l&&a!==(a=e[0]["Add Comment..."]())&&attr(t,"placeholder",a)},i:noop,o:noop,d(n){n&&detach(t),e[7](null),l=!1,run_all(f)}}}function instance$2(e,t,n){let a;const l=createEventDispatcher();let f,{comment:p=""}=t,{translations:h}=t;return function onMount(e){get_current_component().$$.on_mount.push(e)}((()=>{f.focus()})),e.$$set=e=>{"comment"in e&&n(6,p=e.comment),"translations"in e&&n(0,h=e.translations)},e.$$.update=()=>{64&e.$$.dirty&&n(2,a=p||"")},[h,f,a,function selectCommentText(){p&&document.execCommand("selectAll",!1,null)},function handleFocusOut(){l(Zr.Events.FocusOut,f.innerHTML)},function handleInput(){l(Zr.Events.CommentChanged,f.innerHTML)},p,function span_binding(e){Mo[e?"unshift":"push"]((()=>{f=e,n(1,f)}))}]}class Editable_comment extends SvelteComponent{constructor(e){super(),init(this,e,instance$2,create_fragment$2,safe_not_equal,{comment:6,translations:0})}}function getLineEditableCommentConfig(e,{moveList:t,api:n}){let a,l;l=0===e.id?t.dom.getElement():getLineElement(e.id,t.dom.getElement());const f=t.api.getMoveNode({line:e.id,move:0});return f&&(a=f.getElement()),{anchor:a,comment:e.initComment,element:l,handler:function saveComment(a,l){!function updateLineComment(e,{api:t,comment:n,moveList:a,noUIUpdates:l}){t.updateLineComment("string"==typeof n&&n.length>0?n:void 0,e.id),!l&&e.initComment&&(0===e.id?a.dom.getElement():getLineElement(e.id,a.dom.getElement())).prepend(a.dom.addComment(e))}(e,{api:n,comment:a,moveList:t,noUIUpdates:l})}}}function createInsertEditableCommentMethod(e){return function insertEditableComment(t){const{dom:n,game:a,getComponent:l,translations:f}=e;let p,h;if(isNode(t))p=function getNodeEditableCommentConfig(e,{moveList:t,api:n}){const a=t.api.getMoveNode(e.ids);if(!a)throw new ChessError({code:So.ElementNotFound,data:e,message:"No move node found."});return{comment:e.comment,element:a.getElement(),handler:function saveComment(e,l){!function updateNodeComment(e,{api:t,comment:n,moveList:a,noUIUpdates:l}){t.updateNode(e.ids,{comment:"string"==typeof n&&n.length>0?n:void 0}),l||(e.getNodeData().comment&&e.getElement().appendChild(a.dom.addComment(e.getNodeData())),e.touchNextNode())}(a,{api:n,comment:e,moveList:t,noUIUpdates:l})}}}(t,{api:a,moveList:l()});else{if(!isLine(t))throw new ChessError({code:So.BadData,data:t,message:"No line or node found"});p=getLineEditableCommentConfig(t,{api:a,moveList:l()})}n.removeEditableComment(),e.editableCommentComponent=function createEditableCommentComponent(e,{anchor:t,props:n}){return createSvelteComponent({ComponentType:Editable_comment,options:{anchor:t,props:n,target:e},replaceContainer:!1})}(p.element,{anchor:p.anchor,props:{comment:p.comment,translations:f}}),e.editableCommentComponent.on(Zr.Events.CommentChanged,(function handleCommentChange({detail:e}){clearTimeout(h),h=window.setTimeout((()=>{!function saveComment(e=""){const t=cleanCommentString(e);p.handler(t,!0)}(e)}),Zr.Constants.CommentUpdateDelay)})),e.editableCommentComponent.on(Zr.Events.FocusOut,(function saveAndDestroy({detail:t}){clearTimeout(h);const n=cleanCommentString(t);p.handler(n),e.dom.removeEditableComment()}))}}var Go,qo,Wo,zo;function getCommentElementId(e){if(isLine(e))return`line-comment-${e.id}`;if(isNode(e))return`move-node-comment-${e.ids.line}-${e.ids.move}`;throw new ChessError({code:So.BadData,data:e,message:"No line or node found"})}function createAddCommentMethod(e){return function addComment(t,n=!0,a){const{dom:l,options:f,state:p,stateMachine:h}=e,m=Boolean("isCommentEnabled"in t?t.isCommentEnabled:n),g=function createCommentComponent({commentLinkData:e,lineOrNode:t,context:n}){const a=getCommentElementId(t);let l,f,p,h=!1;if(isLine(t))l=t.initComment,p={line:t.id,move:0};else{if(!isNode(t))throw new ChessError({code:So.BadData,data:t,message:"No line or node found"});l=t.comment,p=t.ids}return function createElement(){var t;const p=e?"a":"span";f=document.createElement(p),f.setAttribute(jr.ComponentIdentifier,a),f.innerHTML=stripHTMLTags((null!=(t=null==e?void 0:e.text)?t:l)||"",!0),f.classList.add(bo.Classes.Comment,bo.Classes.StaticComment),e&&(f.setAttribute("href",e.href),f.setAttribute("target","_blank")),n.editingEnabled&&!e&&registerClickListeners()}(),{deregisterClickListeners:deregisterClickListeners,destroy:destroy,getElement:()=>f,getId:()=>a,registerClickListeners:registerClickListeners};function destroy(){deregisterClickListeners(),n.removeCommentFromMoveList(a)}function registerClickListeners(){h||(f.addEventListener("click",handleCommentClick,{once:!0}),f.addEventListener("contextmenu",handleContextMenuClick),h=!0)}function deregisterClickListeners(){f.removeEventListener("click",handleCommentClick),f.removeEventListener("contextmenu",handleContextMenuClick),h=!1}function handleCommentClick(){destroy(),n.emitter.emit(Go.Events.Click,t)}function handleContextMenuClick(e){e.preventDefault(),n.emitter.emit(bo.Events.OpenContextMenu,{node:{ids:p}})}}({commentLinkData:null!=a?a:null,lineOrNode:t,context:{editingEnabled:f.moveListContextMenuEnabled&&m,emitter:h,removeCommentFromMoveList(){l.removeComment(t)}}});return p.comments[g.getId()]&&l.removeComment(t),p.comments[g.getId()]=g,g.getElement()}}function isMainLine(e){return 0===e}function createInsertNodeMethod(e){return function insertNode({node:t,nodeToInsertAfter:n}){const{dom:a,el:l,placeholders:f}=e,p=f[jr.Placeholders.Moves],h=isMainLine(t.ids.line)?p:void 0;let m=l;if(n){const e=n.getElement();if(!e)throw new ChessError({code:So.ElementNotFound,message:"Node element does not exist."});m=e.parentNode}a.addNode(t,{anchor:h,target:m})}}function createLineElement(e,...t){const n=document.createElement("span");return n.setAttribute(jr.ComponentIdentifier,`line-${e}`),n.classList.add(...t),n}function createInsertVariationMethod(e){return function insertVariation({node:t}){const{api:n,dom:a,el:l,game:f}=e,p=t.ids,h=f.getRawLines()[p.line],m={line:h.parentId,move:h.atMoveNode},g=n.getMoveNode({line:m.line,move:m.move+1}),v=f.getNodeByIds(m);if(!v||isLine(v))throw new ChessError({code:So.ElementNotFound,message:"Anchor node element for variation not found."});let y=l;const _=createLineElement(h.id,jr.ClassNames.Variation);if(0===v.ids.line&&_.classList.add(jr.ClassNames.MainLine),a.addNode(t,{target:_}),v.lines&&v.lines.length>1)y=getLineElement(v.lines[v.lines.length-2],l);else{const e=n.getMoveNode(v.ids);e&&(y=e.getElement())}y&&y.after(_),void 0!==g&&g.touch(vo.TouchableKeys.MoveNumber)}}function getVariations(e,t){return t.lines?t.lines.reduce(((t,n)=>(t.push(e[n]),t)),[]):[]}function createLineVariationElements({api:e,depth:t,parentLineEl:n,lines:a,line:l}){let f;f=1===t?document.createDocumentFragment():createLineElement(l.id,jr.ClassNames.Variation),l.initComment&&f.appendChild(e.addComment(l)),l.forEach((n=>{const l=e.addNode(n,{target:f});n.comment&&l.getElement().appendChild(e.addComment(n)),n.lines&&getVariations(a,n).forEach((n=>{createLineVariationElements({api:e,depth:t+1,line:n,lines:a,parentLineEl:f})}))})),n.appendChild(f)}function createLoadMethod(e){return function load2(){const{api:t,dom:n,el:a,game:l,placeholders:f}=e,p=f[jr.Placeholders.Moves];n.reset();const h=l.getRawLines();h[0].initComment&&a.insertBefore(n.addComment(h[0]),p),h[0].forEach((e=>{var t,f;const m=n.addNode(e,{anchor:p,target:a});if(e.comment&&m.getElement().appendChild(n.addComment(e)),(null==(t=e.commands)?void 0:t.text)&&(null==(f=e.commands)?void 0:f.href)){const{text:t,href:n}=e.commands;l.hml.addCommentLink({node:e,text:t,href:n})}e.lines&&getVariations(h,e).forEach((e=>{const t=createLineElement(e.id,jr.ClassNames.Variation,jr.ClassNames.MainLine);createLineVariationElements({api:{addComment:n.addComment,addNode:n.addNode},depth:1,line:e,lines:h,parentLineEl:t}),a.insertBefore(t,p)}))}));const m=l.getSelectedNode();m&&t.selectNode(m.ids),function restoreCustomColorsData({dom:e,game:t}){t.getRawLines().forEach((n=>{n.forEach((n=>{const a=t.getNodeByIds(n.ids);if(!isNode(a))return;const l=a.customColor;l&&e.updateMoveNodeComponent(n.ids,{customColor:l})}))}))}(e),e.state.nodeLimit&&e.game.hml.updateNodeLimits(e.state.nodeLimit)}}function createRemoveCommentMethod(e){return function removeComment(t){const{state:n}=e,a=getCommentElementId(t),l=e.el;n.comments[a]&&(!function removeCommentElement(e,t){const n=t.querySelector(`[${jr.ComponentIdentifier}="${getCommentElementId(e)}"`);n&&n.parentNode&&n.parentNode.removeChild(n)}(t,l),delete n.comments[a])}}function createRemoveEditableCommentMethod(e){return function removeEditableComment(){if(void 0!==e.editableCommentComponent){try{e.editableCommentComponent.destroy()}catch(t){}e.editableCommentComponent=void 0}}}function createRemoveLineMethod(e){return function removeLine(t){const{api:n,dom:a,el:l,state:f}=e,p=t.id;if(void 0===f.nodes[p])throw new ChessError({code:So.BadData,data:t,message:`No line with id ${p} found`});f.nodes[p][0]&&a.removeNode({line:p,move:0});const h=getLineElement(p,l);let m;h&&h.parentNode.removeChild(h),delete f.nodes[p],void 0!==t.atMoveNode&&void 0!==t.parentId&&(m=n.getMoveNode({line:t.parentId,move:t.atMoveNode+1})),m&&m.touch(vo.TouchableKeys.MoveNumber)}}function createRemoveNodeMethod(e){return function removeNode({line:t,move:n}){const{api:a,state:l}=e,f=a.getMoveNode({line:t,move:n});if(!f)return;const p=Object.keys(l.nodes[f.ids.line]).length-1;if(l.nodes[f.ids.line][f.ids.move]!==l.nodes[f.ids.line][p])for(let e=p;e>f.ids.move;e--)l.nodes[f.ids.line][e].destroy(),delete l.nodes[f.ids.line][e];f.destroy(),delete l.nodes[f.ids.line][f.ids.move],function removeOrphanedElements({el:e,game:t,state:n}){const a=t.getRawLines();Object.keys(n.nodes).forEach((t=>{var l;a[t]||(Object.values(n.nodes[t]).forEach((e=>e.destroy())),null==(l=getLineElement(Number(t),e))||l.remove(),delete n.nodes[t])}))}(e);const h=a.getMoveNode({line:f.ids.line,move:f.ids.move+1});h&&h.touch(vo.TouchableKeys.MoveNumber)}}function createResetMethod(e){return function reset(){const{dom:t,el:n,state:a,placeholders:l}=e;t.removeEditableComment(),n.innerHTML="",a.comments={},a.nodes={},a.selectedNode=void 0,n.appendChild(l[jr.Placeholders.Moves]),n.appendChild(l[jr.Placeholders.GameResult])}}function createSetResultNodeMethod(e){return function setResultNode(t){var n;const{el:a}=e,l=a.querySelector(`.${bo.Classes.GameResultNode}`),f=e.placeholders[jr.Placeholders.GameResult];if(l&&(null==(n=l.parentElement)||n.removeChild(l)),t===rr.Results.None)return;const p=document.createElement("span");p.classList.add(bo.Classes.GameResultNode),p.innerText=t,a.insertBefore(p,f)}}function createUpdateLineComponent(e){return function updateLineComponent(t,n){var a;const{dom:l,game:f}=e,p=f.getLine(t);if(!p)return;const{initComment:h}=n;if(void 0!==h){const t=0===p.id?null!=(a=null==l?void 0:l.getElement())?a:e.el:getLineElement(p.id,e.el);null==t||t.prepend(l.addComment(p))}}}function createUpdateMoveNodeComponent(e){return function updateMoveNodeComponent(t,n){const{api:a,dom:l,game:f}=e,p=f.getNodeByIds(t),h=a.getMoveNode(t);if(!p||isLine(p)||!h)return;const m=null==h?void 0:h.getElement(),g=[],{additionalAnnotation:v,annotation:y,comment:_,customColor:b,isCommentEnabled:C}=n;if(void 0===v&&void 0===y||g.push(vo.TouchableKeys.Annotation),void 0!==_)if(""===_)l.removeComment(p);else{const e=h.getNodeData(),t=l.addComment(e,null==C||C);m.appendChild(t)}void 0!==b&&g.push(vo.TouchableKeys.CustomColor),g.forEach((e=>h.touch(e)))}}function createPluginsAPI(e=[],t,n=createEventEmitter()){const a=new Map;let l=t;return addMany(e),__spreadProps(__spreadValues({add:addPlugin,addMany:addMany,destroy:function destroy(){a.forEach((e=>remove(e.name)))}},n),{getAll:function getAll(){return[...a.values()]},getContext:function getContext(){return l},getOne:function getOne(e){return a.get(e)},has:a.has.bind(a),remove:remove,setContext:function setContext(e){l=e,n.emit(Wo.Events.ContextSet,l)}});function addPlugin(e){var t;return!!e.name&&(a.has(e.name)&&remove(e.name),a.set(e.name,e),null==(t=e.create)||t.call(e,l),n.emit(Wo.Events.PluginAdded,e),!0)}function addMany(e){if(!e||0===e.length)return!1;return(Array.isArray(e)?e:[e]).reduce((function pluginsAddedSuccessfully(e,t){return addPlugin(t)||(e=!1),e}),!0)}function remove(e){var t;const f=a.get(e);return!!f&&(null==(t=f.destroy)||t.call(f,l),a.delete(e),n.emit(Wo.Events.PluginRemoved,f),!0)}}function createHMLPluginsAPI(e,t){return function withAPI(e,t,n){const a=function createExtendAPI$1(e,t){return function extendAPI(n,a){const l=e[n];return e[n]=a(t),function destroyOverride(){var t,a;null==(a=(t=e[n]).destroy)||a.call(t),e[n]=l}}}(t,n),l=new Map;return e.on(Wo.Events.PluginAdded,(function pluginAddedEventHandler(e){if(e.api){const t=a(e.name,e.api);t&&l.set(e.name,t)}})),e.on(Wo.Events.PluginRemoved,(function pluginRemovedEventHandler(e){const t=l.get(e.name);null==t||t(),l.delete(e.name)})),e}(createPluginsAPI([],t),e,t)}function createHorizontalMoveList({el:e,game:t,nodeLimit:n,options:a,plugins:l=[createContextMenuPlugin()],stateMachineListeners:f,stateMachine:p,queue:h,placeholders:m,scrollContainer:g,translations:v=Dr}){const y={},_={api:y,contextMenuActions:Po,dom:{getElement:()=>e},editableCommentComponent:void 0,el:e,game:t,getComponent:function getComponent(){return k},options:a,queue:h,placeholders:m,scrollContainer:g,state:{comments:{},nodes:{},nodeLimit:n,selectedNode:void 0},stateMachine:p,stateMachineListeners:f,translations:v},{dom:b,game:C}=_,S=createHMLPluginsAPI(C.hml,_);S.addMany(l),Object.assign(y,__spreadValues({},function createHMLComponentAPI(e){return{getComments:()=>e.state.comments,getContext:()=>e,getContextMenuActions:createGetContextMenuActions(e),getMoveNode:createGetMoveNodeMethod(e),getNodes:()=>e.state.nodes,getOptions:()=>e.options,getSelectedNode:()=>e.state.selectedNode,resetSelectedNode:createResetSelectedNode(e),selectLineStart:createSelectLineStart$1(e),selectNode:createSelectNodeMethod(e),setOptions:createSetOptionsMethod(e)}}(_))),Object.assign(b,__spreadValues({},function createHMLDOMService(e){const{el:t,placeholders:n}=e;return t.classList.add(jr.ClassNames.Component),t.addEventListener("contextmenu",disableContextMenu),t.appendChild(n[jr.Placeholders.Moves]),t.appendChild(n[jr.Placeholders.GameResult]),{addComment:createAddCommentMethod(e),addNode:createAddNodeMethod(e),destroy:createDestroyMethod(e),getElement:()=>t,insertEditableComment:createInsertEditableCommentMethod(e),insertNode:createInsertNodeMethod(e),insertVariation:createInsertVariationMethod(e),load:createLoadMethod(e),removeComment:createRemoveCommentMethod(e),removeEditableComment:createRemoveEditableCommentMethod(e),removeLine:createRemoveLineMethod(e),removeNode:createRemoveNodeMethod(e),reset:createResetMethod(e),setResultNode:createSetResultNodeMethod(e),setScrollContainer:t=>e.scrollContainer=t,updateLineComponent:createUpdateLineComponent(e),updateMoveNodeComponent:createUpdateMoveNodeComponent(e)}}(_))),C.extendAPI(Ie.Plugin.Name,{addContextMenuActions:()=>function createAddContextMenuActions(e){return function addContextMenuActions(t){Object.keys(t).forEach((n=>{e.contextMenuActions[n]=t[n]}))}}(_)});const k={api:y,destroy:function destroy(){S.destroy()},dom:b,plugins:S};return k}function initializeMoveList({context:e,coreContext:t}){var n,a;const{el:l,nodeLimit:f,scrollContainer:p,translations:h}=e,{api:m}=t,g=m.getOptions();null==(a=null==(n=e.moveList)?void 0:n.destroy)||a.call(n),e.methods.destroy(),e.stateMachineListeners.push([Go.Events.Click,e.methods.handleCommentClick]),e.stateMachine.on(Go.Events.Click,e.methods.handleCommentClick),e.moveList=createHorizontalMoveList({el:l,game:m,nodeLimit:f,options:{moveListContextMenuEnabled:g.moveListContextMenuEnabled,moveListDisplayType:g.moveListDisplayType},queue:e.queue,placeholders:e.placeholders,scrollContainer:p,stateMachine:e.stateMachine,stateMachineListeners:e.stateMachineListeners,translations:h}),e.moveList.dom.load(),e.moveList.dom.setResultNode(m.getResult())}(function(e){e.Click="click"})((qo=Go||(Go={})).Events||(qo.Events={})),function(e){e.PluginAdded="PluginAdded",e.PluginRemoved="PluginRemoved",e.ContextSet="ContextSet"}((zo=Wo||(Wo={})).Events||(zo.Events={}));function get_each_context$1(e,t,n){const a=e.slice();return a[9]=t[n],a}function get_each_context_1(e,t,n){const a=e.slice();return a[12]=t[n],a}function create_each_block_1(e){let t,n,a,l,f,p=(e[1][e[12].name]?e[1][e[12].name]():e[12].name)+"";function click_handler(...t){return e[6](e[12],...t)}return{c(){t=element("span"),n=text(p),attr(t,"class",a=null_to_empty(mo.Classes.ActionName)+" svelte-1hoe0fe")},m(e,a){insert(e,t,a),append(t,n),l||(f=listen(t,"click",click_handler),l=!0)},p(t,a){e=t,3&a&&p!==(p=(e[1][e[12].name]?e[1][e[12].name]():e[12].name)+"")&&set_data(n,p)},d(e){e&&detach(t),l=!1,f()}}}function create_each_block$1(e){let t,n,a,l,f,p,h,m=e[9].display+"";function click_handler_1(){return e[7](e[9])}return{c(){t=element("span"),n=text(m),a=space(),attr(t,"alt",l=e[1][e[9].meaning]()),attr(t,"class",f=null_to_empty(mo.Classes.Annotation)+" svelte-1hoe0fe")},m(e,l){insert(e,t,l),append(t,n),append(t,a),p||(h=listen(t,"click",click_handler_1),p=!0)},p(n,a){e=n,2&a&&l!==(l=e[1][e[9].meaning]())&&attr(t,"alt",l)},d(e){e&&detach(t),p=!1,h()}}}function create_fragment$1(e){let t,n,a,l,f,p,h,m,g=e[0],v=[];for(let b=0;b<g.length;b+=1)v[b]=create_each_block_1(get_each_context_1(e,g,b));let y=Vo,_=[];for(let b=0;b<y.length;b+=1)_[b]=create_each_block$1(get_each_context$1(e,y,b));return{c(){t=element("div");for(let e=0;e<v.length;e+=1)v[e].c();n=space(),a=element("div"),l=space(),f=element("div");for(let e=0;e<_.length;e+=1)_[e].c();p=space(),attr(a,"class",null_to_empty(mo.Classes.Divider)+" svelte-1hoe0fe"),attr(f,"class",null_to_empty(mo.Classes.AnnotationsContainer)+" svelte-1hoe0fe"),attr(t,"class",null_to_empty(mo.Classes.Component)+" svelte-1hoe0fe")},m(g,y){insert(g,t,y);for(let e=0;e<v.length;e+=1)v[e].m(t,null);append(t,n),append(t,a),append(t,l),append(t,f);for(let e=0;e<_.length;e+=1)_[e].m(f,null);append(t,p),e[8](t),h||(m=listen(document.body,"click",e[4]),h=!0)},p(e,[a]){if(11&a){let l;for(g=e[0],l=0;l<g.length;l+=1){const f=get_each_context_1(e,g,l);v[l]?v[l].p(f,a):(v[l]=create_each_block_1(f),v[l].c(),v[l].m(t,n))}for(;l<v.length;l+=1)v[l].d(1);v.length=g.length}if(10&a){let t;for(y=Vo,t=0;t<y.length;t+=1){const n=get_each_context$1(e,y,t);_[t]?_[t].p(n,a):(_[t]=create_each_block$1(n),_[t].c(),_[t].m(f,null))}for(;t<_.length;t+=1)_[t].d(1);_.length=y.length}},i:noop,o:noop,d(n){n&&detach(t),destroy_each(v,n),destroy_each(_,n),e[8](null),h=!1,m()}}}function instance$1(e,t,n){let{actions:a}=t,{translations:l}=t;const f=createEventDispatcher();let p;return e.$$set=e=>{"actions"in e&&n(0,a=e.actions),"translations"in e&&n(1,l=e.translations)},[a,l,p,f,function handleDocumentClick(e){e.target.classList.contains(mo.Classes.Component)||f(fo.Events.Close)},function getElement(){return p},(e,t)=>f(fo.Events.ActionClicked,{action:e,event:t}),e=>f(fo.Events.AnnotationClicked,{action:e.action,data:e.code}),function div2_binding(e){Mo[e?"unshift":"push"]((()=>{p=e,n(2,p)}))}]}class Context_menu extends SvelteComponent{constructor(e){super(),init(this,e,instance$1,create_fragment$1,safe_not_equal,{actions:0,translations:1,getElement:5})}get getElement(){return this.$$.ctx[5]}}function createContextMenu({actions:e,el:t,moveNode:n,emitter:a,translations:l}){const f=null==n?void 0:n.getElement(),p=function createContextMenuComponent(e,{anchor:t,props:n}){return createSvelteComponent({ComponentType:Context_menu,methods:["getElement"],options:{anchor:t,props:n,target:e},replaceContainer:!1})}((null==f?void 0:f.parentElement)||t,{anchor:f,props:{actions:e,translations:l}});return setPosition(),function registerListeners(){p.on(fo.Events.ActionClicked,createEventHandler(fo.Events.ActionClicked)),p.on(fo.Events.AnnotationClicked,createEventHandler(fo.Events.AnnotationClicked)),p.on(fo.Events.Close,(()=>a.emit(fo.Events.Close))),t.addEventListener("scroll",function debounce(e,t){let n;return function run2(...a){clearTimeout(n),n=setTimeout((()=>{n=null,e(...a)}),t)}}(setPosition,50))}(),{destroy:p.destroy};function createEventHandler(e){return function handleEvent({detail:t}){a.emit(e,{action:t.action,data:t.data,event:t.event,moveNode:n.getNodeData()})}}function setPosition(){const e=null==p?void 0:p.getElement();if(!e)return;const{left:n,top:a}=function getContextMenuPosition({contextMenu:e,moveNode:t,padding:n={x:10,y:20}}){const a=t.y+n.y-window.pageYOffset,l=window.innerHeight-e.height,f={left:0,top:0};return f.top=Math.min(a,l),f.bottom=f.top+e.height,t.x>window.innerWidth-e.width?f.left=t.x+t.width-e.width:(a<l&&(n.x=0),f.left=t.x+n.x),f}({contextMenu:e.getBoundingClientRect(),moveNode:(null==f?void 0:f.getBoundingClientRect())||t.getBoundingClientRect()});e.style.left=`${n}px`,e.style.top=`${a}px`}}function initializeContextMenu(e){const{el:t,moveList:n,stateMachine:a,methods:{destroyContextMenu:l},translations:f}=e;function handleContextMenuAction(e){l();const t=function createContextMenuActionHandler(e,t){return function handleContextMenuAction({action:n,data:a,event:l,moveNode:f}){const p=t.api.getMoveNode(f.ids);if(!p)throw new ChessError({code:So.BadData,data:f.ids,message:"No move node found."});n.handler(f,{context:e,data:a,moveList:t,moveNodeComponent:p,event:l}),e.queue.flush()}}(n.api.getContext(),n);t(e)}function handleAnnotationAction({action:e,data:t,moveNode:a}){l();const f=n.api.getMoveNode(a.ids);if(!f)throw new ChessError({code:So.BadData,data:a.ids,message:"No move node found."});const p={data:t,game:n.api.getContext().game,moveNodeComponent:f,node:a};e===fo.AnnotationActions.AddAnnotation?function addAnnotation({node:e,game:t,data:n,moveNodeComponent:a}){const l=normalizeAnnotation(n),f=a.getNodeData().annotation===l?void 0:l;t.updateNode(e.ids,{annotation:f}),a.touch(vo.TouchableKeys.Annotation)}(p):e===fo.AnnotationActions.AddAdditionalAnnotation&&function addAdditionalAnnotation({node:e,game:t,data:n,moveNodeComponent:a}){const l=normalizeAnnotation(n),f=a.getNodeData().additionalAnnotation,p=(null==f?void 0:f[0])===l?void 0:[l];t.updateNode(e.ids,{additionalAnnotation:p}),a.touch(vo.TouchableKeys.Annotation)}(p)}function createOpenContextMenuHandler(p){var h;n.api.selectNode(p.node.ids);const m=n.api.getContextMenuActions(p.node.ids);l(),e.contextMenu=createContextMenu({actions:m,el:null!=(h=e.scrollContainer)?h:t,emitter:a,moveNode:n.api.getMoveNode(p.node.ids),translations:f})}e.stateMachineListeners.push([fo.Events.ActionClicked,handleContextMenuAction],[fo.Events.AnnotationClicked,handleAnnotationAction],[fo.Events.Close,l],[bo.Events.OpenContextMenu,createOpenContextMenuHandler]),a.on(fo.Events.Close,l),a.on(fo.Events.ActionClicked,handleContextMenuAction),a.on(fo.Events.AnnotationClicked,handleAnnotationAction),a.on(bo.Events.OpenContextMenu,createOpenContextMenuHandler)}const Ko={condition:function condition({context:e,event:t}){return function match(){return t.type===_.InstanceEvents.Create||t.type===_.InstanceEvents.ModeChanged||!e.moveList||0===Object.entries(e.moveList).length}},handler:function handler({context:e,coreContext:t}){initializeMoveList({context:e,coreContext:t}),e.enableContextMenu&&initializeContextMenu(e)}};function createQueuedEventHandler(e,t){return function queuedEvent(n){n.selectedNode=__spreadValues({},n.coreContext.api.getRelativeNode()),e.add(t,n)}}const Zo=jr.VariationParenthesis.Before,Qo=jr.VariationParenthesis.After;function copyMoveListContentToClipboard({api:e,el:t,win:n=window}){const a=n.getSelection(),l=null==a?void 0:a.anchorNode,f=null==a?void 0:a.focusNode;if(!l||!f)return null;const p=e.getPGN(),h=getPosition({moveList:t,node:l,pgn:p}),m=getPosition({moveList:t,node:f,pgn:p});if(null===h||null===m)return null;const g=Math.min(h,m),v=Math.max(h,m),y=getMoveText(getMoveElement(h<m?f:l)).length,_=v+y-g;let b=p.substr(g,_);return b=function addClosingParentheses({lastIndex:e,pgn:t,pgnPiece:n}){const a=new RegExp(`\\${Zo}`,"g"),l=(n.match(a)||[]).length;let f=n;for(let p=0;p<l&&t[e+p]===Qo;p++)f+=Qo;return f}({lastIndex:v+y,pgn:p,pgnPiece:b}),function copyStringToClipboard(e){const t=document.createElement("textarea");document.body.append(t),t.value=e,t.focus(),t.select(),document.execCommand("cut"),t.remove()}(b),b}function getPosition({moveList:e,pgn:t,node:n}){const a=getMoveElement(n),l=getMoveText(a);let f=function getMoveOrder(e,t){const n=Array.from(e.querySelectorAll(`.${bo.Classes.MoveNode}`));return n.filter((e=>e.textContent===t.textContent)).findIndex((e=>e===t))}(e,a)||0;return t.split("").findIndex(((e,n)=>{if(t.substr(n,l.length)===l){if(0===f)return n;f--}return!1}))}function getMoveElement(e){var t;return!e.parentNode||(null==(t=null==e?void 0:e.classList)?void 0:t.contains(bo.Classes.MoveNode))?e:getMoveElement(e.parentNode)}function getMoveText(e){const t=e.querySelector(`.${bo.Classes.MoveNumber}`),n=e.querySelector(`.${bo.Classes.MoveText}`),a=e.querySelector(`.${bo.Classes.Comment}`);let l="";return t&&(l+=`${t.textContent} `),n&&(l+=n.textContent),a&&(l+=` {${a.textContent}}`),l}function createDiagramAction({action:e,nodeLimit:t}){const n=e.includes("Set");return{action:fo.Actions[e],handler:function handler2(e,{moveList:a,moveNodeComponent:l}){diagramActionHandler({limitType:t,isSettingNodeLimits:n,moveList:a,moveNodeComponent:l,node:e})},isVisible:function isVisible({state:e}){var a,l;const f=null==(a=e.nodeLimit)?void 0:a[t],p=Boolean((null==f?void 0:f.move)===(null==(l=e.selectedNode)?void 0:l.getNodeData().move));return n?Boolean(!f||!p):Boolean(f&&p)},name:Or.Translation.Actions[e]}}const Xo={[fo.Actions.SetBegin]:createDiagramAction({action:fo.Actions.SetBegin,nodeLimit:jr.NodeLimitTypes.Begin}),[fo.Actions.SetFocus]:createDiagramAction({action:fo.Actions.SetFocus,nodeLimit:jr.NodeLimitTypes.Focus}),[fo.Actions.SetEnd]:createDiagramAction({action:fo.Actions.SetEnd,nodeLimit:jr.NodeLimitTypes.End}),[fo.Actions.RemoveBegin]:createDiagramAction({action:fo.Actions.RemoveBegin,nodeLimit:jr.NodeLimitTypes.Begin}),[fo.Actions.RemoveFocus]:createDiagramAction({action:fo.Actions.RemoveFocus,nodeLimit:jr.NodeLimitTypes.Focus}),[fo.Actions.RemoveEnd]:createDiagramAction({action:fo.Actions.RemoveEnd,nodeLimit:jr.NodeLimitTypes.End})};function createAddDiagramActions(e,t){const{api:n}=e;return function addDiagramActions(){n.addContextMenuActions(Xo),createDestroyDiagramActions(e,t)}}function diagramActionHandler({limitType:e,isSettingNodeLimits:t,moveList:n,moveNodeComponent:a,node:l}){var f,p;const h=n.api.getContext(),m=null==(f=h.state.nodeLimit)?void 0:f[e];let g;m&&(g=n.api.getMoveNode({line:m.ids.line,move:m.ids.move})),t?function setNodeLimits({limitType:e,moveList:t,moveNodeComponent:n,node:a}){const l=t.api.getContext();l.state.nodeLimit&&(l.state.nodeLimit[e]=a);if(e===jr.NodeLimitTypes.Focus)return void n.addNodeStyles({fontStyle:"italic"});const f=document.createElement("span"),p=`diagram-${e}`,h=e===jr.NodeLimitTypes.Begin?"[[":"]]";f.classList.add(p),f.innerHTML=h,e===jr.NodeLimitTypes.Begin?n.insertBeforeNode(f):e===jr.NodeLimitTypes.End&&n.insertAfterNode(f)}({limitType:e,moveList:n,moveNodeComponent:a,node:l}):(null==(p=h.state.nodeLimit)||delete p[e],removeNodeLimits({limitType:e,moveList:n,moveNodeComponent:a})),g&&removeNodeLimits({limitType:e,moveList:n,moveNodeComponent:g})}function removeNodeLimits({limitType:e,moveList:t,moveNodeComponent:n}){const a=t.dom.getElement().querySelector(`.diagram-${e}`);a?a.remove():n.removeNodeStyles()}function createUpdateNodeLimits(e,t){return function updateNodeLimits(n){const{moveList:a}=t;e.api.getDiagramNodeLimits||createDestroyDiagramActions(e,t),Object.entries(n).forEach((([e,t])=>{const n=a.api.getMoveNode({line:t.ids.line,move:t.ids.move});diagramActionHandler({limitType:e,isSettingNodeLimits:!0,moveList:a,moveNodeComponent:n,node:t})}))}}function createDestroyDiagramActions(e,t){var n;const a=t.moveList.api.getContext();a.state.nodeLimit=null!=(n=e.api.getDiagramNodeLimits)?n:{},t.methods.destroyDiagramActions=e.api.extendAPI(Ie.Plugin.Name,{getDiagramNodeLimits(){var e;return null!=(e=null==a?void 0:a.state.nodeLimit)?e:{}}})}function createAddCommentLink(e,t){return function addCommentLink({node:n,text:a,href:l}){var f,p;const h=t.moveList.dom.addComment(n,!1,{text:a,href:l});e.api.getOptions().test&&setTestData(h,{[Ft.Element]:$t.CommentLink}),n.commands||(n.commands={}),e.api.updateNode(n.ids,{commands:Object.assign(n.commands,{href:`${l}`,text:`${a}`})}),0===n.ids.line?null==(f=t.moveList.api.getMoveNode(n.ids))||f.getElement().appendChild(h):null==(p=getLineElement(n.ids.line,t.el))||p.append(h)}}function createSetScrollContainer(e){return function setScrollContainer(t){e.scrollContainer=t,e.moveList.dom.setScrollContainer(t)}}function createHorizontalMoveListPlugin({el:e,enableContextMenu:t=!0,nodeLimit:n,scrollContainer:a,translations:l=Dr}){const f={[jr.Placeholders.GameResult]:document.createComment("/Game Result"),[jr.Placeholders.Moves]:document.createComment("/Moves")},p={contextMenu:void 0,el:e,enableContextMenu:t,methods:{destroy:noop$1,destroyContextMenu:noop$1,destroyDiagramActions:noop$1,handleCommentClick:noop$1,handleCopy:noop$1,selectCurrentPosition:noop$1},moveList:{},nodeLimit:n,queue:createQueue(!1),placeholders:f,scrollContainer:a||e,stateMachine:createHMLStateMachine(),stateMachineListeners:[],translations:l};return{api:e=>function createHMLAPI(e,t){return{addDiagramActions:createAddDiagramActions(e,t),addCommentLink:createAddCommentLink(e,t),setScrollContainer:createSetScrollContainer(t),updateNodeLimits:createUpdateNodeLimits(e,t)}}(e,p),create:function create2(e){destroy(),registerMethods(e),registerListeners(),runHorizontalMoveListPlugin({data:null,type:_.APIEvents.Load},e)},destroy:destroy,match:[{condition:isOneOf([_.APIEvents.AddMove,_.APIEvents.CreateContinuation,_.APIEvents.CreateGame,_.APIEvents.DeletePosition,_.APIEvents.LineCommentUpdated,_.APIEvents.Load,_.APIEvents.Move,_.APIEvents.MoveBackward,_.APIEvents.MoveForward,_.APIEvents.MoveVariation,_.APIEvents.NodeUpdated,_.APIEvents.PromoteVariation,_.APIEvents.ResetToMainLine,_.APIEvents.SelectLineEnd,_.APIEvents.SelectLineStart,_.APIEvents.SelectNode,_.APIEvents.Undo,_.APIEvents.UpdatePGNHeaders,_.InstanceEvents.Create,_.OptionsEvents.Update]),handler:runHorizontalMoveListPlugin},{condition:is(_.InstanceEvents.ModeChanged),handler:function modeChanged(e,t){destroy(),registerMethods(t),registerListeners(),runHorizontalMoveListPlugin({data:null,type:_.InstanceEvents.ModeChanged},t)}}],name:Ie.Plugin.Name};function destroy(){var t,n;p.methods.destroy(),null==(n=(t=p.methods).destroyDiagramActions)||n.call(t),e.removeEventListener(jr.Events.Copy,p.methods.handleCopy)}function registerListeners(){e.addEventListener(jr.Events.Copy,p.methods.handleCopy)}function registerMethods(t){p.methods.destroy=function createDestroy$2(e){return function destroy(){var t,n;e.stateMachineListeners.forEach((([t,n])=>{e.stateMachine.off({handler:n,type:t})})),e.stateMachineListeners=[],e.moveList&&(null==(n=null==(t=e.moveList)?void 0:t.dom)?void 0:n.destroy)&&(e.moveList.dom.destroy(),e.moveList.plugins.destroy())}}(p),p.methods.destroyContextMenu=function createDestroyContextMenu(e){return function destroyContextMenu(){e.contextMenu&&(e.contextMenu.destroy(),e.contextMenu=void 0)}}(p),p.methods.handleCommentClick=function createCommentClickHandler(e){return function commentClickHandler(t){e.moveList.dom.insertEditableComment(t)}}(p),p.methods.handleCopy=function createCopyEventHandler({context:e,el:t}){return function copyEventHandler(n){var a;(null==(a=n.target.classList)?void 0:a.contains(Zr.Classes.Component))||copyMoveListContentToClipboard({api:e.api,el:t})&&n.preventDefault()}}({context:t,el:e}),p.methods.selectCurrentPosition=function createSelectCurrentPosition(e){return function selectCurrentPosition(t){t&&(isLine(t)?e.moveList.api.selectLineStart(t):isNode(t)&&e.moveList.api.selectNode(t.ids))}}(p)}function runHorizontalMoveListPlugin(e,t){!function runPatternMatcher({conditionParams:e,handlerContext:t}){const{queue:n}=t.context;!function matchPattern(e,t){const n=e.find((e=>e[0](t)));if(n)n[1](t)}([Wr,zr,Kr,Ko,oo,io,ao,so,co,uo,lo].map((({condition:t,handler:a})=>[t(e),createQueuedEventHandler(n,a)])),t),forceNextFrame((function flushHorizontalMoveListQueue(){n.flush()}))}({conditionParams:{context:p,event:e},handlerContext:{context:p,coreContext:t,event:e}})}}function createMarkingShortcutsFromFrame(e){const{id:t,itemsPerRow:n,rows:a,itemsConfiguration:l=[]}=e;return[...Array(n*a)].map(((e,a)=>{const f=l[a],{name:p,animatedImageURL:h,removalSoundBaseURL:m}="object"==typeof f?f:{name:null!=f?f:`${t}-${a}`},g=a%n,v=Math.floor(a/n);return{name:p,frameId:t,xIndex:g,yIndex:v,animatedImageURL:h,removalSoundBaseURL:m}}))}function preloadImage(e){const t=new Image;return t.src=e,t}function createSetFrames({api:e,framesMap:t,shortcuts:n}){return function setFrames(a=[]){t.clear(),n.clear(),a.forEach((e=>{t.set(e.id,e),preloadImage(e.imageURL)})),a.map(createMarkingShortcutsFromFrame).forEach((e=>{e.forEach((e=>{n.set(e),e.animatedImageURL&&preloadImage(e.animatedImageURL)}))})),function loadRemovalSounds(){const t=n.getAsArray().filter((e=>e.removalSoundBaseURL));if(!t.length)return;const a=t.reduce(((e,t)=>{var n;const{name:a,removalSoundBaseURL:l=""}=t,f=null!=(n=e[l])?n:[];return f.push(a),e[l]=f,e}),{}),l=Object.keys(a);if(l.length){const t=e.sounds.getSoundsInstance();l.forEach((e=>{t.loadExtra({baseURL:e,codes:a[e]})}))}}()}}function getShortcutId({xIndex:e,yIndex:t,frameId:n}){return`frameId=${n}, xIndex=${e}, yIndex=${t}`}function getFrameNotFoundError(e,t){return`Frame: '${e}' not found (frames available: ${t.join(", ")})`}function getResultMarkingData({markings:e,framesMap:t,shortcuts:n}){const a=[],l=[];return e.forEach((e=>{const{model:f}=e;(Array.isArray(e.square)?e.square:[e.square]).forEach((p=>{if("string"==typeof f){const t={data:{square:p,type:Ee[f]},type:"effect",persistent:!0,node:!0};return void a.push({square:p,input:e,marking:t})}const{customMarking:h,itemDisappears:m}=function createCustomMarkingWithFrame({model:e,shortcuts:t,framesMap:n,square:a}){var l;const f=t.find(e);if(!f)throw new Error(function getMarkingShortcutNotFoundError(e){if("xIndex"in e){const{xIndex:t,yIndex:n,frameId:a}=e;return`Marking shortcut: '${getShortcutId({xIndex:t,yIndex:n,frameId:a})}' not found`}return`Marking shortcut: '${e.name}' not found`}(e));const p=n.get(f.frameId);if(!p)throw new Error(getFrameNotFoundError(f.frameId,[...n.keys()]));const{xIndex:h,yIndex:m,animatedImageURL:g,removalSoundBaseURL:v,name:y}=f,{itemsPerRow:_,rows:b,imageURL:C}=p,S=g?{imageAnimated:!0,imageURL:g,positionRatioX:0,positionRatioY:0,widthRatio:1,heightRatio:1}:{imageURL:C,positionRatioX:h/_,positionRatioY:m/b,widthRatio:1/_,heightRatio:1/b};return{customMarking:{data:{square:a,type:ve.Image,removalTimeout:2e3,removalClass:g?void 0:"custom-item__frame--disappear",removalSound:v?y:void 0,frame:S},type:"customItem",persistent:!0},itemDisappears:null!=(l=e.autoRemove)&&l}}({model:f,shortcuts:n,framesMap:t,square:p});a.push({square:p,input:e,marking:h}),m&&l.push(p)}))})),{resultMarkings:a,disappearingMarkingSquares:l}}function createMark$1({api:e,markedSquares:t,framesMap:n,shortcuts:a,unmark:l}){return function mark(f){const p=Array.isArray(f)?f:[f],{resultMarkings:h,disappearingMarkingSquares:m}=getResultMarkingData({markings:p,framesMap:n,shortcuts:a});let g;h.length&&(g=function markModels(t){var n;if(!t.length)return[];if(1===t.length)return[null!=(n=e.markings.addOne(t[0]))?n:""];return e.markings.addMany(t).map((e=>null!=e?e:""))}(h.map((e=>e.marking)))),h.forEach(((e,n)=>{var a;const{input:l,marking:f,square:p}=e,h=null!=(a=null==g?void 0:g[n])?a:"";h.length&&"effect"!==f.type&&t.set(p,{input:l,marking:__spreadProps(__spreadValues({},f),{key:h})})})),m.length&&setTimeout((()=>{l(m)}),1500)}}function createSetWindow$1({mark:e,boardImagesDOM:t,framesMap:n,windowState:a,hideWindow:l,hotkeysMap:f,shortcuts:p}){return function setWindow(e){var n,f;a.window=e,t.clearElement(),e&&(t.setSize(e.widthPercent/(null!=(n=e.boardContainerAspectRatio)?n:1),e.heightPercent),t.setWindow({elementClickedCallback:defaultMarkFunction,closeButtonCallback:l,elements:getDOMWindowElements(null!=(f=e.elements)?f:[])}))};function getDOMWindowElements(e){const t=new Map,getTitle=e=>[...e,"left click"].join(" + ");return[...f.values()].forEach((e=>{const{keys:n,model:a}=e;if("string"==typeof a)t.set(a,getTitle(n));else{const e=p.find(a);if(e){const{xIndex:a,yIndex:l,frameId:f}=e;t.set(getShortcutId({xIndex:a,yIndex:l,frameId:f}),getTitle(n))}}})),e.map((e=>{if("frameId"in e)return function mapFrameToDOMFrame(e,t){const a=n.get(e.frameId);if(!a){const t=getFrameNotFoundError(e.frameId,[...n.keys()]);throw new Error(t)}const{frameId:l,emptyItemsPerRow:f,itemsAutoRemove:p}=e,{itemsPerRow:h,rows:m,imageURL:g}=a;return{id:l,emptyItemsPerRow:f,itemsPerRow:h,rows:m,imageURL:g,itemsAutoRemove:p,titles:getTitlesForDOMFrame(a,t)}}(e,t);{const{effects:n,id:a,emptyItemsPerRow:l,itemsPerRow:f}=e;return{id:a,emptyItemsPerRow:l,itemsPerRow:f,effects:n.map((e=>{if("string"==typeof e){const n=t.get(e);return n?{title:n,type:e}:e}return e}))}}}))}function getTitlesForDOMFrame(e,t){const{itemsPerRow:n,rows:a,id:l}=e;return[...Array(n*a)].map(((e,a)=>{var f;const p=getShortcutId({xIndex:a%n,yIndex:Math.floor(a/n),frameId:l});return null!=(f=t.get(p))?f:""}))}function defaultMarkFunction(t){a.windowPosition&&(e("type"in t?{square:a.windowPosition,model:t.type}:{square:a.windowPosition,model:t}),l())}}function createInitDefault({setFrames:e,setWindow:t,setHotkeys:n,reset:a}){return function initDefault(l={}){const f=window.location.href.replace(window.location.search,""),{imagesBaseURL:p=`${f}/static/test`,soundsBaseURL:h=`${f}/static/test/sounds`,boardContainerAspectRatio:m=1}=l,{defaultFrames:g,defaultWindow:v,defaultHotkeys:y}=function getDefaultValues({imagesBaseURL:e,soundsBaseURL:t,boardContainerAspectRatio:n}){const a=`${e}/animated-images`;return{defaultFrames:[{id:"objective-markers",imageURL:`${e}/objective-markers.png`,rows:1,itemsPerRow:5,itemsConfiguration:[{name:"star",animatedImageURL:`${a}/star.png`,removalSoundBaseURL:t},{name:"coin",animatedImageURL:`${a}/coin.png`,removalSoundBaseURL:t},{name:"target",animatedImageURL:`${a}/target.png`,removalSoundBaseURL:t},{name:"skull",animatedImageURL:`${a}/skull.png`,removalSoundBaseURL:t},{name:"bomb",animatedImageURL:`${a}/bomb.png`,removalSoundBaseURL:t}]},{id:"emotive-markers",imageURL:`${e}/emotive-markers.png`,rows:17,itemsPerRow:5,itemsConfiguration:["happy","sad","wut","wink","cry","cheeky","meh","bigsmile","cringe","mad","blush","shock","dead","sleepy","tongue","lol","crying","horror","love","nerd","glasses","mustache","kisses","mindblow","stareyes","sick","devil","ghost","scream","facepalm","thumbsup","thumbsdown","worship","wave","clap","knuckles","muscle","donkey","clock","fire","troll","donut","earth","panda","unicorn","shakehands","resign","gameover","bullet","blitz","skewer","fork","pin","fish","trophy","arena","puzzle","computer","scc","tt","tilt","960","doubleexclam","doublequestion","10","1","12","hype","gg","rip","present","gold","stockfish","lc0","komodo","danny","omg","robert","hikaru","anna","alexandra","andrea","levy","eric","aman"]}],defaultWindow:{heightPercent:50,widthPercent:40,boardContainerAspectRatio:n,elements:[{id:"effects",itemsPerRow:5,effects:[Ee.Brilliant,Ee.GreatFind,Ee.BestMove,Ee.Excellent,Ee.Correct,Ee.Equal,Ee.Interesting,Ee.Inaccuracy,Ee.Mistake,Ee.Blunder,Ee.Incorrect,Ee.Book,Ee.Warning,Ee.WinnerWhite]},{frameId:"objective-markers"},{frameId:"emotive-markers",itemsAutoRemove:!0}]},defaultHotkeys:[{keys:["B"],model:Ee.Brilliant},{keys:["G"],model:Ee.GreatFind},{keys:["B","E"],model:Ee.BestMove},{keys:["G","D"],model:Ee.Excellent},{keys:["K"],model:Ee.Correct},{keys:["E","Q"],model:Ee.Equal},{keys:["I"],model:Ee.Interesting},{keys:["D"],model:Ee.Inaccuracy},{keys:["M"],model:Ee.Mistake},{keys:["L"],model:Ee.Blunder},{keys:["W"],model:Ee.Incorrect},{keys:["O"],model:Ee.Book},{keys:["H"],model:Ee.Warning},{keys:["shift","8"],model:Ee.WinnerWhite},{keys:["S"],model:{name:"star"}},{keys:["C"],model:{name:"coin"}},{keys:["T"],model:{name:"target"}},{keys:["S","K"],model:{name:"skull"}},{keys:["F"],model:{name:"bomb"}},{keys:["0"],model:{name:"happy",autoRemove:!0}},{keys:["shift","S"],model:{name:"sad",autoRemove:!0}},{keys:["shift","W"],model:{name:"wut",autoRemove:!0}},{keys:["shift","0"],model:{name:"wink",autoRemove:!0}},{keys:["shift","R"],model:{name:"cry",autoRemove:!0}},{keys:["shift","Q"],model:{name:"cheeky",autoRemove:!0}},{keys:["shift","E"],model:{name:"meh",autoRemove:!0}},{keys:["shift","B"],model:{name:"bigsmile",autoRemove:!0}},{keys:["shift","C"],model:{name:"cringe",autoRemove:!0}},{keys:["shift","1"],model:{name:"mad",autoRemove:!0}},{keys:["shift","U"],model:{name:"blush",autoRemove:!0}},{keys:["shift","O"],model:{name:"shock",autoRemove:!0}},{keys:["shift","D"],model:{name:"dead",autoRemove:!0}},{keys:["S","E"],model:{name:"sleepy",autoRemove:!0}},{keys:["shift","P"],model:{name:"tongue",autoRemove:!0}},{keys:["shift","L"],model:{name:"lol",autoRemove:!0}},{keys:["shift","I"],model:{name:"crying",autoRemove:!0}},{keys:["shift","H"],model:{name:"horror",autoRemove:!0}},{keys:["shift","V"],model:{name:"love",autoRemove:!0}},{keys:["shift","N"],model:{name:"nerd",autoRemove:!0}},{keys:["shift","G"],model:{name:"glasses",autoRemove:!0}},{keys:["shift","T"],model:{name:"mustache",autoRemove:!0}},{keys:["shift","K"],model:{name:"kisses",autoRemove:!0}},{keys:["shift","M"],model:{name:"mindblow",autoRemove:!0}},{keys:["shift","Y"],model:{name:"stareyes",autoRemove:!0}},{keys:["S","I"],model:{name:"sick",autoRemove:!0}},{keys:["D","V"],model:{name:"devil",autoRemove:!0}},{keys:["G","H"],model:{name:"ghost",autoRemove:!0}},{keys:["shift","J"],model:{name:"scream",autoRemove:!0}},{keys:["shift","F"],model:{name:"facepalm",autoRemove:!0}},{keys:["arrowup"],model:{name:"thumbsup",autoRemove:!0}},{keys:["arrowdown"],model:{name:"thumbsdown",autoRemove:!0}},{keys:["I","P"],model:{name:"worship",autoRemove:!0}},{keys:["W","V"],model:{name:"wave",autoRemove:!0}},{keys:["L","P"],model:{name:"clap",autoRemove:!0}},{keys:["K","N"],model:{name:"knuckles",autoRemove:!0}},{keys:["M","U"],model:{name:"muscle",autoRemove:!0}},{keys:["D","K"],model:{name:"donkey",autoRemove:!0}},{keys:["L","K"],model:{name:"clock",autoRemove:!0}},{keys:["F","R"],model:{name:"fire",autoRemove:!0}},{keys:["T","R"],model:{name:"troll",autoRemove:!0}},{keys:["N","T"],model:{name:"donut",autoRemove:!0}},{keys:["E","T"],model:{name:"earth",autoRemove:!0}},{keys:["P","N"],model:{name:"panda",autoRemove:!0}},{keys:["U","I"],model:{name:"unicorn",autoRemove:!0}},{keys:["S","H"],model:{name:"shakehands",autoRemove:!0}},{keys:["R","E"],model:{name:"resign",autoRemove:!0}},{keys:["G","M"],model:{name:"gameover",autoRemove:!0}},{keys:["B","U"],model:{name:"bullet",autoRemove:!0}},{keys:["B","T"],model:{name:"blitz",autoRemove:!0}},{keys:["W","E"],model:{name:"skewer",autoRemove:!0}},{keys:["R","R"],model:{name:"fork",autoRemove:!0}},{keys:["I","N"],model:{name:"pin",autoRemove:!0}},{keys:["H","I"],model:{name:"fish",autoRemove:!0}},{keys:["H","Y"],model:{name:"trophy",autoRemove:!0}},{keys:["A","R"],model:{name:"arena",autoRemove:!0}},{keys:["U","L"],model:{name:"puzzle",autoRemove:!0}},{keys:["M","P"],model:{name:"computer",autoRemove:!0}},{keys:["S","C"],model:{name:"scc",autoRemove:!0}},{keys:["T","Y"],model:{name:"tt",autoRemove:!0}},{keys:["T","L"],model:{name:"tilt",autoRemove:!0}},{keys:["9"],model:{name:"960",autoRemove:!0}},{keys:["2"],model:{name:"doubleexclam",autoRemove:!0}},{keys:["3"],model:{name:"doublequestion",autoRemove:!0}},{keys:["J"],model:{name:"10",autoRemove:!0}},{keys:["Q"],model:{name:"1",autoRemove:!0}},{keys:["V"],model:{name:"12",autoRemove:!0}},{keys:["Y"],model:{name:"hype",autoRemove:!0}},{keys:["G","E"],model:{name:"gg",autoRemove:!0}},{keys:["R","I"],model:{name:"rip",autoRemove:!0}},{keys:["P"],model:{name:"present",autoRemove:!0}},{keys:["G","L"],model:{name:"gold",autoRemove:!0}},{keys:["S","T"],model:{name:"stockfish",autoRemove:!0}},{keys:["L","0"],model:{name:"lc0",autoRemove:!0}},{keys:["K","O"],model:{name:"komodo",autoRemove:!0}},{keys:["D","N"],model:{name:"danny",autoRemove:!0}},{keys:["O","M"],model:{name:"omg",autoRemove:!0}},{keys:["R","B"],model:{name:"robert",autoRemove:!0}},{keys:["H","K"],model:{name:"hikaru",autoRemove:!0}},{keys:["N","R"],model:{name:"anna",autoRemove:!0}},{keys:["D","R"],model:{name:"alexandra",autoRemove:!0}},{keys:["E","A"],model:{name:"andrea",autoRemove:!0}},{keys:["L","Y"],model:{name:"levy",autoRemove:!0}},{keys:["E","C"],model:{name:"eric",autoRemove:!0}},{keys:["M","N"],model:{name:"aman",autoRemove:!0}}]}}({imagesBaseURL:p,soundsBaseURL:h,boardContainerAspectRatio:m});a(),e(g),t(v),n(y)}}function getHotkeyId(e){return[...e.map((e=>e.toLowerCase()))].sort().join("-")}function createGetElement(e){return function getElement(){return e}}function initDOMElements(e,t){const n=document.createElement("div");n.className="board-images__window";const a=document.createElement("div");a.className="board-images__window-body";const l=document.createElement("div");l.className="board-images__close-button";const f=document.createElement("div");f.innerHTML='\n<svg id="Layer_1" data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 18 19">\n  <defs>\n    <style>\n      .cls-1 {\n        opacity: 0.3;\n      }\n\n      .cls-2 {\n        fill: #f8f8f8;\n      }\n\n      .cls-3 {\n        fill: #8a8886;\n      }\n    </style>\n  </defs>\n  <g>\n    <path class="cls-1" d="M9,.5a9,9,0,1,0,9,9A9,9,0,0,0,9,.5Z"/>\n    <circle class="cls-2" cx="9" cy="9" r="8.5"/>\n    <path class="cls-2" d="M9,1A8,8,0,1,1,1,9,8,8,0,0,1,9,1M9,0a9,9,0,1,0,9,9A9,9,0,0,0,9,0Z"/>\n    <path class="cls-3" d="M13.37,12a.53.53,0,0,1,0,.78l-.59.61a.56.56,0,0,1-.4.17.54.54,0,0,1-.4-.17l-3-3-3,3a.58.58,0,0,1-.4.17.54.54,0,0,1-.39-.17l-.59-.59a.54.54,0,0,1-.17-.4.52.52,0,0,1,.17-.4l3-3-3-3a.52.52,0,0,1-.17-.4.54.54,0,0,1,.17-.4l.59-.59a.56.56,0,0,1,.8,0l3,3,3-3a.58.58,0,0,1,.4-.17.56.56,0,0,1,.4.17l.59.59a.54.54,0,0,1,.17.41.5.5,0,0,1-.17.39l-3,3,3,3Z"/>\n  </g>\n</svg>\n',l.appendChild(f);const p=document.createElement("div");p.className="board-images__title";const h=t.map((e=>"effects"in e?function createElementsForDOMEffects(e){const{id:t,effects:n,itemsPerRow:a,emptyItemsPerRow:l=0}=e,f=a+l,p=document.createElement("div");p.className="board-images__effects-container";const h=n.map(((e,t)=>{const n="string"==typeof e?e:e.type,h=document.createElement("div");if(h.className="board-images__effect","object"==typeof e&&e.title&&h.setAttribute("custom-title",e.title),h.style.width=100/f+"%",h.innerHTML=makeSvgIcon({path:Rn[n],size:"100%"}),l>0&&t/a>0&&t%a==0){const e=document.createElement("div");e.className="board-images__break",e.style.width=l/f*100+"%",p.append(e)}return p.append(h),{container:h,type:n}}));return{id:t,container:p,domEffects:h}}(e):function createElementsForDOMFrame(e){const{id:t,itemsPerRow:n,rows:a,imageURL:l,emptyItemsPerRow:f=0,itemsAutoRemove:p,titles:h}=e,m=n+f,g=document.createElement("div");g.className="board-images__hover-container",g.style.width=n/m*100+"%";const v=document.createElement("img");return v.className="board-images__image",v.src=l,v.draggable=!1,g.appendChild(v),{id:t,container:g,imageElement:v,itemsPerRow:n,rows:a,itemsAutoRemove:p,titles:h}}(e)));return h.forEach((e=>{a.appendChild(e.container)})),n.appendChild(a),e.appendChild(n),e.appendChild(p),e.appendChild(l),{closeButton:l,titleElement:p,domElements:h}}function limitNumberWithinRange(e,t){return Math.min(Math.max(e,t.min),t.max)}let Yo=-1,Jo=-1;function getXYFromEvent({clientX:e,clientY:t,pointer:n,type:a,touches:l}){return(a===Tr.Touchmove||a===Tr.Touchstart)&&l.length>0&&(Yo=l[0].clientX,Jo=l[0].clientY),a===Tr.Touchend?{x:Yo,y:Jo}:n?{x:n.x,y:n.y}:l&&l.length>0?{x:l[0].clientX,y:l[0].clientY}:{x:null!=e?e:-1,y:null!=t?t:-1}}function translateEventToIndex({itemsPerRow:e,rows:t,imageElement:n,event:a}){const{width:l,height:f}=n;let p,h;if("offsetX"in a)p=a.offsetX,h=a.offsetY;else{const{x:e,y:t}=getXYFromEvent(a);p=e,h=t}return function translateCoordinatesToIndex({offsetX:e,offsetY:t,itemsPerRow:n,rows:a,width:l,height:f}){const p=l/n,h=f/a,m=limitNumberWithinRange(e,{min:0,max:l}),g=limitNumberWithinRange(t,{min:0,max:f});return{xIndex:limitNumberWithinRange(Math.floor(m/p),{min:0,max:n-1}),yIndex:limitNumberWithinRange(Math.floor(g/h),{min:0,max:a-1})}}({offsetX:p,offsetY:h,itemsPerRow:e,rows:t,width:l,height:f})}function addEventListeners({closeButton:e,titleElement:t,domElements:n,closeButtonCallback:a,elementClickedCallback:l}){var f;null==(f=e.firstChild)||f.addEventListener(Er,(e=>{e.stopPropagation(),a()}));const hideTitle=()=>{t.style.display="none",t.innerHTML=""};n.forEach((e=>{"domEffects"in e?function addEventListenersToEffectsDOMElement({domElement:e,titleElement:t,elementClickedCallback:n,hideTitle:a}){const{domEffects:l,id:f}=e;l.forEach(((e,l)=>{const{container:p,type:h}=e,m=p.getAttribute("custom-title");p.addEventListener(Er,(e=>{e.stopPropagation(),n({effectsId:f,index:l,type:h})})),m&&(p.addEventListener(Ar,(()=>{t.innerHTML=m,t.style.display=""})),p.addEventListener("pointerout",a))}))}({domElement:e,titleElement:t,elementClickedCallback:l,hideTitle:hideTitle}):function addEventListenersToFrameDOMElement({domElement:e,elementClickedCallback:t,titleElement:n,hideTitle:a}){const{container:l,imageElement:f,id:p,itemsPerRow:h,rows:m,itemsAutoRemove:g,titles:v=[]}=e;l.addEventListener(Er,(e=>{e.stopPropagation();const{xIndex:n,yIndex:a}=translateEventToIndex({itemsPerRow:h,rows:m,imageElement:f,event:e});t({frameId:p,xIndex:n,yIndex:a,autoRemove:g})})),f.addEventListener(Ar,(e=>{var t;a();const{xIndex:l,yIndex:p}=translateEventToIndex({itemsPerRow:h,rows:m,imageElement:f,event:e});n.innerHTML=null!=(t=v[l+p*h])?t:"",n.style.display=""})),f.addEventListener("pointerout",a)}({domElement:e,elementClickedCallback:l,titleElement:t,hideTitle:hideTitle})}))}function createSetWindow(e){return function setWindow(t){const{closeButtonCallback:n,elementClickedCallback:a,elements:l}=t,{closeButton:f,titleElement:p,domElements:h}=initDOMElements(e,l);addEventListeners({closeButton:f,titleElement:p,domElements:h,closeButtonCallback:n,elementClickedCallback:a})}}function createShowWindow(e){return function showWindow(){e.style.display=""}}function createHideWindow(e){return function hideWindow(){e.style.display="none"}}function createSetSize(e){return function setSize(t,n){e.style.width=t?`${t}%`:"",e.style.height=n?`${n}%`:""}}function createSetPosition(e){const t="horizontal-overflow";return function setPosition({squareCoords:n,widthInPercent:a,heightInPercent:l,allowOverflow:f}={}){if(e.classList.contains(t)&&e.classList.remove(t),!n||!a||!l)return e.style.top="",void(e.style.left="");const{top:p,left:h,overflows:m}=function calculateTopLeftForWindowInSquare({squareCoords:e,heightInPercent:t,widthInPercent:n,allowOverflow:a}){let l=!1,f=e.x,p=e.y;a||(p+t>100&&(p=limitNumberWithinRange(100-t,{min:0,max:100})),f+n>100&&(f=limitNumberWithinRange(f-n-(e.centered?0:12.5),{min:0,max:100}),l=!0));return{top:p,left:f,overflows:l}}({squareCoords:n,heightInPercent:l,widthInPercent:a,allowOverflow:null!=f&&f});m&&e.classList.add(t),e.style.top=`${p}%`,e.style.left=`${h}%`}}function createClearElement(e){return function clearElement(){e.innerHTML=""}}function createResetBoardElement(e){return function resetBoardElement(t){e.remove(),t.appendChild(e)}}function createBoardImagesAPI(e){const t={windowPosition:void 0,window:void 0},{api:n}=e,a=new Map,l=function createKeyedSet({items:e=[],keys:t=[],createKey:n}={}){if(!n&&!t.length)throw new Error("Need to specify at least one key or createKey function");const a=!t.includes("id")&&n?["id",...t]:t,l=a.map((()=>new Map));function set2(e){a.forEach(((t,a)=>{var f;const p=null!=(f=e[t])?f:null==n?void 0:n(e);p&&l[a].set(p,e)}))}return e.forEach((e=>{set2(e)})),{find:function find(e){let t;const f=l.find((l=>{let f=!1;const p=a.find((t=>{const n=e[t];return n&&(f=!0),n&&l.has(n)}));if(p)return t=e[p],!0;const h=null==n?void 0:n(e);if(!f&&!h)throw new Error("Could not find a key or create a key with passed in parameter");return!(!h||!l.has(h)||(t=h,0))}));return t&&(null==f?void 0:f.get(t))},set:set2,getAsArray:function getAsArray(){var e;return[...null==(e=l[0])?void 0:e.values()]},clear:function clear(){l.forEach((e=>e.clear()))}}}({keys:["id","name"],createKey:getShortcutId}),f=new Map,p=function createBoardImagesDOMService(){const e=function createBoardImagesElement(){const e=document.createElement("div");return e.className="board-images",e.style.display="none",e.addEventListener("pointerdown",(e=>{e.stopPropagation()})),e.addEventListener("wheel",(e=>{e.stopPropagation()})),e}();return{showWindow:createShowWindow(e),hideWindow:createHideWindow(e),setWindow:createSetWindow(e),setSize:createSetSize(e),setPosition:createSetPosition(e),getElement:createGetElement(e),clearElement:createClearElement(e),resetBoardElement:createResetBoardElement(e)}}(),h=new Map;return function createAPIFunctions(e){const p=function createGetHotkey(e){return function getHotkey(t){return e.get(getHotkeyId(t))}}(h),m=function createGetHotkeys(e){return function getHotkeys(){return[...e.values()]}}(h),g=function createGetFrames(e){return function getFrames(){return[...e.values()]}}(a),v=createSetFrames({api:n,framesMap:a,shortcuts:l}),y=function createGetAllMarkingShortcuts(e){return function getAllMarkingShortcuts(){return e.getAsArray()}}(l),_=function createGetMarkingShortcut(e){return function getMarkingShortcut(t){return e.find({name:t})}}(l),b=function createUnmark$1(e,t){return function unmark(n){const a=Array.isArray(n)?n:[n],l=[];a.forEach((e=>{const n=t.get(e);n&&(l.push(n.marking.key),t.delete(e))})),l.length&&e.markings.removeMany(l)}}(n,f),C=createMark$1({api:n,markedSquares:f,framesMap:a,shortcuts:l,unmark:b}),S=function createIsMarked(e){return function isMarked(t){return e.has(t)}}(f),k=function createGetMarkings$1(e){return function getMarkings(){return[...e.values()].map((e=>e.input))}}(f),w=function createClearMarkings$1(e,t){return function clearMarkings(){const n=[...e.keys()];n.length&&t(n)}}(f,b),T=function createGetWindow(e){return function getWindow(){return e.window}}(t),P=function createHideWindow$1({windowState:e,api:t,boardImagesDOM:n}){return function hideWindow(){const{window:a,windowPosition:l}=e;a&&(l&&(t.unmark({square:{square:l}}),e.windowPosition=void 0,n.setPosition()),n.hideWindow())}}({windowState:t,api:n,boardImagesDOM:e}),A=function createIsInitialized({getHotkeys:e,getWindow:t,getFrames:n}){return function isInitialized(){return!!t()&&n().length>0&&e().length>0}}({getWindow:T,getFrames:g,getHotkeys:m}),M=createSetWindow$1({mark:C,boardImagesDOM:e,framesMap:a,windowState:t,hideWindow:P,hotkeysMap:h,shortcuts:l}),x=function createSetHotkeys({hotkeysMap:e,setWindow:t,windowState:n}){return function setHotkeys(a=[]){e.clear(),a.forEach((t=>{const n=getHotkeyId(t.keys);if(e.has(n))throw new Error(function getHotkeyError(e){return`Hotkey combination already in use: ${e.join(", ")})`}(t.keys));e.set(n,t)})),t(n.window)}}({windowState:t,hotkeysMap:h,setWindow:M}),O=function createShowWindow$1({windowState:e,api:t,boardImagesDOM:n}){return function showWindow({square:a,squareCoords:l,allowWindowOverflow:f=!1}){var p;const{window:h,windowPosition:m}=e;h&&(m&&t.unmark({square:{square:m}}),e.windowPosition=a,t.mark({square:{square:a,color:ht.HighlightColors.Selected,opacity:.5}}),n.setPosition({squareCoords:l,heightInPercent:h.heightPercent,widthInPercent:h.widthPercent/(null!=(p=h.boardContainerAspectRatio)?p:1),allowOverflow:f}),n.showWindow())}}({windowState:t,api:n,boardImagesDOM:e}),R=function createGetWindowPosition(e){return function getWindowPosition(){const{window:t,windowPosition:n}=e;if(t)return n}}(t),I=function createToggleWindow({getWindowPosition:e,hideWindow:t,showWindow:n}){return function toggleWindow({square:a,squareCoords:l,allowWindowOverflow:f=!1}){a===e()?t():n({square:a,squareCoords:l,allowWindowOverflow:f})}}({getWindowPosition:R,hideWindow:P,showWindow:O}),L=function createReset({setFrames:e,clearMarkings:t,hideWindow:n,setWindow:a,setHotkeys:l}){return function reset(){e(),t(),n(),a(),l()}}({setFrames:v,clearMarkings:w,hideWindow:P,setWindow:M,setHotkeys:x}),N=createInitDefault({setFrames:v,setWindow:M,setHotkeys:x,reset:L}),D=function createDestroy$1(e,t){return function destroy(){e(),t.getElement().remove()}}(L,e);return{initDefault:N,reset:L,destroy:D,isInitialized:A,getFrames:g,setFrames:v,getAllMarkingShortcuts:y,getMarkingShortcut:_,setHotkeys:x,getHotkeys:m,getHotkey:p,mark:C,unmark:b,isMarked:S,getMarkings:k,clearMarkings:w,getWindow:T,setWindow:M,showWindow:O,hideWindow:P,toggleWindow:I,getWindowPosition:R,dom:e}}(p)}function createBoardImagesPlugin({keyToOpenWindow:e=J.DefaultKeyToOpenWindow,imagesBaseURL:t,soundsBaseURL:n}={}){return{api:createBoardImagesAPI,beforeState:[{condition:is(_.UserEvents.PointerdownLeft),handler:function clickHandler(t,n){var a;const{api:l,el:f,queue:p,renderer:h}=n,m=null==(a=null==t?void 0:t.data)?void 0:a.square,g=l.boardImages,v=l.markings;if(!m)return p.add(g.hideWindow),!0;const y=l.keys.getPressedKeys();if(!y.length)return p.add(g.hideWindow),!0;g.isInitialized()||initialize(void 0,n,!0);const _=v.getAllWhere({persistent:!0,types:["effect"]}).find((e=>e.data.square===m)),b=g.getHotkey(y);if(b)return g.isMarked(m)?p.add(g.unmark,m):_?p.add(v.toggleOne,_):p.add(g.mark,{square:m,model:b.model}),!1;if(!y.includes(e))return p.add(g.hideWindow),!0;if(_)return p.add(v.removeOne,_.key),!1;if(g.isMarked(m))return p.add(g.unmark,m),!1;return p.add(g.toggleWindow,{square:m,squareCoords:getSquareCoords({square:m,el:f,renderer:h,boardFlipped:l.getOptions().flipped})}),!1}}],match:[{condition:is(_.InstanceEvents.RendererSet),handler:initialize},{condition:isOneOf(jn),handler:function moveHandler(e,t){const{api:n,queue:a}=t,{data:l}=e,f=n.boardImages;if(!l.move)return;const{move:p}=l,h=[];f.isMarked(l.move.to)&&h.push(p.to);p.rookTo&&f.isMarked(p.rookTo)&&h.push(p.rookTo);h.length&&a.add(f.unmark,h)}},{condition:is(_.OptionsEvents.Update),handler:function optionsHandler(e,t){const{api:n,el:a,queue:l,renderer:f}=t,p=n.boardImages;if(void 0!==e.data.flipped){const e=p.getWindowPosition();e&&l.add(p.showWindow,{square:e,squareCoords:getSquareCoords({square:e,el:a,renderer:f,boardFlipped:n.getOptions().flipped})})}}}],name:J.Plugin.Name,requires:["keys","custom-items","effects","sounds","markings"],destroy:function destroy(e){const{api:t}=e;t.boardImages.destroy()}};function initialize(e,a,l=!1){const{api:f,el:p,renderer:h}=a,m=f.boardImages;(m.isInitialized()||l)&&m.initDefault({imagesBaseURL:t,soundsBaseURL:n,boardContainerAspectRatio:null==h?void 0:h.getBoardContainerAspectRatio()}),m.dom.resetBoardElement(p)}}function getSquareCoords({square:e,el:t,renderer:n,boardFlipped:a=!1}){if(!n)return{x:0,y:0};const l=n.getCoordsFromSquare(e,a);return n.name===Mt.Types.WebGL2D?{x:l.x/t.clientWidth*100+6.25,y:l.y/t.clientHeight*100-6.25}:n.name===Mt.Types.WebGL3D?{x:l.x/t.clientWidth*100,y:l.y/t.clientHeight*100,centered:!0}:{x:(l.x+100)/800*100,y:l.y/800*100}}function createMinimalPlugins(){return[createAssetsPlugin(),createBoardSizePlugin(),createPiecesPlugin(),createRendererErrorCatcherPlugin()]}function createStandardPlugins({exclude:e}={}){const t={[Nn.Plugin.Name]:createKeysPlugin,[v.Plugin.Name]:createAccessibilityPlugin,[j.Plugin.Name]:createArrowKeysPlugin,[V.Plugin.Name]:createArrowsPlugin,[z.Plugin.Name]:createBlinkingHighlightPlugin,[ce.Plugin.Name]:createCoordinatesPlugin,[In.Plugin.Name]:createFlipBoardPlugin,[N.Plugin.Name]:createHighlightsPlugin,[Ne.Plugin.Name]:createHoverSquarePlugin,[$n.Plugin.Name]:createMarkingsPlugin,[ft.Plugin.Name]:createBoardDisabledPlugin,[Be.Plugin.Name]:createMoveHintsPlugin,[ze.Plugin.Name]:createSoundsPlugin,[Gn.Plugin.Name]:createScrollThroughMovesPlugin};e&&e.forEach((e=>{delete t[e]}));const n=[getSelectionSquare,getMoveHighlights,getAnalysisHighlights],a=[...createMinimalPlugins()];return Object.keys(t).forEach((e=>e===N.Plugin.Name?a.push(t[e](n)):a.push(t[e]()))),a}function createPremiumPlugins(){return[...createStandardPlugins(),createFadeSetupPlugin(),createEffectsPlugin(),createCustomItemsPlugin(),createCheatDetectionPlugin()]}Symbol.toStringTag;const ei=/^rgba?\((\d+),\s*(\d+),\s*(\d+)(?:,\s*((\d|\.)+))?\)$/;function rgbToHex(e){if(-1===e.search("rgb"))return e;const t=e.match(ei);return`#${hexValue(t[1])}${hexValue(t[2])}${hexValue(t[3])}`}function rgbaToOpacity(e){return-1===e.search("rgba")?1:parseFloat(e.match(ei)[4])}function hexValue(e){return`0${parseInt(e,10).toString(16)}`.slice(-2)}function getElementBackgroundImage(e,t){return window.getComputedStyle(e,t).backgroundImage}function getPieceShortStringFromUrl(e){const[t,n]=e.split("/").pop().split(".")[0];return"w"===t?n.toUpperCase():n}function getFileRankFromSan(e){return{file:e.toLowerCase().charCodeAt(0)-96,rank:Number(e.charAt(1))}}function getSanFromFileRank$1(e){if(!(!e||!e.file||!e.rank||e.file>8||e.rank>8))return`${String.fromCharCode(96+e.file)}${e.rank.toString()}`}var ti,ni,ri,oi,ii,ai,si=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",highlights:{"8_bit":"#ffff00",bases:"#f5cc2a",blackwhite:"#5b91b3",blue:"#00a5ff",brown:"#ffff00",bubblegum:"#de5d6f",burled_wood:"#ee9016",dark_wood:"#cc9122",dash:"#eca722",default:"#ffff00",glass:"#5b91b3",graffiti:"#f39011",green:"#ffff00",grey:"#a4b8c4",icy_sea:"#5ed7f1",light:"#a4b8c4",lolz:"#a3becd",marble:"#f0db86",marbleblue:"#65daf7",marblebrown:"#f39011",marblegreen:"#f0db86",metal:"#a3becd",natural:"#f0e464",nature:"#eef396",neon:"#6d90a6",newspaper:"#99976e",orange:"#ffff00",overlay:"#0d9acf",parchment:"#d8cc66",pink:"#de5d6f",purple:"#7dacc9",red:"#f8f893",sand:"#e2bc87",sky:"#65daf7",stone:"#36525f",tan:"#f7d84a",tournament:"#a4c25b",translucent:"#5b91b3",walnut:"#d1a52d",winboard:"#a4c25b",wood:"#cc9122",wooddark:"#ee9016",woodlight:"#d8cc66",woodmid:"#cc9122",woodolive:"#a3becd"}});Symbol.toStringTag;function buildMode({base:e,initialOptions:t}){return function getBoundMode(n){const a=Object.keys(t).reduce(((e,n)=>(e[n]=t[n].default,e)),{}),l=e({api:n,options:a}),f=function createExtendMode(e,t){return function extendMode(n){const a=Object.entries(n).map((([n,a])=>{var l;if(!a||!(null==(l=e.overridableMethods)?void 0:l.includes(n)))return;const f=e[n];return e[n]=a(e,t),function destroyOverride(){e[n]=f}}));return function destroyOverride(){a.map((e=>null==e?void 0:e()))}}}(l,n);return Object.assign(l,{extendMode:f,getOptions:function getOptions(){return a},setOption:function setOption(e,n){var l;if(!(null==(l=t[e])?void 0:l.editable))return void warnOptionNotEditable(e);a[e]=n}})}}function createModeFactory(e,t){return function createMode(n={}){const a=Object.keys(n).reduce(((e,a)=>{var l;return(null==(l=t[a])?void 0:l.editable)?Object.assign(e,{[a]:{default:n[a],editable:!0}}):warnOptionNotEditable(a),e}),t);return buildMode({base:e,initialOptions:a})}}function warnOptionNotEditable(e){console.warn(`${e} is not an editable option in this mode.`)}function canMoveForward({api:e,followAlternateLines:t=!1,mv:n}){const{game:a,mutateGame:l}=e.getContext(),f=l((function callMethod(){a.moveForward(t,n)}));return!!(null==f?void 0:f.plyDiff)&&(a.moveBackward(),!0)}function createMove$7(e){const{api:t}=e,n=t.move;return function move(e){const a=t.isAtEndOfLine(),{canAddMovesToMainLine:l}=t.getMode().getOptions();return canMoveForward({api:t,followAlternateLines:!0,mv:e})?n(e):function shouldAddContinuation({canAddMovesToMainLine:e,isAtEndOfLine:t,node:n}){var a;const l=isNode(n)?null==(a=null==n?void 0:n.ids)?void 0:a.line:null==n?void 0:n.id;return!e&&t&&0===l}({canAddMovesToMainLine:l,isAtEndOfLine:a,node:t.getRelativeNode()})?function addContinuation(){if(t.createContinuation())return n(e);return null}():n(e)}}(function(e){e.Name="analysis"})((ni=ti||(ti={})).Plugin||(ni.Plugin={})),function(e){e.Name="effectsHMLSync"}((oi=ri||(ri={})).Plugin||(oi.Plugin={})),(ai=ii||(ii={})).GreatFind="!",ai.Mistake="?",ai.Brilliant="!!",ai.Blunder="??",ai.Interesting="!?",ai.Inaccuracy="?!",ai.Drawish="=",ai.Unclear="",ai.WhiteHasModerateAdvantage="",ai.BlackHasModerateAdvantage="",ai.WhiteHasDecisiveAdvantage="+-",ai.BlackHasDecisiveAdvantage="-+",ai.PositionInZugzwang="",ai.WithCompensation="",ai.Novelty="N",ai.WithAttack="=/";const ci=function createGetAnnotationName(){const e=new Map;return Object.keys(ii).forEach((t=>{const n=ii[t];e.set(n,t)})),function getName(t){if(t)return e.get(t)}}();function annotationAdded(e,t){const{data:n}=e;if(n.changes.userGenerated)return!1;const a=ci(n.changes.annotation);return Boolean(a)}function annotationRemoved(e,t){const{data:n}=e;return!n.changes.userGenerated&&("annotation"in n.changes&&!n.changes.annotation)}function selectedNodeUpdated(e,t){const{data:n}=e,{api:a}=t;if(n.changes.userGenerated)return!1;const l=a.getSelectedNode();if(!isNode(l))return!1;const{ids:f}=l,{ids:p}=n;return!(!f||!p)&&(p.move===f.move&&p.line===f.line)}function unselectedNodeUpdated(e,t){var n,a;const{data:l}=e,{api:f}=t;if(l.changes.userGenerated)return!1;const p=f.getSelectedNode(),{ids:h}=l;return!!h&&(h.move!==(null==(n=null==p?void 0:p.ids)?void 0:n.move)||h.line===(null==(a=null==p?void 0:p.ids)?void 0:a.line))}function selectedNodeHasAnnotation(e,t){const{api:n}=t,a=n.getSelectedNode();return!!isNode(a)&&Boolean(a.annotation)}function selectedNodeAnnotationDoesNotMatchEffect(e,t){var n;const{api:a}=t,l=a.markings,f=a.getSelectedNode();if(!isNode(f))return!1;const p=ci(f.annotation);if(!p)return!1;const h=l.getAllWhere({types:[Pe]}).find((e=>e.data.square===(null==f?void 0:f.to)&&e.node));return p!==(null==(n=null==h?void 0:h.data)?void 0:n.type)}function addEffect(e,t){const{data:n}=e,{api:a,queue:l}=t,f=a.markings,p=ci(n.node.annotation);l.add((function addMarking(){f.addOne({data:{square:n.node.to,type:p},persistent:!0,node:!0,type:Pe})}))}function removeEffect(e,t){const{data:n}=e,{api:a,queue:l}=t,f=a.markings,p=f.getAllWhere({types:[Pe]}).find((e=>e.data.square===n.node.to));p&&l.add((function removeMarking(){f.removeOne(p.key)}))}function updateAnnotation(e,t){var n;const{api:a,queue:l}=t,f=a.getSelectedNode();if(!isNode(f))return;const p=e.data.filter(isType(Pe)).find((e=>e.data.square===f.to&&e.node));if(!p)return;const h=null!=(n=ii[p.data.type])?n:"";f.annotation&&f.annotation===h||l.add((function refreshAnnotation(){l.add((function refreshAnnotationInNextCycle(){a.updateNode(f.ids,{annotation:h,userGenerated:!0})}))}))}function removeAnnotation(e,t){const{api:n,queue:a}=t,l=n.getSelectedNode();if(!isNode(l))return;const f=e.data.filter(isType(Pe)).find((e=>e.data.square===l.to&&e.node));f&&ii[f.data.type]&&a.add((function clearAnnotation(){n.updateNode(l.ids,{annotation:"",userGenerated:!0})}))}function removeEffectFromJCE(e,t){const{data:n}=e,{api:a}=t,{move:l,line:f}=n.ids,{game:p}=a.getContext(),h=p.ids();p.selectPosition(l,f);const m=getMarkingsFromJCE(p).find((e=>e.data.square===n.node.to&&"effect"===e.type));m&&removeFromJCENode(p,m),p.selectPosition(h.move,h.line)}function queueAddEffect(e,t){const{api:n,queue:a}=t,l=n.markings,f=n.getSelectedNode();if(!isNode(f))return;const{annotation:p}=f;a.add((function addEffect2(){a.add((function addEffectInNextCycle(){const e=n.getSelectedNode();if(!isNode(e))return;const{annotation:t}=e,a=ci((null==t?void 0:t.length)?t:p);a&&l.addOne({data:{square:null==f?void 0:f.to,type:a},persistent:!0,node:!0,type:Pe})}))}))}var li,ui;(function(e){e.Analysis="analysis",e.CaptureTheStar="capture-the-star",e.Explorer="exploring",e.GuessTheMove="guess-the-move",e.PassiveObserving="passive-observing",e.Observing="observing",e.Playing="playing",e.Setup="setup"})((ui=li||(li={})).Types||(ui.Types={}));const di=createModeFactory((function base$7({api:e}){return{isAllowedToMove:function isAllowedToMove(){const{canAddMovesToMainLine:t}=e.getMode().getOptions();return t||Boolean(e.getSelectedNode())},name:li.Types.Analysis,plugins:[{apiOverrides:{move:createMove$7},name:ti.Plugin.Name},createAnalysisOverlayPlugin(),{match:[{condition:isMark(Pe),handler:updateAnnotation},{condition:pipeConditions(isUnmark(Pe),selectedNodeHasAnnotation),handler:removeAnnotation},{condition:pipeConditions(is(_.APIEvents.NodeUpdated),selectedNodeUpdated,annotationAdded,selectedNodeAnnotationDoesNotMatchEffect),handler:addEffect},{condition:pipeConditions(is(_.APIEvents.NodeUpdated),selectedNodeUpdated,annotationRemoved),handler:removeEffect},{condition:pipeConditions(isOneOf(jn),selectedNodeHasAnnotation),handler:queueAddEffect},{condition:pipeConditions(is(_.APIEvents.NodeUpdated),unselectedNodeUpdated),handler:removeEffectFromJCE}],name:ri.Plugin.Name}]}}),{canAddMovesToMainLine:{default:!0,editable:!0},canInteractWithPieces:{default:!0,editable:!0},canMoveWhenGameIsOver:{default:!0,editable:!1},canModifyExistingMovesOnMainLine:{default:!0,editable:!0}});var fi,pi,hi=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:di});function createConfigureitems(e){return function configureItems(t){e.config.set("items",t)}}function createGetCurrentMoveCount(e){return function getCurrentMoveCount(){var t;return(null==(t=e.getHistorySANs())?void 0:t.length)-1||0}}function createGetData(e,t){return function getData(){const n=e.captureTheStar;return{completed:t.status.get("completed")||!1,completedMoveCount:t.status.get("completedMoveCount"),itemsRemaining:n.getNumItemsRemaining(),moveCount:n.getCurrentMoveCount()}}}function createGetItems(e){return function getItems(t={}){const{api:n,game:a}=e,l=n.markings,{previousNode:f}=t;let p=[];if(f){const e=a.ids();a.moveBackward(),p=getItems(),a.selectPosition(e.move,e.line)}else p=l.getAllWhere({types:[fe]});return p}}function createGetItemSquares(e){return function getItemSquares(){return e.captureTheStar.getItems().map((e=>e.data.square))}}(function(e){e.Completed="CTSCompleted"})((pi=fi||(fi={})).Events||(pi.Events={})),function(e){e.Name="captureTheStar"}(pi.Plugin||(pi.Plugin={}));const mi='Move object has no "from" square.',gi="Cannot load without any items.",vi="Cannot load without a piece.",yi="Configuration missing for custom item";function getIntermediateSquares(e,t){const{file:n,rank:a}=getFileRankFromSan$1(e),{file:l,rank:f}=getFileRankFromSan$1(t),p="abcdefgh",h="12345678";if(n===l)return getIntegersBetweenTwoNumbers(a,f).map((e=>`${p.charAt(n-1)}${h.charAt(e-1)}`));if(a===f)return getIntegersBetweenTwoNumbers(n,l).map((e=>`${p.charAt(e-1)}${h.charAt(a-1)}`));if(Math.abs(l-n)!==Math.abs(f-a))throw new Error("Squares are not on same file, rank, or diagonal");const m=getIntegersBetweenTwoNumbers(n,l),g=getIntegersBetweenTwoNumbers(a,f);return m.reduce(((e,t,n)=>(e.push(`${p.charAt(t-1)}${h.charAt(g[n]-1)}`),e)),[])}function getIntegersBetweenTwoNumbers(e,t){const[n,a]=[e,t].sort();return Array(a-n-1).fill(void 0).map(((e,t)=>n+t+1))}function createGetNextItems(e){return function getNextItems(t){const n=e.captureTheStar,{from:a,to:l}=t;if(!a)throw new Error(mi);let f=[];return f="n"===t.piece.toLowerCase()?[l]:[l,...getIntermediateSquares(a,l)],n.getItems({previousNode:!0}).filter((e=>!f.includes(e.data.square)))}}function createGetNumItemsRemaining(e){return function getNumItemsRemaining(){const t=e.captureTheStar;return Object.keys(t.getItems()).length}}function createIsCompleted(e){return function isCompleted(){return Boolean(e.status.get("completed"))}}function createLoad$2(e,t){return function load2(n){const{items:a,piece:l}=n,{api:f,game:p,respond:h}=e,m=f.captureTheStar,g=f.markings;if(!Object.keys(a).length)throw new Error(gi);if(!l)throw new Error(vi);return f.clearMarkings(),p.load("8/8/8/8/8/8/8/8"),p.put(l,l.square),Object.entries(a).forEach((([e,n])=>{const a=function createCTSMarking(e,t,n){const a=null==e?void 0:e[n];if(!ve[n]&&!a)return null;const l={data:{square:t,type:a?ve.Image:ve.Star},node:!0,persistent:!0,type:fe,key:`cts-${t}`};return a&&(l.data.image={url:a}),l}(t.config.get("items"),e,n);if(!a)throw new Error(yi);g.addOne(a)})),f.setPlayingAs(l.color),f.setTurn(l.color),m.resetPuzzleStatus(),h(_.APIEvents.Load,{pieces:f.getPieces()})}}function createUpdatePuzzleStatus(e,t){return function updatePuzzleStatus(){const n=e.captureTheStar;0!==n.getNumItemsRemaining()||n.isCompleted()||(t.status.set("completed",!0),t.status.set("completedMoveCount",n.getCurrentMoveCount()),n.emit(fi.Events.Completed,n.getData()))}}function createCaptureTheStarAPI(e){const{api:t}=e,n=createEventEmitter(),a=function createInternalAPI(){const e=new Map,t=new Map;return{config:e,status:t}}();a.config.set("items",{});const l=function createResetPuzzleStatus(e){return function resetPuzzleStatus(){e.status.set("completed",!1),e.status.delete("completedMoveCount")}}(a);return l(),__spreadProps(__spreadValues({configureItems:createConfigureitems(a),getCurrentMoveCount:createGetCurrentMoveCount(t),getData:createGetData(t,a),getItems:createGetItems(e),getItemSquares:createGetItemSquares(t),getNextItems:createGetNextItems(t),getNumItemsRemaining:createGetNumItemsRemaining(t)},n),{isCompleted:createIsCompleted(a),load:createLoad$2(e,a),resetPuzzleStatus:l,updatePuzzleStatus:createUpdatePuzzleStatus(t,a)})}function getOppositeColor(e){return e===rr.ColorsAsNumbers.Black?rr.ColorsAsNumbers.White:rr.ColorsAsNumbers.Black}function createGetLegalMoves$1(e){const{api:t,game:n}=e,a=t.getLegalMoves;return function getLegalMoves(){const e=t.captureTheStar;if(!t.getPlayingAs())return[];const l=a(),f=n.getPieces(!1)[0];if(!f||"p"!==f.type)return l;const p=function buildFEN(e,t){const n=getOppositeColor(t.color)===rr.ColorsAsNumbers.Black?"p":"P",a=t.color===rr.ColorsAsNumbers.Black?t.type:t.type.toUpperCase(),l=new Array(8).fill(void 0).map((()=>new Array(8).fill(".")));return l[8-t.rank][t.file-1]=a,e.reduce(((e,t)=>{const{file:a,rank:l}=getFileRankFromSan$1(t);return a&&l?(e[8-l][a-1]=n,e):e}),l).map((e=>e.join("").replace(/(\.+)/g,(e=>e.length.toString())))).join("/")}(e.getItemSquares(),f),h=B.getLegalMoves(p);return function deduplicateByKey(e,t){return[...new Map(e.map((e=>[e[t],e]))).values()]}([...l,...h],"san")}}function createGetMove$2(e){const{api:t}=e,n=t.getMove;return function getMove(e){var a;const l=n(e);return l||(null!=(a=t.getLegalMoves().find((t=>t.to===e.to)))?a:null)}}function createMove$6(e){const{api:t,game:n}=e,a=t.move;return function move(e){if(!t.isAtEndOfLine())return t.selectLineEnd();if(!e.userGenerated||!("flags"in e))return a(e);const l=e;return isCapture(l)&&"p"===l.piece&&n.put({type:"p",color:getOppositeColor(l.color)},e.to),a(e)}}function createMoveBackward$1(e){return function moveBackward(){var t;const{respond:n,game:a,mutateGame:l}=e,f=l((function callMethod(){a.moveBackward()}));return!f||0===f.lineDiff&&0===f.plyDiff?n(_.APIEvents.MoveBackward,null):((null==(t=f.move)?void 0:t.captured)&&(f.move.captured=void 0),n(_.APIEvents.MoveBackward,f))}}function createHandleIllegalMove(e){return function handleIllegalMove(){e.isAtEndOfLine()||e.selectLineEnd()}}const _i=createModeFactory((function base$6({api:e}){return{isAllowedToMove:function isAllowedToMove(){return!0},handleIllegalMove:createHandleIllegalMove(e),name:li.Types.CaptureTheStar,plugins:[{api:createCaptureTheStarAPI,apiOverrides:{getLegalMoves:createGetLegalMoves$1,getMove:createGetMove$2,move:createMove$6,moveBackward:createMoveBackward$1},create:function create2(e){const{api:n}=e,a=n.captureTheStar;t&&a.configureItems(t.items)},match:[{condition:isOneOf(jn),handler:function setTurn(e,t){const{api:n,queue:a}=t,l=n.getPlayingAs();l&&a.add(n.setTurn,l)}},{condition:is(_.APIEvents.Move),handler:function handleMove2(e,t){const{api:n,queue:a}=t,l=n.captureTheStar,f=n.markings,p=n.getContext().game,h=l.getNextItems(e.data.move);a.add((function refreshCTS(){a.add((function refreshInNextCycle(){f.addMany(h),p.turn(n.getPlayingAs()),l.updatePuzzleStatus()}))}))}}],name:fi.Plugin.Name}],usePlayingAs:!0};var t}),{canAddMovesToMainLine:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!1}});var bi,Ci,Si=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:_i});function getIdsToDelete(e){return isNode(e)?{line:e.ids.line,move:e.ids.move+1}:{line:0,move:0}}function createMove$5(e){const{api:t}=e,n=t.move;return function move(e){if(t.isAtEndOfLine())return n(e);const{line:a,move:l}=getIdsToDelete(t.getRelativeNode());return t.deletePosition(l,a),n(e)}}(function(e){e.Name="exploring"})((Ci=bi||(bi={})).Plugin||(Ci.Plugin={}));const ki=createModeFactory((function base$5(){return{isAllowedToMove:function isAllowedToMove(){return!0},name:li.Types.Explorer,plugins:[{apiOverrides:{move:createMove$5},name:bi.Plugin.Name}]}}),{canAddMovesToMainLine:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!0,editable:!1}});var wi,Ti,Pi,Ei=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:ki});function createGuessTheMoveAPI(e){let t=[];return{cancel:function cancel(){const{api:n,respond:a}=e,l=getActiveGuess();if(!l)return;t.pop(),a(_.APIEvents.SetBoardPosition,{pieces:n.getPieces()}),a(wi.APIEvents.CancelGuess,l)},confirm:function confirm(t){const{respond:n}=e,a=getLastGuess();if(!a)return;Object.assign(a,{confirmed:!0,correct:t}),n(wi.APIEvents.GuessConfirmed,a)},get:function get2(){return t},getActiveGuess:getActiveGuess,guess:function guess(n){var a,l;const{api:f,respond:p}=e,h=__spreadProps(__spreadValues({},n),{confirmed:!1,correct:!1,ids:null!=(l=null==(a=f.getSelectedNode())?void 0:a.ids)?l:{line:0,move:0}});t.push(h),p(wi.APIEvents.GuessMade,h)},reset:function reset(){t=[]}};function getActiveGuess(){const e=getLastGuess();return(null==e?void 0:e.confirmed)?void 0:e}function getLastGuess(){return t[t.length-1]}}function createMove$4(e){const{api:t,game:n,respond:a}=e,l=t.move;return function move(e){return e.userGenerated?function handleGuessAttempt(e){if(t.isLegalMove(e)){const l=n.move(e);if(!l)return a(_.APIEvents.IllegalMove);t.guessTheMove.guess(l);const f=__spreadValues({},t.getPieces());return n.undo(),a(_.APIEvents.SetBoardPosition,{pieces:f})}return a(_.APIEvents.IllegalMove)}(e):function handleGameMoveAndConfirmGuess(e){const n=__spreadValues({},e),a=t.guessTheMove.getActiveGuess(),f=t.getMove(e);if(!f||!a)return t.isAtEndOfLine()?l(e):t.addMoveToEndOfLine(n);const p=f.color===t.getPlayingAs()&&f.san===a.san;return e.animate=!p,t.reload(),l(e),t.guessTheMove.confirm(p)}(e)}}(function(e){e.Name="guessTheMove"})((Ti=wi||(wi={})).Plugin||(Ti.Plugin={})),function(e){e.CancelGuess="CancelGuess",e.GuessConfirmed="GuessConfirmed",e.GuessMade="GuessMade"}(Ti.APIEvents||(Ti.APIEvents={})),(Pi=Ti.Colors||(Ti.Colors={})).Correct="#96bc4b",Pi.Incorrect="#c93430";function getGuessTheMoveHighlights(e,t){var n;const{api:a,options:l}=t,f=null==(n=a.guessTheMove)?void 0:n.getActiveGuess();if(!l||!l.allowMarkings||!f)return[];const p=[];if(f.from){const e=createKeyedHighlight({color:l.premoveHighlightColor,opacity:l.premoveHighlightOpacity,square:f.from,type:"gtm"});p.push(e)}const h=createKeyedHighlight({color:l.premoveHighlightColor,opacity:l.premoveHighlightOpacity,square:f.kingTo||f.to,type:"gtm"});return p.push(h),p}function createGuessTheMoveModePlugin(){let e=!1;return{api:createGuessTheMoveAPI,apiOverrides:{move:createMove$4},beforeState:[{condition:is(_.UserEvents.PointerdownRight),handler:function cancelGuess(e,{api:t,queue:n}){if(!t.guessTheMove.getActiveGuess())return!0;return n.add(t.guessTheMove.cancel),!1}}],destroy:function destroy(e){var t;const{api:n}=e;null==(t=n.highlights)||t.removeModule(getGuessTheMoveHighlights)},match:[{condition:isOneOf(jn),handler:function handler2(e,t){const{api:n,queue:a}=t;e.type===_.APIEvents.Load&&n.guessTheMove.reset();const l=n.getTurn();a.add(n.setPlayingAs,l)}},{condition:isOneOf(wi.APIEvents),handler:function addHighlights(t,n){var a,l,f;if(e)return;const{api:p}=n;null==(a=p.highlights)||a.addModule(getGuessTheMoveHighlights),(null!=(f=null==(l=p.highlights)?void 0:l.getModules())?f:[]).find((e=>"getGuessTheMoveHighlights"===e.name))&&(e=!0)}},{condition:is(wi.APIEvents.GuessConfirmed),handler:function handleGuessConfirmation(e,t){const{api:n}=t,{correct:a,ids:l}=e.data;n.updateNode(l,{customColor:a?wi.Colors.Correct:wi.Colors.Incorrect})}}],name:wi.Plugin.Name}}const Ai=createModeFactory((function base$4({api:e}){return{isAllowedToMove:function isAllowedToMove(){return e.guessTheMove&&e.isAtEndOfLine()&&!e.guessTheMove.getActiveGuess()},handleIllegalMove:createHandleIllegalMove(e),name:li.Types.GuessTheMove,plugins:[createGuessTheMoveModePlugin()],usePlayingAs:!0}}),{canAddMovesToMainLine:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!1}});var Mi=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:Ai});function createLoad$1(e){const{api:t,respond:n}=e,a=t.load;return function load2(e,l){const f=t.observing;return f.setCachedPGN(""),f.isAnalyzing()&&(f.clearCachedIds(),n(Br.APIEvents.AnalysisEnd)),a(e,l)}}function isNullNode(e){return Boolean(e&&"san"in e&&"--"===e.san)}function createMove$3(e){const{api:t,respond:n,game:a}=e,l=t.move;return function move(e){const f=t.observing.getCachedPGN();return f&&t.load({pgn:f}),e.userGenerated?function userGeneratedMove(e){var f;const p=t.observing,{move:h,line:m}=a.ids(),g=p.isAnalyzing(),v=isMainLine(m);0===(null==(f=t.getLine(0))?void 0:f.length)&&a.move("--");const y=t.getNodeByIds({line:0,move:0});isNullNode(y)&&"san"in e&&(e.san="");isNullNode(y)&&isNullNode(t.getSelectedNode())&&t.selectNode(0,-1);v&&!canMoveForward({api:t,followAlternateLines:!0,mv:e})&&t.isAtEndOfLine()&&t.createContinuation();const b=l(e);if((null==b?void 0:b.type)!==_.APIEvents.Move)return b;const C=isMainLine(a.ids().line);!v||C||g||(p.setCachedIds(h,m),n(Br.APIEvents.AnalysisStart));return b}(e):function programmaticMove(e){const n=t.observing,f=isNullNode(t.getNodeByIds({line:0,move:0})),p=t.getLine(0);if(f&&1===(null==p?void 0:p.length))return void function replaceNullMove({move:e,api:t,game:n}){const a=t.observing,l=n.ids();n.selectPosition(0,0),n.createVariation(),n.move(e);const f=t.getRawLines().length-1;n.promoteVariation(f,0),n.deletePosition(0,f);const{playSounds:p}=t.getOptions();p&&t.setOptions({playSounds:!1});const h=a.getCachedIds();h&&a.clearCachedIds(),t.load({pgn:t.getPGN()}),p&&t.setOptions({playSounds:!0}),h&&a.setCachedIds(h.move,h.line),t.selectNode(l.line,l.move)}({move:e,api:t,game:a});if(n.isAnalyzing()||!t.isAtEndOfLine())return t.addMoveToEndOfLine(e,0);return l(e,!1)}(e)}}function createRestorePosition(e){const{api:t}=e;return function restorePosition2(e,n){const a=t.observing;if(!a.isAnalyzing())return;const l=a.getCachedIds();e?t.load(e,n):t.load({pgn:t.getPGN()}),l&&t.selectNode(l.line,l.move)}}function createObservingModeAPI(e){let t,n="";return{clearCachedIds:function clearCachedIds(){t=void 0},getCachedIds:function getCachedIds(){return t},isAnalyzing:function isAnalyzing(){return Boolean(t)},restorePosition:createRestorePosition(e),setCachedIds:function setCachedIds(e,n){t={move:e,line:n}},setCachedPGN:function setCachedPGN(e){n=e},getCachedPGN:function getCachedPGN(){return n}}}function or(...e){return function checkConditions(t,n){return Boolean(e.find((e=>e(t,n))))}}function nullMovePresent(e,t){const{api:n}=t;return isNullNode(n.getNodeByIds({line:0,move:0}))}function nullMoveAbsent(e,t){const{api:n}=t;return!isNullNode(n.getNodeByIds({line:0,move:0}))}function nullMoveSelected(e,t){const{api:n}=t;return isNullNode(n.getSelectedNode())}function startingPositionSelected(e,t){var n,a;const{api:l}=t,f=l.getSelectedNode();return 0===(null==(n=null==f?void 0:f.ids)?void 0:n.line)&&-1===(null==(a=null==f?void 0:f.ids)?void 0:a.move)}function variationSelected(e,t){const{api:n}=t,a=n.getSelectedNode();return Boolean(a&&0!==a.ids.line)}function firstVariationEmpty(e,t){const{api:n}=t,a=n.getLine(1);return Boolean(!a||0===a.length)}function firstNodeDeletedFromVariation(e,t){var n;const{data:a}=e;return Boolean(0===(null==(n=a.line)?void 0:n.atMoveNode))}function cachePGNAndLoadEmptyPGN(e,t){const{api:n,queue:a}=t,l=n.observing,f=n.getPGN();a.add((function loadInNextCycle(){a.add((function loadAndSetPGN(){n.load({pgn:"*"}),l.setCachedPGN(f)}))}))}function startAnalysis(e,t){const{api:n,queue:a}=t;n.observing.isAnalyzing()||a.add((function initAnalysis(){var e;const t=null==(e=n.getSelectedNode())?void 0:e.ids;t&&(n.observing.setCachedIds(t.move,t.line),n.getContext().respond(Br.APIEvents.AnalysisStart))}))}function selectFirstVariationNode(e,t){const{api:n,queue:a}=t;a.add((function selectNode2(){n.selectNode(1,0)}))}function selectFirstVariationEnd(e,t){const{api:n,queue:a}=t,l=n.getLine(1);if(l){const e=Math.max(...l.map((e=>e.moveNumber)));a.add((function selectNode2(){n.selectNode(1,e)}))}}function removeNullMoveAndRestorePosition(e,t){const{api:n}=t,a=n.observing;n.deletePosition(0,0),a.setCachedPGN(""),a.restorePosition()}function selectStartingPosition(e,t){const{api:n,queue:a}=t;a.add((function selectNode2(){n.selectNode(0,-1)}))}function refreshAnalysisOverlay(e,t){const{api:n}=t,a=n.observing,{overlayInAnalysisMode:l}=n.getOptions(),f=a.isAnalyzing();f!==l&&n.setOptions({overlayInAnalysisMode:f})}function restorePosition(e,t){const{api:n}=t;n.observing.restorePosition()}function selectNullNode(e,t){const{api:n,queue:a}=t;a.add((function selectNode2(){n.selectNode(0,0)}))}const xi=createModeFactory((function base$3(){return{isAllowedToMove:function isAllowedToMove(){return!0},name:li.Types.Observing,plugins:[createAnalysisOverlayPlugin(),{api:createObservingModeAPI,apiOverrides:{load:createLoad$1,move:createMove$3},create:function create2(e){const{api:t}=e;t.setOptions({overlayInAnalysisMode:!1})},match:[{condition:isOneOf([Br.APIEvents.AnalysisStart,Br.APIEvents.AnalysisEnd]),handler:refreshAnalysisOverlay},{condition:pipeConditions(is(Br.APIEvents.AnalysisEnd),nullMovePresent),handler:cachePGNAndLoadEmptyPGN},{condition:pipeConditions(is(_.APIEvents.ResetToMainLine),nullMovePresent),handler:removeNullMoveAndRestorePosition},{condition:pipeConditions(is(_.APIEvents.ResetToMainLine),nullMoveAbsent),handler:restorePosition},{condition:pipeConditions(is(_.APIEvents.DeletePosition),nullMovePresent,firstVariationEmpty),handler:removeNullMoveAndRestorePosition},{condition:pipeConditions(is(_.APIEvents.DeletePosition),nullMovePresent,firstNodeDeletedFromVariation),handler:selectNullNode},{condition:pipeConditions(is(_.APIEvents.DeletePosition),nullMoveAbsent,firstVariationEmpty),handler:restorePosition},{condition:pipeConditions(is(_.APIEvents.SelectNode),nullMoveSelected),handler:selectStartingPosition},{condition:pipeConditions(is(_.APIEvents.SelectNode),nullMoveAbsent,variationSelected),handler:startAnalysis},{condition:pipeConditions(is(_.APIEvents.MoveForward),nullMovePresent,or(nullMoveSelected,startingPositionSelected)),handler:selectFirstVariationNode},{condition:pipeConditions(is(_.APIEvents.SelectLineEnd),nullMovePresent,or(nullMoveSelected,startingPositionSelected)),handler:selectFirstVariationEnd}],name:Br.Plugin.Name}]}}),{canAddMovesToMainLine:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!1}});var Oi,Ri,Ii=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:xi});function createMove$2(e){const{api:t}=e,n=t.move,a=function handleMoveOnPreviousNodeFactory(e){const{api:t}=e;return function handleMoveOnPreviousNode(){if(!t.isAtEndOfLine())if(t.getMode().getOptions().canModifyExistingMovesOnMainLine){const{line:e,move:n}=getIdsToDelete(t.getRelativeNode());t.deletePosition(n,e)}else t.selectLineEnd()}}(e);return function move(e){return t.isGameOver()&&t.getMode().getOptions().canMoveWhenGameIsOver&&t.setResult(rr.Results.None),a(),n(e)}}(function(e){e.Name="playing"})((Ri=Oi||(Oi={})).Plugin||(Ri.Plugin={}));const Li=createModeFactory((function base$2({api:e}){return{handleIllegalMove:createHandleIllegalMove(e),isAllowedToMove:function isAllowedToMove(){return isAllowedToMoveInPlayingMode({api:e,canMoveWhenNotPlayerTurn:!1,modeOptions:e.getMode().getOptions()})},name:li.Types.Playing,plugins:[{apiOverrides:{move:createMove$2},name:Oi.Plugin.Name}],overridableMethods:["isAllowedToMove"],usePlayingAs:!0}}),{canAddMovesToMainLine:{default:!0,editable:!0},canMoveWhenGameIsOver:{default:!1,editable:!0},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!0}});var Ni=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:Li});const Di=createModeFactory((function base$1(){return{isAllowedToMove:function isAllowedToMove(){return!1},name:li.Types.PassiveObserving}}),{canAddMovesToMainLine:{default:!1,editable:!1},canInteractWithPieces:{default:!1,editable:!1},canModifyExistingMovesOnMainLine:{default:!1,editable:!1}});var Bi,Fi,ji=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:Di});function createDropPiece(e){return function dropPiece2({piece:t,square:n}){const{api:a,game:l}=e;return l.remove(n),l.put(t,n),a.setGameDetails({FEN:l.fen()}),a.reload()}}function createMovePiece(e){return function movePiece({from:t,piece:n,to:a}){const{api:l,game:f}=e;return f.remove(t),f.remove(a),f.put(n,a),l.setGameDetails({FEN:f.fen()}),l.reload()}}function createRemovePiece(e){return function removePiece(t){const{api:n,game:a}=e;return a.remove(t),n.setGameDetails({FEN:a.fen()}),n.reload()}}function createSetupAPI(e){return{dropPiece:createDropPiece(e),movePiece:createMovePiece(e),removePiece:createRemovePiece(e)}}function createGetMove$1(){return function getMove(e){return e}}function createMove$1(e){const{api:t}=e;return function move(e){const{color:n,drop:a,from:l,to:f}=e,{setup:p}=t,h=n&&a?{color:n,type:a}:t.getPiece(l);h&&(l&&f?p.movePiece({from:l,piece:h,to:f}):f?p.dropPiece({piece:h,square:f}):l&&p.removePiece(l))}}(function(e){e.DropPiece="DropPiece",e.MovePiece="MovePiece",e.RemovePiece="RemovePiece"})((Fi=Bi||(Bi={})).Events||(Fi.Events={})),function(e){e.Name="setup"}(Fi.Plugin||(Fi.Plugin={}));const $i=createModeFactory((function base(){return{isAllowedToMove:function isAllowedToMove(){return!0},name:li.Types.Setup,plugins:[{api:createSetupAPI,apiOverrides:{getMove:createGetMove$1,isLegalMove:()=>!0,move:createMove$1},name:Bi.Plugin.Name}]}}),{canAddMovesToMainLine:{default:!1,editable:!1},canDropOffBoard:{default:!0,editable:!1},canInteractWithPieces:{default:!0,editable:!0},canModifyExistingMovesOnMainLine:{default:!1,editable:!1},canDropPiecesContinuously:{default:!1,editable:!0}});var Hi=Object.freeze({__proto__:null,[Symbol.toStringTag]:"Module",create:$i});function getExtendedNode({move:e,startingMoveNumber:t}){if(!e)return null;const{moveNumber:n}=e,a=n%2==0&&e.color===rr.ColorsAsNumbers.Black||n%2!=0&&e.color===rr.ColorsAsNumbers.White,l=t+Math.floor(n/2)+(a&&e.color===rr.ColorsAsNumbers.White?1:0);return __spreadProps(__spreadValues({},e),{ply:e.ids.move+1,wholeMoveNumber:l})}function getTimestamp({baseTimeDs:e,incrementDs:t,lastTimeDs:n,currentTimeDs:a}){if(!a)return 1;const l=(null!=n?n:e)-(a-t);return Math.max(l,1)}function calculateTimestampValue({api:e,node:t}){const n=e.getLine(0),a=e.timeControl.get();if(!n||!a)return null;const l=t.time,f=getPreviousNodeOfSameColor({api:e,node:t}),p=null==f?void 0:f.time,{baseTime:h,increment:m}=a;return getTimestamp({baseTimeDs:millisecondsToDeciseconds(h),incrementDs:millisecondsToDeciseconds(m),lastTimeDs:p,currentTimeDs:l})}function formatClk(e){const t=Math.floor(e%36e3/600),n=Math.floor(e%36e3%600)/10;return`${Math.floor(e/36e3)}:${t<10?"0":""}${t}:${n<10?"0":""}${n}`}function handleTimestamp({context:e,time:t}){const{api:n,game:a}=e,l=a.moveDetails();l.time=t,function setClkOnNode({api:e,node:t,clk:n}){const{line:a,move:l}=t.ids,f=e.getContext().game;t.commands||(t.commands={}),f.updateNode({commands:Object.assign(t.commands,{clk:null===n?n:formatClk(n)})},l,a)}({api:n,node:l,clk:t});const f=calculateTimestampValue({api:n,node:l});f&&setTimestampOnNode({api:n,node:l,timestamp:f})}function createAddMoveToEndOfLine(e){return function addMoveToEndOfLine(t,n=0){var a;const{api:l,game:f,mutateGame:p,respond:h}=e,{ids:m}=null!=(a=l.getSelectedNode())?a:{ids:{move:-1,line:0}},{move:g,line:v}=m;f.selectLineEnd(n);const y=p((function callMethod(){f.move(t,!1),t.time&&handleTimestamp({context:e,time:t.time})}));return f.selectPosition(g,v),null===y?h(_.APIEvents.IllegalMove,{fen:f.fen(),move:t}):(y.move=getExtendedNode({move:y.move,startingMoveNumber:f.startingMoveNumber()})||void 0,h(_.APIEvents.AddMove,{listMove:y.move}))}}function createAgreeDraw(e){return function agreeDraw(){const{api:t,respond:n}=e;return t.isGameOver()?null:(t.setResult(rr.Results.Draw),n(_.APIEvents.DrawAgreed))}}function createBlinkHighlight(e){return function blinkHighlight(t){const{respond:n}=e,a={data:t,type:F};return n(_.APIEvents.BlinkHighlight,[a])}}function tryMovingForward(e){const{move:t,followContinuations:n=!0,steps:a=1,context:l}=e,{mutateGame:f,game:p}=l,h=p.ids(),m=f((function callMethod(){p.moveForward(n,t)}));let g=1===(null==m?void 0:m.plyDiff);if(a>1&&g)for(let y=1;y<a&&(g=p.moveForward(n),g);y++);const v=p.ids();return p.selectPosition(h.move,h.line),{firstStepData:m,startIds:h,endIds:v,success:g}}function createCanMoveForward(e){return function canMoveForward2(t){const{move:n,followContinuations:a,steps:l}=null!=t?t:{},{success:f}=tryMovingForward({context:e,move:n,followContinuations:a,steps:l});return f}}function isClaimableDraw(e){return e.inThreefoldRepetition()||e.in50MoveRule()}function createClaimDraw(e){return function claimDraw(){const{api:t,game:n}=e;return t.isGameOver()?null:isClaimableDraw(n)?(t.setResult(rr.Results.Draw),e.respond(_.APIEvents.DrawClaimed)):null}}const Vi={ClearMarkings:buildMarkingsWarning("clearMarkings","api.markings.removeAll/removeAllWhere/removeMany/removeOne"),Mark:buildMarkingsWarning("mark","api.markings.addOne/addMany"),ToggleMarking:buildMarkingsWarning("toggleMarking","api.markings.toggleOne/toggleMany"),Unmark:buildMarkingsWarning("unmark","api.markings.removeOne/removeMany")};function buildMarkingsWarning(e,t){return`The "${e}" method is deprecated and will be removed in v2.0.0. Please use the ${t} methods instead.`}function createClearMarkings(e){return function clearMarkings(t,n={}){console.warn(Vi.ClearMarkings);const{api:a,respond:l}=e,f=a.markings,p=null==t?void 0:t.map((e=>"square"===e?"highlight":e));return f.removeAllWhere(__spreadProps(__spreadValues({},n),{types:p})),l(_.APIEvents.ClearMarkings)}}function createCreateContinuation(e){return function createContinuation(){const{api:t,game:n,respond:a}=e,l=n._getPos();if("initial"in l)return null;n.createVariation(),n.move(l);const f=t.getRelativeNode();return a(_.APIEvents.CreateContinuation,{node:f})}}function createDeletePosition(e){return function deletePosition(t,n){const{api:a,game:l,respond:f}=e,p=a.getRawLines()[n];return l.deletePosition(t,n),0===n&&a.getResult()!==rr.Results.None&&a.setResult(rr.Results.None),f(_.APIEvents.DeletePosition,{ids:{line:n,move:t},line:p,pieces:a.getPieces()})}}function createExtendAPI(e){const t={};return function extendAPI(n,a){const l=Object.entries(a).map((([a,l])=>{if(l)return t[a]||(t[a]={extensions:{},original:e.api[a]}),e.api[a]=l(e),t[a].extensions[n]=l,function destroyOverride(){delete t[a].extensions[n],e.api[a]=t[a].original,Object.keys(t[a].extensions).map((n=>e.api[a]=t[a].extensions[n](e)))}}));return function destroyOverride(){l.map((e=>e&&e()))}}}function createGetCalculatedResult(e){return function getCalculatedResult(){const{api:t,game:n}=e;let a=rr.Results.None;const l=isClaimableDraw(n);return l&&t.getOptions().autoClaimDraw||!l&&n.inDraw()?a=rr.Results.Draw:function isJCEWin(e){return e.inCheckmate()||Boolean(e.isVariantWin())||Boolean(e.isBughouseWin())}(n)&&(a=n.turn()===rr.ColorsAsNumbers.Black?rr.Results.White:rr.Results.Black),a}}function createGetContext(e){return function getContext(){return e}}function createGetCurrentFullLine(e){return function getCurrentFullLine(){const{game:t}=e;return t.history({toCurrent:!0,verbose:!0})}}function createGetFen(e){return function getFEN(){const{game:t}=e;return t.fen()}}function createGetFingerprints(e){return function getFingerprints(){return B.gameFingerprints({game:e.game,analysis:!0})}}function createGetHeaders(e){return function getHeaders(){const{game:t}=e;return t.headers()}}function isFirstNodeInLine(e){return-1===e}function createGetHistoryFENs(e){return function getHistoryFENs(t=!1){const{game:n}=e,a=n._getPos();return a.ids&&0===a.ids.line&&isFirstNodeInLine(a.ids.move)&&a.fen?[a.fen]:n.history({toCurrent:!t,verbose:!0}).map((e=>e.fen))}}function createGetHistorySANs(e){return function getHistorySANs(){const{game:t}=e;return t.history(!1)}}function createGetJCEGameCopy(e){return function getJCEGameCopy(){var t;const{api:n}=e,a=(null==(t=n.premoves)?void 0:t.getQueue())||[],l=B.createGame({pgn:n.getPGN(),analysis:!0,timestamps:n.times.get()||n.timestamps.get()||void 0});return l?(l.premove.queue.push(...a),l):null}}function createGetLastMove(e){return function getLastMove(){const{game:t}=e;return t.history(!0).slice(-1)[0]}}function createGetLegalMoves(e){return function getLegalMoves(){const{game:t}=e;return B.getLegalMoves({game:t})}}function createGetLegalMovesForSquare(e){return function getLegalMovesForSquare(t){return e.api.getLegalMoves().filter((e=>void 0===t||e.from===t)).map((e=>e.to)).filter(((e,t,n)=>n.indexOf(e)===t))}}function createGetLine(e){return function getLine(t){const{game:n}=e,a=n.startingMoveNumber(),l=e.api.getRawLines()[t];if(l)return l.forEach(((e,t)=>{const n=getExtendedNode({move:e,startingMoveNumber:a});l[t]=n})),l}}function createGetMarkings(e){return function getMarkings(){const{api:t}=e;return function convertMarkingsToCollection(e){const t={[rr.Node.Marking.Types.Arrow]:{},[rr.Node.Marking.Types.CustomItem]:{},[rr.Node.Marking.Types.Effect]:{},[rr.Node.Marking.Types.Square]:{}};return e.map((e=>{var t;return __spreadValues({markingType:"highlight"===e.type?"square":e.type,key:null!=(t=e.data.square)?t:`${e.data.from}${e.data.to}`,color:Bn.Default},e.data)})).reduce(((e,t)=>{const{key:n,markingType:a}=t;return e[a][n]=t,e}),t)}(t.markings.getAll())}}function createGetMaterial(e){return function getMaterial(){const{game:t}=e;return t.material()}}function createGetMove(e){return function getMove(t){const{game:n}=e;if(null===t.to)return null;let a=n.getMove(t);return null===a&&(Object.assign(t,{promotion:"q"}),a=n.getMove(t)),a&&(a=n.moveDetails(a)),a}}function createGetNodeByIds(e){return function getNodeByIds(t){const{api:n,game:a}=e,l=n.getRawLines()[t.line];return l?isFirstNodeInLine(t.move)?l:getExtendedNode({move:l[t.move],startingMoveNumber:a.startingMoveNumber()}):null}}function getMoveNumber(e){const{moveNumber:t}=e;return void 0!==t?t:-1}function getEPCapturedSquare(e){if(e.flags===rr.Move.Flags.EPCapture&&e.from)return`${e.to.slice(0,1)}${e.from.slice(-1)}`}function extend(e){const t=__spreadProps(__spreadValues({},e),{EPCapturedSquare:getEPCapturedSquare(e)});return e.rookFrom&&e.rookTo&&(t.rookMove={animate:!0,from:e.rookFrom,to:e.rookTo}),t}function createGetNodeDiffData(e){return function getNodeDiffData(t,n){const{api:a,game:l}=e,f=null!=n?n:l._getPos(),p=null!=t?t:l._getPos(-1,0),h={};return h.plyDiff=function getPlyDiff(e,t){return getMoveNumber(t)-getMoveNumber(e)}(p,f),h.lineDiff=function getLineDiff(e,t){return t.ids.line-e.ids.line}(p,f),-1===h.plyDiff?h.move=extend(__spreadProps(__spreadValues({},t),{animate:!0})):1===h.plyDiff?(h.animate=!0,h.move=extend(__spreadProps(__spreadValues({},f),{animate:!0}))):h.pieces=a.getPieces(),h}}function createGetNodeIds(e){return function getNodeIds(){const{game:t}=e;return t.ids()}}function createGetPieces(e){return function getPieces(){const{game:t}=e;return createCollection(t.getPieces(!0))}}function createGetPGN(e){return function getPGN(t={}){const{game:n}=e;return n.pgn(__spreadProps(__spreadValues({},t),{useResultHeader:!0}))}}function createGetPiece(e){return function getPiece(t){const{game:n}=e;return n.get(t)}}function createGetPosition(e){return function getPosition2(t,n){const{game:a}=e;return a._getPos(t,n)}}function createGetPositionDetails(e){return function getPositionDetails(t){const n=e.api.getPGN();return B.getPositionDetails({pgn:n},t)}}function createGetPositionInfo(e){return function getPositionInfo(t=[]){const{api:n}=e,a=B.getPositionInfo(n.getFEN(),t,{variant:rr.JCEVariantTypes[n.getVariant()]});return"object"==typeof a&&__spreadProps(__spreadValues({},a),{gameOver:n.isGameOver()})}}function createGetRawLines(e){return function getRawLines(){const{game:t}=e;return t._lines()}}function createGetRelativeNode(e){return function getRelativeNode(t=0){const{game:n}=e,a=__spreadValues({},n.ids());a.move+=t;const l=e.api.getRawLines()[a.line];return isFirstNodeInLine(a.move)?l:getExtendedNode({move:l[a.move],startingMoveNumber:n.startingMoveNumber()})}}function createGetResult(e){return function getResult(){const{game:t}=e;return t.headers().Result}}function createGetSelectedNode(e){return function getSelectedNode(){const{api:t,game:n}=e,a=n.ids();if(isFirstNodeInLine(a.move))return null;return getExtendedNode({move:t.getRawLines()[a.line][a.move],startingMoveNumber:n.startingMoveNumber()})}}function createGetTCN(e){return function getTCN(){const{game:t}=e;return B.encodeTCN(t.history(!0))}}function createGetTurn(e){return function getTurn(){const{game:t}=e;return t.turn()}}const Ui={"3-check":rr.Variants.ThreeCheck,Bughouse:rr.Variants.Bughouse,Chess:rr.Variants.Chess,Chess960:rr.Variants.Chess960,Crazyhouse:rr.Variants.Crazyhouse,"King of the Hill":rr.Variants.KingOfTheHill};function createGetVariant(e){return function getVariant(){var t;const{api:n}=e,a=n.getHeaders().Variant;return a&&null!=(t=Ui[a])?t:rr.Variants.Chess}}function createIsAtEndOfLine(e){return function isAtEndOfLine(){const{game:t}=e,n=t.ids();return e.api.getRawLines()[n.line].length-1===n.move}}function createIsCheck(e){return function isCheck2(){const{game:t}=e;if(t.inCheck()){const n=e.api.getPieces();return n.keys().filter((e=>{const a=n.get(e);return"k"===a.type&&a.color===t.turn()}))[0]}return!1}}function createIsGameOver(e){return function isGameOver(){const{api:t}=e;return"*"!==t.getResult()}}function createIsLegalMove(e){return function isLegalMove(t){const{game:n}=e;return null!==n.getMove(t)}}function createLoad(e){return function load2({fen:t,moves:n,pgn:a,times:l,timestamps:f,timeControl:p,variant:h=rr.Variants.Chess,pieces:m},g){const{api:v,game:y,respond:b}=e;let C=!1;a?C=y.loadPgn(a):t&&(C=y.load(t,h)),(n||""===n)&&(C=y.loadMoves(n,g));const S=v.getLine(0),k=l?function convertTimesToTimestamps(e,t){if(t&&e){const n=millisecondsToDeciseconds(e.baseTime),a=millisecondsToDeciseconds(e.increment);return t.map(((e,l)=>"number"!=typeof e?e:getTimestamp({baseTimeDs:n,incrementDs:a,lastTimeDs:l<=1?void 0:t[l-2],currentTimeDs:e})))}return t}(p||v.timeControl.get(),l):f;if(k&&S&&S.forEach(((e,t)=>{const n=k[t];void 0!==n&&setTimestampOnNode({api:v,node:e,timestamp:n})})),p&&v.timeControl.set(p),!C)throw new ChessError({code:So.BadData,data:{fen:t,pgn:a},message:"Unable to load with provided data."});const w=v.getResult();return v.setResult(w===rr.Results.None?v.getCalculatedResult():w),b(_.APIEvents.Load,__spreadProps(__spreadValues(__spreadValues({},B.getPositionDetails({game:y,skipValidation:!0})),B.getPositionInfo({analysis:!0,game:y})),{line:S,pieces:null!=m?m:v.getPieces(),variant:h}))}}function formatForMarkingsAPI(e,t={}){const[n,a]=Object.entries(e)[0],{node:l,persistent:f}=t;return toArray(a).map((e=>{const t={data:e,node:l,persistent:f,type:"square"===n?F:n};return __spreadProps(__spreadValues({},t),{key:generatePrimaryKey(t)})}))}function createMark(e){return function mark(t,n,a){var l,f;console.warn(Vi.Mark);const{api:p}=e,h=p.markings,m=formatForMarkingsAPI(t,{node:null!=(l=null==a?void 0:a.node)?l:n,persistent:null==(f=null==a?void 0:a.persistent)||f});return h.addMany(m),createCoreEvent(_.APIEvents.Mark,m)}}function createMove(e){return function move(t,n=!0){const{api:a,game:l,mutateGame:f,respond:p}=e,{animate:h,san:m,tcn:g,time:v,userGenerated:y,userGeneratedDrop:b}=function getMoveDetails(e,t){const n="string"==typeof e?B.sanToObj(e,t):e,{animate:a=!0,san:l,tcn:f,time:p,userGenerated:h,userGeneratedDrop:m}=n;return{animate:a,san:l,tcn:f,time:p,userGenerated:h,userGeneratedDrop:m}}(t,a.getFEN()),C=f((function makeMove(){if(!(g?l.loadMoves(g.slice(0,2),{atCurrent:!0,method:"merge"}):l.move(m||t,n)))return null;v&&handleTimestamp({context:e,time:v})}));return null===C?p(_.APIEvents.IllegalMove,{fen:l.fen(),move:t}):(C.result&&a.setResult(C.result),Object.assign(C.move,{animate:h,userGenerated:y,userGeneratedDrop:b}),C.move=extend(C.move),p(_.APIEvents.Move,C))}}function createMoveBackward(e){return function moveBackward(){const{respond:t,game:n,mutateGame:a}=e,l=a((function callMethod(){n.moveBackward()}));return!l||0===l.lineDiff&&0===l.plyDiff?t(_.APIEvents.MoveBackward,null):t(_.APIEvents.MoveBackward,l)}}function createMoveForward(e){return function moveForward(t,n){const{respond:a,api:l,game:f}=e,{move:p,followContinuations:h,steps:m}=function getMoveForwardParameters(e,t){var n;let a,l={};"object"==typeof e?l=e:a=e;const{move:f,followContinuations:p,steps:h}=l;return{move:null!=f?f:t,followContinuations:null==(n=null!=p?p:a)||n,steps:null!=h?h:1}}(t,n);if(m<1)return null;const{firstStepData:g,success:v,endIds:y}=tryMovingForward({context:e,move:p,followContinuations:h,steps:m});return 1===m||1!==(null==g?void 0:g.plyDiff)?(f.selectPosition(y.move,y.line),a(_.APIEvents.MoveForward,g)):v?l.selectNode(y.line,y.move):a(_.APIEvents.MoveForward,null)}}function createMoveVariation(e){return function moveVariation(t,n){const{game:a,respond:l}=e;return a.moveVariation(t,n)?l(_.APIEvents.MoveVariation):null}}function removeUnsetHeaders(e){return Object.keys(e).reduce(((t,n)=>(e[n]!==rr.EmptyPGNHeaders.Value&&e[n]!==rr.EmptyPGNHeaders.Date&&(t[n]=e[n]),t)),{})}const Gi={trans:function trans(e,t,n){return e},transChoice:function transChoice(e,t,n,a){return`${t}`}};function createOutOfTime(e){return function outOfTime(t){const{api:n,game:a,respond:l}=e,f=getOppositeColor(t),p=function capitalizeFirstLetter(e){return`${e[0].toUpperCase()}${e.slice(1)}`}(getColorAsWord(f)),h=n.getHeaders()[p];n.setResult(f===rr.ColorsAsNumbers.Black?rr.Results.Black:rr.Results.White),a.header({Termination:Gi.trans("%username% won on time",{"%username":h})});const m=__spreadProps(__spreadValues({},removeUnsetHeaders(a.header())),{color:t});return l(_.APIEvents.OutOfTime,m)}}function createReload(e){return function reload(){const{api:t,game:n,respond:a}=e;return a(_.APIEvents.Reload,{holdSelectedPiece:!0,pieces:createCollection(n.getPieces(!0)),variant:t.getVariant()})}}function createPromoteVariation(e){return function promoteVariation(t,n){const{game:a,respond:l}=e;return a.promoteVariation(t,n)?l(_.APIEvents.PromoteVariation):null}}function createResetGame(e){return function resetGame(){const{api:t,respond:n}=e;return t.setResult(rr.Results.None),t.load({fen:"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1"}),n(_.APIEvents.ResetGame)}}function createResign(e){return function resign(t){const{api:n,respond:a}=e;if(n.isGameOver())return null;const l=t===rr.ColorsAsNumbers.White?rr.Results.Black:rr.Results.White;return n.setResult(l),a(_.APIEvents.GameResigned,l)}}function createResetToMainLine(e){return function resetToMainLine(){const{api:t,game:n,respond:a}=e;return n.resetToMainLine(),a(_.APIEvents.ResetToMainLine,{pieces:t.getPieces()})}}function createSelectLineEnd(e){return function selectLineEnd(t){const{api:n,game:a,mutateGame:l,respond:f}=e,p=l((function callMethod(){a.selectLineEnd(t)}));return p&&(p.pieces=n.getPieces()),f(_.APIEvents.SelectLineEnd,p)}}function createSelectLineStart(e){return function selectLineStart(){const{api:t,game:n,mutateGame:a,respond:l}=e,f=a((function callMethod(){n.selectLineStart()}));return f&&(f.pieces=t.getPieces()),l(_.APIEvents.SelectLineStart,f)}}function createSelectNode(e){return function selectNode2(t,n){const{api:a,game:l,respond:f}=e,p=l.moveDetails();l.selectPosition(n,t);const h=l.moveDetails(),m=a.getNodeDiffData(p,h);return 0===m.plyDiff&&0===m.lineDiff?null:(0!==m.lineDiff&&(m.pieces=a.getPieces()),f(_.APIEvents.SelectNode,m))}}function createSetGameDetails(e){return function setGameDetails(t){const{game:n,respond:a}=e,l=removeUnsetHeaders(n.header(t));return a(_.APIEvents.UpdatePGNHeaders,l)}}function createSetResult(e){return function setResult(t){const{api:n}=e;return n.setGameDetails({Result:t})}}function createSetTurn(e){return function setTurn(t){const{game:n,respond:a}=e;return n.turn()===t?null:(n.turn(t),a(_.APIEvents.TurnSet,t))}}function createToggleMarking(e){return function toggleMarking(t,n,a){var l,f;console.warn(Vi.ToggleMarking);const{api:p}=e,h=p.markings,m=formatForMarkingsAPI(t,{node:null!=(l=null==a?void 0:a.node)?l:n,persistent:null==(f=null==a?void 0:a.persistent)||f});return h.toggleMany(m),createCoreEvent(_.APIEvents.Mark,m)}}function createUndo(e){return function undo2(){const{api:t}=e,n=t.getSelectedNode();return n?t.deletePosition(n.ids.move,n.ids.line):null}}function createUpdateNode(e){return function updateNode(t,n){const{game:a,respond:l}=e;return a.updateNode(n,t.move,t.line),l(_.APIEvents.NodeUpdated,{changes:n,ids:t,node:a._getPos(t.move,t.line)})}}function createUpdateLineComment(e){return function updateLineComment2(t,n){const{game:a,respond:l}=e;return a.updateLineComment(t,n),l(_.APIEvents.LineCommentUpdated,{comment:t,lineId:n})}}function createUnmark(e){return function unmark(t,n,a){var l,f;console.warn(Vi.Unmark);const{api:p}=e,h=p.markings,m=formatForMarkingsAPI(t,{node:null!=(l=null==a?void 0:a.node)?l:n,persistent:null==(f=null==a?void 0:a.persistent)||f});return h.removeMany(m.map((e=>e.key))),createCoreEvent(_.APIEvents.Unmark,m)}}function getBughouseGameTimeValues(e){return Array.isArray(e)&&Array.isArray(e[0])?e[0]:e}function createCreateGame(e){return function createGame2(t){const n=B.createGame(__spreadProps(__spreadValues({timestamps:t.times||t.timestamps||void 0},t),{analysis:!0}));if(!n)return;const{api:a}=e;let{times:l,timestamps:f}=t;return t.variant===rr.Variants.Bughouse&&(l=getBughouseGameTimeValues(l),f=getBughouseGameTimeValues(f)),a.load({pgn:n.pgn({useResultHeader:!0}),variant:t.variant,times:l,timestamps:f,premoves:n.premove.queue&&n.premove.queue.length>0?n.premove.queue:void 0})}}function createGetTimeControl(e){return function getTimeControl(){const t=e.api.getHeaders().TimeControl;if(!t||t===Ye.Header.Null||t.includes(Ye.Header.Unset)||t.includes(Ye.Header.TimePerMove))return null;const[n,a]=t.split(Ye.Header.Separator).map((e=>Math.round(1e3*parseFloat(e))));return{baseTime:n,increment:a||0}}}function createGetTimeControlType(e){return function getTimeControlType(){const{api:t}=e,n=t.timeControl.get();if(n){const e=function getExpectedGameDuration(e){const{baseTime:t,increment:n}=e;return(t+40*(n||0))/1e3}(n);if(e<1800)return Ye.Types.Bullet;if(e>6e3)return Ye.Types.Rapid}return Ye.Types.Blitz}}function createSetTimeControl(e){return function setTimeControl(t){const{api:n}=e;if(null===t)return n.setGameDetails({TimeControl:Ye.Header.Null});const{baseTime:a,increment:l}=t,f=a/1e3,p=l/1e3;return n.setGameDetails({TimeControl:p?`${f}+${p}`:`${f}`})}}function createTimeControlAPI(e){return{get:createGetTimeControl(e),getType:createGetTimeControlType(e),set:createSetTimeControl(e)}}function toUnit(e,t){if(null===e)return null;let n;switch(t){case R.Units.Milliseconds:n=100*e;break;case R.Units.Seconds:n=10*e;break;case R.Units.Deciseconds:default:n=e}return n}function getValidTimestamp(e,t){return null===e?null:Math.max(1,function toRoundedDeciseconds(e,t){let n;switch(t){case R.Units.Milliseconds:n=e/100;break;case R.Units.Seconds:n=10*e;break;case R.Units.Deciseconds:default:n=e}return Math.round(n)}(e,t))}function createTimestampsAPI(e){return{get:get2,set:function set2(t,n,a=R.Units.Deciseconds){var l;const{api:f,respond:p}=e,{getLine:h}=f,m=null==(l=h(0))?void 0:l[n];if(!m)return null;const g=getValidTimestamp(t,a);if(void 0===g)return null;return setTimestampOnNode({api:f,node:m,timestamp:g}),p(_.APIEvents.NodeUpdated,{changes:{timestamp:g,node:m}})},setMany:function setMany2(t=[],n=R.Units.Deciseconds){const{api:a,respond:l}=e,f=0===t.length?function getAll(){return get2(void 0,{filtered:!1})}().map((()=>null)):t;return a.getRawLines()[0].forEach(((e,t)=>{if(void 0===f[t])return;const l=getValidTimestamp(f[t],n);void 0!==l&&setTimestampOnNode({api:a,node:e,timestamp:l})})),l(_.APIEvents.LineUpdated)}};function get2(t,{filtered:n=!0}={},a=R.Units.Deciseconds){var l;const{api:f}=e,p=null==(l=f.getLine(0))?void 0:l.map(getTimestampFromNode);if(void 0!==t)return p[t]&&toUnit(p[t],a);return(n?p.filter((e=>void 0!==e)):p).map((e=>toUnit(e,a)))}}function createGetTimes(e){return function get2(t){var n;const{api:a}=e,l=a.getLine(0);return void 0!==t?null==(n=l[t])?void 0:n.time:l.map((e=>e.time))}}function createSetManyTimes(e){return function setMany2(t=[]){const{api:n,respond:a}=e;return n.getRawLines()[0].forEach(((e,a)=>{void 0!==t[a]&&(!e.time&&t[a]&&(e.time=t[a]),n.timestamps.set(calculateTimestampValue({api:n,node:e}),a))})),a(_.APIEvents.LineUpdated)}}function createSetTimes(e){return function set2(t,n){var a;const{api:l,respond:f}=e,{getLine:p}=l,h=null==(a=p(0))?void 0:a[n];return h?(h.time||(h.time=t),l.timestamps.set(calculateTimestampValue({api:l,node:h}),n),f(_.APIEvents.NodeUpdated,{changes:{time:t,node:h}})):null}}function createTimesAPI(e){return{get:createGetTimes(e),set:createSetTimes(e),setMany:createSetManyTimes(e)}}function createLoggerAPI(e=100){const t=createEventEmitter(),n=[];let a=Ut.Levels.Debug;const l={[Ut.Levels.None]:0,[Ut.Levels.Error]:1,[Ut.Levels.Debug]:2};return __spreadProps(__spreadValues({},t),{clear:function clear(){n.length=0},get:function get2(e){return e?n.filter((t=>Object.entries(e).every((([e,n])=>t[e]===n)))):n},log:function log({code:f,data:p,level:h=Ut.Levels.Debug,message:m}){if(l[h]>l[a])return;n.length===e&&n.shift();const g={code:f,data:p,level:h,message:m,timestamp:Date.now()};n.push(g),t.emit(Ut.Events.EntryAdded,g)},setLogLevel:function setLogLevel(e){a=e}})}function createAPI({game:e,logger:t,options:n,eventEmitter:a}){const l=e||B.createGame(__spreadProps(__spreadValues({},n),{analysis:!0}));if(!l)throw new ChessError({code:So.BadData,data:n,message:"Error creating game from createAPI"});const f=a||createEventEmitter(),p=function createMemoryCache(e={}){let t=copy(e);return{add:function add(e,...n){let a=t;n.forEach((e=>{e in a||(a[e]={}),a=a[e]})),Object.assign(a,e)},clear:function clear(n){n?t[n]={}:t=copy(e)},get:function get2(){return copy(t)},remove:function remove(...e){let n=t;const a=e.length-1;e.forEach(((e,t)=>{e in n&&t!==a&&(n=n[e])})),delete n[e[a]]}};function copy(e){return JSON.parse(JSON.stringify(e))}}({arrow:{},customItem:{},effect:{},square:{}}),h={},m=function createMutateGame(e,t){return function mutateGame(n){const a=e.moveDetails(),l=t.getCalculatedResult();if(null===n())return null;const f=e.moveDetails(),p=t.getCalculatedResult(),h=t.getNodeDiffData(a,f);l!==p&&isMainLine(null==f?void 0:f.ids.line)&&(h.result=p);const{line:m,move:g}=e.ids();return h.linesReordered=0!==m&&0===g&&e.reorderLines(),h}}(l,h),g=function createRespond(e){return function respond(t,n){const a=createCoreEvent(t,n);return e.emit(t,a),a}}(f),v={api:h,emitter:f,game:l,markingCache:p,mutateGame:m,respond:g};return Object.assign(v.api,function createAPIModel(){return __spreadProps(__spreadValues(__spreadProps(__spreadValues({addMoveToEndOfLine:createAddMoveToEndOfLine(v),agreeDraw:createAgreeDraw(v),blinkSquare:createBlinkHighlight(v),canMoveForward:createCanMoveForward(v),claimDraw:createClaimDraw(v),clearMarkings:createClearMarkings(v),createContinuation:createCreateContinuation(v),createGame:createCreateGame(v)},function createPlayingAsAPI(e){let t=rr.ColorsAsNumbers.White,n=!1;return{getPlayingAs:function getPlayingAs(){return n?t:void 0},setPlayingAs:function setPlayingAs(n){if(n===t)return null;const{respond:a}=e;return t=n,a(_.APIEvents.SetPlayingAs,n)},usePlayingAs:function usePlayingAs(e){n=e||!1}}}(v)),{deletePosition:createDeletePosition(v)}),f),{extendAPI:createExtendAPI(v),getCalculatedResult:createGetCalculatedResult(v),getContext:createGetContext(v),getCurrentFullLine:createGetCurrentFullLine(v),getFEN:createGetFen(v),getFingerprints:createGetFingerprints(v),getHeaders:createGetHeaders(v),getHistoryFENs:createGetHistoryFENs(v),getHistorySANs:createGetHistorySANs(v),getJCEGameCopy:createGetJCEGameCopy(v),getLastMove:createGetLastMove(v),getLegalMoves:createGetLegalMoves(v),getLegalMovesForSquare:createGetLegalMovesForSquare(v),getLine:createGetLine(v),getMarkings:createGetMarkings(v),getMaterial:createGetMaterial(v),getMove:createGetMove(v),getNodeByIds:createGetNodeByIds(v),getNodeDiffData:createGetNodeDiffData(v),getNodeIds:createGetNodeIds(v),getPGN:createGetPGN(v),getPiece:createGetPiece(v),getPieces:createGetPieces(v),getPosition:createGetPosition(v),getPositionDetails:createGetPositionDetails(v),getPositionInfo:createGetPositionInfo(v),getRawLines:createGetRawLines(v),getRelativeNode:createGetRelativeNode(v),getResult:createGetResult(v),getSelectedNode:createGetSelectedNode(v),getStartingMoveNumber:v.game.startingMoveNumber,getTCN:createGetTCN(v),getTurn:createGetTurn(v),getVariant:createGetVariant(v),isAtEndOfLine:createIsAtEndOfLine(v),isCheck:createIsCheck(v),isGameOver:createIsGameOver(v),isLegalMove:createIsLegalMove(v),load:createLoad(v),logger:t||createLoggerAPI(),mark:createMark(v),move:createMove(v),moveBackward:createMoveBackward(v),moveForward:createMoveForward(v),moveVariation:createMoveVariation(v),outOfTime:createOutOfTime(v),promoteVariation:createPromoteVariation(v),reload:createReload(v),resetGame:createResetGame(v),resetToMainLine:createResetToMainLine(v),resign:createResign(v),selectLineEnd:createSelectLineEnd(v),selectLineStart:createSelectLineStart(v),selectNode:createSelectNode(v),setGameDetails:createSetGameDetails(v),setResult:createSetResult(v),setTurn:createSetTurn(v),timeControl:createTimeControlAPI(v),times:createTimesAPI(v),timestamps:createTimestampsAPI(v),toggleMarking:createToggleMarking(v),undo:createUndo(v),unmark:createUnmark(v),updateLineComment:createUpdateLineComment(v),updateNode:createUpdateNode(v)})}()),v.api}function createGetSet(e={}){const t=e;return{get:function get2(e){return e?t[e]:t},set:function set2(e){Object.assign(t,e)}}}const qi={anyAPIEvent:({UpdateParams:e})=>(e.cancelMarkingStartSquare(),Lt.States.Idle),[_.UserEvents.PointerdownLeft]:({UpdateParams:e})=>(e.cancelMarkingStartSquare(),Lt.States.Idle),[_.UserEvents.Pointerup]:({context:e,data:{keyPressed:t,square:n},params:{markingStartSquare:a},UpdateParams:l})=>{const{api:{markings:f},options:p,queue:h}=e;return n&&a&&h.add(f.toggleOne,function getMarking({endSquare:e,keyPressed:t,opacity:n,startSquare:a}){if(a===e)return{data:{keyPressed:t,opacity:n,square:a},node:!0,persistent:!1,type:F};return{data:{keyPressed:t,from:a,opacity:n,to:e},node:!0,persistent:!1,type:G}}({endSquare:n,keyPressed:t,opacity:p.analysisHighlightOpacity,startSquare:a})),l.cancelMarkingStartSquare(),Lt.States.Idle}};const Wi={[_.UserEvents.PointerdownLeft]:({context:e,data:{coords:t,square:n},UpdateParams:a})=>{const{api:{getPieces:l,markings:f},mode:{getOptions:p},options:h,queue:m,renderer:g,state:v}=e;if(n&&m.add(f.removeAllWhere,{node:!0,persistent:!1,types:[G,Pe,F]}),!h.enabled||!p().canInteractWithPieces)return Lt.States.Idle;if(!l().isDefined(n))return Lt.States.Idle;if(h.moveMethod===ht.MoveMethods.Click){const t=null==g?void 0:g.getCoordsFromSquare(n,h.flipped);if(void 0===t)throw new ChessError({code:So.BadData,message:`getCoordsFromSquare returned undefined for ${n}`});return a.dragPiece(t,n),v.set({hideHoverSquare:!0}),null==g||g.dragPiece({coords:t,square:n},e),Lt.States.PieceDragging}return a.dragPiece(t,n),null==g||g.dragPiece({coords:t,square:n},e),Lt.States.PieceDragging},[_.UserEvents.PointerdownRight]:({context:e,data:{square:t},UpdateParams:n})=>{const{options:a}=e;if(a.enabled)return n.setMarkingStartSquare(t),Lt.States.AddingMarkings}};function shouldDropOrDeselectPiece({api:e,move:t,plyDiff:n,pieceSquare:a}){var l;const f=a&&(null==(l=e.getPieces().getCollection()[a])?void 0:l.color);return!t||1!==n||!f||f===t.color&&!t.userGenerated||(t.from===a||t.to===a)}const zi={anyAPIEvent:({context:e,data:{holdSelectedPiece:t,move:n,plyDiff:a},params:{draggingPiece:l},UpdateParams:f})=>{const{renderer:p}=e;return l&&!t&&shouldDropOrDeselectPiece({api:e.api,move:n,pieceSquare:l,plyDiff:a})?(f.resetElevatedState(),null==p||p.dropPiece(l,e),Lt.States.Idle):Lt.States.PieceDragging},[_.UserEvents.MousedownRight]:({context:e,params:{draggingPiece:t},UpdateParams:n})=>{const{renderer:a}=e;if(!t)throw new ChessError({code:So.BadData,message:"Attempted to pointerdown on a dragging piece but dragging piece is null or undefined"});return n.dropPiece(),n.deselectPiece(),null==a||a.dropPiece(t,e),Lt.States.Idle},[_.UserEvents.Pointermove]:({context:e,data:{coordsInsideBoard:t},params:{draggingPiece:n},UpdateParams:a})=>{const{renderer:l}=e;if(!n)throw new ChessError({code:So.BadData,message:"Attempted to drag a piece but draggingPiece is null or undefined"});return a.dragPiece(t,n),null==l||l.dragPiece({coords:t,square:n},e),Lt.States.PieceDragging},[_.UserEvents.Pointerup]:({context:e,data:{keyPressed:t,square:n},params:{draggingPiece:a,selectedPiece:l},UpdateParams:f})=>{var p;const{api:{getMove:h,getPiece:m,getTurn:g,isCheck:v,move:y,playSound:_},mode:b,options:C,queue:S,renderer:k}=e;if(!a)throw new ChessError({code:So.BadData,message:"Attempted to pointerup on a dragging piece but dragging piece is null or undefined"});if(e.options.test){const t=e.el.querySelector(".dragging");null==t||t.setAttribute("data-test-dragging","false"),null==t||t.removeAttribute("dragging")}if(a===n)return f.dropPiece(),null==k||k.dropPiece(a,e),l===n||C.moveMethod===ht.MoveMethods.DragOnly?(f.deselectPiece(),Lt.States.Idle):(f.selectPiece(a),Lt.States.PieceSelected);l&&f.deselectPiece();const w={from:a,to:n},T=h(w),P=!(!b.isAllowedToMove()||!T)&&__spreadProps(__spreadValues({},T),{animate:!1,userGenerated:!0,userGeneratedDrop:!0});if(!P){f.dropPiece(),b.handleIllegalMove&&S.add(b.handleIllegalMove,w);const t=v();let n=!1;return(null==(p=m(a))?void 0:p.color)===g()&&t&&(C.playSounds&&S.add(_,ze.BoardSounds.Illegal),n=t),null==k||k.illegalMove(n,e),null==k||k.dropPiece(a,e),C.moveMethod===ht.MoveMethods.DragOnly?(f.deselectPiece(),Lt.States.Idle):(f.selectPiece(a),Lt.States.PieceSelected)}return isPromotion(P)?C.autoPromote&&"alt"!==t?(f.dropPiece(),null==k||k.dropPiece(P.to,e),S.add(y,__spreadProps(__spreadValues({},P),{promotion:rr.Piece.Types.Queen})),Lt.States.Idle):(f.dragPiece({},a),f.showPromotionArea(P),null==k||k.dragPiece({square:a,toSquare:P.to},e),null==k||k.openPromotionWindow(P,e),Lt.States.PromotionAreaShowing):(f.dropPiece(),null===n&&b.getOptions().canDropOffBoard?null==k||k.removePiece(a,e):null==k||k.dropPiece(n,e),S.add(y,P),Lt.States.Idle)}},Ki={anyAPIEvent:({context:e,data:{holdSelectedPiece:t,move:n,plyDiff:a},params:{selectedPiece:l},UpdateParams:f})=>!t&&shouldDropOrDeselectPiece({api:e.api,move:n,pieceSquare:l,plyDiff:a})?(f.resetElevatedState(),Lt.States.Idle):Lt.States.PieceSelected,[_.UserEvents.PointerdownLeft]:({context:e,data:{coords:t,keyPressed:n,square:a},params:{selectedPiece:l},UpdateParams:f})=>{const{api:{getMove:p,getPieces:h,move:m},mode:{isAllowedToMove:g},options:v,queue:y,renderer:_,state:b}=e;if(!l)throw new ChessError({code:So.BadData,message:"Attempted to interact with a selectedPiece but selectedPiece is null or undefined"});if(a===l){const n=v.moveMethod===ht.MoveMethods.Drag||v.moveMethod===ht.MoveMethods.DragOnly?t:(null==_?void 0:_.getCoordsFromSquare(a,v.flipped))||t;return f.dragPiece(n,l),v.moveMethod===ht.MoveMethods.Click&&b.set({hideHoverSquare:!0}),null==_||_.dragPiece({coords:n,square:l},e),Lt.States.PieceDragging}const C={from:l,to:a},S=h(),k=p(C),w=!(!g()||!k)&&__spreadProps(__spreadValues({},k),{userGenerated:!0});if(!w){if(f.deselectPiece(),!S.isDefined(a))return Lt.States.Idle;if(v.moveMethod===ht.MoveMethods.Click){const n=(null==_?void 0:_.getCoordsFromSquare(a,v.flipped))||t;return f.dragPiece(n,a),b.set({hideHoverSquare:!0}),null==_||_.dragPiece({coords:n,square:a},e),Lt.States.PieceDragging}return f.dragPiece(t,a),null==_||_.dragPiece({coords:t,square:a},e),Lt.States.PieceDragging}return isPromotion(w)?v.autoPromote&&"alt"!==n?(f.deselectPiece(),y.add(m,w,__spreadProps(__spreadValues({},w),{promotion:rr.Piece.Types.Queen})),Lt.States.Idle):(f.deselectPiece(),f.dragPiece({},l),f.showPromotionArea(w),null==_||_.dragPiece({square:l,toSquare:w.to},e),null==_||_.openPromotionWindow(w,e),Lt.States.PromotionAreaShowing):(f.deselectPiece(),y.add(m,w),Lt.States.Idle)},[_.UserEvents.PointerdownRight]:({context:e,data:{square:t},UpdateParams:n})=>{const{options:a}=e;if(a.enabled)return n.deselectPiece(),n.setMarkingStartSquare(t),Lt.States.AddingMarkings}};function cancelPromotion({context:e,params:{draggingPiece:t},UpdateParams:n}){const{renderer:a}=e;return n.dropPiece(),n.cancelPromotion(),null==a||a.dropPiece(t,e),null==a||a.closePromotionWindow(e),Lt.States.Idle}const Zi={anyAPIEvent:e=>{const{data:t}=e;return t.move?Lt.States.PromotionAreaShowing:cancelPromotion(e)},[_.BoardEvents.PromotionPiecePointerdown]:({context:e,data:{piece:t},params:{draggingPiece:n,promotionMove:a},UpdateParams:l})=>{const{api:{move:f},queue:p,renderer:h}=e;return l.dropPiece(),l.cancelPromotion(),null==h||h.dropPiece(n,e),null==h||h.closePromotionWindow(e),a?(p.add(f,{animate:!1,flags:a.flags,from:a.from,piece:rr.Piece.Types.Pawn,promotion:t,to:a.to,userGenerated:!0}),Lt.States.Idle):Lt.States.Idle},[_.BoardEvents.PromotionAreaClosePointerdown]:cancelPromotion,[_.UserEvents.PointerdownLeft]:cancelPromotion,[_.UserEvents.PointerdownRight]:cancelPromotion},Qi={createUpdateParams:function createUpdateParams(e){return{cancelMarkingStartSquare:function cancelMarkingStartSquare(){e.markingStartSquare=void 0},cancelPromotion:function cancelPromotion2(){e.promotionMove=void 0},deselectPiece:function deselectPiece(){e.selectedPiece=void 0},dragPiece:function dragPiece(t,n){e.draggingPiece=n,e.draggingCoords=t},dropPiece:function dropPiece2(){e.draggingPiece=void 0,e.draggingCoords=void 0},resetElevatedState:function resetElevatedState(){e.draggingPiece=void 0,e.draggingCoords=void 0,e.promotionMove=void 0,e.selectedPiece=void 0},selectPiece:function selectPiece(t){e.selectedPiece=t},setMarkingStartSquare:function setMarkingStartSquare(t){e.markingStartSquare=t},showPromotionArea:function showPromotionArea(t){e.promotionMove=__spreadValues({},t)}}},getCurrentState:()=>Lt.States.Idle,getParams:()=>({draggingCoords:void 0,draggingPiece:void 0,markingStartSquare:void 0,promotionMove:void 0,selectedPiece:void 0}),states:{[Lt.States.AddingMarkings]:qi,[Lt.States.PieceDragging]:zi,[Lt.States.Idle]:Wi,[Lt.States.PromotionAreaShowing]:Zi,[Lt.States.PieceSelected]:Ki}};function createUpdateMachineState(){const e=Qi.getParams(),t=Qi.createUpdateParams(e);let n=Qi.getCurrentState();const a=[tt.Events.Tick];return function updateMachineState(l,f){if(a.includes(l.type))return;const{state:p}=f;p.set({draggingPiece:e.draggingPiece,machineState:n,promotionMove:e.promotionMove,selectedPiece:e.selectedPiece});const h=function isAPIEvent(e){return Object.values(_.APIEvents).includes(e.type)}(l)&&!function shouldIgnoreEvent(e){return[_.APIEvents.BlinkHighlight,_.APIEvents.ClearMarkings,_.APIEvents.Mark,_.APIEvents.LineUpdated,_.APIEvents.NodeUpdated,_.APIEvents.Unmark,_.APIEvents.UpdatePGNHeaders].includes(e)}(l.type)?"anyAPIEvent":l.type;if(!Qi.states[n]||!Qi.states[n][h])return void p.set({machineState:n});const m=Qi.states[n][h]({context:f,data:l.data,params:e,UpdateParams:t}),g=n;if(n=m||n,!function machineIsValid(){if(n===Lt.States.Idle)return!e.draggingPiece&&!e.selectedPiece;if(n===Lt.States.PieceDragging)return Boolean(e.draggingPiece);if(n===Lt.States.PieceSelected)return!e.draggingPiece&&Boolean(e.selectedPiece);return!0}())throw{data:{draggingPiece:e.draggingPiece,machineState:n,oldState:g,selectedPiece:e.selectedPiece},error:new ChessError({code:So.InvalidStateMachine,message:"The machine parameters and state do not match up."})};p.set({draggingPiece:e.draggingPiece,machineState:n,selectedPiece:e.selectedPiece})}}function runPlugin(e,t){e.match&&e.match.forEach((e=>function run2(e,t){if(!e.condition(...t))return;e.handler(...t)}(e,t)))}function createCore({params:e,plugins:t}){const n=function createContext({params:e,run:t}){const n=createQueue(!1),a=__spreadValues({queue:n,reset:function reset(){a.queue=createQueue(!1),a.state=createGetSet()},run:t,setMode:function setMode(e){a.mode=e},setRenderer:function setRenderer(e){a.renderer=e},state:createGetSet()},e);return a.reset(),a}({params:e,run:run2}),a=createUpdateMachineState();return{getContext:function getContext(){return n},getMode:function getMode2(){return n.mode},run:run2,setMode:function setMode(e){n.setMode(e)},setRenderer:function setRenderer(e){n.setRenderer(e)}};function run2(e){const{api:{logger:l}}=n;l.log({code:_.LogCodes.Event,data:e}),n.reset();const f=t.get(),p=function runBeforeStateHooks(e,t){return t.every((t=>function runBeforeState(e,t){if(!e.beforeState)return!0;let n=!0;return e.beforeState.forEach((e=>{!1===function run(e,t){if(e.condition(...t))return e.handler(...t)}(e,t)&&(n=!1)})),n}(t,[e,n])))}(e,f);p&&a(e,n);const{beforeRender:h,afterRender:m}=function splitPluginsByHookType(e){return e.reduce(((e,t)=>(t.afterRender?e.afterRender.push(t):e.beforeRender.push(t),e)),{beforeRender:[],afterRender:[]})}(f);try{h.forEach((t=>runPlugin(t,[e,n]))),n.queue.flush(),m.forEach((t=>runPlugin(t,[e,n]))),l.log({code:_.LogCodes.State,data:n.state.get()})}catch(g){throw l.log({code:_.LogCodes.State,data:__spreadProps(__spreadValues({},g.data),{event:e,queue:n.queue,state:n.state.get()}),level:Ut.Levels.Error}),g}}}function getKeyPressed(e){return e.altKey?lt.Alt:e.ctrlKey?lt.Ctrl:e.shiftKey?lt.Shift:lt.None}function isTouchEvent(e){return void 0!==e.touches}function isRightButton(e){return!isTouchEvent(e)&&3===e.which}function onNextTick(e){setTimeout(e)}function createUserEventHandlers$1({el:e,getPointerPosition:t,options:n,run:a}){const l=function debounceAnimationFrame(e){let t;return function run2(...n){t&&cancelAnimationFrame(t),t=requestAnimationFrame((()=>{t=null,e(...n)}))}}((function runPointerMoveEvent(l){const f=createCoreEvent(_.UserEvents.Pointermove);f.data=__spreadProps(__spreadValues({},t({el:e,event:l,flipped:n.flipped})),{keyPressed:getKeyPressed(l)}),a(f)}));return{handleDocumentPointerdown:function handleDocumentPointerdown(e){const t=createCoreEvent(isRightButton(e)?_.UserEvents.PointerdownRight:_.UserEvents.PointerdownLeft);return t.data={square:null},a(t)},handlePointerdown:function handlePointerdown(f){f.stopPropagation(),document.addEventListener(Ar,l),document.addEventListener(Mr,handlePointerup);const p=createCoreEvent(isRightButton(f)?_.UserEvents.PointerdownRight:_.UserEvents.PointerdownLeft);return p.data=__spreadProps(__spreadValues({},t({el:e,event:f,flipped:n.flipped})),{keyPressed:getKeyPressed(f)}),onNextTick((function addMouseDownListener(){document.addEventListener(Tr.Mousedown,handleMousedown,{once:!0})})),a(p)},handlePointermove:l,handlePointerup:handlePointerup};function handleMousedown(l){const f=createCoreEvent(isRightButton(l)?_.UserEvents.MousedownRight:_.UserEvents.MousedownLeft);return f.data=__spreadProps(__spreadValues({},t({el:e,event:l,flipped:n.flipped})),{keyPressed:getKeyPressed(l)}),a(f)}function handlePointerup(f){document.removeEventListener(Tr.Mousedown,handleMousedown),document.removeEventListener(Ar,l),document.removeEventListener(Mr,handlePointerup);const p=createCoreEvent(_.UserEvents.Pointerup);return p.data=__spreadProps(__spreadValues({},t({el:e,event:f,flipped:n.flipped})),{keyPressed:getKeyPressed(f)}),a(p)}}function generateRandomId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789";return[0,0,0,0,0,0,0,0,0,0].reduce((t=>t+e.charAt(Math.floor(Math.random()*e.length))),"")}function getDefaultOptions(){return{allowMarkings:!0,analysisHighlightColors:{alt:ht.HighlightColors.Blue,ctrl:ht.HighlightColors.Orange,default:ht.HighlightColors.Red,shift:ht.HighlightColors.Green},analysisHighlightOpacity:.8,animationType:ht.Animation.Types.Default,arrowColors:{alt:ht.HighlightedArrowColors.Blue,ctrl:ht.HighlightedArrowColors.Red,default:ht.HighlightedArrowColors.Orange,shift:ht.HighlightedArrowColors.Green},aspectRatio:1,autoClaimDraw:!0,autoPromote:!1,autoResize:!0,boardStyle:"green",captureKeyStrokes:!0,checkBlinkingSquareColor:"#ff0000",coordinates:ht.CoordinatesPositions.Inside,darkMode:!1,diagramStyle:!0,enabled:!0,fadeSetup:0,flipped:!1,highlightColor:void 0,highlightLegalMoves:!0,highlightMoves:!0,highlightOpacity:.5,hoverSquareOutline:!0,id:generateRandomId(),moveListContextMenuEnabled:!0,moveListDisplayType:ht.MoveListDisplayTypes.Text,moveMethod:ht.MoveMethods.Drag,overlayInAnalysisMode:!1,pieceStyle:"neo",playSounds:!0,premoveDelay:200,premoveHighlightColor:"#f42a32",premoveHighlightOpacity:.5,rounded:!0,soundTheme:"default",threatSquareColor:"#ff0000",threatSquareOpacity:.8,useSharedStyleTag:!1}}var Xi,Yi,Ji,ea,ta,na;function buildErrorMsg(e){return(Array.isArray(e)?e:[e]).map((e=>{var t;return`${e.name} (requires: ${null==(t=e.requires)?void 0:t.join(", ")})`})).join(", ")}function getMapOfLoadablePlugins(e,t=new Map){return getLoadablePlugins(e,t,new Map)}function getLoadablePlugins(e,t,n){if(0===e.size)return n;const a=e.size,l=new Map([...t.entries(),...n.entries()]);return e.forEach((t=>{(function requiredPluginsExist(e,t=new Map){return!e||e.every((e=>t.has(e)))})(t.requires,l)&&(n.set(t.name,t),e.delete(t.name))})),a===e.size?(n.clear(),n):getLoadablePlugins(e,t,n)}function createChessboardPluginsAPI(e=[],t){const n=createPluginsAPI();return n.addMany(e),{add:add,addMany:add,get:n.getAll,has:n.has,remove:remove,setCreatePluginContext:n.setContext};function add(e){(function getPluginsOrderedByRequires(e,t){if(0===e.length)return[];const n=getMapOfLoadablePlugins(new Map(e.map((e=>[e.name,e]))),new Map(t.map((e=>[e.name,e]))));if(0===n.size){const t=buildErrorMsg(e);throw new Error(`Required plugins do not exist: ${t}`)}return[...n.values()]})(Array.isArray(e)?e:[e],n.getAll()).forEach((a=>{n.has(a.name)&&n.remove(a.name),function loadPlugin(e){const t=n.getContext();if(!t)return;const{api:a,apiOverrides:l,modeOverrides:f,name:p}=e;a&&(e.destroyAPIMethods=t.api.extendAPI(p,{[p]:a})),l&&(e.destroyAPIOverrides=t.api.extendAPI(p,l)),f&&(e.destroyModeOverrides=t.mode.extendMode(f))}(a);if(!n.add(a)){const{name:l}=a;null==t||t.log({code:Xi.LogCodes.CreateFailure,data:{currentPlugins:n.getAll().map((e=>e.name)),data:buildErrorMsg(e),plugin:l},level:Ut.Levels.Error,message:`Could not create ${l} plugin`}),remove(a.name)}}))}function remove(e){var t,a,l;if(!n.has(e))return;const f=n.getOne(e);n.remove(e),null==(t=null==f?void 0:f.destroyAPIMethods)||t.call(f),null==(a=null==f?void 0:f.destroyAPIOverrides)||a.call(f),null==(l=null==f?void 0:f.destroyModeOverrides)||l.call(f)}}function getRendererType(e){const{Arcade:t,Natural:n}=ht.Animation.Types;return e.pieceStyle===Yi.PieceStyles.Trigger?Mt.Types.WebGL3D:[t,n].includes(e.animationType)?Mt.Types.WebGL2D:Mt.Types.Default}function getRenderer(e){return function fetchRenderer(e){return e===Mt.Types.WebGL3D?Promise.all([n.e(934),n.e(588)]).then(n.bind(n,6588)):e===Mt.Types.WebGL2D?Promise.all([n.e(934),n.e(647)]).then(n.bind(n,5647)):n.e(283).then(n.bind(n,2283))}(getRendererType(e))}async function getMode(e){return function __variableDynamicImportRuntime0__(e){switch(e){case"../analysis/index.ts":return Promise.resolve().then((function(){return hi}));case"../capture-the-star/index.ts":return Promise.resolve().then((function(){return Si}));case"../exploring/index.ts":return Promise.resolve().then((function(){return Ei}));case"../guess-the-move/index.ts":return Promise.resolve().then((function(){return Mi}));case"../observing/index.ts":return Promise.resolve().then((function(){return Ii}));case"../passive-observing/index.ts":return Promise.resolve().then((function(){return ji}));case"../playing/index.ts":return Promise.resolve().then((function(){return Ni}));case"../setup/index.ts":return Promise.resolve().then((function(){return Hi}));default:return new Promise((function(t,n){("function"==typeof queueMicrotask?queueMicrotask:setTimeout)(n.bind(null,new Error("Unknown variable dynamic import: "+e)))}))}}(`../${e.toLowerCase()}/index.ts`)}function createGame({api:e,apiOptions:t,el:n,emitter:a,init:l,logger:f,mode:p,options:h=getDefaultOptions(),plugins:m=createStandardPlugins(),renderer:g}){const v=e||createAPI({eventEmitter:a,logger:f,options:t||{}}),y=__spreadValues(__spreadValues({},getDefaultOptions()),h);n.id=`board-${y.id}`;const b=createChessboardPluginsAPI(),C=function createSetRenderer(){const e=createQueue();return async function set2(t){e.add(handler2,t)};async function handler2(e){destroyRenderer(),S=null!=e?e:(await getRenderer(y)).createRenderer({el:n,options:y}),w.setRenderer(S),Object.assign(T,{animationComplete:S.animationComplete,getPointerPosition:S.getPointerPosition,isAnimating:S.isAnimating}),k=createUserEventHandlers$1({el:n,getPointerPosition:S.getPointerPosition,options:y,run:runCoreEvent}),n.addEventListener(Er,k.handlePointerdown),document.addEventListener(Er,k.handleDocumentPointerdown),S.onAll(v.logger.log),v.emit(_.InstanceEvents.RendererSet,createCoreEvent(_.InstanceEvents.RendererSet,S.name))}}();let S,k;const w=createCore({params:{api:v,el:n,options:y},plugins:b});b.setCreatePluginContext(w.getContext());const T=Object.assign(v,{destroy:function destroy(){destroyRenderer(),v.offAll(runCoreEvent);const e=createCoreEvent(_.InstanceEvents.Destroy);runCoreEvent(e),v.emit(_.InstanceEvents.Destroy,e)},getMode:w.getMode,getOptions:function getOptions(){return __spreadValues({},y)},getRenderer:()=>S,playSound:function playSound2(e){runCoreEvent(createCoreEvent(_.SoundEvents.Play,{sound:e}))},plugins:b,resize:function resize(e,t){runCoreEvent(createCoreEvent(_.UIEvents.Resize,{height:t,width:e}))},run:runCoreEvent,setMode:setMode,setOptions:function setOptions(e){if(Object.assign(y||{},e),e&&Object.keys(e).some((e=>Mt.TriggerOptions.includes(e)))&&S&&getRendererType(y)!==S.name)return void C();v.emit(_.OptionsEvents.Update,createCoreEvent(_.OptionsEvents.Update,e))},setRenderer:C}),P=setMode(p);return"name"in P?finishInit():P.then(finishInit),T;function finishInit(){b.add(m),runCoreEvent(createCoreEvent(_.InstanceEvents.Create)),n.addEventListener("contextmenu",(e=>(e.stopPropagation(),e.preventDefault(),!1))),v.onAll(runCoreEvent),v.emit(_.InstanceEvents.Create,createCoreEvent(_.InstanceEvents.Create,w.getMode().name)),C(g).then((()=>{l&&v.load(l)}))}function destroyRenderer(){w.setRenderer(),null==S||S.offAll(v.logger.log),null==S||S.destroy(),S=void 0,n.removeEventListener(Er,null==k?void 0:k.handlePointerdown),document.removeEventListener(Er,null==k?void 0:k.handleDocumentPointerdown),document.removeEventListener(Ar,null==k?void 0:k.handlePointermove),document.removeEventListener(Mr,null==k?void 0:k.handlePointerup)}function runCoreEvent(e){return w.run(e),e}function setMode(e){return"modeType"in e?getMode(e.modeType).then((t=>setModeWithBuilder(t.create(e.options)))):setModeWithBuilder(e)}function setModeWithBuilder(e){var t,n;const a=w&&w.getMode();a&&(null==(t=a.plugins)||t.forEach((e=>b.remove(e.name))),b.get().forEach((e=>{var t;return null==(t=e.destroyModeOverrides)?void 0:t.call(e)})),null==(n=a.destroy)||n.call(a));const l=e(v);return v.usePlayingAs(l.usePlayingAs),l.plugins&&b.add(l.plugins),b.get().forEach((e=>e.modeOverrides&&l.extendMode(e.modeOverrides))),w&&(w.setMode(l),runCoreEvent(createCoreEvent(_.InstanceEvents.ModeChanged)),v.emit(_.InstanceEvents.ModeChanged,createCoreEvent(_.InstanceEvents.ModeChanged,w.getMode().name))),l}}function toPiecesObjWithCount(e,t){const n=t.toLowerCase(),a=`${t===n?"b":"w"}${n}`;return e[a]||(e[a]=0),e[a]+=1,e}function cloneAndInsertElement(e){const t=e.cloneNode();return e.insertAdjacentElement("afterend",t),t}function getRootPieceElement(e){return e.classList.contains(Ji.Classes.Piece)?e:e.parentElement?getRootPieceElement(e.parentElement):void 0}!function(e){!function(e){e.CreateFailure="CreateFailure"}(e.LogCodes||(e.LogCodes={}))}(Xi||(Xi={})),function(e){var t,n,a,l,f,p,h;(t=e.PieceStyles||(e.PieceStyles={})).Default="staunton_executive",t.Trigger="real3d",(e.CacheKeys||(e.CacheKeys={})).CameraSettings="cameraSettings",(n=e.CssClasses||(e.CssClasses={})).Board="board-webgl-3d",n.PieceDrag="piece-dragging",n.PieceHover="piece-hover",n.PromotionWindow="promotion-window-3d",n.StatisticsPanel="statistics-panel",(a=e.ObjectsRenderOrder||(e.ObjectsRenderOrder={}))[a.AnalysisOverlay=1]="AnalysisOverlay",a[a.NotationPlane=2]="NotationPlane",a[a.OverSquare=3]="OverSquare",a[a.HighligtedSquare=4]="HighligtedSquare",a[a.Hint=5]="Hint",a[a.CustomItem=6]="CustomItem",a[a.PieceShadow=7]="PieceShadow",a[a.Arrow=8]="Arrow",a[a.Effect=9]="Effect",a[a.Highest=10]="Highest",function(e){e[e.PositionY=.005]="PositionY"}(e.Arrow||(e.Arrow={})),(l=e.CustomItem||(e.CustomItem={}))[l.PositionY=.005]="PositionY",(f=e.Effect||(e.Effect={}))[f.PositionY=.005]="PositionY",(p=e.Square||(e.Square={}))[p.Size=10]="Size",p[p.HalfSize=5]="HalfSize",p[p.BorderSize=.5]="BorderSize",p[p.OverBorderSize=.5]="OverBorderSize",p[p.VisibleY=.005]="VisibleY",p[p.InvisibleY=-.2]="InvisibleY",p[p.InsideTolerance=.01]="InsideTolerance",function(e){e[e.MarginSize=4]="MarginSize",e[e.Size=88]="Size"}(e.Board||(e.Board={})),(h=e.Camera||(e.Camera={}))[h.Distance=140]="Distance",h[h.DistanceMin=50]="DistanceMin",h[h.DistanceMax=500]="DistanceMax",h[h.PanAngle=0]="PanAngle",h[h.TiltAngle=100]="TiltAngle",h[h.HorizontalPanning=0]="HorizontalPanning",h[h.VerticalPanning=-12]="VerticalPanning",h[h.ZoomIncrement=5]="ZoomIncrement"}(Yi||(Yi={})),function(e){e.BodyDragging="hand-pieces-dragging-body",e.Component="hand-pieces",e.Dragging="dragging",e.Flipped="flipped",e.Horizontal="horizontal",e.Piece="hand-piece",e.Pseudo3d="pseudo3d",e.Vertical="vertical",e.WithKing="with-king"}((ea=Ji||(Ji={})).Classes||(ea.Classes={})),(ta=ea.DataAttributes||(ea.DataAttributes={})).Dragging="data-hand-piece-dragging",ta.Selected="data-hand-piece-selected",(na=ea.DisplayDirections||(ea.DisplayDirections={})).Horizontal="horizontal",na.Vertical="vertical";var ra,oa;function get_each_context(e,t,n){const a=e.slice();return a[15]=t[n],a}function create_if_block(e){let t,n,a=e[1][e[15]]+"";return{c(){t=element("span"),n=text(a),attr(t,"class","hand-piece-count svelte-77hwby")},m(e,a){insert(e,t,a),append(t,n)},p(e,t){2&t&&a!==(a=e[1][e[15]]+"")&&set_data(n,a)},d(e){e&&detach(t)}}}function create_each_block(e,t){let n,a,l,f,p,h,m=t[1][t[15]]>1&&create_if_block(t);function pointerdown_handler(...e){return t[10](t[15],...e)}return{key:e,first:null,c(){n=element("div"),m&&m.c(),a=space(),attr(n,"class",l="hand-piece "+t[15]+" "+(0===t[1][t[15]]?"hidden":"")+" svelte-77hwby"),attr(n,"data-hand-piece",f=t[15]),this.first=n},m(e,t){insert(e,n,t),m&&m.m(n,null),append(n,a),p||(h=listen(n,"pointerdown",pointerdown_handler),p=!0)},p(e,p){(t=e)[1][t[15]]>1?m?m.p(t,p):(m=create_if_block(t),m.c(),m.m(n,a)):m&&(m.d(1),m=null),2&p&&l!==(l="hand-piece "+t[15]+" "+(0===t[1][t[15]]?"hidden":"")+" svelte-77hwby")&&attr(n,"class",l),2&p&&f!==(f=t[15])&&attr(n,"data-hand-piece",f)},d(e){e&&detach(n),m&&m.d(),p=!1,h()}}}function create_fragment(e){let t,n,a=[],l=new Map,f=Object.keys(e[1]);const get_key=e=>e[15];for(let p=0;p<f.length;p+=1){let t=get_each_context(e,f,p),n=get_key(t);l.set(n,a[p]=create_each_block(n,t))}return{c(){t=element("div");for(let e=0;e<a.length;e+=1)a[e].c();attr(t,"class",n=null_to_empty(e[2])+" svelte-77hwby")},m(n,l){insert(n,t,l);for(let e=0;e<a.length;e+=1)a[e].m(t,null);e[11](t)},p(e,[p]){10&p&&(f=Object.keys(e[1]),a=function update_keyed_each(e,t,n,a,l,f,p,h,m,g,v,y){let _=e.length,b=f.length,C=_;const S={};for(;C--;)S[e[C].key]=C;const k=[],w=new Map,T=new Map;for(C=b;C--;){const e=y(l,f,C),h=n(e);let m=p.get(h);m?a&&m.p(e,t):(m=g(h,e),m.c()),w.set(h,k[C]=m),h in S&&T.set(h,Math.abs(C-S[h]))}const P=new Set,A=new Set;function insert2(e){transition_in(e,1),e.m(h,v),p.set(e.key,e),v=e.first,b--}for(;_&&b;){const t=k[b-1],n=e[_-1],a=t.key,l=n.key;t===n?(v=t.first,_--,b--):w.has(l)?!p.has(a)||P.has(a)?insert2(t):A.has(l)?_--:T.get(a)>T.get(l)?(A.add(a),insert2(t)):(P.add(l),_--):(m(n,p),_--)}for(;_--;){const t=e[_];w.has(t.key)||m(t,p)}for(;b;)insert2(k[b-1]);return k}(a,p,get_key,1,e,f,l,t,destroy_block,create_each_block,null,get_each_context)),4&p&&n!==(n=null_to_empty(e[2])+" svelte-77hwby")&&attr(t,"class",n)},i:noop,o:noop,d(n){n&&detach(t);for(let e=0;e<a.length;e+=1)a[e].d();e[11](null)}}}function instance(e,t,n){let a,l,f,p=[],h=[],m=function getFullHand(){const e=Object.values(rr.Piece.Types);return[...e,...e.map((e=>e.toUpperCase()))]}(),{flipped:g=!1}=t,{isPseudo3d:v=!1}=t,{fillHandWithAllPieces:y=!1}=t,{context:_}=t,{direction:b=Ji.Classes.Vertical}=t;function pointerDownHandler({piece:e,event:t}){const[a,p]=e;if(!_.api.pieceIsInteractable(a)||isRightButton(t))return;const m=getRootPieceElement(t.target);if(!m)return;h[e]>0&&n(1,h[e]-=1,h);const g={color:a,component:l,type:p,cloneOf:m};f=e,_.eventHandlers.pointerDownLeft({el:cloneAndInsertElement(m),event:t,piece:g})}return e.$$set=e=>{"flipped"in e&&n(4,g=e.flipped),"isPseudo3d"in e&&n(5,v=e.isPseudo3d),"fillHandWithAllPieces"in e&&n(6,y=e.fillHandWithAllPieces),"context"in e&&n(7,_=e.context),"direction"in e&&n(8,b=e.direction)},e.$$.update=()=>{368&e.$$.dirty&&n(2,a=`${Ji.Classes.Component} ${g?Ji.Classes.Flipped:""} ${b===Ji.DisplayDirections.Horizontal?Ji.Classes.Horizontal:Ji.Classes.Vertical} ${y?Ji.Classes.WithKing:""} ${v?Ji.Classes.Pseudo3d:""}`)},[l,h,a,pointerDownHandler,g,v,y,_,b,function setHand(e,t=!1){t&&(f=void 0),p=e.split(""),n(1,h=(y?m:p).reduce(toPiecesObjWithCount,{})),f&&h[f]>0&&n(1,h[f]-=1,h)},(e,t)=>pointerDownHandler({event:t,piece:e}),function div_binding(e){Mo[e?"unshift":"push"]((()=>{l=e,n(0,l)}))}]}class Hand_pieces extends SvelteComponent{constructor(e){super(),init(this,e,instance,create_fragment,safe_not_equal,{flipped:4,isPseudo3d:5,fillHandWithAllPieces:6,context:7,direction:8,setHand:9})}get setHand(){return this.$$.ctx[9]}}function getColorAsNumber(e){return e===rr.ColorsAsLetters.Black||e===rr.ColorsAsWords.Black?rr.ColorsAsNumbers.Black:rr.ColorsAsNumbers.White}function toggleDraggingPiece({el:e,game:t,isDragging:n=!1,piece:a}){var l;if(!e||!a)return;const{component:f,type:p}=a,{test:h}=t.getOptions();n?(h&&p&&e.setAttribute(Ji.DataAttributes.Dragging,p),e.classList.add(Ji.Classes.Dragging),document.body.classList.add(Ji.Classes.BodyDragging),document.body.append(e)):(h&&e.removeAttribute(Ji.DataAttributes.Dragging),e.classList.remove(Ji.Classes.Dragging),document.body.classList.remove(Ji.Classes.BodyDragging),f.append(e),null==(l=e.parentNode)||l.removeChild(e))}function dropPiece({boardEl:e,coords:t,el:n,game:a,piece:l}){const{square:f}=a.getPointerPosition({el:e,event:{clientX:t.x,clientY:t.y},flipped:a.getOptions().flipped});return f&&l&&function dropPieceOnBoard({game:e,piece:t,square:n}){e.getMode().isAllowedToMove()&&e.move({color:getColorAsNumber(t.color),drop:t.type,to:n,userGenerated:!0})}({game:a,piece:l,square:f}),toggleDraggingPiece({el:n,game:a,isDragging:!1,piece:l}),f}function toggleSelectedPiece({el:e,game:t,isSelected:n=!1,piece:a}){var l,f;if(!e)return;const p=(null==(l=getTheme(t.getOptions().boardStyle))?void 0:l.highlightColor)||ht.HighlightColors.Selected,h=null!=(f=null==a?void 0:a.cloneOf)?f:e;n?h.setAttribute(Ji.DataAttributes.Selected,p):h.removeAttribute(Ji.DataAttributes.Selected),h.style.backgroundColor=n?p:""}function resetPieceToHand({api:e,el:t,game:n,piece:a}){toggleSelectedPiece({el:t,game:n,isSelected:!1,piece:a}),toggleDraggingPiece({el:t,game:n,isDragging:!1,piece:a}),(null==a?void 0:a.cloneOf)?(t.remove(),e.setHand(e.getHand(),!0)):function clearInlineStyles(e){e.style.height="",e.style.width="",e.style.left="",e.style.top="",e.style.transform=""}(t)}function setInitialPiecePosition({el:e,initialCoords:t}){const{height:n,width:a,x:l,y:f}=t;e.style.height=`${n}px`,e.style.width=`${a}px`,e.style.left=l-a/2+"px",e.style.top=f-n/2+"px"}function pieceSelected({api:e,boardEl:t,eventHandlers:n,game:a}){return{[_.UserEvents.MousedownRight]:function mouseDownRight({el:e,piece:t}){return resetToIdle({el:e,piece:t})},[_.UserEvents.PointerdownLeft]:function PointerDownLeft({el:l,coords:f,initialCoords:p,piece:h,targetEl:m}){if(!n)return ra.Idle;const{canDropPiecesContinuously:g}=a.getMode().getOptions(),v=null==l?void 0:l.parentNode,y=null==v?void 0:v.querySelector(`[${Ji.DataAttributes.Selected}]`);if(function unselectAllPieces({handPiecesElement:e}){if(!e)return;e.querySelectorAll(".hand-piece").forEach((e=>{e.style.backgroundColor="",e.removeAttribute(Ji.DataAttributes.Selected)}))}({handPiecesElement:v}),g&&(null==m?void 0:m.classList.contains(Ji.Classes.Piece))){const t=`${null==h?void 0:h.color}${null==h?void 0:h.type}`;return t&&(null==y?void 0:y.classList.contains(t))?resetToIdle({el:l,piece:h}):(resetPieceToHand({api:e,el:l,game:a,piece:h}),toggleSelectedPiece({el:l,game:a,isSelected:!0,piece:h}),ra.PieceSelected)}const _=dropPiece({boardEl:t,coords:f,el:l,game:a,piece:h});return _&&g?(toggleSelectedPiece({el:l,game:a,isSelected:!0,piece:h}),ra.PieceSelected):!_&&m&&h&&h.cloneOf&&m.isEqualNode(h.cloneOf)?(setInitialPiecePosition({el:l,initialCoords:p}),toggleDraggingPiece({el:l,game:a,isDragging:!0,piece:h}),ra.DraggingPiece):resetToIdle({el:l,piece:h})},[oa.ResetToIdle]:({el:e,piece:t})=>resetToIdle({el:e,piece:t})};function resetToIdle({el:l,piece:f}){return document.removeEventListener(Er,n.documentPointerDown),t.removeEventListener(Er,n.documentPointerDown),resetPieceToHand({api:e,el:l,game:a,piece:f}),ra.Idle}}function draggingPiece({api:e,boardEl:t,game:n,eventHandlers:a}){return{[_.UserEvents.MousedownRight]:function mouseDownRight({el:e,piece:t}){return resetToIdle({el:e,piece:t})},[_.UserEvents.Pointermove]:function pointerMove({coords:e,el:t,initialCoords:n}){return t?(t.style.transform=function translateCoordinates({coords:e,initialCoords:t}){return`translate(${e.x-t.x}px, ${e.y-t.y}px)`}({coords:e,initialCoords:n}),ra.DraggingPiece):ra.Idle},[_.UserEvents.Pointerup]:function pointerUp({coords:l,el:f,initialCoords:p,piece:h}){if(function droppedInsideInitialCoords({coords:e,initialCoords:t}){const{x:n,y:a}=e;if(0===n&&0===a)return!0;const{height:l,width:f,x:p,y:h}=t,m=f/2,g=l/2;return n>=p-m&&n<=p+m&&a<=h+g&&a>=h-g}({coords:l,initialCoords:p})){if(resetPieceToHand({api:e,el:f,game:n,piece:h}),!a)return ra.Idle;document.addEventListener(Er,a.documentPointerDown),document.addEventListener(Tr.Mousedown,a.mouseDown),t.addEventListener(Er,a.documentPointerDown);const l=Boolean(f.hasAttribute(Ji.DataAttributes.Selected));return toggleSelectedPiece({el:f,game:n,isSelected:!l,piece:h}),l?resetToIdle({el:f,piece:h}):ra.PieceSelected}return h&&e.pieceIsInteractable(h.color)&&dropPiece({boardEl:t,coords:l,el:f,game:n,piece:h}),resetToIdle({el:f,piece:h})},[oa.ResetToIdle]:({el:e,piece:t})=>resetToIdle({el:e,piece:t})};function resetToIdle({el:l,piece:f}){return document.removeEventListener(Er,a.documentPointerDown),document.removeEventListener(Tr.Mousedown,a.mouseDown),t.removeEventListener(Er,a.documentPointerDown),document.removeEventListener(Tr.PointerMove,a.pointerMove),resetPieceToHand({api:e,el:l,game:n,piece:f}),ra.Idle}}function idle({game:e}){return{[_.UserEvents.PointerdownLeft]:function PointerDownLeft({el:t,piece:n,initialCoords:a}){return setInitialPiecePosition({el:t,initialCoords:a}),toggleDraggingPiece({el:t,game:e,isDragging:!0,piece:n}),ra.DraggingPiece}}}function createHandPiecesStateMachine(e){return createStateMachine(function getStateMachine(e){return{initialState:ra.Idle,states:{[ra.PieceSelected]:pieceSelected(e),[ra.DraggingPiece]:draggingPiece(e),[ra.Idle]:idle(e)}}}(e))}function createResetToIdle(e){return function resetToIdle(){e.stateMachine.transition(oa.ResetToIdle,e.transitionParams)}}function getPieceBaseURL(e,t=150){return`https://images.chesscomfiles.com/chess-themes/pieces/${e}/${t}`}function createGetHand(e){const{game:t}=e.game.getContext();return function getHand(){var e;return(null==(e=null==t?void 0:t.hand)?void 0:e.call(t))||""}}function createDestroy(...e){return function destroy(){return e.forEach((e=>null==e?void 0:e()))}}function createPieceIsInteractable({game:e}){return function pieceIsInteractable(t){return void 0===e.getPlayingAs()||Boolean(e.getPlayingAs()===getColorAsNumber(t))}}function createHandPieces({boardEl:e,containerEl:t,direction:n,fillHandWithAllPieces:a=!1,flipped:l,game:f,pieceStyles:p=fr,replaceContainer:h}){const m={api:{},boardEl:e,eventHandlers:{},game:f,stateMachine:{},transitionParams:{coords:{x:0,y:0},el:document.createElement("div"),initialCoords:{height:0,width:0,x:0,y:0},piece:null}},g=function createHandPiecesComponent({options:e,target:t,replaceContainer:n=!0}){return createSvelteComponent({ComponentType:Hand_pieces,methods:["setHand"],options:__spreadProps(__spreadValues({},e),{target:t}),replaceContainer:n})}({options:{props:{context:m,direction:n,fillHandWithAllPieces:a,flipped:l}},replaceContainer:h,target:t}),{removePieceStyleElement:v,updatePieceStyle:y}=function createUpdatePieceStyle({component:e,pieceStyles:t}){const n=document.createElement("style");return document.head.append(n),{getPieceStyles:getPieceStyles,removePieceStyleElement:function removePieceStyleElement(){n.remove()},updatePieceStyle:function updatePieceStyle(a){n.innerHTML=getPieceStyles(a);const{isPseudo3d:l}=t[a];e.set({isPseudo3d:l})}};function getPieceStyles(e){const{path:n,format:a,isPseudo3d:l}=t[e],f=getPieceBaseURL(n),p=l?"::after":"";return ur.reduce(((e,t)=>`${e} .hand-piece.${t}${p} { background-image: url('${f}/${t}.${a}'); }`),"")}}({component:g,pieceStyles:p});return m.api=function createAPI2(){return{destroy:createDestroy(g.destroy,v),getHand:createGetHand(m),pieceIsInteractable:createPieceIsInteractable(m),resetToIdle:createResetToIdle(m),setDirection:e=>g.set({direction:e}),setFlipped:e=>g.set({flipped:e}),setHand:g.instance.setHand,setFillHandWithAllPieces:e=>g.set({fillHandWithAllPieces:e}),updatePieceStyle:y}}(),m.eventHandlers=function createUserEventHandlers(e){const t={documentPointerDown:function documentPointerDown(t){isRightButton(t)||(e.transitionParams.coords={x:t.clientX,y:t.clientY},e.transitionParams.targetEl=t.target,e.stateMachine.transition(_.UserEvents.PointerdownLeft,e.transitionParams))},mouseDown:mouseDown,pointerDownLeft:function pointerDownLeft({el:n,piece:a,event:l}){if(isRightButton(l))return;const{width:f,height:p}=n.getBoundingClientRect();e.transitionParams.el=n,e.transitionParams.piece=a,e.transitionParams.initialCoords={height:p,width:f,x:l.clientX,y:l.clientY},e.transitionParams.targetEl=l.target,document.addEventListener(Tr.PointerMove,t.pointerMove),document.addEventListener(Tr.PointerUp,t.pointerUp),onNextTick((()=>{document.addEventListener(Tr.Mousedown,mouseDown)})),e.stateMachine.transition(_.UserEvents.PointerdownLeft,e.transitionParams)},pointerMove:function pointerMove({clientX:t,clientY:n}){e.transitionParams.coords={x:t,y:n},e.stateMachine.transition(_.UserEvents.Pointermove,e.transitionParams)},pointerUp:function pointerUp({clientX:n,clientY:a}){document.removeEventListener(Tr.PointerUp,t.pointerUp),document.removeEventListener(Tr.PointerMove,t.pointerMove),document.removeEventListener(Tr.Mousedown,t.mouseDown),e.transitionParams.coords={x:n,y:a},e.stateMachine.transition(_.UserEvents.Pointerup,e.transitionParams)}};return t;function mouseDown(n){isRightButton(n)&&(document.oncontextmenu=()=>!1,onNextTick((()=>{document.oncontextmenu=()=>!0})),e.transitionParams.targetEl=n.target,document.removeEventListener(Tr.Mousedown,t.mouseDown),document.removeEventListener(Tr.PointerMove,t.pointerMove),e.stateMachine.transition(_.UserEvents.MousedownRight,e.transitionParams))}}(m),m.stateMachine=createHandPiecesStateMachine(m),m.api}function createHandPiecesPlugin({direction:e,el:t,pieceStyles:n,replaceContainer:a}={}){let l;return{create:function create2(f){const{api:p,el:h,mode:m}=f,g=isSetupMode(m.name);l=createHandPieces({boardEl:h,containerEl:t||h,direction:e,fillHandWithAllPieces:g,game:p,pieceStyles:n,replaceContainer:a}),loadHand(f)},destroy:function destroy(){l.destroy()},match:[{condition:isOneOf([_.APIEvents.Load,_.OptionsEvents.Update]),handler:function onLoadOrOptionChanged(e,t){e.type===_.APIEvents.Load&&l.resetToIdle();loadHand(t)}},{condition:isOneOf([...jn,Oe.Events.SetHand]),handler:function onPositionChanged(){l.setHand(l.getHand())}},{condition:is(_.InstanceEvents.ModeChanged),handler:function onModeChanged(e){setModeOptions(e.data)}}],name:Oe.Plugin.Name};function loadHand(e){const{flipped:t,pieceStyle:n}=e.options,{name:a}=e.mode;l.setFlipped(t),l.updatePieceStyle(n),l.setHand(l.getHand()),setModeOptions(a)}function setModeOptions(e){const t=isSetupMode(e);l.setFillHandWithAllPieces(t)}function isSetupMode(e){return e===li.Types.Setup}}!function(e){e.DraggingPiece="DraggingPiece",e.Idle="Idle",e.PieceSelected="PieceSelected"}(ra||(ra={})),(oa||(oa={})).ResetToIdle="ResetToIdle";j.Plugin.Name,ze.Plugin.Name;function getBoardURL(e,t=150){return`https://images.chesscomfiles.com/chess-themes/boards/${e}/${t}.png`}function getColorAsLetter(e){return e===rr.ColorsAsNumbers.Black?rr.ColorsAsLetters.Black:rr.ColorsAsLetters.White}function getPGNForDownload(e){if(!e)return"";const t=e.lastIndexOf('"]')+2;return`${e.slice(0,t).trim()}\n\n${function revertAnnotationType(e){const t=Object.keys(Ho).sort(((e,t)=>t.length-e.length)),n=new Set($o);let a=e;return t.forEach((e=>{var t;const l=`\\${null!=(t=jo[e])?t:e}`,f=n.has(e)?` ${Ho[e]}`:Ho[e];a=a.replace(new RegExp(l,"gm"),f)})),a}(e.slice(t).trim())}`}function getSanFromFileRank(e){return!e||!e.file||!e.rank||e.file>8||e.rank>8||e.file<1||e.rank<1?null:`${String.fromCharCode(96+e.file)}${e.rank.toString()}`}function mergePlugins(e,t){const n=Object.values(e).map((e=>e.name));return t.reduce(((e,t)=>{const a=n.indexOf(t.name);return a>-1?e.splice(a,1,t):e.push(t),e}),e)}},3527:function(e,t,n){n(4155),function(){"use strict";var t=function(){var e=[[2637767806,863464769],[720845184,95069639],[1155203408,610415943],[2618685246,1655139042],[1971536997,1218186377],[848342074,540017087],[263957791,1627660921],[3896152207,4076560586],[226391645,1484086288],[436746274,3467632685],[2516964848,3797861296],[3491888988,3510251221],[1086189917,1248276018],[18044180,1876255637],[1572111136,1190386149],[597658413,2146900428],[97624494,2243205793],[1738507407,1854916977],[1950989311,2149575947],[2098318769,3283594736],[2194108574,2015279052],[4079062812,2500884588],[856979699,2941369318],[1270058469,3877737539],[2858720366,3170717948],[2378012835,1387254795],[2278688587,2178388503],[435406673,3555273441],[3031118064,1655806655],[2063925420,1107589828],[3376753832,436852829],[615148625,1302492416],[1285502018,1963045959],[346460119,1016137793],[2803604355,1176288659],[55085973,2968618255],[1669016372,4287873088],[164740250,1037634196],[896886403,883023163],[1935551383,2764331555],[410153072,4055711755],[533441746,1505690343],[3541084098,3466290517],[3214426080,4267541060],[2675233103,1951705124],[1374411850,3115986997],[1552073989,3684348154],[4244110986,875606593],[844343081,3115990494],[2356462440,135999605],[3116133511,377238503],[2129956651,2197966368],[299173332,3276914047],[1701379241,745972291],[1306570996,254977976],[2530644806,214138461],[1122123979,1667800879],[1831591130,3801192033],[1116211970,920967505],[1594837592,2551651254],[972591349,2046373768],[2479207924,1935030411],[1675376029,2367888248],[3960916618,3935874422],[1398143232,3265801671],[133930885,1520005442],[1351827834,2829577566],[2076951437,2723839804],[435980918,2364847828],[1668970368,3738157273],[2185864314,3993911799],[2041407829,31969768],[346864372,2004703094],[4047877822,3437142421],[3669961416,538399484],[616810829,4190688246],[3144558884,4030272234],[216165387,2513010905],[2761740594,3216997572],[3919406634,4096014649],[669429112,2434161727],[2234904640,3111407601],[1421079802,1598085235],[1924213810,310373675],[4002762044,2067865415],[2592451728,2586110625],[1890340057,4031717877],[4189625662,2577429954],[2276713138,3049850801],[2741429688,3310307512],[2924122950,3426712818],[421576781,1193704381],[2277442246,3030264553],[153237420,595540057],[4278711886,4176286928],[2380848297,4030514510],[2618700582,1303682185],[3018992701,185284845],[957243316,1291916363],[1543415220,1898408169],[504378001,531073412],[2591337657,1692896435],[1333852064,903543556],[1661259930,188168388],[561112646,2197961224],[1536910315,2632972300],[1349168372,2307429186],[411152329,2745631190],[1694697476,1081411140],[3755185459,2631660711],[4019355068,4027326706],[2066937809,3761668332],[3120395808,3878773315],[94890149,2109283191],[3045629038,358812277],[1249184265,3465901047],[3477490924,2308583306],[4114113436,3875911716],[1014604031,1434513279],[3991324799,2222416029],[2040431088,1539915569],[2253613964,4081224332],[2547464012,1611168627],[2722521980,4281500978],[71289574,213969824],[2450408597,903689630],[1894451515,364024012],[1939968537,374938813],[1447259295,3785468557],[4021046128,1664847745],[3139524504,3562928047],[1173487682,4065269608],[2467266804,3907744866],[4284945151,3486998177],[2925674454,1953016432],[3710671816,1271453948],[2129465869,1422863833],[587093076,18243356],[3373793513,2411305257],[2156648078,1791034213],[3737413652,1534461430],[468575139,2935304962],[1129551363,3603256834],[2861996892,1763494778],[2826449619,2465197654],[1704209531,1014895022],[3738359347,3402630390],[569410928,4095796581],[3021312909,2108247612],[2444777957,2664129360],[282063667,3773661258],[682545472,3188439005],[3318488457,1917822038],[1447622272,4045023041],[757420137,4038580915],[2613420942,4146703316],[4012836163,150381244],[2938127093,3428591704],[1208226490,3086335530],[2935205706,1446903363],[430957978,3830532479],[1381578755,3757172800],[4109399782,1596778224],[288855589,1954372339],[3169178148,2256716053],[2644780093,3895892303],[107966643,1071681559],[1304747544,2607225372],[1359190711,1898207171],[3229237120,3273634996],[3027167685,3863637628],[3011615298,2883984519],[564135827,978463264],[770797430,362326607],[1983662611,1907583229],[4153656423,48268960],[3609759233,720080177],[3727911466,1270989899],[200708787,2366086947],[744508026,393422515],[1213261630,65757284],[3485747185,3845951003],[2958861301,1680248217],[2598470344,3163845864],[2767997908,4233451722],[3881113485,1492930166],[1773764017,2764062206],[4189435844,2898689174],[4234838742,1267095035],[2624081078,3302114327],[2395569449,390426320],[1728307101,690284926],[3309827454,1118258254],[2028172868,3888829086],[4271523049,909051386],[146617804,942892565],[2467685867,974297806],[2483428231,503635829],[3743260573,2018222096],[1002067894,2289153437],[3535252974,3738302271],[4154611160,1002664952],[3623154244,2349656961],[3646679180,3524329383],[862933752,4282853607],[2806008282,3272780913],[2734037942,3828874677],[1328176304,2137666995],[2278785213,2780788825],[381286368,1816476193],[2074232908,2316293454],[4087773386,3651330956],[967884669,3728964514],[4239349185,3213509668],[419231360,1463788948],[1275421624,2672384707],[1088456595,436245261],[2365565249,783696577],[1758083333,845223583],[2048846183,3530914274],[2635948261,124738415],[940630937,3069598626],[839474029,1253439921],[902477345,165479306],[2836079689,2681188273],[2007115168,2093139645],[1363041891,1282466609],[1130479818,1063857938],[3644959908,1260430427],[1385135238,46497915],[1386975934,3110156681],[2635987502,4233461619],[1915744629,4117939016],[487743653,285736599],[2049219159,3960249250],[69242857,3908563670],[1511066720,1488527520],[215590039,1703564952],[1459430344,4184955468],[676103291,2642967214],[83799035,3182827979],[1949179493,476101251],[2593534694,1493478716],[2283504289,995211746],[1349412676,3449243940],[2954378677,1878813305],[249149717,3329151870],[1578231917,1483986052],[4135085182,890874990],[461755528,3505523909],[3669622373,634949665],[219487622,2914465301],[2825233742,3703631897],[2479105382,2935590907],[2582097898,3187672881],[1221328648,1843341402],[2140891889,3958868911],[1482849818,345750049],[751922730,3178831411],[3546542069,4036458902],[216179596,877293293],[444615341,3117393729],[2424254530,494454238],[1344234989,3003337991],[929188581,2760877801],[2507911009,1879899982],[980166547,1311840394],[3566535507,1790747461],[143525013,2311336672],[4181962471,4273938872],[1815842366,862009811],[911175674,1179575598],[3591335374,3694215714],[1452686093,3393294272],[385158879,2447709103],[4011414929,1264623507],[1448477120,911094312],[3971299641,2289992053],[3133647265,2234591563],[3007628400,964409938],[1708345684,3673411261],[3031964479,2843021794],[3022128657,2480338599],[118850112,473449293],[2048127371,3202109429],[3158349745,382018770],[1505327237,3807570472],[2568424029,3272693060],[1866609495,3888556537],[844703982,1852802964],[3504617058,682636099],[1448882679,3733580327],[821387540,2215744532],[3631471417,311618895],[2077838877,2383929020],[3352949096,1688694420],[2491080787,3998672444],[3368630402,4182204255],[983299419,2837414346],[3651215291,1033373924],[265429091,3988955082],[3019003608,2896212153],[2955948456,3025235588],[903690197,2266253487],[3925215275,89402958],[3959093811,3609545561],[2455088053,223552128],[3115011301,2133669107],[1765081558,673805649],[3324795129,2111392191],[3443871631,432345706],[3152559950,3425427147],[3699649406,672784944],[3129545774,7668664],[2747044893,173040075],[3925243406,852328481],[164095314,3161868591],[2234471571,1302682825],[2164784335,105893718],[159995093,536831360],[599199451,425051327],[3274759746,1680930461],[1192619331,3903085578],[2832721114,3078660237],[91404660,4030521531],[3044880024,1578375623],[3906596030,754177855],[803516785,1894094672],[288455592,2030430096],[2143232492,2317305324],[388352703,3406060288],[2521731420,3588403719],[1043041227,4028028525],[3195290851,2468913324],[4166724431,3168683191],[1228226538,968516529],[500177583,3444787306],[533367442,4252082053],[4236023256,657816314],[413575568,3367198397],[3435884549,3334062733],[1004255532,1135705894],[2859513268,4170618274],[3914086821,1251487871],[3080761716,3489067886],[3571165255,699353261],[773372954,3648014952],[769693293,2939128604],[3116440923,507748478],[1687629160,3739431776],[2489486648,3502376324],[3686847158,2878383449],[3530767427,902211375],[2121652637,2493976397],[1827477891,930064171],[2549918411,4029725732],[2071415163,844118802],[2236083679,3088894868],[2040110303,4144562891],[3489536313,1133419300],[2190878435,2301466071],[2465915458,2448602097],[1675766804,2073834499],[3329799896,1613253148],[1483966600,1348836071],[159505618,2527621997],[2674227354,1695130688],[2683539437,1927873839],[3833196123,2570082188],[3891433165,759819981],[1455453349,2179602430],[1430583255,1957776111],[2067726741,4235143439],[303380021,2998980439],[2136024795,3126725799],[2054591852,1051702291],[1029141665,489794361],[2317027384,569642164],[2068461795,624418658],[2499875684,1830645251],[1302894490,4319401],[1002663431,2406815191],[1560941298,2060652753],[2141002286,515773223],[3661248027,475092913],[3705503008,2419919909],[914567990,3496539911],[3462935583,2039034761],[2878378006,2379243316],[1133857586,1390159333],[3023618742,2140726761],[282908558,944874642],[3686955701,1148723903],[2604456805,4163675010],[3061545110,377179268],[3218002352,76459088],[2836503392,916455101],[536836808,151306053],[2886925079,404221671],[2936593041,2011015485],[453815187,1852163908],[3042568989,82176306],[3279635891,4174836410],[3282689058,2360003049],[4088968807,1516570623],[2680453086,1322680794],[1731693966,3438253771],[1842894553,1294307894],[2736377365,2964642609],[121205621,521330014],[2324595870,3005710757],[3784465521,676493813],[1958759409,2030833406],[1306150933,1016370058],[2636541290,482366508],[1950415745,1695073534],[322077955,3746046623],[3602873262,3829181504],[1211684447,1861645455],[504701736,4080111082],[2407799203,1223857855],[1925743434,1498920209],[3617596327,845198428],[2498480299,3484773806],[2680229135,2560201696],[3731399221,1536412390],[2756509305,2924710846],[2635957500,3459716133],[1372762539,769635894],[802677945,3878474636],[1707760534,3075809808],[3714687192,2872792173],[1615679922,1606381794],[1940556374,1337437342],[445390489,731124040],[2864974375,64601760],[1984806574,2141516710],[513390958,1890172555],[744398315,1475299139],[982749166,852662657],[652663695,4260736510],[1184061125,82616221],[3363191899,147951756],[1064069880,1507328085],[2138882964,547595589],[2616926846,3186935246],[2298715513,3606862940],[2414381911,811477686],[2694745228,900437726],[4202576185,2201114451],[3602305260,3323446937],[3756663274,2658490339],[3061587876,2171079416],[3390977925,2850497765],[486312941,224925241],[3515712841,3510684394],[1322319486,2647200565],[3839619171,1148450258],[392296762,1154854654],[1401523788,957405781],[1934485528,527352730],[645968162,3131215255],[696971825,3361451947],[2038689491,1946699733],[1723966113,2785859721],[2652365974,1118037185],[3988018407,3134982149],[1354171594,3053634345],[1287854075,2631782435],[1723106141,2662328866],[563845090,1878819261],[639520332,171129501],[534957223,1696062352],[3612364282,2283204027],[3109494688,1304463816],[500957989,630925278],[3477030536,2149497258],[4109750364,281719363],[951472732,564407054],[922095147,2767874048],[3946156928,829677774],[2622281253,2086286851],[2936811901,850242186],[630086272,3340782667],[2340986210,1296336989],[4107355543,3865114709],[3560210278,3968418243],[3868847493,2967450637],[611513888,2083325060],[3265390517,3025776309],[2874106961,3424470508],[1668707698,2923258228],[2778598353,24320552],[292356118,3415510793],[754567370,86994591],[185141877,1621715171],[2884558258,3722473457],[1492107531,111281805],[3336927864,4225337056],[782994598,1021838039],[346133860,18281270],[2080909533,1649329040],[3612065399,3859901127],[2151962287,284556115],[3957975594,3745718727],[52533817,3998775856],[1232633839,397383972],[2716413964,3629253960],[1531307298,3836851439],[3030137657,2500401718],[3561556693,653345841],[313061910,2945718466],[2065276,3342140708],[410498334,1470588117],[2726640512,4051654894],[2570984935,758567696],[3008987264,3462702678],[623860175,228525243],[3527183895,1829844480],[467272850,3890501742],[568376656,650516927],[990477018,4035508558],[2366955227,817792110],[4183621538,989198068],[946958343,1639184195],[3395758993,3924097558],[1690887473,3220519765],[605184237,1255270525],[275515833,1926424610],[2142902612,283494960],[2021972412,1823828440],[105373677,3448326697],[1666662384,1042433908],[1338566998,261206307],[498685668,1344755577],[3101233780,3119109371],[2733370951,3808165089],[3656512268,3449289481],[4025308119,1607880299],[778896067,1612183167],[2846510368,3674754715],[3058428120,2991822529],[1892379383,3268787440],[2565895844,4154602030],[3213117192,98999135],[2495816991,116985075],[1040203361,1785041385],[3106252493,69316595],[1639829808,2087117568],[3213709576,3799911752],[604681594,2340981536],[4236730699,2938666503],[4009938384,1878897714],[2701667332,1725918218],[2182473079,1258184],[3550198211,2760750799],[657991062,875584532],[1640976276,3380476221],[460041378,2924352091],[1972323596,2287414795],[2510248061,1350206297],[2959337826,3762681165],[1625877874,3235902929],[2070189957,1429368735],[4245163299,1839731898],[2358312347,138364248],[275739390,2179122576],[2037777210,972544338],[2766930226,1984733259],[1933485829,4209310327],[3034118011,3286589799],[2653025529,62078937],[2641780289,2679545709],[3540781195,2787026415],[1569993599,3215949659],[441337890,3947723353],[1878946792,459505587],[3724105660,920173002],[1691411102,3934795955],[148741087,3647709027],[142506469,2776440083],[3811107376,3823285243],[472209891,252266174],[1913386482,1867329194],[2960608550,482740699],[1145005292,1513558421],[1091751784,1687823886],[3625186042,3086337482],[1712140887,940065262],[1504455800,1945702563],[3896940088,2003245591],[2478191531,4197739e3],[3233871270,250924495],[3404865229,1131917964],[1462204167,429621621],[1349259705,3641608989],[3627860584,2048468319],[1244251718,1513180369],[3979211282,371413143],[3043187861,4285699810],[581894202,3060983825],[1390895705,1811317301],[2599134010,3337406128],[2488233440,2436161462],[1816641224,2208816697],[1792034756,815866116],[2779893723,2695577703],[2084952115,2951772258],[1351806869,169269771],[2469979804,86740603],[1163545420,4264616949],[1795352113,2511146232],[1796715044,3134635815],[3521170642,1538900329],[3725363621,1455009392],[1342594643,1512127734],[2618386938,662157428],[2028859350,2494504685],[1841905045,648351336],[4002935891,4033319405],[850071259,1768358867],[979915719,3876018087],[830889197,1629549437],[1744763229,2455795856],[522919199,368499868],[3063822504,2522639205],[2861636095,407686388],[4097602344,1945259027],[4215946617,1251639506],[894485042,534122652],[924809191,1807237502],[1811585710,1589663609],[3439653887,1722232],[3810997538,105152714],[2677100683,4291805514],[77233985,102407776],[4239834691,2851274395],[148802076,2006440603],[2409138150,126301601],[3048474397,3217504870],[588133437,4221603123],[1139638106,263087485],[982032635,3165674595],[562514827,1294842959],[467575086,905357513],[1405117894,3370530088],[3813285157,242912619],[3601878331,1985076606],[1586505598,2092146221],[738488098,103663229],[2970334297,321718822],[1068097019,1742926233],[235518094,420804527],[283685722,4092504887],[2666392744,3799169331],[3569817788,1256762975],[2169728352,292617248],[2444571896,2239859206],[3967907832,1066404216],[420376911,2913277294],[3046293305,2956347747],[2311278792,2477686209],[2885955184,4172514290],[3030078181,2275536480],[4212469731,4280736393],[1046900335,1773022229],[995380926,1414273529],[3892683234,2429494358],[615726237,2127712535],[3880203074,2071130305],[176180504,3070850165],[1474506861,2283723599],[1256707747,1857412043],[764236850,359687368],[3521530334,511649419],[2318567964,3992868140],[128167623,2518992858],[2220129756,1042300052],[2567608573,1349636707],[441446694,384760969],[4143447316,829506048],[817912603,2738025500],[2368091832,357934982],[1187643061,1561463042],[3438021235,3030161697],[1318922279,895468690],[434876457,1130220303],[1180291767,1132759596],[2520707785,1798553137],[1962430872,2958700157],[1510954061,3534879512],[57831539,3269538993],[3354831405,3852135009],[891783098,2698494511],[2555636406,996018997],[2881342935,3982231648],[3473267445,2894952368],[1238029452,3958679326],[2051805420,559465638],[3655936674,1186951582],[330209165,167662935],[1929681327,2450868735],[1313566811,2458925988],[4283920930,3243182650],[1438004300,4185567150],[3093439067,89876832],[3401620219,3721579956],[3673745794,2682874719],[3053321309,825410712],[822915968,3681514755],[3900685126,561657358],[553823814,1857753416],[4166295066,983949325],[128359165,3426887194],[3300989119,3884968622],[4193552686,3647722552],[452189154,1569670618],[4122259632,3537825460],[2519387887,2821594244],[74333898,2940550377],[4032631446,2173999692],[2521268686,1934310532],[2620314688,2177785789],[1378755571,2455646622],[394133753,4231198609],[734399075,2800989170],[573292462,1634883078],[1214417373,3426576256],[2110224475,2399009920],[2331215665,3224086912],[531326186,698539511],[3839443603,583861850],[2644531398,2017784332],[616620850,3070237104],[590349237,2798642861],[3582377217,3317831670],[1582708616,1596570667],[2126148205,2358511947],[173450736,3219362418],[3616831144,1323437318],[2655785577,3131359031],[401600069,2967397952],[496349349,4244179910],[2479612086,2579650653],[1710903074,2049666425],[3589924952,690291925],[3266682943,1900485231],[1496318498,3025542656],[3459221058,3389461212],[2091479615,3140389256],[663040899,1207089672],[3323704225,1105530508],[353318429,2879253542],[2674540957,941987316],[1688550857,620657353],[338551967,4286217277],[204689992,2239736295],[178008789,3940832005],[3871613304,3300636974],[1911672356,2429684487],[4055679954,1974461722],[3878217928,1009991796],[2533095482,310920740],[2174833823,3596041637],[1604814460,2939543881],[1452830254,4092397851],[2441027029,4169690209],[3524103304,3372213855]],t=[[836181454,1689436944],[2776523577,3710710688],[4049974663,3750330768],[519497435,2979405513]],n=[[1892447193,197291556],[3793382197,3742120663],[3838936,2994760034],[479846099,1018728609],[3476112862,182272649],[3504620154,1427438450],[2009473484,2679350403],[1738755500,1129731339]],a=[4174784170,2938602761],l={p:0,P:1,n:2,N:3,b:4,B:5,r:6,R:7,q:8,Q:9,k:10,K:11},f=[];f[5]=1,f[6]=0,f[9]=3,f[10]=2,f[17]=5,f[18]=4,f[33]=7,f[34]=6,f[65]=9,f[66]=8,f[129]=11,f[130]=10;var p,h=[2,5,10,20,40,80,160,64],m=["","0000000","000000","00000","0000","000","00","0",""];function to32BitHex(e){var t=e.toString(16);return m[t.length]+t}function to64BitHex(e){return to32BitHex(e[0])+to32BitHex(e[1])}function hash(f,p){var m,g,v,y,_,b,C,S,k,w,T,P,A=f.split(" "),M=A[0].split("/"),x="w"===A[1],O=0,R=Number(x),I=R?3:4;for(v=7;v>=0;v-=1)for(y=0,C=(_=M[v]).length,b=0;b<C;b+=1)S=_[b],(T=l[S])>=0&&(m=(m^(k=e[64*T+8*(7-v)+y])[0])>>>0,g=(g^k[1])>>>0,T===R&&v===I&&(O|=1<<y)),y+=Number(S)||1;return"-"!==A[2]&&((w=A[2]).indexOf("K")>-1&&(m=(m^(k=t[0])[0])>>>0,g=(g^k[1])>>>0),w.indexOf("Q")>-1&&(m=(m^(k=t[2])[0])>>>0,g=(g^k[1])>>>0),w.indexOf("k")>-1&&(m=(m^(k=t[1])[0])>>>0,g=(g^k[1])>>>0),w.indexOf("q")>-1&&(m=(m^(k=t[3])[0])>>>0,g=(g^k[1])>>>0)),A[3]&&"-"!==A[3]&&(P=A[3].charCodeAt(0)-97,h[P]&O&&(m=(m^(k=n[P])[0])>>>0,g=(g^k[1])>>>0)),x&&(m=(m^a[0])>>>0,g=(g^a[1])>>>0),p&&"hex"===p?to64BitHex([m,g]):[m,g]}function wrap(e){var t,n,a,l,f={};function parseBook(e,t){var a,l,f,p,h,m,g=n.getUint16(e+8),v=n.getUint16(e+10);return l=g>>9&7,p=g>>3&7,h=7&g,m=g>>12&7,4===(f=g>>6&7)&&t&&l===p&&"-"!==t&&(7===h&&(0===l&&t.indexOf("K")>-1||7===l&&t.indexOf("k")>-1)?h-=1:0===h&&(0===l&&t.indexOf("Q")>-1||7===l&&t.indexOf("q")>-1)&&(h+=2)),a=String.fromCharCode(f+97)+(l+1)+String.fromCharCode(h+97)+(p+1),m&&(a+="nbrq"[m-1]),{move:a,weight:v}}function query(e){return"string"==typeof e&&(e={fen:e}),t(e)}if(f={query:query,pick:function pick(e){var t,n,a,l,f,p=0;if(function sortMoves(e){e.sort((function sorter(e,t){return t.weight-e.weight}))}(t=(e=e||{}).moves||query(e)),a=t.length){if(e.type&&1!==a&&"best"!==e.type){if("random"===e.type){for(l=Math.floor(Math.random()*t.sum)+1,f=0;f<a-1&&!(l<=(p+=t[f].weight));f+=1);return t[f].move}return"randomDisregardWeight"===e.type?t[Math.floor(Math.random()*a)].move:"worst"===e.type?t[a-1].move:((n=parseInt(e.type)||1)<0&&(n=a+n+1),n<1?n=1:n>a&&(n=a),t[n-1].move)}return t[0].move}}},e.getUint32)t=function bufferBookFind(e){var t,a,l,f,p,h=n.length||n.byteLength||0,m=e.offset||0,g=e.fen,v=e.chess960,y=e.checkAll,_=[],b=0;for(e.hash?"string"==typeof(t=e.hash)&&(t=function hex64ToDec(e){return[parseInt(e.substr(0,8),16),parseInt(e.substr(8),16)]}(t)):t=hash(g),!v&&g&&(p=g.split(" ")[2]),m=0;m<h;m+=16)if(n.getUint32(m)===t[0]&&n.getUint32(m+4)===t[1])l=parseBook(m,p),_[_.length]=l,b+=l.weight,a=!0;else if(a&&!y)break;if(_.sum=b,e.relative)for(f=_.length-1;f>=0;f-=1)_[f].relative=Math.round(_[f].weight/b*1e4);return _},n=e,f.buffer=n;else for(l in t=function jsonBookFind(e){var t,n,l,p,h,m,g=0,v=e.fen;if(f.useFen)l=v.replace(/ \d+ \d+$/,""),(t=a[l])||(p=l.replace(/[a-h][1-8]$/,"-"))!==l&&(t=a[p]);else if(e.hash||(e.hash=hash(v,"hex")),t=a[e.hash]){if(t[0]&&t[0].n&&(t=t[0]),t.n&&!t.b)return[];if(t.b)t=function decompressMoves(e){var t,n=[],a=e.b.length;for(t=0;t<a;++t)n.push({move:e.b[t],weight:e.w[t]});return n}(t);else if(!e.chess960&&v)for(m=v.split(" ")[2],n=t.length-1;n>=0;n-=1)(h=t[n].move.match(/e([18])([ah])\1/))&&("h"===h[2]&&("1"===h[1]&&m.indexOf("K")>-1||"8"===h[1]&&m.indexOf("k")>-1)?t[n]={move:"e"+h[1]+"g"+h[1],weight:t[n].weight}:"a"===h[2]&&("1"===h[1]&&m.indexOf("Q")>-1||"8"===h[1]&&m.indexOf("q")>-1)&&(t[n]={move:"e"+h[1]+"c"+h[1],weight:t[n].weight}))}if(t)for(n=t.length-1;n>=0;n-=1)g+=Number(t[n].weight);else t=[];return t.sum=g,t},a=e,f.json=a,a){f.useFen=l.indexOf(" ")>-1;break}return f}function getBook(e,t){!function ajaxLoad(e,t){var n=new XMLHttpRequest,a=e.toLowerCase().indexOf(".json")>-1;function onload(){var e;if(n.status>=200&&n.status<300||304===n.status||0===n.status||1223===n.status)if(a)try{t(null,JSON.parse(n.response))}catch(l){t(l)}else e=new DataView(n.response),t(null,e);else t(new Error("Error code: "+n.status))}n.open("GET",e,!0),a||(n.responseType="arraybuffer"),n.onload=onload,n.onerror=onload,n.send()}(e,(function onload(e,n){var a;if(n&&(a=wrap(n)),t)return t(e,a);if(e)throw e;return a}))}return{hash:hash,loadBook:(p={},function loadBook(e,t){p[e]?p[e].book?setTimeout((function(){t(null,p[e].book)}),0):p[e].cbs.push(t):(p[e]={cbs:[t]},getBook(e,(function onload(t,n){var a=p[e].cbs;t?delete p[e]:(p[e].book=n,p[e].cbs=void 0),a.forEach((function(e){setTimeout((function(){e(t,n)}),0)}))})))}),to64BitHex:to64BitHex,zobristPiece:e,zobristCastle:t,zobristEnPassant:n,zobristTurn:a,zobristPieceValue:l,zobristPieceValueNumbers:f}}(),n=function init(){var e,n,a,l,f={Chess:0,Chess960:1,Crazyhouse:2,"3-check":3,"King of the Hill":4,Bughouse:5,chess960:1,fischerandom:1,fischerrandom:1,fischer:1,chess9lx:1,960:1,crazyhouse:2,"three-check":3,threecheck:3,"3check":3,kingofthehill:4,koth:4,bughouse:5},p=["Chess","Chess960","Crazyhouse","3-check","King of the Hill","Bughouse"],h={a8:0,b8:1,c8:2,d8:3,e8:4,f8:5,g8:6,h8:7,a7:16,b7:17,c7:18,d7:19,e7:20,f7:21,g7:22,h7:23,a6:32,b6:33,c6:34,d6:35,e6:36,f6:37,g6:38,h6:39,a5:48,b5:49,c5:50,d5:51,e5:52,f5:53,g5:54,h5:55,a4:64,b4:65,c4:66,d4:67,e4:68,f4:69,g4:70,h4:71,a3:80,b3:81,c3:82,d3:83,e3:84,f3:85,g3:86,h3:87,a2:96,b2:97,c2:98,d2:99,e2:100,f2:101,g2:102,h2:103,a1:112,b1:113,c1:114,d1:115,e1:116,f1:117,g1:118,h1:119},m=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],g=0,v=0,y=0,_=-1,b=32,C=128,S=252,k=255,w=512,T=112,P=14,A=21,M=127,x="pnbrqkPNBRQK",O="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",R=[];R[5]=[-16,-17,-15],R[6]=[16,17,15],R[8]=[-18,-33,-31,-14,18,33,31,14],R[16]=[-17,-15,17,15],R[32]=[-16,1,16,-1],R[64]=[-17,-16,-15,1,17,16,15,-1],R[128]=[-17,-16,-15,1,17,16,15,-1];var I={P:5,p:6,N:9,n:10,B:17,b:18,R:33,r:34,Q:65,q:66,K:129,k:130},L={P:4,p:4,N:8,n:8,B:16,b:16,R:32,r:32,Q:64,q:64,K:128,k:128},N={5:"P",6:"p",9:"N",10:"n",17:"B",18:"b",33:"R",34:"r",65:"Q",66:"q",129:"K",130:"k"},D={9:"N",10:"N",17:"B",18:"B",33:"R",34:"R",65:"Q",66:"Q",129:"K",130:"K"},B=[80,0,0,0,0,0,0,96,0,0,0,0,0,0,80,0,0,80,0,0,0,0,0,96,0,0,0,0,0,80,0,0,0,0,80,0,0,0,0,96,0,0,0,0,80,0,0,0,0,0,0,80,0,0,0,96,0,0,0,80,0,0,0,0,0,0,0,0,80,0,0,96,0,0,80,0,0,0,0,0,0,0,0,0,0,80,8,96,8,80,0,0,0,0,0,0,0,0,0,0,0,8,212,224,212,8,0,0,0,0,0,0,96,96,96,96,96,96,224,0,224,96,96,96,96,96,96,0,0,0,0,0,0,8,212,224,212,8,0,0,0,0,0,0,0,0,0,0,0,80,8,96,8,80,0,0,0,0,0,0,0,0,0,0,80,0,0,96,0,0,80,0,0,0,0,0,0,0,0,80,0,0,0,96,0,0,0,80,0,0,0,0,0,0,80,0,0,0,0,96,0,0,0,0,80,0,0,0,0,80,0,0,0,0,0,96,0,0,0,0,0,80,0,0,80,0,0,0,0,0,0,96,0,0,0,0,0,0,80],F=[336,80,80,0,0,0,96,352,96,0,0,0,80,80,336,0,80,336,80,80,0,0,96,352,96,0,0,80,80,336,80,0,80,80,336,80,80,0,96,352,96,0,80,80,336,80,80,0,0,80,80,336,80,80,96,352,96,80,80,336,80,80,0,0,0,0,80,80,336,88,120,360,120,88,336,80,80,0,0,0,0,0,0,80,88,476,252,508,252,476,88,80,0,0,0,0,96,96,96,96,120,252,252,252,252,252,120,96,96,96,96,0,352,352,352,352,360,508,252,0,252,508,360,352,352,352,352,0,96,96,96,96,120,252,252,252,252,252,120,96,96,96,96,0,0,0,0,80,88,476,252,508,252,476,88,80,0,0,0,0,0,0,80,80,336,88,120,360,120,88,336,80,80,0,0,0,0,80,80,336,80,80,96,352,96,80,80,336,80,80,0,0,80,80,336,80,80,0,96,352,96,0,80,80,336,80,80,0,80,336,80,80,0,0,96,352,96,0,0,80,80,336,80,0,336,80,80,0,0,0,96,352,96,0,0,0,80,80,336],j=[336,80,80,0,0,0,96,352,96,96,0,0,80,80,336,0,80,336,80,80,0,0,96,352,96,96,0,80,80,336,80,0,80,80,336,80,80,0,96,352,96,96,80,80,336,80,80,0,0,80,80,336,80,80,96,352,96,112,80,336,80,80,0,0,0,0,80,80,336,88,120,360,120,120,336,80,80,0,0,0,0,0,0,80,88,476,252,508,252,508,88,80,0,0,0,0,96,96,96,96,120,252,252,252,252,252,252,104,96,96,96,0,352,352,352,352,360,508,252,0,252,508,488,352,352,352,352,0,96,96,96,96,120,252,252,252,252,252,252,104,96,96,96,0,0,0,0,80,88,476,252,508,252,508,88,80,0,0,0,0,0,0,80,80,336,88,120,360,120,120,336,80,80,0,0,0,0,80,80,336,80,80,96,352,96,112,80,336,80,80,0,0,80,80,336,80,80,0,96,352,96,96,80,80,336,80,80,0,80,336,80,80,0,0,96,352,96,96,0,80,80,336,80,0,336,80,80,0,0,0,96,352,96,96,0,0,80,80,336],$=[336,80,80,0,0,96,96,352,96,0,0,0,80,80,336,0,80,336,80,80,0,96,96,352,96,0,0,80,80,336,80,0,80,80,336,80,80,96,96,352,96,0,80,80,336,80,80,0,0,80,80,336,80,112,96,352,96,80,80,336,80,80,0,0,0,0,80,80,336,120,120,360,120,88,336,80,80,0,0,0,0,0,0,80,88,508,252,508,252,476,88,80,0,0,0,0,96,96,96,104,252,252,252,252,252,252,120,96,96,96,96,0,352,352,352,352,488,508,252,0,252,508,360,352,352,352,352,0,96,96,96,104,252,252,252,252,252,252,120,96,96,96,96,0,0,0,0,80,88,508,252,508,252,476,88,80,0,0,0,0,0,0,80,80,336,120,120,360,120,88,336,80,80,0,0,0,0,80,80,336,80,112,96,352,96,80,80,336,80,80,0,0,80,80,336,80,80,96,96,352,96,0,80,80,336,80,80,0,80,336,80,80,0,96,96,352,96,0,0,80,80,336,80,0,336,80,80,0,0,96,96,352,96,0,0,0,80,80,336],H=[336,80,80,0,0,96,96,352,96,96,0,0,80,80,336,0,80,336,80,80,0,96,96,352,96,96,0,80,80,336,80,0,80,80,336,80,80,96,96,352,96,96,80,80,336,80,80,0,0,80,80,336,80,112,96,352,96,112,80,336,80,80,0,0,0,0,80,80,336,120,120,360,120,120,336,80,80,0,0,0,0,0,0,80,88,508,252,508,252,508,88,80,0,0,0,0,96,96,96,104,252,252,252,252,252,252,252,104,96,96,96,0,352,352,352,352,488,508,252,0,252,508,488,352,352,352,352,0,96,96,96,104,252,252,252,252,252,252,252,104,96,96,96,0,0,0,0,80,88,508,252,508,252,508,88,80,0,0,0,0,0,0,80,80,336,120,120,360,120,120,336,80,80,0,0,0,0,80,80,336,80,112,96,352,96,112,80,336,80,80,0,0,80,80,336,80,80,96,96,352,96,96,80,80,336,80,80,0,80,336,80,80,0,96,96,352,96,96,0,80,80,336,80,0,336,80,80,0,0,96,96,352,96,96,0,0,80,80,336],V=[336,80,80,112,112,112,96,352,96,96,112,112,112,80,336,0,80,336,80,112,112,112,112,352,96,112,112,112,112,336,80,0,80,80,336,112,112,112,112,368,112,112,112,112,368,80,80,0,80,80,80,368,112,112,112,368,112,112,112,368,112,80,80,0,80,80,80,112,368,120,120,376,120,120,368,112,112,80,80,0,0,80,88,120,120,508,252,508,252,508,120,120,120,88,80,0,96,104,252,252,252,252,252,252,252,252,252,252,252,252,104,0,352,352,480,480,488,508,252,0,252,508,488,480,480,480,352,0,96,104,252,252,252,252,252,252,252,252,252,252,252,252,104,0,0,80,88,120,120,508,252,508,252,508,120,120,120,88,80,0,80,80,80,112,368,120,120,376,120,120,368,112,112,80,80,0,80,80,80,368,112,112,112,368,112,112,112,368,112,80,80,0,80,80,336,112,112,112,112,368,112,112,112,112,368,80,80,0,80,336,80,112,112,112,112,352,96,112,112,112,112,336,80,0,336,80,80,112,112,112,96,352,96,96,112,112,112,80,336],U=[17,0,0,0,0,0,0,16,0,0,0,0,0,0,15,0,0,17,0,0,0,0,0,16,0,0,0,0,0,15,0,0,0,0,17,0,0,0,0,16,0,0,0,0,15,0,0,0,0,0,0,17,0,0,0,16,0,0,0,15,0,0,0,0,0,0,0,0,17,0,0,16,0,0,15,0,0,0,0,0,0,0,0,0,0,17,33,16,31,15,0,0,0,0,0,0,0,0,0,0,0,18,17,16,15,14,0,0,0,0,0,0,1,1,1,1,1,1,1,0,-1,-1,-1,-1,-1,-1,-1,0,0,0,0,0,0,-14,-15,-16,-17,-18,0,0,0,0,0,0,0,0,0,0,0,-15,-31,-16,-33,-17,0,0,0,0,0,0,0,0,0,0,-15,0,0,-16,0,0,-17,0,0,0,0,0,0,0,0,-15,0,0,0,-16,0,0,0,-17,0,0,0,0,0,0,-15,0,0,0,0,-16,0,0,0,0,-17,0,0,0,0,-15,0,0,0,0,0,-16,0,0,0,0,0,-17,0,0,-15,0,0,0,0,0,0,-16,0,0,0,0,0,0,-17],G=[0,5,8,11,14],q=[31,7,7,7,63],W={P:0,p:0,N:5,n:5,B:8,b:8,R:11,r:11,Q:14,q:14},z=[4,8,16,b,64],K=["","N","B","R","Q"],Z={CAPTURE:1,BIG_PAWN:2,EP_CAPTURE:4,ANY_CAPTURE:5,PROMOTION:8,KSIDE_CASTLE:16,QSIDE_CASTLE:32,KQSIDE_CASTLE:48,DROP:64,DROP_OR_PROMOTE:72},Q=[0,6,1],X={K:119,Q:112,k:7,q:0,A:112,B:113,C:114,D:115,E:116,F:117,G:118,H:119,a:0,b:1,c:2,d:3,e:4,f:5,g:6,h:7},Y=["Event","Site","Date","Round","White","Black","Result"],J=["Event","Site","Date","Round","White","Black","Result","Variant","SetUp","FEN","WhiteA","WhiteB","BlackA","BlackB"];function rank(e){return e>>4}function file(e){return 7&e}function algebraic(e){return String.fromCharCode(file(e)+97)+(8-rank(e))}function swapColor(e){return 3-e}function hashNum(e,t){e[0]=(e[0]^t[0])>>>0,e[1]=(e[1]^t[1])>>>0}function completeFen(e){var t,n;return(t=[""," w - - 0 1"," - - 0 1"," - 0 1"," 0 1"," 1"][(n=(e=e.trim()).split(" ")).length])&&e?e+=t:"0"===n[5]&&(n[5]=1,e=n.join(" ")),e}function createVariantZobristNumbers(){t.zobristCheck=[[441249556,340005552],[1040760204,311043682],[1621584863,1749286446],[1006868636,1625552915],[1953853171,24921145],[161251506,1935545265]]}function validateFen(e,t){var n,a,l,p,h,m,g,v,y,_,b,C,S,k,w,T,P,A,M,O,R=/^(?:[A-H]{1,2}[a-h]{0,2}|[A-H]{0,2}[a-h]{1,2}|KQ?k?q?|Qk?q?|kq?|q|-)$/,I=f[t]||1*t||f[String(t).replace(/\s/g,"").toLowerCase()],L=I===f.Crazyhouse||I===f.Bughouse,N=0,D=0,B=!0,F="",j={0:0,7:0},$={0:0,7:0},H={0:"k",7:"K"},V={0:"r",7:"R"},U=I===f.Chess960;if(!e)return 1;if(I===f.Bughouse&&2===(h=e.split(" | ")).length)return 0===(m=validateFen(h[0],t))&&(m=validateFen(h[1],t)),m;if(h=e.split(/\s+/),I===f["3-check"]&&7===h.length&&(p=h.pop(),!/^\+[0-3]\+[0-3]$/.test(p)||"+3+3"===p))return 14;if(6!==h.length)return 1;if(/\D|.{7,}|^0|^$/.test(h[5]))return 2;if(/\D|.{7,}|^0.|^$/.test(h[4]))return 3;if(!/^(?:-|[abcdefgh][36])$/.test(h[3]))return 4;if(_=h[2],U){if(!R.test(_))return 12}else if(!/^(?:KQ?k?q?|Qk?q?|kq?|q|-)$/.test(_)){if(void 0!==t||!R.test(_))return 5;U=!0}if("w"!==h[1]&&"b"!==h[1])return 6;if(L&&(h[0]=h[0].replace(/~(?=.*\/)/g,"")),a=h[0].split("/"),L&&9===a.length&&(p=a.pop(),!/^[pnbrq]{0,63}$/i.test(p)))return 13;if(8!==a.length)return 7;if("3"===h[3][1]&&"w"===h[1]||"6"===h[3][1]&&"b"===h[1])return 11;for("-"!==h[3]&&(g=4===(D="3"===h[3][1]?4:3)?5:2,N=h[3].charCodeAt(0)-97,B=!1,F=4===D?"P":"p"),n=0;n<a.length;++n){for(A=0,M=!1,O=0;O<a[n].length;O++)if(+(l=a[n][O])==+l){if(M)return 8;A+=1*l,M=!0}else{if(-1===x.indexOf(l))return 9;if(B||D!==n||N!==A||F!==l||(B=!0),g===n&&N===A)return 11;n%7==0&&(l===H[n]?$[n]=1<<A:l===V[n]&&(j[n]|=1<<A)),++A,M=!1}if(8!==A)return 10}if(!B)return 11;if("-"!==_)if(U)for(C={0:0,1:0,2:252,4:248,8:240,16:224,32:192,64:128,128:0},b={0:0,1:0,2:1,4:3,8:7,16:15,32:31,64:63,128:0},P={0:[0,0],7:[0,0]},n=_.length-1;n>=0;--n){if(w=_.charCodeAt(n),T&&T>w&&T-w<8)return 15;if(75===w?S=j[k=7]&C[$[k]]:81===w?S=j[k=7]&b[$[k]]:107===w?S=j[k=0]&C[$[k]]:113===w?S=j[k=0]&b[$[k]]:(S=1<<w-((k=w>=97?0:7)?65:97),T=w),!S||0!=(S&S-1))return 15;if($[k]<2||$[k]>64||(S&j[k])!==S)return 15;if(++P[k][1*($[k]<S)]>1)return 15}else{if((v=(_.indexOf("K")>-1?128:0)|(_.indexOf("Q")>-1?1:0))&&(16!==$[7]||(v&j[7])!==v))return 15;if((y=(_.indexOf("k")>-1?128:0)|(_.indexOf("q")>-1?1:0))&&(16!==$[0]||(y&j[0])!==y))return 15}return 0}function handToString(e,t){var n,a,l="",f=0,p=t?6:0;if(e)for(;f<5;){for(n=e>>G[f]&q[f],a=0;a<n;++a)l+=x[f+p];++f}return l}function hashEP(e,n,a,l){e[a+1]!==l&&e[a-1]!==l||hashNum(n,t.zobristEnPassant[file(a)])}function addPawnMove(e,t,a,l){var f;(0===n||2&e[a+8])&&(rank(a)%7==0?(f=l|Z.PROMOTION|t<<7|a<<P,m[v++]=8388608|f,m[v++]=6291456|f,m[v++]=4194304|f,m[v++]=2097152|f):m[v++]=l|t<<7|a<<P)}function kingOfTheHillWin(e){switch(e){case 67:case 68:case 51:case 52:return!0}return!1}function canCastle960(e,t,n,a){var l,f,p,h=t+(n-t%8),m=n>t%8?1:-1;for(p=t+m;p!==h;p+=m)if(e[p])return!1;if(f=(l=1===a?1===m?118:114:1===m?6:2)-m,e[l+8]||e[l]&&l!==t&&l!==h||e[f]&&f!==t&&f!==h)return!1;if(l!==t)for(p=t+(m=l>t?1:-1);p!==l;p+=m)if(p!==h&&e[p]||e[p+8])return!1;return!0}var ee=function(){function createLine(e,t,n,a,l,p,h){var m,g,v,y,_,b,C,S,k,w,T,P=[],A="",M=!0,x=t[n],O=x.length,R="";if(x.commands)for(y in x.commands)(!p||p.indexOf(y)>-1)&&(R+="[%"+y+" "+x.commands[y]+"]");for(x.initComment&&!h&&(R=(R+" "+x.initComment.replace(/(\"|\}|\%|\\)/g,"\\$1")).trim()),R&&P.push("{"+R+"}"),g=0;g<O;++g){if(b=1===(m=x[g]).color,A="",R="",a!==f.Bughouse?(M&&!b?A=e+"...":b&&(A=e+"."),l&&(b||M)&&(A+=" ")):(P.bughouseOrder||(P.bughouseOrder=[]),P.bughouseOrder.push(m.bughouseOrder),g||(P.blackCountOffset=2===x[0].color?1:0)),A+=m.san,m.annotation&&(A+=m.annotation),m.additionalAnnotation&&(A+=" "+m.additionalAnnotation.join(" ")),M=!1,void 0===m.time||m.commands||(m.commands={clk:(k=m.time,w=void 0,T=void 0,w=Math.floor(k%36e3/600),T=Math.floor(k%36e3%600)/10,Math.floor(k/36e3)+":"+(w<10?"0":"")+w+":"+(T<10?"0":"")+T)}),m.commands)for(y in m.commands)(!p||p.indexOf(y)>-1)&&(R+="[%"+y+" "+m.commands[y]+"]");if(m.comment&&!h&&(R=(R+" "+m.comment.replace(/(\"|\}|\%|\\)/g,"\\$1")).trim()),R&&(A+=" {"+R+"}",M=!0),P.push(A),m.lines)for(C=m.lines.length,v=0;v<C;++v)t[S=m.lines[v]].length&&((_=createLine(e,t,S,a,l,p,h))[0]="("+_[0],_[_.length-1]+=")",P=P.concat(_),M=!0);b||e++}return P}function createHeader(e,t){return"["+e+' "'+String(t).replace(/(\"|\\)/g,"\\$1")+'"]'}return function generatePgn(e,t,n,a,l,p){var h,m,g="string"==typeof e.newline?e.newline:"\n",v=void 0===e.spaceAfterPeriods||e.spaceAfterPeriods,y="";for(h in y+=createHeader("Event",t.Event)+g,y+=createHeader("Site",t.Site)+g,y+=createHeader("Date",t.Date)+g,y+=createHeader("Round",t.Round)+g,l===f.Bughouse?(y+=createHeader("WhiteA",t.WhiteA||"?")+g,y+=createHeader("BlackA",t.BlackA||"?")+g,y+=createHeader("WhiteB",t.WhiteB||"?")+g,y+=createHeader("BlackB",t.BlackB||"?")+g):(y+=createHeader("White",t.White)+g,y+=createHeader("Black",t.Black)+g),y+=createHeader("Result",t.Result)+g,l&&(y+=createHeader("Variant",t.Variant)+g),t.FEN&&t.FEN!==O&&(y+=createHeader("SetUp","1")+g,y+=createHeader("FEN",t.FEN)+g),t)-1===J.indexOf(h)&&(y+=createHeader(h,t[h])+g);if(y+=g,m=createLine(a,n,0,l,v,e.hideCommands?[]:e.restrictCommands,e.hideComments),l===f.Bughouse){if(p.isDependent)return m;m=function makeBugHousePgn(e,t,n){var a=t,l=e.siblingGame.pgn(),f=0,p=0,h=[];for(t.bughouseOrder=t.bughouseOrder||[],l.bughouseOrder=l.bughouseOrder||[];t.bughouseOrder.length||l.bughouseOrder.length;)!t.bughouseOrder.length||l.bughouseOrder.length&&t.bughouseOrder[0]>l.bughouseOrder[0]?(l.bughouseOrder.shift(),h.push("B")):(t.bughouseOrder.shift(),h.push("A"));return t=[],h.forEach((function(h){var m,g,v,y="";"A"===h?(m=a,g=++f,v=e.startingMoveNumber()):(m=l,g=++p,v=e.siblingGame.startingMoveNumber()),y=String(Math.floor((g+1)/2)+v-1),(m.blackCountOffset+g)%2?y+=h:y+=h.toLowerCase(),y+="."+(n?" ":"")+m.shift(),t.push(y)})),t}(p,m,v)}return m.push(t.Result),y+function wordWrap(e,t,n){return t<1?e:(t="number"==typeof t?t:80,e.replace(new RegExp("(.{1,"+t+"})(?: |$|\r?\n)","g"),"$1"+n).slice(0,-n.length))}(m.join(" "),e.maxWidth,g)}}(),te=function(){var e="!?~",t=/\[%(\S+)\s([^\]]+)\]/,n=/^(?:[+=~\/\-\u2212]+|T?N|RR|D)$/;function extractCommands(e){for(var n,a=e.commands||{};n=t.exec(e.value);)e.value=e.value.replace(n[0],"").trim(),a[n[1]]=n[2],e.commands=a}function isSplitGame(e,t,n,a){for(var l;++t<n;)if((l=e[t].trim())&&"%"!==l[0])return"["===l[0]&&(!a||/^\[\S+\s+".*"\]$/.test(l))}return function tokenize(t,a){var l,f,p,h,m,g,v,y="tags",_=[],b={type:y,value:""},C=0,S=[],k=!0;a=a||{},h=(l=t.split(/\r?\n/)).length;e:for(f=0;f<h;++f)if("%"!==(p=l[f].trim())[0])if(p){if(g=(p=" "+p+" ").length,m=0,k)for(;m<g;++m)if(v=p[m],"tags"===y){if("["===v)b={type:y="tagName",value:""};else if(v.trim()){b={type:y="san",value:""},k=!1;break}}else if("tagName"===y)b.value&&""===v.trim()?(_.push(b),y="tagValueStart"):" "!==v&&(b.value+=v);else if("tagValueStart"===y){if('"'===v||""===v)b={type:y="tagValue",value:""};else if(v.trim()){_.push({type:"tagValue",value:p.slice(m,-1).match(/(.*?)"?\]?$/)[1]}),b={type:y="tags",value:""};continue e}}else if("tagValue"===y)if('"'===v||""===v)if(_.push(b),"]"===p[m+1])b={type:y="tags",value:""},++m;else{if("]"===p.slice(-2,-1)){b.value+=p.substr(m).match(/(.*?)"?\s*\] $/)[1],b={type:y="tags",value:""};continue e}y="tagEnd"}else"\\"===v&&m+2<g&&(v=p[++m]),m>0&&(b.value+=v);else{if("]"!==v){if(!v.trim())continue;--m}b={type:y="tags",value:""}}for(;m<g;++m)if(v=p[m],"san"===y)if(e.indexOf(v)>-1)"!"===v||"?"===v||e.indexOf(v)<6&&(v=["!!","??","!?","?!"][e.indexOf(v)-2])?(b.value&&_.push(b),b={type:"a",value:v},"!"!==p[m+1]&&"?"!==p[m+1]||(b.value+=p[++m]),_.push(b),b={type:"san",value:""}):(""===v&&"=/"===b.value?(b.type="aa",b.value+=v):(b.value&&(n.test(b.value)&&("--"!==b.value||a.rejectNullMoves)&&(b.type="aa"),_.push(b)),b={type:"aa",value:v},""===v&&""===p[m+1]&&(b.value="",++m)),_.push(b),b={type:"san",value:""});else if(" "===v||"\t"===v||"\r"===v||"{"===v||"("===v||")"===v){if(b.value){if("$"===b.value[0])b.type="nag";else if("*"===b.value||"1-0"===b.value||"0-1"===b.value||"1/2-1/2"===b.value||"-"===b.value){if(!(C||m+1<g)){if(b.type="result","-"===b.value&&(b.value="1/2-1/2"),_.push(b),S.push(_),f+1===h||f+2===h&&!l[f+1])return S;k=!0,b={type:y="tags",value:""},_=[];break}b.type="*"===b.value?"cont":"comment"}n.test(b.value)&&("--"!==b.value||a.rejectNullMoves)&&(b.type="aa"),_.push(b),b={type:y,value:""}}if(" "===v||"\t"===v||"\r"===v)y="san";else if("{"===v)y="comment",_.length&&"comment"===_[_.length-1].type&&((b=_.pop()).value+=" ");else if("("===v)y="san",_.push({type:"variationStart",value:++C});else{if(C<1){if(!a.commentErrors)return!1}else _.push({type:"variationEnd",value:C--});y="san"}b.type=y}else if("."===v||!b.value&&+v==+v&&"-"!==p[m+1]&&"/"!==p[m+1]){if(+v==+v)switch(b.number||(b.number=""),b.number+=v,p[m+1]){case"A":case"a":case"B":case"b":b.number+=p[++m],_.push({type:"number",value:b.number}),delete b.number}}else b.value+=v;else 0===m&&(b.value=b.value.trim()),"}"!==v?("\\"===v&&m+2<g&&(v=p[++m]),b.value+=v):(b.value=b.value.trim(),b.value.indexOf("[")>-1&&extractCommands(b),_.push(b),b={type:y="san",value:""})}else _.length&&("tags"===y?(y="san",k=!1):"tagValueStart"!==y&&isSplitGame(l,f,h,C||"comment"===y)&&("comment"===y&&_.push(b),"tagValue"!==_[_.length-1].type&&(S.push(_),_=[]),y="tags",k=!0,C=0));return b.value&&_.push(b),!_.length&&S.length||S.push(_),S}}();function Chess(J,ne){var re,oe,ie=0,ae=!0,se=[],ce=1,le=[],ue=_,de=0,fe=1,pe=1,he=[],me=[he],ge=0;he.id=ge;var ve={},ye=[],_e=!1,be=!1,Ce=makeMoveChess,moveToSan=function(e,t){var n,a,l,f,p,h,_="";return e&Z.KQSIDE_CASTLE?_=e&Z.KSIDE_CASTLE?"O-O":"O-O-O":e&Z.DROP?((n=e>>A)&&(_+=K[n]),_+="@"+algebraic(l=e>>P&M)):(l=e>>P&M,4&(f=oe[a=e>>7&M])?(e&Z.ANY_CAPTURE&&(_+=String.fromCharCode(file(a)+97)+"x"),_+=algebraic(l),e&Z.PROMOTION&&(_+="="+K[n=e>>A])):(_+=D[f&k],y>1&&(_+=function getDisambiguator(e,t,n){var a,l,f,p,h,g;if(v<2)return"";for(e&=S,g=0;g<v;++g)if(n===(a=m[g])>>P&&(f=a>>7&M)!==t&&oe[f]&e){if(l=!0,rank(t)===rank(f)){if(p)return algebraic(t);h=!0}if(file(t)===file(f)){if(h)return algebraic(t);p=!0}}if(l)return p?String(8-rank(t)):String.fromCharCode(file(t)+97);return""}(f,a,l)),e&Z.ANY_CAPTURE&&(_+="x"),_+=algebraic(l))),t||(e&Z.KQSIDE_CASTLE?(a=e>>7&M,l=e>>P&M):e&Z.DROP_OR_PROMOTE&&(f=z[n]+ce),inCheckAfterMove(f,a,l,e)&&(Ce(e,a,l,n),p=g,g=v,h=y,ie&&isVariantWin()||generateMoves()===g?_+="#":_+="+",v=g,g=p,y=h,reverseMove(he.pop()))),_};function hashPosition(){var e,n,a,l=1===ce?[4174784170,2938602761]:[0,0];for(a=0;a<120;++a)136&a&&(a+=8),(e=oe[a])&&hashNum(l,t.zobristPiece[64*t.zobristPieceValueNumbers[e&k]+8*(7-rank(a))+file(a)]);if(be)for(n=1;n<3;++n)le[n]&&(0!=(le[n]&le[n]-1)?(hashNum(l,t.zobristCastle[n-1]),hashNum(l,t.zobristCastle[n+1])):le[n]>1<<file(se[n])?hashNum(l,t.zobristCastle[n-1]):hashNum(l,t.zobristCastle[n+1]));else{for(n=1;n<3;++n)le[n]&&(le[n]&Z.KSIDE_CASTLE&&hashNum(l,t.zobristCastle[n-1]),le[n]&Z.QSIDE_CASTLE&&hashNum(l,t.zobristCastle[n+1]));_e?function hashHand(e,n){var a,l,f,p,h,m,g,v=0;for(a=1;a<3;++a){if(l=n[a])for(f=0;f<5;){for(h=v+63*f,p=l>>G[f]&q[f],m=0;m<p;++m)hashNum(e,[31*(g=t.zobristPiece[h++])[0]>>>0,17*g[1]>>>0]);++f}v=315}}(l,re._hand):ie===f["3-check"]&&function hash3Check(e,n){n[1]&&hashNum(e,t.zobristCheck[n[1]-1]),n[2]&&hashNum(e,t.zobristCheck[n[2]+2])}(l,ye)}return ue!==_&&hashEP(oe,l,ue+(1===ce?16:-16),4|ce),l}function getCurrentHash(){var e;return he.length?e=he[he.length-1].hash:(he.hash||(he.hash=hashPosition()),e=he.hash),[e[0],e[1]]}function bughouseify(e){function fixBughouseSan(e){return/#/.test(e)&&checkIsPotentiallyBlockable()&&(e=e.replace("#","+")),e}function bughouseFunc(t,n){var a=e(t,n);return a&&("string"==typeof a?a=fixBughouseSan(a):(a.san=fixBughouseSan(a.san),he[he.length-1].san=a.san)),a}return bughouseFunc._isBughouseified=!0,bughouseFunc._orig=e,bughouseFunc}function setVariant(e,t){ie!==(ie=e?f[e]||1*e||f[String(e).replace(/\s/g,"").toLowerCase()]||f.Chess:0)&&(ie===f.Bughouse?(_e=!0,re.isDependent||(re.siblingGame=Chess(),re.siblingGame.hashing(ae),re.siblingGame.isDependent=!0,re.siblingGame.siblingGame=re,re.siblingGame.header({Variant:"Bughouse"})),createVariantZobristNumbers(),Ce=makeMoveVariant,moveToSan=bughouseify(moveToSan),re.move=bughouseify(re.move)):(delete re.siblingGame,_e=ie===f.Crazyhouse,be=ie===f.Chess960,ie?(createVariantZobristNumbers(),Ce=makeMoveVariant):Ce=makeMoveChess,moveToSan._isBughouseified&&(moveToSan=moveToSan._orig,re.move=re.move._orig)),t||updateSetup(generateFen()))}function disambiguate960Rook(e,t){for(var n,a,l=e>7?1:2;!(136&e);){if((n=oe[e])&l)if(n&b){if(a)return;a=e%8+(1===l?65:97)}else if(n&C)return a;e+=t}}function clear(e,t,n){oe=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],ce=1,se[1]=_,se[2]=_,le[1]=0,le[2]=0,re._hand[1]=0,re._hand[2]=0,ye[1]=0,ye[2]=0,ue=_,de=0,fe=1,t||(me=[he=[]],ge=0,he.id=ge,ve={Event:"?",Site:"?",Date:"????.??.??",Round:"?",White:"?",Black:"?",Result:"*"},e?setHeader(["Variant",e]):setVariant(!1,n),n||updateSetup(generateFen()))}function reset(){clear(0,!1,!0),he.hash=[1178310168,378666140],oe=[34,10,18,66,130,18,10,34,0,0,0,0,0,0,0,0,6,6,6,6,6,6,6,6,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,5,5,5,5,5,5,5,5,0,0,0,0,0,0,0,0,33,9,17,65,129,17,9,33,0,0,0,0,0,0,0,0],pe=1,se[1]=116,se[2]=4,le[1]=48,le[2]=48}function load(e,t,n,a){var l,m,g,v,y,S,k,T,P,A,M,x,O=0;if(a?(x=(l=e.split(" "))[3],M=l[2]):(x=(l=e.trim().split(/\s+/))[3]||"-",M=l[2]||"-"),void 0===t?(31&M.charCodeAt(0))<9&&setVariant(f.Chess960,!0):setVariant(t,!0),m=l[0],!a&&!(m=function fixFenPieces(e,t){var n,a,l=e.length,p=0,h=0,m=t&&(t===f.Crazyhouse||t===f.Bughouse);for(n=0;n<l;++n)if(+(a=e[n])!=+a)if("/"===a){if(8!==h&&(e=e.substr(0,n)+(8-h)+e.substr(n),++n,++l),h=0,++p>7){if(!m&&n<l-1||!/^[pnbrq]{0,63}$/i.test(e.substr(n+1)))return!1;break}}else if(I[a]){if(++h>8)return!1}else{if("~"!==a)return!1;m&&n&&/[nbrq]/i.test(e[n-1])||(e=e.substr(0,n)+e.substr(n+1),--n,--l)}else(h+=1*a)>8&&(e=e.substr(0,n)+(a-(h-8))+e.substr(n+1),h=8);return e}(m,ie)))return!1;if(v=m.length,clear(p[ie],n,!0),_e){if(ie===f.Bughouse&&!re.isDependent&&(S=e.split(" | "),!re.siblingGame.load(1===S.length?e:S[1],t,n,a)))return reset(),!1;for(y=0;y<v;++y)if(+(k=m[y])!=+k)if("/"===k){if(O>111){for(++y;y<v;++y)k=m[y],re._hand[k<"a"?1:2]+=1<<W[k]>>>0;break}O+=8}else oe[O]=I[k],"~"===m[y+1]&&(++y,oe[O]|=w),oe[O]&C&&(se[3&oe[O]]=O),++O;else O+=1*k}else for(y=0;y<v;++y)+(k=m[y])!=+k?"/"===k?O+=8:(oe[O]=I[k],oe[O]&C&&(se[3&oe[O]]=O),++O):O+=1*k;if(ce="b"===l[1]?2:1,"-"!==M)if(be){for(P={1:[0,0],2:[0,0]},y=M.length-1;y>=0;--y)75===(g=M.charCodeAt(y))?g=disambiguate960Rook(119,-1):81===g?g=disambiguate960Rook(112,1):107===g?g=disambiguate960Rook(7,-1):113===g&&(g=disambiguate960Rook(0,1)),T=g<97?1:2,A=X[String.fromCharCode(g)],(a||oe[A]===(b|T))&&(g>=97?se[T]>=1&&se[T]<=6&&(le[T]|=1<<A):se[T]>=113&&se[T]<=118&&(le[T]|=1<<A-112),++P[T][1*(se[T]<A)]);(P[1][0]>1||P[1][1]>1)&&(le[1]=0),(P[2][0]>1||P[2][1]>1)&&(le[2]=0)}else{if(!a)for(y=M.length-1;y>=0;--y)T=M.charCodeAt(y)<97?1:2,oe[X[M[y]]]===(b|T)&&se[T]===(1===T?116:4)||(M=M.substr(0,y)+M.substr(y+1));for(y=M.length-1;y>=0;--y)switch(M[y]){case"K":le[1]|=Z.KSIDE_CASTLE;break;case"Q":le[1]|=Z.QSIDE_CASTLE;break;case"k":le[2]|=Z.KSIDE_CASTLE;break;case"q":le[2]|=Z.QSIDE_CASTLE}}return!a&&(2!==x.length||1===ce&&"6"!==x[1]||2===ce&&"3"!==x[1]||oe[x.charCodeAt(0)-97+16*(8-("3"===x[1]?4:5))]!==(4|swapColor(ce))||oe[h[x]])&&(x="-"),ue="-"===x?_:h[x],de=1*l[4]||0,fe=1*l[5]||1,ie===f["3-check"]&&(l[6]&&"+3+3"!==l[6]&&(S=l[6].match(/^\+([0-3])\+([0-3])$/)),S=S||[0,0,0],ye[1]=1*S[1],ye[2]=1*S[2]),n||(pe=fe,updateSetup(generateFen())),!0}function generateFen(){return ie?function generateVariantFen(){var e,t,n,a=0,l="",p="";for(e=0;e<120;++e)136&e&&(a&&(l+=a),l+="/",a=0,e+=8),(n=oe[e])?(a&&(l+=a,a=0),l+=N[n&k],_e&&n&w&&(l+="~")):++a;if(a&&(l+=a),_e&&(l+="/"+handToString(re._hand[1],!0)+handToString(re._hand[2])),be){for(t=le[2],e=0;t;)1&t&&(p=String.fromCharCode(e+97)+p),t>>=1,++e;for(t=le[1],e=0;t;)1&t&&(p=String.fromCharCode(e+65)+p),t>>=1,++e}else le[1]&Z.KSIDE_CASTLE&&(p+="K"),le[1]&Z.QSIDE_CASTLE&&(p+="Q"),le[2]&Z.KSIDE_CASTLE&&(p+="k"),le[2]&Z.QSIDE_CASTLE&&(p+="q");return l+=" "+(1===ce?"w":"b")+" "+(p||"-")+" "+(ue===_?"-":algebraic(ue))+" "+de+" "+fe,ie===f["3-check"]?l+=" +"+ye[1]+"+"+ye[2]:ie!==f.Bughouse||re.isDependent||(l+=" | "+re.siblingGame.fen()),l}():function generateStandardFen(){var e,t,n=0,a="",l="";for(e=0;e<120;++e)136&e&&(n&&(a+=n),a+="/",n=0,e+=8),(t=oe[e])?(n&&(a+=n,n=0),a+=N[t&k]):++n;return n&&(a+=n),le[1]&Z.KSIDE_CASTLE&&(l+="K"),le[1]&Z.QSIDE_CASTLE&&(l+="Q"),le[2]&Z.KSIDE_CASTLE&&(l+="k"),le[2]&Z.QSIDE_CASTLE&&(l+="q"),a+" "+(1===ce?"w":"b")+" "+(l||"-")+" "+(ue===_?"-":algebraic(ue))+" "+de+" "+fe}()}function setHeader(e){var t,n,a;for(t=0;t<e.length;t+=2)n=e[t],a=e[t+1],n&&("Variant"===n&&(setVariant(a),a=ie?p[ie]:void 0),"Result"===n&&"*"!==a&&"1-0"!==a&&"0-1"!==a&&"1/2-1/2"!==a&&(a="*"),void 0!==a?ve[n]=String(a):Y.indexOf(n)>-1?ve[n]="Date"===n?"????.??.??":"?":delete ve[n]);return ve}function updateSetup(e){he.length>0||ge||(e!==O?(ve.SetUp="1",ve.FEN=e,he.hash=null):(delete ve.SetUp,delete ve.FEN,he.hash=[1178310168,378666140]))}function get(e){var t=oe[h[e]];return t?{type:N[t&S|2],color:3&t,promoted:0!=(t&w)}:null}function calculateLegalMoveInfo(t,f){var p,h,m,g,v,y,b,C,k,w,P,A,M,x=ce,O=oe;if(e=[],n=0,a=0,l=0,O[8]=O[9]=O[10]=O[11]=O[12]=O[13]=O[14]=O[15]=O[24]=O[25]=O[26]=O[27]=O[28]=O[29]=O[30]=O[31]=O[40]=O[41]=O[42]=O[43]=O[44]=O[45]=O[46]=O[47]=O[56]=O[57]=O[58]=O[59]=O[60]=O[61]=O[62]=O[63]=O[72]=O[73]=O[74]=O[75]=O[76]=O[77]=O[78]=O[79]=O[88]=O[89]=O[90]=O[91]=O[92]=O[93]=O[94]=O[95]=O[104]=O[105]=O[106]=O[107]=O[108]=O[109]=O[110]=O[111]=O[120]=O[121]=O[122]=O[123]=O[124]=O[125]=O[126]=O[127]=0,f!==_){for(A=function chooseKingThreats(e,t){return be&&le[e]?V:le[e]&Z.KSIDE_CASTLE&&!oe[t+1]&&!oe[t+2]?le[e]&Z.QSIDE_CASTLE&&!oe[t-1]&&!oe[t-2]&&!oe[t-3]?(l=Z.KQSIDE_CASTLE,H):(l=Z.KSIDE_CASTLE,j):le[e]&Z.QSIDE_CASTLE&&!oe[t-1]&&!oe[t-2]&&!oe[t-3]?(l=Z.QSIDE_CASTLE,$):F}(x,f),p=0;p<120;++p)if(136&p&&(p+=8),g=oe[p])if(g&x)(!t||(0|g)&t)&&e.push(p);else if(0!=((M=A[p-f+119])&g))if(4&g)for(k=R[g],h=1;h<3;++h)136&(b=p+k[h])||(O[b+8]|=1,b===f&&(++n,O[p+8]|=2));else{C=(k=R[g&S]).length,P=g&T;e:for(h=0;h<C;++h)if(w=k[h],!(f>(b=p)&&w<0&&f-b>16||f<b&&w>0&&b-f>16))for(;0==(136&(b+=w));){if(O[b+8]|=1,v=oe[b]){if(v&x)if(b===f){for(m=b-w;m!==p;m-=w)O[m+8]|=2;O[p+8]|=2,++n,P&&0==(136&(b+=w))&&(O[b+8]|=1)}else if(P&&256&M){for(y=b;(y+=w)!==f;)if(136&y||oe[y])continue e;O[b+8]|=4+(Math.abs(w)<<3),++a}break}if(!P)break}}n>1&&(e=[f])}else e=function getPieces(e,t){var n,a,l=[];for(n=0;n<120;++n)136&n&&(n+=8),(a=e[n])&&(a&t)===t&&l.push(n);return l}(oe,x|t)}function validateEnPassant(e,t){var a,l,f,p=t+16*(1===ce?1:-1);return(1!==n||0!=(2&oe[t+8])||0!=(2&oe[p+8]))&&(a=oe[e],oe[t]=a,oe[e]=0,l=oe[p],oe[p]=0,f=inCheck(),oe[e]=a,oe[t]=0,oe[p]=l,!f)}function addCastlingMoves(e){var t,n,a;if(be){if(le[e])for(n=(t=se[e])%8,a=0;a<8;++a)le[e]&1<<a&&canCastle960(oe,t,a,e)&&(m[v++]=(a>n?Z.KSIDE_CASTLE:Z.QSIDE_CASTLE)+(t<<7)+(t+(a-n)<<P),++a)}else l&Z.KSIDE_CASTLE&&(n=(t=se[e])+2,0===oe[t+9]&&0===oe[t+10]&&(m[v++]=Z.KSIDE_CASTLE+(t<<7)+(n<<P))),l&Z.QSIDE_CASTLE&&(n=(t=se[e])-2,0===oe[t+7]&&0===oe[t+6]&&(m[v++]=Z.QSIDE_CASTLE+(t<<7)+(n<<P)))}function generateMoves(t,l){var f,p,h,_,b,C,k,w,M,x,O=ce,I=swapColor(O),L=se[O];for(calculateLegalMoveInfo(t,L),y=e.length,v=g,M=0;M<y;++M)if(f=e[M],_=oe[f],!(n&&a&&4&oe[f+8]))if(4&_)for(C=R[_],0!==a&&0!=(4&oe[f+8])&&oe[f+8]>>3!=16||(b=f+C[0],0===oe[b]&&(addPawnMove(oe,f,b,0),Q[O]===rank(f)&&(b+=C[0],oe[b]||addPawnMove(oe,f,b,Z.BIG_PAWN)))),p=1;p<3;++p)136&(b=f+(k=C[p]))||a&&4&oe[f+8]&&oe[f+8]>>3!==Math.abs(k)||(oe[b]&I?addPawnMove(oe,f,b,Z.CAPTURE):b===ue&&validateEnPassant(f,b)&&(m[v++]=Z.EP_CAPTURE|f<<7|b<<P));else{if(a&&4&oe[f+8]){if(8&_)continue;if(!(B[f-se[O]+119]&_))continue;C=[k=oe[f+8]>>3,-k]}else C=R[_&S];if(x=f<<7,f===L){for(p=0;p<8;++p)0==(136&(b=f+(k=C[p])))&&(oe[b]?oe[b]&I&&0==(1&oe[b+8])&&(m[v++]=Z.CAPTURE|x|b<<P):0==(1&oe[b+8])&&(m[v++]=x|b<<P));0===n&&addCastlingMoves(O)}else for(h=C.length,w=_&T,p=0;p<h;++p)for(k=C[p],b=f;!(136&(b+=k));){if(oe[b]){oe[b]&I&&(0===n||2&oe[b+8])&&(m[v++]=Z.CAPTURE|x|b<<P);break}if((0===n||2&oe[b+8])&&(m[v++]=x|b<<P),!w)break}}return ie&&(_e?function drop(e,t,a){var l,f,p,h,g;if(!e)for(t&&(t>>=26),h=0;h<5;++h)if((!t||(0|t)==1<<h)&&re._hand[a]&q[h]<<G[h]){for(0===h?(l=16,f=103,p=Z.DROP):(l=0,f=119,p=Z.DROP|h<<A),g=l;g<=f;++g)136&g&&(g+=8),oe[g]||(0===n||1===n&&2&oe[g+8])&&(m[v++]=p|g<<P);if(t)return}}(l,t,O):!be&&isVariantWin()&&(v=g)),v}function inCheckAfterMove(e,t,n,a){var l,p,h,m,g,v,y,S;if(ie===f["King of the Hill"]&&e&C&&kingOfTheHillWin(n))return!0;if(a&Z.KQSIDE_CASTLE&&(n=1===ce?a&Z.KSIDE_CASTLE?117:115:a&Z.KSIDE_CASTLE?5:3,e=b,S=!0),(l=se[swapColor(ce)])===_)return!1;if(0==(e&C)&&B[n-l+119]&e)for(g=e&T,m=n+(h=U[n-l+119]);0==(136&m);){if(m===l){if(4&e){if(1==(3&e)?l-n<0:l-n>0)return!0;break}return!0}if(m!==t&&oe[m]||!g)break;m+=h}if(!S){if((p=B[t-l+119])&T&&(h=U[t-l+119])!==U[n-l+119])for(m=l-h;0==(136&m);){if(m!==t&&(v=oe[m])){if(v&ce&&p&v&&v&T)return!0;break}m-=h}if(a&Z.EP_CAPTURE&&(p=B[(y=n+16*(1===ce?1:-1))-l+119])&T)for(m=l-(h=U[y-l+119]);0==(136&m);){if(m!==t&&m!==y){if(m===n)break;if(v=oe[m]){if(v&ce&&p&v&&v&T)return!0;break}}m-=h}}return!1}function attacked(e,t){var n,a,l,f,p=R[8],h=8|e;for(n=0;n<8;++n)if(0==(136&(l=t+p[n]))&&((a=oe[l])&h)===h)return!0;for(p=R[128],n=0;n<8;++n)for(l=t+(f=p[n]);0==(136&l);){if(a=oe[l]){if(a&e&&B[t-l+119]&a){if(!(4&a))return!0;if(1===e?t-l<0:t-l>0)return!0}break}l+=f}return!1}function kingAttacked(e){return se[e]!==_&&attacked(swapColor(e),se[e])}function inCheck(){return kingAttacked(ce)}function checkIsPotentiallyBlockable(){var e,t,n,a=1<<G[4];return re._hand[ce]+=a,e=g,g=v,t=y,n=generateMoves()!==g,v=g,g=e,y=t,re._hand[ce]-=a,n}function inCheckmate(){return inCheck()&&(m[0]=0)===generateMoves()&&!m[0]&&(ie!==f.Bughouse||!checkIsPotentiallyBlockable())}function inStalemate(){var e=!inCheck()&&(m[0]=0)===generateMoves()&&!m[0];return e&&ie===f.Bughouse&&!re.isDependent&&(e=re.siblingGame.inStalemate()),e&&se[ce]!==_}function insufficientMaterial(e){var t,n,a=0,l=0,f=0;for(n=0;n<120;++n)if(136&n&&(n+=8),t=oe[n]){if(e&&0==(t&e))continue;if(100&t)return!1;if(8&t){if(l||a++)return!1}else if(16&t){if(a)return!1;if(++l,(rank(n)+n)%2&&++f,f&&l!==f)return!1}}return!0}function inThreefoldRepetition(){if(de<8)return!1;for(var e,t=getCurrentHash(),n=!1,a=de,l=!1,f=he,p=f.length-1;;){if((p-=2)<0){if(f.id){p=f.atMoveNode+p+2,f=me[f.parentId];continue}if(-2===p)return!1;e=f.hash,l=!0}else e=f[p].hash,f[p].halfMoves>a||a<2?l=!0:a=f[p].halfMoves;if(e[0]===t[0]&&e[1]===t[1]){if(n)return!0;n=!0}if(l)return!1}}function modifyHand(e){var n,a,l,p,h,m,g,v,y,_=e.move;if(ie===f.Crazyhouse||_&Z.DROP?(a=re._hand,h=e.hash,y=e.color):(a=re.siblingGame._hand,e.handSibling=!0,ae&&((m=re.siblingGame._history()).length?h=m[m.length-1].hash:(m.hash||(m.hash=re.siblingGame._hashPosition()),h=m.hash)),y=swapColor(e.color)),e.captured){switch((e.captured&w?4:e.captured&S)&S){case 4:g=0;break;case 8:g=1;break;case 16:g=2;break;case b:g=3;break;default:g=4}n=1<<G[g],ae&&(p=a[y]>>G[g]&q[g],v=t.zobristPiece[p+63*g+(1===y?0:315)])}else n=-1<<G[l=_>>A],ae&&(p=a[y]>>G[l]&q[l],v=t.zobristPiece[p-1+63*l+(1===y?0:315)]);a[y]+=n,e.handChange=n,ae&&hashNum(h,[31*v[0]>>>0,17*v[1]>>>0])}function makeMoveChess(e,n,a,l){var f,p,h,m,g,v,y,S,T=ce,P=swapColor(T),A={move:e,epSquare:ue,halfMoves:de,castlingW:le[1],castlingB:le[2],color:T},M=1===T;ae&&(m=getCurrentHash(),A.hash=m,hashNum(m,t.zobristTurn),ue!==_&&hashEP(oe,m,ue+(M?16:-16),4|T)),0==(e&Z.KQSIDE_CASTLE)?_e&&e&Z.DROP?(oe[a]=z[l]|T,ae&&hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[oe[a]]+8*(7-rank(a))+file(a)]),modifyHand(A),y=0):(y=oe[n],(S=oe[a])&&(A.captured=S,ae&&hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[oe[a]&k]+8*(7-rank(a))+file(a)]),S&b&&le[P]&&(be?rank(a)===(M?0:7)&&(h=1<<file(a),le[P]&h&&(le[P]^=h,ae&&(h>1<<file(se[T])?hashNum(m,t.zobristCastle[P-1]):hashNum(m,t.zobristCastle[P+1])))):a===(M?7:119)?le[P]&Z.KSIDE_CASTLE&&(le[P]^=Z.KSIDE_CASTLE,ae&&hashNum(m,t.zobristCastle[P-1])):a===(M?0:112)&&le[P]&Z.QSIDE_CASTLE&&(le[P]^=Z.QSIDE_CASTLE,ae&&hashNum(m,t.zobristCastle[P+1])))),oe[a]=e&Z.PROMOTION?z[l]|T|w:oe[n],oe[n]=0,ae&&(hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[y&k]+8*(7-rank(n))+file(n)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[oe[a]&k]+8*(7-rank(a))+file(a)]))):y=C,e&Z.EP_CAPTURE?(M?(v=a+16,g=6):(v=a-16,g=8),A.captured=4|P,oe[v]=0,ae&&hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[4|P]+8*(g-rank(a))+file(a)])):y&C?(be?(e&Z.KQSIDE_CASTLE&&(oe[a]=0,oe[n]=0,e&Z.KSIDE_CASTLE?M?(f=118,p=117):(f=6,p=5):M?(f=114,p=115):(f=2,p=3),oe[f]=T|C,oe[p]=T|b,ae&&(hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[C|T]+8*(7-rank(n))+file(n)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[b|T]+8*(7-rank(a))+file(a)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[C|T]+8*(7-rank(f))+file(f)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[b|T]+8*(7-rank(p))+file(p)]))),ae&&(0!=(le[T]&le[T]-1)?(hashNum(m,t.zobristCastle[T-1]),hashNum(m,t.zobristCastle[T+1])):le[T]>1<<file(se[T])?hashNum(m,t.zobristCastle[T-1]):hashNum(m,t.zobristCastle[T+1])),se[T]=f||a):(e&Z.KQSIDE_CASTLE&&(oe[a]=oe[n],oe[n]=0,e&Z.KSIDE_CASTLE?(f=a-1,p=a+1):(f=a+1,p=a-2),oe[f]=oe[p],oe[p]=0,ae&&(hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[C|T]+8*(7-rank(n))+file(n)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[b|T]+8*(7-rank(p))+file(p)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[C|T]+8*(7-rank(a))+file(a)]),hashNum(m,t.zobristPiece[64*t.zobristPieceValueNumbers[b|T]+8*(7-rank(f))+file(f)]))),ae&&(le[T]&Z.KSIDE_CASTLE&&hashNum(m,t.zobristCastle[T-1]),le[T]&Z.QSIDE_CASTLE&&hashNum(m,t.zobristCastle[T+1])),se[T]=a),le[T]=0):y&b&&le[T]&&(be?rank(n)===(M?7:0)&&(h=1<<file(n),le[T]&h&&(le[T]^=h,ae&&(h>1<<file(se[T])?hashNum(m,t.zobristCastle[T-1]):hashNum(m,t.zobristCastle[T+1])))):n===(M?119:7)?le[T]&Z.KSIDE_CASTLE&&(le[T]^=Z.KSIDE_CASTLE,ae&&hashNum(m,t.zobristCastle[T-1])):n===(M?112:0)&&le[T]&Z.QSIDE_CASTLE&&(le[T]^=Z.QSIDE_CASTLE,ae&&hashNum(m,t.zobristCastle[T+1]))),e&Z.BIG_PAWN?(ue=M?a+16:a-16,ae&&hashEP(oe,m,a,4|P)):ue=_,4&y||e&Z.ANY_CAPTURE?de=0:de++,ce=P,he.push(A)}function makeMoveVariant(e,n,a,l){var p,h=ce;makeMoveChess(e,n,a,l),p=he[he.length-1],_e?(de=p.halfMoves+1,p.captured&&modifyHand(p),ie===f.Bughouse&&(p.bughouseOrder=re.moveCount()-1+re.siblingGame.moveCount())):ie===f["3-check"]&&kingAttacked(ce)&&(p.checked=!0,ae&&ye[h]&&hashNum(p.hash,t.zobristCheck[ye[h]+(1===h?-1:2)]),++ye[h],ae&&hashNum(p.hash,t.zobristCheck[ye[h]+(1===h?-1:2)]))}function reverseMove(e){var t,n,a=ce,l=swapColor(a),p=e.move,h=p>>P&M,m=p>>7&M;if(ce=l,le[2]=e.castlingB,le[1]=e.castlingW,ue=e.epSquare,de=e.halfMoves,ie){if(be&&p&Z.KQSIDE_CASTLE)return p&Z.KSIDE_CASTLE?1===l?(n=118,t=117):(n=6,t=5):1===l?(n=114,t=115):(n=2,t=3),oe[n]=0,oe[t]=0,oe[m]=l|C,oe[h]=l|b,void(se[l]=m);if(e.handChange&&(ie!==f.Crazyhouse&&e.handSibling?re.siblingGame._hand[swapColor(l)]-=e.handChange:re._hand[l]-=e.handChange),p&Z.DROP)return void(oe[h]=0);e.checked&&--ye[l]}p&Z.PROMOTION?(oe[m]=4|l,oe[h]=p&Z.CAPTURE?e.captured:0):(oe[m]=oe[h],p&Z.KQSIDE_CASTLE?(oe[h]=0,p&Z.KSIDE_CASTLE?(t=h+1,n=h-1):(t=h-2,n=h+1),oe[t]=l|b,oe[n]=0,se[l]=m):(h===se[l]&&(se[l]=m),p&Z.CAPTURE?oe[h]=e.captured:(oe[h]=0,p&Z.EP_CAPTURE&&(oe[h-(1===l?-16:16)]=4|a))))}function beautifyMove(e,t,n){var a,l,f=e>>P&M,p={color:ce,to:algebraic(f),flags:e&M};return _e&&0!=(e&Z.DROP)?(l=e>>A,p.drop=l,p.piece=z[l]+ce):(a=e>>7&M,p.from=algebraic(a),p.piece=oe[a],e&Z.PROMOTION&&(l=e>>A,p.promotion=z[l]+ce),e&Z.CAPTURE?p.captured=oe[f]:e&Z.EP_CAPTURE&&(p.captured=4|swapColor(ce))),p.san=t||moveToSan(e,n),p}function isVariantWin(){return ie===f["3-check"]?3===ye[swapColor(ce)]:ie===f["King of the Hill"]?kingOfTheHillWin(se[swapColor(ce)]):void 0}function isBughouseWin(){if(ie===f.Bughouse)return re.siblingGame.inCheckmate()}function createVariation(){var e=[],t=generateFen(),n=he.length-1,a=he[n];return!!a&&(e.parentId=ge,e.id=me.length,he.curFen=t,a.lines||(a.lines=[]),a.lines.push(e.id),a.move?reverseMove(a):(ue=a.epSquare,--de,ce=swapColor(ce)),2===ce&&--fe,e.atMoveNode=n,e.hash=n?he[n-1].hash:he.hash,ge=e.id,me.push(e),he=e,!0)}function selectLine(e){var t=generateFen();he.curFen=t,he=me[e],ge=e,load(he.curFen,ie,!0,!0)}return re={WHITE:1,BLACK:2,PAWN:4,KNIGHT:8,BISHOP:16,ROOK:b,QUEEN:64,KING:C,FLAGS:Z,load:load,reset:reset,moves:function(e){var t,n,a,l=[],f=moveToSan;for(e&&(e.verbose&&(f=beautifyMove),e.type&&(n=e.type|e.type<<24),a=e.noDrop),generateMoves(n,a),t=0;t<v;++t)l.push(f(m[t]));return l},inCheck:inCheck,inCheckmate:inCheckmate,inStalemate:inStalemate,isBughouseWin:isBughouseWin,in50MoveRule:function(){return de>=100},inDraw:function(){return de>=100||inStalemate()||insufficientMaterial()||inThreefoldRepetition()||Boolean(function isBughouseDraw(){if(ie===f.Bughouse)return re.siblingGame.in50MoveRule()||re.siblingGame.inThreefoldRepetition()}())},insufficientMaterial:insufficientMaterial,inThreefoldRepetition:inThreefoldRepetition,isVariantWin:isVariantWin,gameOver:function(){return re.inDraw()||inCheckmate()||Boolean(isVariantWin())||Boolean(isBughouseWin())},isPositionValid:function(e){var t,n,a,l=0;if(!1!==(e=e||{}).pawns)for(t=0;t<=119;){if(4&(a=oe[t]))return!1;8==++t&&(t=112)}if(!1!==e.kings){for(t=0;t<=119;++t)if(136&t&&(t+=8),(a=oe[t])&C){if(++l>2)return!1;if(n&&n&a)return!1;n=3&a}if(2!==l)return!1}return!1===e.check||!1===e.kings&&se[swapColor(ce)]===_||!kingAttacked(swapColor(ce))},validateFen:validateFen,fen:generateFen,pgn:function(e){return(e=e||{}).useResultHeader||ge||(isVariantWin()||inCheckmate()?ve.Result=2===ce?"1-0":"0-1":re.inStalemate()?ve.Result="1/2-1/2":isBughouseWin()&&(ve.Result=1===re.siblingGame.turn()?"1-0":"0-1")),ee(e,ve,me,pe,ie,re)},loadPgn:function(e,t,n){var a,l,f,p,h,m,g,v,y,_={},b=0;if("number"!=typeof t&&(n=n||t,t=0),n=n||{},"string"==typeof e&&(n.singleGame&&(e=e.replace(/(?:\r?\n\s*){2,}/g,"\n")),e=re.tokenizePgn(e,n)),t<0&&(t=e.length+t),!(p=e[t]))return!1;for(reset(),l=p.length,a=0;a<l&&"tagName"===(f=p[a]).type;++a){if(!p[a+1]||"tagValue"!==p[a+1].type)return!1;++a,"FEN"===f.value?g=completeFen(p[a].value):_[f.value]=p[a].value}if(n.variant&&(_.Variant=n.variant),_.Variant&&!g&&(g=O),g||"1"===_.SetUp)if("0"===_.SetUp)_.FEN=g;else if(!g||!load(g,_.Variant))return!1;for(re.header(_),m=(h=re)._history();a<l;++a)if("san"===(f=p[a]).type&&0===b){if(!h.move(f.value)&&("Z0"!==f.value&&"<>"!==f.value||n.rejectNullMoves||!h.move("--")))if(n.commentErrors)m.length?m[m.length-1].comment=((m[m.length-1].comment||"")+" "+f.value).trim():m.initComment=((m.initComment||"")+" "+f.value).trim();else{if(!n.skipBadLines||!(0!==ge||he.length&&n.allowBadMainLine))return reset(),!1;b=1}}else if("result"===f.type&&"*"===ve.Result)setHeader(["Result",f.value]);else if("a"===f.type&&0===b&&m[m.length-1])m[m.length-1].annotation=f.value;else if("nag"!==f.type&&"aa"!==f.type||0!==b||!m[m.length-1])if("comment"===f.type&&0===b)m.length?(f.value&&(m[m.length-1].comment=f.value),f.commands&&(m[m.length-1].commands=f.commands,f.commands.clk&&(m[m.length-1].time=(v=f.commands.clk,y=void 0,10*(3600*(y=v.split(":"))[0]+60*y[1]+1*y[2]))))):(m.initComment=String(f.value),f.commands&&(m.commands=f.commands));else if("variationStart"===f.type){if(b>0)++b;else if(!createVariation())return reset(),!1;m=h._history()}else if("variationEnd"===f.type)b>0&&--b,0===b&&(selectLine(m.parentId),m=h._history());else if("number"===f.type){if(!(h=/b/i.test(f.value.slice(-1))?re.siblingGame:re))return!1;m=h._history()}else"cont"===f.type&&ge&&!m.length&&h.move(h._lines()[m.parentId][m.atMoveNode].san);else m[m.length-1].additionalAnnotation||(m[m.length-1].additionalAnnotation=[]),-1===m[m.length-1].additionalAnnotation.indexOf(f.value)&&m[m.length-1].additionalAnnotation.push(f.value);return!0},header:function(e){return Array.isArray(e)?setHeader(e):"object"==typeof e?(Object.keys(e).forEach((function(t){setHeader([t,e[t]])})),ve):ve},turn:function(e){return 1!==e&&2!==e||(ce=e),ce},move:function playMove(e){var n,a,l,f,p,g,y,b,k,T,O,R,I;if("string"==typeof e){switch(e[f=e.length-1]){case"+":case"#":e=e.substr(0,f)}for(k=x.indexOf(e[0])>6?L[e[0]]:"O"===e[0]?C:4,_e&&(-1===e.indexOf("@")?T=!0:(T=!1,k<<=24)),generateMoves(k,T),f=0;f<v;++f)if(e===(g=moveToSan(m[f],!0))){a=m[f];break}if(!a){if("--"===e)return function makeNullMove(){var e,n={color:ce,san:"--",epSquare:ue},a={color:ce,san:"--"};return ae&&(e=getCurrentHash(),n.hash=e,hashNum(e,t.zobristTurn),ue!==_&&hashEP(oe,e,ue+(1===ce?16:-16),4|ce)),ue=_,de++,1===(ce=swapColor(ce))&&++fe,he.push(n),a}();if(e=re.fixMove(e))try{return playMove(e)}catch(N){}return null}y=a>>7&M,b=a>>P&M,l=a>>A}else{if(e.drop){switch(e.drop){case"p":l=0;break;case"n":l=1;break;case"b":l=2;break;case"r":l=3;break;case"q":l=4;break;default:return null}k=1<<26+l}else{if(e.promotion)switch(e.promotion){case"q":l=4;break;case"n":l=1;break;case"r":l=3;break;case"b":l=2;break;default:return null}y=h[e.from],T=!0,k=oe[y]&S}for(b=h[e.to],n=((l?l<<A:0)|b<<P)>>7|y,generateMoves(k,T),f=0;f<v;++f)if(m[f]>>7===n){a=m[f];break}if(!a)return(e=re.fixMove(e))?playMove(e):null}return I=a&Z.DROP_OR_PROMOTE?z[l]+ce:oe[y],p=beautifyMove(a,g,!0),O=inCheckAfterMove(I,y,b,a),Ce(a,y,b,l),O&&(ie&&isVariantWin()||0===generateMoves()?p.san+="#":p.san+="+"),(R=he[he.length-1]).san=p.san,p.piece&w&&(R.promoted=!0),1===ce&&++fe,p},undo:function(e){var t=he.pop();return t?(1===ce&&--fe,t.move?(reverseMove(t),!!e||beautifyMove(t.move,t.san)):(ue=t.epSquare,--de,ce=swapColor(ce),!!e||{san:"--",color:t.color})):null},clear:function(e){clear(e)},put:function(e,t,n){var a,l=h[t],f=!1,p=oe[l],m=3&p,g=e.color;if(isNaN(l)||!e.type||!g||-1===x.indexOf(e.type))return!1;if(oe[l]=L[e.type]|g|(e.promoted?w:0),oe[l]&C&&(se[g]=l),p&&oe[se[m]]&&oe[se[m]]!==(C|m)){for(a=0;a<120;++a)136&a&&(a+=8),oe[a]===(C|m)&&(se[m]=a,f=!0);f||(se[m]=_)}return n||load(generateFen(),ie,!1,!1),!0},get:get,remove:function(e,t){var n,a=oe[h[e]],l=get(e),f=3&a;if(oe[h[e]]=0,a&C)for(se[f]=_,le[f]=0,n=0;n<120;++n)if(136&n&&(n+=8),oe[n]===(C|f)){se[a.color]=n;break}return t||load(generateFen(),ie,!0,!1),l},history:function(e,t){for(var n,a=[],l=he,f=l.length;;){if(-1==--f){if(l.id&&!t){f=l.atMoveNode,l=me[l.parentId];continue}break}e?((n=beautifyMove(l[f].move,l[f].san)).color=l[f].color,!f&&l.initComment&&(n.firstComment=l.initComment),void 0!==l[f].comment&&(n.comment=l[f].comment),void 0!==l[f].time&&(n.time=l[f].time),void 0!==l[f].annotation&&(n.annotation=l[f].annotation),void 0!==l[f].additionalAnnotation&&(n.additionalAnnotation=l[f].additionalAnnotation),void 0!==l[f].commands&&(n.commands=l[f].commands),void 0!==l[f].captured&&(n.captured=l[f].captured),void 0!==l[f].promoted&&(n.promoted=l[f].promoted),void 0!==l[f].lines&&(n.lines=l[f].lines),void 0!==l[f].bughouseOrder&&(n.bughouseOrder=l[f].bughouseOrder),x.indexOf(l[f].san[0])>6?n.piece=L[l[f].san[0]]:"O"===l[f].san[0]?n.piece=C:n.piece=4,n.piece|=n.color,a.unshift(n)):a.unshift(l[f].san)}return a},hashes:function(){for(var e=[],t=he,n=t.length;;){if(-1==--n){if(t.id){n=t.atMoveNode,t=me[t.parentId];continue}t.hash||getCurrentHash(),e.unshift(t.hash);break}e.unshift(t[n].hash)}return e},moveCount:function(){return he.length},startingMoveNumber:function(){return pe},completeFen:completeFen,createVariation:createVariation,selectLine:selectLine,hash:function(){var e=getCurrentHash();return ie!==f.Bughouse||re.isDependent?e:[e,re.siblingGame.hash()]},hashing:function(e){ae=e,ie!==f.Bughouse||re.isDependent||re.siblingGame.hashing(ae)},hand:function(){if(_e)return handToString(re._hand[1],!0)+handToString(re._hand[2])},checks:function(){if(ie===f["3-check"])return[ye[1],ye[2]]},threats:function(){var e,t,l,f,p,h,y,b=ce,C=swapColor(b),k=[],w=[],T=[],x=[],O=[],R=ue;if(calculateLegalMoveInfo(0,se[b]),n||a)for(e=0;e<120;++e)136&e&&(e+=8),2&oe[e+8]&&oe[e]?T.push(algebraic(e)):4&oe[e+8]&&k.push(algebraic(e));for(ce=C,ue=_,generateMoves(),e=v;e--;){if(p=(t=m[e])>>P&M,h=t>>7&M,t&Z.DROP_OR_PROMOTE){if(f=z[y=t>>A]|C,t&Z.PROMOTION&&y%3!=1)continue}else f=oe[h],y=0;if(inCheckAfterMove(f,h,p,t)&&(Ce(t,h,p,y),g=e,(ie&&isVariantWin()||generateMoves()===e)&&w.push((t&Z.DROP?N[f].toLowerCase()+"@":algebraic(h))+algebraic(p)),reverseMove(he.pop()),t&Z.CAPTURE)){for(l=0,e=v;e>g;)if((m[--e]>>P&M)===p){l=1,e=g;break}if(!l){x.push(algebraic(h)+algebraic(p));continue}}t&Z.CAPTURE&&1!==y&&(l=124&oe[p])&&(attacked(b,p)?l>(f=oe[h]&S)&&l-f!=8&&O.push(algebraic(h)+algebraic(p)):x.push(algebraic(h)+algebraic(p)))}return g=0,ce=b,ue=R,{pins:k,checkers:T,mates:w,undefended:x,underdefended:O}},tokenizePgn:te,fixMove:function(e){var t,n,a;if("string"==typeof e){if(/0|[?!+#]$|[18][QNRB]$|^P/i.test(e))return e.replace(/[?!+#]+$/,"").replace(/0/g,"O").replace(/([18])([QNRB])$/i,"$1=$2").replace(/^P+/i,"");if(n=e.indexOf("=")>0?-4:-2,"number"==typeof(t=h[e.substr(n,2)])){if(oe[t]&swapColor(ce)||/^[a-h]x?[a-h][36]$/.test(e)){if(-1===e.indexOf("x"))return e.slice(0,n)+"x"+e.substr(n)}else if(e.indexOf("x")>-1)return e.replace(/x/g,"");if(a=e.match(/^([KQNRB]?)([a-h][1-8]?|[1-8])x?([a-h][1-8])=?(.?)$/)){if(oe[h[a[2]]])return{from:a[2],to:a[3],promotion:a[4].toLowerCase()};if(/^\d$/.test(a[2])){for(e=0,generateMoves(L[a[1]],!0),n=0;n<v;++n)if(m[n]>>P===t&&rank(m[n]>>7&M)===8-a[2]){if(e)return;e=m[n]}if(e)return moveToSan(e,!0)}return a[1]+a[3]+a[4]}}}else if(oe[h[e.from]]===(C|ce)&&e.to&&e.from[1]===e.to[1]){if(e.from<e.to)return"O-O";if(e.from>e.to)return"O-O-O"}},_hand:[],_history:function(e){return e&&(ge=(he=e).id),he},_lines:function(){return me},_hashPosition:hashPosition,_board:function(){return oe}},J&&load(J,ne)||reset(),re}return Chess.variants=p,Chess}(),ENGINE_MANAGER=function(e){var n=["bench","d","eval","flip","isready","ponderhit","stop","uci","ucinewgame"],a=[{cmd:"position",args:["fen","startpos","moves","continuation"]},{cmd:"go",args:["binc","btime","confidence","depth","infinite","mate","mindepth","mintime","maxdepth","maxtime","movestogo","movetime","ponder","searchmoves","shallow","winc","wtime"]}],l=["moves","searchmoves"],f=["ponder","infinite","startpos"],p={depth:1,seldepth:1,time:1,nodes:1,multipv:1,cp:1,mate:1,currmovenumber:1,hashfull:1,nps:1,tbhits:1,sbhits:1,cpuload:1,bmc:1,score:2,lowerbound:2,upperbound:2,bestmove:3,ponder:3,baseTurn:3,bestmoveSan:3,ponderSan:3,pv:4,pvSan:4,string:4,refutation:4,currline:4},h=/(?:Total|Final) Evaluation[\s\S]+\n$/i;function createWebWorker(e,t,n){var a=new Worker(e||"stockfish.js"),l={terminate:function terminate(){a.terminate()},postMessage:function postMessage(e){a.postMessage(e)}};function requeue(e){var t=e.concat();e.length=0,t.forEach((function(e){e.cmd?"go"!==e.cmd.substr(0,2)&&n.send(e.cmd,e.cb,e.stream):(clearTimeout(e.timer),n.getBestMove(e.args,e.cb,e.stream))}))}return a.onmessage=function(e){"string"==typeof e.data&&l.onmessage(e.data)},a.onerror=function(f){if(n.fallbackPath&&n.fallbackPath!==e){try{f.preventDefault()}catch(f){}try{a.terminate()}catch(f){}return(a=createWebWorker(n.fallbackPath,t,n)).onmessage=function(e){l.onmessage(e)},requeue(n._activeCommands()),requeue(n._bestMoveQueue()),!1}if(t.onError)return t.onError(f)},l}function createWorker(t,n){var a;return function getSupportedEngines(t,n){n.fallbackPath=t.pathToNonWasmEngine,n.path=t.enginePath||t.pathToEngineWorker,n.wasmPath=t.pathToWasmEngine,t.engines&&(t.engines.multiThreaded&&e.supportsMultithreading()?(n.path=t.engines.multiThreaded.loader,n.wasmPath=t.engines.multiThreaded.engine):t.engines.singleThreaded&&(n.path=t.engines.singleThreaded.loader,n.wasmPath=t.engines.singleThreaded.engine),n.fallbackPath=t.engines.asm||n.fallbackPath)}(t,n),a=n.path,(n.fallbackPath&&"undefined"==typeof WebAssembly||!a)&&(a=n.fallbackPath),n.wasmPath&&(a+="#"+n.wasmPath),createWebWorker(a,t,n)}function parseSearchLine(e){for(var t,n,a=e.split(" "),l=a.length,f="info"===a[0]?1:0,h={mtype:a[0]};f<l;++f)if(n=a[f])if(1===(t=p[n])){for(;!a[++f]&&f<l;);h[n]=Number(a[f])}else if(2===t)h[n]=!0;else if(3===t){for(;!a[++f]&&f<l;);h[n]=a[f]}else for(h[n]=[],++f;f<l;++f){if(p[a[f]]){--f;break}a[f]&&h[n].push(a[f])}return"(none)"!==h.bestmove&&"0000"!==h.bestmove||(h.bestmove=void 0,h.bestmoveSan=void 0),"(none)"!==h.ponder&&"0000"!==h.ponder||(h.ponder=void 0,h.ponderSan=void 0),h}function getFirstWord(e){var t=e.indexOf(" ");return-1===t?e:e.substr(0,t)}return function loadEngine(p,m){var g,v,y,_={},b=[],C=[],S=null;function bestMoveSearch(){var t,n,a,l,f,p=1,h=[],m=[],g=null,y=C[0].args,b=C[0].cb,S=C[0].stream,k=1,w=[],T=loadEngine._previousCP;function convertpv(e){var t=[],n=m[e]||createSanPv(h[e]);return h[e].forEach((function oneach(e,a){t.push({moveSan:n[a],moveLan:e})})),t}function getpv(e,t,n,a){var l;for(l=h.length-1;l>=0;l-=1)if(h[l][0]===e)return convertpv(l);return n?[{moveSan:t,moveLan:e},{moveSan:a,moveLan:n}]:t?[{moveSan:t,moveLan:e}]:[]}function convertScore(e){0===e.mate?(e.mateIn=0,e.cp=-31800*k):(e.mateIn=Number(e.mate*k)||null,"number"!=typeof e.mateIn||isNaN(e.mateIn)||"number"==typeof e.cp?(e.cp*=k,9===Math.abs(e.cp)&&(e.cp=0),y.normalize&&e.depth<=14&&"number"==typeof T&&1===e.multipv&&function normalize(e){var t=.03*Math.pow(32,e.depth/14);e.cp=T+(e.cp-T)*t}(e)):e.cp=31800*k*(e.mate/Math.abs(e.mate))),e.score=e.cp/100}function addBestMoveProps(f){var h;f.baseTurn=a,f.cp=t,f.score=t/100,f.mate=n,f.mateIn=g,f.depth=p,f.moveLan=f.bestmove,f.moveLan&&(f.move=e.uciToObj(f.moveLan)[0],(h=l.move(f.move))&&(f.moveSan=f.bestmoveSan=h.san,f.ponder&&(h=l.move(e.uciToObj(f.ponder)[0]))&&(f.ponderSan=h.san,l.undo(!0)),l.undo(!0)))}function createSanPv(t){var n,a,f=t.length,p=[];for(n=0;n<f&&(a=l.move(e.uciToObj(t[n])[0]));++n)p.push(a.san);for(;n>0;--n)l.undo(!0);return p}function createTimeout(){y.timeout&&(clearTimeout(v),C[0].timer=v=setTimeout((function(){_.stop(),b&&(b(),b=void 0)}),y.timeout))}C[0].started=!0,loadEngine._previousCP=null,y.difficulty>=0&&y.difficulty<20?(_.setoption("Skill Level",y.difficulty),y.maximumError>=0&&y.maximumError<=4999&&_.setoption("Skill Level Maximum Error",y.maximumError),y.errorProbability>=1&&y.errorProbability<=128&&_.setoption("Skill Level Probability",y.errorProbability)):_.setoption("Skill Level",20),void 0!==y.contempt?_.setoption("Contempt",y.contempt):_.setoption("Contempt","0"),y.multiPv>1?_.setoption("MultiPV",y.multiPv):_.setoption("MultiPV",1),y.movetime||y.wtime&&y.btime||y.depth||(y.btime=y.btime||72e3,y.wtime=y.wtime||72e3),!y.startpos&&y.fen||y.moves||y.variant?(l=e.createGame({fen:y.fen?(f=y.fen,(f+"").replace(/\[([qrbnp]*)\]/i,"/$1").replace(/([0-3])\+([0-3]) (\d+ \d+)/,(function(e,t,n,a){return a+" +"+(3-t)+"+"+(3-n)}))):"rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",moves:y.moves,variant:y.variant,disableHashing:!0})).turn()===l.WHITE?a="w":(a="b",k=-1):(a="w",l=e.createGame({disableHashing:!0})),_.setVariant(y.variant),_.position(y),_.go(y,(function returnBestMove(e){var n=parseSearchLine(e);if(addBestMoveProps(n),p>14&&t<5e3&&t>-5e3&&(loadEngine._previousCP=t),n.pv=getpv(n.moveLan,n.moveSan),1===n.pv.length&&n.ponder&&(n.pv=getpv(n.moveLan,n.moveSan,n.ponder,n.ponderSan)),w.length>1)w.splice(w.indexOf(n.moveLan),1),y.searchmoves=w,y.getNextBest=0,queueBestMoveSearch(y,(function done(){b(n)}),(function streamer(e){S&&(e.multipv=2,S(e))}));else if(b)try{b(n)}catch(a){console.error(a)}C.shift(),clearTimeout(v),C.length>0&&bestMoveSearch()}),(function streamInfo(e){var l=parseSearchLine(e);l.score&&(l.baseTurn=a,convertScore(l),!l.multipv&&l.depth&&(l.multipv=1),1!==l.multipv&&0!==l.depth||(t=l.cp,n=l.mate,g=l.mateIn)),l.pv&&S&&(l.pvSan=createSanPv(l.pv)),!l.pv||l.lowerbound||l.upperbound||(h.push(l.pv),S&&m.push(l.pvSan)),l.depth>p?p=l.depth:"bestmove"===l.mtype&&addBestMoveProps(l),!S||0===l.mateIn&&l.pv||S(l),createTimeout()})),y.getNextBest&&b&&l.moves({verbose:!0}).forEach((function toLan(t){t=e.normalizeMoveObj(t),w.push(t.from+t.to+(t.promotion||""))})),createTimeout()}function queueBestMoveSearch(e,t,n){C.push({args:e,cb:t,stream:n}),1===C.length&&bestMoveSearch()}function cbIfReady(){_.ready&&(_.bookLoaded||!_.pathToBook)&&m&&m(_)}return _.send=function(t,n,a){var l;!function isPrintingCommand(e){return"ucinewgame"!==e&&"flip"!==e&&"stop"!==e&&"ponderhit"!==e&&0!==e.indexOf("position")&&0!==e.indexOf("setoption")&&0!==e.indexOf("variation")&&0!==e.indexOf("threat-variation")&&0!==e.indexOf("push")&&0!==e.indexOf("pop")&&0!==e.indexOf("serve")}(t=String(t).trim())?l=!0:b[b.length]={cmd:t,cb:n,stream:a},g&&(e.log&&console.log("stdin: "+t),g.postMessage(t),l&&n&&setTimeout(n,0))},_._activeCommands=function(){return b},_._bestMoveQueue=function(){return C},_.quit=function(){if(g&&g.terminate){try{_.send("quit")}catch(e){}g.terminate(),g=null,_.ready=void 0}clearTimeout(v)},n.forEach((function oneach(e){_[e]=function makeSCmd(t,n){_.send(e,t,n)}})),a.forEach((function oneach(e){_[e.cmd]=function makeCCmd(t,n,a){var p=[e.cmd];y&&t.fen&&(t.fen=function convertStockfishVariantFen(e){return(e+"").replace(/^([^/]+)((?:\/[^/]+){7})\/([qrbnp]*)/i,"$1$2[$3]").replace(/( \d+ \d+) \+([0-3])\+([0-3])/,(function(e,t,n,a){return" "+(3-n)+"+"+(3-a)+t}))}(t.fen)),e.args.forEach((function oneach(e){if(t[e]||0===t[e]){if(l.indexOf(e)>-1){if(!t[e]||!t[e].length)return;Array.isArray(t[e])&&(t[e]=t[e].join(" "))}p.push(e),-1===f.indexOf(e)&&p.push(t[e])}})),_.send(p.join(" "),n,a)}})),_.setoption=function(e,t){_.send("setoption name "+e+" value "+t)},_.setVariant=function(e){var t;e!==y&&(t=String(e).toLowerCase().replace(/ |-/g,""),e&&"chess"!==t?"chess960"===t?(_.setoption("UCI_Variant","chess"),_.setoption("UCI_Chess960","true")):("threecheck"===t&&(t="3check"),_.setoption("UCI_Variant",t),_.setoption("UCI_Chess960","false")):(t=void 0,_.setoption("UCI_Variant","chess"),_.setoption("UCI_Chess960","false")),y=t)},_.loadBook=function(e,n){_.pathToBook=e,t.loadBook(e,(function onload(e,t){_.book=t,_.bookLoaded=!0,e&&(console.error("Error loading opening book."),console.error(e),_.pathToBook=null,_.bookLoaded=!1),n()}))},_.getBestMove=function(t,n,a){var l;if((t=t||{}).fen=t.fen||t.baseFen,t.is960&&(t.variant="Chess960"),_.bookLoaded&&t.useBook&&(l=function getBookMove(t){var n=e.createGame(t),a=_.book.pick({fen:n.fen(),type:void 0!==t.bookPick?t.bookPick:"random",chess960:"Chess960"===n.header().Variant}),l=a&&n.move(a);if(l)return{moveSan:l.san,moveLan:a,move:{from:l.from,to:l.to,promotion:l.promotion||null},baseTurn:1===n.turn()?"b":"w",pv:[{moveSan:l.san,moveLan:a}],depth:null,score:null,mateIn:null,isBookMove:!0}}(t),l))return setTimeout((function(){l.mtype="bestmove",n(l)}),0);queueBestMoveSearch(t,n,a)},_.stopAll=function(t){var n,a=b.length,l=0;function ondiscard(){0===(l-=1)&&t()}for(C=[],n=0;n<a;n+=1)e.log&&console.log("debug (stop_moves): "+n,getFirstWord(b[n].cmd)),"go"!==getFirstWord(b[n].cmd)||b[n].discard||(_.stop(),b[n].discard=!0,t&&(l+=1,b[n].ondiscard=ondiscard));t&&!l&&_.isready(t)},_.restartEngine=function(e){return _.stopAll(),_.quit(),b=[],C=[],_.bookLoaded&&!p.book&&((p=JSON.parse(JSON.stringify(p))).book=_.book),loadEngine(p,e)},_.stopFast=function(e,t){var n;_.stopAll((function(){clearTimeout(n),e(_)})),n=setTimeout((function(){_.restartEngine(e)}),t||5e3)},"undefined"!=typeof Worker&&(p.ceeMode&&(!function addCeeInterface(t,n){var a,l,f=1e3,p=0;function createInterruptHook(e){function interruptHook(e){var t=interruptHook.callbacks;for(var n in interruptHook.callbacks={},interruptHook.original&&interruptHook.original(e),t)t[n](e)}return interruptHook.callbacks={},interruptHook.original=e,interruptHook}function analyze(n,h,m,g){var v,y=Date.now(),_=!1,b=++p;function cleanup(){clearTimeout(v),delete a.callbacks[b],delete l.callbacks[b],_=!0}function handleError(e){_||(cleanup(),g({data:e,action:h,uci:n},n))}function onProcessCrash(t){handleError({msg:"CEE process crashed unexpectedly",code:e.ERROR_CODES.CRASH,exitCode:t,err:new Error("CEE process exited with "+t)})}a.callbacks[b]=onProcessCrash,l.callbacks[b]=onProcessCrash,v=setTimeout((function(){handleError({msg:"CEE timed out",code:e.ERROR_CODES.TIMEOUT,timeout:f,duration:Date.now()-y,err:new Error("CEE timed out")})}),f);for(var C=0;C<n.length;++C)t.send(n[C]);t.send("fetch "+h,(function onFetchDone(e){_||(cleanup(),m(e,n))}),(function onFetchStream(n){n.indexOf("info string CEEError")>=0?handleError({msg:"CEE crashed with error code",code:e.ERROR_CODES.ERROR,log:n.match(/info string CEEError\s*(.*)/)[1],err:new Error(n.match(/info string CEEError\s*(.*)/)[1])}):t.ceeDebug&&n.indexOf("not recognized")>=0&&handleError({msg:"CEE received unknown UCI option (engine.ceeDebug mode on)",option:n,code:e.ERROR_CODES.NONFATAL_ERROR,err:new Error(n)})}))}n.onError=a=createInterruptHook(n.onError),n.onSignal=l=createInterruptHook(n.onSignal),t.fetch=function(t,n,a){var l,f;l=(t=t||[]).action||"analysis",Array.isArray(t)?f=t:(f=t.uciCommands?t.uciCommands.map((function(e){return e})):[],t.startFen&&(t.options=t.options||{},void 0===t.options.ScoreWhiteToMove&&(t.options.ScoreWhiteToMove=!0),void 0===t.options.SerializeLikeCEAC&&(t.options.SerializeLikeCEAC=!0),e.CEE_LIB.addOptions(f,t.options),e.CEE_LIB.addVariant(f,t.variant),e.CEE_LIB.addPosition(f,t.startFen)),e.CEE_LIB.addVariations(f,t.evals&&t.evals[0]),e.CEE_LIB.addVariations(f,t.threats&&t.threats[0],"threat-variation"),(t.moves||[]).forEach((function(n,a){var l=a+1;e.CEE_LIB.addPush(f,n),e.CEE_LIB.addVariations(f,t.evals&&t.evals[l]),e.CEE_LIB.addVariations(f,t.threats&&t.threats[l],"threat-variation")}))),analyze(f,l,n,a)},t.fetch.setTimeout=function(e){f=e},e.ERROR_CODES={TIMEOUT:1,CRASH:2,ERROR:3,NONFATAL_ERROR:4}}(_,p),_.ceeVersion=function(){return JSON.parse(JSON.stringify(S))}),(g=createWorker(p,_)).onmessage=function onmessage(t){var n,a,l,f,m;if(t.indexOf("\n")>-1)for(f=t.split("\n"),m=0;m<f.length;m+=1)onmessage(f[m]);else if(e.log&&console.log("debug (onmessage): "+t),_.stream&&_.stream(t),b.length&&0!==t.indexOf("No such option")&&0!==t.indexOf("Stockfish")&&0!==t.indexOf("Komodo")&&0!==t.indexOf("Explanation Engine")&&0!==t.indexOf("info string variant")){if(a=function determineQueueNum(e,t){var n,a,l,f,p=getFirstWord(e);for(n="uciok"===p||"option"===p?"uci":"readyok"===p||"ready"===p?"isready":"json"===p||e.indexOf("info string CEEError")>=0?"fetch":"bestmove"===p||"info"===p?"go":"other",f=t.length,l=0;l<f;l+=1)if((a=getFirstWord(t[l].cmd))===n||"other"===n&&("d"===a||"eval"===a))return l;return 0}(t,b),(l=b[a]).stream&&!l.discard&&l.stream(t),void 0===l.message?l.message="":""!==l.message&&(l.message+="\n"),l.message+=t,0===t.indexOf("uciok"))_.name=function parseEngineName(e){var t=e.match(/id name ((\S+) ([\d.a-z]+).*)/i);if(t)return{all:t[1].trim(),short:t[2],version:t[3],full:t[2]+" "+t[3],wasm:/ wasm/i.test(e),multithreaded:/ multithreaded/i.test(e)}}(l.message),n=!0;else if(0===t.indexOf("ready"))n=!0;else if(0!==t.indexOf("bestmove")&&"bestmove"!==getFirstWord(t)||"bench"===l.cmd)if("d"===l.cmd)0!==t.indexOf("Legal uci moves")&&0!==t.indexOf("Key is")||(l.done=!0,n=!0);else if(0===l.cmd.indexOf("fetch"))try{0===l.message.indexOf("json ")&&(l.message=JSON.parse(l.message.replace(/^json /gm,"").replace(/\n/g,""))),n=!0}catch(v){}else"eval"===l.cmd?h.test(l.message)&&(n=!0):(0===t.indexOf("pawn key")||0===t.indexOf("Nodes/second")||0===t.indexOf("Unknown command"))&&(n=!0);else n=!0,l.message=t;n&&(b.splice(a,1),l.cb&&!l.discard?l.cb(l.message):l.ondiscard&&l.ondiscard())}else if(p.ceeMode&&0===t.indexOf("Explanation Engine")){var g=t.match(/Explanation Engine\s*([0-9]+)\.([0-9]+)/);S={date:g[1],increment:g[2]}}},p.book&&(_.book=p.book,_.bookLoaded=!0,_.pathToBook=p.pathToBook),_.getFenFromMoves=e.getFenFromMoves,_.getLegalMoves=e.getLegalMoves,_.getPositionInfo=e.getPositionInfo,_.isFenValid=e.isFenValid,_.ready=!1,function startUp(){_.uci((function onstart(){p.settings&&Object.keys(p.settings).forEach((function oneach(e){_.setoption(e,p.settings[e])})),_.ready=!0,cbIfReady()}))}(),!_.book&&p.pathToBook&&_.loadBook(p.pathToBook,cbIfReady),_)}},a=function(){var e,a=n(),l="rnbqkbnr/pppppppp/8/8/8/8/PPPPPPPP/RNBQKBNR w KQkq - 0 1",f=252,p={4:"p",5:"P",6:"p",8:"n",9:"N",10:"n",16:"b",17:"B",18:"b",32:"r",33:"R",34:"r",64:"q",65:"Q",66:"q",128:"k",129:"K",130:"k"},h=512,m="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789!?{~}(^)[_]@#$,./&-*++=",g="qnrbkp";function decodeTCN(e){var t,n,a,l,f=e.length,p=[];for(t=0;t<f;t+=2)l={},n=m.indexOf(e[t]),(a=m.indexOf(e[t+1]))>63&&(l.promotion=g[Math.floor((a-64)/3)],a=n+(n<16?-8:8)+(a-1)%3-1),n>75?l.drop=g[n-79]:l.from=m[n%8]+(Math.floor(n/8)+1),l.to=m[a%8]+(Math.floor(a/8)+1),p.push(l);return p}function uciToObj(e){var t,n,a=e.split(" "),l=a.length,f=[];if(e)for(t=0;t<l;++t)4===(n=a[t]).length?"@"===n[1]?f.push({drop:n[0].toLowerCase(),to:n.substr(2,2)}):f.push({from:n.substr(0,2),to:n.substr(2,2)}):f.push({from:n.substr(0,2),to:n.substr(2,2),promotion:n[4]});return f}function isSameMove(e,t){return!(e.san!==t.san&&(e.to!==t.to||e.from!==t.from&&(e.from||t.from)||e.promotion!==t.promotion&&(e.promotion||t.promotion)||e.drop!==t.drop&&(e.drop||t.drop)))}function getPremoves(e,t,a){var l,f,p,h,m,g,v,y,_,b,C=[],S=1,k=8,w=1,T=8,P={verbose:!0};for(_=3-(b=e.turn()),(h=n("/",t)).turn(_),a&&(S=k=+a[1],w=T=a.charCodeAt(0)-96),l=S;l<=k;++l)for(f=w;f<=T;++f)m=String.fromCharCode(f+96)+l,(p=e.get(m))&&p.color===_&&(h.put(p,m,!0),"p"===p.type?(g=String.fromCharCode(f-1+96)+(l+(1===_?1:-1)),v=String.fromCharCode(f+1+96)+(l+(1===_?1:-1)),h.put({type:"n",color:b},g,!0),h.put({type:"n",color:b},v,!0)):"k"===p.type&&"-"!==(y=e.fen().split(" ")[2])&&h.load(h.fen().replace(/^(\S+\s\S\s)(\S+)/,"$1"+y),t,!0,!0),C=C.concat(h.moves(P)),h.remove(m,!0),"p"===p.type&&(h.remove(g,!0),h.remove(v,!0)));return t&&e.hand()&&(h._hand[_]=18721,C=C.concat(h.moves({verbose:!0}).filter((function(e){return!a||e.to===a})))),C.forEach((function(e){normalizeMoveObj(e)})),C}function makePremove(e,t){var n,l,f,p,h,m=e.header().Variant,g=getPremoves(e,m,t.from),v=3-e.turn();for(n=g.length-1;n>=0;--n)if(isSameMove(l=g[n],t)){f=!0;break}return f?(l.drop?e.put({type:l.drop,color:v},l.to):(p=e.remove(l.from,!0),l.flags===a.FLAGS.KSIDE_CASTLE?(h=e.remove("Chess960"===m?l.to:"h"+l.from[1],!0),e.put(p,"g"+l.from[1],!0),e.put(h,"f"+l.from[1])):l.flags===a.FLAGS.QSIDE_CASTLE?(h=e.remove("Chess960"===m?l.to:"a"+l.from[1],!0),e.put(p,"c"+l.from[1],!0),e.put(h,"d"+l.from[1])):(l.promotion&&(p.type=l.promotion,p.promoted=!0),h=e.get(l.to),e.put(p,l.to,"k"!==p.type&&"r"!==p.type&&(!h||h.color!==v||"r"!==h.type)))),l):t.from&&(e.turn(v),t=e.fixMove(t),e.turn(3-v),t)?makePremove(e,{san:t,from:t.from}):void 0}function getPieces(e,t){var n,a,l,g=t?{}:[],v=e._board();if(t)for(n=112;n>=0;++n)136&n&&(n-=24),(a=v[n])&&(g[l=m[7&n]+(8-(n>>4))]={type:p[a&f],color:3&a,promoted:0!=(a&h),square:l});else for(n=112;n>=0;++n)136&n&&(n-=24),(a=v[n])&&g.push({type:p[a&f],color:3&a,promoted:0!=(a&h),rank:8-(n>>4),file:1+(7&n)});return g}function makeMoves(e,t,n,a){var l,f,p,h,m,g,v,y,_,b;for(n=n||{},"string"==typeof t&&(t=t.trim().split(" ")),p=t.length,l=0;l<p;l+=1){if(m="b"===t[l].board||"B"===t[l].board?e.siblingGame:e,g="string"==typeof t[l].moveLan?uciToObj(t[l].moveLan)[0]:"string"==typeof t[l]?uciToObj(t[l])[0]:t[l].san?t[l].san:t[l],!m.move(g)){if(!n.autoPromote){if(n.skipBadLines)break;return!1}if(!0===n.autoPromote?g.promotion="q":g.promotion=n.autoPromote,!m.move(g)){if(n.skipBadLines)break;return!1}}if(y=(v=m._history())[v.length-1],a&&(_=parseInt(a[l],10)),("number"!=typeof _||isNaN(_))&&(_=parseInt(t[l].time,10)),"number"!=typeof _||isNaN(_)||(y.time=_,_=void 0),t[l].firstComment&&(v.initComment=t[l].firstComment),t[l].comment&&(y.comment=t[l].comment),t[l].annotation&&(y.annotation=t[l].annotation),t[l].additionalAnnotation&&(y.additionalAnnotation=t[l].additionalAnnotation),t[l].commands&&(y.commands=t[l].commands),t[l].lines)for(h=t[l].lines.length,f=0;f<h;++f){if(b=e._history().id,e.createVariation(),!makeMoves(e,t[l].lines[f],n)&&!n.skipBadLines)return!1;e.selectLine(b)}}return!0}function extendChess(e){var t,f,p,h,m=-1,g=0;function swapMoveAttributes(e,t){var n={moveTime:e.moveTime,firstComment:e.firstComment,comment:e.comment,annotation:e.annotation,additionalAnnotation:e.additionalAnnotation,commands:e.commands};Object.keys(n).forEach((function(a){e[a]=t[a],t[a]=n[a]}))}e.extended||(e.extended=!0,t={header:e.header,load:e.load,loadPgn:e.loadPgn,createVariation:e.createVariation,undo:e.undo,pgn:e.pgn},e._move=e.move,e.undo=function(){return e.siblingGame?e.deleteBughouseMove(e.curBughouseMove()):e.deletePosition(m,g)},e.getMove=function(n){return n&&("string"==typeof n||n.to&&(n.from||n.drop))&&e._move(n)&&normalizeMoveObj(t.undo())||null},e.premove={queue:h=[],move:function(t){var a;return!(a=makePremove(p=p||n(e.fen(),e.header().Variant),t))||g||m!==e._history().length-1?(h.length||(p=void 0),null):(h.push(a),a)},consume:function(){var t,a,l,f=h.shift();if(f){if(t=e.move(f)){if(p=void 0,a=h.length)for(p=n(e.fen(),e.header().Variant),l=0;l<a;++l)makePremove(p,h[l]);return t}e.premove.cancel()}},moves:function(t){return!g&&m===e._history().length-1&&getPremoves(p||e,e.header().Variant,t)},getPieces:function(t){return getPieces(p||e,t)},fen:function(){return(p||e).fen()},cancel:function(){h.length=0,p=void 0}},e.getPieces=function(t){return getPieces(e,t)},e.material=function(){var t,n,a,l=e.getPieces(),f={imbalance:0,white:{p:8,n:2,b:2,r:2,q:1,count:0},black:{p:8,n:2,b:2,r:2,q:1,count:0}},p={p:1,n:3,b:3,r:5,q:9,k:0};for(t=l.length-1;t>=0;--t)1===l[t].color?(n=f.white,a=f.black):(n=f.black,a=f.white),a[l[t].type]&&--a[l[t].type],n.count+=p[l[t].type];return f.imbalance=f.white.count-f.black.count,f},e.origHistory=e.history,e.history=function(t,n){var a,l,f,p=[],h=e._history(),m=h.length,g=e._lines();for("boolean"==typeof t&&(t={verbose:t}),t=t||{},n&&(t.noParentLines=n),t.toCurrent&&(m=e.ids().move+1);;){if(-1==--m){if(h.id&&!t.noParentLines){m=h.atMoveNode,h=g[h.parentId];continue}break}if(t.verbose){for(l in a={},h[m])if(h[m][l]&&"object"==typeof h[m][l])for(f in a[l]=h[m][l].constructor===Array?[]:{},h[m][l])a[l][f]=h[m][l][f];else a[l]=h[m][l];p.unshift(a)}else p.unshift(h[m].san)}return p},e._getPos=function(n,a){var f,p,h;return"number"!=typeof n&&(n=m),"number"!=typeof a&&(a=g),f=(p=e._lines())[a],n>=0?f[n]:f.id?f.atMoveNode?p[f.parentId][f.atMoveNode-1]:e._getPos(f.atMoveNode-1,f.parentId):(h={fen:t.header().FEN||l,hash:f.hash,initial:!0,ids:{move:-1,line:0}},e.siblingGame&&(h.bughouseOrder=-1),h)},e.move=function(t,n){var a,l,f,p,h=e._history();if(t&&("string"==typeof t||t.to&&(t.from||t.drop))){if(g===h.id&&m<h.length-1||n){if(e.moveForward(n,t))return!0;m<h.length-1&&(e.selectPosition(m+1),e.createVariation(),h=e._history())}e.siblingGame&&(f=e.isDependent?e.siblingGame.fen():e.fen()),(a=e._move(t))&&(normalizeMoveObj(a),g=h.id,l=h[m=h.length-1],p=e._getPos(m-1),e.siblingGame?(l.fen=e.isDependent?e.siblingGame.fen():e.fen(),l.beforeFen=f,l.siblingIds=e.siblingGame.ids()):(l.fen=e.fen(),l.beforeFen=p.fen),p.initial?(l.moveNumber=0,l.previous=null):(l.moveNumber=p.moveNumber+1,l.previous=p.ids),g&&0===m&&e._lines()[h.parentId][h.atMoveNode].move===l.move&&(l.isContinuation=!0),l.flags=a.flags,l.to=a.to,l.from=a.from,l.drop=a.drop,l.capturedStr=a.captured,l.promotion=a.promotion,l.piece=a.piece,a.promoted&&(l.promoted=!0),a.capturedPromotedPawn&&(l.capturedPromotedPawn=!0),l.ids={move:m,line:g})}return a},e.moveDetails=function(t){return(t=t||e._history()[m])&&(t.lines=t.lines||null,t.flags===a.FLAGS.KSIDE_CASTLE?(t.rookFrom="Chess960"===e.header().Variant?t.to:"h"+t.to[1],t.rookTo="f"+t.to[1],t.kingTo="g"+t.to[1]):t.flags===a.FLAGS.QSIDE_CASTLE?(t.rookFrom="Chess960"===e.header().Variant?t.to:"a"+t.to[1],t.rookTo="d"+t.to[1],t.kingTo="c"+t.to[1]):t.flags===a.FLAGS.EP_CAPTURE&&(t.epCapture=t.to[0]+t.from[1])),t},e.header=e.headers=function(n){var a=t.header(n);return e.siblingGame&&extendChess(e.siblingGame),a},e.load=function(n,a,l,f){var p=t.load(n,a,l,f);return e.siblingGame&&extendChess(e.siblingGame),p&&!l&&(m=-1,g=0),p},e.removeEmptyLines=function(){var t,n,a=e._lines();for(t=a.length-1;t>0;--t)a[t].length||(a[t]=void 0,n=!0);n&&e.reorderLines()},e.loadPgn=function(n,a,l){var f=t.loadPgn(n,a,l),p=e._history();return e.removeEmptyLines(),m=p.length-1,(g=p.id)&&e.selectLine(0),f},e.ids=function(){return{move:m,line:g}},e.selectLine=function(t){e.selectPosition(null,t)},e.curBughouseMove=function(){return Math.max(e._getPos().bughouseOrder,e.siblingGame._getPos().bughouseOrder)},e.deleteBughouseMove=function(t){var n,a,l,f=e.curBughouseMove(),p=!1,h=e;if(t>=0)for(f>=t&&e.selectBughouseMove(t-1);;){for(a=(n=h._history()).length,l=0;l<a;++l)if(n[l].bughouseOrder>=t){n.length=l,p=!0;break}if(h===e.siblingGame)break;h=e.siblingGame}return p},e.selectBughouseMove=function(t){var n,a,l=e.isDependent?e.siblingGame:e,f=l;if(-1===t)return f.selectPosition(-1,0,!0),f.siblingGame.selectPosition(-1,0,!0),l.load(l.header().FEN,"Bughouse",!0,!0);for(;;){for(a=(n=f._history()).length-1;a>=0;--a)if(n[a].bughouseOrder===t)return f.selectPosition(n[a].ids.move,0,!0),f.siblingGame.selectPosition(n[a].siblingIds.move,0,!0),l.load(n[a].fen,"Bughouse",!0,!0);if(f===l.siblingGame)return!1;f=l.siblingGame}},e.moveBackward=function(t){var n;if(e.siblingGame)return e.selectBughouseMove(e.curBughouseMove()-1);if(m<=1)if(0===g){if(-1===m)return!1;e.selectPosition(m-1)}else(n=e._getPos(m-1,g)).isContinuation&&!t&&(n=e._getPos(n.ids.move-1,n.ids.line),n=e._getPos(n.ids.move+1,n.ids.line)),e.selectPosition(n.ids.move,n.ids.line);else e.selectPosition(m-1);return!0},e.moveForward=function(t,n){var a,l,f,p,h,v,y=e._lines();if(e.siblingGame)return e.selectBughouseMove(e.curBughouseMove()+1);if("string"==typeof n&&(n={san:n}),!(a=y[g][m+1])||n&&!isSameMove(n,a)){if(n&&a&&a.lines)for(h=a.lines.length,p=0;p<h;++p)if((f=y[a.lines[p]][0])&&isSameMove(n,f)){a=f,v=!0;break}if(!v&&t&&(l=y[g][m])&&l.lines)for(h=l.lines.length,p=0;p<h;++p)if((f=y[l.lines[p]][0])&&f.isContinuation&&(f=y[l.lines[p]][1])&&(!n||isSameMove(n,f))){a=f,v=!0;break}if(!v){try{if(n&&n.san&&(n=e.fixMove(n.san))||n&&n.to&&n.from&&Math.abs(n.to.charCodeAt(0)-n.from.charCodeAt(0))>1&&(n=e.fixMove(n)))return e.moveForward(t,n)}catch(_){}return!1}}return e.selectPosition(a.ids.move,a.ids.line)},e.moveVariation=function(t,n){var a,l,f,p=e._lines(),h=p[t];if(h&&h.id)for(l=(a=p[h.parentId][h.atMoveNode].lines).length-1;l>=0;--l)if(a[l]===t&&a[f=l-(n?1:-1)])return a[l]=a[f],a[f]=t,e.reorderLines(),!0;return!1},e.promoteVariation=function(t,n){for(var a,l,f,p,h,v,y=e._lines(),_=y[t];_&&_[0]&&_.id&&(-1!==n||_.parentId);){for(a=y[f=_.parentId],p=_.atMoveNode,_[0].lines=a[p].lines.concat(_[0].lines||[]),a[p].lines=void 0,v=a.length-p,l=a.splice(p,v),h=0;h<v;++h)l[h].ids.line=t,l[h].ids.move=h;for(l.id=t,l.parentId=f,l.atMoveNode=p,l.hash=_.hash,0===p?(l.initComment=a.initComment,a.initComment=_.initComment):_.initComment&&(a[p-1].comment=((a[p-1].comment||"")+" "+_.initComment).trim()),y[t]=l,v=_.length,h=0;h<v;++h)_[h].ids.line=f,_[h].ids.move=h+p,a.push(_[h]);for(l[0].isContinuation=!!_[0].isContinuation,a[p].isContinuation=!p&&"number"==typeof a.parentId&&y[a.parentId][a.atMoveNode].move===a[0].move,v=a[p].lines.length,h=0;h<v;++h)y[a[p].lines[h]].atMoveNode=p,y[a[p].lines[h]][0]&&(y[a[p].lines[h]][0].isContinuation=y[a[p].lines[h]][0].move===a[p].move);if(g===t?(g=f,m+=p):g===f&&m>=p&&(g=t,m-=p),1===n)break;_=y[t=f]}return void 0!==a&&(e._history(y[g]),e.reorderLines(),!m&&y[g][0].isContinuation&&e.selectPosition(y[g].atMoveNode,y[g].parentId),!0)},e.reorderLines=function(t,n){var a,l,p,h,m,v,y,_,b,C,S=e._lines(),k=!1;for(t?b=n.length-1:(t=0,n=[S[0]],b=0,f=!1),p=(a=S[t]).length,l=0;l<p;++l)if((h=a[l]).ids.line!==b&&(k=!0,h.ids.line=b),h.lines)for(m=h.lines.length,v=0;v<m;++v)(_=S[y=h.lines[v]])?(_.atMoveNode=l,C=n.length,h.lines[v]=C,_.parentId=b,f||y!==g||(f=!0,g=C),n.push(_),k=e.reorderLines(y,n)||k):(1===h.lines.length?delete h.lines:h.lines.splice(v,1),--v,--m);return t||e.saveLines(n,!0),k},e.createVariation=function(){var n,a,l,f=e._history(),p=e._lines();return m===f.length-1?(n=t.createVariation(),f=e._history(),m=f.length-1,g=f.id,n):-1!==m&&(a=[],l=f[m],a.parentId=f.id,a.id=p.length,l.lines||(l.lines=[]),l.lines.push(a.id),a.hash=e._getPos(m-1).hash,a.atMoveNode=m,p.push(a),e.selectPosition(-1,a.id))},e.selectLineEnd=function(t){return e.siblingGame?e.selectBughouseMove(e._history().length+e.siblingGame._history().length-1):("number"!=typeof t&&(t=g),(t!==g||m<e._history().length-1)&&e.selectPosition(null,t,!0))},e.selectLineStart=function(){var t,n;return e.siblingGame?e.selectBughouseMove(-1):g?(m>1||1===m&&!e._getPos(0).isContinuation?t=e._history():(n=e._getPos(-1),t=e._lines()[n.ids.line]),e.selectPosition(t.id?t[1]&&t[0].isContinuation?1:0:-1,t.id)):-1!==m&&e.selectPosition(-1,0)},e.selectPosition=function(n,a,l){var f=e._lines(),p=e._history();if("number"==typeof a&&(a!==g||l)){if(a<0||a>=f.length)return!1;if(p=f[a],"number"!=typeof n)n=p.length-1;else if(n<-1||n>=p.length)return!1;g=a,e._history(p),l=!0}if("number"==typeof n&&(n!==m||l)){if(n<-1||n>=p.length)return!1;t.load(e._getPos(n).fen,t.header().Variant,!0,!0),m=n}return!0},e.resetToMainLine=function(){var t=e._lines();e.selectLineEnd(0),t.length>1&&(t.length=1,e.reorderLines())},e.updateNode=function(t,n,a){var l,f,p=e._lines();for(f in n="number"==typeof n?n:m,l=p[a="number"==typeof a?a:g][n]||p[a],t)l[f]=t[f]},e.updateLineComment=function(t,n){e.updateNode({initComment:t},-1,n)},e.saveLines=function(t,n){var a,l,f,p=e._lines(),h=t.length;for(t!==p&&(p.length=0),l=0;l<h;++l){if(a=t[l],l&&"number"!=typeof a.parentId)return!1;t!==p&&p.push(a),a.id=l}return e._history(e._history()),n||(f=e.ids(),e.selectPosition(-1,0,!0),e.selectPosition(f.move,f.line)),!0},e.deletePosition=function(t,n){var a,l,f=e._lines();return!(!f[n]||!(f[n][t]||-1===t&&0!==n))&&(n&&(0===t||1===t&&f[n][0].isContinuation)&&(t=-1),g>0&&n!==g?(a=function descendsFromMove(e,t,n){for(var a,l=e[t];"number"==typeof(a=l.parentId);){if(a===n)return l.atMoveNode;l=e[a]}return!1}(f,g,n),l=!1!==a&&a>=t):l=n===g&&t<=m,l&&(t>1?e.selectPosition(t-1,n):(e.selectPosition((f[n][0].isContinuation||1===t)&&f[n][1]?1:0,n),e.moveBackward())),t>0?f[n].length=t:n?f[n]=null:f[0].length=0,e.reorderLines(),e.ids())},e.mark=function(t,n){var a=m<0?e._lines()[g]:e._lines()[g][m],l=t.type,f=1;t.color&&("arrow"===l?e.mark({key:t.color+t.key,type:"cal"},n):"square"===l&&e.mark({key:t.color+t.key,type:"csl"},n)),"cal"!==l&&"csl"!==l&&(l="c_"+l,f=0),a.commands&&a.commands[l]&&(a.commands[l]=a.commands[l].split(",").filter((function rm(e){return e.slice(f).split(";")[0]!==t.key.slice(f)})).join(","),a.commands[l]||delete a.commands[l]),n||(a.commands||(a.commands={}),a.commands[l]=(a.commands[l]?a.commands[l]+",":"")+t.key+(t.data?";"+t.data.join(";"):""))},e.markings=function(){var t,n,a,l,f,p,h,v,y={},_=m<0?e._lines()[g]:e._lines()[g][m],b={cal:"arrow",csl:"square"};for(n in _.commands){if(a=_.commands[n],b[n])n=b[n],l=0;else{if("c_"!==n.substr(0,2))continue;n=n.slice(2),l=1}for(y[n]=y[n]||{},p=(f=a.split(",")).length,t=0;t<p;++t)l?(v=(h=f[t].split(";")).shift(),y[n][v]=y[n][v]||{type:n,key:v},y[n][v].data=h):(v=f[t].slice(1),y[n][v]=y[n][v]||{type:n,key:v},y[n][v].color=f[t][0])}return y},e.clearMarkings=function(){var t,n=m<0?e._lines()[g]:e._lines()[g][m];for(t in n.commands)/^c[sa]l$|^c_/.test(t)&&delete n.commands[t]},e.pgn=function(n){var a,l=e.ids();return e.selectLineEnd(0),a=t.pgn(n),e.selectPosition(l.move,l.line),a},e.loadMoves=function(t,n){var a,l,f,p,h;if(n=n||{},"string"==typeof t&&(t=decodeTCN(t)),t){for(n.atCurrent||e.selectPosition(-1,0),f=g,l=t.length,a=0;a<l;++a){if(!((p=e.move(t[a],!0))||(t[a].promotion=!0===n.autoPromote?"q":n.autoPromote,p=e.move(t[a],!0))))return!1;g!==f&&"merge"!==n.method&&(e.promoteVariation(g,1),"promote"!==n.method&&(e._history()[m].lines=void 0,e.reorderLines()),f=g)}if("promote"===n.method){if(l){for(e._history()[m+1]&&(p=e._history()[m],e.createVariation(),e.move(p),swapMoveAttributes(e._history()[0],p),e.promoteVariation(g,1)),a=(h=e._lines()).length-1;a>=0;--a)1===h[a].length&&h[a][0].isContinuation&&(swapMoveAttributes(h[a][0],h[h[a].parentId][h[a].atMoveNode]),h[a].length=0);e.removeEmptyLines()}}else"merge"!==n.method&&e.deletePosition(m+1,g)}return!0})}function createGame(e){var t,a;if((e=e||{}).game)return e.game;if(t=n(),e.analysis&&extendChess(t),e.disableHashing&&t.hashing(!1),e.pgn){if(!(t.loadPgn(e.pgn,e.index,e.options)||"detect"===e.variant&&n.variants.some((function(n){return e.options=e.options||{},e.options.variant=n,t.loadPgn(e.pgn,e.index,e.options)}))))return!1}else{if(e.headers&&(e.variant=e.headers.Variant||e.variant,e.fen||(e.fen=e.headers.FEN)),"detect"===e.variant&&e.fen&&(e.fen.indexOf("|")>-1?e.variant="Bughouse":9===e.fen.split("/").length?e.variant="Crazyhouse":e.fen.indexOf("+")>-1?e.variant="3-check":e.variant=void 0),(e.fen||e.variant)&&!t.load(e.fen||l,e.variant))return!1;e.headers&&"object"==typeof e.headers&&!Array.isArray(e.headers)&&t.header(e.headers)}if(e.tcn)if("object"==typeof e.tcn){if(!function playBughouseTCN(e,t,n){var a,l,f,p=[decodeTCN(t[0]),decodeTCN(t[1])],h=[0,0],m=[0,0],g=p[0].length+p[1].length,v=Math.max(0|n[0][0],0|n[0][1],0|n[1][0],0|n[1][1]),y=[0,0],_=[0,0];for(a=[[v+=600-v%600,v],[v,v]];g--;){if(_[0]=y[0]+a[0][m[0]]-n[0][h[0]]||0,_[1]=y[1]+a[1][m[1]]-n[1][h[1]]||0,p[l=_[0]<=_[1]?0:1][h[l]]||(l^=1),(!(f=l?e.siblingGame:e).move(p[l][h[l]])||g&&f.inCheckmate()&&f.undo(!0))&&!(f=(l^=1)?e.siblingGame:e).move(p[l][h[l]]))return!1;f._history()[h[l]].time=n[l][h[l]],a[l][m[l]]=n[l][h[l]],y[l]=_[l],m[l]^=1,++h[l]}return!0}(t,e.tcn,e.timestamps||[[],[]]))return!1}else a=decodeTCN(e.tcn);else a=e.moves;return!(a&&!makeMoves(t,a,e,e.timestamps))&&t}function normalizeMoveObj(e){return e&&(e.piece&h&&(e.promoted=!0),e.piece=p[e.piece&f],e.captured&&(e.captured&h&&(e.capturedPromotedPawn=!0),e.captured=p[255&e.captured]),e.promotion&&(e.promotion=p[e.promotion&f]),void 0!==e.drop&&(e.drop="pnbrq"[e.drop])),e}function normalizeHistory(e){var t,n,a,l,f,p,h,m=e.history(!0,!0);if(e.siblingGame){for(t=e.siblingGame.history(!0,!0),a=m.length+t.length,n=[],l=0;l<a;++l)!m.length||t.length&&t[0].bughouseOrder<m[0].bughouseOrder?(f=t.shift()).board="b":(f=m.shift()).board="a",n.push(f);m=n}for(a=m.length,l=0;l<a;++l)if((p=m[l]).fen||normalizeMoveObj(p),p.lines)for(h=p.lines.length-1;h>=0;--h)e.selectLine(p.lines[h]),p.lines[h]=normalizeHistory(e).moves;return{moves:m}}function getLegalMoves(e,t){var n,l,f,p;if("string"==typeof e){if((l=a).reset(),!l.load(e,t))return null}else l=createGame(e);for(p=(n=l.moves({verbose:!0})).length,f=0;f<p;++f)normalizeMoveObj(n[f]);return n}function jce(t,n){return(e=e||ENGINE_MANAGER(jce))(t,n)}return jce.supportsMultithreading=function(){var e,t=Boolean(jce._hasThreads);if("boolean"!=typeof jce._hasThreads){try{(e=new Worker("data:application/javascript,")).postMessage(new SharedArrayBuffer(1)),t=!0}catch(n){}try{e.terminate()}catch(n){}jce._hasThreads=t}return t},jce.gameFingerprints=function gameFingerprints(e){var n,a,f,p,h,m,g,v,y,_=createGame(e),b=[""],C=[];if(!_)return!1;for(y=(v=_.header()).Variant||"",m=_.hashes(),n="function"==typeof _.origHistory?_.origHistory(!0):_.history(!0),h=m.length,a=[m[0][0],m[0][1]],C.push(t.to64BitHex(a)+y),m[0]=t.to64BitHex(m[0]),f=1;f<h;++f)a[0]=(a[0]^m[f][0]*(f+58465))>>>0,a[1]=(a[1]^m[f][1]*(f+984))>>>0,m[f]=t.to64BitHex(m[f]),C.push(t.to64BitHex(a)+y),normalizeMoveObj(n[p=f-1]),g=(n[p].from?n[p].from:n[p].drop.toUpperCase()+"@")+n[p].to+(n[p].promotion||""),p&&(g=b[p]+" "+g),b.push(g);return{startingFen:v.FEN||l,hashes:m,fingerprints:C,moves:b,variant:v.Variant}},jce.getFenFromMoves=function getFenFromMoves(e,t,n){return a.reset(),a.load(e,n),!(t&&!makeMoves(a,t))&&a.fen()},jce.getLegalMoves=getLegalMoves,jce.getPositionInfo=function getPositionInfo(e,t,n){var l,f,p={gameOver:!1,check:!1,checkmate:!1,draw:!1,stalemate:!1,threefold:!1,insufficient:!1};if(Array.isArray(t)||(n=t,t=null),"boolean"==typeof n?(l=n,n={}):l=(n=n||{}).variant,"string"==typeof e){if((f=a).reset(),0!==f.validateFen(e,l)||!f.load(e,l))return!1}else f=createGame(e);return!(t&&!makeMoves(f,t))&&(n.getLegalMoves&&(p.legalMoves=getLegalMoves({game:f})),f.inCheck()?(p.check=!0,p.checkmate=f.inCheckmate()):p.stalemate=f.inStalemate(),p.threefold=f.inThreefoldRepetition(),p.insufficient=f.insufficientMaterial(n.color),p.fiftyMoveRule=f.in50MoveRule(),p.draw=p.stalemate||p.threefold||p.insufficient||p.fiftyMoveRule||f.inDraw(),n.skipValidation||(p.isValid=f.isPositionValid(n)),l&&(p.variantWin=f.isVariantWin(),void 0===p.variantWin&&(p.variantWin=f.isBughouseWin())),p.gameOver=p.checkmate||p.draw||Boolean(p.variantWin),p)},jce.isFenValid=function isFenValid(e,t){return 0===a.validateFen(e,t)},jce.encodeTCN=function encodeTCN(e){var t,n,a,l,f="";for(Array.isArray(e)||(e=[e]),n=e.length,t=0;t<n;t+=1)a=e[t].drop?79+g.indexOf(e[t].drop):m.indexOf(e[t].from[0])+8*(e[t].from[1]-1),l=m.indexOf(e[t].to[0])+8*(e[t].to[1]-1),e[t].promotion&&(l=3*g.indexOf(e[t].promotion)+64+(l<a?9+l-a:l-a-7)),f+=m[a]+m[l];return f},jce.decodeTCN=decodeTCN,jce.uciToObj=uciToObj,jce.generatePgn=function generatePgn(e){var t;return(e=e||{}).disableHashing=!0,!!(t=createGame(e))&&t.pgn(e)},jce.pgnToFen=function pgnToFen(e,t){var n,l,f=[];if(a.reset(),!a.loadPgn(e))return!1;if(n=a.moveCount(),"number"==typeof t){for(t<0&&(t=n+t+1),l=n-1;l>=t&&l>=0;l-=1)a.undo();return a.fen()}for(l=0;l<=n;l+=1)f.unshift(a.fen()),a.undo();return f},jce.pgnToJson=function pgnToJson(e,t,n){var l,f=[],p=a;return"number"!=typeof t&&(n=t,t=void 0),l=p.tokenizePgn(e,n),t<0&&(t=l.length+t),!!l&&(n&&n.includeFen&&(p=createGame({analysis:!0})),l.forEach((function(e,a){var l,h;a===t||void 0===t?p.loadPgn([e],0,n)?(h=normalizeHistory(p),l=p.header(),f.push({headers:l,moves:h.moves})):f.push(!1):f.push(void 0)})),"number"==typeof t?f[t]:f)},jce.sanToObj=function sanToObj(e,t,n){return a.reset(),!!a.load(t,n)&&normalizeMoveObj(a.move(e))},jce.completeFen=a.completeFen,jce.shortenFen=function shortenFen(e,t){return a.completeFen(e).split(" ").slice(0,t||4).join(" ")},jce.createGame=createGame,jce.getPositionDetails=function getPositionDetails(e,t){var n,a,l,f;if((e=e||{}).disableHashing=!0,!(n=createGame(e)))return null;if(t){if(!(l=n.move(t)))return null;n.extended||normalizeMoveObj(l)}return f=n.fen(),e.skipValidation||n.isPositionValid(e)?(a=f.split(" "),{fen:f,pieces:getPieces(n),sideToMove:n.turn(),castling:a[2],epSquare:"-"===a[3]?null:a[3],halfMoves:+a[4],moveNumber:+a[5],move:l,hand:n.hand(),checks:n.checks()}):null},jce.predict=function predict(e,t){var n=Math.min(Math.max(.20773843*Math.atan(2.49085889*e/100-2.47841945*t/100)+.02262979*e/100-.02256839*t/100+.52239679,0),1),a=Math.min(Math.max(-.20720905*Math.atan(2.49626837*e/100-2.48220286*t/100)+-.02352551*e/100+.02172627*t/100+.49443923,0),1),l=Math.min(Math.max(Math.exp(.037043456*e/100+.178106427*t/100-8.069742932)+.004823544*Math.exp(-1.364136591*Math.pow(e/100-t/100,2))+-.001625539,0),1),f=n+a+l;return{w:n/f,b:a/f,d:l/f}},jce.normalizeMoveObj=normalizeMoveObj,jce.FLAGS=a.FLAGS,jce.loadECO=function loadECO(e,n){t.loadBook(e,(function onload(e,a){if(!a||!a.json)return n(e||new Error("Invalid book"));n(e,(function queryECO(e){var n,l,f,p,h,m,g,v,y;if(e.hash)l="string"==typeof e.hash?[t.hex64ToDec(e.hash)]:[e.hash],p=1;else{if(!(n=createGame(e)))return!1;p=(l=n.hashes()).length}for(f=0;f<p;++f)if(h=a.json[t.to64BitHex(l[f])]){if(h.constructor===Array)if(m&&-1===h[0].m.indexOf(m.m)){for(v=h.length-1;v>=0;--v)if(!v||-1!==h[v].m.indexOf(m.m)){(y=h[v]).e=h[0].e,y.s=h[0].s,y.mate=h[0].mate,y.v=h[0].v,y.h=h[0].h,y.n=y.n||h[0].n,y.u=y.u||h[0].u,y.c=y.c||h[0].c;break}}else y=h[0];else y=h;(y.n||e.allowNameless)&&(m=y)}else e.mustEndInBook&&(m=void 0);if(m)return g={name:m.n},m.m&&(g.moves=m.m),void 0!==m.d&&(g.sdiff=m.d/100),m.c&&(g.code=m.c,g.url=m.u||m.n.replace(/[\u00e1-\u00e5]/g,"a").replace(/[\u0107\u010d]/g,"c").replace(/[\u00e9\u00e8\u0117\u0113]/g,"e").replace(/[\u00f3\u00f6\u00f8]/g,"o").replace(/[\u016f\u00fc]/g,"u").replace(/['+,]/g,"").replace(/[^a-z0-9.]+/gi,"-").replace(/(with-\d|St)\.+-?/,"$1-")),m.e?(g.eval=m.e,g.depth=m.h,g.score=m.e[0].cp/100,void 0!==m.e[0].mate&&(g.mate=m.e[0].mate)):(g.score=m.s/100,void 0!==m.mate&&(g.mate=m.mate)),m.v&&(g.bad=!0),g}),a.json)}))},jce.CEE_LIB={addOptions:function(e,t){for(var n in t)void 0!==t[n]&&e.push("setoption name "+n+" value "+t[n]);return e},addVariations:function(e,t,n){var a,l;t=t||[],n=n||"variation";for(var f=0;f<t.length;++f)(a=t[f]).pv=Array.isArray(a.pv)&&a.pv.join(" ")||a.pv||"",l=n+" "+a.pv,"number"==typeof a.mateIn?l+=" mate "+a.mateIn:"number"==typeof a.mate?l+=" mate "+a.mate:l+=" cp "+Math.round(a.cp),"number"==typeof a.depth&&(l+=" depth "+a.depth),e.push(l);return e},addPush:function(e,t){var n;return"string"==typeof t&&(t={moveLan:t}),n="push "+t.moveLan,t.isBook&&(n+=" isBook"),t.isRetry&&(n+=" isRetry"),e.push(n),e},addPosition:function(e,t){return e.push("position fen "+t),e},addVariant:function(e,t){return"chess960"===String(t).toLowerCase().replace(/ |-/g,"")?(e.push("setoption name UCI_Variant value chess"),e.push("setoption name UCI_Chess960 value "+!0)):(e.push("setoption name UCI_Variant value chess"),e.push("setoption name UCI_Chess960 value "+!1)),e}},jce}();
/*!
 * Chess.com (c) 2020
 *
 * A distant fork of chess.js - BSD (c) 2014, Jeff Hlywa (jhlywa@gmail.com)
 */e.exports=a}();
/*!
 * Chess.com (c) 2020 | all rights reserved
 */
/*!
 * A distant fork of chess.js - BSD (c) 2014, Jeff Hlywa (jhlywa@gmail.com)
 */},4713:function(e,t,n){"use strict";function _arrayLikeToArray(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,a=new Array(t);n<t;n++)a[n]=e[n];return a}function _toConsumableArray(e){return function _arrayWithoutHoles(e){if(Array.isArray(e))return _arrayLikeToArray(e)}(e)||function _iterableToArray(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function _unsupportedIterableToArray(e,t){if(e){if("string"==typeof e)return _arrayLikeToArray(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Object"===n&&e.constructor&&(n=e.constructor.name),"Map"===n||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?_arrayLikeToArray(e,t):void 0}}(e)||function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function _typeof(e){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},_typeof(e)}function _defineProperties(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function _assertThisInitialized(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function _setPrototypeOf(e,t){return _setPrototypeOf=Object.setPrototypeOf||function _setPrototypeOf(e,t){return e.__proto__=t,e},_setPrototypeOf(e,t)}function _possibleConstructorReturn(e,t){if(t&&("object"===_typeof(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return _assertThisInitialized(e)}function _getPrototypeOf(e){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf:function _getPrototypeOf(e){return e.__proto__||Object.getPrototypeOf(e)},_getPrototypeOf(e)}function _isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}function _construct(e,t,n){return _construct=_isNativeReflectConstruct()?Reflect.construct:function _construct(e,t,n){var a=[null];a.push.apply(a,t);var l=new(Function.bind.apply(e,a));return n&&_setPrototypeOf(l,n.prototype),l},_construct.apply(null,arguments)}function _wrapNativeSuper(e){var t="function"==typeof Map?new Map:void 0;return _wrapNativeSuper=function _wrapNativeSuper(e){if(null===e||!function _isNativeFunction(e){return-1!==Function.toString.call(e).indexOf("[native code]")}(e))return e;if("function"!=typeof e)throw new TypeError("Super expression must either be null or a function");if(void 0!==t){if(t.has(e))return t.get(e);t.set(e,Wrapper)}function Wrapper(){return _construct(e,arguments,_getPrototypeOf(this).constructor)}return Wrapper.prototype=Object.create(e.prototype,{constructor:{value:Wrapper,enumerable:!1,writable:!0,configurable:!0}}),_setPrototypeOf(Wrapper,e)},_wrapNativeSuper(e)}function defineProperty_defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function _classCallCheck(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function asyncGeneratorStep(e,t,n,a,l,f,p){try{var h=e[f](p),m=h.value}catch(g){return void n(g)}h.done?t(m):Promise.resolve(m).then(a,l)}function asyncToGenerator_asyncToGenerator(e){return function(){var t=this,n=arguments;return new Promise((function(a,l){var f=e.apply(t,n);function _next(e){asyncGeneratorStep(f,a,l,_next,_throw,"next",e)}function _throw(e){asyncGeneratorStep(f,a,l,_next,_throw,"throw",e)}_next(void 0)}))}}n.d(t,{Hn:function(){return h},eI:function(){return createClient},BL:function(){return createCollection},kr:function(){return createContext},ko:function(){return createExtension},QB:function(){return initApp},tL:function(){return initController},DP:function(){return initControllers},Uc:function(){return updateModel}});var a=n(7757),l=n.n(a),f=n(3182),p=n(2866);function _createSuper(e){var t=function dist_isNativeReflectConstruct(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(e){return!1}}();return function _createSuperInternal(){var n,a=_getPrototypeOf(e);if(t){var l=_getPrototypeOf(this).constructor;n=Reflect.construct(a,arguments,l)}else n=a.apply(this,arguments);return _possibleConstructorReturn(this,n)}}function createClient(e){return Object.keys(e).forEach((function(t){"function"==typeof e[t]&&(e[t]=e[t].bind(e))})),e}function _initClient(){return(_initClient=asyncToGenerator_asyncToGenerator(l().mark((function _callee2(e,t){return l().wrap((function _callee2$(n){for(;;)switch(n.prev=n.next){case 0:return n.prev=0,n.next=3,e.init(t);case 3:n.next=8;break;case 5:n.prev=5,n.t0=n.catch(0),console.error(n.t0);case 8:case"end":return n.stop()}}),_callee2,null,[[0,5]])})))).apply(this,arguments)}var h=function Model(){_classCallCheck(this,Model)};function updateModel(e,t){(function getModelProperties(e){return Object.getOwnPropertyNames(e).filter((function(e){return"__ob__"!==e}))})(t).forEach((function(n){n in e&&(e[n]instanceof h&&t[n]?updateModel(e[n],t[n]):function isCollectionLike(e){return Boolean(e instanceof Array&&"options"in e&&"ModelFactory"in e)}(e[n])&&t[n]instanceof Array?t[n].forEach((function(t,a){var l=e[n][a];l instanceof h?updateModel(l,t):e[n].add(t)})):function hasChanged(e,t){return e instanceof Array&&t instanceof Array&&e.length===t.length?0!==e.length&&e.some((function(e,n){return e!==t[n]})):e!==t}(e[n],t[n])&&(e[n]=t[n]))}))}var m=function(e){!function _inherits(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&_setPrototypeOf(e,t)}(Collection,e);var t=_createSuper(Collection);function Collection(e,n){var a;return _classCallCheck(this,Collection),defineProperty_defineProperty(_assertThisInitialized(a=t.call(this)),"options",void 0),defineProperty_defineProperty(_assertThisInitialized(a),"ModelFactory",void 0),a.options=n,a.ModelFactory=e,a}return function _createClass(e,t,n){return t&&_defineProperties(e.prototype,t),n&&_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}(Collection,[{key:"add",value:function add(e){var t=new this.ModelFactory;return updateModel(t,e),this.push(t),this.options.max&&this.length>this.options.max&&this.splice(0,this.length-this.options.max),t}},{key:"find",value:function find(e){return this[this.findIndex(e)]}},{key:"findIndex",value:function findIndex(e){var t=this;return"function"==typeof e?Array.prototype.findIndex.call(this,e):"object"===_typeof(e)&&null!==e?Array.prototype.findIndex.call(this,(function(n){return t.getKey(n)===t.getKey(e)})):Array.prototype.findIndex.call(this,(function(n){return t.getKey(n)===e}))}},{key:"includes",value:function includes(e){return-1!==this.findIndex(e)}},{key:"update",value:function update(e){var t=this.findIndex(e);if(-1===t)return this.add(e);var n=this[t];return updateModel(n,e),n}},{key:"remove",value:function remove(e){var t=this.findIndex(e);if(-1===t)return null;var n=this[t];return this.splice(t,1),n}},{key:"reset",value:function reset(e){var t=this;if(e&&0!==e.length){var n=e.map((function(e){var n;return e instanceof t.ModelFactory?n=e:updateModel((n=t.find(e))||(n=new t.ModelFactory),e),n}));this.splice.apply(this,[0,this.length].concat(_toConsumableArray(n)))}else this.splice(0)}},{key:"getKey",value:function getKey(e){var t=e[this.options.key];return"function"==typeof t?t.call(e):t}}]),Collection}(_wrapNativeSuper(Array));function createCollection(e,t){var n=new m(e,t);if(["add","find","findIndex","update","remove","includes","reset","getKey"].forEach((function(e){n[e]=m.prototype[e].bind(n)})),t.create)for(var a=0;a<t.create;a++)n.push(new n.ModelFactory);return n}function createExtension(e){return function(t){return Object.assign(e.context,t),e}}function createContext(){return{}}function initController(e){if("function"==typeof e)initController(e());else{if(e instanceof Promise)return e.then((function(e){return initController(e.default)}));if(document.querySelector(e.el))return new Promise((function(t){new(f.default.extend({mounted:t}))(e).$mount()}))}}try{f.default.use(p.ZP)}catch(g){}function mergeArray(e,t){var n=[];return e[t]instanceof Array?n.push.apply(n,_toConsumableArray(e[t])):e[t]&&console.warn("".concat(t," should be array")),e.extensions&&e.extensions.forEach((function(e){e[t]instanceof Array?n.push.apply(n,_toConsumableArray(e[t])):e[t]&&console.warn("extension ".concat(t," should be array"))})),n}function mergeObject(e,t){var n={};return e[t]&&Object.assign(n,e[t]),e.extensions&&e.extensions.forEach((function(e){e[t]&&Object.assign(n,e[t])})),n}function initControllers(e){return Promise.all(e.map(initController))}function initElements(e){return _initElements.apply(this,arguments)}function _initElements(){return(_initElements=asyncToGenerator_asyncToGenerator(l().mark((function _callee3(e){return l().wrap((function _callee3$(t){for(;;)switch(t.prev=t.next){case 0:Object.keys(e).forEach((function(t){customElements.define(t,e[t])}));case 1:case"end":return t.stop()}}),_callee3)})))).apply(this,arguments)}function initClients(e){var t=new Promise((function(n){setTimeout((function(){Promise.all(e.map((function(e){return function initClient(e,t){return _initClient.apply(this,arguments)}(e,t)}))).then((function(){return n()}))}),0)}));return t}function initWithHooks(e,t,n,a){return _initWithHooks.apply(this,arguments)}function _initWithHooks(){return(_initWithHooks=asyncToGenerator_asyncToGenerator(l().mark((function _callee4(e,t,n,a){return l().wrap((function _callee4$(l){for(;;)switch(l.prev=l.next){case 0:if(!t){l.next=11;break}return null==n||n(t),l.prev=2,l.next=5,e(t);case 5:l.next=10;break;case 7:l.prev=7,l.t0=l.catch(2),console.error(l.t0);case 10:null==a||a(t);case 11:case"end":return l.stop()}}),_callee4,null,[[2,7]])})))).apply(this,arguments)}function initOptions(e){return _initOptions.apply(this,arguments)}function _initOptions(){return(_initOptions=asyncToGenerator_asyncToGenerator(l().mark((function _callee5(e){var t,n,a,f;return l().wrap((function _callee5$(l){for(;;)switch(l.prev=l.next){case 0:return t=e.elements,n=e.controllers,a=e.clients,f=e.hooks,l.next=3,Promise.all([initWithHooks(initElements,t,null==f?void 0:f.onBeforeInitElements,null==f?void 0:f.onAfterInitElements),initWithHooks(initControllers,n,null==f?void 0:f.onBeforeInitControllers,null==f?void 0:f.onAfterInitControllers),initWithHooks(initClients,a,null==f?void 0:f.onBeforeInitClients,null==f?void 0:f.onAfterInitClients)]);case 3:case"end":return l.stop()}}),_callee5)})))).apply(this,arguments)}function initApp(e){return _initApp.apply(this,arguments)}function _initApp(){return(_initApp=asyncToGenerator_asyncToGenerator(l().mark((function _callee6(e){var t,n,a,f,h,m,g;return l().wrap((function _callee6$(l){for(;;)switch(l.prev=l.next){case 0:return a=(0,p.iH)(mergeArray(e,"state")),f=mergeObject(e,"elements"),h=mergeArray(e,"controllers"),m=mergeArray(e,"clients"),g=e.hooks,l.next=7,initWithHooks(initOptions,{state:a,elements:f,controllers:h,clients:m,hooks:g},null===(t=e.hooks)||void 0===t?void 0:t.onBeforeInit,null===(n=e.hooks)||void 0===n?void 0:n.onAfterInit);case 7:case"end":return l.stop()}}),_callee6)})))).apply(this,arguments)}},6279:function(e){!function webpackUniversalModuleDefinition(t,n){e.exports=n()}("undefined"!=typeof self&&self,(function(){return function(e){var t={};function __nested_webpack_require_575__(n){if(t[n])return t[n].exports;var a=t[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,__nested_webpack_require_575__),a.l=!0,a.exports}return __nested_webpack_require_575__.m=e,__nested_webpack_require_575__.c=t,__nested_webpack_require_575__.d=function(e,t,n){__nested_webpack_require_575__.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},__nested_webpack_require_575__.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},__nested_webpack_require_575__.t=function(e,t){if(1&t&&(e=__nested_webpack_require_575__(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(__nested_webpack_require_575__.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var a in e)__nested_webpack_require_575__.d(n,a,function(t){return e[t]}.bind(null,a));return n},__nested_webpack_require_575__.n=function(e){var t=e&&e.__esModule?function getDefault(){return e.default}:function getModuleExports(){return e};return __nested_webpack_require_575__.d(t,"a",t),t},__nested_webpack_require_575__.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},__nested_webpack_require_575__.p="",__nested_webpack_require_575__(__nested_webpack_require_575__.s=118)}([function(e,t,n){"use strict";function normalizeComponent(e,t,n,a,l,f,p,h){var m,g="function"==typeof e?e.options:e;if(t&&(g.render=t,g.staticRenderFns=n,g._compiled=!0),a&&(g.functional=!0),f&&(g._scopeId="data-v-"+f),p?(m=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),l&&l.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(p)},g._ssrRegister=m):l&&(m=h?function(){l.call(this,this.$root.$options.shadowRoot)}:l),m)if(g.functional){g._injectStyles=m;var v=g.render;g.render=function renderWithStyleInjection(e,t){return m.call(t),v(e,t)}}else{var y=g.beforeCreate;g.beforeCreate=y?[].concat(y,m):[m]}return{exports:e,options:g}}n.d(t,"a",(function(){return normalizeComponent}))},function(e,t){e.exports=function(e){if(!e.webpackPolyfill){var t=Object.create(e);t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),Object.defineProperty(t,"exports",{enumerable:!0}),t.webpackPolyfill=1}return t}},function(e,t,n){"use strict";(function(e){var a=n(78),l=n(35),f=n(54),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/icon-font/icon-font.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){e.exports={component:"ui_button-component",button:"ui_button-button",dark:"ui_button-dark",primary:"ui_button-primary",active:"ui_button-active","x-small":"ui_button-x-small",small:"ui_button-small",large:"ui_button-large","x-large":"ui_button-x-large",full:"ui_button-full"}},function(e,t,n){e.exports={component:"ui_icon-font-component"}},function(e,t,n){e.exports={component:"ui_message-list-item-component",avatar:"ui_message-list-item-avatar",content:"ui_message-list-item-content","username-date":"ui_message-list-item-username-date",date:"ui_message-list-item-date",preview:"ui_message-list-item-preview"}},function(e,t,n){e.exports={component:"ui_modal-content-component",content:"ui_modal-content-content"}},function(e,t,n){e.exports={component:"ui_outside-close-component",icon:"ui_outside-close-icon"}},function(e,t,n){e.exports={component:"ui_modal-header-component","dark-mode":"ui_modal-header-dark-mode",icon:"ui_modal-header-icon"}},function(e,t,n){"use strict";(function(e){var a=n(84),l=n(30),f=n(59),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/modal/modal.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){e.exports={component:"ui_modal-component",footer:"ui_modal-footer",header:"ui_modal-header","rounded-sm":"ui_modal-rounded-sm","rounded-lg":"ui_modal-rounded-lg",body:"ui_modal-body",content:"ui_modal-content","parent-centered":"ui_modal-parent-centered",bg:"ui_modal-bg","bg-dark":"ui_modal-bg-dark","bg-transparent":"ui_modal-bg-transparent",enter:"ui_modal-enter",leave:"ui_modal-leave",xs:"ui_modal-xs",sm:"ui_modal-sm",md:"ui_modal-md",lg:"ui_modal-lg",xl:"ui_modal-xl"}},function(e,t,n){e.exports={component:"ui_modal-puzzle-component","close-button":"ui_modal-puzzle-close-button",header:"ui_modal-puzzle-header",title:"ui_modal-puzzle-title",subtitle:"ui_modal-puzzle-subtitle",modes:"ui_modal-puzzle-modes",mode:"ui_modal-puzzle-mode",arrow:"ui_modal-puzzle-arrow",rated:"ui_modal-puzzle-rated",learning:"ui_modal-puzzle-learning",rush:"ui_modal-puzzle-rush",description:"ui_modal-puzzle-description",footer:"ui_modal-puzzle-footer",bullets:"ui_modal-puzzle-bullets",modal:"ui_modal-puzzle-modal",content:"ui_modal-puzzle-content"}},function(e,t,n){"use strict";(function(e){var a=n(85),l=n(40),f=n(61),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/pagination/pagination-item.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){e.exports={component:"ui_pagination-item-component",light:"ui_pagination-item-light",dark:"ui_pagination-item-dark",disabled:"ui_pagination-item-disabled",active:"ui_pagination-item-active",icon:"ui_pagination-item-icon"}},function(e,t,n){"use strict";(function(e){var a=n(86),l=n(41),f=n(62),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/pagination/pagination-spread.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){e.exports={component:"ui_pagination-spread-component",light:"ui_pagination-spread-light",dark:"ui_pagination-spread-dark"}},function(e,t,n){e.exports={component:"ui_pagination-component",top:"ui_pagination-top",navigation:"ui_pagination-navigation"}},function(e,t,n){e.exports={component:"ui_section-container-component",heading:"ui_section-container-heading",black:"ui_section-container-black",grey:"ui_section-container-grey","light-grey":"ui_section-container-light-grey",green:"ui_section-container-green",red:"ui_section-container-red",white:"ui_section-container-white",dark:"ui_section-container-dark",title:"ui_section-container-title",normal:"ui_section-container-normal",large:"ui_section-container-large",content:"ui_section-container-content",link:"ui_section-container-link"}},function(e,t,n){e.exports={component:"ui_section-link-component","dark-mode":"ui_section-link-dark-mode",name:"ui_section-link-name",icon:"ui_section-link-icon",chevron:"ui_section-link-chevron","header-count":"ui_section-link-header-count"}},function(e,t,n){e.exports={component:"ui_section-tabs-component","dark-mode":"ui_section-tabs-dark-mode",tab:"ui_section-tabs-tab",active:"ui_section-tabs-active",icon:"ui_section-tabs-icon",label:"ui_section-tabs-label"}},function(e,t,n){e.exports={component:"ui_sortable-list-item-component",light:"ui_sortable-list-item-light",dark:"ui_sortable-list-item-dark",main:"ui_sortable-list-item-main",checkbox:"ui_sortable-list-item-checkbox",title:"ui_sortable-list-item-title",name:"ui_sortable-list-item-name",controls:"ui_sortable-list-item-controls",gear:"ui_sortable-list-item-gear",arrows:"ui_sortable-list-item-arrows",arrow:"ui_sortable-list-item-arrow",settings:"ui_sortable-list-item-settings","check-list-item":"ui_sortable-list-item-check-list-item","select-item":"ui_sortable-list-item-select-item","select-item-dropdown":"ui_sortable-list-item-select-item-dropdown","select-item-disabled":"ui_sortable-list-item-select-item-disabled","select-item-slot":"ui_sortable-list-item-select-item-slot","select-item-caret":"ui_sortable-list-item-select-item-caret","select-item-select":"ui_sortable-list-item-select-item-select","gear-wrapper":"ui_sortable-list-item-gear-wrapper","gear-select":"ui_sortable-list-item-gear-select"}},function(e,t,n){e.exports={component:"ui_user-username-component"}},function(e,t,n){e.exports={component:"ui_v5-button-component",primary:"ui_v5-button-primary",large:"ui_v5-button-large",secondary:"ui_v5-button-secondary",tertiary:"ui_v5-button-tertiary",danger:"ui_v5-button-danger",basic:"ui_v5-button-basic","basic-dark":"ui_v5-button-basic-dark","basic-light":"ui_v5-button-basic-light",small:"ui_v5-button-small","x-small":"ui_v5-button-x-small","extra-padding":"ui_v5-button-extra-padding","min-width":"ui_v5-button-min-width",full:"ui_v5-button-full",icon:"ui_v5-button-icon",disabled:"ui_v5-button-disabled",active:"ui_v5-button-active"}},function(e,t,n){"use strict";(function(e){var a=n(95),l=n(49),f=n(71),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/v5-input/v5-input.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){e.exports={component:"ui_v5-input-component",light:"ui_v5-input-light",dark:"ui_v5-input-dark",error:"ui_v5-input-error",large:"ui_v5-input-large"}},function(e,t,n){e.exports={component:"ui_v5-input-group-component",light:"ui_v5-input-group-light",dark:"ui_v5-input-group-dark",icon:"ui_v5-input-group-icon",left:"ui_v5-input-group-left",right:"ui_v5-input-group-right","space-left":"ui_v5-input-group-space-left","space-right":"ui_v5-input-group-space-right",button:"ui_v5-input-group-button"}},function(e,t,n){e.exports={component:"ui_v5-select-component",light:"ui_v5-select-light",dark:"ui_v5-select-dark",error:"ui_v5-select-error",large:"ui_v5-select-large"}},function(e,t,n){e.exports={component:"ui_v5-sidebar-component",header:"ui_v5-sidebar-header","compact-header":"ui_v5-sidebar-compact-header","title-wrapper":"ui_v5-sidebar-title-wrapper",title:"ui_v5-sidebar-title",logo:"ui_v5-sidebar-logo","action-icon":"ui_v5-sidebar-action-icon",left:"ui_v5-sidebar-left",right:"ui_v5-sidebar-right",tabs:"ui_v5-sidebar-tabs",content:"ui_v5-sidebar-content"}},function(e,t,n){e.exports={component:"ui_v5-switch-component",checkbox:"ui_v5-switch-checkbox",label:"ui_v5-switch-label",readonly:"ui_v5-switch-readonly",button:"ui_v5-switch-button",group:"ui_v5-switch-group"}},function(e,t,n){e.exports={component:"ui_v5-textarea-component",light:"ui_v5-textarea-light",dark:"ui_v5-textarea-dark",autosize:"ui_v5-textarea-autosize",small:"ui_v5-textarea-small",large:"ui_v5-textarea-large","x-large":"ui_v5-textarea-x-large"}},function(e,t,n){"use strict";var a,l;!function(e){!function(e){e.DidHide="modal-did-hide"}(e.Events||(e.Events={}))}(a||(a={})),function(e){!function(e){e[e.Backspace=8]="Backspace",e[e.Delete=46]="Delete",e[e.DownArrow=40]="DownArrow",e[e.Enter=13]="Enter",e[e.Escape=27]="Escape",e[e.LeftArrow=37]="LeftArrow",e[e.RightArrow=39]="RightArrow",e[e.Spacebar=32]="Spacebar",e[e.Stop=137]="Stop",e[e.Tab=9]="Tab",e[e.UpArrow=38]="UpArrow"}(e.KeyCodes||(e.KeyCodes={}))}(l||(l={}));var f={name:"Modal",props:{autoShow:{type:Boolean,default:!1},closeOnAction:{type:Boolean,default:!0},centerOverParent:{type:Boolean,default:!1},isTransparent:{type:Boolean,default:!1},corners:{type:String,default:null},modalWidth:{type:String,default:null}},data:function data(){return{visible:!1}},mounted:function mounted(){this.closeOnAction&&window.addEventListener("keyup",this.onKeyPress),this.autoShow&&this.show()},beforeUnmount:function beforeUnmount(){this.closeOnAction&&window.removeEventListener("keyup",this.onKeyPress)},methods:{hide:function hide(){this.visible=!1,this.$emit(a.Events.DidHide)},onBackgroundClick:function onBackgroundClick(e){this.closeOnAction&&this.$refs.body&&!this.$refs.body.contains(e.target)&&this.hide()},onKeyPress:function onKeyPress(e){e.keyCode===l.KeyCodes.Escape&&this.hide()},show:function show(){this.visible=!0}}};t.a=f},function(e,t,n){"use strict";var a;!function(e){!function(e){!function(e){e.Base="button",e.IgnoreDarkMode="ignore-dark-mode"}(e.Classes||(e.Classes={})),function(e){e.Large="large",e.Small="small",e.Xl="x-large"}(e.Sizes||(e.Sizes={})),function(e){e.Primary="primary"}(e.Themes||(e.Themes={}))}(e.Component||(e.Component={}))}(a||(a={}));var l={name:"FormButton",props:{active:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},fullWidth:{type:Boolean,default:!1},href:{default:null,type:String,required:!1},size:{type:String,required:!1,default:a.Component.Sizes.Large},theme:{type:String,default:""},type:{type:String,default:"button"}},methods:{handleClick:function handleClick(e){this.$emit("click",e),e.stopPropagation(),this.href&&(window.location=this.href)}}};t.a=l},function(e,t,n){"use strict";var a={name:"MessageListItem",props:{avatarSrc:{type:String,required:!0},date:{type:String,required:!0},preview:{type:String,required:!0}},methods:{pixelDensity:function pixelDensity(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;if(!e)return null;var n="@2x";return/\.svg$/.test(e)?e:([1.5,3,4].includes(t)&&(n="@".concat(t,"x")),e.replace(/(\.\w+)$/,(function(e){return n+e})))}}};t.a=a},function(e,t,n){"use strict";var a,l,f={};n.r(f),n.d(f,"ListTypes",(function(){return a})),n.d(f,"PositionDirections",(function(){return l})),function(e){e.CheckList="check-list",e.SelectList="select-list"}(a||(a={})),function(e){e.Down="down",e.Up="up"}(l||(l={}));var p={Types:f,name:"SortableListItem",props:{checkListItems:{default:function _default(){return[]},type:Array},enabled:{required:!0,type:Boolean},forceTheme:{default:"",type:String},gearOptions:{default:function _default(){return[]},type:Array},gearValue:{default:0,type:Number},isDownArrowDisabled:{default:!1,type:Boolean},isUpArrowDisabled:{default:!1,type:Boolean},listType:{default:"",type:String},name:{required:!0,type:String},selectListSlotsCount:{default:0,type:Number},selectListSlots:{default:function _default(){return[]},type:Array},selectListOptions:{default:function _default(){return[]},type:Array},showGearIcon:{default:!1,type:Boolean}},data:function data(){return{listTypes:Object.freeze(a),positionDirections:Object.freeze(l)}},methods:{checkboxIcon:function checkboxIcon(e){return e?"square-checkmark":"square"},onCheckListItemChange:function onCheckListItemChange(e,t){this.$emit("check-list-item-change",{enabled:t,value:e})},onGearChange:function onGearChange(e){this.$emit("gear-option-change",{value:e.target.value})},onItemToggle:function onItemToggle(e){this.$emit("item-enabled-change",e.target.checked)},onPositionChange:function onPositionChange(e){this.$emit("position-change",e)},onSelectListItemInput:function onSelectListItemInput(e,t){this.$emit("select-list-item-input",{slot:e-1,value:t.target.value})}}};t.a=p},function(e,t,n){"use strict";var a,l,f="function"==typeof Map?new Map:(a=[],l=[],{has:function(e){return a.indexOf(e)>-1},get:function(e){return l[a.indexOf(e)]},set:function(e,t){-1===a.indexOf(e)&&(a.push(e),l.push(t))},delete:function(e){var t=a.indexOf(e);t>-1&&(a.splice(t,1),l.splice(t,1))}}),o=function(e){return new Event(e,{bubbles:!0})};try{new Event("test")}catch(a){o=function(e){var t=document.createEvent("Event");return t.initEvent(e,!0,!1),t}}function r(e){var t=f.get(e);t&&t.destroy()}function i(e){var t=f.get(e);t&&t.update()}var p=null;"undefined"==typeof window||"function"!=typeof window.getComputedStyle?((p=function(e){return e}).destroy=function(e){return e},p.update=function(e){return e}):((p=function(e,t){return e&&Array.prototype.forEach.call(e.length?e:[e],(function(e){return function(e){if(e&&e.nodeName&&"TEXTAREA"===e.nodeName&&!f.has(e)){var t,n=null,a=null,l=null,d=function(){e.clientWidth!==a&&c()},p=function(t){window.removeEventListener("resize",d,!1),e.removeEventListener("input",c,!1),e.removeEventListener("keyup",c,!1),e.removeEventListener("autosize:destroy",p,!1),e.removeEventListener("autosize:update",c,!1),Object.keys(t).forEach((function(n){e.style[n]=t[n]})),f.delete(e)}.bind(e,{height:e.style.height,resize:e.style.resize,overflowY:e.style.overflowY,overflowX:e.style.overflowX,wordWrap:e.style.wordWrap});e.addEventListener("autosize:destroy",p,!1),"onpropertychange"in e&&"oninput"in e&&e.addEventListener("keyup",c,!1),window.addEventListener("resize",d,!1),e.addEventListener("input",c,!1),e.addEventListener("autosize:update",c,!1),e.style.overflowX="hidden",e.style.wordWrap="break-word",f.set(e,{destroy:p,update:c}),"vertical"===(t=window.getComputedStyle(e,null)).resize?e.style.resize="none":"both"===t.resize&&(e.style.resize="horizontal"),n="content-box"===t.boxSizing?-(parseFloat(t.paddingTop)+parseFloat(t.paddingBottom)):parseFloat(t.borderTopWidth)+parseFloat(t.borderBottomWidth),isNaN(n)&&(n=0),c()}function u(t){var n=e.style.width;e.style.width="0px",e.style.width=n,e.style.overflowY=t}function s(){if(0!==e.scrollHeight){var t=function(e){for(var t=[];e&&e.parentNode&&e.parentNode instanceof Element;)e.parentNode.scrollTop&&t.push({node:e.parentNode,scrollTop:e.parentNode.scrollTop}),e=e.parentNode;return t}(e),l=document.documentElement&&document.documentElement.scrollTop;e.style.height="",e.style.height=e.scrollHeight+n+"px",a=e.clientWidth,t.forEach((function(e){e.node.scrollTop=e.scrollTop})),l&&(document.documentElement.scrollTop=l)}}function c(){s();var t=Math.round(parseFloat(e.style.height)),n=window.getComputedStyle(e,null),a="content-box"===n.boxSizing?Math.round(parseFloat(n.height)):e.offsetHeight;if(a<t?"hidden"===n.overflowY&&(u("scroll"),s(),a="content-box"===n.boxSizing?Math.round(parseFloat(window.getComputedStyle(e,null).height)):e.offsetHeight):"hidden"!==n.overflowY&&(u("hidden"),s(),a="content-box"===n.boxSizing?Math.round(parseFloat(window.getComputedStyle(e,null).height)):e.offsetHeight),l!==a){l=a;var f=o("autosize:resized");try{e.dispatchEvent(f)}catch(e){}}}}(e)})),e}).destroy=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],r),e},p.update=function(e){return e&&Array.prototype.forEach.call(e.length?e:[e],i),e});var h=p,m={name:"V5Textarea",props:{autofocus:{default:!1,type:Boolean},autosize:{type:Boolean,default:!1},forceTheme:{type:String,default:""},size:{type:String,default:""},value:{default:"",type:[Number,String]}},mounted:function mounted(){this.autosize&&(h(this.$el),this.$el.addEventListener("autosize:resized",this.resizeEvent)),this.autofocus&&this.$el.focus()},beforeUnmount:function beforeUnmount(){this.autosize&&this.$el.removeEventListener("autosize:resized",this.resizeEvent)},methods:{resizeEvent:function resizeEvent(){var e=this;this.$nextTick((function(){e.$emit("resize")}))}}};t.a=m},function(e,t,n){"use strict";var a={name:"IconFont",props:{name:{required:!0,type:String},size:{default:3,required:!1,type:Number}}};t.a=a},function(e,t,n){"use strict";t.a={name:"ModalContent"}},function(e,t,n){"use strict";t.a={name:"OutsideClose"}},function(e,t,n){"use strict";var a={name:"ModalHeader",components:{IconFont:n(2).a},props:{icon:{type:String,default:""}}};t.a=a},function(e,t,n){"use strict";var a={name:"PuzzleModal",components:{Modal:n(9).a}};t.a=a},function(e,t,n){"use strict";var a={name:"PaginationItem",props:{active:{type:Boolean,default:!1},content:{type:String,required:!1},disabled:{type:Boolean,default:!1},icon:{type:String,required:!1},href:{default:null,type:String,required:!1},forceTheme:{type:String,required:!1}},emits:["click"]};t.a=a},function(e,t,n){"use strict";var a={name:"PaginationSpread",props:{forceTheme:{type:String,required:!1}}};t.a=a},function(e,t,n){"use strict";var a=n(12),l=n(14),f={name:"Pagination",components:{PaginationItem:a.a,PaginationSpread:l.a},props:{forceTheme:{type:String,required:!1}}};t.a=f},function(e,t,n){"use strict";var a={name:"SectionContainer",props:{darkMode:{default:!1,type:Boolean},heading:{default:function _default(){return{}},type:Object},lightMode:{default:!1,type:Boolean},link:{default:"",type:String}}};t.a=a},function(e,t,n){"use strict";var a={name:"SectionLink",components:{IconFont:n(2).a},props:{icon:{type:String,default:""},name:{type:String,required:!0},isDarkMode:{type:Boolean,required:!1},url:{default:"",type:String}}};t.a=a},function(e,t,n){"use strict";var a={name:"SectionTabs",components:{IconFont:n(2).a},props:{isDarkMode:{default:!1,type:Boolean},selectedValue:{required:!0,type:String},showLabels:{default:!0,type:Boolean},tabs:{required:!0,type:Array}},methods:{changeTab:function changeTab(e){this.$emit("tab-changed",e)}}};t.a=a},function(e,t,n){"use strict";t.a={name:"UserUsername"}},function(e,t,n){"use strict";var a={name:"V5Button",props:{active:{type:Boolean,default:!1},disabled:{type:Boolean,default:!1},extraPadding:{type:Boolean,default:!1},fullWidth:{type:Boolean,default:!1},href:{default:null,type:String,required:!1},minWidth:{type:Boolean,required:!1},size:{type:String,default:""},theme:{type:String,default:"basic"},type:{type:String,default:"button"}}};t.a=a},function(e,t,n){"use strict";var a=n(70),l=n.n(a),f={name:"V5InputGroup",components:{V5Input:n(23).a},props:{ariaLabel:{type:String,default:""},autocomplete:{type:String,default:"off"},autofocus:Boolean,clearButtonIcon:{type:String,default:""},disabled:Boolean,forceTheme:{type:String,default:""},iconLeft:{type:String,default:""},iconRight:{type:String,default:""},id:{type:String,default:""},maxlength:{type:Number,default:524288},name:{type:String,default:""},placeholder:{type:String,default:""},size:{type:String,default:"small"},type:{type:String,default:"text"},value:{type:[String,Number],default:""}},computed:{inputClasses:function inputClasses(){var e;return[(e={},l()(e,this.$style["space-left"],this.iconLeft),l()(e,this.$style["space-right"],this.iconRight||this.clearButtonIcon),e)]}},methods:{clearButtonAction:function clearButtonAction(e){this.$emit("clear-button-action",e)},blurEvent:function blurEvent(e){this.$emit("blur",e)},focusEvent:function focusEvent(e){this.$emit("focus",e)},keydownEvent:function keydownEvent(e){this.$emit("keydown",e)},keyupEvent:function keyupEvent(e){this.$emit("keyup",e)},keyupEnterEvent:function keyupEnterEvent(e){this.$emit("enter",e)},onIconClick:function onIconClick(e){this.$emit("icon-click-".concat(e))},updateValue:function updateValue(e){this.$emit("input",e)}}};t.a=f},function(e,t,n){"use strict";var a={name:"V5Input",props:{size:{type:String,default:""},forceTheme:{type:String,default:""},value:{default:"",type:[Number,String]},hasError:{default:!1,type:Boolean},hasNativeInputEvent:{default:!1,type:Boolean}},methods:{keyupEvent:function keyupEvent(e){this.$emit("keyup",e)},onInput:function onInput(e){this.$emit("input",this.hasNativeInputEvent?e:e.target.value)}}};t.a=a},function(e,t,n){"use strict";var a={name:"V5Select",props:{emptyOption:{type:String,default:""},forceTheme:{type:String,default:""},hasError:{default:!1,type:Boolean},labelKey:{type:String,default:"label"},options:{type:Array,required:!0},placeholderText:{type:String,default:""},size:{type:String,default:""},value:{type:[String,Number],required:!1,default:""},valueKey:{type:String,default:"value"}},methods:{getLabel:function getLabel(e){return this.labelKey?e[this.labelKey]:e},getValue:function getValue(e){return this.valueKey?e[this.valueKey]:e},setSelectedOption:function setSelectedOption(e){this.$emit("input",e),this.onChange&&this.onChange()}}};t.a=a},function(e,t,n){"use strict";var a={name:"V5Sidebar",props:{title:{type:String,required:!0},compactHeader:{type:Boolean,default:!1}}};t.a=a},function(e,t,n){"use strict";var a={name:"V5Switch",props:{name:{type:String,required:!0},value:{type:Boolean,required:!0},isDisabled:{type:Boolean,default:!1}},methods:{setSwitchStatus:function setSwitchStatus(e){this.$emit("input",e)}}};t.a=a},function(e,t,n){"use strict";var a=n(3),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(4),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(5),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(6),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(7),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(8),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(10),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(11),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(13),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(15),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(16),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(17),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(18),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(19),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(20),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(21),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(22),l=n.n(a);t.default=l.a},function(e,t){e.exports=function _defineProperty(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}},function(e,t,n){"use strict";var a=n(24),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(25),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(26),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(27),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(28),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var a=n(29),l=n.n(a);t.default=l.a},function(e,t,n){"use strict";var render=function(){var e,t=this,n=t.$createElement;return(t._self._c||n)("button",{class:[t.$style.component,t.$style[t.size],t.$style[t.theme],(e={},e[t.$style.full]=t.fullWidth,e[t.$style.active]=t.active,e[t.$style.disabled]=t.disabled,e)],attrs:{"aria-selected":t.active,disabled:t.disabled,type:t.type},on:{click:t.handleClick}},[t._t("default")],2)},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",e._b({class:[e.$style.component,"icon-font-chess",e.name],style:[{fontSize:e.size+"rem",marginTop:"-"+1.7*e.size/2+"px"}],on:{click:function(t){return e.$emit("click",t)}}},"div",e.$attrs,!1))},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.$style.component},[n("img",{class:e.$style.avatar,attrs:{src:e.avatarSrc,srcset:e.pixelDensity(e.avatarSrc)}}),e._v(" "),n("div",{class:e.$style.content},[n("div",{class:e.$style["username-date"]},[e._t("user-tagline"),e._v(" "),n("div",{class:e.$style.date,domProps:{textContent:e._s(e.date)}})],2),e._v(" "),n("div",{class:e.$style.preview,domProps:{textContent:e._s(e.preview)}})])])},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{class:e.$style.component},[e._t("default")],2)},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("button",{class:e.$style.component,attrs:{type:"button"},on:{click:function(t){return e.$emit("click",t)}}},[n("div",{staticClass:"icon-font-chess x",class:e.$style.icon})])},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.$style.component},[e._t("default"),e._v(" "),e.icon?n("IconFont",{class:e.$style.icon,attrs:{name:e.icon},on:{click:function(t){return e.$emit("close",t)}}}):e._e()],2)},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("Modal",{ref:"modal",class:e.$style.modal,attrs:{"close-on-action":!1,"auto-show":""}},[n("div",{class:e.$style.content},[n("div",{class:e.$style.component,attrs:{"data-cy":"modalIntro"}},[n("div",{class:e.$style.header},[n("div",{class:e.$style.title},[e._v("\n          Solve Chess Puzzles\n        ")])]),e._v(" "),n("div",{class:e.$style.description},[n("div",{class:[e.$style.arrow,e.$style.rated]}),e._v(" "),n("p",[e._v("\n          Test your tactical skills with puzzles that push your limits. The faster you solve, the higher your score.\n        ")])]),e._v(" "),n("div",{class:e.$style.footer},[e._v("\n        Here is where footer info would go\n      ")])])])])},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e,t=this,n=t.$createElement,a=t._self._c||n;return a("Transition",{attrs:{"enter-active-class":t.$style.enter,"leave-active-class":t.$style.leave}},[t.visible?a("div",[t.centerOverParent?t._e():a("div",{class:[t.$style.bg,[t.isTransparent?t.$style["bg-transparent"]:t.$style["bg-dark"]]]}),t._v(" "),a("div",{class:[t.$style.component,(e={},e[t.$style["parent-centered"]]=t.centerOverParent,e)],on:{click:function(e){return t.onBackgroundClick(e)}}},[a("div",{ref:"body",class:[t.$style.body,t.$style[t.corners],t.$style[t.modalWidth]]},[this.$slots.header?a("div",{class:t.$style.header},[t._t("header")],2):t._e(),t._v(" "),this.$slots.content?a("div",{class:t.$style.content},[t._t("content")],2):t._e(),t._v(" "),t._t("default"),t._v(" "),this.$slots.footer?a("div",{class:t.$style.footer},[t._t("footer")],2):t._e()],2)])]):t._e()])},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e,t=this,n=t.$createElement,a=t._self._c||n;return a(t.href?"a":"button",{tag:"Component",class:[t.$style.component,(e={},e[t.$style.disabled]=t.href&&t.disabled,e[t.$style.active]=t.active,e[t.$style.dark]="dark"==t.forceTheme,e[t.$style.light]="light"==t.forceTheme,e)],attrs:{rel:"nofollow","aria-selected":t.active,disabled:!t.href&&t.disabled,href:t.href,type:!t.href&&"button"},on:{click:function(e){return t.$emit("click",e)}}},[t.icon?a("span",{class:[t.$style.icon,"icon-font-chess",t.icon]}):t._e(),t._v(" "),t.content?a("span",{domProps:{textContent:t._s(t.content)}}):t._e()])},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e,t=this,n=t.$createElement;return(t._self._c||n)("div",{class:[t.$style.component,(e={},e[t.$style.dark]="dark"==t.forceTheme,e[t.$style.light]="light"==t.forceTheme,e)],domProps:{textContent:t._s("...")}})},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.$style.component},[n("PaginationItem",{class:e.$style.top,attrs:{"aria-label":"Go to Top",icon:"chevron-up",content:"Top","force-theme":e.forceTheme},on:{click:e.onClick}}),e._v(" "),n("nav",{class:e.$style.navigation},[n("PaginationItem",{attrs:{"force-theme":e.forceTheme,href:"#"},domProps:{textContent:e._s("First")}}),e._v(" "),n("PaginationItem",{attrs:{disabled:"",icon:"chevron-left","force-theme":e.forceTheme},on:{click:e.onClick}}),e._v(" "),n("PaginationSpread",{attrs:{"force-theme":e.forceTheme}}),e._v(" "),n("PaginationItem",{attrs:{"force-theme":e.forceTheme,href:"#"},domProps:{textContent:e._s("4")}}),e._v(" "),n("PaginationItem",{attrs:{active:"","force-theme":e.forceTheme},domProps:{textContent:e._s("5")},on:{click:e.onClick}}),e._v(" "),n("PaginationItem",{attrs:{disabled:"",href:"#","force-theme":e.forceTheme},domProps:{textContent:e._s("6")}}),e._v(" "),n("PaginationItem",{attrs:{icon:"chevron-right","force-theme":e.forceTheme},on:{click:e.onClick}}),e._v(" "),n("PaginationItem",{attrs:{"force-theme":e.forceTheme},domProps:{textContent:e._s("Last")},on:{click:e.onClick}})],1)],1)},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:[e.$style.component,{"dark-mode":e.darkMode,"light-mode":e.lightMode}]},[e.$slots.heading?n("div",{class:[e.$style.heading,e.$style[e.heading.theme]]},[n("span",{class:[e.$style.title,e.$style[e.heading.size]]},[e._t("heading")],2)]):e._e(),e._v(" "),e.$slots.link?n("a",{class:[e.$style.link,{"dark-mode":e.darkMode,"light-mode":e.lightMode}],attrs:{href:e.link.url}},[e._t("link")],2):e._e(),e._v(" "),e.$slots.title?n("span",{class:e.$style.link},[e._t("title")],2):e._e(),e._v(" "),e._t("title-content"),e._v(" "),e.$slots.default?n("div",{class:e.$style.content},[e._t("default")],2):e._e()],2)},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e,t=this,n=t.$createElement,a=t._self._c||n;return a("a",{class:[t.$style.component,(e={},e[t.$style["dark-mode"]]=t.isDarkMode,e)],attrs:{href:t.url}},[t.icon?a("IconFont",{class:t.$style.icon,attrs:{family:"chess",name:t.icon}}):t._e(),t._v(" "),a("span",{class:t.$style.name},[t._v(t._s(t.name))]),t._v(" "),t._t("default"),t._v(" "),a("IconFont",{class:t.$style.chevron,attrs:{theme:"primary",name:"chevron-right"}})],2)},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e,t=this,n=t.$createElement,a=t._self._c||n;return a("div",{class:[t.$style.component,(e={},e[t.$style["dark-mode"]]=t.isDarkMode,e)]},t._l(t.tabs,(function(e){var n;return a("div",{key:e.value,class:[t.$style.tab,(n={},n[t.$style.active]=t.selectedValue===e.value,n)],on:{click:function(n){return t.changeTab(e.value)}}},[e.icon?a("IconFont",{class:t.$style.icon,attrs:{name:e.icon}}):t._e(),t._v(" "),a("span",{directives:[{name:"show",rawName:"v-show",value:t.showLabels,expression:"showLabels"}],class:t.$style.label,domProps:{textContent:t._s(e.label)}})],1)})),0)},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e,t=this,n=t.$createElement,a=t._self._c||n;return a("div",{class:[t.$style.component,(e={},e[t.$style.dark]="dark"==t.forceTheme,e[t.$style.light]="light"==t.forceTheme,e)]},[a("div",{class:t.$style.main},[a("div",{class:t.$style.title},[a("input",{class:t.$style.checkbox,attrs:{id:"checkbox-"+t.name,type:"checkbox"},domProps:{checked:t.enabled},on:{change:function(e){return t.onItemToggle(e)}}}),t._v(" "),a("label",{class:t.$style.name,attrs:{for:"checkbox-"+t.name},domProps:{textContent:t._s(t.name)}})]),t._v(" "),a("div",{class:t.$style.controls},[t.showGearIcon?a("div",{class:t.$style["gear-wrapper"]},[a("span",{staticClass:"icon-font-chess circle-gearwheel",class:t.$style.gear}),t._v(" "),a("select",{class:t.$style["gear-select"],attrs:{disabled:!t.enabled},on:{change:function(e){return t.onGearChange(e)}}},t._l(t.gearOptions,(function(e){return a("option",{key:e.value,domProps:{selected:e.value===t.gearValue,value:e.value,textContent:t._s(e.name)}})})),0)]):t._e(),t._v(" "),a("div",{class:t.$style.arrows},[a("span",{staticClass:"icon-font-chess caret-up",class:t.$style.arrow,style:[{pointerEvents:t.isUpArrowDisabled?"none":"auto"}],on:{click:function(e){return t.onPositionChange(t.positionDirections.Up)}}}),t._v(" "),a("span",{staticClass:"icon-font-chess caret-down",class:t.$style.arrow,style:[{pointerEvents:t.isDownArrowDisabled?"none":"auto"}],on:{click:function(e){return t.onPositionChange(t.positionDirections.Down)}}})])])]),t._v(" "),t.listType===t.listTypes.CheckList?a("div",{class:t.$style.settings},t._l(t.checkListItems,(function(e){return a("div",{key:e.value,class:t.$style["check-list-item"]},[a("input",{class:t.$style.checkbox,attrs:{id:"checkbox-"+e.value,type:"checkbox",disabled:!t.enabled},domProps:{checked:e.enabled},on:{input:function(n){return t.onCheckListItemChange(e.value,!e.enabled)}}}),t._v(" "),a("label",{attrs:{for:"checkbox-"+e.value},domProps:{textContent:t._s(e.name)}})])})),0):t._e(),t._v(" "),t.listType===t.listTypes.SelectList?a("div",{class:t.$style.settings},t._l(t.selectListSlotsCount,(function(e,n){var l;return a("div",{key:e,class:[t.$style["select-item"],(l={},l[t.$style["select-item-disabled"]]=!t.enabled,l)]},[a("div",{class:t.$style["select-item-slot"],domProps:{textContent:t._s(e)}}),t._v(" "),a("div",{class:t.$style["select-item-dropdown"]},[a("div",{class:t.selectListSlots[n].className,domProps:{textContent:t._s(t.selectListSlots[n].name)}}),t._v(" "),a("span",{staticClass:"icon-font-chess caret-down",class:t.$style["select-item-caret"]}),t._v(" "),a("select",{class:t.$style["select-item-select"],attrs:{disabled:!t.enabled},on:{change:function(n){return t.onSelectListItemInput(e,n)}}},t._l(t.selectListOptions,(function(e){return a("option",{key:e.value,domProps:{selected:e.value===t.selectListSlots[n].value,value:e.value,textContent:t._s(e.name)}})})),0)])])})),0):t._e()])},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e=this,t=e.$createElement;return(e._self._c||t)("div",{class:e.$style.component},[e._t("default")],2)},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e,t,n=this,a=n.$createElement,l=n._self._c||a;return n.href?l("a",{class:[n.$style.component,n.$style[n.theme],n.$style[n.size],(e={},e[n.$style.full]=n.fullWidth,e[n.$style.active]=n.active,e[n.$style.disabled]=n.disabled,e[n.$style["extra-padding"]]=n.extraPadding,e[n.$style["min-width"]]=n.minWidth,e)],attrs:{href:n.href},on:{click:function(e){return n.$emit("click",e)}}},[n._t("default")],2):l("button",{class:[n.$style.component,n.$style[n.theme],n.$style[n.size],(t={},t[n.$style.full]=n.fullWidth,t[n.$style.active]=n.active,t[n.$style["extra-padding"]]=n.extraPadding,t[n.$style["min-width"]]=n.minWidth,t)],attrs:{disabled:n.disabled,type:n.type},on:{click:function(e){return n.$emit("click",e)}}},[n._t("default")],2)},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e,t=this,n=t.$createElement,a=t._self._c||n;return a("div",{class:[t.$style.component,(e={},e[t.$style.dark]="dark"==t.forceTheme,e[t.$style.light]="light"==t.forceTheme,e)]},[a("V5Input",{class:t.inputClasses,attrs:{id:t.id,"aria-label":t.ariaLabel,autocomplete:t.autocomplete,autofocus:t.autofocus,"force-theme":t.forceTheme,maxlength:t.maxlength,name:t.name,placeholder:t.placeholder,readonly:t.disabled,type:t.type,size:t.size,value:t.value},on:{blur:function(e){return t.blurEvent(e)},focus:function(e){return t.focusEvent(e)},input:function(e){return t.updateValue(e)},keydown:function(e){return t.keydownEvent(e)},keyup:[function(e){return t.keyupEvent(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.keyupEnterEvent(e)}]}}),t._v(" "),t.iconLeft?a("span",{staticClass:"icon-font-chess",class:[t.$style.icon,t.$style.left,t.iconLeft],on:{click:function(e){return t.onIconClick("left")}}}):t._e(),t._v(" "),t.iconRight?a("span",{staticClass:"icon-font-chess",class:[t.$style.icon,t.$style.right,t.iconRight],on:{click:function(e){return t.onIconClick("right")}}}):t._e(),t._v(" "),t.clearButtonIcon&&!t.iconRight&&t.value?a("button",{class:t.$style.button,attrs:{type:"button"},on:{click:function(e){return t.clearButtonAction(e)}}},[a("span",{staticClass:"icon-font-chess circle-x",class:t.$style.icon})]):t._e(),t._v(" "),!t.clearButtonIcon||t.iconRight||t.value?t._e():a("span",{staticClass:"icon-font-chess",class:[t.$style.icon,t.$style.right,t.clearButtonIcon]})],1)},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e,t=this,n=t.$createElement;return(t._self._c||n)("input",{class:[t.$style.component,t.$style[t.size],(e={},e[t.$style.dark]="dark"==t.forceTheme,e[t.$style.light]="light"==t.forceTheme,e[t.$style.error]=t.hasError,e)],domProps:{value:t.value},on:{blur:function(e){return t.$emit("blur",e)},focus:function(e){return t.$emit("focus",e)},input:t.onInput,keydown:function(e){return t.$emit("keydown",e)},keyup:[function(e){return t.keyupEvent(e)},function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.$emit("enter",e)}],paste:function(e){return t.$emit("paste",e)}}})},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e,t=this,n=t.$createElement,a=t._self._c||n;return a("select",{class:[t.$style.component,t.$style[t.size],(e={},e[t.$style.dark]="dark"==t.forceTheme,e[t.$style.light]="light"==t.forceTheme,e[t.$style.error]=t.hasError,e)],on:{change:function(e){return t.setSelectedOption(e.target.value)}}},[t.placeholderText?a("option",{attrs:{disabled:"",hidden:"",selected:"",value:""},domProps:{textContent:t._s(t.placeholderText)}}):t._e(),t._v(" "),t.emptyOption?a("option",{attrs:{selected:"",value:""},domProps:{textContent:t._s(t.emptyOption)}}):t._e(),t._v(" "),t._l(t.options,(function(e,n){return a("option",{key:n,attrs:{disabled:e.disabled,hidden:e.hidden},domProps:{selected:t.getValue(e)===t.value,value:t.getValue(e)}},[t._v("\n    "+t._s(t.getLabel(e))+"\n  ")])}))],2)},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e,t=this,n=t.$createElement,a=t._self._c||n;return a("div",{class:t.$style.component},[a("div",{class:[t.$style.header,(e={},e[t.$style["compact-header"]]=t.compactHeader,e)]},[t.$slots.leftActionIcon?a("div",{class:[t.$style["action-icon"],t.$style.left]},[t._t("leftActionIcon")],2):t._e(),t._v(" "),a("div",{class:t.$style["title-wrapper"]},[a("span",{class:t.$style.title},[t._v("\n        "+t._s(t.title)+"\n      ")]),t._v(" "),t.$slots.logo?a("div",{class:t.$style.logo},[t._t("logo")],2):t._e()]),t._v(" "),t.$slots.rightActionIcon?a("div",{class:[t.$style["action-icon"],t.$style.right]},[t._t("rightActionIcon")],2):t._e()]),t._v(" "),t.$slots.tabs?a("div",{class:t.$style.tabs},[t._t("tabs")],2):t._e(),t._v(" "),a("div",{class:t.$style.content},[t._t("default")],2)])},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{class:e.$style.component},[n("input",{class:e.$style.checkbox,attrs:{id:e.name,type:"checkbox",disabled:e.isDisabled,name:e.name},domProps:{checked:e.value},on:{change:function(t){return e.setSwitchStatus(t.target.checked)}}}),e._v(" "),n("label",{class:e.$style.label,attrs:{for:e.name}},[n("div",{class:e.$style.button})])])},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";var render=function(){var e,t=this,n=t.$createElement;return(t._self._c||n)("textarea",{class:[t.$style.component,t.$style[t.size],(e={},e[t.$style.dark]="dark"==t.forceTheme,e[t.$style.light]="light"==t.forceTheme,e[t.$style.autosize]=t.autosize,e)],domProps:{value:t.value},on:{blur:function(e){return t.$emit("blur",e)},focus:function(e){return t.$emit("focus",e)},input:function(e){return t.$emit("input",e.target.value)},keydown:function(e){return t.$emit("keydown",e)}}})},a=[];render._withStripped=!0,n.d(t,"a",(function(){return render})),n.d(t,"b",(function(){return a}))},function(e,t,n){"use strict";(function(e){var a=n(77),l=n(31),f=n(53),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/button/button.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){"use strict";(function(e){var a=n(79),l=n(32),f=n(55),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/message-list-item/message-list-item.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){"use strict";(function(e){var a=n(80),l=n(36),f=n(56),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/modal/modal-content/modal-content.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){"use strict";(function(e){var a=n(81),l=n(37),f=n(57),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/modal/modal-content/outside-close.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){"use strict";(function(e){var a=n(82),l=n(38),f=n(58),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/modal/modal-header/modal-header.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){"use strict";(function(e){var a=n(83),l=n(39),f=n(60),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/modal/modal-puzzle/modal-puzzle.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){"use strict";(function(e){var a=n(87),l=n(42),f=n(63),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/pagination/pagination.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){"use strict";(function(e){var a=n(88),l=n(43),f=n(64),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/section/section-container.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){"use strict";(function(e){var a=n(89),l=n(44),f=n(65),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/section/section-link/section-link.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){"use strict";(function(e){var a=n(90),l=n(45),f=n(66),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/section/section-tabs/section-tabs.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){"use strict";(function(e){var a=n(91),l=n(33),f=n(67),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/sortable-list/sortable-list-item/sortable-list-item.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){"use strict";(function(e){var a=n(92),l=n(46),f=n(68),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/user-username/user-username.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){"use strict";(function(e){var a=n(93),l=n(47),f=n(69),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/v5-button/v5-button.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){"use strict";(function(e){var a=n(94),l=n(48),f=n(72),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/v5-input/v5-input-group.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){"use strict";(function(e){var a=n(96),l=n(50),f=n(73),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/v5-select/v5-select.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){"use strict";(function(e){var a=n(97),l=n(51),f=n(74),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/v5-sidebar/v5-sidebar.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){"use strict";(function(e){var a=n(98),l=n(52),f=n(75),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/v5-switch/v5-switch.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){"use strict";(function(e){var a=n(99),l=n(34),f=n(76),p=n(0),h={};e.hot,e.hot;var m=Object(p.a)(l.a,a.a,a.b,!1,(function injectStyles(e){h.$style=f.default.locals||f.default,Object.defineProperty(this,"$style",{configurable:!0,get:function(){return h.$style}})}),null,null);m.options.__file="src/ui/v5-textarea/v5-textarea.vue",t.a=m.exports}).call(this,n(1)(e))},function(e,t,n){"use strict";n.r(t);var a=n(100);n.d(t,"Button",(function(){return a.a}));var l=n(2);n.d(t,"IconFont",(function(){return l.a}));var f=n(101);n.d(t,"MessageListItem",(function(){return f.a}));var p=n(102);n.d(t,"ModalContent",(function(){return p.a}));var h=n(103);n.d(t,"OutsideClose",(function(){return h.a}));var m=n(104);n.d(t,"ModalHeader",(function(){return m.a}));var g=n(105);n.d(t,"ModalPuzzle",(function(){return g.a}));var v=n(9);n.d(t,"Modal",(function(){return v.a}));var y=n(12);n.d(t,"PaginationItem",(function(){return y.a}));var _=n(14);n.d(t,"PaginationSpread",(function(){return _.a}));var b=n(106);n.d(t,"Pagination",(function(){return b.a}));var C=n(107);n.d(t,"SectionContainer",(function(){return C.a}));var S=n(108);n.d(t,"SectionLink",(function(){return S.a}));var k=n(109);n.d(t,"SectionTabs",(function(){return k.a}));var w=n(110);n.d(t,"SortableListItem",(function(){return w.a}));var T=n(111);n.d(t,"UserUsername",(function(){return T.a}));var P=n(112);n.d(t,"V5Button",(function(){return P.a}));var A=n(113);n.d(t,"V5InputGroup",(function(){return A.a}));var M=n(23);n.d(t,"V5Input",(function(){return M.a}));var x=n(114);n.d(t,"V5Select",(function(){return x.a}));var O=n(115);n.d(t,"V5Sidebar",(function(){return O.a}));var R=n(116);n.d(t,"V5Switch",(function(){return R.a}));var I=n(117);n.d(t,"V5Textarea",(function(){return I.a}))}])}))},5174:function(e,t,n){"use strict";function createEventEmitter(){const e=[];return{emit:function emit(t,n){let a;for(a of e)a.type!==t&&"all"!==a.type||a.handler(n)},listeners:e,off:off,offAll:function offAll(e){return off({handler:e,type:"all"})},offMany:function offMany(e=[]){e.forEach((e=>off(e)))},on:on,onAll:function onAll(e){on("all",e)},onMany:function onMany(e=[],t){e.forEach((e=>on(e,t)))},once:function once(t,n){const a={handler:(...e)=>{off(a),n(...e)},type:t};e.push(a)}};function off(t){const n=e.findIndex((e=>t.type===e.type&&t.handler===e.handler));-1!==n&&e.splice(n,1)}function on(t,n){const a={handler:n,type:t};e.push(a)}}n.d(t,{I:function(){return createEventEmitter}})},3167:function(e,t,n){"use strict";function pick(e,t){return t.reduce(((t,n)=>(Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]),t)),{})}n.d(t,{ei:function(){return pick}})},2591:function(e,t,n){"use strict";function noop(){}function createQueue(e=!0){const t=[];let n=!1;return{add:function add(a,...l){let f=noop,p=noop;const h=new Promise(((e,t)=>{p=e,f=t}));t.push({fn:a,params:l,reject:f,resolve:p}),e&&!1===n&&flush();return h},clear:function clear(){n=!1,t.length=0},flush:flush,getEntries:function getEntries(){return t}};async function flush(){const e=t.shift();if(e){n=!0;try{const t=await e.fn(...e.params);return e.resolve(t),flush()}catch(a){e.reject(a)}}else n=!1}}n.d(t,{j:function(){return createQueue}})},6110:function(e,t,n){"use strict";n.d(t,{IZ:function(){return loadSound},GN:function(){return playSound}});const a=["mousedown","keydown","touchstart","touchend"];let l=!1;const f=window.chesscom||{},p=window.AudioContext||window.webkitAudioContext;let h=Boolean(p);function isSuspended(){return h}function resumeAudio(e){if(p){if(f.audioContext||(f.audioContext=function newAudioContext(){try{return new p}catch(e){return null}}()),!f.audioContext||!f.audioContext.resume)return h=!1,void e();f.audioContext.resume().then((()=>{h=!1,e()}))}}var m="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:void 0!==n.g?n.g:"undefined"!=typeof self?self:{};
/*!
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
var g,v=function createCommonjsModule(e){var t={exports:{}};return e(t,t.exports),t.exports}((function(e,t){!function(){var HowlerGlobal=function(){this.init()};HowlerGlobal.prototype={init:function(){var t=this||e;return t._counter=1e3,t._html5AudioPool=[],t.html5PoolSize=10,t._codecs={},t._howls=[],t._muted=!1,t._volume=1,t._canPlayEvent="canplaythrough",t._navigator="undefined"!=typeof window&&window.navigator?window.navigator:null,t.masterGain=null,t.noAudio=!1,t.usingWebAudio=!0,t.autoSuspend=!0,t.ctx=null,t.autoUnlock=!0,t._setup(),t},volume:function(t){var n=this||e;if(t=parseFloat(t),n.ctx||setupAudioContext(),void 0!==t&&t>=0&&t<=1){if(n._volume=t,n._muted)return n;n.usingWebAudio&&n.masterGain.gain.setValueAtTime(t,e.ctx.currentTime);for(var a=0;a<n._howls.length;a++)if(!n._howls[a]._webAudio)for(var l=n._howls[a]._getSoundIds(),f=0;f<l.length;f++){var p=n._howls[a]._soundById(l[f]);p&&p._node&&(p._node.volume=p._volume*t)}return n}return n._volume},mute:function(t){var n=this||e;n.ctx||setupAudioContext(),n._muted=t,n.usingWebAudio&&n.masterGain.gain.setValueAtTime(t?0:n._volume,e.ctx.currentTime);for(var a=0;a<n._howls.length;a++)if(!n._howls[a]._webAudio)for(var l=n._howls[a]._getSoundIds(),f=0;f<l.length;f++){var p=n._howls[a]._soundById(l[f]);p&&p._node&&(p._node.muted=!!t||p._muted)}return n},stop:function(){for(var t=this||e,n=0;n<t._howls.length;n++)t._howls[n].stop();return t},unload:function(){for(var t=this||e,n=t._howls.length-1;n>=0;n--)t._howls[n].unload();return t.usingWebAudio&&t.ctx&&void 0!==t.ctx.close&&(t.ctx.close(),t.ctx=null,setupAudioContext()),t},codecs:function(t){return(this||e)._codecs[t.replace(/^x-/,"")]},_setup:function(){var t=this||e;if(t.state=t.ctx&&t.ctx.state||"suspended",t._autoSuspend(),!t.usingWebAudio)if("undefined"!=typeof Audio)try{void 0===(new Audio).oncanplaythrough&&(t._canPlayEvent="canplay")}catch(n){t.noAudio=!0}else t.noAudio=!0;try{(new Audio).muted&&(t.noAudio=!0)}catch(n){}return t.noAudio||t._setupCodecs(),t},_setupCodecs:function(){var t=this||e,n=null;try{n="undefined"!=typeof Audio?new Audio:null}catch(v){return t}if(!n||"function"!=typeof n.canPlayType)return t;var a=n.canPlayType("audio/mpeg;").replace(/^no$/,""),l=t._navigator?t._navigator.userAgent:"",f=l.match(/OPR\/([0-6].)/g),p=f&&parseInt(f[0].split("/")[1],10)<33,h=-1!==l.indexOf("Safari")&&-1===l.indexOf("Chrome"),m=l.match(/Version\/(.*?) /),g=h&&m&&parseInt(m[1],10)<15;return t._codecs={mp3:!(p||!a&&!n.canPlayType("audio/mp3;").replace(/^no$/,"")),mpeg:!!a,opus:!!n.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,""),ogg:!!n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),oga:!!n.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),wav:!!(n.canPlayType('audio/wav; codecs="1"')||n.canPlayType("audio/wav")).replace(/^no$/,""),aac:!!n.canPlayType("audio/aac;").replace(/^no$/,""),caf:!!n.canPlayType("audio/x-caf;").replace(/^no$/,""),m4a:!!(n.canPlayType("audio/x-m4a;")||n.canPlayType("audio/m4a;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),m4b:!!(n.canPlayType("audio/x-m4b;")||n.canPlayType("audio/m4b;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),mp4:!!(n.canPlayType("audio/x-mp4;")||n.canPlayType("audio/mp4;")||n.canPlayType("audio/aac;")).replace(/^no$/,""),weba:!(g||!n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),webm:!(g||!n.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")),dolby:!!n.canPlayType('audio/mp4; codecs="ec-3"').replace(/^no$/,""),flac:!!(n.canPlayType("audio/x-flac;")||n.canPlayType("audio/flac;")).replace(/^no$/,"")},t},_unlockAudio:function(){var t=this||e;if(!t._audioUnlocked&&t.ctx){t._audioUnlocked=!1,t.autoUnlock=!1,t._mobileUnloaded||44100===t.ctx.sampleRate||(t._mobileUnloaded=!0,t.unload()),t._scratchBuffer=t.ctx.createBuffer(1,1,22050);var unlock=function(e){for(;t._html5AudioPool.length<t.html5PoolSize;)try{var n=new Audio;n._unlocked=!0,t._releaseHtml5Audio(n)}catch(e){t.noAudio=!0;break}for(var a=0;a<t._howls.length;a++)if(!t._howls[a]._webAudio)for(var l=t._howls[a]._getSoundIds(),f=0;f<l.length;f++){var p=t._howls[a]._soundById(l[f]);p&&p._node&&!p._node._unlocked&&(p._node._unlocked=!0,p._node.load())}t._autoResume();var h=t.ctx.createBufferSource();h.buffer=t._scratchBuffer,h.connect(t.ctx.destination),void 0===h.start?h.noteOn(0):h.start(0),"function"==typeof t.ctx.resume&&t.ctx.resume(),h.onended=function(){h.disconnect(0),t._audioUnlocked=!0,document.removeEventListener("touchstart",unlock,!0),document.removeEventListener("touchend",unlock,!0),document.removeEventListener("click",unlock,!0),document.removeEventListener("keydown",unlock,!0);for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("unlock")}};return document.addEventListener("touchstart",unlock,!0),document.addEventListener("touchend",unlock,!0),document.addEventListener("click",unlock,!0),document.addEventListener("keydown",unlock,!0),t}},_obtainHtml5Audio:function(){var t=this||e;if(t._html5AudioPool.length)return t._html5AudioPool.pop();var n=(new Audio).play();return n&&"undefined"!=typeof Promise&&(n instanceof Promise||"function"==typeof n.then)&&n.catch((function(){console.warn("HTML5 Audio pool exhausted, returning potentially locked audio object.")})),new Audio},_releaseHtml5Audio:function(t){var n=this||e;return t._unlocked&&n._html5AudioPool.push(t),n},_autoSuspend:function(){var t=this;if(t.autoSuspend&&t.ctx&&void 0!==t.ctx.suspend&&e.usingWebAudio){for(var n=0;n<t._howls.length;n++)if(t._howls[n]._webAudio)for(var a=0;a<t._howls[n]._sounds.length;a++)if(!t._howls[n]._sounds[a]._paused)return t;return t._suspendTimer&&clearTimeout(t._suspendTimer),t._suspendTimer=setTimeout((function(){if(t.autoSuspend){t._suspendTimer=null,t.state="suspending";var handleSuspension=function(){t.state="suspended",t._resumeAfterSuspend&&(delete t._resumeAfterSuspend,t._autoResume())};t.ctx.suspend().then(handleSuspension,handleSuspension)}}),3e4),t}},_autoResume:function(){var t=this;if(t.ctx&&void 0!==t.ctx.resume&&e.usingWebAudio)return"running"===t.state&&"interrupted"!==t.ctx.state&&t._suspendTimer?(clearTimeout(t._suspendTimer),t._suspendTimer=null):"suspended"===t.state||"running"===t.state&&"interrupted"===t.ctx.state?(t.ctx.resume().then((function(){t.state="running";for(var e=0;e<t._howls.length;e++)t._howls[e]._emit("resume")})),t._suspendTimer&&(clearTimeout(t._suspendTimer),t._suspendTimer=null)):"suspending"===t.state&&(t._resumeAfterSuspend=!0),t}};var e=new HowlerGlobal,Howl=function(e){e.src&&0!==e.src.length?this.init(e):console.error("An array of source files must be passed with any new Howl.")};Howl.prototype={init:function(t){var n=this;return e.ctx||setupAudioContext(),n._autoplay=t.autoplay||!1,n._format="string"!=typeof t.format?t.format:[t.format],n._html5=t.html5||!1,n._muted=t.mute||!1,n._loop=t.loop||!1,n._pool=t.pool||5,n._preload="boolean"!=typeof t.preload&&"metadata"!==t.preload||t.preload,n._rate=t.rate||1,n._sprite=t.sprite||{},n._src="string"!=typeof t.src?t.src:[t.src],n._volume=void 0!==t.volume?t.volume:1,n._xhr={method:t.xhr&&t.xhr.method?t.xhr.method:"GET",headers:t.xhr&&t.xhr.headers?t.xhr.headers:null,withCredentials:!(!t.xhr||!t.xhr.withCredentials)&&t.xhr.withCredentials},n._duration=0,n._state="unloaded",n._sounds=[],n._endTimers={},n._queue=[],n._playLock=!1,n._onend=t.onend?[{fn:t.onend}]:[],n._onfade=t.onfade?[{fn:t.onfade}]:[],n._onload=t.onload?[{fn:t.onload}]:[],n._onloaderror=t.onloaderror?[{fn:t.onloaderror}]:[],n._onplayerror=t.onplayerror?[{fn:t.onplayerror}]:[],n._onpause=t.onpause?[{fn:t.onpause}]:[],n._onplay=t.onplay?[{fn:t.onplay}]:[],n._onstop=t.onstop?[{fn:t.onstop}]:[],n._onmute=t.onmute?[{fn:t.onmute}]:[],n._onvolume=t.onvolume?[{fn:t.onvolume}]:[],n._onrate=t.onrate?[{fn:t.onrate}]:[],n._onseek=t.onseek?[{fn:t.onseek}]:[],n._onunlock=t.onunlock?[{fn:t.onunlock}]:[],n._onresume=[],n._webAudio=e.usingWebAudio&&!n._html5,void 0!==e.ctx&&e.ctx&&e.autoUnlock&&e._unlockAudio(),e._howls.push(n),n._autoplay&&n._queue.push({event:"play",action:function(){n.play()}}),n._preload&&"none"!==n._preload&&n.load(),n},load:function(){var t=this,n=null;if(e.noAudio)t._emit("loaderror",null,"No audio support.");else{"string"==typeof t._src&&(t._src=[t._src]);for(var a=0;a<t._src.length;a++){var l,f;if(t._format&&t._format[a])l=t._format[a];else{if("string"!=typeof(f=t._src[a])){t._emit("loaderror",null,"Non-string found in selected audio sources - ignoring.");continue}(l=/^data:audio\/([^;,]+);/i.exec(f))||(l=/\.([^.]+)$/.exec(f.split("?",1)[0])),l&&(l=l[1].toLowerCase())}if(l||console.warn('No file extension was found. Consider using the "format" property or specify an extension.'),l&&e.codecs(l)){n=t._src[a];break}}if(n)return t._src=n,t._state="loading","https:"===window.location.protocol&&"http:"===n.slice(0,5)&&(t._html5=!0,t._webAudio=!1),new Sound(t),t._webAudio&&loadBuffer(t),t;t._emit("loaderror",null,"No codec support for selected audio sources.")}},play:function(t,n){var a=this,l=null;if("number"==typeof t)l=t,t=null;else{if("string"==typeof t&&"loaded"===a._state&&!a._sprite[t])return null;if(void 0===t&&(t="__default",!a._playLock)){for(var f=0,p=0;p<a._sounds.length;p++)a._sounds[p]._paused&&!a._sounds[p]._ended&&(f++,l=a._sounds[p]._id);1===f?t=null:l=null}}var h=l?a._soundById(l):a._inactiveSound();if(!h)return null;if(l&&!t&&(t=h._sprite||"__default"),"loaded"!==a._state){h._sprite=t,h._ended=!1;var m=h._id;return a._queue.push({event:"play",action:function(){a.play(m)}}),m}if(l&&!h._paused)return n||a._loadQueue("play"),h._id;a._webAudio&&e._autoResume();var g=Math.max(0,h._seek>0?h._seek:a._sprite[t][0]/1e3),v=Math.max(0,(a._sprite[t][0]+a._sprite[t][1])/1e3-g),y=1e3*v/Math.abs(h._rate),_=a._sprite[t][0]/1e3,b=(a._sprite[t][0]+a._sprite[t][1])/1e3;h._sprite=t,h._ended=!1;var setParams=function(){h._paused=!1,h._seek=g,h._start=_,h._stop=b,h._loop=!(!h._loop&&!a._sprite[t][2])};if(!(g>=b)){var C=h._node;if(a._webAudio){var playWebAudio=function(){a._playLock=!1,setParams(),a._refreshBuffer(h);var t=h._muted||a._muted?0:h._volume;C.gain.setValueAtTime(t,e.ctx.currentTime),h._playStart=e.ctx.currentTime,void 0===C.bufferSource.start?h._loop?C.bufferSource.noteGrainOn(0,g,86400):C.bufferSource.noteGrainOn(0,g,v):h._loop?C.bufferSource.start(0,g,86400):C.bufferSource.start(0,g,v),y!==1/0&&(a._endTimers[h._id]=setTimeout(a._ended.bind(a,h),y)),n||setTimeout((function(){a._emit("play",h._id),a._loadQueue()}),0)};"running"===e.state&&"interrupted"!==e.ctx.state?playWebAudio():(a._playLock=!0,a.once("resume",playWebAudio),a._clearTimer(h._id))}else{var playHtml5=function(){C.currentTime=g,C.muted=h._muted||a._muted||e._muted||C.muted,C.volume=h._volume*e.volume(),C.playbackRate=h._rate;try{var l=C.play();if(l&&"undefined"!=typeof Promise&&(l instanceof Promise||"function"==typeof l.then)?(a._playLock=!0,setParams(),l.then((function(){a._playLock=!1,C._unlocked=!0,n?a._loadQueue():a._emit("play",h._id)})).catch((function(){a._playLock=!1,a._emit("playerror",h._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction."),h._ended=!0,h._paused=!0}))):n||(a._playLock=!1,setParams(),a._emit("play",h._id)),C.playbackRate=h._rate,C.paused)return void a._emit("playerror",h._id,"Playback was unable to start. This is most commonly an issue on mobile devices and Chrome where playback was not within a user interaction.");"__default"!==t||h._loop?a._endTimers[h._id]=setTimeout(a._ended.bind(a,h),y):(a._endTimers[h._id]=function(){a._ended(h),C.removeEventListener("ended",a._endTimers[h._id],!1)},C.addEventListener("ended",a._endTimers[h._id],!1))}catch(f){a._emit("playerror",h._id,f)}};"data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA"===C.src&&(C.src=a._src,C.load());var S=window&&window.ejecta||!C.readyState&&e._navigator.isCocoonJS;if(C.readyState>=3||S)playHtml5();else{a._playLock=!0,a._state="loading";var listener=function(){a._state="loaded",playHtml5(),C.removeEventListener(e._canPlayEvent,listener,!1)};C.addEventListener(e._canPlayEvent,listener,!1),a._clearTimer(h._id)}}return h._id}a._ended(h)},pause:function(e){var t=this;if("loaded"!==t._state||t._playLock)return t._queue.push({event:"pause",action:function(){t.pause(e)}}),t;for(var n=t._getSoundIds(e),a=0;a<n.length;a++){t._clearTimer(n[a]);var l=t._soundById(n[a]);if(l&&!l._paused&&(l._seek=t.seek(n[a]),l._rateSeek=0,l._paused=!0,t._stopFade(n[a]),l._node))if(t._webAudio){if(!l._node.bufferSource)continue;void 0===l._node.bufferSource.stop?l._node.bufferSource.noteOff(0):l._node.bufferSource.stop(0),t._cleanBuffer(l._node)}else isNaN(l._node.duration)&&l._node.duration!==1/0||l._node.pause();arguments[1]||t._emit("pause",l?l._id:null)}return t},stop:function(e,t){var n=this;if("loaded"!==n._state||n._playLock)return n._queue.push({event:"stop",action:function(){n.stop(e)}}),n;for(var a=n._getSoundIds(e),l=0;l<a.length;l++){n._clearTimer(a[l]);var f=n._soundById(a[l]);f&&(f._seek=f._start||0,f._rateSeek=0,f._paused=!0,f._ended=!0,n._stopFade(a[l]),f._node&&(n._webAudio?f._node.bufferSource&&(void 0===f._node.bufferSource.stop?f._node.bufferSource.noteOff(0):f._node.bufferSource.stop(0),n._cleanBuffer(f._node)):isNaN(f._node.duration)&&f._node.duration!==1/0||(f._node.currentTime=f._start||0,f._node.pause(),f._node.duration===1/0&&n._clearSound(f._node))),t||n._emit("stop",f._id))}return n},mute:function(t,n){var a=this;if("loaded"!==a._state||a._playLock)return a._queue.push({event:"mute",action:function(){a.mute(t,n)}}),a;if(void 0===n){if("boolean"!=typeof t)return a._muted;a._muted=t}for(var l=a._getSoundIds(n),f=0;f<l.length;f++){var p=a._soundById(l[f]);p&&(p._muted=t,p._interval&&a._stopFade(p._id),a._webAudio&&p._node?p._node.gain.setValueAtTime(t?0:p._volume,e.ctx.currentTime):p._node&&(p._node.muted=!!e._muted||t),a._emit("mute",p._id))}return a},volume:function(){var t,n,a,l=this,f=arguments;if(0===f.length)return l._volume;if(1===f.length||2===f.length&&void 0===f[1]){var p=l._getSoundIds(),h=p.indexOf(f[0]);h>=0?n=parseInt(f[0],10):t=parseFloat(f[0])}else f.length>=2&&(t=parseFloat(f[0]),n=parseInt(f[1],10));if(!(void 0!==t&&t>=0&&t<=1))return(a=n?l._soundById(n):l._sounds[0])?a._volume:0;if("loaded"!==l._state||l._playLock)return l._queue.push({event:"volume",action:function(){l.volume.apply(l,f)}}),l;void 0===n&&(l._volume=t),n=l._getSoundIds(n);for(var m=0;m<n.length;m++)(a=l._soundById(n[m]))&&(a._volume=t,f[2]||l._stopFade(n[m]),l._webAudio&&a._node&&!a._muted?a._node.gain.setValueAtTime(t,e.ctx.currentTime):a._node&&!a._muted&&(a._node.volume=t*e.volume()),l._emit("volume",a._id));return l},fade:function(t,n,a,l){var f=this;if("loaded"!==f._state||f._playLock)return f._queue.push({event:"fade",action:function(){f.fade(t,n,a,l)}}),f;t=Math.min(Math.max(0,parseFloat(t)),1),n=Math.min(Math.max(0,parseFloat(n)),1),a=parseFloat(a),f.volume(t,l);for(var p=f._getSoundIds(l),h=0;h<p.length;h++){var m=f._soundById(p[h]);if(m){if(l||f._stopFade(p[h]),f._webAudio&&!m._muted){var g=e.ctx.currentTime,v=g+a/1e3;m._volume=t,m._node.gain.setValueAtTime(t,g),m._node.gain.linearRampToValueAtTime(n,v)}f._startFadeInterval(m,t,n,a,p[h],void 0===l)}}return f},_startFadeInterval:function(e,t,n,a,l,f){var p=this,h=t,m=n-t,g=Math.abs(m/.01),v=Math.max(4,g>0?a/g:a),y=Date.now();e._fadeTo=n,e._interval=setInterval((function(){var l=(Date.now()-y)/a;y=Date.now(),h+=m*l,h=Math.round(100*h)/100,h=m<0?Math.max(n,h):Math.min(n,h),p._webAudio?e._volume=h:p.volume(h,e._id,!0),f&&(p._volume=h),(n<t&&h<=n||n>t&&h>=n)&&(clearInterval(e._interval),e._interval=null,e._fadeTo=null,p.volume(n,e._id),p._emit("fade",e._id))}),v)},_stopFade:function(t){var n=this,a=n._soundById(t);return a&&a._interval&&(n._webAudio&&a._node.gain.cancelScheduledValues(e.ctx.currentTime),clearInterval(a._interval),a._interval=null,n.volume(a._fadeTo,t),a._fadeTo=null,n._emit("fade",t)),n},loop:function(){var e,t,n,a=this,l=arguments;if(0===l.length)return a._loop;if(1===l.length){if("boolean"!=typeof l[0])return!!(n=a._soundById(parseInt(l[0],10)))&&n._loop;e=l[0],a._loop=e}else 2===l.length&&(e=l[0],t=parseInt(l[1],10));for(var f=a._getSoundIds(t),p=0;p<f.length;p++)(n=a._soundById(f[p]))&&(n._loop=e,a._webAudio&&n._node&&n._node.bufferSource&&(n._node.bufferSource.loop=e,e&&(n._node.bufferSource.loopStart=n._start||0,n._node.bufferSource.loopEnd=n._stop,a.playing(f[p])&&(a.pause(f[p],!0),a.play(f[p],!0)))));return a},rate:function(){var t,n,a,l=this,f=arguments;if(0===f.length)n=l._sounds[0]._id;else if(1===f.length){var p=l._getSoundIds(),h=p.indexOf(f[0]);h>=0?n=parseInt(f[0],10):t=parseFloat(f[0])}else 2===f.length&&(t=parseFloat(f[0]),n=parseInt(f[1],10));if("number"!=typeof t)return(a=l._soundById(n))?a._rate:l._rate;if("loaded"!==l._state||l._playLock)return l._queue.push({event:"rate",action:function(){l.rate.apply(l,f)}}),l;void 0===n&&(l._rate=t),n=l._getSoundIds(n);for(var m=0;m<n.length;m++)if(a=l._soundById(n[m])){l.playing(n[m])&&(a._rateSeek=l.seek(n[m]),a._playStart=l._webAudio?e.ctx.currentTime:a._playStart),a._rate=t,l._webAudio&&a._node&&a._node.bufferSource?a._node.bufferSource.playbackRate.setValueAtTime(t,e.ctx.currentTime):a._node&&(a._node.playbackRate=t);var g=l.seek(n[m]),v=(l._sprite[a._sprite][0]+l._sprite[a._sprite][1])/1e3-g,y=1e3*v/Math.abs(a._rate);!l._endTimers[n[m]]&&a._paused||(l._clearTimer(n[m]),l._endTimers[n[m]]=setTimeout(l._ended.bind(l,a),y)),l._emit("rate",a._id)}return l},seek:function(){var t,n,a=this,l=arguments;if(0===l.length)a._sounds.length&&(n=a._sounds[0]._id);else if(1===l.length){var f=a._getSoundIds(),p=f.indexOf(l[0]);p>=0?n=parseInt(l[0],10):a._sounds.length&&(n=a._sounds[0]._id,t=parseFloat(l[0]))}else 2===l.length&&(t=parseFloat(l[0]),n=parseInt(l[1],10));if(void 0===n)return 0;if("number"==typeof t&&("loaded"!==a._state||a._playLock))return a._queue.push({event:"seek",action:function(){a.seek.apply(a,l)}}),a;var h=a._soundById(n);if(h){if(!("number"==typeof t&&t>=0)){if(a._webAudio){var m=a.playing(n)?e.ctx.currentTime-h._playStart:0,g=h._rateSeek?h._rateSeek-h._seek:0;return h._seek+(g+m*Math.abs(h._rate))}return h._node.currentTime}var v=a.playing(n);v&&a.pause(n,!0),h._seek=t,h._ended=!1,a._clearTimer(n),a._webAudio||!h._node||isNaN(h._node.duration)||(h._node.currentTime=t);var seekAndEmit=function(){v&&a.play(n,!0),a._emit("seek",n)};if(v&&!a._webAudio){var emitSeek=function(){a._playLock?setTimeout(emitSeek,0):seekAndEmit()};setTimeout(emitSeek,0)}else seekAndEmit()}return a},playing:function(e){var t=this;if("number"==typeof e){var n=t._soundById(e);return!!n&&!n._paused}for(var a=0;a<t._sounds.length;a++)if(!t._sounds[a]._paused)return!0;return!1},duration:function(e){var t=this,n=t._duration,a=t._soundById(e);return a&&(n=t._sprite[a._sprite][1]/1e3),n},state:function(){return this._state},unload:function(){for(var t=this,a=t._sounds,l=0;l<a.length;l++)a[l]._paused||t.stop(a[l]._id),t._webAudio||(t._clearSound(a[l]._node),a[l]._node.removeEventListener("error",a[l]._errorFn,!1),a[l]._node.removeEventListener(e._canPlayEvent,a[l]._loadFn,!1),a[l]._node.removeEventListener("ended",a[l]._endFn,!1),e._releaseHtml5Audio(a[l]._node)),delete a[l]._node,t._clearTimer(a[l]._id);var f=e._howls.indexOf(t);f>=0&&e._howls.splice(f,1);var p=!0;for(l=0;l<e._howls.length;l++)if(e._howls[l]._src===t._src||t._src.indexOf(e._howls[l]._src)>=0){p=!1;break}return n&&p&&delete n[t._src],e.noAudio=!1,t._state="unloaded",t._sounds=[],t=null,null},on:function(e,t,n,a){var l=this["_on"+e];return"function"==typeof t&&l.push(a?{id:n,fn:t,once:a}:{id:n,fn:t}),this},off:function(e,t,n){var a=this,l=a["_on"+e],f=0;if("number"==typeof t&&(n=t,t=null),t||n)for(f=0;f<l.length;f++){var p=n===l[f].id;if(t===l[f].fn&&p||!t&&p){l.splice(f,1);break}}else if(e)a["_on"+e]=[];else{var h=Object.keys(a);for(f=0;f<h.length;f++)0===h[f].indexOf("_on")&&Array.isArray(a[h[f]])&&(a[h[f]]=[])}return a},once:function(e,t,n){return this.on(e,t,n,1),this},_emit:function(e,t,n){for(var a=this,l=a["_on"+e],f=l.length-1;f>=0;f--)l[f].id&&l[f].id!==t&&"load"!==e||(setTimeout(function(e){e.call(this,t,n)}.bind(a,l[f].fn),0),l[f].once&&a.off(e,l[f].fn,l[f].id));return a._loadQueue(e),a},_loadQueue:function(e){var t=this;if(t._queue.length>0){var n=t._queue[0];n.event===e&&(t._queue.shift(),t._loadQueue()),e||n.action()}return t},_ended:function(t){var n=this,a=t._sprite;if(!n._webAudio&&t._node&&!t._node.paused&&!t._node.ended&&t._node.currentTime<t._stop)return setTimeout(n._ended.bind(n,t),100),n;var l=!(!t._loop&&!n._sprite[a][2]);if(n._emit("end",t._id),!n._webAudio&&l&&n.stop(t._id,!0).play(t._id),n._webAudio&&l){n._emit("play",t._id),t._seek=t._start||0,t._rateSeek=0,t._playStart=e.ctx.currentTime;var f=1e3*(t._stop-t._start)/Math.abs(t._rate);n._endTimers[t._id]=setTimeout(n._ended.bind(n,t),f)}return n._webAudio&&!l&&(t._paused=!0,t._ended=!0,t._seek=t._start||0,t._rateSeek=0,n._clearTimer(t._id),n._cleanBuffer(t._node),e._autoSuspend()),n._webAudio||l||n.stop(t._id,!0),n},_clearTimer:function(e){var t=this;if(t._endTimers[e]){if("function"!=typeof t._endTimers[e])clearTimeout(t._endTimers[e]);else{var n=t._soundById(e);n&&n._node&&n._node.removeEventListener("ended",t._endTimers[e],!1)}delete t._endTimers[e]}return t},_soundById:function(e){for(var t=this,n=0;n<t._sounds.length;n++)if(e===t._sounds[n]._id)return t._sounds[n];return null},_inactiveSound:function(){var e=this;e._drain();for(var t=0;t<e._sounds.length;t++)if(e._sounds[t]._ended)return e._sounds[t].reset();return new Sound(e)},_drain:function(){var e=this,t=e._pool,n=0,a=0;if(!(e._sounds.length<t)){for(a=0;a<e._sounds.length;a++)e._sounds[a]._ended&&n++;for(a=e._sounds.length-1;a>=0;a--){if(n<=t)return;e._sounds[a]._ended&&(e._webAudio&&e._sounds[a]._node&&e._sounds[a]._node.disconnect(0),e._sounds.splice(a,1),n--)}}},_getSoundIds:function(e){if(void 0===e){for(var t=[],n=0;n<this._sounds.length;n++)t.push(this._sounds[n]._id);return t}return[e]},_refreshBuffer:function(t){return t._node.bufferSource=e.ctx.createBufferSource(),t._node.bufferSource.buffer=n[this._src],t._panner?t._node.bufferSource.connect(t._panner):t._node.bufferSource.connect(t._node),t._node.bufferSource.loop=t._loop,t._loop&&(t._node.bufferSource.loopStart=t._start||0,t._node.bufferSource.loopEnd=t._stop||0),t._node.bufferSource.playbackRate.setValueAtTime(t._rate,e.ctx.currentTime),this},_cleanBuffer:function(t){var n=e._navigator&&e._navigator.vendor.indexOf("Apple")>=0;if(e._scratchBuffer&&t.bufferSource&&(t.bufferSource.onended=null,t.bufferSource.disconnect(0),n))try{t.bufferSource.buffer=e._scratchBuffer}catch(a){}return t.bufferSource=null,this},_clearSound:function(t){/MSIE |Trident\//.test(e._navigator&&e._navigator.userAgent)||(t.src="data:audio/wav;base64,UklGRigAAABXQVZFZm10IBIAAAABAAEARKwAAIhYAQACABAAAABkYXRhAgAAAAEA")}};var Sound=function(e){this._parent=e,this.init()};Sound.prototype={init:function(){var t=this,n=t._parent;return t._muted=n._muted,t._loop=n._loop,t._volume=n._volume,t._rate=n._rate,t._seek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++e._counter,n._sounds.push(t),t.create(),t},create:function(){var t=this,n=t._parent,a=e._muted||t._muted||t._parent._muted?0:t._volume;return n._webAudio?(t._node=void 0===e.ctx.createGain?e.ctx.createGainNode():e.ctx.createGain(),t._node.gain.setValueAtTime(a,e.ctx.currentTime),t._node.paused=!0,t._node.connect(e.masterGain)):e.noAudio||(t._node=e._obtainHtml5Audio(),t._errorFn=t._errorListener.bind(t),t._node.addEventListener("error",t._errorFn,!1),t._loadFn=t._loadListener.bind(t),t._node.addEventListener(e._canPlayEvent,t._loadFn,!1),t._endFn=t._endListener.bind(t),t._node.addEventListener("ended",t._endFn,!1),t._node.src=n._src,t._node.preload=!0===n._preload?"auto":n._preload,t._node.volume=a*e.volume(),t._node.load()),t},reset:function(){var t=this,n=t._parent;return t._muted=n._muted,t._loop=n._loop,t._volume=n._volume,t._rate=n._rate,t._seek=0,t._rateSeek=0,t._paused=!0,t._ended=!0,t._sprite="__default",t._id=++e._counter,t},_errorListener:function(){var e=this;e._parent._emit("loaderror",e._id,e._node.error?e._node.error.code:0),e._node.removeEventListener("error",e._errorFn,!1)},_loadListener:function(){var t=this,n=t._parent;n._duration=Math.ceil(10*t._node.duration)/10,0===Object.keys(n._sprite).length&&(n._sprite={__default:[0,1e3*n._duration]}),"loaded"!==n._state&&(n._state="loaded",n._emit("load"),n._loadQueue()),t._node.removeEventListener(e._canPlayEvent,t._loadFn,!1)},_endListener:function(){var e=this,t=e._parent;t._duration===1/0&&(t._duration=Math.ceil(10*e._node.duration)/10,t._sprite.__default[1]===1/0&&(t._sprite.__default[1]=1e3*t._duration),t._ended(e)),e._node.removeEventListener("ended",e._endFn,!1)}};var n={},loadBuffer=function(e){var t=e._src;if(n[t])return e._duration=n[t].duration,void loadSound(e);if(/^data:[^;]+;base64,/.test(t)){for(var a=atob(t.split(",")[1]),l=new Uint8Array(a.length),f=0;f<a.length;++f)l[f]=a.charCodeAt(f);decodeAudioData(l.buffer,e)}else{var p=new XMLHttpRequest;p.open(e._xhr.method,t,!0),p.withCredentials=e._xhr.withCredentials,p.responseType="arraybuffer",e._xhr.headers&&Object.keys(e._xhr.headers).forEach((function(t){p.setRequestHeader(t,e._xhr.headers[t])})),p.onload=function(){var t=(p.status+"")[0];"0"===t||"2"===t||"3"===t?decodeAudioData(p.response,e):e._emit("loaderror",null,"Failed loading audio file with status: "+p.status+".")},p.onerror=function(){e._webAudio&&(e._html5=!0,e._webAudio=!1,e._sounds=[],delete n[t],e.load())},safeXhrSend(p)}},safeXhrSend=function(e){try{e.send()}catch(t){e.onerror()}},decodeAudioData=function(t,a){var error=function(){a._emit("loaderror",null,"Decoding audio data failed.")},success=function(e){e&&a._sounds.length>0?(n[a._src]=e,loadSound(a,e)):error()};"undefined"!=typeof Promise&&1===e.ctx.decodeAudioData.length?e.ctx.decodeAudioData(t).then(success).catch(error):e.ctx.decodeAudioData(t,success,error)},loadSound=function(e,t){t&&!e._duration&&(e._duration=t.duration),0===Object.keys(e._sprite).length&&(e._sprite={__default:[0,1e3*e._duration]}),"loaded"!==e._state&&(e._state="loaded",e._emit("load"),e._loadQueue())},setupAudioContext=function(){if(e.usingWebAudio){try{"undefined"!=typeof AudioContext?e.ctx=new AudioContext:"undefined"!=typeof webkitAudioContext?e.ctx=new webkitAudioContext:e.usingWebAudio=!1}catch(f){e.usingWebAudio=!1}e.ctx||(e.usingWebAudio=!1);var t=/iP(hone|od|ad)/.test(e._navigator&&e._navigator.platform),n=e._navigator&&e._navigator.appVersion.match(/OS (\d+)_(\d+)_?(\d+)?/),a=n?parseInt(n[1],10):null;if(t&&a&&a<9){var l=/safari/.test(e._navigator&&e._navigator.userAgent.toLowerCase());e._navigator&&!l&&(e.usingWebAudio=!1)}e.usingWebAudio&&(e.masterGain=void 0===e.ctx.createGain?e.ctx.createGainNode():e.ctx.createGain(),e.masterGain.gain.setValueAtTime(e._muted?0:e._volume,e.ctx.currentTime),e.masterGain.connect(e.ctx.destination)),e._setup()}};t.Howler=e,t.Howl=Howl,void 0!==m?(m.HowlerGlobal=HowlerGlobal,m.Howler=e,m.Howl=Howl,m.Sound=Sound):"undefined"!=typeof window&&(window.HowlerGlobal=HowlerGlobal,window.Howler=e,window.Howl=Howl,window.Sound=Sound)}(),
/*!
 *  Spatial Plugin - Adds support for stereo and 3D audio where Web Audio is supported.
 *  
 *  howler.js v2.2.3
 *  howlerjs.com
 *
 *  (c) 2013-2020, James Simpson of GoldFire Studios
 *  goldfirestudios.com
 *
 *  MIT License
 */
function(){var e;HowlerGlobal.prototype._pos=[0,0,0],HowlerGlobal.prototype._orientation=[0,0,-1,0,1,0],HowlerGlobal.prototype.stereo=function(e){var t=this;if(!t.ctx||!t.ctx.listener)return t;for(var n=t._howls.length-1;n>=0;n--)t._howls[n].stereo(e);return t},HowlerGlobal.prototype.pos=function(e,t,n){var a=this;return a.ctx&&a.ctx.listener?(t="number"!=typeof t?a._pos[1]:t,n="number"!=typeof n?a._pos[2]:n,"number"!=typeof e?a._pos:(a._pos=[e,t,n],void 0!==a.ctx.listener.positionX?(a.ctx.listener.positionX.setTargetAtTime(a._pos[0],Howler.ctx.currentTime,.1),a.ctx.listener.positionY.setTargetAtTime(a._pos[1],Howler.ctx.currentTime,.1),a.ctx.listener.positionZ.setTargetAtTime(a._pos[2],Howler.ctx.currentTime,.1)):a.ctx.listener.setPosition(a._pos[0],a._pos[1],a._pos[2]),a)):a},HowlerGlobal.prototype.orientation=function(e,t,n,a,l,f){var p=this;if(!p.ctx||!p.ctx.listener)return p;var h=p._orientation;return t="number"!=typeof t?h[1]:t,n="number"!=typeof n?h[2]:n,a="number"!=typeof a?h[3]:a,l="number"!=typeof l?h[4]:l,f="number"!=typeof f?h[5]:f,"number"!=typeof e?h:(p._orientation=[e,t,n,a,l,f],void 0!==p.ctx.listener.forwardX?(p.ctx.listener.forwardX.setTargetAtTime(e,Howler.ctx.currentTime,.1),p.ctx.listener.forwardY.setTargetAtTime(t,Howler.ctx.currentTime,.1),p.ctx.listener.forwardZ.setTargetAtTime(n,Howler.ctx.currentTime,.1),p.ctx.listener.upX.setTargetAtTime(a,Howler.ctx.currentTime,.1),p.ctx.listener.upY.setTargetAtTime(l,Howler.ctx.currentTime,.1),p.ctx.listener.upZ.setTargetAtTime(f,Howler.ctx.currentTime,.1)):p.ctx.listener.setOrientation(e,t,n,a,l,f),p)},Howl.prototype.init=(e=Howl.prototype.init,function(t){var n=this;return n._orientation=t.orientation||[1,0,0],n._stereo=t.stereo||null,n._pos=t.pos||null,n._pannerAttr={coneInnerAngle:void 0!==t.coneInnerAngle?t.coneInnerAngle:360,coneOuterAngle:void 0!==t.coneOuterAngle?t.coneOuterAngle:360,coneOuterGain:void 0!==t.coneOuterGain?t.coneOuterGain:0,distanceModel:void 0!==t.distanceModel?t.distanceModel:"inverse",maxDistance:void 0!==t.maxDistance?t.maxDistance:1e4,panningModel:void 0!==t.panningModel?t.panningModel:"HRTF",refDistance:void 0!==t.refDistance?t.refDistance:1,rolloffFactor:void 0!==t.rolloffFactor?t.rolloffFactor:1},n._onstereo=t.onstereo?[{fn:t.onstereo}]:[],n._onpos=t.onpos?[{fn:t.onpos}]:[],n._onorientation=t.onorientation?[{fn:t.onorientation}]:[],e.call(this,t)}),Howl.prototype.stereo=function(e,t){var n=this;if(!n._webAudio)return n;if("loaded"!==n._state)return n._queue.push({event:"stereo",action:function(){n.stereo(e,t)}}),n;var a=void 0===Howler.ctx.createStereoPanner?"spatial":"stereo";if(void 0===t){if("number"!=typeof e)return n._stereo;n._stereo=e,n._pos=[e,0,0]}for(var l=n._getSoundIds(t),f=0;f<l.length;f++){var p=n._soundById(l[f]);if(p){if("number"!=typeof e)return p._stereo;p._stereo=e,p._pos=[e,0,0],p._node&&(p._pannerAttr.panningModel="equalpower",p._panner&&p._panner.pan||setupPanner(p,a),"spatial"===a?void 0!==p._panner.positionX?(p._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),p._panner.positionY.setValueAtTime(0,Howler.ctx.currentTime),p._panner.positionZ.setValueAtTime(0,Howler.ctx.currentTime)):p._panner.setPosition(e,0,0):p._panner.pan.setValueAtTime(e,Howler.ctx.currentTime)),n._emit("stereo",p._id)}}return n},Howl.prototype.pos=function(e,t,n,a){var l=this;if(!l._webAudio)return l;if("loaded"!==l._state)return l._queue.push({event:"pos",action:function(){l.pos(e,t,n,a)}}),l;if(t="number"!=typeof t?0:t,n="number"!=typeof n?-.5:n,void 0===a){if("number"!=typeof e)return l._pos;l._pos=[e,t,n]}for(var f=l._getSoundIds(a),p=0;p<f.length;p++){var h=l._soundById(f[p]);if(h){if("number"!=typeof e)return h._pos;h._pos=[e,t,n],h._node&&(h._panner&&!h._panner.pan||setupPanner(h,"spatial"),void 0!==h._panner.positionX?(h._panner.positionX.setValueAtTime(e,Howler.ctx.currentTime),h._panner.positionY.setValueAtTime(t,Howler.ctx.currentTime),h._panner.positionZ.setValueAtTime(n,Howler.ctx.currentTime)):h._panner.setPosition(e,t,n)),l._emit("pos",h._id)}}return l},Howl.prototype.orientation=function(e,t,n,a){var l=this;if(!l._webAudio)return l;if("loaded"!==l._state)return l._queue.push({event:"orientation",action:function(){l.orientation(e,t,n,a)}}),l;if(t="number"!=typeof t?l._orientation[1]:t,n="number"!=typeof n?l._orientation[2]:n,void 0===a){if("number"!=typeof e)return l._orientation;l._orientation=[e,t,n]}for(var f=l._getSoundIds(a),p=0;p<f.length;p++){var h=l._soundById(f[p]);if(h){if("number"!=typeof e)return h._orientation;h._orientation=[e,t,n],h._node&&(h._panner||(h._pos||(h._pos=l._pos||[0,0,-.5]),setupPanner(h,"spatial")),void 0!==h._panner.orientationX?(h._panner.orientationX.setValueAtTime(e,Howler.ctx.currentTime),h._panner.orientationY.setValueAtTime(t,Howler.ctx.currentTime),h._panner.orientationZ.setValueAtTime(n,Howler.ctx.currentTime)):h._panner.setOrientation(e,t,n)),l._emit("orientation",h._id)}}return l},Howl.prototype.pannerAttr=function(){var e,t,n,a=this,l=arguments;if(!a._webAudio)return a;if(0===l.length)return a._pannerAttr;if(1===l.length){if("object"!=typeof l[0])return(n=a._soundById(parseInt(l[0],10)))?n._pannerAttr:a._pannerAttr;e=l[0],void 0===t&&(e.pannerAttr||(e.pannerAttr={coneInnerAngle:e.coneInnerAngle,coneOuterAngle:e.coneOuterAngle,coneOuterGain:e.coneOuterGain,distanceModel:e.distanceModel,maxDistance:e.maxDistance,refDistance:e.refDistance,rolloffFactor:e.rolloffFactor,panningModel:e.panningModel}),a._pannerAttr={coneInnerAngle:void 0!==e.pannerAttr.coneInnerAngle?e.pannerAttr.coneInnerAngle:a._coneInnerAngle,coneOuterAngle:void 0!==e.pannerAttr.coneOuterAngle?e.pannerAttr.coneOuterAngle:a._coneOuterAngle,coneOuterGain:void 0!==e.pannerAttr.coneOuterGain?e.pannerAttr.coneOuterGain:a._coneOuterGain,distanceModel:void 0!==e.pannerAttr.distanceModel?e.pannerAttr.distanceModel:a._distanceModel,maxDistance:void 0!==e.pannerAttr.maxDistance?e.pannerAttr.maxDistance:a._maxDistance,refDistance:void 0!==e.pannerAttr.refDistance?e.pannerAttr.refDistance:a._refDistance,rolloffFactor:void 0!==e.pannerAttr.rolloffFactor?e.pannerAttr.rolloffFactor:a._rolloffFactor,panningModel:void 0!==e.pannerAttr.panningModel?e.pannerAttr.panningModel:a._panningModel})}else 2===l.length&&(e=l[0],t=parseInt(l[1],10));for(var f=a._getSoundIds(t),p=0;p<f.length;p++)if(n=a._soundById(f[p])){var h=n._pannerAttr;h={coneInnerAngle:void 0!==e.coneInnerAngle?e.coneInnerAngle:h.coneInnerAngle,coneOuterAngle:void 0!==e.coneOuterAngle?e.coneOuterAngle:h.coneOuterAngle,coneOuterGain:void 0!==e.coneOuterGain?e.coneOuterGain:h.coneOuterGain,distanceModel:void 0!==e.distanceModel?e.distanceModel:h.distanceModel,maxDistance:void 0!==e.maxDistance?e.maxDistance:h.maxDistance,refDistance:void 0!==e.refDistance?e.refDistance:h.refDistance,rolloffFactor:void 0!==e.rolloffFactor?e.rolloffFactor:h.rolloffFactor,panningModel:void 0!==e.panningModel?e.panningModel:h.panningModel};var m=n._panner;m?(m.coneInnerAngle=h.coneInnerAngle,m.coneOuterAngle=h.coneOuterAngle,m.coneOuterGain=h.coneOuterGain,m.distanceModel=h.distanceModel,m.maxDistance=h.maxDistance,m.refDistance=h.refDistance,m.rolloffFactor=h.rolloffFactor,m.panningModel=h.panningModel):(n._pos||(n._pos=a._pos||[0,0,-.5]),setupPanner(n,"spatial"))}return a},Sound.prototype.init=function(e){return function(){var t=this,n=t._parent;t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,e.call(this),t._stereo?n.stereo(t._stereo):t._pos&&n.pos(t._pos[0],t._pos[1],t._pos[2],t._id)}}(Sound.prototype.init),Sound.prototype.reset=function(e){return function(){var t=this,n=t._parent;return t._orientation=n._orientation,t._stereo=n._stereo,t._pos=n._pos,t._pannerAttr=n._pannerAttr,t._stereo?n.stereo(t._stereo):t._pos?n.pos(t._pos[0],t._pos[1],t._pos[2],t._id):t._panner&&(t._panner.disconnect(0),t._panner=void 0,n._refreshBuffer(t)),e.call(this)}}(Sound.prototype.reset);var setupPanner=function(e,t){"spatial"===(t=t||"spatial")?(e._panner=Howler.ctx.createPanner(),e._panner.coneInnerAngle=e._pannerAttr.coneInnerAngle,e._panner.coneOuterAngle=e._pannerAttr.coneOuterAngle,e._panner.coneOuterGain=e._pannerAttr.coneOuterGain,e._panner.distanceModel=e._pannerAttr.distanceModel,e._panner.maxDistance=e._pannerAttr.maxDistance,e._panner.refDistance=e._pannerAttr.refDistance,e._panner.rolloffFactor=e._pannerAttr.rolloffFactor,e._panner.panningModel=e._pannerAttr.panningModel,void 0!==e._panner.positionX?(e._panner.positionX.setValueAtTime(e._pos[0],Howler.ctx.currentTime),e._panner.positionY.setValueAtTime(e._pos[1],Howler.ctx.currentTime),e._panner.positionZ.setValueAtTime(e._pos[2],Howler.ctx.currentTime)):e._panner.setPosition(e._pos[0],e._pos[1],e._pos[2]),void 0!==e._panner.orientationX?(e._panner.orientationX.setValueAtTime(e._orientation[0],Howler.ctx.currentTime),e._panner.orientationY.setValueAtTime(e._orientation[1],Howler.ctx.currentTime),e._panner.orientationZ.setValueAtTime(e._orientation[2],Howler.ctx.currentTime)):e._panner.setOrientation(e._orientation[0],e._orientation[1],e._orientation[2])):(e._panner=Howler.ctx.createStereoPanner(),e._panner.pan.setValueAtTime(e._stereo,Howler.ctx.currentTime)),e._panner.connect(e._node),e._paused||e._parent.pause(e._id,!0).play(e._id,!0)}}()}));class Sound$1{constructor(e,t=0,n=!1){this.howler=null,this.tags=[],this.assets=e,this.maxTags=t,this.useHowler=n}load(){this.unload(),this.useHowler?this.howler||(this.howler=new v.Howl({src:this.assets})):this.addTag()}addTag(){const e=document.createElement("audio");e.setAttribute("preload","auto"),this.assets.forEach((t=>{const n=t.split(".").pop(),a="mp3"===n?"audio/mpeg":`audio/${n}`,l=document.createElement("source");l.setAttribute("src",t),l.setAttribute("type",a),e.appendChild(l)})),document.body.appendChild(e),e.pause&&e.pause(),this.tags.push(e)}unload(){var e;if(this.useHowler)null===(e=this.howler)||void 0===e||e.unload();else for(;this.tags.length;){const e=this.tags.shift();(null==e?void 0:e.parentNode)&&e.parentNode.removeChild(e)}}play(){var e;if(this.useHowler)this.howler||this.load(),null===(e=this.howler)||void 0===e||e.play();else{const e=this.tags.find((e=>e.paused||e.ended));if(!e){if(this.tags.length>=this.maxTags)return;return this.addTag(),void this.play()}const t=e.play();t&&t.catch((()=>{}))}}}!function(e){e.Suspended="web-ui-sound-suspended",e.Enabled="web-ui-sound-enabled"}(g||(g={}));let y=0,_=!1;function whenEnabled(e){!function waitMessage(e,t){window.addEventListener("message",(function listener(n){var a;(null===(a=null==n?void 0:n.data)||void 0===a?void 0:a.key)===e&&(t(),window.removeEventListener("message",listener))}))}(g.Enabled,e)}function enableSound(){isSuspended()&&resumeAudio((()=>{window.postMessage({key:g.Enabled},window.location.origin),function removeWindowEvents(e){l&&(l=!1,a.forEach((t=>window.removeEventListener(t,e))))}(enableSound)}))}function loadSound(e,t=5,n=!1){const f=new Sound$1(e,t,n);return isSuspended()?(!function addWindowEvents(e){l||(l=!0,a.forEach((t=>window.addEventListener(t,e))))}(enableSound),whenEnabled((()=>f.load()))):f.load(),f}function playSound(e){isSuspended()?!_&&y>3?(y=0,_=!0,window.postMessage({key:g.Suspended},window.location.origin)):_||(y++,enableSound(),whenEnabled((()=>e.play()))):e.play()}},5348:function(e,t,n){"use strict";var a=n(2939).flatMap,l=n(2939).guessBrowser,f=n(2939).guessBrowserVersion,p=n(1406).getSdpFormat,h=l(),m=f(),g="chrome"===h,v="firefox"===h,y="safari"===h,_=g?m.major:null;function standardizeChromeOrSafariActiveIceCandidatePairStats(e){var t=Array.from(e.values()).find((function(e){return"candidate-pair"===e.type&&e.nominated}));if(!t)return null;var n=e.get(t.localCandidateId),a=e.get(t.remoteCandidateId),l=[{key:"candidateType",type:"string"},{key:"ip",type:"string"},{key:"port",type:"number"},{key:"priority",type:"number"},{key:"protocol",type:"string"},{key:"url",type:"string"}],f=l.concat([{key:"deleted",type:"boolean"},{key:"relayProtocol",type:"string"}]),p=n?f.reduce((function(e,t){return e[t.key]=typeof n[t.key]===t.type?n[t.key]:"deleted"!==t.key&&null,e}),{}):null,h=a?l.reduce((function(e,t){return e[t.key]=typeof a[t.key]===t.type?a[t.key]:null,e}),{}):null;return[{key:"availableIncomingBitrate",type:"number"},{key:"availableOutgoingBitrate",type:"number"},{key:"bytesReceived",type:"number"},{key:"bytesSent",type:"number"},{key:"consentRequestsSent",type:"number"},{key:"currentRoundTripTime",type:"number"},{key:"lastPacketReceivedTimestamp",type:"number"},{key:"lastPacketSentTimestamp",type:"number"},{key:"nominated",type:"boolean"},{key:"priority",type:"number"},{key:"readable",type:"boolean"},{key:"requestsReceived",type:"number"},{key:"requestsSent",type:"number"},{key:"responsesReceived",type:"number"},{key:"responsesSent",type:"number"},{key:"retransmissionsReceived",type:"number"},{key:"retransmissionsSent",type:"number"},{key:"state",type:"string",fixup:function(e){return"inprogress"===e?"in-progress":e}},{key:"totalRoundTripTime",type:"number"},{key:"transportId",type:"string"},{key:"writable",type:"boolean"}].reduce((function(e,n){return e[n.key]=typeof t[n.key]===n.type?n.fixup?n.fixup(t[n.key]):t[n.key]:null,e}),{localCandidate:p,remoteCandidate:h})}function standardizeFirefoxActiveIceCandidatePairStats(e){var t=Array.from(e.values()).find((function(e){return"candidate-pair"===e.type&&e.nominated}));if(!t)return null;var n=e.get(t.localCandidateId),a=e.get(t.remoteCandidateId),l=[{key:"candidateType",type:"string"},{key:"ip",ffKeys:["address","ipAddress"],type:"string"},{key:"port",ffKeys:["portNumber"],type:"number"},{key:"priority",type:"number"},{key:"protocol",ffKeys:["transport"],type:"string"},{key:"url",type:"string"}],f=l.concat([{key:"deleted",type:"boolean"},{key:"relayProtocol",type:"string"}]),p={host:"host",peerreflexive:"prflx",relayed:"relay",serverreflexive:"srflx"},h=n?f.reduce((function(e,t){var a=t.ffKeys&&t.ffKeys.find((function(e){return e in n}))||t.key;return e[t.key]=typeof n[a]===t.type?"candidateType"===a&&p[n[a]]||n[a]:"deleted"!==a&&null,e}),{}):null,m=a?l.reduce((function(e,t){var n=t.ffKeys&&t.ffKeys.find((function(e){return e in a}))||t.key;return e[t.key]=typeof a[n]===t.type?"candidateType"===n&&p[a[n]]||a[n]:null,e}),{}):null;return[{key:"availableIncomingBitrate",type:"number"},{key:"availableOutgoingBitrate",type:"number"},{key:"bytesReceived",type:"number"},{key:"bytesSent",type:"number"},{key:"consentRequestsSent",type:"number"},{key:"currentRoundTripTime",type:"number"},{key:"lastPacketReceivedTimestamp",type:"number"},{key:"lastPacketSentTimestamp",type:"number"},{key:"nominated",type:"boolean"},{key:"priority",type:"number"},{key:"readable",type:"boolean"},{key:"requestsReceived",type:"number"},{key:"requestsSent",type:"number"},{key:"responsesReceived",type:"number"},{key:"responsesSent",type:"number"},{key:"retransmissionsReceived",type:"number"},{key:"retransmissionsSent",type:"number"},{key:"state",type:"string"},{key:"totalRoundTripTime",type:"number"},{key:"transportId",type:"string"},{key:"writable",type:"boolean"}].reduce((function(e,n){return e[n.key]=typeof t[n.key]===n.type?t[n.key]:null,e}),{localCandidate:h,remoteCandidate:m})}function getTracks(e,t,n){var l="local"===n?"getSenders":"getReceivers";return e[l]?e[l]().map((function(e){return e.track})).filter((function(e){return e&&e.kind===t})):a(e["local"===n?"getLocalStreams":"getRemoteStreams"](),(function(e){return e["audio"===t?"getAudioTracks":"getVideoTracks"]()}))}function chromeOrSafariGetTrackStats(e,t){return new Promise((function(n,a){_&&_<67?e.getStats((function(e){n([standardizeChromeLegacyStats(e,t)])}),null,a):e.getStats(t).then((function(e){n(function standardizeChromeOrSafariStats(e){var t=null,n=[],a=null,l=null,f=null,p=null;e.forEach((function(e){switch(e.type){case"inbound-rtp":t=e;break;case"outbound-rtp":n.push(e);break;case"track":f=e;break;case"codec":p=e;break;case"remote-inbound-rtp":a=e;break;case"remote-outbound-rtp":l=e}}));var h=f&&f.remoteSource,m=[],g=h?l:a;return(h?[t]:n).forEach((function(e){var t={},n=[e,f,p,g&&g.ssrc===e.ssrc?g:null];function getStatValue(e){var t=n.find((function(t){return t&&void 0!==t[e]}))||null;return t?t[e]:null}var a=getStatValue("ssrc");"number"==typeof a&&(t.ssrc=String(a));var l=getStatValue("timestamp");t.timestamp=Math.round(l);var v=getStatValue("mimeType");"string"==typeof v&&(v=v.split("/"),t.codecName=v[v.length-1]);var y=getStatValue("roundTripTime");"number"==typeof y&&(t.roundTripTime=Math.round(1e3*y));var _=getStatValue("jitter");"number"==typeof _&&(t.jitter=Math.round(1e3*_));var b=getStatValue("frameWidth");"number"==typeof b&&(h?t.frameWidthReceived=b:t.frameWidthSent=b);var C=getStatValue("frameHeight");"number"==typeof C&&(h?t.frameHeightReceived=C:t.frameHeightSent=C);var S=getStatValue("framesPerSecond");"number"==typeof S&&(t.frameRateSent=S);var k=getStatValue("bytesReceived");"number"==typeof k&&(t.bytesReceived=k);var w=getStatValue("bytesSent");"number"==typeof w&&(t.bytesSent=w);var T=getStatValue("packetsLost");"number"==typeof T&&(t.packetsLost=T);var P=getStatValue("packetsReceived");"number"==typeof P&&(t.packetsReceived=P);var A=getStatValue("packetsSent");"number"==typeof A&&(t.packetsSent=A);var M=getStatValue("audioLevel");"number"==typeof M&&(M=Math.round(32767*M),h?t.audioOutputLevel=M:t.audioInputLevel=M);var x=getStatValue("totalPacketSendDelay");"number"==typeof x&&(t.totalPacketSendDelay=x);var O=getStatValue("totalEncodeTime");"number"==typeof O&&(t.totalEncodeTime=O);var R=getStatValue("framesEncoded");"number"==typeof R&&(t.framesEncoded=R);var I=getStatValue("estimatedPlayoutTimestamp");"number"==typeof I&&(t.estimatedPlayoutTimestamp=I);var L=getStatValue("totalDecodeTime");"number"==typeof L&&(t.totalDecodeTime=L);var N=getStatValue("framesDecoded");"number"==typeof N&&(t.framesDecoded=N);var D=getStatValue("jitterBufferDelay");"number"==typeof D&&(t.jitterBufferDelay=D);var B=getStatValue("jitterBufferEmittedCount");"number"==typeof B&&(t.jitterBufferEmittedCount=B),m.push(t)})),m}(e))}),a)}))}function standardizeChromeLegacyStats(e,t){var n=e.result().find((function(e){return"ssrc"===e.type&&e.stat("googTrackId")===t.id})),a={};return n&&(a.timestamp=Math.round(Number(n.timestamp)),a=n.names().reduce((function(e,t){switch(t){case"googCodecName":e.codecName=n.stat(t);break;case"googRtt":e.roundTripTime=Number(n.stat(t));break;case"googJitterReceived":e.jitter=Number(n.stat(t));break;case"googFrameWidthInput":e.frameWidthInput=Number(n.stat(t));break;case"googFrameHeightInput":e.frameHeightInput=Number(n.stat(t));break;case"googFrameWidthSent":e.frameWidthSent=Number(n.stat(t));break;case"googFrameHeightSent":e.frameHeightSent=Number(n.stat(t));break;case"googFrameWidthReceived":e.frameWidthReceived=Number(n.stat(t));break;case"googFrameHeightReceived":e.frameHeightReceived=Number(n.stat(t));break;case"googFrameRateInput":e.frameRateInput=Number(n.stat(t));break;case"googFrameRateSent":e.frameRateSent=Number(n.stat(t));break;case"googFrameRateReceived":e.frameRateReceived=Number(n.stat(t));break;case"ssrc":e[t]=n.stat(t);break;case"bytesReceived":case"bytesSent":case"packetsLost":case"packetsReceived":case"packetsSent":case"audioInputLevel":case"audioOutputLevel":e[t]=Number(n.stat(t))}return e}),a)),a}function standardizeFirefoxStats(e,t){e=e||new Map;var n=null,a=null;e.forEach((function(t){if(!t.isRemote)switch(t.type){case"inbound-rtp":n=t,a=e.get(t.remoteId);break;case"outbound-rtp":a=t,n=e.get(t.remoteId)}}));var l=t?n:a,f=t?a:n;function getStatValue(e){return l&&void 0!==l[e]?l[e]:f&&void 0!==f[e]?f[e]:null}var p={},h=getStatValue("timestamp");p.timestamp=Math.round(h);var m=getStatValue("ssrc");"number"==typeof m&&(p.ssrc=String(m));var g=getStatValue("bytesSent");"number"==typeof g&&(p.bytesSent=g);var v=getStatValue("packetsLost");"number"==typeof v&&(p.packetsLost=v);var y=getStatValue("packetsSent");"number"==typeof y&&(p.packetsSent=y);var _=getStatValue("roundTripTime");"number"==typeof _&&(p.roundTripTime=Math.round(1e3*_));var b=getStatValue("jitter");"number"==typeof b&&(p.jitter=Math.round(1e3*b));var C=getStatValue("framerateMean");"number"==typeof C&&(p.frameRateSent=Math.round(C));var S=getStatValue("bytesReceived");"number"==typeof S&&(p.bytesReceived=S);var k=getStatValue("packetsReceived");"number"==typeof k&&(p.packetsReceived=k);var w=getStatValue("framerateMean");"number"==typeof w&&(p.frameRateReceived=Math.round(w));var T=getStatValue("totalPacketSendDelay");"number"==typeof T&&(p.totalPacketSendDelay=T);var P=getStatValue("totalEncodeTime");"number"==typeof P&&(p.totalEncodeTime=P);var A=getStatValue("framesEncoded");"number"==typeof A&&(p.framesEncoded=A);var M=getStatValue("estimatedPlayoutTimestamp");"number"==typeof M&&(p.estimatedPlayoutTimestamp=M);var x=getStatValue("totalDecodeTime");"number"==typeof x&&(p.totalDecodeTime=x);var O=getStatValue("framesDecoded");"number"==typeof O&&(p.framesDecoded=O);var R=getStatValue("jitterBufferDelay");"number"==typeof R&&(p.jitterBufferDelay=R);var I=getStatValue("jitterBufferEmittedCount");return"number"==typeof I&&(p.jitterBufferEmittedCount=I),p}e.exports=function getStats(e,t){return e&&"function"==typeof e.getStats?function _getStats(e,t){var n=getTracks(e,"audio","local"),l=getTracks(e,"video","local"),f=getTracks(e,"audio"),h=getTracks(e,"video"),m={activeIceCandidatePair:null,localAudioTrackStats:[],localVideoTrackStats:[],remoteAudioTrackStats:[],remoteVideoTrackStats:[]},_=a([[n,"localAudioTrackStats",!1],[l,"localVideoTrackStats",!1],[f,"remoteAudioTrackStats",!0],[h,"remoteVideoTrackStats",!0]],(function(n){var a=n[0],l=n[1],f=n[2];return a.map((function(n){return function getTrackStats(e,t,n){if(void 0!==(n=n||{}).testForChrome||g)return chromeOrSafariGetTrackStats(e,t);if(void 0!==n.testForFirefox||v)return function firefoxGetTrackStats(e,t,n){return new Promise((function(a,l){e.getStats(t).then((function(e){a([standardizeFirefoxStats(e,n)])}),l)}))}(e,t,n.isRemote);if(void 0!==n.testForSafari||y)return void 0!==n.testForSafari||"unified"===p()?chromeOrSafariGetTrackStats(e,t):Promise.reject(new Error(["getStats() is not supported on this version of Safari","due to this bug: https://bugs.webkit.org/show_bug.cgi?id=192601"].join(" ")));return Promise.reject(new Error("RTCPeerConnection#getStats() not supported"))}(e,n,Object.assign({isRemote:f},t)).then((function(e){e.forEach((function(e){e.trackId=n.id,m[l].push(e)}))}))}))}));return Promise.all(_).then((function(){return function getActiveIceCandidatePairStats(e,t){if(void 0!==(t=t||{}).testForChrome||g||void 0!==t.testForSafari||y)return e.getStats().then(standardizeChromeOrSafariActiveIceCandidatePairStats);if(void 0!==t.testForFirefox||v)return e.getStats().then(standardizeFirefoxActiveIceCandidatePairStats);return Promise.reject(new Error("RTCPeerConnection#getStats() not supported"))}(e,t)})).then((function(e){return m.activeIceCandidatePair=e,m}))}(e,t):Promise.reject(new Error("Given PeerConnection does not support getStats"))}},3045:function(e){"use strict";e.exports=function getUserMedia(e){return"object"==typeof navigator&&"object"==typeof navigator.mediaDevices&&"function"==typeof navigator.mediaDevices.getUserMedia?(e=e||{audio:!0,video:!0},navigator.mediaDevices.getUserMedia(e)):Promise.reject(new Error("getUserMedia is not supported"))}},3819:function(e,t,n){"use strict";var a={};Object.defineProperties(a,{getStats:{enumerable:!0,value:n(5348)},getUserMedia:{enumerable:!0,value:n(3045)},MediaStream:{enumerable:!0,value:n(8240)},MediaStreamTrack:{enumerable:!0,value:n(1742)},RTCIceCandidate:{enumerable:!0,value:n(1284)},RTCPeerConnection:{enumerable:!0,value:n(6745)},RTCSessionDescription:{enumerable:!0,value:n(7454)},version:{enumerable:!0,value:n(8720).i8}}),e.exports=a},8240:function(e){"use strict";"function"==typeof MediaStream?e.exports=MediaStream:e.exports=function MediaStream(){throw new Error("MediaStream is not supported")}},1742:function(e){"use strict";"function"==typeof MediaStreamTrack?e.exports=MediaStreamTrack:e.exports=function MediaStreamTrack(){throw new Error("MediaStreamTrack is not supported")}},1284:function(e){"use strict";"function"==typeof RTCIceCandidate?e.exports=RTCIceCandidate:e.exports=function RTCIceCandidate(){throw new Error("RTCIceCandidate is not supported")}},6010:function(e,t,n){"use strict";var a=n(5366),l=n(3488),f=n(9539).inherits,p=n(7372),h=n(8240),m=n(4286),g=n(1406),v=n(2939),y=n(2939).isIOSChrome,_="unified"===g.getSdpFormat();function ChromeRTCPeerConnection(e,t){if(!(this instanceof ChromeRTCPeerConnection))return new ChromeRTCPeerConnection(e,t);l.call(this),e=e||{};var n=Object.assign(e.iceTransportPolicy?{iceTransports:e.iceTransportPolicy}:{},e);v.interceptEvent(this,"datachannel"),v.interceptEvent(this,"signalingstatechange");var a=g.getSdpFormat(n.sdpSemantics),f=new RTCPeerConnection(n,t);Object.defineProperties(this,{_appliedTracksToSSRCs:{value:new Map,writable:!0},_localStream:{value:new h},_peerConnection:{value:f},_pendingLocalOffer:{value:null,writable:!0},_pendingRemoteOffer:{value:null,writable:!0},_rolledBackTracksToSSRCs:{value:new Map,writable:!0},_sdpFormat:{value:a},_senders:{value:new Map},_signalingStateLatch:{value:new p},_tracksToSSRCs:{value:new Map,writable:!0},localDescription:{enumerable:!0,get:function(){return this._pendingLocalOffer?this._pendingLocalOffer:f.localDescription}},remoteDescription:{enumerable:!0,get:function(){return this._pendingRemoteOffer?this._pendingRemoteOffer:f.remoteDescription}},signalingState:{enumerable:!0,get:function(){return this._pendingLocalOffer?"have-local-offer":this._pendingRemoteOffer?"have-remote-offer":f.signalingState}}});var m=this;f.addEventListener("datachannel",(function ondatachannel(e){shimDataChannel(e.channel),m.dispatchEvent(e)})),f.addEventListener("signalingstatechange",(function onsignalingstatechange(){"stable"===f.signalingState&&(m._appliedTracksToSSRCs=new Map(m._tracksToSSRCs)),m._pendingLocalOffer||m._pendingRemoteOffer||m.dispatchEvent.apply(m,arguments)})),f.ontrack=function ontrack(){},"function"!=typeof RTCPeerConnection.prototype.addTrack&&f.addStream(this._localStream),v.proxyProperties(RTCPeerConnection.prototype,this,f)}function setDescription(e,t,n){var a,l=t?e._pendingLocalOffer:e._pendingRemoteOffer,f=t?e._pendingRemoteOffer:e._pendingLocalOffer,p=t?"have-local-offer":"have-remote-offer",h=t?"setLocalDescription":"setRemoteDescription";if(!t&&f&&"answer"===n.type)a=function setRemoteAnswer(e,t){var n=e._pendingLocalOffer;return e._peerConnection.setLocalDescription(n).then((function setLocalOfferSucceeded(){return e._pendingLocalOffer=null,e.setRemoteDescription(t)})).then((function setRemoteAnswerSucceeded(){e._signalingStateLatch.lower()}))}(e,n);else if("offer"===n.type){if(e.signalingState!==p&&"stable"!==e.signalingState)return Promise.reject(new Error("Cannot set "+(t?"local":"remote")+" offer in state "+e.signalingState));l||"low"!==e._signalingStateLatch.state||e._signalingStateLatch.raise();var m=e.signalingState;!function setPendingLocalOffer(n){t?e._pendingLocalOffer=n:e._pendingRemoteOffer=n}(unwrap(n)),a=Promise.resolve(),e.signalingState!==m&&a.then((function dispatchSignalingStateChangeEvent(){e.dispatchEvent(new Event("signalingstatechange"))}))}else"rollback"===n.type&&(e.signalingState!==p?a=Promise.reject(new Error("Cannot rollback "+(t?"local":"remote")+" description in "+e.signalingState)):(!function clearPendingLocalOffer(){t?e._pendingLocalOffer=null:e._pendingRemoteOffer=null}(),e._rolledBackTracksToSSRCs=new Map(e._tracksToSSRCs),e._tracksToSSRCs=new Map(e._appliedTracksToSSRCs),(a=Promise.resolve()).then((function dispatchSignalingStateChangeEvent(){e.dispatchEvent(new Event("signalingstatechange"))}))));return a||e._peerConnection[h](unwrap(n))}function hasReceiversForTracksOfKind(e,t){return!!e.getTransceivers().find((function(e){return e.receiver&&e.receiver.track&&e.receiver.track.kind===t}))}function unwrap(e){return e instanceof a&&e._description?e._description:new RTCSessionDescription(e)}function needsMaxPacketLifeTimeShim(){return"maxRetransmitTime"in RTCDataChannel.prototype&&!("maxPacketLifeTime"in RTCDataChannel.prototype)}function shimDataChannel(e){return Object.defineProperty(e,"maxRetransmits",{value:65535===e.maxRetransmits?null:e.maxRetransmits}),needsMaxPacketLifeTimeShim()&&Object.defineProperty(e,"maxPacketLifeTime",{value:65535===e.maxRetransmitTime?null:e.maxRetransmitTime}),e}function updateTrackIdsToSSRCs(e,t,n){return"unified"===e?g.updateUnifiedPlanTrackIdsToSSRCs(t,n):g.updatePlanBTrackIdsToSSRCs(t,n)}f(ChromeRTCPeerConnection,l),"function"!=typeof RTCPeerConnection.prototype.addTrack?(ChromeRTCPeerConnection.prototype.addTrack=function addTrack(){var e=[].slice.call(arguments),t=e[0];if("closed"===this._peerConnection.signalingState)throw new Error("Cannot add MediaStreamTrack ["+t.id+", "+t.kind+"]: RTCPeerConnection is closed");var n=this._senders.get(t);if(n&&n.track)throw new Error("Cannot add MediaStreamTrack ["+t.id+", "+t.kind+"]: RTCPeerConnection already has it");return this._peerConnection.removeStream(this._localStream),this._localStream.addTrack(t),this._peerConnection.addStream(this._localStream),n=new m(t),this._senders.set(t,n),n},ChromeRTCPeerConnection.prototype.removeTrack=function removeTrack(e){if("closed"===this._peerConnection.signalingState)throw new Error("Cannot remove MediaStreamTrack: RTCPeerConnection is closed");var t=e.track;t&&(e=this._senders.get(t))&&e.track&&(e.track=null,this._peerConnection.removeStream(this._localStream),this._localStream.removeTrack(t),this._peerConnection.addStream(this._localStream))},ChromeRTCPeerConnection.prototype.getSenders=function getSenders(){return Array.from(this._senders.values())}):ChromeRTCPeerConnection.prototype.removeTrack=function removeTrack(e){if("closed"===this._peerConnection.signalingState)throw new Error("Cannot remove MediaStreamTrack: RTCPeerConnection is closed");try{this._peerConnection.removeTrack(e)}catch(t){}},ChromeRTCPeerConnection.prototype.addIceCandidate=function addIceCandidate(e){var t,n=[].slice.call(arguments),a=this;return t="have-remote-offer"===this.signalingState?this._signalingStateLatch.when("low").then((function signalingStatesResolved(){return a._peerConnection.addIceCandidate(e)})):this._peerConnection.addIceCandidate(e),n.length>1?v.legacyPromise(t,n[1],n[2]):t},ChromeRTCPeerConnection.prototype.close=function close(){"closed"!==this.signalingState&&(this._pendingLocalOffer=null,this._pendingRemoteOffer=null,this._peerConnection.close())},ChromeRTCPeerConnection.prototype.createAnswer=function createAnswer(){var e,t=[].slice.call(arguments),n=this;return e=this._pendingRemoteOffer?this._peerConnection.setRemoteDescription(this._pendingRemoteOffer).then((function setRemoteDescriptionSucceeded(){return n._signalingStateLatch.lower(),n._peerConnection.createAnswer()})).then((function createAnswerSucceeded(e){return n._pendingRemoteOffer=null,n._rolledBackTracksToSSRCs.clear(),new a({type:"answer",sdp:updateTrackIdsToSSRCs(n._sdpFormat,n._tracksToSSRCs,e.sdp)})}),(function setRemoteDescriptionOrCreateAnswerFailed(e){throw n._pendingRemoteOffer=null,e})):this._peerConnection.createAnswer().then((function(e){return n._rolledBackTracksToSSRCs.clear(),new a({type:"answer",sdp:updateTrackIdsToSSRCs(n._sdpFormat,n._tracksToSSRCs,e.sdp)})})),t.length>1?v.legacyPromise(e,t[0],t[1]):e},ChromeRTCPeerConnection.prototype.createOffer=function createOffer(){var e=[].slice.call(arguments),t=(e.length>1?e[2]:e[0])||{},n=this;if(y()){if(t.offerToReceiveVideo&&!this._audioTransceiver&&(!_||!hasReceiversForTracksOfKind(this,"audio"))){delete t.offerToReceiveAudio;try{this._audioTransceiver=_?this.addTransceiver("audio",{direction:"recvonly"}):this.addTransceiver("audio")}catch(f){return Promise.reject(f)}}if(t.offerToReceiveVideo&&!this._videoTransceiver&&(!_||!hasReceiversForTracksOfKind(this,"video"))){delete t.offerToReceiveVideo;try{this._videoTransceiver=_?this.addTransceiver("video",{direction:"recvonly"}):this.addTransceiver("video")}catch(f){return Promise.reject(f)}}}var l=this._peerConnection.createOffer(t).then((function(e){return n._rolledBackTracksToSSRCs.clear(),new a({type:e.type,sdp:updateTrackIdsToSSRCs(n._sdpFormat,n._tracksToSSRCs,e.sdp)})}));return e.length>1?v.legacyPromise(l,e[0],e[1]):l},ChromeRTCPeerConnection.prototype.createDataChannel=function createDataChannel(e,t){t=function shimDataChannelInit(e){e=Object.assign({},e),needsMaxPacketLifeTimeShim()&&"maxPacketLifeTime"in e&&(e.maxRetransmitTime=e.maxPacketLifeTime);return e}(t);var n=this._peerConnection.createDataChannel(e,t);return shimDataChannel(n),n},ChromeRTCPeerConnection.prototype.setLocalDescription=function setLocalDescription(){var e=[].slice.call(arguments),t=e[0];this._rolledBackTracksToSSRCs.size>0&&(this._tracksToSSRCs=new Map(this._rolledBackTracksToSSRCs),this._rolledBackTracksToSSRCs.clear());var n=setDescription(this,!0,t);return e.length>1?v.legacyPromise(n,e[1],e[2]):n},ChromeRTCPeerConnection.prototype.setRemoteDescription=function setRemoteDescription(){var e=[].slice.call(arguments),t=e[0];this._rolledBackTracksToSSRCs.clear();var n=setDescription(this,!1,t);return e.length>1?v.legacyPromise(n,e[1],e[2]):n},v.delegateMethods(RTCPeerConnection.prototype,ChromeRTCPeerConnection.prototype,"_peerConnection"),e.exports=ChromeRTCPeerConnection},2112:function(e,t,n){"use strict";var a=n(3488),l=n(9265),f=n(9539).inherits,p=n(1406).updateUnifiedPlanTrackIdsToSSRCs,h=n(2939),m="object"==typeof navigator&&navigator.userAgent&&(navigator.userAgent.match(/Firefox\/61/)||navigator.userAgent.match(/Firefox\/62/));function FirefoxRTCPeerConnection(e){if(!(this instanceof FirefoxRTCPeerConnection))return new FirefoxRTCPeerConnection(e);a.call(this),h.interceptEvent(this,"signalingstatechange");var t=new RTCPeerConnection(e);Object.defineProperties(this,{_initiallyNegotiatedDtlsRole:{value:null,writable:!0},_isClosed:{value:!1,writable:!0},_peerConnection:{value:t},_rollingBack:{value:!1,writable:!0},_tracksToSSRCs:{value:new Map},iceGatheringState:{enumerable:!0,get:function(){return this._isClosed?"complete":this._peerConnection.iceGatheringState}},localDescription:{enumerable:!0,get:function(){return overwriteWithInitiallyNegotiatedDtlsRole(this._peerConnection.localDescription,this._initiallyNegotiatedDtlsRole)}},signalingState:{enumerable:!0,get:function(){return this._isClosed?"closed":this._peerConnection.signalingState}}});var n,l=this;t.addEventListener("signalingstatechange",(function onsignalingstatechange(){if(!l._rollingBack&&l.signalingState!==n){n=l.signalingState;var e=l.dispatchEvent.apply.bind(l.dispatchEvent,l,arguments);l._isClosed?setTimeout(e):e()}})),h.proxyProperties(RTCPeerConnection.prototype,this,t)}function rollback(e,t,n){var a=t?"setLocalDescription":"setRemoteDescription";return e._rollingBack=!0,e._peerConnection[a](new l({type:"rollback"})).then(n).then((function onceRolledBackSucceeded(t){return e._rollingBack=!1,t}),(function rollbackOrOnceRolledBackFailed(t){throw e._rollingBack=!1,t}))}function saveInitiallyNegotiatedDtlsRole(e,t,n){if(!e._initiallyNegotiatedDtlsRole&&"offer"!==t.type){var a=t.sdp.match(/a=setup:([a-z]+)/);if(a){var l=a[1];e._initiallyNegotiatedDtlsRole=n?{active:"passive",passive:"active"}[l]:l}}}function overwriteWithInitiallyNegotiatedDtlsRole(e,t){return e&&"answer"===e.type&&t?new l({type:e.type,sdp:e.sdp.replace(/a=setup:[a-z]+/g,"a=setup:"+t)}):e}f(FirefoxRTCPeerConnection,a),Object.defineProperty(FirefoxRTCPeerConnection.prototype,"peerIdentity",{enumerable:!0,value:Promise.resolve({idp:"",name:""})}),m&&(FirefoxRTCPeerConnection.prototype.addTrack=function addTrack(){var e=arguments[0],t=this._peerConnection.addTrack.apply(this._peerConnection,arguments);return t.replaceTrack(e),t}),FirefoxRTCPeerConnection.prototype.createAnswer=function createAnswer(){var e,t=[].slice.call(arguments),n=this;return e=this._peerConnection.createAnswer().then((function createAnswerSucceeded(e){return saveInitiallyNegotiatedDtlsRole(n,e),overwriteWithInitiallyNegotiatedDtlsRole(e,n._initiallyNegotiatedDtlsRole)})),"function"==typeof t[0]?h.legacyPromise(e,t[0],t[1]):e},FirefoxRTCPeerConnection.prototype.createOffer=function createOffer(){var e,t=[].slice.call(arguments),n=(t.length>1?t[2]:t[0])||{},a=this;if("have-local-offer"===this.signalingState||"have-remote-offer"===this.signalingState){var f="have-local-offer"===this.signalingState;e=rollback(this,f,(function rollbackSucceeded(){return a.createOffer(n)}))}else e=a._peerConnection.createOffer(n);return e=e.then((function(e){return new l({type:e.type,sdp:p(a._tracksToSSRCs,e.sdp)})})),t.length>1?h.legacyPromise(e,t[0],t[1]):e},FirefoxRTCPeerConnection.prototype.setLocalDescription=function setLocalDescription(){var e,t=[].slice.call(arguments),n=t[0];return n&&"answer"===n.type&&"have-local-offer"===this.signalingState&&(e=Promise.reject(new Error("Cannot set local answer in state have-local-offer"))),e?t.length>1?h.legacyPromise(e,t[1],t[2]):e:this._peerConnection.setLocalDescription.apply(this._peerConnection,t)},FirefoxRTCPeerConnection.prototype.setRemoteDescription=function setRemoteDescription(){var e,t=[].slice.call(arguments),n=t[0],a=this;return n&&"have-remote-offer"===this.signalingState&&("answer"===n.type?e=Promise.reject(new Error("Cannot set remote answer in state have-remote-offer")):"offer"===n.type&&(e=rollback(this,!1,(function rollbackSucceeded(){return a._peerConnection.setRemoteDescription(n)})))),e||(e=this._peerConnection.setRemoteDescription(n)),e=e.then((function setRemoteDescriptionSucceeded(){saveInitiallyNegotiatedDtlsRole(a,n,!0)})),t.length>1?h.legacyPromise(e,t[1],t[2]):e},FirefoxRTCPeerConnection.prototype.close=function close(){"closed"!==this.signalingState&&(this._isClosed=!0,this._peerConnection.close())},h.delegateMethods(RTCPeerConnection.prototype,FirefoxRTCPeerConnection.prototype,"_peerConnection"),e.exports=FirefoxRTCPeerConnection},6745:function(e,t,n){"use strict";if("function"==typeof RTCPeerConnection)switch((0,n(2939).guessBrowser)()){case"chrome":e.exports=n(6010);break;case"firefox":e.exports=n(2112);break;case"safari":e.exports=n(9928);break;default:e.exports=RTCPeerConnection}else e.exports=function RTCPeerConnection(){throw new Error("RTCPeerConnection is not supported")}},9928:function(e,t,n){"use strict";var a=n(3488),l=n(9539).inherits,f=n(7372),p=n(1406),h=n(2939),m="unified"===p.getSdpFormat(),g=m?p.updateUnifiedPlanTrackIdsToSSRCs:p.updatePlanBTrackIdsToSSRCs;function SafariRTCPeerConnection(e){if(!(this instanceof SafariRTCPeerConnection))return new SafariRTCPeerConnection(e);a.call(this),h.interceptEvent(this,"datachannel"),h.interceptEvent(this,"iceconnectionstatechange"),h.interceptEvent(this,"signalingstatechange"),h.interceptEvent(this,"track");var t=new RTCPeerConnection(e);Object.defineProperties(this,{_appliedTracksToSSRCs:{value:new Map,writable:!0},_audioTransceiver:{value:null,writable:!0},_isClosed:{value:!1,writable:!0},_peerConnection:{value:t},_pendingLocalOffer:{value:null,writable:!0},_pendingRemoteOffer:{value:null,writable:!0},_rolledBackTracksToSSRCs:{value:new Map,writable:!0},_signalingStateLatch:{value:new f},_tracksToSSRCs:{value:new Map,writable:!0},_videoTransceiver:{value:null,writable:!0},localDescription:{enumerable:!0,get:function(){return this._pendingLocalOffer||this._peerConnection.localDescription}},iceConnectionState:{enumerable:!0,get:function(){return this._isClosed?"closed":this._peerConnection.iceConnectionState}},iceGatheringState:{enumerable:!0,get:function(){return this._isClosed?"complete":this._peerConnection.iceGatheringState}},remoteDescription:{enumerable:!0,get:function(){return this._pendingRemoteOffer||this._peerConnection.remoteDescription}},signalingState:{enumerable:!0,get:function(){return this._isClosed?"closed":this._pendingLocalOffer?"have-local-offer":this._pendingRemoteOffer?"have-remote-offer":this._peerConnection.signalingState}}});var n=this;t.addEventListener("datachannel",(function ondatachannel(e){shimDataChannel(e.channel),n.dispatchEvent(e)})),t.addEventListener("iceconnectionstatechange",(function oniceconnectionstatechange(){n._isClosed||n.dispatchEvent.apply(n,arguments)})),t.addEventListener("signalingstatechange",(function onsignalingstatechange(){n._isClosed||("stable"===t.signalingState&&(n._appliedTracksToSSRCs=new Map(n._tracksToSSRCs)),n._pendingLocalOffer||n._pendingRemoteOffer||n.dispatchEvent.apply(n,arguments))})),t.addEventListener("track",(function ontrack(e){n._pendingRemoteOffer=null,n.dispatchEvent(e)})),h.proxyProperties(RTCPeerConnection.prototype,this,t)}function setDescription(e,t,n){var a=t?e._pendingLocalOffer:e._pendingRemoteOffer,l=t?e._pendingRemoteOffer:e._pendingLocalOffer,f=t?"have-local-offer":"have-remote-offer",p=t?"setLocalDescription":"setRemoteDescription";if(!t&&l&&"answer"===n.type)return function setRemoteAnswer(e,t){var n=e._pendingLocalOffer;return e._peerConnection.setLocalDescription(n).then((function setLocalOfferSucceeded(){return e._pendingLocalOffer=null,e.setRemoteDescription(t)})).then((function setRemoteAnswerSucceeded(){e._signalingStateLatch.lower()}))}(e,n);if("offer"===n.type){if(e.signalingState!==f&&"stable"!==e.signalingState)return Promise.reject(new Error("Cannot set "+(t?"local":"remote")+" offer in state "+e.signalingState));a||"low"!==e._signalingStateLatch.state||e._signalingStateLatch.raise();var h=e.signalingState;return function setPendingLocalOffer(n){t?e._pendingLocalOffer=n:e._pendingRemoteOffer=n}(n),e.signalingState!==h?Promise.resolve().then((function dispatchSignalingStateChangeEvent(){e.dispatchEvent(new Event("signalingstatechange"))})):Promise.resolve()}return"rollback"===n.type?e.signalingState!==f?Promise.reject(new Error("Cannot rollback "+(t?"local":"remote")+" description in "+e.signalingState)):(function clearPendingLocalOffer(){t?e._pendingLocalOffer=null:e._pendingRemoteOffer=null}(),e._rolledBackTracksToSSRCs=new Map(e._tracksToSSRCs),e._tracksToSSRCs=new Map(e._appliedTracksToSSRCs),Promise.resolve().then((function dispatchSignalingStateChangeEvent(){e.dispatchEvent(new Event("signalingstatechange"))}))):e._peerConnection[p](n)}function hasReceiversForTracksOfKind(e,t){return!!e.getTransceivers().find((function(e){return e.receiver&&e.receiver.track&&e.receiver.track.kind===t}))}function shimDataChannel(e){return Object.defineProperties(e,{maxPacketLifeTime:{value:65535===e.maxPacketLifeTime?null:e.maxPacketLifeTime},maxRetransmits:{value:65535===e.maxRetransmits?null:e.maxRetransmits}})}l(SafariRTCPeerConnection,a),SafariRTCPeerConnection.prototype.addIceCandidate=function addIceCandidate(e){var t=this;return"have-remote-offer"===this.signalingState?this._signalingStateLatch.when("low").then((function signalingStatesResolved(){return t._peerConnection.addIceCandidate(e)})):this._peerConnection.addIceCandidate(e)},SafariRTCPeerConnection.prototype.createOffer=function createOffer(e){e=Object.assign({},e);var t=this;if(e.offerToReceiveVideo&&!this._audioTransceiver&&(!m||!hasReceiversForTracksOfKind(this,"audio"))){delete e.offerToReceiveAudio;try{this._audioTransceiver=m?this.addTransceiver("audio",{direction:"recvonly"}):this.addTransceiver("audio")}catch(n){return Promise.reject(n)}}if(e.offerToReceiveVideo&&!this._videoTransceiver&&(!m||!hasReceiversForTracksOfKind(this,"video"))){delete e.offerToReceiveVideo;try{this._videoTransceiver=m?this.addTransceiver("video",{direction:"recvonly"}):this.addTransceiver("video")}catch(n){return Promise.reject(n)}}return this._peerConnection.createOffer(e).then((function(e){return t._rolledBackTracksToSSRCs.clear(),new RTCSessionDescription({type:e.type,sdp:g(t._tracksToSSRCs,e.sdp)})}))},SafariRTCPeerConnection.prototype.createAnswer=function createAnswer(e){var t=this;return this._pendingRemoteOffer?this._peerConnection.setRemoteDescription(this._pendingRemoteOffer).then((function setRemoteDescriptionSucceeded(){return t._signalingStateLatch.lower(),t._peerConnection.createAnswer()})).then((function createAnswerSucceeded(e){return t._pendingRemoteOffer=null,t._rolledBackTracksToSSRCs.clear(),m?new RTCSessionDescription({type:e.type,sdp:g(t._tracksToSSRCs,e.sdp)}):e}),(function setRemoteDescriptionOrCreateAnswerFailed(e){throw t._pendingRemoteOffer=null,e})):this._peerConnection.createAnswer(e).then((function createAnswerSucceeded(e){return t._rolledBackTracksToSSRCs.clear(),m?new RTCSessionDescription({type:e.type,sdp:g(t._tracksToSSRCs,e.sdp)}):e}))},SafariRTCPeerConnection.prototype.createDataChannel=function createDataChannel(e,t){var n=this._peerConnection.createDataChannel(e,t);return shimDataChannel(n),n},SafariRTCPeerConnection.prototype.removeTrack=function removeTrack(e){e.replaceTrack(null),this._peerConnection.removeTrack(e)},SafariRTCPeerConnection.prototype.setLocalDescription=function setLocalDescription(e){return this._rolledBackTracksToSSRCs.size>0&&(this._tracksToSSRCs=new Map(this._rolledBackTracksToSSRCs),this._rolledBackTracksToSSRCs.clear()),setDescription(this,!0,e)},SafariRTCPeerConnection.prototype.setRemoteDescription=function setRemoteDescription(e){return this._rolledBackTracksToSSRCs.clear(),setDescription(this,!1,e)},SafariRTCPeerConnection.prototype.close=function close(){if(!this._isClosed){this._isClosed=!0,this._peerConnection.close();var e=this;setTimeout((function(){e.dispatchEvent(new Event("iceconnectionstatechange")),e.dispatchEvent(new Event("signalingstatechange"))}))}},h.delegateMethods(RTCPeerConnection.prototype,SafariRTCPeerConnection.prototype,"_peerConnection"),e.exports=SafariRTCPeerConnection},4286:function(e){"use strict";e.exports=function RTCRtpSenderShim(e){Object.defineProperties(this,{track:{enumerable:!0,value:e,writable:!0}})}},5366:function(e){"use strict";e.exports=function ChromeRTCSessionDescription(e){if(!(this instanceof ChromeRTCSessionDescription))return new ChromeRTCSessionDescription(e);var t=e&&"rollback"===e.type?null:new RTCSessionDescription(e);Object.defineProperties(this,{_description:{get:function(){return t}},sdp:{enumerable:!0,value:t?t.sdp:e.sdp},type:{enumerable:!0,value:t?t.type:e.type}})}},9265:function(e){"use strict";e.exports=RTCSessionDescription},7454:function(e,t,n){"use strict";if("function"==typeof RTCSessionDescription)switch((0,n(2939).guessBrowser)()){case"chrome":e.exports=n(5366);break;case"firefox":e.exports=n(9265);break;default:e.exports=RTCSessionDescription}else e.exports=function RTCSessionDescription(){throw new Error("RTCSessionDescription is not supported")}},3488:function(e,t,n){"use strict";var a=n(7187).EventEmitter;function EventTarget(){Object.defineProperties(this,{_eventEmitter:{value:new a}})}EventTarget.prototype.dispatchEvent=function dispatchEvent(e){return this._eventEmitter.emit(e.type,e)},EventTarget.prototype.addEventListener=function addEventListener(){return this._eventEmitter.addListener.apply(this._eventEmitter,arguments)},EventTarget.prototype.removeEventListener=function removeEventListener(){return this._eventEmitter.removeListener.apply(this._eventEmitter,arguments)},e.exports=EventTarget},2939:function(e,t){"use strict";function delegateMethod(e,t,n,a){if(!(a in t)&&!a.match(/^on[a-z]+$/)){var l=!1;try{var f=Object.getOwnPropertyDescriptor(e,a);l=f&&!!f.get}catch(h){}if(!l){var p;try{p=typeof e[a]}catch(h){}"function"===p&&(t[a]=function(){return this[n][a].apply(this[n],arguments)})}}}function getUserAgent(){return"undefined"!=typeof navigator&&"string"==typeof navigator.userAgent?navigator.userAgent:null}function guessBrowser(e){return void 0===e&&(e=getUserAgent()),/Chrome|CriOS/.test(e)?"chrome":/Firefox|FxiOS/.test(e)?"firefox":/Safari/.test(e)?"safari":null}t.defer=function defer(){var e={};return e.promise=new Promise((function(t,n){e.resolve=t,e.reject=n})),e},t.delegateMethods=function delegateMethods(e,t,n){for(var a in e)delegateMethod(e,t,n,a)},t.difference=function difference(e,t){e=Array.isArray(e)?new Set(e):new Set(e.values()),t=Array.isArray(t)?new Set(t):new Set(t.values());var n=new Set;return e.forEach((function(e){t.has(e)||n.add(e)})),n},t.flatMap=function flatMap(e,t){return(e instanceof Map||e instanceof Set?Array.from(e.values()):e).reduce((function(e,n){var a=t(n);return e.concat(a)}),[])},t.guessBrowser=guessBrowser,t.guessBrowserVersion=function guessBrowserVersion(e){void 0===e&&(e=getUserAgent());var t={chrome:"Chrome|CriOS",firefox:"Firefox|FxiOS",safari:"Version"}[guessBrowser(e)];if(!t)return null;var n=new RegExp("("+t+")/([^\\s]+)"),a=(e.match(n)||[])[2];if(!a)return null;var l=a.split(".").map(Number);return{major:isNaN(l[0])?null:l[0],minor:isNaN(l[1])?null:l[1]}},t.isIOSChrome=function isIOSChrome(e){return void 0===e&&(e=getUserAgent()),/Mobi/.test(e)&&"chrome"===guessBrowser()&&/iPad|iPhone|iPod/.test(e)},t.interceptEvent=function interceptEvent(e,t){var n=null;Object.defineProperty(e,"on"+t,{get:function(){return n},set:function(e){n&&this.removeEventListener(t,n),"function"==typeof e?(n=e,this.addEventListener(t,n)):n=null}})},t.legacyPromise=function legacyPromise(e,t,n){return t?e.then((function(e){t(e)}),(function(e){n(e)})):e},t.makeUUID=function makeUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.proxyProperties=function proxyProperties(e,t,n){Object.getOwnPropertyNames(e).forEach((function(e){!function proxyProperty(e,t,n,a){if(a in t)return;if(a.match(/^on[a-z]+$/))return Object.defineProperty(t,a,{value:null,writable:!0}),void n.addEventListener(a.slice(2),(function(){t.dispatchEvent.apply(t,arguments)}));Object.defineProperty(t,a,{enumerable:!0,get:function(){return n[a]}})}(0,t,n,e)}))},t.support=function support(){return"object"==typeof navigator&&"object"==typeof navigator.mediaDevices&&"function"==typeof navigator.mediaDevices.getUserMedia&&"function"==typeof RTCPeerConnection}},7372:function(e,t,n){"use strict";var a=n(2939).defer,l={high:new Set(["low"]),low:new Set(["high"])};function Latch(e){if(!(this instanceof Latch))return new Latch(e);var t=e||"low";Object.defineProperties(this,{_state:{set:function(e){if(t!==e){t=e;var n=this._whenDeferreds.get(t);n.forEach((function(e){e.resolve(this)}),this),n.clear()}},get:function(){return t}},_whenDeferreds:{value:new Map([["high",new Set],["low",new Set]])},state:{enumerable:!0,get:function(){return this._state}}})}function createUnreachableStateError(e,t){return new Error('Cannot transition from "'+e+'" to "'+t+'"')}Latch.prototype.lower=function lower(){return this.transition("low")},Latch.prototype.raise=function raise(){return this.transition("high")},Latch.prototype.transition=function transition(e){if(!l[this.state].has(e))throw createUnreachableStateError(this.state,e);return this._state=e,this},Latch.prototype.when=function when(e){if(this.state===e)return Promise.resolve(this);if(!l[this.state].has(e))return Promise.reject(createUnreachableStateError(this.state,e));var t=a();return this._whenDeferreds.get(e).add(t),t.promise},e.exports=Latch},1406:function(e,t,n){"use strict";var a=n(2939).flatMap,l=n(2939).guessBrowser,f=null;var p=null;function getChromeSdpFormat(e){return e&&function checkIfSdpSemanticsIsSupported(){if("boolean"==typeof f)return f;if("undefined"==typeof RTCPeerConnection)return f=!1;try{new RTCPeerConnection({sdpSemantics:"foo"}),f=!1}catch(e){f=!0}return f}()?{"plan-b":"planb","unified-plan":"unified"}[e]:function getChromeDefaultSdpFormat(){if(!p)if("undefined"!=typeof RTCPeerConnection&&"addTransceiver"in RTCPeerConnection.prototype)try{(new RTCPeerConnection).addTransceiver("audio"),p="unified"}catch(e){p="planb"}else p="planb";return p}()}function getMatches(e,t){return(t.match(new RegExp(e,"gm"))||[]).reduce((function(t,n){var a=n.match(new RegExp(e));return a?t.add(a[1]):t}),new Set)}function getTrackIds(e,t){return getMatches(e,t)}function getPlanBTrackIds(e){return getTrackIds("^a=ssrc:[0-9]+ +msid:.+ +(.+) *$",e)}function getUnifiedPlanTrackIds(e){return getTrackIds("^a=msid:.+ +(.+) *$",e)}function getPlanBSSRCs(e,t){return getMatches("^a=ssrc:([0-9]+) +msid:[^ ]+ +"+t+" *$",e)}function getMediaSections(e,t,n){return t=t||".*",n=n||".*",e.split("\r\nm=").slice(1).map((function(e){return"m="+e})).filter((function(e){var a=new RegExp("m="+t,"gm"),l=new RegExp("a="+n,"gm");return a.test(e)&&l.test(e)}))}function getMediaSectionSSRCs(e){return Array.from(getMatches("^a=ssrc:([0-9]+) +.*$",e))}function getUnifiedPlanSSRCs(e,t){var n=getMediaSections(e),l=new RegExp("^a=msid:[^ ]+ +"+t+" *$","gm"),f=n.filter((function(e){return e.match(l)}));return new Set(a(f,getMediaSectionSSRCs))}function getTrackIdsToSSRCs(e,t,n){return new Map(Array.from(e(n)).map((function(e){return[e,t(n,e)]})))}function getPlanBTrackIdsToSSRCs(e){return getTrackIdsToSSRCs(getPlanBTrackIds,getPlanBSSRCs,e)}function getUnifiedPlanTrackIdsToSSRCs(e){return getTrackIdsToSSRCs(getUnifiedPlanTrackIds,getUnifiedPlanSSRCs,e)}function updateTrackIdsToSSRCs(e,t,n){var a=e(n),l=new Map;a.forEach((function(e,a){if(t.has(a)){var f=Array.from(t.get(a)),p=Array.from(e);f.forEach((function(e,t){var a=p[t];l.set(a,e);var f="^a=ssrc:"+a+" (.*)$",h="a=ssrc:"+e+" $1";n=n.replace(new RegExp(f,"gm"),h)}))}else t.set(a,e)}));var f="^(a=ssrc-group:[^ ]+ +)(.*)$";return(n.match(new RegExp(f,"gm"))||[]).forEach((function(e){var t=e.match(new RegExp(f));if(t){var a=t[1],p=t[2].split(" ").map((function(e){var t=l.get(e);return t||e})).join(" ");n=n.replace(t[0],a+p)}})),n}t.getSdpFormat=function getSdpFormat(e){return{chrome:getChromeSdpFormat(e),firefox:"unified",safari:"undefined"!=typeof RTCRtpTransceiver&&"currentDirection"in RTCRtpTransceiver.prototype?"unified":"planb"}[l()]||null},t.getMediaSections=getMediaSections,t.getPlanBTrackIds=getPlanBTrackIds,t.getUnifiedPlanTrackIds=getUnifiedPlanTrackIds,t.getPlanBSSRCs=getPlanBSSRCs,t.getUnifiedPlanSSRCs=getUnifiedPlanSSRCs,t.updatePlanBTrackIdsToSSRCs=function updatePlanBTrackIdsToSSRCs(e,t){return updateTrackIdsToSSRCs(getPlanBTrackIdsToSSRCs,e,t)},t.updateUnifiedPlanTrackIdsToSSRCs=function updateUnifiedPlanTrackIdsToSSRCs(e,t){return updateTrackIdsToSSRCs(getUnifiedPlanTrackIdsToSSRCs,e,t)}},835:function(e,t,n){"use strict";n.d(t,{Fl:function(){return computed},aZ:function(){return defineComponent},qj:function(){return reactive},iH:function(){return ref}});var a=n(3182);function isNative(e){return"function"==typeof e&&/native code/.test(e.toString())}var l="undefined"!=typeof Symbol&&isNative(Symbol)&&"undefined"!=typeof Reflect&&isNative(Reflect.ownKeys),noopFn=function(e){return e},f={enumerable:!0,configurable:!0,get:noopFn,set:noopFn};function proxy(e,t,n){var a=n.get,l=n.set;f.get=a||noopFn,f.set=l||noopFn,Object.defineProperty(e,t,f)}function def(e,t,n,a){Object.defineProperty(e,t,{value:n,enumerable:!!a,writable:!0,configurable:!0})}function hasOwn(e,t){return Object.hasOwnProperty.call(e,t)}function isArray(e){return Array.isArray(e)}function isPlainObject(e){return"[object Object]"===function(e){return Object.prototype.toString.call(e)}(e)}function isFunction(e){return"function"==typeof e}function warn(e,t){a.default.util.warn(e,t)}var p=void 0;try{var h=n(3182);h&&isVue(h)?p=h:h&&"default"in h&&isVue(h.default)&&(p=h.default)}catch(P){}var m=null,g=null,v="__composition_api_installed__";function isVue(e){return e&&"function"==typeof e&&"Vue"===e.name}function getVueConstructor(){return m}function setCurrentInstance(e){g=e}function getCurrentInstance(){return g?toVue3ComponentInstance(g):null}var y,_=new WeakMap;function toVue3ComponentInstance(e){if(_.has(e))return _.get(e);var t={proxy:e,update:e.$forceUpdate,uid:e._uid,emit:e.$emit.bind(e),parent:null,root:null};return["data","props","attrs","refs","vnode","slots"].forEach((function(n){proxy(t,n,{get:function(){return e["$"+n]}})})),proxy(t,"isMounted",{get:function(){return e._isMounted}}),proxy(t,"isUnmounted",{get:function(){return e._isDestroyed}}),proxy(t,"isDeactivated",{get:function(){return e._inactive}}),proxy(t,"emitted",{get:function(){return e._events}}),_.set(e,t),e.$parent&&(t.parent=toVue3ComponentInstance(e.$parent)),e.$root&&(t.root=toVue3ComponentInstance(e.$root)),t}function currentVMInFn(e){var t=getCurrentInstance();return null==t?void 0:t.proxy}function defineComponentInstance(e,t){void 0===t&&(t={});var n=e.config.silent;e.config.silent=!0;var a=new e(t);return e.config.silent=n,a}function createSlotProxy(e,t){return function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];return e.$scopedSlots[t]?e.$scopedSlots[t].apply(e,n):warn("slots."+t+'() got called outside of the "render()" scope',e)}}function __values(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],a=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function __read(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p}function __spread(){for(var e=[],t=0;t<arguments.length;t++)e=e.concat(__read(arguments[t]));return e}function createSymbol(e){return l?Symbol.for(e):e}createSymbol("composition-api.preFlushQueue"),createSymbol("composition-api.postFlushQueue");var b="composition-api.refKey",C=new WeakMap,S=(new WeakMap,new WeakMap),k=function k(e){proxy(this,"value",{get:e.get,set:e.set})};function createRef(e,t){var n=new k(e),a=Object.seal(n);return S.set(a,!0),a}function ref(e){var t;if(isRef(e))return e;var n=reactive(((t={})[b]=e,t));return createRef({get:function(){return n[b]},set:function(e){return n[b]=e}})}function isRef(e){return e instanceof k}function toRef(e,t){var n=e[t];return isRef(n)?n:createRef({get:function(){return e[t]},set:function(n){return e[t]=n}})}function isRaw(e){var t;return Boolean((null==e?void 0:e.__ob__)&&(null===(t=e.__ob__)||void 0===t?void 0:t.__raw__))}function isReactive(e){var t;return Boolean((null==e?void 0:e.__ob__)&&!(null===(t=e.__ob__)||void 0===t?void 0:t.__raw__))}function setupAccessControl(e){if(!(!isPlainObject(e)||isRaw(e)||Array.isArray(e)||isRef(e)||function isComponentInstance(e){var t=getVueConstructor();return t&&e instanceof t}(e)||C.has(e))){C.set(e,!0);for(var t=Object.keys(e),n=0;n<t.length;n++)defineAccessControl(e,t[n])}}function defineAccessControl(e,t,n){if("__ob__"!==t&&!isRaw(e[t])){var a,l,f=Object.getOwnPropertyDescriptor(e,t);if(f){if(!1===f.configurable)return;a=f.get,l=f.set,a&&!l||2!==arguments.length||(n=e[t])}setupAccessControl(n),Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:function getterHandler(){var l=a?a.call(e):n;return t!==b&&isRef(l)?l.value:l},set:function setterHandler(f){if(!a||l){var p=a?a.call(e):n;t!==b&&isRef(p)&&!isRef(f)?p.value=f:l?l.call(e,f):n=f,setupAccessControl(f)}}})}}function observe(e){var t,n=function getRegisteredVueOrDefault(){return m||p}();n.observable?t=n.observable(e):t=defineComponentInstance(n,{data:{$$state:e}})._data.$$state;return hasOwn(t,"__ob__")||def(t,"__ob__",function mockObserver(e){void 0===e&&(e={});return{value:e,dep:{notify:noopFn,depend:noopFn,addSub:noopFn,removeSub:noopFn}}}(t)),t}function createObserver(){return observe({}).__ob__}function reactive(e){if(!isPlainObject(e)&&!isArray(e)||isRaw(e)||!Object.isExtensible(e))return e;var t=observe(e);return setupAccessControl(t),t}function createLifeCycle(e){return function(t){var n,a=currentVMInFn(((n=e)[0].toUpperCase(),n.slice(1)));a&&function injectHookOption(e,t,n,a){var l=t.$options,f=e.config.optionMergeStrategies[n];l[n]=f(l[n],function wrapHookCall(e,t){return function(){for(var n,a=[],l=0;l<arguments.length;l++)a[l]=arguments[l];var f=null===(n=getCurrentInstance())||void 0===n?void 0:n.proxy;setCurrentInstance(e);try{return t.apply(void 0,__spread(a))}finally{setCurrentInstance(f)}}}(t,a))}(getVueConstructor(),a,e,t)}}createLifeCycle("beforeMount"),createLifeCycle("mounted"),createLifeCycle("beforeUpdate"),createLifeCycle("updated"),createLifeCycle("beforeDestroy"),createLifeCycle("destroyed"),createLifeCycle("errorCaptured"),createLifeCycle("activated"),createLifeCycle("deactivated"),createLifeCycle("serverPrefetch");function computed(e){var t,n,a,l,f,p=null===(t=getCurrentInstance())||void 0===t?void 0:t.proxy;if("function"==typeof e?n=e:(n=e.get,a=e.set),p&&!p.$isServer){var h,m=function(){if(!y){var e=defineComponentInstance(getVueConstructor(),{computed:{value:function(){return 0}}}),t=e._computedWatchers.value.constructor,n=e._data.__ob__.dep.constructor;y={Watcher:t,Dep:n},e.$destroy()}return y}(),g=m.Watcher,v=m.Dep;f=function(){return h||(h=new g(p,n,noopFn,{lazy:!0})),h.dirty&&h.evaluate(),v.target&&h.depend(),h.value},l=function(e){a&&a(e)}}else{var _=defineComponentInstance(getVueConstructor(),{computed:{$$state:{get:n,set:a}}});p&&p.$on("hook:destroyed",(function(){return _.$destroy()})),f=function(){return _.$$state},l=function(e){_.$$state=e}}return createRef({get:f,set:l})}var w={set:function set$1(e,t,n){(e.__composition_api_state__=e.__composition_api_state__||{})[t]=n},get:function get(e,t){return(e.__composition_api_state__||{})[t]}};function updateTemplateRef(e){var t=w.get(e,"rawBindings")||{};if(t&&Object.keys(t).length){for(var n=e.$refs,a=w.get(e,"refs")||[],l=0;l<a.length;l++){var f=t[m=a[l]];!n[m]&&f&&isRef(f)&&(f.value=null)}var p=Object.keys(n),h=[];for(l=0;l<p.length;l++){var m;f=t[m=p[l]];n[m]&&f&&isRef(f)&&(f.value=n[m],h.push(m))}w.set(e,"refs",h)}}function resolveScopedSlots(e,t){var n=e.$options._parentVnode;if(n){for(var a=w.get(e,"slots")||[],l=function resolveSlots(e,t){var n;if(e){if(e._normalized)return e._normalized;for(var a in n={},e)e[a]&&"$"!==a[0]&&(n[a]=!0)}else n={};for(var a in t)a in n||(n[a]=!0);return n}(n.data.scopedSlots,e.$slots),f=0;f<a.length;f++){l[h=a[f]]||delete t[h]}var p=Object.keys(l);for(f=0;f<p.length;f++){var h;t[h=p[f]]||(t[h]=createSlotProxy(e,h))}w.set(e,"slots",p)}}function activateCurrentInstance(e,t,n){var a=function getCurrentVue2Instance(){return g}();setCurrentInstance(e);try{return t(e)}catch(l){if(!n)throw l;n(l)}finally{setCurrentInstance(a)}}function mixin(e){function customReactive(e){if(isPlainObject(e)&&!isRef(e)&&!isReactive(e)&&!isRaw(e)){var t=getVueConstructor().util.defineReactive;Object.keys(e).forEach((function(n){var a=e[n];t(e,n,a),a&&customReactive(a)}))}}function hasReactiveArrayChild(e,t){return void 0===t&&(t=new Map),t.has(e)?t.get(e):(t.set(e,!1),Array.isArray(e)&&isReactive(e)?(t.set(e,!0),!0):!(!isPlainObject(e)||isRaw(e))&&Object.keys(e).some((function(n){return hasReactiveArrayChild(e[n],t)})))}e.mixin({beforeCreate:function functionApiInit(){var e=this,t=e.$options,n=t.setup,a=t.render;a&&(t.render=function(){for(var t=this,n=[],l=0;l<arguments.length;l++)n[l]=arguments[l];return activateCurrentInstance(e,(function(){return a.apply(t,n)}))});if(!n)return;if("function"!=typeof n)return void 0;var l=t.data;t.data=function wrappedData(){return function initSetup(e,t){void 0===t&&(t={});var n,a=e.$options.setup,l=function createSetupContext(e){var t={slots:{}},n=["attrs"],a=["emit"];["root","parent","refs","listeners","isServer","ssrContext"].forEach((function(n){var a="$"+n;proxy(t,n,{get:function(){return e[a]},set:function(){warn("Cannot assign to '"+n+"' because it is a read-only property",e)}})})),n.forEach((function(n){var a="$"+n;proxy(t,n,{get:function(){var t,n,l=reactive({}),f=e[a],_loop_1=function(t){proxy(l,t,{get:function(){return e[a][t]}})};try{for(var p=__values(Object.keys(f)),h=p.next();!h.done;h=p.next()){_loop_1(h.value)}}catch(m){t={error:m}}finally{try{h&&!h.done&&(n=p.return)&&n.call(p)}finally{if(t)throw t.error}}return l},set:function(){warn("Cannot assign to '"+n+"' because it is a read-only property",e)}})})),a.forEach((function(n){var a="$"+n;proxy(t,n,{get:function(){return function(){for(var t=[],n=0;n<arguments.length;n++)t[n]=arguments[n];e[a].apply(e,t)}}})})),!1;return t}(e);if(def(t,"__ob__",createObserver()),resolveScopedSlots(e,l.slots),activateCurrentInstance(e,(function(){n=a(t,l)})),!n)return;if(isFunction(n)){var f=n;return void(e.$options.render=function(){return resolveScopedSlots(e,l.slots),activateCurrentInstance(e,(function(){return f()}))})}if(isPlainObject(n)){isReactive(n)&&(n=function toRefs(e){if(!isPlainObject(e))return e;var t={};for(var n in e)t[n]=toRef(e,n);return t}(n)),w.set(e,"rawBindings",n);var p=n;return void Object.keys(p).forEach((function(t){var n=p[t];isRef(n)||(isReactive(n)?isArray(n)&&(n=ref(n)):isFunction(n)?n=n.bind(e):!function isObject(e){return null!==e&&"object"==typeof e}(n)?n=ref(n):hasReactiveArrayChild(n)&&customReactive(n)),function asVmProperty(e,t,n){var a=e.$options.props;t in e||a&&hasOwn(a,t)||(isRef(n)?proxy(e,t,{get:function(){return n.value},set:function(e){n.value=e}}):e[t]=n)}(e,t,n)}))}0}(e,e.$props),"function"==typeof l?l.call(e,e):l||{}}},mounted:function(){updateTemplateRef(this)},updated:function(){updateTemplateRef(this)}})}function mergeData(e,t){if(!e)return t;if(!t)return e;for(var n,a,f,p=l?Reflect.ownKeys(e):Object.keys(e),h=0;h<p.length;h++)"__ob__"!==(n=p[h])&&(a=t[n],f=e[n],hasOwn(t,n)?a!==f&&isPlainObject(a)&&!isRef(a)&&isPlainObject(f)&&!isRef(f)&&mergeData(f,a):t[n]=f);return t}function install(e){(function isVueRegistered(e){return hasOwn(e,v)})(e)||(e.config.optionMergeStrategies.setup=function(e,t){return function mergedSetupFn(n,a){return mergeData("function"==typeof e?e(n,a)||{}:void 0,"function"==typeof t?t(n,a)||{}:void 0)}},function setVueConstructor(e){m=e,Object.defineProperty(e,v,{configurable:!0,writable:!0,value:!0})}(e),mixin(e))}var T={install:function(e){return install(e)}};function defineComponent(e){return e}"undefined"!=typeof window&&window.Vue&&window.Vue.use(T),t.ZP=T},9669:function(e,t,n){e.exports=n(1609)},5448:function(e,t,n){"use strict";var a=n(4867),l=n(6026),f=n(4372),p=n(5327),h=n(4097),m=n(4109),g=n(7985),v=n(5061),y=n(5655),_=n(5263);e.exports=function xhrAdapter(e){return new Promise((function dispatchXhrRequest(t,n){var b,C=e.data,S=e.headers,k=e.responseType;function done(){e.cancelToken&&e.cancelToken.unsubscribe(b),e.signal&&e.signal.removeEventListener("abort",b)}a.isFormData(C)&&delete S["Content-Type"];var w=new XMLHttpRequest;if(e.auth){var T=e.auth.username||"",P=e.auth.password?unescape(encodeURIComponent(e.auth.password)):"";S.Authorization="Basic "+btoa(T+":"+P)}var A=h(e.baseURL,e.url);function onloadend(){if(w){var a="getAllResponseHeaders"in w?m(w.getAllResponseHeaders()):null,f={data:k&&"text"!==k&&"json"!==k?w.response:w.responseText,status:w.status,statusText:w.statusText,headers:a,config:e,request:w};l((function _resolve(e){t(e),done()}),(function _reject(e){n(e),done()}),f),w=null}}if(w.open(e.method.toUpperCase(),p(A,e.params,e.paramsSerializer),!0),w.timeout=e.timeout,"onloadend"in w?w.onloadend=onloadend:w.onreadystatechange=function handleLoad(){w&&4===w.readyState&&(0!==w.status||w.responseURL&&0===w.responseURL.indexOf("file:"))&&setTimeout(onloadend)},w.onabort=function handleAbort(){w&&(n(v("Request aborted",e,"ECONNABORTED",w)),w=null)},w.onerror=function handleError(){n(v("Network Error",e,null,w)),w=null},w.ontimeout=function handleTimeout(){var t=e.timeout?"timeout of "+e.timeout+"ms exceeded":"timeout exceeded",a=e.transitional||y.transitional;e.timeoutErrorMessage&&(t=e.timeoutErrorMessage),n(v(t,e,a.clarifyTimeoutError?"ETIMEDOUT":"ECONNABORTED",w)),w=null},a.isStandardBrowserEnv()){var M=(e.withCredentials||g(A))&&e.xsrfCookieName?f.read(e.xsrfCookieName):void 0;M&&(S[e.xsrfHeaderName]=M)}"setRequestHeader"in w&&a.forEach(S,(function setRequestHeader(e,t){void 0===C&&"content-type"===t.toLowerCase()?delete S[t]:w.setRequestHeader(t,e)})),a.isUndefined(e.withCredentials)||(w.withCredentials=!!e.withCredentials),k&&"json"!==k&&(w.responseType=e.responseType),"function"==typeof e.onDownloadProgress&&w.addEventListener("progress",e.onDownloadProgress),"function"==typeof e.onUploadProgress&&w.upload&&w.upload.addEventListener("progress",e.onUploadProgress),(e.cancelToken||e.signal)&&(b=function(e){w&&(n(!e||e&&e.type?new _("canceled"):e),w.abort(),w=null)},e.cancelToken&&e.cancelToken.subscribe(b),e.signal&&(e.signal.aborted?b():e.signal.addEventListener("abort",b))),C||(C=null),w.send(C)}))}},1609:function(e,t,n){"use strict";var a=n(4867),l=n(1849),f=n(321),p=n(7185);var h=function createInstance(e){var t=new f(e),n=l(f.prototype.request,t);return a.extend(n,f.prototype,t),a.extend(n,t),n.create=function create(t){return createInstance(p(e,t))},n}(n(5655));h.Axios=f,h.Cancel=n(5263),h.CancelToken=n(4972),h.isCancel=n(6502),h.VERSION=n(7288).version,h.all=function all(e){return Promise.all(e)},h.spread=n(8713),h.isAxiosError=n(6268),e.exports=h,e.exports.default=h},5263:function(e){"use strict";function Cancel(e){this.message=e}Cancel.prototype.toString=function toString(){return"Cancel"+(this.message?": "+this.message:"")},Cancel.prototype.__CANCEL__=!0,e.exports=Cancel},4972:function(e,t,n){"use strict";var a=n(5263);function CancelToken(e){if("function"!=typeof e)throw new TypeError("executor must be a function.");var t;this.promise=new Promise((function promiseExecutor(e){t=e}));var n=this;this.promise.then((function(e){if(n._listeners){var t,a=n._listeners.length;for(t=0;t<a;t++)n._listeners[t](e);n._listeners=null}})),this.promise.then=function(e){var t,a=new Promise((function(e){n.subscribe(e),t=e})).then(e);return a.cancel=function reject(){n.unsubscribe(t)},a},e((function cancel(e){n.reason||(n.reason=new a(e),t(n.reason))}))}CancelToken.prototype.throwIfRequested=function throwIfRequested(){if(this.reason)throw this.reason},CancelToken.prototype.subscribe=function subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]},CancelToken.prototype.unsubscribe=function unsubscribe(e){if(this._listeners){var t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}},CancelToken.source=function source(){var e;return{token:new CancelToken((function executor(t){e=t})),cancel:e}},e.exports=CancelToken},6502:function(e){"use strict";e.exports=function isCancel(e){return!(!e||!e.__CANCEL__)}},321:function(e,t,n){"use strict";var a=n(4867),l=n(5327),f=n(782),p=n(3572),h=n(7185),m=n(4875),g=m.validators;function Axios(e){this.defaults=e,this.interceptors={request:new f,response:new f}}Axios.prototype.request=function request(e,t){if("string"==typeof e?(t=t||{}).url=e:t=e||{},!t.url)throw new Error("Provided config url is not valid");(t=h(this.defaults,t)).method?t.method=t.method.toLowerCase():this.defaults.method?t.method=this.defaults.method.toLowerCase():t.method="get";var n=t.transitional;void 0!==n&&m.assertOptions(n,{silentJSONParsing:g.transitional(g.boolean),forcedJSONParsing:g.transitional(g.boolean),clarifyTimeoutError:g.transitional(g.boolean)},!1);var a=[],l=!0;this.interceptors.request.forEach((function unshiftRequestInterceptors(e){"function"==typeof e.runWhen&&!1===e.runWhen(t)||(l=l&&e.synchronous,a.unshift(e.fulfilled,e.rejected))}));var f,v=[];if(this.interceptors.response.forEach((function pushResponseInterceptors(e){v.push(e.fulfilled,e.rejected)})),!l){var y=[p,void 0];for(Array.prototype.unshift.apply(y,a),y=y.concat(v),f=Promise.resolve(t);y.length;)f=f.then(y.shift(),y.shift());return f}for(var _=t;a.length;){var b=a.shift(),C=a.shift();try{_=b(_)}catch(S){C(S);break}}try{f=p(_)}catch(S){return Promise.reject(S)}for(;v.length;)f=f.then(v.shift(),v.shift());return f},Axios.prototype.getUri=function getUri(e){if(!e.url)throw new Error("Provided config url is not valid");return e=h(this.defaults,e),l(e.url,e.params,e.paramsSerializer).replace(/^\?/,"")},a.forEach(["delete","get","head","options"],(function forEachMethodNoData(e){Axios.prototype[e]=function(t,n){return this.request(h(n||{},{method:e,url:t,data:(n||{}).data}))}})),a.forEach(["post","put","patch"],(function forEachMethodWithData(e){Axios.prototype[e]=function(t,n,a){return this.request(h(a||{},{method:e,url:t,data:n}))}})),e.exports=Axios},782:function(e,t,n){"use strict";var a=n(4867);function InterceptorManager(){this.handlers=[]}InterceptorManager.prototype.use=function use(e,t,n){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!n&&n.synchronous,runWhen:n?n.runWhen:null}),this.handlers.length-1},InterceptorManager.prototype.eject=function eject(e){this.handlers[e]&&(this.handlers[e]=null)},InterceptorManager.prototype.forEach=function forEach(e){a.forEach(this.handlers,(function forEachHandler(t){null!==t&&e(t)}))},e.exports=InterceptorManager},4097:function(e,t,n){"use strict";var a=n(1793),l=n(7303);e.exports=function buildFullPath(e,t){return e&&!a(t)?l(e,t):t}},5061:function(e,t,n){"use strict";var a=n(481);e.exports=function createError(e,t,n,l,f){var p=new Error(e);return a(p,t,n,l,f)}},3572:function(e,t,n){"use strict";var a=n(4867),l=n(8527),f=n(6502),p=n(5655),h=n(5263);function throwIfCancellationRequested(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new h("canceled")}e.exports=function dispatchRequest(e){return throwIfCancellationRequested(e),e.headers=e.headers||{},e.data=l.call(e,e.data,e.headers,e.transformRequest),e.headers=a.merge(e.headers.common||{},e.headers[e.method]||{},e.headers),a.forEach(["delete","get","head","post","put","patch","common"],(function cleanHeaderConfig(t){delete e.headers[t]})),(e.adapter||p.adapter)(e).then((function onAdapterResolution(t){return throwIfCancellationRequested(e),t.data=l.call(e,t.data,t.headers,e.transformResponse),t}),(function onAdapterRejection(t){return f(t)||(throwIfCancellationRequested(e),t&&t.response&&(t.response.data=l.call(e,t.response.data,t.response.headers,e.transformResponse))),Promise.reject(t)}))}},481:function(e){"use strict";e.exports=function enhanceError(e,t,n,a,l){return e.config=t,n&&(e.code=n),e.request=a,e.response=l,e.isAxiosError=!0,e.toJSON=function toJSON(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:this.config,code:this.code,status:this.response&&this.response.status?this.response.status:null}},e}},7185:function(e,t,n){"use strict";var a=n(4867);e.exports=function mergeConfig(e,t){t=t||{};var n={};function getMergedValue(e,t){return a.isPlainObject(e)&&a.isPlainObject(t)?a.merge(e,t):a.isPlainObject(t)?a.merge({},t):a.isArray(t)?t.slice():t}function mergeDeepProperties(n){return a.isUndefined(t[n])?a.isUndefined(e[n])?void 0:getMergedValue(void 0,e[n]):getMergedValue(e[n],t[n])}function valueFromConfig2(e){if(!a.isUndefined(t[e]))return getMergedValue(void 0,t[e])}function defaultToConfig2(n){return a.isUndefined(t[n])?a.isUndefined(e[n])?void 0:getMergedValue(void 0,e[n]):getMergedValue(void 0,t[n])}function mergeDirectKeys(n){return n in t?getMergedValue(e[n],t[n]):n in e?getMergedValue(void 0,e[n]):void 0}var l={url:valueFromConfig2,method:valueFromConfig2,data:valueFromConfig2,baseURL:defaultToConfig2,transformRequest:defaultToConfig2,transformResponse:defaultToConfig2,paramsSerializer:defaultToConfig2,timeout:defaultToConfig2,timeoutMessage:defaultToConfig2,withCredentials:defaultToConfig2,adapter:defaultToConfig2,responseType:defaultToConfig2,xsrfCookieName:defaultToConfig2,xsrfHeaderName:defaultToConfig2,onUploadProgress:defaultToConfig2,onDownloadProgress:defaultToConfig2,decompress:defaultToConfig2,maxContentLength:defaultToConfig2,maxBodyLength:defaultToConfig2,transport:defaultToConfig2,httpAgent:defaultToConfig2,httpsAgent:defaultToConfig2,cancelToken:defaultToConfig2,socketPath:defaultToConfig2,responseEncoding:defaultToConfig2,validateStatus:mergeDirectKeys};return a.forEach(Object.keys(e).concat(Object.keys(t)),(function computeConfigValue(e){var t=l[e]||mergeDeepProperties,f=t(e);a.isUndefined(f)&&t!==mergeDirectKeys||(n[e]=f)})),n}},6026:function(e,t,n){"use strict";var a=n(5061);e.exports=function settle(e,t,n){var l=n.config.validateStatus;n.status&&l&&!l(n.status)?t(a("Request failed with status code "+n.status,n.config,null,n.request,n)):e(n)}},8527:function(e,t,n){"use strict";var a=n(4867),l=n(5655);e.exports=function transformData(e,t,n){var f=this||l;return a.forEach(n,(function transform(n){e=n.call(f,e,t)})),e}},5655:function(e,t,n){"use strict";var a=n(4155),l=n(4867),f=n(6016),p=n(481),h={"Content-Type":"application/x-www-form-urlencoded"};function setContentTypeIfUnset(e,t){!l.isUndefined(e)&&l.isUndefined(e["Content-Type"])&&(e["Content-Type"]=t)}var m={transitional:{silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},adapter:function getDefaultAdapter(){var e;return("undefined"!=typeof XMLHttpRequest||void 0!==a&&"[object process]"===Object.prototype.toString.call(a))&&(e=n(5448)),e}(),transformRequest:[function transformRequest(e,t){return f(t,"Accept"),f(t,"Content-Type"),l.isFormData(e)||l.isArrayBuffer(e)||l.isBuffer(e)||l.isStream(e)||l.isFile(e)||l.isBlob(e)?e:l.isArrayBufferView(e)?e.buffer:l.isURLSearchParams(e)?(setContentTypeIfUnset(t,"application/x-www-form-urlencoded;charset=utf-8"),e.toString()):l.isObject(e)||t&&"application/json"===t["Content-Type"]?(setContentTypeIfUnset(t,"application/json"),function stringifySafely(e,t,n){if(l.isString(e))try{return(t||JSON.parse)(e),l.trim(e)}catch(a){if("SyntaxError"!==a.name)throw a}return(n||JSON.stringify)(e)}(e)):e}],transformResponse:[function transformResponse(e){var t=this.transitional||m.transitional,n=t&&t.silentJSONParsing,a=t&&t.forcedJSONParsing,f=!n&&"json"===this.responseType;if(f||a&&l.isString(e)&&e.length)try{return JSON.parse(e)}catch(h){if(f){if("SyntaxError"===h.name)throw p(h,this,"E_JSON_PARSE");throw h}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,validateStatus:function validateStatus(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*"}}};l.forEach(["delete","get","head"],(function forEachMethodNoData(e){m.headers[e]={}})),l.forEach(["post","put","patch"],(function forEachMethodWithData(e){m.headers[e]=l.merge(h)})),e.exports=m},7288:function(e){e.exports={version:"0.25.0"}},1849:function(e){"use strict";e.exports=function bind(e,t){return function wrap(){for(var n=new Array(arguments.length),a=0;a<n.length;a++)n[a]=arguments[a];return e.apply(t,n)}}},5327:function(e,t,n){"use strict";var a=n(4867);function encode(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}e.exports=function buildURL(e,t,n){if(!t)return e;var l;if(n)l=n(t);else if(a.isURLSearchParams(t))l=t.toString();else{var f=[];a.forEach(t,(function serialize(e,t){null!=e&&(a.isArray(e)?t+="[]":e=[e],a.forEach(e,(function parseValue(e){a.isDate(e)?e=e.toISOString():a.isObject(e)&&(e=JSON.stringify(e)),f.push(encode(t)+"="+encode(e))})))})),l=f.join("&")}if(l){var p=e.indexOf("#");-1!==p&&(e=e.slice(0,p)),e+=(-1===e.indexOf("?")?"?":"&")+l}return e}},7303:function(e){"use strict";e.exports=function combineURLs(e,t){return t?e.replace(/\/+$/,"")+"/"+t.replace(/^\/+/,""):e}},4372:function(e,t,n){"use strict";var a=n(4867);e.exports=a.isStandardBrowserEnv()?function standardBrowserEnv(){return{write:function write(e,t,n,l,f,p){var h=[];h.push(e+"="+encodeURIComponent(t)),a.isNumber(n)&&h.push("expires="+new Date(n).toGMTString()),a.isString(l)&&h.push("path="+l),a.isString(f)&&h.push("domain="+f),!0===p&&h.push("secure"),document.cookie=h.join("; ")},read:function read(e){var t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove:function remove(e){this.write(e,"",Date.now()-864e5)}}}():{write:function write(){},read:function read(){return null},remove:function remove(){}}},1793:function(e){"use strict";e.exports=function isAbsoluteURL(e){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(e)}},6268:function(e,t,n){"use strict";var a=n(4867);e.exports=function isAxiosError(e){return a.isObject(e)&&!0===e.isAxiosError}},7985:function(e,t,n){"use strict";var a=n(4867);e.exports=a.isStandardBrowserEnv()?function standardBrowserEnv(){var e,t=/(msie|trident)/i.test(navigator.userAgent),n=document.createElement("a");function resolveURL(e){var a=e;return t&&(n.setAttribute("href",a),a=n.href),n.setAttribute("href",a),{href:n.href,protocol:n.protocol?n.protocol.replace(/:$/,""):"",host:n.host,search:n.search?n.search.replace(/^\?/,""):"",hash:n.hash?n.hash.replace(/^#/,""):"",hostname:n.hostname,port:n.port,pathname:"/"===n.pathname.charAt(0)?n.pathname:"/"+n.pathname}}return e=resolveURL(window.location.href),function isURLSameOrigin(t){var n=a.isString(t)?resolveURL(t):t;return n.protocol===e.protocol&&n.host===e.host}}():function isURLSameOrigin(){return!0}},6016:function(e,t,n){"use strict";var a=n(4867);e.exports=function normalizeHeaderName(e,t){a.forEach(e,(function processHeader(n,a){a!==t&&a.toUpperCase()===t.toUpperCase()&&(e[t]=n,delete e[a])}))}},4109:function(e,t,n){"use strict";var a=n(4867),l=["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"];e.exports=function parseHeaders(e){var t,n,f,p={};return e?(a.forEach(e.split("\n"),(function parser(e){if(f=e.indexOf(":"),t=a.trim(e.substr(0,f)).toLowerCase(),n=a.trim(e.substr(f+1)),t){if(p[t]&&l.indexOf(t)>=0)return;p[t]="set-cookie"===t?(p[t]?p[t]:[]).concat([n]):p[t]?p[t]+", "+n:n}})),p):p}},8713:function(e){"use strict";e.exports=function spread(e){return function wrap(t){return e.apply(null,t)}}},4875:function(e,t,n){"use strict";var a=n(7288).version,l={};["object","boolean","number","function","string","symbol"].forEach((function(e,t){l[e]=function validator(n){return typeof n===e||"a"+(t<1?"n ":" ")+e}}));var f={};l.transitional=function transitional(e,t,n){function formatMessage(e,t){return"[Axios v"+a+"] Transitional option '"+e+"'"+t+(n?". "+n:"")}return function(n,a,l){if(!1===e)throw new Error(formatMessage(a," has been removed"+(t?" in "+t:"")));return t&&!f[a]&&(f[a]=!0,console.warn(formatMessage(a," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(n,a,l)}},e.exports={assertOptions:function assertOptions(e,t,n){if("object"!=typeof e)throw new TypeError("options must be an object");for(var a=Object.keys(e),l=a.length;l-- >0;){var f=a[l],p=t[f];if(p){var h=e[f],m=void 0===h||p(h,f,e);if(!0!==m)throw new TypeError("option "+f+" must be "+m)}else if(!0!==n)throw Error("Unknown option "+f)}},validators:l}},4867:function(e,t,n){"use strict";var a=n(1849),l=Object.prototype.toString;function isArray(e){return Array.isArray(e)}function isUndefined(e){return void 0===e}function isArrayBuffer(e){return"[object ArrayBuffer]"===l.call(e)}function isObject(e){return null!==e&&"object"==typeof e}function isPlainObject(e){if("[object Object]"!==l.call(e))return!1;var t=Object.getPrototypeOf(e);return null===t||t===Object.prototype}function isFunction(e){return"[object Function]"===l.call(e)}function forEach(e,t){if(null!=e)if("object"!=typeof e&&(e=[e]),isArray(e))for(var n=0,a=e.length;n<a;n++)t.call(null,e[n],n,e);else for(var l in e)Object.prototype.hasOwnProperty.call(e,l)&&t.call(null,e[l],l,e)}e.exports={isArray:isArray,isArrayBuffer:isArrayBuffer,isBuffer:function isBuffer(e){return null!==e&&!isUndefined(e)&&null!==e.constructor&&!isUndefined(e.constructor)&&"function"==typeof e.constructor.isBuffer&&e.constructor.isBuffer(e)},isFormData:function isFormData(e){return"[object FormData]"===l.call(e)},isArrayBufferView:function isArrayBufferView(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&isArrayBuffer(e.buffer)},isString:function isString(e){return"string"==typeof e},isNumber:function isNumber(e){return"number"==typeof e},isObject:isObject,isPlainObject:isPlainObject,isUndefined:isUndefined,isDate:function isDate(e){return"[object Date]"===l.call(e)},isFile:function isFile(e){return"[object File]"===l.call(e)},isBlob:function isBlob(e){return"[object Blob]"===l.call(e)},isFunction:isFunction,isStream:function isStream(e){return isObject(e)&&isFunction(e.pipe)},isURLSearchParams:function isURLSearchParams(e){return"[object URLSearchParams]"===l.call(e)},isStandardBrowserEnv:function isStandardBrowserEnv(){return("undefined"==typeof navigator||"ReactNative"!==navigator.product&&"NativeScript"!==navigator.product&&"NS"!==navigator.product)&&("undefined"!=typeof window&&"undefined"!=typeof document)},forEach:forEach,merge:function merge(){var e={};function assignValue(t,n){isPlainObject(e[n])&&isPlainObject(t)?e[n]=merge(e[n],t):isPlainObject(t)?e[n]=merge({},t):isArray(t)?e[n]=t.slice():e[n]=t}for(var t=0,n=arguments.length;t<n;t++)forEach(arguments[t],assignValue);return e},extend:function extend(e,t,n){return forEach(t,(function assignValue(t,l){e[l]=n&&"function"==typeof t?a(t,n):t})),e},trim:function trim(e){return e.trim?e.trim():e.replace(/^\s+|\s+$/g,"")},stripBOM:function stripBOM(e){return 65279===e.charCodeAt(0)&&(e=e.slice(1)),e}}},5144:function(e,t,n){var a=n(1070),l=n(3217),f=n(8433),p=n(4220);e.exports.Backoff=a,e.exports.FunctionCall=p,e.exports.FibonacciStrategy=f,e.exports.ExponentialStrategy=l,e.exports.fibonacci=function(e){return new a(new f(e))},e.exports.exponential=function(e){return new a(new l(e))},e.exports.call=function(e,t,n){var a=Array.prototype.slice.call(arguments);return e=a[0],t=a.slice(1,a.length-1),n=a[a.length-1],new p(e,t,n)}},1070:function(e,t,n){var a=n(7187),l=n(3814);function Backoff(e){a.EventEmitter.call(this),this.backoffStrategy_=e,this.maxNumberOfRetry_=-1,this.backoffNumber_=0,this.backoffDelay_=0,this.timeoutID_=-1,this.handlers={backoff:this.onBackoff_.bind(this)}}n(9539).inherits(Backoff,a.EventEmitter),Backoff.prototype.failAfter=function(e){l.checkArgument(e>0,"Expected a maximum number of retry greater than 0 but got %s.",e),this.maxNumberOfRetry_=e},Backoff.prototype.backoff=function(e){l.checkState(-1===this.timeoutID_,"Backoff in progress."),this.backoffNumber_===this.maxNumberOfRetry_?(this.emit("fail",e),this.reset()):(this.backoffDelay_=this.backoffStrategy_.next(),this.timeoutID_=setTimeout(this.handlers.backoff,this.backoffDelay_),this.emit("backoff",this.backoffNumber_,this.backoffDelay_,e))},Backoff.prototype.onBackoff_=function(){this.timeoutID_=-1,this.emit("ready",this.backoffNumber_,this.backoffDelay_),this.backoffNumber_++},Backoff.prototype.reset=function(){this.backoffNumber_=0,this.backoffStrategy_.reset(),clearTimeout(this.timeoutID_),this.timeoutID_=-1},e.exports=Backoff},4220:function(e,t,n){var a=n(7187),l=n(3814),f=n(9539),p=n(1070),h=n(8433);function FunctionCall(e,t,n){a.EventEmitter.call(this),l.checkIsFunction(e,"Expected fn to be a function."),l.checkIsArray(t,"Expected args to be an array."),l.checkIsFunction(n,"Expected callback to be a function."),this.function_=e,this.arguments_=t,this.callback_=n,this.lastResult_=[],this.numRetries_=0,this.backoff_=null,this.strategy_=null,this.failAfter_=-1,this.retryPredicate_=FunctionCall.DEFAULT_RETRY_PREDICATE_,this.state_=FunctionCall.State_.PENDING}f.inherits(FunctionCall,a.EventEmitter),FunctionCall.State_={PENDING:0,RUNNING:1,COMPLETED:2,ABORTED:3},FunctionCall.DEFAULT_RETRY_PREDICATE_=function(e){return!0},FunctionCall.prototype.isPending=function(){return this.state_==FunctionCall.State_.PENDING},FunctionCall.prototype.isRunning=function(){return this.state_==FunctionCall.State_.RUNNING},FunctionCall.prototype.isCompleted=function(){return this.state_==FunctionCall.State_.COMPLETED},FunctionCall.prototype.isAborted=function(){return this.state_==FunctionCall.State_.ABORTED},FunctionCall.prototype.setStrategy=function(e){return l.checkState(this.isPending(),"FunctionCall in progress."),this.strategy_=e,this},FunctionCall.prototype.retryIf=function(e){return l.checkState(this.isPending(),"FunctionCall in progress."),this.retryPredicate_=e,this},FunctionCall.prototype.getLastResult=function(){return this.lastResult_.concat()},FunctionCall.prototype.getNumRetries=function(){return this.numRetries_},FunctionCall.prototype.failAfter=function(e){return l.checkState(this.isPending(),"FunctionCall in progress."),this.failAfter_=e,this},FunctionCall.prototype.abort=function(){this.isCompleted()||this.isAborted()||(this.isRunning()&&this.backoff_.reset(),this.state_=FunctionCall.State_.ABORTED,this.lastResult_=[new Error("Backoff aborted.")],this.emit("abort"),this.doCallback_())},FunctionCall.prototype.start=function(e){l.checkState(!this.isAborted(),"FunctionCall is aborted."),l.checkState(this.isPending(),"FunctionCall already started.");var t=this.strategy_||new h;this.backoff_=e?e(t):new p(t),this.backoff_.on("ready",this.doCall_.bind(this,!0)),this.backoff_.on("fail",this.doCallback_.bind(this)),this.backoff_.on("backoff",this.handleBackoff_.bind(this)),this.failAfter_>0&&this.backoff_.failAfter(this.failAfter_),this.state_=FunctionCall.State_.RUNNING,this.doCall_(!1)},FunctionCall.prototype.doCall_=function(e){e&&this.numRetries_++;var t=["call"].concat(this.arguments_);a.EventEmitter.prototype.emit.apply(this,t);var n=this.handleFunctionCallback_.bind(this);this.function_.apply(null,this.arguments_.concat(n))},FunctionCall.prototype.doCallback_=function(){this.callback_.apply(null,this.lastResult_)},FunctionCall.prototype.handleFunctionCallback_=function(){if(!this.isAborted()){var e=Array.prototype.slice.call(arguments);this.lastResult_=e,a.EventEmitter.prototype.emit.apply(this,["callback"].concat(e));var t=e[0];t&&this.retryPredicate_(t)?this.backoff_.backoff(t):(this.state_=FunctionCall.State_.COMPLETED,this.doCallback_())}},FunctionCall.prototype.handleBackoff_=function(e,t,n){this.emit("backoff",e,t,n)},e.exports=FunctionCall},3217:function(e,t,n){var a=n(9539),l=n(3814),f=n(9618);function ExponentialBackoffStrategy(e){f.call(this,e),this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay(),this.factor_=ExponentialBackoffStrategy.DEFAULT_FACTOR,e&&void 0!==e.factor&&(l.checkArgument(e.factor>1,"Exponential factor should be greater than 1 but got %s.",e.factor),this.factor_=e.factor)}a.inherits(ExponentialBackoffStrategy,f),ExponentialBackoffStrategy.DEFAULT_FACTOR=2,ExponentialBackoffStrategy.prototype.next_=function(){return this.backoffDelay_=Math.min(this.nextBackoffDelay_,this.getMaxDelay()),this.nextBackoffDelay_=this.backoffDelay_*this.factor_,this.backoffDelay_},ExponentialBackoffStrategy.prototype.reset_=function(){this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()},e.exports=ExponentialBackoffStrategy},8433:function(e,t,n){var a=n(9539),l=n(9618);function FibonacciBackoffStrategy(e){l.call(this,e),this.backoffDelay_=0,this.nextBackoffDelay_=this.getInitialDelay()}a.inherits(FibonacciBackoffStrategy,l),FibonacciBackoffStrategy.prototype.next_=function(){var e=Math.min(this.nextBackoffDelay_,this.getMaxDelay());return this.nextBackoffDelay_+=this.backoffDelay_,this.backoffDelay_=e,e},FibonacciBackoffStrategy.prototype.reset_=function(){this.nextBackoffDelay_=this.getInitialDelay(),this.backoffDelay_=0},e.exports=FibonacciBackoffStrategy},9618:function(e,t,n){n(7187),n(9539);function isDef(e){return null!=e}function BackoffStrategy(e){if(isDef((e=e||{}).initialDelay)&&e.initialDelay<1)throw new Error("The initial timeout must be greater than 0.");if(isDef(e.maxDelay)&&e.maxDelay<1)throw new Error("The maximal timeout must be greater than 0.");if(this.initialDelay_=e.initialDelay||100,this.maxDelay_=e.maxDelay||1e4,this.maxDelay_<=this.initialDelay_)throw new Error("The maximal backoff delay must be greater than the initial backoff delay.");if(isDef(e.randomisationFactor)&&(e.randomisationFactor<0||e.randomisationFactor>1))throw new Error("The randomisation factor must be between 0 and 1.");this.randomisationFactor_=e.randomisationFactor||0}BackoffStrategy.prototype.getMaxDelay=function(){return this.maxDelay_},BackoffStrategy.prototype.getInitialDelay=function(){return this.initialDelay_},BackoffStrategy.prototype.next=function(){var e=this.next_(),t=1+Math.random()*this.randomisationFactor_;return Math.round(e*t)},BackoffStrategy.prototype.next_=function(){throw new Error("BackoffStrategy.next_() unimplemented.")},BackoffStrategy.prototype.reset=function(){this.reset_()},BackoffStrategy.prototype.reset_=function(){throw new Error("BackoffStrategy.reset_() unimplemented.")},e.exports=BackoffStrategy},2475:function(e,t,n){var a,l;
/**
 * @author William DURAND <william.durand1@gmail.com>
 * @license MIT Licensed
 */void 0===(l="function"==typeof(a=function(){"use strict";var e={},t="en",n=[],a=new RegExp(/^\w+\: +(.+)$/),l=new RegExp(/^\s*((\{\s*(\-?\d+[\s*,\s*\-?\d+]*)\s*\})|([\[\]])\s*(-Inf|\-?\d+)\s*,\s*(\+?Inf|\-?\d+)\s*([\[\]]))\s?(.+?)$/),f=new RegExp(/^\s*(\{\s*(\-?\d+[\s*,\s*\-?\d+]*)\s*\})|([\[\]])\s*(-Inf|\-?\d+)\s*,\s*(\+?Inf|\-?\d+)\s*([\[\]])/),p={locale:get_current_locale(),fallback:t,placeHolderPrefix:"%",placeHolderSuffix:"%",defaultDomain:"messages",pluralSeparator:"|",add:function(t,a,l,f){var p=f||this.locale||this.fallback,h=l||this.defaultDomain;return e[p]||(e[p]={}),e[p][h]||(e[p][h]={}),e[p][h][t]=a,!1===exists(n,h)&&n.push(h),this},trans:function(e,t,n,a){return replace_placeholders(get_message(e,n,a,this.locale,this.fallback),t||{})},transChoice:function(e,t,n,a,l){var f=get_message(e,a,l,this.locale,this.fallback),p=parseInt(t,10);return void 0===(n=n||{}).count&&(n.count=t),void 0===f||isNaN(p)||(f=pluralize(f,p,l||this.locale||this.fallback)),replace_placeholders(f,n)},fromJSON:function(e){if("string"==typeof e&&(e=JSON.parse(e)),e.locale&&(this.locale=e.locale),e.fallback&&(this.fallback=e.fallback),e.defaultDomain&&(this.defaultDomain=e.defaultDomain),e.translations)for(var t in e.translations)for(var n in e.translations[t])for(var a in e.translations[t][n])this.add(a,e.translations[t][n][a],n,t);return this},reset:function(){e={},n=[],this.locale=get_current_locale()}};function replace_placeholders(e,t){var n,a=p.placeHolderPrefix,l=p.placeHolderSuffix;for(n in t){var f=new RegExp(a+n+l,"g");if(f.test(e)){var h=String(t[n]).replace(new RegExp("\\$","g"),"$$$$");e=e.replace(f,h)}}return e}function get_message(t,a,l,f,p){var h,m,g,v=l||f||p,y=a,_=v.split("_")[0];if(!(v in e))if(_ in e)v=_;else{if(!(p in e))return t;v=p}if(null==y)for(var b=0;b<n.length;b++)if(has_message(v,n[b],t)||has_message(_,n[b],t)||has_message(p,n[b],t)){y=n[b];break}if(has_message(v,y,t))return e[v][y][t];for(;v.length>2&&(h=v.length,g=(m=v.split(/[\s_]+/))[m.length-1].length,1!==m.length);)if(has_message(v=v.substring(0,h-(g+1)),y,t))return e[v][y][t];return has_message(p,y,t)?e[p][y][t]:t}function has_message(t,n,a){return t in e&&n in e[t]&&a in e[t][n]}function pluralize(e,t,n){var h,m,g=[],v=[],y=e.split(p.pluralSeparator),_=[];for(h=0;h<y.length;h++){var b=y[h];l.test(b)?g[(_=b.match(l))[0]]=_[_.length-1]:a.test(b)?(_=b.match(a),v.push(_[1])):v.push(b)}for(m in g)if(f.test(m))if((_=m.match(f))[1]){var C,S=_[2].split(",");for(C in S)if(t==S[C])return g[m]}else{var k=convert_number(_[4]),w=convert_number(_[5]);if(("["===_[3]?t>=k:t>k)&&("]"===_[6]?t<=w:t<w))return g[m]}return v[plural_position(t,n)]||v[0]||void 0}function convert_number(e){return"-Inf"===e?Number.NEGATIVE_INFINITY:"+Inf"===e||"Inf"===e?Number.POSITIVE_INFINITY:parseInt(e,10)}function plural_position(e,t){var n=t;switch("pt_BR"===n&&(n="xbr"),n.length>3&&(n=n.split("_")[0]),n){case"bo":case"dz":case"id":case"ja":case"jv":case"ka":case"km":case"kn":case"ko":case"ms":case"th":case"tr":case"vi":case"zh":default:return 0;case"af":case"az":case"bn":case"bg":case"ca":case"da":case"de":case"el":case"en":case"eo":case"es":case"et":case"eu":case"fa":case"fi":case"fo":case"fur":case"fy":case"gl":case"gu":case"ha":case"he":case"hu":case"is":case"it":case"ku":case"lb":case"ml":case"mn":case"mr":case"nah":case"nb":case"ne":case"nl":case"nn":case"no":case"om":case"or":case"pa":case"pap":case"ps":case"pt":case"so":case"sq":case"sv":case"sw":case"ta":case"te":case"tk":case"ur":case"zu":return 1==e?0:1;case"am":case"bh":case"fil":case"fr":case"gun":case"hi":case"ln":case"mg":case"nso":case"xbr":case"ti":case"wa":return 0===e||1==e?0:1;case"be":case"bs":case"hr":case"ru":case"sr":case"uk":return e%10==1&&e%100!=11?0:e%10>=2&&e%10<=4&&(e%100<10||e%100>=20)?1:2;case"cs":case"sk":return 1==e?0:e>=2&&e<=4?1:2;case"ga":return 1==e?0:2==e?1:2;case"lt":return e%10==1&&e%100!=11?0:e%10>=2&&(e%100<10||e%100>=20)?1:2;case"sl":return e%100==1?0:e%100==2?1:e%100==3||e%100==4?2:3;case"mk":return e%10==1?0:1;case"mt":return 1==e?0:0===e||e%100>1&&e%100<11?1:e%100>10&&e%100<20?2:3;case"lv":return 0===e?0:e%10==1&&e%100!=11?1:2;case"pl":return 1==e?0:e%10>=2&&e%10<=4&&(e%100<12||e%100>14)?1:2;case"cy":return 1==e?0:2==e?1:8==e||11==e?2:3;case"ro":return 1==e?0:0===e||e%100>0&&e%100<20?1:2;case"ar":return 0===e?0:1==e?1:2==e?2:e>=3&&e<=10?3:e>=11&&e<=99?4:5}}function exists(e,t){for(var n=0;n<e.length;n++)if(t===e[n])return!0;return!1}function get_current_locale(){return"undefined"!=typeof document?document.documentElement.lang.replace("-","_"):t}return p})?a.call(t,n,t,e):a)||(e.exports=l)},1924:function(e,t,n){"use strict";var a=n(210),l=n(5559),f=l(a("String.prototype.indexOf"));e.exports=function callBoundIntrinsic(e,t){var n=a(e,!!t);return"function"==typeof n&&f(e,".prototype.")>-1?l(n):n}},5559:function(e,t,n){"use strict";var a=n(8612),l=n(210),f=l("%Function.prototype.apply%"),p=l("%Function.prototype.call%"),h=l("%Reflect.apply%",!0)||a.call(p,f),m=l("%Object.getOwnPropertyDescriptor%",!0),g=l("%Object.defineProperty%",!0),v=l("%Math.max%");if(g)try{g({},"a",{value:1})}catch(_){g=null}e.exports=function callBind(e){var t=h(a,p,arguments);if(m&&g){var n=m(t,"length");n.configurable&&g(t,"length",{value:1+v(0,e.length-(arguments.length-1))})}return t};var y=function applyBind(){return h(a,f,arguments)};g?g(e.exports,"apply",{value:y}):e.exports.apply=y},7187:function(e){"use strict";var t,n="object"==typeof Reflect?Reflect:null,a=n&&"function"==typeof n.apply?n.apply:function ReflectApply(e,t,n){return Function.prototype.apply.call(e,t,n)};t=n&&"function"==typeof n.ownKeys?n.ownKeys:Object.getOwnPropertySymbols?function ReflectOwnKeys(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:function ReflectOwnKeys(e){return Object.getOwnPropertyNames(e)};var l=Number.isNaN||function NumberIsNaN(e){return e!=e};function EventEmitter(){EventEmitter.init.call(this)}e.exports=EventEmitter,e.exports.once=function once(e,t){return new Promise((function(n,a){function errorListener(n){e.removeListener(t,resolver),a(n)}function resolver(){"function"==typeof e.removeListener&&e.removeListener("error",errorListener),n([].slice.call(arguments))}eventTargetAgnosticAddListener(e,t,resolver,{once:!0}),"error"!==t&&function addErrorHandlerIfEventEmitter(e,t,n){"function"==typeof e.on&&eventTargetAgnosticAddListener(e,"error",t,n)}(e,errorListener,{once:!0})}))},EventEmitter.EventEmitter=EventEmitter,EventEmitter.prototype._events=void 0,EventEmitter.prototype._eventsCount=0,EventEmitter.prototype._maxListeners=void 0;var f=10;function checkListener(e){if("function"!=typeof e)throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof e)}function _getMaxListeners(e){return void 0===e._maxListeners?EventEmitter.defaultMaxListeners:e._maxListeners}function _addListener(e,t,n,a){var l,f,p;if(checkListener(n),void 0===(f=e._events)?(f=e._events=Object.create(null),e._eventsCount=0):(void 0!==f.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),f=e._events),p=f[t]),void 0===p)p=f[t]=n,++e._eventsCount;else if("function"==typeof p?p=f[t]=a?[n,p]:[p,n]:a?p.unshift(n):p.push(n),(l=_getMaxListeners(e))>0&&p.length>l&&!p.warned){p.warned=!0;var h=new Error("Possible EventEmitter memory leak detected. "+p.length+" "+String(t)+" listeners added. Use emitter.setMaxListeners() to increase limit");h.name="MaxListenersExceededWarning",h.emitter=e,h.type=t,h.count=p.length,function ProcessEmitWarning(e){console&&console.warn&&console.warn(e)}(h)}return e}function onceWrapper(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,0===arguments.length?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function _onceWrap(e,t,n){var a={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},l=onceWrapper.bind(a);return l.listener=n,a.wrapFn=l,l}function _listeners(e,t,n){var a=e._events;if(void 0===a)return[];var l=a[t];return void 0===l?[]:"function"==typeof l?n?[l.listener||l]:[l]:n?function unwrapListeners(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(l):arrayClone(l,l.length)}function listenerCount(e){var t=this._events;if(void 0!==t){var n=t[e];if("function"==typeof n)return 1;if(void 0!==n)return n.length}return 0}function arrayClone(e,t){for(var n=new Array(t),a=0;a<t;++a)n[a]=e[a];return n}function eventTargetAgnosticAddListener(e,t,n,a){if("function"==typeof e.on)a.once?e.once(t,n):e.on(t,n);else{if("function"!=typeof e.addEventListener)throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof e);e.addEventListener(t,(function wrapListener(l){a.once&&e.removeEventListener(t,wrapListener),n(l)}))}}Object.defineProperty(EventEmitter,"defaultMaxListeners",{enumerable:!0,get:function(){return f},set:function(e){if("number"!=typeof e||e<0||l(e))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+e+".");f=e}}),EventEmitter.init=function(){void 0!==this._events&&this._events!==Object.getPrototypeOf(this)._events||(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},EventEmitter.prototype.setMaxListeners=function setMaxListeners(e){if("number"!=typeof e||e<0||l(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this},EventEmitter.prototype.getMaxListeners=function getMaxListeners(){return _getMaxListeners(this)},EventEmitter.prototype.emit=function emit(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var l="error"===e,f=this._events;if(void 0!==f)l=l&&void 0===f.error;else if(!l)return!1;if(l){var p;if(t.length>0&&(p=t[0]),p instanceof Error)throw p;var h=new Error("Unhandled error."+(p?" ("+p.message+")":""));throw h.context=p,h}var m=f[e];if(void 0===m)return!1;if("function"==typeof m)a(m,this,t);else{var g=m.length,v=arrayClone(m,g);for(n=0;n<g;++n)a(v[n],this,t)}return!0},EventEmitter.prototype.addListener=function addListener(e,t){return _addListener(this,e,t,!1)},EventEmitter.prototype.on=EventEmitter.prototype.addListener,EventEmitter.prototype.prependListener=function prependListener(e,t){return _addListener(this,e,t,!0)},EventEmitter.prototype.once=function once(e,t){return checkListener(t),this.on(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.prependOnceListener=function prependOnceListener(e,t){return checkListener(t),this.prependListener(e,_onceWrap(this,e,t)),this},EventEmitter.prototype.removeListener=function removeListener(e,t){var n,a,l,f,p;if(checkListener(t),void 0===(a=this._events))return this;if(void 0===(n=a[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=Object.create(null):(delete a[e],a.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(l=-1,f=n.length-1;f>=0;f--)if(n[f]===t||n[f].listener===t){p=n[f].listener,l=f;break}if(l<0)return this;0===l?n.shift():function spliceOne(e,t){for(;t+1<e.length;t++)e[t]=e[t+1];e.pop()}(n,l),1===n.length&&(a[e]=n[0]),void 0!==a.removeListener&&this.emit("removeListener",e,p||t)}return this},EventEmitter.prototype.off=EventEmitter.prototype.removeListener,EventEmitter.prototype.removeAllListeners=function removeAllListeners(e){var t,n,a;if(void 0===(n=this._events))return this;if(void 0===n.removeListener)return 0===arguments.length?(this._events=Object.create(null),this._eventsCount=0):void 0!==n[e]&&(0==--this._eventsCount?this._events=Object.create(null):delete n[e]),this;if(0===arguments.length){var l,f=Object.keys(n);for(a=0;a<f.length;++a)"removeListener"!==(l=f[a])&&this.removeAllListeners(l);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(void 0!==t)for(a=t.length-1;a>=0;a--)this.removeListener(e,t[a]);return this},EventEmitter.prototype.listeners=function listeners(e){return _listeners(this,e,!0)},EventEmitter.prototype.rawListeners=function rawListeners(e){return _listeners(this,e,!1)},EventEmitter.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):listenerCount.call(e,t)},EventEmitter.prototype.listenerCount=listenerCount,EventEmitter.prototype.eventNames=function eventNames(){return this._eventsCount>0?t(this._events):[]}},9804:function(e){var t=Object.prototype.hasOwnProperty,n=Object.prototype.toString;e.exports=function forEach(e,a,l){if("[object Function]"!==n.call(a))throw new TypeError("iterator must be a function");var f=e.length;if(f===+f)for(var p=0;p<f;p++)a.call(l,e[p],p,e);else for(var h in e)t.call(e,h)&&a.call(l,e[h],h,e)}},7648:function(e){"use strict";var t="Function.prototype.bind called on incompatible ",n=Array.prototype.slice,a=Object.prototype.toString,l="[object Function]";e.exports=function bind(e){var f=this;if("function"!=typeof f||a.call(f)!==l)throw new TypeError(t+f);for(var p,h=n.call(arguments,1),binder=function(){if(this instanceof p){var t=f.apply(this,h.concat(n.call(arguments)));return Object(t)===t?t:this}return f.apply(e,h.concat(n.call(arguments)))},m=Math.max(0,f.length-h.length),g=[],v=0;v<m;v++)g.push("$"+v);if(p=Function("binder","return function ("+g.join(",")+"){ return binder.apply(this,arguments); }")(binder),f.prototype){var y=function Empty(){};y.prototype=f.prototype,p.prototype=new y,y.prototype=null}return p}},8612:function(e,t,n){"use strict";var a=n(7648);e.exports=Function.prototype.bind||a},210:function(e,t,n){"use strict";var a,l=SyntaxError,f=Function,p=TypeError,getEvalledConstructor=function(e){try{return f('"use strict"; return ('+e+").constructor;")()}catch(t){}},h=Object.getOwnPropertyDescriptor;if(h)try{h({},"")}catch(L){h=null}var throwTypeError=function(){throw new p},m=h?function(){try{return throwTypeError}catch(e){try{return h(arguments,"callee").get}catch(t){return throwTypeError}}}():throwTypeError,g=n(1405)(),v=Object.getPrototypeOf||function(e){return e.__proto__},y={},_="undefined"==typeof Uint8Array?a:v(Uint8Array),b={"%AggregateError%":"undefined"==typeof AggregateError?a:AggregateError,"%Array%":Array,"%ArrayBuffer%":"undefined"==typeof ArrayBuffer?a:ArrayBuffer,"%ArrayIteratorPrototype%":g?v([][Symbol.iterator]()):a,"%AsyncFromSyncIteratorPrototype%":a,"%AsyncFunction%":y,"%AsyncGenerator%":y,"%AsyncGeneratorFunction%":y,"%AsyncIteratorPrototype%":y,"%Atomics%":"undefined"==typeof Atomics?a:Atomics,"%BigInt%":"undefined"==typeof BigInt?a:BigInt,"%Boolean%":Boolean,"%DataView%":"undefined"==typeof DataView?a:DataView,"%Date%":Date,"%decodeURI%":decodeURI,"%decodeURIComponent%":decodeURIComponent,"%encodeURI%":encodeURI,"%encodeURIComponent%":encodeURIComponent,"%Error%":Error,"%eval%":eval,"%EvalError%":EvalError,"%Float32Array%":"undefined"==typeof Float32Array?a:Float32Array,"%Float64Array%":"undefined"==typeof Float64Array?a:Float64Array,"%FinalizationRegistry%":"undefined"==typeof FinalizationRegistry?a:FinalizationRegistry,"%Function%":f,"%GeneratorFunction%":y,"%Int8Array%":"undefined"==typeof Int8Array?a:Int8Array,"%Int16Array%":"undefined"==typeof Int16Array?a:Int16Array,"%Int32Array%":"undefined"==typeof Int32Array?a:Int32Array,"%isFinite%":isFinite,"%isNaN%":isNaN,"%IteratorPrototype%":g?v(v([][Symbol.iterator]())):a,"%JSON%":"object"==typeof JSON?JSON:a,"%Map%":"undefined"==typeof Map?a:Map,"%MapIteratorPrototype%":"undefined"!=typeof Map&&g?v((new Map)[Symbol.iterator]()):a,"%Math%":Math,"%Number%":Number,"%Object%":Object,"%parseFloat%":parseFloat,"%parseInt%":parseInt,"%Promise%":"undefined"==typeof Promise?a:Promise,"%Proxy%":"undefined"==typeof Proxy?a:Proxy,"%RangeError%":RangeError,"%ReferenceError%":ReferenceError,"%Reflect%":"undefined"==typeof Reflect?a:Reflect,"%RegExp%":RegExp,"%Set%":"undefined"==typeof Set?a:Set,"%SetIteratorPrototype%":"undefined"!=typeof Set&&g?v((new Set)[Symbol.iterator]()):a,"%SharedArrayBuffer%":"undefined"==typeof SharedArrayBuffer?a:SharedArrayBuffer,"%String%":String,"%StringIteratorPrototype%":g?v(""[Symbol.iterator]()):a,"%Symbol%":g?Symbol:a,"%SyntaxError%":l,"%ThrowTypeError%":m,"%TypedArray%":_,"%TypeError%":p,"%Uint8Array%":"undefined"==typeof Uint8Array?a:Uint8Array,"%Uint8ClampedArray%":"undefined"==typeof Uint8ClampedArray?a:Uint8ClampedArray,"%Uint16Array%":"undefined"==typeof Uint16Array?a:Uint16Array,"%Uint32Array%":"undefined"==typeof Uint32Array?a:Uint32Array,"%URIError%":URIError,"%WeakMap%":"undefined"==typeof WeakMap?a:WeakMap,"%WeakRef%":"undefined"==typeof WeakRef?a:WeakRef,"%WeakSet%":"undefined"==typeof WeakSet?a:WeakSet},C=function doEval(e){var t;if("%AsyncFunction%"===e)t=getEvalledConstructor("async function () {}");else if("%GeneratorFunction%"===e)t=getEvalledConstructor("function* () {}");else if("%AsyncGeneratorFunction%"===e)t=getEvalledConstructor("async function* () {}");else if("%AsyncGenerator%"===e){var n=doEval("%AsyncGeneratorFunction%");n&&(t=n.prototype)}else if("%AsyncIteratorPrototype%"===e){var a=doEval("%AsyncGenerator%");a&&(t=v(a.prototype))}return b[e]=t,t},S={"%ArrayBufferPrototype%":["ArrayBuffer","prototype"],"%ArrayPrototype%":["Array","prototype"],"%ArrayProto_entries%":["Array","prototype","entries"],"%ArrayProto_forEach%":["Array","prototype","forEach"],"%ArrayProto_keys%":["Array","prototype","keys"],"%ArrayProto_values%":["Array","prototype","values"],"%AsyncFunctionPrototype%":["AsyncFunction","prototype"],"%AsyncGenerator%":["AsyncGeneratorFunction","prototype"],"%AsyncGeneratorPrototype%":["AsyncGeneratorFunction","prototype","prototype"],"%BooleanPrototype%":["Boolean","prototype"],"%DataViewPrototype%":["DataView","prototype"],"%DatePrototype%":["Date","prototype"],"%ErrorPrototype%":["Error","prototype"],"%EvalErrorPrototype%":["EvalError","prototype"],"%Float32ArrayPrototype%":["Float32Array","prototype"],"%Float64ArrayPrototype%":["Float64Array","prototype"],"%FunctionPrototype%":["Function","prototype"],"%Generator%":["GeneratorFunction","prototype"],"%GeneratorPrototype%":["GeneratorFunction","prototype","prototype"],"%Int8ArrayPrototype%":["Int8Array","prototype"],"%Int16ArrayPrototype%":["Int16Array","prototype"],"%Int32ArrayPrototype%":["Int32Array","prototype"],"%JSONParse%":["JSON","parse"],"%JSONStringify%":["JSON","stringify"],"%MapPrototype%":["Map","prototype"],"%NumberPrototype%":["Number","prototype"],"%ObjectPrototype%":["Object","prototype"],"%ObjProto_toString%":["Object","prototype","toString"],"%ObjProto_valueOf%":["Object","prototype","valueOf"],"%PromisePrototype%":["Promise","prototype"],"%PromiseProto_then%":["Promise","prototype","then"],"%Promise_all%":["Promise","all"],"%Promise_reject%":["Promise","reject"],"%Promise_resolve%":["Promise","resolve"],"%RangeErrorPrototype%":["RangeError","prototype"],"%ReferenceErrorPrototype%":["ReferenceError","prototype"],"%RegExpPrototype%":["RegExp","prototype"],"%SetPrototype%":["Set","prototype"],"%SharedArrayBufferPrototype%":["SharedArrayBuffer","prototype"],"%StringPrototype%":["String","prototype"],"%SymbolPrototype%":["Symbol","prototype"],"%SyntaxErrorPrototype%":["SyntaxError","prototype"],"%TypedArrayPrototype%":["TypedArray","prototype"],"%TypeErrorPrototype%":["TypeError","prototype"],"%Uint8ArrayPrototype%":["Uint8Array","prototype"],"%Uint8ClampedArrayPrototype%":["Uint8ClampedArray","prototype"],"%Uint16ArrayPrototype%":["Uint16Array","prototype"],"%Uint32ArrayPrototype%":["Uint32Array","prototype"],"%URIErrorPrototype%":["URIError","prototype"],"%WeakMapPrototype%":["WeakMap","prototype"],"%WeakSetPrototype%":["WeakSet","prototype"]},k=n(8612),w=n(7642),T=k.call(Function.call,Array.prototype.concat),P=k.call(Function.apply,Array.prototype.splice),A=k.call(Function.call,String.prototype.replace),M=k.call(Function.call,String.prototype.slice),x=/[^%.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|%$))/g,O=/\\(\\)?/g,R=function stringToPath(e){var t=M(e,0,1),n=M(e,-1);if("%"===t&&"%"!==n)throw new l("invalid intrinsic syntax, expected closing `%`");if("%"===n&&"%"!==t)throw new l("invalid intrinsic syntax, expected opening `%`");var a=[];return A(e,x,(function(e,t,n,l){a[a.length]=n?A(l,O,"$1"):t||e})),a},I=function getBaseIntrinsic(e,t){var n,a=e;if(w(S,a)&&(a="%"+(n=S[a])[0]+"%"),w(b,a)){var f=b[a];if(f===y&&(f=C(a)),void 0===f&&!t)throw new p("intrinsic "+e+" exists, but is not available. Please file an issue!");return{alias:n,name:a,value:f}}throw new l("intrinsic "+e+" does not exist!")};e.exports=function GetIntrinsic(e,t){if("string"!=typeof e||0===e.length)throw new p("intrinsic name must be a non-empty string");if(arguments.length>1&&"boolean"!=typeof t)throw new p('"allowMissing" argument must be a boolean');var n=R(e),a=n.length>0?n[0]:"",f=I("%"+a+"%",t),m=f.name,g=f.value,v=!1,y=f.alias;y&&(a=y[0],P(n,T([0,1],y)));for(var _=1,C=!0;_<n.length;_+=1){var S=n[_],k=M(S,0,1),A=M(S,-1);if(('"'===k||"'"===k||"`"===k||'"'===A||"'"===A||"`"===A)&&k!==A)throw new l("property names with quotes must have matching quotes");if("constructor"!==S&&C||(v=!0),w(b,m="%"+(a+="."+S)+"%"))g=b[m];else if(null!=g){if(!(S in g)){if(!t)throw new p("base intrinsic for "+e+" exists, but the property is not available.");return}if(h&&_+1>=n.length){var x=h(g,S);g=(C=!!x)&&"get"in x&&!("originalValue"in x.get)?x.get:g[S]}else C=w(g,S),g=g[S];C&&!v&&(b[m]=g)}}return g}},1405:function(e,t,n){"use strict";var a="undefined"!=typeof Symbol&&Symbol,l=n(5419);e.exports=function hasNativeSymbols(){return"function"==typeof a&&("function"==typeof Symbol&&("symbol"==typeof a("foo")&&("symbol"==typeof Symbol("bar")&&l())))}},5419:function(e){"use strict";e.exports=function hasSymbols(){if("function"!=typeof Symbol||"function"!=typeof Object.getOwnPropertySymbols)return!1;if("symbol"==typeof Symbol.iterator)return!0;var e={},t=Symbol("test"),n=Object(t);if("string"==typeof t)return!1;if("[object Symbol]"!==Object.prototype.toString.call(t))return!1;if("[object Symbol]"!==Object.prototype.toString.call(n))return!1;for(t in e[t]=42,e)return!1;if("function"==typeof Object.keys&&0!==Object.keys(e).length)return!1;if("function"==typeof Object.getOwnPropertyNames&&0!==Object.getOwnPropertyNames(e).length)return!1;var a=Object.getOwnPropertySymbols(e);if(1!==a.length||a[0]!==t)return!1;if(!Object.prototype.propertyIsEnumerable.call(e,t))return!1;if("function"==typeof Object.getOwnPropertyDescriptor){var l=Object.getOwnPropertyDescriptor(e,t);if(42!==l.value||!0!==l.enumerable)return!1}return!0}},6410:function(e,t,n){"use strict";var a=n(5419);e.exports=function hasToStringTagShams(){return a()&&!!Symbol.toStringTag}},7642:function(e,t,n){"use strict";var a=n(8612);e.exports=a.call(Function.call,Object.prototype.hasOwnProperty)},5717:function(e){"function"==typeof Object.create?e.exports=function inherits(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:e.exports=function inherits(e,t){if(t){e.super_=t;var TempCtor=function(){};TempCtor.prototype=t.prototype,e.prototype=new TempCtor,e.prototype.constructor=e}}},2584:function(e,t,n){"use strict";var a=n(6410)(),l=n(1924)("Object.prototype.toString"),f=function isArguments(e){return!(a&&e&&"object"==typeof e&&Symbol.toStringTag in e)&&"[object Arguments]"===l(e)},p=function isArguments(e){return!!f(e)||null!==e&&"object"==typeof e&&"number"==typeof e.length&&e.length>=0&&"[object Array]"!==l(e)&&"[object Function]"===l(e.callee)},h=function(){return f(arguments)}();f.isLegacyArguments=p,e.exports=h?f:p},8662:function(e,t,n){"use strict";var a,l=Object.prototype.toString,f=Function.prototype.toString,p=/^\s*(?:function)?\*/,h=n(6410)(),m=Object.getPrototypeOf;e.exports=function isGeneratorFunction(e){if("function"!=typeof e)return!1;if(p.test(f.call(e)))return!0;if(!h)return"[object GeneratorFunction]"===l.call(e);if(!m)return!1;if(void 0===a){var t=function(){if(!h)return!1;try{return Function("return function*() {}")()}catch(e){}}();a=!!t&&m(t)}return m(e)===a}},5692:function(e,t,n){"use strict";var a=n(9804),l=n(3083),f=n(1924),p=f("Object.prototype.toString"),h=n(6410)(),m="undefined"==typeof globalThis?n.g:globalThis,g=l(),v=f("Array.prototype.indexOf",!0)||function indexOf(e,t){for(var n=0;n<e.length;n+=1)if(e[n]===t)return n;return-1},y=f("String.prototype.slice"),_={},b=n(882),C=Object.getPrototypeOf;h&&b&&C&&a(g,(function(e){var t=new m[e];if(Symbol.toStringTag in t){var n=C(t),a=b(n,Symbol.toStringTag);if(!a){var l=C(n);a=b(l,Symbol.toStringTag)}_[e]=a.get}}));e.exports=function isTypedArray(e){if(!e||"object"!=typeof e)return!1;if(!h||!(Symbol.toStringTag in e)){var t=y(p(e),8,-1);return v(g,t)>-1}return!!b&&function tryAllTypedArrays(e){var t=!1;return a(_,(function(n,a){if(!t)try{t=n.call(e)===a}catch(l){}})),t}(e)}},3814:function(e,t,n){e.exports=n(1361)},1361:function(e,t,n){var a=n(9539),l=e.exports=n(3984);function failCheck(e,t,n,l){n=n||"";var f=new e(a.format.apply(this,[n].concat(l)));throw Error.captureStackTrace(f,t),f}function failArgumentCheck(e,t,n){failCheck(l.IllegalArgumentError,e,t,n)}function failStateCheck(e,t,n){failCheck(l.IllegalStateError,e,t,n)}function typeOf(e){var t=typeof e;if("object"==t){if(!e)return"null";if(e instanceof Array)return"array"}return t}function typeCheck(e){return function(t,n){var a=typeOf(t);if(a==e)return t;failArgumentCheck(arguments.callee,n||'Expected "'+e+'" but got "'+a+'".',Array.prototype.slice.call(arguments,2))}}e.exports.checkArgument=function(e,t){e||failArgumentCheck(arguments.callee,t,Array.prototype.slice.call(arguments,2))},e.exports.checkState=function(e,t){e||failStateCheck(arguments.callee,t,Array.prototype.slice.call(arguments,2))},e.exports.checkIsDef=function(e,t){if(void 0!==e)return e;failArgumentCheck(arguments.callee,t||"Expected value to be defined but was undefined.",Array.prototype.slice.call(arguments,2))},e.exports.checkIsDefAndNotNull=function(e,t){if(null!=e)return e;failArgumentCheck(arguments.callee,t||'Expected value to be defined and not null but got "'+typeOf(e)+'".',Array.prototype.slice.call(arguments,2))},e.exports.checkIsString=typeCheck("string"),e.exports.checkIsArray=typeCheck("array"),e.exports.checkIsNumber=typeCheck("number"),e.exports.checkIsBoolean=typeCheck("boolean"),e.exports.checkIsFunction=typeCheck("function"),e.exports.checkIsObject=typeCheck("object")},3984:function(e,t,n){var a=n(9539);function IllegalArgumentError(e){Error.call(this,e),this.message=e}function IllegalStateError(e){Error.call(this,e),this.message=e}a.inherits(IllegalArgumentError,Error),IllegalArgumentError.prototype.name="IllegalArgumentError",a.inherits(IllegalStateError,Error),IllegalStateError.prototype.name="IllegalStateError",e.exports.IllegalStateError=IllegalStateError,e.exports.IllegalArgumentError=IllegalArgumentError},4155:function(e){var t,n,a=e.exports={};function defaultSetTimout(){throw new Error("setTimeout has not been defined")}function defaultClearTimeout(){throw new Error("clearTimeout has not been defined")}function runTimeout(e){if(t===setTimeout)return setTimeout(e,0);if((t===defaultSetTimout||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:defaultSetTimout}catch(e){t=defaultSetTimout}try{n="function"==typeof clearTimeout?clearTimeout:defaultClearTimeout}catch(e){n=defaultClearTimeout}}();var l,f=[],p=!1,h=-1;function cleanUpNextTick(){p&&l&&(p=!1,l.length?f=l.concat(f):h=-1,f.length&&drainQueue())}function drainQueue(){if(!p){var e=runTimeout(cleanUpNextTick);p=!0;for(var t=f.length;t;){for(l=f,f=[];++h<t;)l&&l[h].run();h=-1,t=f.length}l=null,p=!1,function runClearTimeout(e){if(n===clearTimeout)return clearTimeout(e);if((n===defaultClearTimeout||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{return n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function Item(e,t){this.fun=e,this.array=t}function noop(){}a.nextTick=function(e){var t=new Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];f.push(new Item(e,t)),1!==f.length||p||runTimeout(drainQueue)},Item.prototype.run=function(){this.fun.apply(null,this.array)},a.title="browser",a.browser=!0,a.env={},a.argv=[],a.version="",a.versions={},a.on=noop,a.addListener=noop,a.once=noop,a.off=noop,a.removeListener=noop,a.removeAllListeners=noop,a.emit=noop,a.prependListener=noop,a.prependOnceListener=noop,a.listeners=function(e){return[]},a.binding=function(e){throw new Error("process.binding is not supported")},a.cwd=function(){return"/"},a.chdir=function(e){throw new Error("process.chdir is not supported")},a.umask=function(){return 0}},6940:function(e,t,n){"use strict";n.r(t),t.default="1.6.3"},5666:function(e){var t=function(e){"use strict";var t,n=Object.prototype,a=n.hasOwnProperty,l="function"==typeof Symbol?Symbol:{},f=l.iterator||"@@iterator",p=l.asyncIterator||"@@asyncIterator",h=l.toStringTag||"@@toStringTag";function define(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{define({},"")}catch(w){define=function(e,t,n){return e[t]=n}}function wrap(e,t,n,a){var l=t&&t.prototype instanceof Generator?t:Generator,f=Object.create(l.prototype),p=new Context(a||[]);return f._invoke=function makeInvokeMethod(e,t,n){var a=m;return function invoke(l,f){if(a===v)throw new Error("Generator is already running");if(a===y){if("throw"===l)throw f;return doneResult()}for(n.method=l,n.arg=f;;){var p=n.delegate;if(p){var h=maybeInvokeDelegate(p,n);if(h){if(h===_)continue;return h}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(a===m)throw a=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);a=v;var b=tryCatch(e,t,n);if("normal"===b.type){if(a=n.done?y:g,b.arg===_)continue;return{value:b.arg,done:n.done}}"throw"===b.type&&(a=y,n.method="throw",n.arg=b.arg)}}}(e,n,p),f}function tryCatch(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(w){return{type:"throw",arg:w}}}e.wrap=wrap;var m="suspendedStart",g="suspendedYield",v="executing",y="completed",_={};function Generator(){}function GeneratorFunction(){}function GeneratorFunctionPrototype(){}var b={};define(b,f,(function(){return this}));var C=Object.getPrototypeOf,S=C&&C(C(values([])));S&&S!==n&&a.call(S,f)&&(b=S);var k=GeneratorFunctionPrototype.prototype=Generator.prototype=Object.create(b);function defineIteratorMethods(e){["next","throw","return"].forEach((function(t){define(e,t,(function(e){return this._invoke(t,e)}))}))}function AsyncIterator(e,t){function invoke(n,l,f,p){var h=tryCatch(e[n],e,l);if("throw"!==h.type){var m=h.arg,g=m.value;return g&&"object"==typeof g&&a.call(g,"__await")?t.resolve(g.__await).then((function(e){invoke("next",e,f,p)}),(function(e){invoke("throw",e,f,p)})):t.resolve(g).then((function(e){m.value=e,f(m)}),(function(e){return invoke("throw",e,f,p)}))}p(h.arg)}var n;this._invoke=function enqueue(e,a){function callInvokeWithMethodAndArg(){return new t((function(t,n){invoke(e,a,t,n)}))}return n=n?n.then(callInvokeWithMethodAndArg,callInvokeWithMethodAndArg):callInvokeWithMethodAndArg()}}function maybeInvokeDelegate(e,n){var a=e.iterator[n.method];if(a===t){if(n.delegate=null,"throw"===n.method){if(e.iterator.return&&(n.method="return",n.arg=t,maybeInvokeDelegate(e,n),"throw"===n.method))return _;n.method="throw",n.arg=new TypeError("The iterator does not provide a 'throw' method")}return _}var l=tryCatch(a,e.iterator,n.arg);if("throw"===l.type)return n.method="throw",n.arg=l.arg,n.delegate=null,_;var f=l.arg;return f?f.done?(n[e.resultName]=f.value,n.next=e.nextLoc,"return"!==n.method&&(n.method="next",n.arg=t),n.delegate=null,_):f:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,_)}function pushTryEntry(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function resetTryEntry(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function Context(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(pushTryEntry,this),this.reset(!0)}function values(e){if(e){var n=e[f];if(n)return n.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var l=-1,p=function next(){for(;++l<e.length;)if(a.call(e,l))return next.value=e[l],next.done=!1,next;return next.value=t,next.done=!0,next};return p.next=p}}return{next:doneResult}}function doneResult(){return{value:t,done:!0}}return GeneratorFunction.prototype=GeneratorFunctionPrototype,define(k,"constructor",GeneratorFunctionPrototype),define(GeneratorFunctionPrototype,"constructor",GeneratorFunction),GeneratorFunction.displayName=define(GeneratorFunctionPrototype,h,"GeneratorFunction"),e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===GeneratorFunction||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,GeneratorFunctionPrototype):(e.__proto__=GeneratorFunctionPrototype,define(e,h,"GeneratorFunction")),e.prototype=Object.create(k),e},e.awrap=function(e){return{__await:e}},defineIteratorMethods(AsyncIterator.prototype),define(AsyncIterator.prototype,p,(function(){return this})),e.AsyncIterator=AsyncIterator,e.async=function(t,n,a,l,f){void 0===f&&(f=Promise);var p=new AsyncIterator(wrap(t,n,a,l),f);return e.isGeneratorFunction(n)?p:p.next().then((function(e){return e.done?e.value:p.next()}))},defineIteratorMethods(k),define(k,h,"Generator"),define(k,f,(function(){return this})),define(k,"toString",(function(){return"[object Generator]"})),e.keys=function(e){var t=[];for(var n in e)t.push(n);return t.reverse(),function next(){for(;t.length;){var n=t.pop();if(n in e)return next.value=n,next.done=!1,next}return next.done=!0,next}},e.values=values,Context.prototype={constructor:Context,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(resetTryEntry),!e)for(var n in this)"t"===n.charAt(0)&&a.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=t)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var n=this;function handle(a,l){return p.type="throw",p.arg=e,n.next=a,l&&(n.method="next",n.arg=t),!!l}for(var l=this.tryEntries.length-1;l>=0;--l){var f=this.tryEntries[l],p=f.completion;if("root"===f.tryLoc)return handle("end");if(f.tryLoc<=this.prev){var h=a.call(f,"catchLoc"),m=a.call(f,"finallyLoc");if(h&&m){if(this.prev<f.catchLoc)return handle(f.catchLoc,!0);if(this.prev<f.finallyLoc)return handle(f.finallyLoc)}else if(h){if(this.prev<f.catchLoc)return handle(f.catchLoc,!0)}else{if(!m)throw new Error("try statement without catch or finally");if(this.prev<f.finallyLoc)return handle(f.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var l=this.tryEntries[n];if(l.tryLoc<=this.prev&&a.call(l,"finallyLoc")&&this.prev<l.finallyLoc){var f=l;break}}f&&("break"===e||"continue"===e)&&f.tryLoc<=t&&t<=f.finallyLoc&&(f=null);var p=f?f.completion:{};return p.type=e,p.arg=t,f?(this.method="next",this.next=f.finallyLoc,_):this.complete(p)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),_},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),resetTryEntry(n),_}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var a=n.completion;if("throw"===a.type){var l=a.arg;resetTryEntry(n)}return l}}throw new Error("illegal catch attempt")},delegateYield:function(e,n,a){return this.delegate={iterator:values(e),resultName:n,nextLoc:a},"next"===this.method&&(this.arg=t),_}},e}(e.exports);try{regeneratorRuntime=t}catch(n){"object"==typeof globalThis?globalThis.regeneratorRuntime=t:Function("r","regeneratorRuntime = r")(t)}},4279:function(e){function E(){}E.prototype={on:function(e,t,n){var a=this.e||(this.e={});return(a[e]||(a[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var a=this;function listener(){a.off(e,listener),t.apply(n,arguments)}return listener._=t,this.on(e,listener,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),a=0,l=n.length;a<l;a++)n[a].fn.apply(n[a].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),a=n[e],l=[];if(a&&t)for(var f=0,p=a.length;f<p;f++)a[f].fn!==t&&a[f].fn._!==t&&l.push(a[f]);return l.length?n[e]=l:delete n[e],this}},e.exports=E,e.exports.TinyEmitter=E},3651:function(e,t,n){"use strict";var a=n(7422);e.exports=function createCancelableRoomPromise(e,t,n,l){var f,p=new Error("Canceled");return new a((function onCreate(h,m,g){var v;e((function getLocalTracksSucceeded(e){return g()?a.reject(p):(v=t(e),n(v).then((function createRoomSignalingSucceeded(e){if(g())throw p;return f=e()})))})).then((function roomSignalingConnected(e){if(g())throw e.disconnect(),p;h(l(v,e))})).catch((function onError(e){m(e)}))}),(function onCancel(){f&&f.cancel()}))}},1060:function(e,t,n){"use strict";var a=n(3819).MediaStreamTrack,l=n(2939),f=l.guessBrowser,p=l.guessBrowserVersion,h=n(3651),m=n(4769),g=n(3111),v=n(1299),y=n(9849),_=n(8363),b=n(186),C=b.LocalAudioTrack,S=b.LocalDataTrack,k=b.LocalVideoTrack,w=n(7453),T=n(7081),P=n(9528),A=n(6971),M=A.asLocalTrack,x=A.buildLogLevels,O=A.filterObject,R=A.isNonArrayObject,I=n(2097),L=I.DEFAULT_ENVIRONMENT,N=I.DEFAULT_LOG_LEVEL,D=I.DEFAULT_LOGGER_NAME,B=I.DEFAULT_REALM,F=I.DEFAULT_REGION,j=I.WS_SERVER,$=I.SDK_NAME,H=I.SDK_VERSION,V=I.typeErrors,U=n(7422),G=n(3451),q=n(6372),W=n(324).kG,z="safari"===f()&&p(),K=0,Z=!1,Q=!1;if(z){var X=z.major,Y=z.minor;Q=X<12||12===X&&Y<1}var J=new Set([{didWarn:!1,shouldDelete:!0,name:"abortOnIceServersTimeout"},{didWarn:!1,shouldDelete:!0,name:"dscpTagging",newName:"enableDscp"},{didWarn:!1,shouldDelete:!0,name:"iceServersTimeout"},{didWarn:!1,shouldDelete:!1,name:"eventListener",newName:"Video.Logger"},{didWarn:!1,shouldDelete:!1,name:"logLevel",newName:"Video.Logger"}]),ee=new Set([{didWarn:!1,shouldDelete:!1,name:"maxTracks",newName:"bandwidthProfile.video.clientTrackSwitchOffControl"},{didWarn:!1,shouldDelete:!1,name:"renderDimensions",newName:"bandwidthProfile.video.contentPreferencesMode"}]);function deprecateOptions(e,t,n){n.forEach((function(n){var a=n.didWarn,l=n.name,f=n.newName,p=n.shouldDelete;l in e&&void 0!==e[l]&&(f&&p&&(e[f]=e[l]),p&&delete e[l],a||["error","off"].includes(t.level)||(t.warn('The ConnectOptions "'+l+'" is '+(f?'deprecated and scheduled for removal. Please use "'+f+'" instead.':"no longer applicable and will be ignored.")),n.didWarn=!0))}))}function createLocalParticipant(e,t,n,a,l,f){var p=e.createLocalParticipantSignaling(n,a);return t.debug("Creating a new LocalParticipant:",p),new l.LocalParticipant(p,f,l)}function createRoom(e,t,n){var a=new T(t,n,e),l=e.log;return l.debug("Creating a new Room:",a),n.on("stateChanged",(function stateChanged(e){"disconnected"===e&&(l.info("Disconnected from Room:",a.toString()),n.removeListener("stateChanged",stateChanged))})),a}function createRoomSignaling(e,t,n,a,l,f){return t.log.debug("Creating a new RoomSignaling"),n.connect(f._signaling,e,a,l,t)}function getLocalTracks(e,t){var n=e.log;return e.shouldStopLocalTracks=!e.tracks,e.shouldStopLocalTracks?n.info("LocalTracks were not provided, so they will be acquired automatically before connecting to the Room. LocalTracks will be released if connecting to the Room fails or if the Room is disconnected"):(n.info("Getting LocalTracks"),n.debug("Options:",e)),e.createLocalTracks(e).then((function getLocalTracksSucceeded(a){var l=t(a);return l.catch((function handleLocalTracksFailed(){e.shouldStopLocalTracks&&(n.info("The automatically acquired LocalTracks will now be stopped"),a.forEach((function(e){e.stop()})))})),l}))}function normalizeCodecSettings(e){var t="string"==typeof e?{codec:e}:e;switch(t.codec.toLowerCase()){case"opus":return Object.assign({dtx:!0},t);case"vp8":return Object.assign({simulcast:!1},t);default:return t}}e.exports=function connect(e,t){if(void 0===t&&(t={}),!R(t))return U.reject(V.INVALID_TYPE("options","object"));var n,l=t.Log||q,f=t.loggerName||D,p=t.logLevel||N,b=x(p),T="[connect #"+ ++K+"]";try{n=new l("default",T,b,f)}catch(te){return U.reject(te)}deprecateOptions(t,n,J);var A={};"string"==typeof(t=Object.assign({automaticSubscription:!0,createLocalTracks:m,dominantSpeaker:!1,enableDscp:!1,environment:L,eventListener:null,insights:!0,LocalAudioTrack:C,LocalDataTrack:S,LocalParticipant:v,LocalVideoTrack:k,Log:l,MediaStreamTrack:a,loggerName:f,logLevel:p,maxAudioBitrate:null,maxVideoBitrate:null,name:null,networkMonitor:!0,networkQuality:!1,preferredAudioCodecs:[],preferredVideoCodecs:[],realm:B,region:F,signaling:P},O(t))).wsServerInsights&&(A.gateway=t.wsServerInsights);var I=new(t.insights?y:_)(e,$,H,t.environment,t.realm,A),z=j(t.environment,t.region),X=new G(I,Date.now(),n,t.eventListener);if((t=Object.assign({eventObserver:X,wsServer:z},t)).log=n,Q&&!Z&&"error"!==n.logLevel&&"off"!==n.logLevel&&(Z=!0,n.warn(["Support for Safari 12.0 and below is limited because it does not support VP8.","This means you may experience codec issues in Group Rooms. You may also","experience codec issues in Peer-to-Peer (P2P) Rooms containing Android- or","iOS-based Participants who do not support H.264. However, P2P Rooms","with browser-based Participants should work. For more information, please","refer to this guide: https://www.twilio.com/docs/video/javascript-v2-developing-safari-11"].join(" "))),"string"!=typeof e)return U.reject(V.INVALID_TYPE("token","string"));var Y=Object.assign({},t);if(delete Y.name,"tracks"in t){if(!Array.isArray(t.tracks))return U.reject(V.INVALID_TYPE("options.tracks","Array of LocalAudioTrack, LocalVideoTrack or MediaStreamTrack"));try{t.tracks=t.tracks.map((function(e){return M(e,Y)}))}catch(te){return U.reject(te)}}var te=W(t.bandwidthProfile);if(te)return U.reject(te);t.clientTrackSwitchOffControl="disabled",t.contentPreferencesMode="disabled",t.bandwidthProfile&&(t.clientTrackSwitchOffControl="auto",t.contentPreferencesMode="auto",t.bandwidthProfile.video&&(deprecateOptions(t.bandwidthProfile.video,n,ee),"maxTracks"in t.bandwidthProfile.video?t.clientTrackSwitchOffControl="disabled":"manual"===t.bandwidthProfile.video.clientTrackSwitchOffControl?t.clientTrackSwitchOffControl="manual":t.clientTrackSwitchOffControl="auto","renderDimensions"in t.bandwidthProfile.video?t.contentPreferencesMode="disabled":"manual"===t.bandwidthProfile.video.contentPreferencesMode?t.contentPreferencesMode="manual":t.contentPreferencesMode="auto"));var ne=new(0,t.signaling)(t.wsServer,t);n.info("Connecting to a Room"),n.debug("Options:",t);var re=new g({maxAudioBitrate:t.maxAudioBitrate,maxVideoBitrate:t.maxVideoBitrate}),oe={audio:t.preferredAudioCodecs.map(normalizeCodecSettings),video:t.preferredVideoCodecs.map(normalizeCodecSettings)},ie=new w(R(t.networkQuality)?t.networkQuality:{}),ae=h(getLocalTracks.bind(null,t),createLocalParticipant.bind(null,ne,n,re,ie,t),createRoomSignaling.bind(null,e,t,ne,re,oe),createRoom.bind(null,t));return ae.then((function(e){return I.connect(e.sid,e.localParticipant.sid),n.info("Connected to Room:",e.toString()),n.info("Room name:",e.name),n.debug("Room:",e),e.once("disconnected",(function(){return I.disconnect()})),e}),(function(e){I.disconnect(),ae._isCanceled?n.info("Attempt to connect to a Room was canceled"):n.info("Error while connecting to a Room:",e)})),ae}},9218:function(e,t,n){"use strict";var a=n(4769),l=n(2097),f=l.DEFAULT_LOG_LEVEL,p=l.DEFAULT_LOGGER_NAME;function createLocalTrack(e,t){t=Object.assign({createLocalTracks:a,loggerName:p,logLevel:f},t);var n={};n.loggerName=t.loggerName,n.logLevel=t.logLevel,delete t.loggerName,delete t.logLevel;var l=t.createLocalTracks;return delete t.createLocalTracks,n[e]=!(Object.keys(t).length>0)||t,l(n).then((function(e){return e[0]}))}e.exports={audio:function createLocalAudioTrack(e){return createLocalTrack("audio",e)},video:function createLocalVideoTrack(e){return createLocalTrack("video",e)}}},4769:function(e,t,n){"use strict";var a=n(6971).asLocalTrack,l=n(6971).buildLogLevels,f=n(3819).getUserMedia,p=n(186),h=p.LocalAudioTrack,m=p.LocalDataTrack,g=p.LocalVideoTrack,v=n(3819).MediaStreamTrack,y=n(6372),_=n(2097),b=_.DEFAULT_LOG_LEVEL,C=_.DEFAULT_LOGGER_NAME,S=n(6245),k=0;e.exports=function createLocalTracks(e){var t=!(e&&("audio"in e||"video"in e));e=Object.assign({audio:t,getUserMedia:f,loggerName:C,logLevel:b,LocalAudioTrack:h,LocalDataTrack:m,LocalVideoTrack:g,MediaStreamTrack:v,Log:y,video:t},e);var n="[createLocalTracks #"+ ++k+"]",p=l(e.logLevel),_=new e.Log("default",n,p,e.loggerName),w=Object.assign({log:_},e);if(delete w.name,!1===e.audio&&!1===e.video)return _.info("Neither audio nor video requested, so returning empty LocalTracks"),Promise.resolve([]);if(e.tracks)return _.info("Adding user-provided LocalTracks"),_.debug("LocalTracks:",e.tracks),Promise.resolve(e.tracks);var T={audio:e.audio&&e.audio.name?{name:e.audio.name}:{},video:e.video&&e.video.name?{name:e.video.name}:{}};T.audio.isCreatedByCreateLocalTracks=!0,T.video.isCreatedByCreateLocalTracks=!0,e.audio&&"boolean"==typeof e.audio.workaroundWebKitBug1208516&&(T.audio.workaroundWebKitBug1208516=e.audio.workaroundWebKitBug1208516),e.video&&"boolean"==typeof e.video.workaroundWebKitBug1208516&&(T.video.workaroundWebKitBug1208516=e.video.workaroundWebKitBug1208516),e.audio&&delete e.audio.name,e.video&&delete e.video.name;var P={audio:e.audio,video:e.video};return(e.audio&&e.audio.workaroundWebKitBug180748?S(_,e.getUserMedia,P):e.getUserMedia(P)).then((function(e){var t=e.getAudioTracks().concat(e.getVideoTracks());return _.info("Call to getUserMedia successful; got MediaStreamTracks:",t),t.map((function(e){return a(e,Object.assign(T[e.kind],w))}))}),(function(e){throw _.warn("Call to getUserMedia failed:",e),e}))}},9538:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(5069),p=n(2003),h=function(e){function DataTrackReceiver(t){var n=e.call(this,t.label,t.maxPacketLifeTime,t.maxRetransmits,t.ordered)||this;return Object.defineProperties(n,{_dataChannel:{value:t}}),t.binaryType="arraybuffer",t.addEventListener("message",(function(e){n.emit("message",e.data)})),t.addEventListener("close",(function(){n.emit("close")})),n}return l(DataTrackReceiver,e),DataTrackReceiver.prototype.stop=function(){this._dataChannel.close(),e.prototype.stop.call(this)},DataTrackReceiver.prototype.toDataTransport=function(){return new p(this._dataChannel)},DataTrackReceiver}(f);e.exports=h},4716:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(5069),p=n(6971).makeUUID,h=function(e){function DataTrackSender(t,n,a){var l=e.call(this,p(),t,n,a)||this;return Object.defineProperties(l,{_clones:{value:new Set},_dataChannels:{value:new Set}}),l}return l(DataTrackSender,e),DataTrackSender.prototype._addClone=function(e){this._clones.add(e)},DataTrackSender.prototype.removeClone=function(e){this._clones.delete(e)},DataTrackSender.prototype.addDataChannel=function(e){return this._dataChannels.add(e),this},DataTrackSender.prototype.clone=function(){var e=this,t=new DataTrackSender(this.maxPacketLifeTime,this.maxRetransmits,this.ordered);return this._addClone(t),t.once("stopped",(function(){return e.removeClone(t)})),t},DataTrackSender.prototype.removeDataChannel=function(e){return this._dataChannels.delete(e),this},DataTrackSender.prototype.send=function(e){return this._dataChannels.forEach((function(t){try{t.send(e)}catch(n){}})),this._clones.forEach((function(t){try{t.send(e)}catch(n){}})),this},DataTrackSender.prototype.stop=function(){this._dataChannels.forEach((function(e){return e.close()})),this._clones.forEach((function(e){return e.stop()})),e.prototype.stop.call(this)},DataTrackSender}(f);e.exports=h},5069:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function DataTrackTransceiver(t,n,a,l){var f=e.call(this,t,"data")||this;return Object.defineProperties(f,{maxPacketLifeTime:{enumerable:!0,value:n},maxRetransmits:{enumerable:!0,value:a},ordered:{enumerable:!0,value:l}}),f}return l(DataTrackTransceiver,e),DataTrackTransceiver}(n(9430));e.exports=f},2003:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function DataTransport(t){var n=e.call(this)||this;return Object.defineProperties(n,{_dataChannel:{value:t},_messageQueue:{value:[]}}),t.addEventListener("open",(function(){n._messageQueue.splice(0).forEach((function(e){return n._publish(e)}))})),t.addEventListener("message",(function(e){var t=e.data;try{var a=JSON.parse(t);n.emit("message",a)}catch(l){}})),n.publish({type:"ready"}),n}return l(DataTransport,e),DataTransport.prototype._publish=function(e){var t=JSON.stringify(e);try{this._dataChannel.send(t)}catch(n){}},DataTransport.prototype.publish=function(e){var t=this._dataChannel;return"closing"!==t.readyState&&"closed"!==t.readyState&&("connecting"===t.readyState?(this._messageQueue.push(e),!0):(this._publish(e),!0))},DataTransport}(n(7187).EventEmitter);e.exports=f},3111:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function EncodingParametersImpl(t){var n=e.call(this)||this;return t=Object.assign({maxAudioBitrate:null,maxVideoBitrate:null},t),Object.defineProperties(n,{maxAudioBitrate:{value:t.maxAudioBitrate,writable:!0},maxVideoBitrate:{value:t.maxVideoBitrate,writable:!0}}),n}return l(EncodingParametersImpl,e),EncodingParametersImpl.prototype.toJSON=function(){return{maxAudioBitrate:this.maxAudioBitrate,maxVideoBitrate:this.maxVideoBitrate}},EncodingParametersImpl.prototype.update=function(e){var t=this;e=Object.assign({maxAudioBitrate:this.maxAudioBitrate,maxVideoBitrate:this.maxVideoBitrate},e),["maxAudioBitrate","maxVideoBitrate"].reduce((function(n,a){return t[a]!==e[a]&&(t[a]=e[a],n=!0),n}),!1)&&this.emit("changed")},EncodingParametersImpl}(n(7187).EventEmitter);e.exports=f},3029:function(e,t,n){"use strict";var a=n(7187).EventEmitter,l=n(6971).hidePrivateAndCertainPublicPropertiesInClass;e.exports=l(a,["domain"])},8445:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=n(6200),l={connect:n(1060),createLocalAudioTrack:n(9218).audio,createLocalTracks:n(4769),createLocalVideoTrack:n(9218).video,isSupported:n(1345)(),version:n(1730).version,Logger:n(5021),LocalAudioTrack:n(186).LocalAudioTrack,LocalDataTrack:n(186).LocalDataTrack,LocalVideoTrack:n(186).LocalVideoTrack};var f=l.isSupported,p=l.version,h=l.Logger,m=l.LocalAudioTrack,g=l.LocalVideoTrack,v=l.LocalDataTrack;e.exports={connect:function connect(e,t){return l.connect(e,t)},createLocalAudioTrack:function createLocalAudioTrack(e){return l.createLocalAudioTrack(e)},createLocalTracks:function createLocalTracks(e){return l.createLocalTracks(e)},createLocalVideoTrack:function createLocalVideoTrack(e){return l.createLocalVideoTrack(e)},runPreflight:a.runPreflight,isSupported:f,version:p,Logger:h,LocalAudioTrack:m,LocalVideoTrack:g,LocalDataTrack:v}},1299:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(3819).MediaStreamTrack,p=n(6971),h=p.asLocalTrack,m=p.asLocalTrackPublication,g=p.trackClass,v=n(2097),y=v.typeErrors,_=v.trackPriority,b=n(324).Wv,C=n(186),S=C.LocalAudioTrack,k=C.LocalDataTrack,w=C.LocalVideoTrack,T=n(7959),P=n(5197),A=n(3445),M=function(e){function LocalParticipant(t,n,a){var l=this,p=(a=Object.assign({LocalAudioTrack:S,LocalVideoTrack:w,LocalDataTrack:k,MediaStreamTrack:f,LocalAudioTrackPublication:T,LocalVideoTrackPublication:A,LocalDataTrackPublication:P,shouldStopLocalTracks:!1,tracks:n},a)).shouldStopLocalTracks?new Set(n.filter((function(e){return"data"!==e.kind}))):new Set;return l=e.call(this,t,a)||this,Object.defineProperties(l,{_eventObserver:{value:a.eventObserver},_LocalAudioTrack:{value:a.LocalAudioTrack},_LocalDataTrack:{value:a.LocalDataTrack},_LocalVideoTrack:{value:a.LocalVideoTrack},_MediaStreamTrack:{value:a.MediaStreamTrack},_LocalAudioTrackPublication:{value:a.LocalAudioTrackPublication},_LocalDataTrackPublication:{value:a.LocalDataTrackPublication},_LocalVideoTrackPublication:{value:a.LocalVideoTrackPublication},_tracksToStop:{value:p},signalingRegion:{enumerable:!0,get:function(){return t.signalingRegion}}}),l._handleTrackSignalingEvents(),l}return l(LocalParticipant,e),LocalParticipant.prototype._addTrack=function(t,n,a){var l=e.prototype._addTrack.call(this,t,n);return l&&"disconnected"!==this.state&&this._addLocalTrack(t,a),l},LocalParticipant.prototype._addLocalTrack=function(e,t){this._signaling.addTrack(e._trackSender,e.name,t),this._log.info("Added a new "+g(e,!0)+":",e.id),this._log.debug(g(e,!0)+":",e)},LocalParticipant.prototype._removeTrack=function(t,n){var a=e.prototype._removeTrack.call(this,t,n);return a&&"disconnected"!==this.state&&(this._signaling.removeTrack(t._trackSender),this._log.info("Removed a "+g(t,!0)+":",t.id),this._log.debug(g(t,!0)+":",t)),a},LocalParticipant.prototype._getTrackEvents=function(){return e.prototype._getTrackEvents.call(this).concat([["disabled","trackDisabled"],["enabled","trackEnabled"],["stopped","trackStopped"]])},LocalParticipant.prototype.toString=function(){return"[LocalParticipant #"+this._instanceId+(this.sid?": "+this.sid:"")+"]"},LocalParticipant.prototype._handleTrackSignalingEvents=function(){var e=this,t=this._log;if("disconnected"!==this.state){var n=this._signaling;this.on("trackDisabled",localTrackDisabled),this.on("trackEnabled",localTrackEnabled),this.on("trackStopped",localTrackStopped),this._tracks.forEach((function(n){e._addLocalTrack(n,_.PRIORITY_STANDARD),e._getOrCreateLocalTrackPublication(n).catch((function(e){t.warn("Failed to get or create LocalTrackPublication for "+n+":",e)}))}));var a=this;n.on("stateChanged",(function stateChanged(e){t.debug("Transitioned to state:",e),"disconnected"===e?(t.debug("Removing LocalTrack event listeners"),n.removeListener("stateChanged",stateChanged),a.removeListener("trackDisabled",localTrackDisabled),a.removeListener("trackEnabled",localTrackEnabled),a.removeListener("trackStopped",localTrackStopped),a._tracks.forEach((function(e){var t=localTrackStopped(e);t&&e._trackSender.removeClone(t._trackTransceiver)})),t.info("LocalParticipant disconnected. Stopping "+a._tracksToStop.size+" automatically-acquired LocalTracks"),a._tracksToStop.forEach((function(e){e.stop()}))):"connected"===e&&(t.info("reconnected"),setTimeout((function(){return a.emit("reconnected")}),0))}))}function localTrackDisabled(e){var a=n.getPublication(e._trackSender);a&&(a.disable(),t.debug("Disabled the "+g(e,!0)+":",e.id))}function localTrackEnabled(e){var a=n.getPublication(e._trackSender);a&&(a.enable(),t.debug("Enabled the "+g(e,!0)+":",e.id))}function localTrackStopped(e){var t=n.getPublication(e._trackSender);return t&&t.stop(),t}},LocalParticipant.prototype._getOrCreateLocalTrackPublication=function(e){var t=getTrackPublication(this.tracks,e);if(t)return Promise.resolve(t);var n=this._log,a=this,l=this._signaling.getPublication(e._trackSender);if(!l)return Promise.reject(new Error("Unexpected error: The "+e+" cannot be published"));function unpublish(e){a.unpublishTrack(e.track)}return new Promise((function(f,p){l.on("updated",(function updated(){var h=l.error;if(h)return l.removeListener("updated",updated),n.warn("Failed to publish the "+g(e,!0)+": "+h.message),a._removeTrack(e,e.id),setTimeout((function(){a.emit("trackPublicationFailed",h,e)})),void p(h);if(!a._tracks.has(e.id))return l.removeListener("updated",updated),void p(new Error("The "+e+" was unpublished"));if(l.sid){l.removeListener("updated",updated);var v={log:n,LocalAudioTrackPublication:a._LocalAudioTrackPublication,LocalDataTrackPublication:a._LocalDataTrackPublication,LocalVideoTrackPublication:a._LocalVideoTrackPublication};(t=getTrackPublication(a.tracks,e))||(t=m(e,l,unpublish,v),a._addTrackPublication(t));var y=a._signaling.state;"connected"!==y&&"connecting"!==y||(e._processorEventObserver&&e._processorEventObserver.on("event",(function(e){a._eventObserver.emit("event",{name:e.name,payload:e.data,group:"video-processor",level:"info"})})),e.processedTrack&&(e._captureFrames(),e._setSenderMediaStreamTrack(!0))),"connected"===y&&setTimeout((function(){a.emit("trackPublished",t)})),f(t)}}))}))},LocalParticipant.prototype.publishTrack=function(e,t){var n,a=getTrackPublication(this.tracks,e);if(a)return Promise.resolve(a);t=Object.assign({log:this._log,priority:_.PRIORITY_STANDARD,LocalAudioTrack:this._LocalAudioTrack,LocalDataTrack:this._LocalDataTrack,LocalVideoTrack:this._LocalVideoTrack,MediaStreamTrack:this._MediaStreamTrack},t);try{n=h(e,t)}catch(p){return Promise.reject(p)}var l=Object.values(_);if(!l.includes(t.priority))return Promise.reject(y.INVALID_VALUE("LocalTrackPublishOptions.priority",l));var f=this._addTrack(n,n.id,t.priority)||this._tracks.get(n.id);return this._getOrCreateLocalTrackPublication(f)},LocalParticipant.prototype.publishTracks=function(e){if(!Array.isArray(e))throw y.INVALID_TYPE("tracks","Array of LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack");return Promise.all(e.map(this.publishTrack,this))},LocalParticipant.prototype.setBandwidthProfile=function(){this._log.warn("setBandwidthProfile is not implemented yet and may be available in future versions of twilio-video.js")},LocalParticipant.prototype.setNetworkQualityConfiguration=function(e){if("object"!=typeof e||null===e)throw y.INVALID_TYPE("networkQualityConfiguration","NetworkQualityConfiguration");return["local","remote"].forEach((function(t){if(t in e&&("number"!=typeof e[t]||isNaN(e[t])))throw y.INVALID_TYPE("networkQualityConfiguration."+t,"number")})),this._signaling.setNetworkQualityConfiguration(e),this},LocalParticipant.prototype.setParameters=function(e){if(void 0!==e&&"object"!=typeof e)throw y.INVALID_TYPE("encodingParameters","EncodingParameters, null or undefined");return e?["maxAudioBitrate","maxVideoBitrate"].forEach((function(t){if(void 0!==e[t]&&"number"!=typeof e[t]&&null!==e[t])throw y.INVALID_TYPE("encodingParameters."+t,"number, null or undefined")})):null===e&&(e={maxAudioBitrate:null,maxVideoBitrate:null}),this._signaling.setParameters(e),this},LocalParticipant.prototype.unpublishTrack=function(e){b(e,{LocalAudioTrack:this._LocalAudioTrack,LocalDataTrack:this._LocalDataTrack,LocalVideoTrack:this._LocalVideoTrack,MediaStreamTrack:this._MediaStreamTrack});var t=this._tracks.get(e.id);if(!t)return null;if(this._signaling.getPublication(t._trackSender).publishFailed(new Error("The "+t+" was unpublished")),!(t=this._removeTrack(t,t.id)))return null;var n=getTrackPublication(this.tracks,t);return n&&this._removeTrackPublication(n),n},LocalParticipant.prototype.unpublishTracks=function(e){var t=this;if(!Array.isArray(e))throw y.INVALID_TYPE("tracks","Array of LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack");return e.reduce((function(e,n){var a=t.unpublishTrack(n);return a?e.concat(a):e}),[])},LocalParticipant}(n(8948));function getTrackPublication(e,t){return Array.from(e.values()).find((function(e){return e.track===t||e.track.mediaStreamTrack===t}))||null}e.exports=M},4592:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function AudioTrack(t,n){return e.call(this,t,n)||this}return l(AudioTrack,e),AudioTrack.prototype._start=function(){e.prototype._start.call(this),this._dummyEl&&(this._dummyEl.srcObject=null,this._dummyEl=null)},AudioTrack.prototype.attach=function(){return e.prototype.attach.apply(this,arguments)},AudioTrack.prototype.detach=function(){return e.prototype.detach.apply(this,arguments)},AudioTrack}(n(9361));e.exports=f},186:function(e,t,n){"use strict";e.exports={LocalAudioTrack:n(1662),LocalVideoTrack:n(2987),LocalDataTrack:n(4352)}},1662:function(e,t,n){"use strict";var a=n(9539).inherits,l=n(2935);function LocalAudioTrack(e,t){var n=new l(e,t);return Object.setPrototypeOf(n,LocalAudioTrack.prototype),n}a(LocalAudioTrack,l),e.exports=LocalAudioTrack},4352:function(e,t,n){"use strict";var a=n(9539).inherits,l=n(429);function LocalDataTrack(e){var t=new l(e);return Object.setPrototypeOf(t,LocalDataTrack.prototype),t}a(LocalDataTrack,l),e.exports=LocalDataTrack},2987:function(e,t,n){"use strict";var a=n(9539).inherits,l=n(566);function LocalVideoTrack(e,t){var n=new l(e,t);return Object.setPrototypeOf(n,LocalVideoTrack.prototype),n}a(LocalVideoTrack,l),e.exports=LocalVideoTrack},4958:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(3029),p=n(6971),h=p.buildLogLevels,m=p.valueToJSON,g=n(2097).DEFAULT_LOG_LEVEL,v=n(6372),y=0,_=function(e){function Track(t,n,a){var l;a=Object.assign({name:t,log:null,logLevel:g},a),l=e.call(this)||this;var f=String(a.name),p=h(a.logLevel),m=a.log?a.log.createLog("media",l):new v("media",l,p,a.loggerName);return Object.defineProperties(l,{_instanceId:{value:++y},_log:{value:m},kind:{enumerable:!0,value:n},name:{enumerable:!0,value:f}}),l}return l(Track,e),Track.prototype.toJSON=function(){return m(this)},Track}(f);e.exports=_},2935:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(4592),p=function(e){function LocalAudioTrack(t,n){return e.call(this,t,n)||this}return l(LocalAudioTrack,e),LocalAudioTrack.prototype.toString=function(){return"[LocalAudioTrack #"+this._instanceId+": "+this.id+"]"},LocalAudioTrack.prototype.attach=function(t){return(t=e.prototype.attach.call(this,t)).muted=!0,t},LocalAudioTrack.prototype._end=function(){return e.prototype._end.apply(this,arguments)},LocalAudioTrack.prototype.disable=function(){return e.prototype.disable.apply(this,arguments)},LocalAudioTrack.prototype.enable=function(){return e.prototype.enable.apply(this,arguments)},LocalAudioTrack.prototype.restart=function(){return e.prototype.restart.apply(this,arguments)},LocalAudioTrack.prototype.stop=function(){return e.prototype.stop.apply(this,arguments)},LocalAudioTrack}(n(5820)(f));e.exports=p},7959:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function LocalAudioTrackPublication(t,n,a,l){return e.call(this,t,n,a,l)||this}return l(LocalAudioTrackPublication,e),LocalAudioTrackPublication.prototype.toString=function(){return"[LocalAudioTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},LocalAudioTrackPublication}(n(6345));e.exports=f},429:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(4958),p=n(4716),h=function(e){function LocalDataTrack(t){var n,a=new(0,(t=Object.assign({DataTrackSender:p,maxPacketLifeTime:null,maxRetransmits:null,ordered:!0},t)).DataTrackSender)(t.maxPacketLifeTime,t.maxRetransmits,t.ordered);return n=e.call(this,a.id,"data",t)||this,Object.defineProperties(n,{_trackSender:{value:a},id:{enumerable:!0,value:a.id},maxPacketLifeTime:{enumerable:!0,value:t.maxPacketLifeTime},maxRetransmits:{enumerable:!0,value:t.maxRetransmits},ordered:{enumerable:!0,value:t.ordered},reliable:{enumerable:!0,value:null===t.maxPacketLifeTime&&null===t.maxRetransmits}}),n}return l(LocalDataTrack,e),LocalDataTrack.prototype.send=function(e){this._trackSender.send(e)},LocalDataTrack}(f);e.exports=h},5197:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function LocalDataTrackPublication(t,n,a,l){return e.call(this,t,n,a,l)||this}return l(LocalDataTrackPublication,e),LocalDataTrackPublication.prototype.toString=function(){return"[LocalDataTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},LocalDataTrackPublication}(n(6345));e.exports=f},5820:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(3819).getUserMedia,p=n(2939),h=p.guessBrowser,m=p.isIOSChrome,g=n(6971),v=g.capitalize,y=g.defer,_=g.isUserMediaTrack,b=g.waitForSometime,C=g.waitForEvent,S=n(2097).typeErrors.ILLEGAL_INVOKE,k=n(8685),w=n(8815),T=n(8379),P=n(4919),A=n(6245),M=n(2259);function restartWhenInadvertentlyStopped(e){var t=e._log,n=e.kind,a={audio:k,video:w}[n],l=e._dummyEl,f=e.mediaStreamTrack,p=null;function shouldReacquireTrack(){var n=e._workaroundWebKitBug1208516Cleanup,f=e.isStopped,h=e.mediaStreamTrack.muted,m=f&&!!n;return Promise.resolve().then((function(){return"visible"===document.visibilityState&&!p&&(h||m||function checkSilence(){return l.play().then((function(){return a(l)})).then((function(e){return e?t.warn("Silence detected"):t.info("Non-silence detected"),e})).catch((function(e){t.warn("Failed to detect silence:",e)})).finally((function(){l.pause()}))}())}))}function maybeRestart(){return Promise.race([C(f,"unmute"),b(50)]).then((function(){return shouldReacquireTrack()})).then((function(t){return t&&!p&&(p=y(),e._restart().finally((function(){l=e._dummyEl,removeMediaStreamTrackListeners(),f=e.mediaStreamTrack,addMediaStreamTrackListeners(),p.resolve(),p=null}))),(p&&p.promise||Promise.resolve()).finally((function(){return P.resolveDeferred(n)}))})).catch((function(e){t.error("error in maybeRestart: "+e.message)}))}function onMute(){var t=e._log,n=e.kind;t.info("Muted"),t.debug("LocalMediaTrack:",e),P.startDeferred(n)}function addMediaStreamTrackListeners(){f.addEventListener("ended",maybeRestart),f.addEventListener("mute",onMute),f.addEventListener("unmute",maybeRestart)}function removeMediaStreamTrackListeners(){f.removeEventListener("ended",maybeRestart),f.removeEventListener("mute",onMute),f.removeEventListener("unmute",maybeRestart)}var onVisibilityChange=function(e){return!!e&&maybeRestart()};return T.onVisibilityChange(1,onVisibilityChange),addMediaStreamTrackListeners(),function(){T.offVisibilityChange(1,onVisibilityChange),removeMediaStreamTrackListeners()}}e.exports=function mixinLocalMediaTrack(e){return function(e){function LocalMediaTrack(t,n){var a=this,l=("safari"===h()||m())&&_(t)&&"object"==typeof document&&"function"==typeof document.addEventListener&&"string"==typeof document.visibilityState;n=Object.assign({getUserMedia:f,isCreatedByCreateLocalTracks:!1,workaroundWebKitBug1208516:l,gUMSilentTrackWorkaround:A},n);var p=new M(t),g=p.kind;return a=e.call(this,p,n)||this,Object.defineProperties(a,{_constraints:{value:"object"==typeof n[g]?n[g]:{},writable:!0},_getUserMedia:{value:n.getUserMedia},_gUMSilentTrackWorkaround:{value:n.gUMSilentTrackWorkaround},_workaroundWebKitBug1208516:{value:n.workaroundWebKitBug1208516},_workaroundWebKitBug1208516Cleanup:{value:null,writable:!0},_didCallEnd:{value:!1,writable:!0},_isCreatedByCreateLocalTracks:{value:n.isCreatedByCreateLocalTracks},_trackSender:{value:p},id:{enumerable:!0,value:p.id},isEnabled:{enumerable:!0,get:function(){return p.enabled}},isStopped:{enumerable:!0,get:function(){return"ended"===p.readyState}}}),a._workaroundWebKitBug1208516&&(a._workaroundWebKitBug1208516Cleanup=restartWhenInadvertentlyStopped(a)),a}return l(LocalMediaTrack,e),LocalMediaTrack.prototype._end=function(){this._didCallEnd||(e.prototype._end.call(this),this._didCallEnd=!0,this.emit("stopped",this))},LocalMediaTrack.prototype._initialize=function(){this._didCallEnd&&(this._didCallEnd=!1),e.prototype._initialize.call(this)},LocalMediaTrack.prototype._reacquireTrack=function(e){var t,n=this,a=n._getUserMedia,l=n._gUMSilentTrackWorkaround,f=n._log,p=n.mediaStreamTrack.kind;f.info("Re-acquiring the MediaStreamTrack"),f.debug("Constraints:",e);var h=Object.assign({audio:!1,video:!1},((t={})[p]=e,t));return(this._workaroundWebKitBug1208516Cleanup?l(f,a,h):a(h)).then((function(e){return e.getTracks()[0]}))},LocalMediaTrack.prototype._restart=function(e){var t=this,n=this._log;return e=e||this._constraints,this._stop(),this._reacquireTrack(e).catch((function(t){throw n.error("Failed to re-acquire the MediaStreamTrack:",{error:t,constraints:e}),t})).then((function(a){return n.info("Re-acquired the MediaStreamTrack"),n.debug("MediaStreamTrack:",a),t._constraints=Object.assign({},e),t._setMediaStreamTrack(a)}))},LocalMediaTrack.prototype._setMediaStreamTrack=function(e){var t=this;return e.enabled=this.mediaStreamTrack.enabled,this._stop(),(this._unprocessedTrack?Promise.resolve().then((function(){t._unprocessedTrack=e})):this._trackSender.setMediaStreamTrack(e).catch((function(n){t._log.warn("setMediaStreamTrack failed:",{error:n,mediaStreamTrack:e})}))).then((function(){t._initialize(),t._getAllAttachedElements().forEach((function(e){return t._attach(e)}))}))},LocalMediaTrack.prototype._stop=function(){return this.mediaStreamTrack.stop(),this._end(),this},LocalMediaTrack.prototype.enable=function(e){return(e="boolean"!=typeof e||e)!==this.mediaStreamTrack.enabled&&(this._log.info((e?"En":"Dis")+"abling"),this.mediaStreamTrack.enabled=e,this.emit(e?"enabled":"disabled",this)),this},LocalMediaTrack.prototype.disable=function(){return this.enable(!1)},LocalMediaTrack.prototype.restart=function(e){var t=this,n=this.kind;if(!this._isCreatedByCreateLocalTracks)return Promise.reject(S("restart","can only be called on a Local"+v(n)+"Track that is created using createLocalTracks or createLocal"+v(n)+"Track."));this._workaroundWebKitBug1208516Cleanup&&(this._workaroundWebKitBug1208516Cleanup(),this._workaroundWebKitBug1208516Cleanup=null);var a=this._restart(e);return this._workaroundWebKitBug1208516&&(a=a.finally((function(){t._workaroundWebKitBug1208516Cleanup=restartWhenInadvertentlyStopped(t)}))),a},LocalMediaTrack.prototype.stop=function(){return this._log.info("Stopping"),this._workaroundWebKitBug1208516Cleanup&&(this._workaroundWebKitBug1208516Cleanup(),this._workaroundWebKitBug1208516Cleanup=null),this._stop()},LocalMediaTrack}(e)}},6345:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(6379),p=n(2097),h=p.typeErrors,m=p.trackPriority,g=function(e){function LocalTrackPublication(t,n,a,l){var f=e.call(this,n.name,t.sid,l)||this;return Object.defineProperties(f,{_reemitTrackEvent:{value:function(){return f.emit(f.isTrackEnabled?"trackEnabled":"trackDisabled")}},_signaling:{value:t},_unpublish:{value:a},isTrackEnabled:{enumerable:!0,get:function(){return"data"===this.track.kind||this.track.isEnabled}},kind:{enumerable:!0,value:n.kind},priority:{enumerable:!0,get:function(){return t.updatedPriority}},track:{enumerable:!0,value:n}}),n.on("disabled",f._reemitTrackEvent),n.on("enabled",f._reemitTrackEvent),f}return l(LocalTrackPublication,e),LocalTrackPublication.prototype.toString=function(){return"[LocalTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},LocalTrackPublication.prototype.setPriority=function(e){var t=Object.values(m);if(!t.includes(e))throw h.INVALID_VALUE("priority",t);return this._signaling.setPriority(e),this},LocalTrackPublication.prototype.unpublish=function(){return this.track.removeListener("disabled",this._reemitTrackEvent),this.track.removeListener("enabled",this._reemitTrackEvent),this._unpublish(this),this},LocalTrackPublication}(f);e.exports=g},566:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(2939),p=f.guessBrowser,h=f.isIOSChrome,m=n(8815),g=n(5820),v=n(8222),y=n(6971).isUserMediaTrack,_=function(e){function LocalVideoTrack(t,n){var a=this;return n=Object.assign({workaroundSilentLocalVideo:("safari"===p()||h())&&y(t)&&"undefined"!=typeof document&&"function"==typeof document.createElement},n),a=e.call(this,t,n)||this,Object.defineProperties(a,{_workaroundSilentLocalVideo:{value:n.workaroundSilentLocalVideo?workaroundSilentLocalVideo:null},_workaroundSilentLocalVideoCleanup:{value:null,writable:!0}}),a._workaroundSilentLocalVideo&&(a._workaroundSilentLocalVideoCleanup=a._workaroundSilentLocalVideo(a,document)),a}return l(LocalVideoTrack,e),LocalVideoTrack.prototype.toString=function(){return"[LocalVideoTrack #"+this._instanceId+": "+this.id+"]"},LocalVideoTrack.prototype._checkIfCanCaptureFrames=function(){return e.prototype._checkIfCanCaptureFrames.call(this,this._trackSender.isPublishing)},LocalVideoTrack.prototype._end=function(){return e.prototype._end.apply(this,arguments)},LocalVideoTrack.prototype._setSenderMediaStreamTrack=function(e){var t=this,n=this.mediaStreamTrack,a=e?this.processedTrack:n;return this._trackSender.setMediaStreamTrack(a).catch((function(e){return t._log.warn("setMediaStreamTrack failed on LocalVideoTrack RTCRtpSender",{error:e,mediaStreamTrack:a})})).then((function(){t._unprocessedTrack=e?n:null}))},LocalVideoTrack.prototype.addProcessor=function(){this._log.debug("Adding VideoProcessor to the LocalVideoTrack");var t=e.prototype.addProcessor.apply(this,arguments);return this.processedTrack?(this._log.debug("Updating LocalVideoTrack's MediaStreamTrack with the processed MediaStreamTrack",this.processedTrack),this._setSenderMediaStreamTrack(!0),t):this._log.warn("Unable to add a VideoProcessor to the LocalVideoTrack")},LocalVideoTrack.prototype.removeProcessor=function(){var t=this;this._log.debug("Removing VideoProcessor from the LocalVideoTrack");var n=e.prototype.removeProcessor.apply(this,arguments);return this._log.debug("Updating LocalVideoTrack's MediaStreamTrack with the original MediaStreamTrack"),this._setSenderMediaStreamTrack().then((function(){return t._updateElementsMediaStreamTrack()})),n},LocalVideoTrack.prototype.disable=function(){var t=e.prototype.disable.apply(this,arguments);return this.processedTrack&&(this.processedTrack.enabled=!1),t},LocalVideoTrack.prototype.enable=function(t){void 0===t&&(t=!0);var n=e.prototype.enable.apply(this,arguments);return this.processedTrack&&(this.processedTrack.enabled=t,t&&(this._captureFrames(),this._log.debug("Updating LocalVideoTrack's MediaStreamTrack with the processed MediaStreamTrack",this.processedTrack),this._setSenderMediaStreamTrack(!0))),n},LocalVideoTrack.prototype.restart=function(){var t=this;this._workaroundSilentLocalVideoCleanup&&(this._workaroundSilentLocalVideoCleanup(),this._workaroundSilentLocalVideoCleanup=null);var n=e.prototype.restart.apply(this,arguments);return this.processor&&n.then((function(){t._restartProcessor()})),this._workaroundSilentLocalVideo&&n.finally((function(){t._workaroundSilentLocalVideoCleanup=t._workaroundSilentLocalVideo(t,document)})),n},LocalVideoTrack.prototype.stop=function(){return this._workaroundSilentLocalVideoCleanup&&(this._workaroundSilentLocalVideoCleanup(),this._workaroundSilentLocalVideoCleanup=null),e.prototype.stop.apply(this,arguments)},LocalVideoTrack}(g(v));function workaroundSilentLocalVideo(e,t){var n=e._log,a=e._dummyEl,l=e.mediaStreamTrack;function onUnmute(){e.isEnabled&&(n.info("Unmuted, checking silence"),a.play().then((function(){return m(a,t)})).then((function(t){if(t)return n.warn("Silence detected, restarting"),e._stop(),e._restart();n.info("Non-silent frames detected, so no need to restart")})).catch((function(e){n.warn("Failed to detect silence and restart:",e)})).finally((function(){(a=e._dummyEl).paused||a.pause(),l.removeEventListener("unmute",onUnmute),(l=e.mediaStreamTrack).addEventListener("unmute",onUnmute)})))}return l.addEventListener("unmute",onUnmute),function(){l.removeEventListener("unmute",onUnmute)}}e.exports=_},3445:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function LocalVideoTrackPublication(t,n,a,l){return e.call(this,t,n,a,l)||this}return l(LocalVideoTrackPublication,e),LocalVideoTrackPublication.prototype.toString=function(){return"[LocalVideoTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},LocalVideoTrackPublication}(n(6345));e.exports=f},9361:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(2939),p=f.guessBrowser,h=f.isIOSChrome,m=n(3819).MediaStream,g=n(6971),v=g.waitForEvent,y=g.waitForSometime,_=n(4919),b=function(e){function MediaTrack(t,n){var a=this;n=Object.assign({playPausedElementsIfNotBackgrounded:("safari"===p()||h())&&"object"==typeof document&&"function"==typeof document.addEventListener&&"string"==typeof document.visibilityState},n),a=e.call(this,t.id,t.kind,n)||this;var l=!1;return n=Object.assign({MediaStream:m},n),Object.defineProperties(a,{_attachments:{value:new Set},_dummyEl:{value:null,writable:!0},_elShims:{value:new WeakMap},_isStarted:{get:function(){return l},set:function(e){l=e}},_playPausedElementsIfNotBackgrounded:{value:n.playPausedElementsIfNotBackgrounded},_shouldShimAttachedElements:{value:n.workaroundWebKitBug212780||n.playPausedElementsIfNotBackgrounded},_unprocessedTrack:{value:null,writable:!0},_MediaStream:{value:n.MediaStream},isStarted:{enumerable:!0,get:function(){return l}},mediaStreamTrack:{enumerable:!0,get:function(){return this._unprocessedTrack||t.track}},processedTrack:{enumerable:!0,value:null,writable:!0}}),a._initialize(),a}return l(MediaTrack,e),MediaTrack.prototype._start=function(){this._log.debug("Started"),this._isStarted=!0,this._dummyEl&&(this._dummyEl.oncanplay=null),this.emit("started",this)},MediaTrack.prototype._initialize=function(){var e=this;this._log.debug("Initializing"),this._dummyEl=this._createElement(),this.mediaStreamTrack.addEventListener("ended",(function onended(){e._end(),e.mediaStreamTrack.removeEventListener("ended",onended)})),this._dummyEl&&(this._dummyEl.muted=!0,this._dummyEl.oncanplay=this._start.bind(this,this._dummyEl),this._attach(this._dummyEl,this.mediaStreamTrack),this._attachments.delete(this._dummyEl))},MediaTrack.prototype._end=function(){this._log.debug("Ended"),this._dummyEl&&(this._dummyEl.remove(),this._dummyEl.srcObject=null,this._dummyEl.oncanplay=null,this._dummyEl=null)},MediaTrack.prototype.attach=function(e){var t=this;if("string"==typeof e?e=this._selectElement(e):e||(e=this._createElement()),this._log.debug("Attempting to attach to element:",e),e=this._attach(e),this._shouldShimAttachedElements&&!this._elShims.has(e)){var n=this._playPausedElementsIfNotBackgrounded?function(){return function playIfPausedAndNotBackgrounded(e,t){var n=e.tagName.toLowerCase();t.warn("Unintentionally paused:",e),Promise.race([v(document,"visibilitychange"),y(1e3)]).then((function(){"visible"===document.visibilityState&&_.whenResolved("audio").then((function(){return t.info("Playing unintentionally paused <"+n+"> element"),t.debug("Element:",e),e.play()})).then((function(){t.info("Successfully played unintentionally paused <"+n+"> element"),t.debug("Element:",e)})).catch((function(a){t.warn("Error while playing unintentionally paused <"+n+"> element:",{error:a,el:e})}))}))}(e,t._log)}:null;this._elShims.set(e,function shimMediaElement(e,t){void 0===t&&(t=null);var n=e.pause,a=e.play,l=!1;e.pause=function(){return l=!0,n.call(e)},e.play=function(){return l=!1,a.call(e)};var f=t?function(){l||t()}:null;f&&e.addEventListener("pause",f);return{pausedIntentionally:function(){return l},unShim:function(){e.pause=n,e.play=a,f&&e.removeEventListener("pause",f)}}}(e,n))}return e},MediaTrack.prototype._attach=function(e,t){void 0===t&&(t=this.processedTrack||this.mediaStreamTrack);var n=e.srcObject;n instanceof this._MediaStream||(n=new this._MediaStream);var a="audio"===t.kind?"getAudioTracks":"getVideoTracks";return n[a]().forEach((function(e){n.removeTrack(e)})),n.addTrack(t),e.srcObject=n,e.autoplay=!0,e.playsInline=!0,this._attachments.has(e)||this._attachments.add(e),e},MediaTrack.prototype._selectElement=function(e){var t=document.querySelector(e);if(!t)throw new Error("Selector matched no element: "+e);return t},MediaTrack.prototype._updateElementsMediaStreamTrack=function(){var e=this;this._log.debug("Reattaching all elements to update mediaStreamTrack"),this._getAllAttachedElements().forEach((function(t){return e._attach(t)}))},MediaTrack.prototype._createElement=function(){return"undefined"!=typeof document?document.createElement(this.kind):null},MediaTrack.prototype.detach=function(e){var t;return t="string"==typeof e?[this._selectElement(e)]:e?[e]:this._getAllAttachedElements(),this._log.debug("Attempting to detach from elements:",t),this._detachElements(t),e?t[0]:t},MediaTrack.prototype._detachElements=function(e){return e.map(this._detachElement.bind(this))},MediaTrack.prototype._detachElement=function(e){if(!this._attachments.has(e))return e;var t=e.srcObject;(t instanceof this._MediaStream&&t.removeTrack(this.processedTrack||this.mediaStreamTrack),this._attachments.delete(e),this._shouldShimAttachedElements&&this._elShims.has(e))&&(this._elShims.get(e).unShim(),this._elShims.delete(e));return e},MediaTrack.prototype._getAllAttachedElements=function(){var e=[];return this._attachments.forEach((function(t){e.push(t)})),e},MediaTrack}(n(4958));e.exports=b},8960:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function MediaTrackReceiver(t,n){return e.call(this,t,n)||this}return l(MediaTrackReceiver,e),MediaTrackReceiver}(n(2854));e.exports=f},1455:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(4592),p=function(e){function RemoteAudioTrack(t,n,a,l,f,p,h){return e.call(this,t,n,a,l,f,p,h)||this}return l(RemoteAudioTrack,e),RemoteAudioTrack.prototype.toString=function(){return"[RemoteAudioTrack #"+this._instanceId+": "+this.sid+"]"},RemoteAudioTrack.prototype.setPriority=function(t){return e.prototype.setPriority.call(this,t)},RemoteAudioTrack}(n(806)(f));e.exports=p},4685:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function RemoteAudioTrackPublication(t,n){return e.call(this,t,n)||this}return l(RemoteAudioTrackPublication,e),RemoteAudioTrackPublication.prototype.toString=function(){return"[RemoteAudioTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},RemoteAudioTrackPublication}(n(4906));e.exports=f},5:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},p=this&&this.__spreadArray||function(e,t){for(var n=0,a=t.length,l=e.length;n<a;n++,l++)e[l]=t[n];return e},h=n(4958),m=n(2097),g=m.typeErrors,v=m.trackPriority,y=function(e){function RemoteDataTrack(t,n,a){var l=e.call(this,n.id,"data",a)||this;return Object.defineProperties(l,{_isSwitchedOff:{value:!1,writable:!0},_priority:{value:null,writable:!0},isEnabled:{enumerable:!0,value:!0},isSwitchedOff:{enumerable:!0,get:function(){return this._isSwitchedOff}},maxPacketLifeTime:{enumerable:!0,value:n.maxPacketLifeTime},maxRetransmits:{enumerable:!0,value:n.maxRetransmits},ordered:{enumerable:!0,value:n.ordered},priority:{enumerable:!0,get:function(){return this._priority}},reliable:{enumerable:!0,value:null===n.maxPacketLifeTime&&null===n.maxRetransmits},sid:{enumerable:!0,value:t}}),n.on("message",(function(e){l.emit("message",e,l)})),l}return l(RemoteDataTrack,e),RemoteDataTrack.prototype.setPriority=function(e){var t=p([null],f(Object.values(v)));if(!t.includes(e))throw g.INVALID_VALUE("priority",t);return this._priority=e,this},RemoteDataTrack.prototype._setEnabled=function(){},RemoteDataTrack.prototype._setSwitchedOff=function(e){this._isSwitchedOff!==e&&(this._isSwitchedOff=e,this.emit(e?"switchedOff":"switchedOn",this))},RemoteDataTrack}(h);e.exports=y},2655:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function RemoteDataTrackPublication(t,n){return e.call(this,t,n)||this}return l(RemoteDataTrackPublication,e),RemoteDataTrackPublication.prototype.toString=function(){return"[RemoteDataTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},RemoteDataTrackPublication}(n(4906));e.exports=f},806:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},p=this&&this.__spreadArray||function(e,t){for(var n=0,a=t.length,l=e.length;n<a;n++,l++)e[l]=t[n];return e},h=n(2097),m=h.typeErrors,g=h.trackPriority,v=n(2939),y=v.guessBrowser,_=v.isIOSChrome,b=n(8379);e.exports=function mixinRemoteMediaTrack(e){return function(e){function RemoteMediaTrack(t,n,a,l,f,p,h){var m=this;return h=Object.assign({workaroundWebKitBug212780:("safari"===y()||_())&&"object"==typeof document&&"function"==typeof document.addEventListener&&"string"==typeof document.visibilityState},h),m=e.call(this,n,h)||this,Object.defineProperties(m,{_isEnabled:{value:a,writable:!0},_isSwitchedOff:{value:l,writable:!0},_priority:{value:null,writable:!0},_setPriority:{value:f},_setRenderHint:{value:function(e){m._log.debug("updating render hint:",e),p(e)}},isEnabled:{enumerable:!0,get:function(){return this._isEnabled}},isSwitchedOff:{enumerable:!0,get:function(){return this._isSwitchedOff}},priority:{enumerable:!0,get:function(){return this._priority}},sid:{enumerable:!0,value:t},_workaroundWebKitBug212780:{value:h.workaroundWebKitBug212780},_workaroundWebKitBug212780Cleanup:{value:null,writable:!0}}),m}return l(RemoteMediaTrack,e),RemoteMediaTrack.prototype.setPriority=function(e){var t=p([null],f(Object.values(g)));if(!t.includes(e))throw m.INVALID_VALUE("priority",t);return this._priority!==e&&(this._priority=e,this._setPriority(e)),this},RemoteMediaTrack.prototype._setEnabled=function(e){this._isEnabled!==e&&(this._isEnabled=e,this.emit(this._isEnabled?"enabled":"disabled",this))},RemoteMediaTrack.prototype._setSwitchedOff=function(e){this._isSwitchedOff!==e&&(this._isSwitchedOff=e,this.emit(e?"switchedOff":"switchedOn",this))},RemoteMediaTrack.prototype.attach=function(t){var n=e.prototype.attach.call(this,t);return!0!==this.mediaStreamTrack.enabled&&(this.mediaStreamTrack.enabled=!0,this.processedTrack&&(this.processedTrack.enabled=!0),this.processor&&this._captureFrames()),this._workaroundWebKitBug212780&&(this._workaroundWebKitBug212780Cleanup=this._workaroundWebKitBug212780Cleanup||function playIfPausedWhileInBackground(e){var t=e._log,n=e.kind;function onVisibilityChanged(a){a&&e._attachments.forEach((function(a){var l=e._elShims.get(a);a.paused&&l&&!l.pausedIntentionally()&&(t.info("Playing inadvertently paused <"+n+"> element"),t.debug("Element:",a),t.debug("RemoteMediaTrack:",e),a.play().then((function(){t.info("Successfully played inadvertently paused <"+n+"> element"),t.debug("Element:",a),t.debug("RemoteMediaTrack:",e)})).catch((function(l){t.warn("Error while playing inadvertently paused <"+n+"> element:",{err:l,el:a,remoteMediaTrack:e})})))}))}return b.onVisibilityChange(2,onVisibilityChanged),function(){b.offVisibilityChange(2,onVisibilityChanged)}}(this)),n},RemoteMediaTrack.prototype.detach=function(t){var n=e.prototype.detach.call(this,t);return 0===this._attachments.size&&(this.mediaStreamTrack.enabled=!1,this.processedTrack&&(this.processedTrack.enabled=!1),this._workaroundWebKitBug212780Cleanup&&(this._workaroundWebKitBug212780Cleanup(),this._workaroundWebKitBug212780Cleanup=null)),n},RemoteMediaTrack}(e)}},4906:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function RemoteTrackPublication(t,n){var a=e.call(this,t.name,t.sid,n)||this;Object.defineProperties(a,{_signaling:{value:t},_track:{value:null,writable:!0},isSubscribed:{enumerable:!0,get:function(){return!!this._track}},isTrackEnabled:{enumerable:!0,get:function(){return t.isEnabled}},kind:{enumerable:!0,value:t.kind},publishPriority:{enumerable:!0,get:function(){return t.priority}},track:{enumerable:!0,get:function(){return this._track}}});var l=t.error,f=t.isEnabled,p=t.isSwitchedOff,h=t.priority;return t.on("updated",(function(){if(l!==t.error)return l=t.error,void a.emit("subscriptionFailed",t.error);f!==t.isEnabled&&(f=t.isEnabled,a.track&&a.track._setEnabled(t.isEnabled),a.emit(t.isEnabled?"trackEnabled":"trackDisabled")),p!==t.isSwitchedOff&&(a._log.debug(a.trackSid+": "+(p?"OFF":"ON")+" => "+(t.isSwitchedOff?"OFF":"ON")),p=t.isSwitchedOff,a.track?(a.track._setSwitchedOff(t.isSwitchedOff),a.emit(p?"trackSwitchedOff":"trackSwitchedOn",a.track)):p&&a._log.warn("Track was not subscribed when switched Off.")),h!==t.priority&&(h=t.priority,a.emit("publishPriorityChanged",h))})),a}return l(RemoteTrackPublication,e),RemoteTrackPublication.prototype.toString=function(){return"[RemoteTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},RemoteTrackPublication.prototype._subscribed=function(e){!this._track&&e&&(this._track=e,this.emit("subscribed",e))},RemoteTrackPublication.prototype._unsubscribe=function(){if(this._track){var e=this._track;this._track=null,this.emit("unsubscribed",e)}},RemoteTrackPublication}(n(6379));e.exports=f},2099:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},p=n(806),h=n(8222),m=n(8379),g=n(8537).NullObserver,v=n(5317),y=p(h),_=function(e){function RemoteVideoTrack(t,n,a,l,f,p,h){var m=this;return h=Object.assign({clientTrackSwitchOffControl:"auto",contentPreferencesMode:"auto",enableDocumentVisibilityTurnOff:!0},h),h=Object.assign({IntersectionObserver:"undefined"==typeof IntersectionObserver||"auto"!==h.clientTrackSwitchOffControl?g:IntersectionObserver,ResizeObserver:"undefined"==typeof ResizeObserver||"auto"!==h.contentPreferencesMode?g:ResizeObserver},h),m=e.call(this,t,n,a,l,f,p,h)||this,Object.defineProperties(m,{_enableDocumentVisibilityTurnOff:{value:!0===h.enableDocumentVisibilityTurnOff&&"auto"===h.clientTrackSwitchOffControl},_documentVisibilityTurnOffCleanup:{value:null,writable:!0},_clientTrackSwitchOffControl:{value:h.clientTrackSwitchOffControl},_contentPreferencesMode:{value:h.contentPreferencesMode},_invisibleElements:{value:new WeakSet},_elToPipCallbacks:{value:new WeakMap},_elToPipWindows:{value:new WeakMap},_turnOffTimer:{value:new v((function(){m._setRenderHint({enabled:!1})}),50,!1)},_resizeObserver:{value:new h.ResizeObserver((function(e){e.find((function(e){return!m._invisibleElements.has(e.target)}))&&maybeUpdateDimensionHint(m)}))},_intersectionObserver:{value:new h.IntersectionObserver((function(e){var t=!1;e.forEach((function(e){!m._invisibleElements.has(e.target)!==e.isIntersecting&&(e.isIntersecting?(m._log.debug("intersectionObserver detected: Off => On"),m._invisibleElements.delete(e.target)):(m._log.debug("intersectionObserver detected: On => Off"),m._invisibleElements.add(e.target)),t=!0)})),t&&(maybeUpdateEnabledHint(m),maybeUpdateDimensionHint(m))}),{threshold:.25})}}),m}return l(RemoteVideoTrack,e),RemoteVideoTrack.prototype._start=function(t){var n=e.prototype._start.call(this,t);return maybeUpdateEnabledHint(this),n},RemoteVideoTrack.prototype.switchOn=function(){if("manual"!==this._clientTrackSwitchOffControl)throw new Error('Invalid state. You can call switchOn only when bandwidthProfile.video.clientTrackSwitchOffControl is set to "manual"');return this._setRenderHint({enabled:!0}),this},RemoteVideoTrack.prototype.switchOff=function(){if("manual"!==this._clientTrackSwitchOffControl)throw new Error('Invalid state. You can call switchOff only when bandwidthProfile.video.clientTrackSwitchOffControl is set to "manual"');return this._setRenderHint({enabled:!1}),this},RemoteVideoTrack.prototype.setContentPreferences=function(e){if("manual"!==this._contentPreferencesMode)throw new Error('Invalid state. You can call switchOn only when bandwidthProfile.video.contentPreferencesMode is set to "manual"');return e.renderDimensions&&this._setRenderHint({renderDimensions:e.renderDimensions}),this},RemoteVideoTrack.prototype._unObservePip=function(e){var t=this._elToPipCallbacks.get(e);t&&(e.removeEventListener("enterpictureinpicture",t.onEnterPip),e.removeEventListener("leavepictureinpicture",t.onLeavePip),this._elToPipCallbacks.delete(e))},RemoteVideoTrack.prototype._observePip=function(e){var t=this;if(!this._elToPipCallbacks.get(e)){var onEnterPip=function(n){return t._onEnterPip(n,e)},onLeavePip=function(n){return t._onLeavePip(n,e)};e.addEventListener("enterpictureinpicture",onEnterPip),e.addEventListener("leavepictureinpicture",onLeavePip),this._elToPipCallbacks.set(e,{onEnterPip:onEnterPip,onLeavePip:onLeavePip,onResizePip:function(n){return t._onResizePip(n,e)}})}},RemoteVideoTrack.prototype._onEnterPip=function(e,t){this._log.debug("onEnterPip");var n=e.pictureInPictureWindow;this._elToPipWindows.set(t,n);var a=this._elToPipCallbacks.get(t).onResizePip;n.addEventListener("resize",a),maybeUpdateEnabledHint(this)},RemoteVideoTrack.prototype._onLeavePip=function(e,t){this._log.debug("onLeavePip"),this._elToPipWindows.delete(t);var n=this._elToPipCallbacks.get(t).onResizePip;e.pictureInPictureWindow.removeEventListener("resize",n),maybeUpdateEnabledHint(this)},RemoteVideoTrack.prototype._onResizePip=function(){maybeUpdateDimensionHint(this)},RemoteVideoTrack.prototype.attach=function(t){var n=e.prototype.attach.call(this,t);return"auto"===this._clientTrackSwitchOffControl&&this._invisibleElements.add(n),this._intersectionObserver.observe(n),this._resizeObserver.observe(n),this._enableDocumentVisibilityTurnOff&&(this._documentVisibilityTurnOffCleanup=this._documentVisibilityTurnOffCleanup||function setupDocumentVisibilityTurnOff(e){function onVisibilityChanged(){maybeUpdateEnabledHint(e)}return m.onVisibilityChange(1,onVisibilityChanged),function(){m.offVisibilityChange(1,onVisibilityChanged)}}(this)),this._observePip(n),n},RemoteVideoTrack.prototype.detach=function(t){var n=this,a=e.prototype.detach.call(this,t);return(Array.isArray(a)?a:[a]).forEach((function(e){n._intersectionObserver.unobserve(e),n._resizeObserver.unobserve(e),n._invisibleElements.delete(e),n._unObservePip(e)})),0===this._attachments.size&&this._documentVisibilityTurnOffCleanup&&(this._documentVisibilityTurnOffCleanup(),this._documentVisibilityTurnOffCleanup=null),maybeUpdateEnabledHint(this),maybeUpdateDimensionHint(this),a},RemoteVideoTrack.prototype.addProcessor=function(){return e.prototype.addProcessor.apply(this,arguments)},RemoteVideoTrack.prototype.removeProcessor=function(){return e.prototype.removeProcessor.apply(this,arguments)},RemoteVideoTrack.prototype.toString=function(){return"[RemoteVideoTrack #"+this._instanceId+": "+this.sid+"]"},RemoteVideoTrack.prototype.setPriority=function(t){return e.prototype.setPriority.call(this,t)},RemoteVideoTrack}(y);function maybeUpdateEnabledHint(e){if("auto"===e._clientTrackSwitchOffControl){var t=e._getAllAttachedElements().filter((function(t){return!e._invisibleElements.has(t)}));!0===(e._getAllAttachedElements().filter((function(t){return e._elToPipWindows.has(t)})).length>0||"visible"===document.visibilityState&&t.length>0)?(e._turnOffTimer.clear(),e._setRenderHint({enabled:!0})):e._turnOffTimer.isSet||e._turnOffTimer.start()}}function maybeUpdateDimensionHint(e){if("auto"===e._contentPreferencesMode){var t=e._getAllAttachedElements().filter((function(t){return!e._invisibleElements.has(t)})),n=e._getAllAttachedElements().map((function(t){var n=e._elToPipWindows.get(t);return n?{clientHeight:n.height,clientWidth:n.width}:{clientHeight:0,clientWidth:0}})),a=t.concat(n);if(a.length>0){var l=f(a.sort((function(e,t){return t.clientHeight+t.clientWidth-e.clientHeight-e.clientWidth-1})),1)[0],p={height:l.clientHeight,width:l.clientWidth};e._setRenderHint({renderDimensions:p})}}}e.exports=_},6329:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function RemoteVideoTrackPublication(t,n){return e.call(this,t,n)||this}return l(RemoteVideoTrackPublication,e),RemoteVideoTrackPublication.prototype.toString=function(){return"[RemoteVideoTrackPublication #"+this._instanceId+": "+this.trackSid+"]"},RemoteVideoTrackPublication}(n(4906));e.exports=f},2259:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function MediaTrackSender(t){var n=e.call(this,t.id,t)||this;return Object.defineProperties(n,{_clones:{value:new Set},_senders:{value:new Set},isPublishing:{get:function(){return!!this._clones.size}}}),n}return l(MediaTrackSender,e),MediaTrackSender.prototype.clone=function(){var e=new MediaTrackSender(this.track.clone());return this._clones.add(e),e},MediaTrackSender.prototype.removeClone=function(e){this._clones.delete(e)},MediaTrackSender.prototype.setMediaStreamTrack=function(e){var t=this,n=Array.from(this._clones),a=Array.from(this._senders);return Promise.all(n.map((function(t){return t.setMediaStreamTrack(e.clone())})).concat(a.map((function(t){return t.replaceTrack(e)})))).finally((function(){t._track=e}))},MediaTrackSender.prototype.addSender=function(e){return this._senders.add(e),this},MediaTrackSender.prototype.removeSender=function(e){return this._senders.delete(e),this},MediaTrackSender}(n(2854));e.exports=f},6379:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(3029),p=n(6971),h=p.buildLogLevels,m=p.valueToJSON,g=n(2097).DEFAULT_LOG_LEVEL,v=n(6372),y=0,_=function(e){function TrackPublication(t,n,a){var l=e.call(this)||this;a=Object.assign({logLevel:g},a);var f=h(a.logLevel);return Object.defineProperties(l,{_instanceId:{value:y++},_log:{value:a.log?a.log.createLog("default",l):new v("default",l,f,a.loggerName)},trackName:{enumerable:!0,value:t},trackSid:{enumerable:!0,value:n}}),l}return l(TrackPublication,e),TrackPublication.prototype.toJSON=function(){return m(this)},TrackPublication.prototype.toString=function(){return"[TrackPublication #"+this._instanceId+": "+this.trackSid+"]"},TrackPublication}(f);e.exports=_},2854:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function MediaTrackTransceiver(t,n){var a=e.call(this,t,n.kind)||this;return Object.defineProperties(a,{_track:{value:n,writable:!0},enabled:{enumerable:!0,get:function(){return this._track.enabled}},readyState:{enumerable:!0,get:function(){return this._track.readyState}},track:{enumerable:!0,get:function(){return this._track}}}),a}return l(MediaTrackTransceiver,e),MediaTrackTransceiver.prototype.stop=function(){this.track.stop(),e.prototype.stop.call(this)},MediaTrackTransceiver}(n(9430));e.exports=f},4028:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(7187).EventEmitter,p=n(2097).DEFAULT_VIDEO_PROCESSOR_STATS_INTERVAL_MS,h=function(e){function VideoProcessorEventObserver(t){var n=e.call(this)||this;return Object.defineProperties(n,{_lastStatsSaveTime:{value:null,writable:!0},_lastStatsPublishTime:{value:null,writable:!0},_log:{value:t},_processorInfo:{value:null,writable:!0},_stats:{value:null,writable:!0}}),n.on("add",(function(e){n._lastStatsSaveTime=Date.now(),n._lastStatsPublishTime=Date.now(),n._processorInfo=e,n._stats=[],n._reemitEvent("add",n._getEventData())})),n.on("remove",(function(){var e=n._getEventData();n._lastStatsSaveTime=null,n._lastStatsPublishTime=null,n._processorInfo=null,n._stats=null,n._reemitEvent("remove",e)})),n.on("start",(function(){n._reemitEvent("start",n._getEventData())})),n.on("stop",(function(e){n._reemitEvent("stop",Object.assign({message:e},n._getEventData()))})),n.on("stats",(function(){return n._maybeEmitStats()})),n}return l(VideoProcessorEventObserver,e),VideoProcessorEventObserver.prototype._getEventData=function(){if(!this._processorInfo)return{};var e=this._processorInfo,t=e.processor,n={captureHeight:e.captureHeight,captureWidth:e.captureWidth,inputFrameRate:e.inputFrameRate,isRemoteVideoTrack:e.isRemoteVideoTrack};return n.name=t._name||"VideoProcessor",["assetsPath","blurFilterRadius","fitType","isSimdEnabled","maskBlurRadius","version"].forEach((function(e){var a=t["_"+e];void 0!==a&&(n[e]=a)})),Object.keys(n).forEach((function(e){var t=n[e];"boolean"==typeof t&&(n[e]=t?"true":"false")})),n},VideoProcessorEventObserver.prototype._maybeEmitStats=function(){if(this._stats&&this._processorInfo){var e=this._processorInfo.processor._benchmark;if(e){var t=Date.now();if(!(t-this._lastStatsSaveTime<1e3)){var n={outputFrameRate:e.getRate("totalProcessingDelay")};if(["captureFrameDelay","imageCompositionDelay","inputImageResizeDelay","processFrameDelay","segmentationDelay"].forEach((function(t){n[t]=e.getAverageDelay(t)})),this._lastStatsSaveTime=t,this._stats.push(n),!(t-this._lastStatsPublishTime<p)){this._lastStatsPublishTime=t;var a=this._stats.splice(0).reduce((function(e,t,a){return Object.keys(n).forEach((function(n){e[n]||(e[n]=0),e[n]=(e[n]*a+t[n])/(a+1)})),e}),{});Object.keys(a).forEach((function(e){a[e]=parseFloat(a[e].toFixed(2))})),this._reemitEvent("stats",Object.assign({},a,this._getEventData()))}}}}},VideoProcessorEventObserver.prototype._reemitEvent=function(e,t){this._log.debug("VideoProcessor:"+e,t),this.emit("event",{name:e,data:t})},VideoProcessorEventObserver}(f);e.exports=h},8222:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(9361),p=n(4028),h=n(2097).DEFAULT_FRAME_RATE,m=function(e){function VideoTrack(t,n){var a=e.call(this,t,n)||this;return Object.defineProperties(a,{_captureTimeoutId:{value:null,writable:!0},_isCapturing:{value:!1,writable:!0},_inputFrame:{value:null,writable:!0},_outputFrame:{value:null,writable:!0},_processorEventObserver:{value:null,writable:!0},_unmuteHandler:{value:null,writable:!0},dimensions:{enumerable:!0,value:{width:null,height:null}},processor:{enumerable:!0,value:null,writable:!0}}),a._processorEventObserver=new(n.VideoProcessorEventObserver||p)(a._log),a}return l(VideoTrack,e),VideoTrack.prototype._checkIfCanCaptureFrames=function(e){void 0===e&&(e=!1);var t=!0,n="",a=this.mediaStreamTrack;return a.enabled||(t=!1,n="MediaStreamTrack is disabled"),"ended"===a.readyState&&(t=!1,n="MediaStreamTrack is ended"),this.processor||(t=!1,n="VideoProcessor not detected."),this._attachments.size||e||(t=!1,n="VideoTrack is not publishing and there is no attached element."),n&&this._log.debug(n),{canCaptureFrames:t,message:n}},VideoTrack.prototype._captureFrames=function(){var e=this;if(this._isCapturing)this._log.debug("Ignoring captureFrames call. Capture is already in progress");else{if(!this._checkIfCanCaptureFrames().canCaptureFrames)return this._isCapturing=!1,void this._log.debug("Cannot capture frames. Ignoring captureFrames call.");this._isCapturing=!0,this._processorEventObserver.emit("start"),this._log.debug("Start capturing frames");var t,n=Date.now();this._dummyEl.play().then((function(){var captureFrame=function(n){clearTimeout(e._captureTimeoutId);var a=e.mediaStreamTrack.getSettings().frameRate,l=void 0===a?h:a,f=Math.floor(1e3/l)-t;(f<0||"number"!=typeof t)&&(f=0),e._captureTimeoutId=setTimeout(n,f)},process=function(){var a=e._checkIfCanCaptureFrames();if(!a.canCaptureFrames)return e._isCapturing=!1,e._processorEventObserver.emit("stop",a.message),void e._log.debug("Cannot capture frames. Stopping capturing frames.");n=Date.now();var l=e.mediaStreamTrack.getSettings(),f=l.width,p=void 0===f?0:f,h=l.height,m=void 0===h?0:h;e._inputFrame.width!==p&&(e._inputFrame.width=p,e._inputFrame.height=m,e._outputFrame&&(e._outputFrame.width=p,e._outputFrame.height=m)),e._inputFrame.getContext("2d").drawImage(e._dummyEl,0,0,p,m);var g=null;try{g=e.processor.processFrame(e._inputFrame,e._outputFrame)}catch(v){e._log.debug("Exception detected after calling processFrame.",v)}(g instanceof Promise?g:Promise.resolve(g)).then((function(){e._outputFrame&&(e.processedTrack.requestFrame(),e._processorEventObserver.emit("stats"))})).finally((function(){t=Date.now()-n,captureFrame(process)}))};captureFrame(process)})).catch((function(t){return e._log.error("Video element cannot be played",{error:t,track:e})}))}},VideoTrack.prototype._initialize=function(){var t=this;e.prototype._initialize.call(this),this._dummyEl&&(this._dummyEl.onloadedmetadata=function(){dimensionsChanged(t,t._dummyEl)&&(t.dimensions.width=t._dummyEl.videoWidth,t.dimensions.height=t._dummyEl.videoHeight)},this._dummyEl.onresize=function(){dimensionsChanged(t,t._dummyEl)&&(t.dimensions.width=t._dummyEl.videoWidth,t.dimensions.height=t._dummyEl.videoHeight,t.isStarted&&(t._log.debug("Dimensions changed:",t.dimensions),t.emit(VideoTrack.DIMENSIONS_CHANGED,t)))})},VideoTrack.prototype._restartProcessor=function(){var e=this.processor;e&&(this.removeProcessor(e),this.addProcessor(e))},VideoTrack.prototype._start=function(t){return this.dimensions.width=t.videoWidth,this.dimensions.height=t.videoHeight,this._log.debug("Dimensions:",this.dimensions),e.prototype._start.call(this,t)},VideoTrack.prototype.addProcessor=function(e){var t=this;if("function"!=typeof OffscreenCanvas)return this._log.warn("Adding a VideoProcessor is not supported in this browser.");if(!e||"function"!=typeof e.processFrame)throw new Error("Received an invalid VideoProcessor from addProcessor.");if(this.processor)throw new Error("A VideoProcessor has already been added.");if(!this._dummyEl)throw new Error("VideoTrack has not been initialized.");this._log.debug("Adding VideoProcessor to the VideoTrack",e),this._unmuteHandler||(this._unmuteHandler=function(){t._log.debug("mediaStreamTrack unmuted"),t.processedTrack.muted&&(t._log.debug("mediaStreamTrack is unmuted but processedTrack is muted. Restarting processor."),t._restartProcessor())},this.mediaStreamTrack.addEventListener("unmute",this._unmuteHandler));var n=this.mediaStreamTrack.getSettings(),a=n.width,l=void 0===a?0:a,f=n.height,p=void 0===f?0:f,m=n.frameRate,g=void 0===m?h:m;return this._inputFrame=new OffscreenCanvas(l,p),this._outputFrame=document.createElement("canvas"),this._outputFrame.width=l,this._outputFrame.height=p,this.processedTrack=this._outputFrame.captureStream(0).getTracks()[0],this.processedTrack.enabled=this.mediaStreamTrack.enabled,this.processor=e,this._processorEventObserver.emit("add",{processor:e,captureHeight:p,captureWidth:l,inputFrameRate:g,isRemoteVideoTrack:this.toString().includes("RemoteVideoTrack")}),this._updateElementsMediaStreamTrack(),this._captureFrames(),this},VideoTrack.prototype.attach=function(){var t=e.prototype.attach.apply(this,arguments);return this.processor&&this._captureFrames(),t},VideoTrack.prototype.detach=function(){return e.prototype.detach.apply(this,arguments)},VideoTrack.prototype.removeProcessor=function(e){if(!e)throw new Error("Received an invalid VideoProcessor from removeProcessor.");if(!this.processor)throw new Error("No existing VideoProcessor detected.");if(e!==this.processor)throw new Error("The provided VideoProcessor is different than the existing one.");return this._processorEventObserver.emit("remove"),this._log.debug("Removing VideoProcessor from the VideoTrack",e),clearTimeout(this._captureTimeoutId),this.mediaStreamTrack.removeEventListener("unmute",this._unmuteHandler),this._unmuteHandler=null,this._isCapturing=!1,this.processor=null,this.processedTrack=null,this._inputFrame.getContext("2d").clearRect(0,0,this._inputFrame.width,this._inputFrame.height),this._outputFrame.getContext("2d").clearRect(0,0,this._outputFrame.width,this._outputFrame.height),this._inputFrame=null,this._outputFrame=null,this._updateElementsMediaStreamTrack(),this},VideoTrack}(f);function dimensionsChanged(e,t){return e.dimensions.width!==t.videoWidth||e.dimensions.height!==t.videoHeight}m.DIMENSIONS_CHANGED="dimensionsChanged",e.exports=m},7453:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},p=n(7187).EventEmitter,h=n(2097),m=h.DEFAULT_NQ_LEVEL_LOCAL,g=h.DEFAULT_NQ_LEVEL_REMOTE,v=h.MAX_NQ_LEVEL,y=n(6971).inRange,_=function(e){function NetworkQualityConfigurationImpl(t){var n=e.call(this)||this;return t=Object.assign({local:m,remote:g},t),Object.defineProperties(n,{local:{value:y(t.local,m,v)?t.local:m,writable:!0},remote:{value:y(t.remote,g,v)?t.remote:g,writable:!0}}),n}return l(NetworkQualityConfigurationImpl,e),NetworkQualityConfigurationImpl.prototype.update=function(e){var t=this;e=Object.assign({local:this.local,remote:this.remote},e),[["local",m,3],["remote",g,3]].forEach((function(n){var a=f(n,3),l=a[0],p=a[1],h=a[2];t[l]="number"==typeof e[l]&&y(e[l],p,h)?e[l]:p}))},NetworkQualityConfigurationImpl}(p);e.exports=_},8948:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},p=this&&this.__spreadArray||function(e,t){for(var n=0,a=t.length,l=e.length;n<a;n++,l++)e[l]=t[n];return e},h=n(3029),m=n(1455),g=n(4685),v=n(5),y=n(2655),_=n(2099),b=n(6329),C=n(6971),S=0,k=function(e){function Participant(t,n){var a=e.call(this)||this,l=function indexTracksById(e){var t=e.map((function(e){return[e.id,e]})),n=t.filter((function(e){return"audio"===e[1].kind})),a=t.filter((function(e){return"video"===e[1].kind})),l=t.filter((function(e){return"data"===e[1].kind}));return{audioTracks:n,dataTracks:l,tracks:t,videoTracks:a}}((n=Object.assign({RemoteAudioTrack:m,RemoteAudioTrackPublication:g,RemoteDataTrack:v,RemoteDataTrackPublication:y,RemoteVideoTrack:_,RemoteVideoTrackPublication:b,tracks:[]},n)).tracks),f=n.log.createLog("default",a),p=new Map(l.audioTracks),h=new Map(l.dataTracks),C=new Map(l.tracks),k=new Map(l.videoTracks);return Object.defineProperties(a,{_RemoteAudioTrack:{value:n.RemoteAudioTrack},_RemoteAudioTrackPublication:{value:n.RemoteAudioTrackPublication},_RemoteDataTrack:{value:n.RemoteDataTrack},_RemoteDataTrackPublication:{value:n.RemoteDataTrackPublication},_RemoteVideoTrack:{value:n.RemoteVideoTrack},_RemoteVideoTrackPublication:{value:n.RemoteVideoTrackPublication},_audioTracks:{value:p},_dataTracks:{value:h},_instanceId:{value:++S},_clientTrackSwitchOffControl:{value:n.clientTrackSwitchOffControl},_contentPreferencesMode:{value:n.contentPreferencesMode},_log:{value:f},_signaling:{value:t},_tracks:{value:C},_trackEventReemitters:{value:new Map},_trackPublicationEventReemitters:{value:new Map},_trackSignalingUpdatedEventCallbacks:{value:new Map},_videoTracks:{value:k},audioTracks:{enumerable:!0,value:new Map},dataTracks:{enumerable:!0,value:new Map},identity:{enumerable:!0,get:function(){return t.identity}},networkQualityLevel:{enumerable:!0,get:function(){return t.networkQualityLevel}},networkQualityStats:{enumerable:!0,get:function(){return t.networkQualityStats}},sid:{enumerable:!0,get:function(){return t.sid}},state:{enumerable:!0,get:function(){return t.state}},tracks:{enumerable:!0,value:new Map},videoTracks:{enumerable:!0,value:new Map}}),a._tracks.forEach(reemitTrackEvents.bind(null,a)),t.on("networkQualityLevelChanged",(function(){return a.emit("networkQualityLevelChanged",a.networkQualityLevel,a.networkQualityStats&&(a.networkQualityStats.audio||a.networkQualityStats.video)?a.networkQualityStats:null)})),function reemitSignalingStateChangedEvents(e,t){var n=e._log;if("disconnected"===e.state)return;t.on("stateChanged",(function stateChanged(a){n.debug("Transitioned to state:",a),e.emit(a,e),"disconnected"===a&&(n.debug("Removing Track event reemitters"),t.removeListener("stateChanged",stateChanged),e._tracks.forEach((function(t){var n=e._trackEventReemitters.get(t.id);t&&n&&n.forEach((function(e,n){t.removeListener(n,e)}))})),t.tracks.forEach((function(t){var n=e._tracks.get(t.id),a=e._trackEventReemitters.get(t.id);n&&a&&a.forEach((function(e,t){n.removeListener(t,e)}))})),e._trackEventReemitters.clear(),e.tracks.forEach((function(t){e._trackPublicationEventReemitters.get(t.trackSid).forEach((function(e,n){t.removeListener(n,e)}))})),e._trackPublicationEventReemitters.clear())}))}(a,t),f.info("Created a new Participant"+(a.identity?": "+a.identity:"")),a}return l(Participant,e),Participant.prototype._getTrackEvents=function(){return[["dimensionsChanged","trackDimensionsChanged"],["message","trackMessage"],["started","trackStarted"]]},Participant.prototype._getTrackPublicationEvents=function(){return[]},Participant.prototype.toString=function(){return"[Participant #"+this._instanceId+": "+this.sid+"]"},Participant.prototype._addTrack=function(e,t){var n=this._log;return this._tracks.has(t)?null:(this._tracks.set(t,e),{audio:this._audioTracks,video:this._videoTracks,data:this._dataTracks}[e.kind].set(t,e),reemitTrackEvents(this,e,t),n.info("Added a new "+C.trackClass(e)+":",t),n.debug(C.trackClass(e)+":",e),e)},Participant.prototype._addTrackPublication=function(e){var t=this._log;return this.tracks.has(e.trackSid)?null:(this.tracks.set(e.trackSid,e),{audio:this.audioTracks,data:this.dataTracks,video:this.videoTracks}[e.kind].set(e.trackSid,e),function reemitTrackPublicationEvents(e,t){var n=new Map;if("disconnected"===e.state)return;e._getTrackPublicationEvents().forEach((function(a){var l=f(a,2),h=l[0],m=l[1];n.set(h,(function(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];e.emit.apply(e,p(p([m],f(n)),[t]))})),t.on(h,n.get(h))})),e._trackPublicationEventReemitters.set(t.trackSid,n)}(this,e),t.info("Added a new "+C.trackPublicationClass(e)+":",e.trackSid),t.debug(C.trackPublicationClass(e)+":",e),e)},Participant.prototype._handleTrackSignalingEvents=function(){var e=this,t=e._log,n=e._clientTrackSwitchOffControl,a=e._contentPreferencesMode,l=this;if("disconnected"!==this.state){var p=this._RemoteAudioTrack,h=this._RemoteAudioTrackPublication,m=this._RemoteVideoTrack,g=this._RemoteVideoTrackPublication,v=this._RemoteDataTrack,y=this._RemoteDataTrackPublication,_=this._signaling;_.on("trackAdded",trackSignalingAdded),_.on("trackRemoved",trackSignalingRemoved),_.tracks.forEach(trackSignalingAdded),_.on("stateChanged",(function stateChanged(e){"disconnected"===e?(t.debug("Removing event listeners"),_.removeListener("stateChanged",stateChanged),_.removeListener("trackAdded",trackSignalingAdded),_.removeListener("trackRemoved",trackSignalingRemoved)):"connected"===e&&(t.info("reconnected"),setTimeout((function(){return l.emit("reconnected")}),0))}))}function trackSignalingAdded(e){var n=new(0,{audio:h,data:y,video:g}[e.kind])(e,{log:t});l._addTrackPublication(n);var a=e.isSubscribed;a&&trackSignalingSubscribed(e),l._trackSignalingUpdatedEventCallbacks.set(e.sid,(function(){if(a!==e.isSubscribed){if(a=e.isSubscribed)return void trackSignalingSubscribed(e);!function trackSignalingUnsubscribed(e){var t=f(Array.from(l._tracks.entries()).find((function(t){return f(t,2)[1].sid===e.sid})),2),n=t[0],a=t[1],p=l.tracks.get(e.sid);a&&l._removeTrack(a,p,n)}(e)}})),e.on("updated",l._trackSignalingUpdatedEventCallbacks.get(e.sid))}function trackSignalingRemoved(e){e.isSubscribed&&e.setTrackTransceiver(null);var t=l._trackSignalingUpdatedEventCallbacks.get(e.sid);t&&(e.removeListener("updated",t),l._trackSignalingUpdatedEventCallbacks.delete(e.sid));var n=l.tracks.get(e.sid);n&&l._removeTrackPublication(n)}function trackSignalingSubscribed(e){var f=e.isEnabled,h=e.name,g=e.kind,y=e.sid,b=e.trackTransceiver,C=e.isSwitchedOff,S={audio:p,video:m,data:v}[g],k=l.tracks.get(y);if(S&&g===b.kind){var w={log:t,name:h,clientTrackSwitchOffControl:n,contentPreferencesMode:a},T="data"===g?new S(y,b,w):new S(y,b,f,C,(function(e){return _.updateSubscriberTrackPriority(y,e)}),(function(t){e.isSubscribed&&_.updateTrackRenderHint(y,t)}),w);l._addTrack(T,k,b.id)}}},Participant.prototype._removeTrack=function(e,t){if(!this._tracks.has(t))return null;this._tracks.delete(t),{audio:this._audioTracks,video:this._videoTracks,data:this._dataTracks}[e.kind].delete(t),(this._trackEventReemitters.get(t)||new Map).forEach((function(t,n){e.removeListener(n,t)}));var n=this._log;return n.info("Removed a "+C.trackClass(e)+":",t),n.debug(C.trackClass(e)+":",e),e},Participant.prototype._removeTrackPublication=function(e){if(!(e=this.tracks.get(e.trackSid)))return null;this.tracks.delete(e.trackSid),{audio:this.audioTracks,data:this.dataTracks,video:this.videoTracks}[e.kind].delete(e.trackSid),(this._trackPublicationEventReemitters.get(e.trackSid)||new Map).forEach((function(t,n){e.removeListener(n,t)}));var t=this._log;return t.info("Removed a "+C.trackPublicationClass(e)+":",e.trackSid),t.debug(C.trackPublicationClass(e)+":",e),e},Participant.prototype.toJSON=function(){return C.valueToJSON(this)},Participant}(h);function reemitTrackEvents(e,t,n){var a=new Map;"disconnected"!==e.state&&(e._getTrackEvents().forEach((function(n){var l=n[0],h=n[1];a.set(l,(function(){var t=[h].concat([].slice.call(arguments));return e.emit.apply(e,p([],f(t)))})),t.on(l,a.get(l))})),e._trackEventReemitters.set(n,a))}e.exports=k},9706:function(e,t){"use strict";var n=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(l,f){function fulfilled(e){try{step(a.next(e))}catch(t){f(t)}}function rejected(e){try{step(a.throw(e))}catch(t){f(t)}}function step(e){e.done?l(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((a=a.apply(e,t||[])).next())}))},a=this&&this.__generator||function(e,t){var n,a,l,f,p={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return f={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function verb(f){return function(h){return function step(f){if(n)throw new TypeError("Generator is already executing.");for(;p;)try{if(n=1,a&&(l=2&f[0]?a.return:f[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,f[1])).done)return l;switch(a=0,l&&(f=[2&f[0],l.value]),f[0]){case 0:case 1:l=f;break;case 4:return p.label++,{value:f[1],done:!1};case 5:p.label++,a=f[1],f=[0];continue;case 7:f=p.ops.pop(),p.trys.pop();continue;default:if(!(l=p.trys,(l=l.length>0&&l[l.length-1])||6!==f[0]&&2!==f[0])){p=0;continue}if(3===f[0]&&(!l||f[1]>l[0]&&f[1]<l[3])){p.label=f[1];break}if(6===f[0]&&p.label<l[1]){p.label=l[1],l=f;break}if(l&&p.label<l[2]){p.label=l[2],p.ops.push(f);break}l[2]&&p.ops.pop(),p.trys.pop();continue}f=t.call(e,p)}catch(h){f=[6,h],a=0}finally{n=l=0}if(5&f[0])throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}([f,h])}}},l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p};function getStatValues(e,t,n,a){var l=[];return e.forEach((function(e){0!==a.length&&!a.includes(e.type)||0!==n.length&&!n.includes(e.kind)||"number"!=typeof e[t]||l.push(e[t])})),l}function makeStandardCandidateStats(e){return[{key:"transportId",type:"string"},{key:"candidateType",type:"string"},{key:"port",altKeys:["portNumber"],type:"number"},{key:"address",altKeys:["ip","ipAddress"],type:"string"},{key:"priority",type:"number"},{key:"protocol",altKeys:["transport"],type:"string"},{key:"url",type:"string"},{key:"relayProtocol",type:"string"}].reduce((function(t,n){var a=[n.key];n.altKeys&&(a=a.concat(n.altKeys));var l=a.find((function(t){return t in e}));return l&&typeof e[l]===n.type&&(t[n.key]=e[l]),t}),{})}Object.defineProperty(t,"__esModule",{value:!0}),t.getCombinedConnectionStats=void 0,t.getCombinedConnectionStats=function getCombinedConnectionStats(e){var t=e.publisher,f=e.subscriber;return n(this,void 0,void 0,(function(){var e,n,p,h,m,g,v,y,_,b,C,S,k,w,T;return a(this,(function(a){switch(a.label){case 0:return[4,Promise.all([t,f].map((function(e){return e.getStats()})))];case 1:return e=l.apply(void 0,[a.sent(),2]),n=e[0],p=e[1],h=getStatValues(p,"timestamp",["audio"],["inbound-rtp"]),m=h.length>0?h[0]:0,g=getStatValues(p,"jitter",["audio"],["inbound-rtp"]).reduce((function(e,t){return Math.max(e,t)}),0),v=getStatValues(p,"packetsReceived",["audio","video"],["inbound-rtp"]).reduce((function(e,t){return e+t}),0),y=getStatValues(p,"packetsLost",["audio","video"],["inbound-rtp"]).reduce((function(e,t){return e+t}),0),_=getStatValues(n,"roundTripTime",["audio","video"],["remote-inbound-rtp"]).reduce((function(e,t){return Math.max(e,t)}),0),b=getStatValues(p,"currentRoundTripTime",[],["candidate-pair"]).reduce((function(e,t){return Math.max(e,t)}),0),C=1e3*(b||_),S=getStatValues(n,"bytesSent",[],["candidate-pair"]).reduce((function(e,t){return e+t}),0),k=getStatValues(p,"bytesReceived",[],["candidate-pair"]).reduce((function(e,t){return e+t}),0),w=function extractSelectedActiveCandidatePair(e){var t=null,n=[];e.forEach((function(e){"transport"===e.type&&e.selectedCandidatePairId?t=e.selectedCandidatePairId:"candidate-pair"===e.type&&n.push(e)}));var a=n.find((function(e){return e.selected||t&&e.id===t}));if(!a)return null;var l=a,f=e.get(l.localCandidateId),p=e.get(l.remoteCandidateId);if(!f||!p)return null;return{localCandidate:makeStandardCandidateStats(f),remoteCandidate:makeStandardCandidateStats(p)}}(p),T=[],p.forEach((function(e){"local-candidate"!==e.type&&"remote-candidate"!==e.type||T.push(makeStandardCandidateStats(e))})),[2,{timestamp:m,jitter:g,packets:v,packetsLost:y,roundTripTime:C,bytesSent:S,bytesReceived:k,selectedIceCandidatePairStats:w,iceCandidateStats:T}]}}))}))}},8780:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.getTurnCredentials=void 0;var a=n(4670),l=n(2097).ICE_VERSION,f=n(7187);t.getTurnCredentials=function getTurnCredentials(e,t){return new Promise((function(n,p){var h=new f.EventEmitter,m=new a(t,{networkMonitor:null,eventObserver:h,helloBody:{edge:"roaming",preflight:!0,token:e,type:"ice",version:l}}),g=!1;m.once("close",(function(e){g||(g=!0,p(e))})),m.on("message",(function(e){"iced"===e.type&&(g||(g=!0,n(e.ice_servers),m.close()))}))}))}},2017:function(e,t){"use strict";var n=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},a=this&&this.__spreadArray||function(e,t){for(var n=0,a=t.length,l=e.length;n<a;n++,l++)e[l]=t[n];return e};Object.defineProperty(t,"__esModule",{value:!0}),t.makeStat=void 0,t.makeStat=function makeStat(e){return e&&e.length?{min:Math.min.apply(Math,a([],n(e))),max:Math.max.apply(Math,a([],n(e))),average:e.reduce((function(e,t){return e+t}),0)/e.length}:null}},7745:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.mosToScore=t.calculateMOS=void 0;var n=94.768;t.calculateMOS=function calculateMOS(e,t,a){var l=e+2*t+10,f=0;switch(!0){case l<160:f=n-l/40;break;case l<1e3:f=n-(l-120)/10}if(!0==a<=f/2.5)f=Math.max(f-2.5*a,6.52);else f=0;return 1+.035*f+7e-6*f*(f-60)*(100-f)},t.mosToScore=function mosToScore(e){return e?e>4.2?5:e>4?4:e>3.6?3:e>3?2:1:0}},6200:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=this&&this.__awaiter||function(e,t,n,a){return new(n||(n=Promise))((function(l,f){function fulfilled(e){try{step(a.next(e))}catch(t){f(t)}}function rejected(e){try{step(a.throw(e))}catch(t){f(t)}}function step(e){e.done?l(e.value):function adopt(e){return e instanceof n?e:new n((function(t){t(e)}))}(e.value).then(fulfilled,rejected)}step((a=a.apply(e,t||[])).next())}))},p=this&&this.__generator||function(e,t){var n,a,l,f,p={label:0,sent:function(){if(1&l[0])throw l[1];return l[1]},trys:[],ops:[]};return f={next:verb(0),throw:verb(1),return:verb(2)},"function"==typeof Symbol&&(f[Symbol.iterator]=function(){return this}),f;function verb(f){return function(h){return function step(f){if(n)throw new TypeError("Generator is already executing.");for(;p;)try{if(n=1,a&&(l=2&f[0]?a.return:f[0]?a.throw||((l=a.return)&&l.call(a),0):a.next)&&!(l=l.call(a,f[1])).done)return l;switch(a=0,l&&(f=[2&f[0],l.value]),f[0]){case 0:case 1:l=f;break;case 4:return p.label++,{value:f[1],done:!1};case 5:p.label++,a=f[1],f=[0];continue;case 7:f=p.ops.pop(),p.trys.pop();continue;default:if(!(l=p.trys,(l=l.length>0&&l[l.length-1])||6!==f[0]&&2!==f[0])){p=0;continue}if(3===f[0]&&(!l||f[1]>l[0]&&f[1]<l[3])){p.label=f[1];break}if(6===f[0]&&p.label<l[1]){p.label=l[1],l=f;break}if(l&&p.label<l[2]){p.label=l[2],p.ops.push(f);break}l[2]&&p.ops.pop(),p.trys.pop();continue}f=t.call(e,p)}catch(h){f=[6,h],a=0}finally{n=l=0}if(5&f[0])throw f[1];return{value:f[0]?f[1]:void 0,done:!0}}([f,h])}}};Object.defineProperty(t,"__esModule",{value:!0}),t.runPreflight=t.PreflightTest=void 0;var h=n(2097),m=n(8646),g=n(7745),v=n(9706),y=n(8780),_=n(2017),b=n(9977),C=n(4441),S=n(6971),k=n(2097).WS_SERVER,w=n(6372),T=n(3029),P=n(9576),A=n(3451),M=n(9849),x=n(7480),O=x.createSID,R=x.sessionSID,I="mediaAcquired",L="connected",N="mediaSubscribed",D="mediaStarted",B="dtlsConnected",F="peerConnectionConnected",j="iceConnected";function notEmpty(e){return null!=e}var $=0,H=function(e){function PreflightTest(t,n){var a=e.call(this)||this;a._testTiming=new m.Timer,a._dtlsTiming=new m.Timer,a._iceTiming=new m.Timer,a._peerConnectionTiming=new m.Timer,a._mediaTiming=new m.Timer,a._connectTiming=new m.Timer,a._sentBytesMovingAverage=new P,a._packetLossMovingAverage=new P,a._receivedBytesMovingAverage=new P;var l=n,f=l.environment,p=void 0===f?"prod":f,g=l.region,v=void 0===g?"gll":g,y=l.duration,_=void 0===y?1e4:y,b=l.wsServer||k(p,v);return a._log=new w("default",a,h.DEFAULT_LOG_LEVEL,h.DEFAULT_LOGGER_NAME),a._testDuration=_,a._instanceId=$++,a._testTiming.start(),a._runPreflightTest(t,p,b),a}return l(PreflightTest,e),PreflightTest.prototype.toString=function(){return"[Preflight #"+this._instanceId+"]"},PreflightTest.prototype.stop=function(){this._stopped=!0},PreflightTest.prototype._generatePreflightReport=function(e,t){return this._testTiming.stop(),{testTiming:this._testTiming.getTimeMeasurement(),networkTiming:{dtls:this._dtlsTiming.getTimeMeasurement(),ice:this._iceTiming.getTimeMeasurement(),peerConnection:this._peerConnectionTiming.getTimeMeasurement(),connect:this._connectTiming.getTimeMeasurement(),media:this._mediaTiming.getTimeMeasurement()},stats:{jitter:_.makeStat(null==e?void 0:e.jitter),rtt:_.makeStat(null==e?void 0:e.rtt),packetLoss:_.makeStat(null==e?void 0:e.packetLoss)},selectedIceCandidatePairStats:e?e.selectedIceCandidatePairStats:null,iceCandidateStats:e?e.iceCandidateStats:[],error:null==t?void 0:t.toString(),mos:_.makeStat(null==e?void 0:e.mos)}},PreflightTest.prototype._executePreflightStep=function(e,t){return f(this,void 0,void 0,(function(){var n,a,l,f;return p(this,(function(p){switch(p.label){case 0:if(this._log.debug("Executing step: ",e),n=this._testDuration+1e4,this._stopped)throw new Error("stopped");a=Promise.resolve().then(t),l=null,f=new Promise((function(t,a){l=setTimeout((function(){a(new Error("Timed out waiting for : "+e))}),n)})),p.label=1;case 1:return p.trys.push([1,,3,4]),[4,Promise.race([f,a])];case 2:return[2,p.sent()];case 3:return null!==l&&clearTimeout(l),[7];case 4:return[2]}}))}))},PreflightTest.prototype._trackNetworkTimings=function(e){var t=this;e.addEventListener("iceconnectionstatechange",(function(){"checking"===e.iceConnectionState&&t._iceTiming.start(),"connected"===e.iceConnectionState&&(t._iceTiming.stop(),t.emit("progress",j))})),e.addEventListener("connectionstatechange",(function(){"connecting"===e.connectionState&&t._peerConnectionTiming.start(),"connected"===e.connectionState&&(t._peerConnectionTiming.stop(),t.emit("progress",F))}));var n=e.getSenders().map((function(e){return e.transport})).find(notEmpty);if(void 0!==n){var a=n;a.addEventListener("statechange",(function(){"connecting"===a.state&&t._dtlsTiming.start(),"connected"===a.state&&(t._dtlsTiming.stop(),t.emit("progress",B))}))}},PreflightTest.prototype._setupInsights=function(e){var t=e.token,n=e.environment,a=void 0===n?h.DEFAULT_ENVIRONMENT:n,l=e.realm,f=void 0===l?h.DEFAULT_REALM:l,p=new M(t,h.SDK_NAME,h.SDK_VERSION,a,f,{});p.connect("PREFLIGHT_ROOM_SID","PREFLIGHT_PARTICIPANT");var m=new A(p,Date.now(),this._log),g=void 0;return{reportToInsights:function(e){var t,n,a=e.report,l=a.stats.jitter||g,f=a.stats.rtt||g,h=a.stats.packetLoss||g,v=a.mos||g,y=new Map;a.iceCandidateStats.forEach((function(e){if(e.candidateType&&e.protocol){var t=y.get(e.candidateType)||[];t.indexOf(e.protocol)<0&&t.push(e.protocol),y.set(e.candidateType,t)}}));var _=JSON.stringify(Object.fromEntries(y)),b={name:"report",group:"preflight",level:a.error?"error":"info",payload:{sessionSID:R,preflightSID:O("PF"),testTiming:a.testTiming,dtlsTiming:a.networkTiming.dtls,iceTiming:a.networkTiming.ice,peerConnectionTiming:a.networkTiming.peerConnection,connectTiming:a.networkTiming.connect,mediaTiming:a.networkTiming.media,selectedLocalCandidate:null===(t=a.selectedIceCandidatePairStats)||void 0===t?void 0:t.localCandidate,selectedRemoteCandidate:null===(n=a.selectedIceCandidatePairStats)||void 0===n?void 0:n.remoteCandidate,iceCandidateStats:_,jitterStats:l,rttStats:f,packetLossStats:h,mosStats:v,error:a.error}};m.emit("event",b),setTimeout((function(){return p.disconnect()}),2e3)}}},PreflightTest.prototype._runPreflightTest=function(e,t,n){return f(this,void 0,void 0,(function(){var a,l,h,m,g,v,_,S,k,w,T,P=this;return p(this,(function(A){switch(A.label){case 0:a=[],l=[],h=this._setupInsights({token:e,environment:t}).reportToInsights,A.label=1;case 1:return A.trys.push([1,8,9,10]),m=[],[4,this._executePreflightStep("Acquire media",(function(){return[b.syntheticAudio(),C.syntheticVideo({width:640,height:480})]}))];case 2:return a=A.sent(),this.emit("progress",I),this.emit("debug",{localTracks:a}),this._connectTiming.start(),[4,this._executePreflightStep("Get turn credentials",(function(){return y.getTurnCredentials(e,n)}))];case 3:return g=A.sent(),this._connectTiming.stop(),this.emit("progress",L),v=new RTCPeerConnection({iceServers:g,iceTransportPolicy:"relay",bundlePolicy:"max-bundle"}),_=new RTCPeerConnection({iceServers:g,bundlePolicy:"max-bundle"}),l.push(v),l.push(_),this._mediaTiming.start(),[4,this._executePreflightStep("Setup Peer Connections",(function(){return f(P,void 0,void 0,(function(){var e,t,n,l,f;return p(this,(function(p){switch(p.label){case 0:return v.addEventListener("icecandidate",(function(e){return e.candidate&&_.addIceCandidate(e.candidate)})),_.addEventListener("icecandidate",(function(e){return e.candidate&&v.addIceCandidate(e.candidate)})),a.forEach((function(e){return v.addTrack(e)})),e=new Promise((function(e){var t=[];_.addEventListener("track",(function(n){t.push(n.track),t.length===a.length&&e(t)}))})),[4,v.createOffer()];case 1:return t=p.sent(),n=t,[4,v.setLocalDescription(n)];case 2:return p.sent(),[4,_.setRemoteDescription(n)];case 3:return p.sent(),[4,_.createAnswer()];case 4:return l=p.sent(),f=l,[4,_.setLocalDescription(f)];case 5:return p.sent(),[4,v.setRemoteDescription(f)];case 6:return p.sent(),this._trackNetworkTimings(v),[2,e]}}))}))}))];case 4:return S=A.sent(),this.emit("debug",{remoteTracks:S}),S.forEach((function(e){e.addEventListener("ended",(function(){return P._log.warn(e.kind+":ended")})),e.addEventListener("mute",(function(){return P._log.warn(e.kind+":muted")})),e.addEventListener("unmute",(function(){return P._log.warn(e.kind+":unmuted")}))})),this.emit("progress",N),[4,this._executePreflightStep("wait for tracks to start",(function(){return new Promise((function(e){var t=document.createElement("video");t.autoplay=!0,t.playsInline=!0,t.muted=!0,t.srcObject=new MediaStream(S),m.push(t),P.emit("debugElement",t),t.oncanplay=e}))}))];case 5:return A.sent(),this._mediaTiming.stop(),this.emit("progress",D),[4,this._executePreflightStep("collect stats for duration",(function(){return P._collectRTCStatsForDuration(P._testDuration,{mos:[],jitter:[],rtt:[],outgoingBitrate:[],incomingBitrate:[],packetLoss:[],selectedIceCandidatePairStats:null,iceCandidateStats:[]},v,_)}))];case 6:return k=A.sent(),[4,this._executePreflightStep("generate report",(function(){return P._generatePreflightReport(k)}))];case 7:return w=A.sent(),h({report:w}),this.emit("completed",w),[3,10];case 8:return T=A.sent(),h({report:this._generatePreflightReport(void 0,T)}),this.emit("failed",T),[3,10];case 9:return l.forEach((function(e){return e.close()})),a.forEach((function(e){return e.stop()})),[7];case 10:return[2]}}))}))},PreflightTest.prototype._collectRTCStats=function(e,t,n){return f(this,void 0,void 0,(function(){var a,l,f,h,m,y,_,b,C,S,k,w,T,P;return p(this,(function(p){switch(p.label){case 0:return[4,v.getCombinedConnectionStats({publisher:t,subscriber:n})];case 1:return a=p.sent(),l=a.timestamp,f=a.bytesSent,h=a.bytesReceived,m=a.packets,y=a.packetsLost,_=a.roundTripTime,b=a.jitter,C=a.selectedIceCandidatePairStats,S=a.iceCandidateStats,k=e.jitter.length>0,e.jitter.push(b),e.rtt.push(_),this._sentBytesMovingAverage.putSample(f,l),this._receivedBytesMovingAverage.putSample(h,l),this._packetLossMovingAverage.putSample(y,m),k&&(e.outgoingBitrate.push(1e3*this._sentBytesMovingAverage.get()*8),e.incomingBitrate.push(1e3*this._receivedBytesMovingAverage.get()*8),w=this._packetLossMovingAverage.get(),T=Math.min(100,100*w),e.packetLoss.push(T),P=g.calculateMOS(_,b,w),e.mos.push(P)),e.selectedIceCandidatePairStats||(e.selectedIceCandidatePairStats=C),0===e.iceCandidateStats.length&&(e.iceCandidateStats=S),[2]}}))}))},PreflightTest.prototype._collectRTCStatsForDuration=function(e,t,n,a){return f(this,void 0,void 0,(function(){var l,f,h;return p(this,(function(p){switch(p.label){case 0:return l=Date.now(),f=Math.min(1e3,e),[4,S.waitForSometime(f)];case 1:return p.sent(),[4,this._collectRTCStats(t,n,a)];case 2:return p.sent(),(h=e-(Date.now()-l))>0?[4,this._collectRTCStatsForDuration(h,t,n,a)]:[3,4];case 3:t=p.sent(),p.label=4;case 4:return[2,t]}}))}))},PreflightTest}(T);t.PreflightTest=H,t.runPreflight=function runPreflight(e,t){return void 0===t&&(t={}),new H(e,t)}},9977:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.syntheticAudio=void 0,t.syntheticAudio=function syntheticAudio(){var e=n(3585),t={},a=e.getOrCreate(t),l=a.createOscillator(),f=l.connect(a.createMediaStreamDestination());l.start();var p=f.stream.getAudioTracks()[0],h=p.stop;return p.stop=function(){h.call(p),e.release(t)},p}},4441:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.syntheticVideo=void 0,t.syntheticVideo=function syntheticVideo(e){var t=void 0===e?{}:e,n=t.width,a=void 0===n?640:n,l=t.height,f=void 0===l?480:l,p=Object.assign(document.createElement("canvas"),{width:a,height:f}),h=p.getContext("2d");h.fillStyle="green",h.fillRect(0,0,p.width,p.height);var m=!1;requestAnimationFrame((function animate(){if(!m){var e=Math.round(255*Math.random()),t=Math.round(255*Math.random()),n=Math.round(255*Math.random()),l=Math.round(255*Math.random());h.fillStyle="rgba("+e+", "+t+", "+n+", "+l+")",h.fillRect(Math.random()*a,Math.random()*f,50,50),requestAnimationFrame(animate)}}));var g=p.captureStream(30).getTracks()[0],v=g.stop;return g.stop=function(){m=!0,v.call(g)},g}},8646:function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0}),t.Timer=void 0;var n=function(){function Timer(){this._end=void 0,this.start()}return Timer.prototype.start=function(){return this._start=Date.now(),this},Timer.prototype.stop=function(){return this._end=Date.now(),this},Timer.prototype.getTimeMeasurement=function(){return{start:this._start,end:this._end,duration:void 0===this._end?void 0:this._end-this._start}},Timer}();t.Timer=n},3172:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},p=this&&this.__spreadArray||function(e,t){for(var n=0,a=t.length,l=e.length;n<a;n++,l++)e[l]=t[n];return e},h=function(e){function QueueingEventEmitter(){var t=e.call(this)||this;return Object.defineProperties(t,{_queuedEvents:{value:new Map}}),t}return l(QueueingEventEmitter,e),QueueingEventEmitter.prototype.dequeue=function(e){var t=this,n=!0;if(!e)return this._queuedEvents.forEach((function(e,t){n=this.dequeue(t)&&n}),this),n;var a=this._queuedEvents.get(e)||[];return this._queuedEvents.delete(e),a.reduce((function(n,a){return t.emit.apply(t,p([],f([e].concat(a))))&&n}),n)},QueueingEventEmitter.prototype.queue=function(){var e=[].slice.call(arguments);if(this.emit.apply(this,p([],f(e))))return!0;var t=e[0];return this._queuedEvents.has(t)||this._queuedEvents.set(t,[]),this._queuedEvents.get(t).push(e.slice(1)),!1},QueueingEventEmitter}(n(7187).EventEmitter);e.exports=h},8690:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},p=this&&this.__spreadArray||function(e,t){for(var n=0,a=t.length,l=e.length;n<a;n++,l++)e[l]=t[n];return e},h=function(e){function RemoteParticipant(t,n){var a=e.call(this,t,n)||this;return a._handleTrackSignalingEvents(),a.once("disconnected",a._unsubscribeTracks.bind(a)),a}return l(RemoteParticipant,e),RemoteParticipant.prototype.toString=function(){return"[RemoteParticipant #"+this._instanceId+(this.sid?": "+this.sid:"")+"]"},RemoteParticipant.prototype._addTrack=function(t,n,a){return e.prototype._addTrack.call(this,t,a)?(n._subscribed(t),this.emit("trackSubscribed",t,n),t):null},RemoteParticipant.prototype._addTrackPublication=function(t){var n=e.prototype._addTrackPublication.call(this,t);return n?(this.emit("trackPublished",n),n):null},RemoteParticipant.prototype._getTrackPublicationEvents=function(){return p(p([],f(e.prototype._getTrackPublicationEvents.call(this))),[["subscriptionFailed","trackSubscriptionFailed"],["trackDisabled","trackDisabled"],["trackEnabled","trackEnabled"],["publishPriorityChanged","trackPublishPriorityChanged"],["trackSwitchedOff","trackSwitchedOff"],["trackSwitchedOn","trackSwitchedOn"]])},RemoteParticipant.prototype._unsubscribeTracks=function(){var e=this;this.tracks.forEach((function(t){if(t.isSubscribed){var n=t.track;t._unsubscribe(),e.emit("trackUnsubscribed",n,t)}}))},RemoteParticipant.prototype._removeTrack=function(t,n,a){var l=this._tracks.get(a);return l?(e.prototype._removeTrack.call(this,l,a),n._unsubscribe(),this.emit("trackUnsubscribed",l,n),l):null},RemoteParticipant.prototype._removeTrackPublication=function(t){this._signaling.clearTrackHint(t.trackSid);var n=e.prototype._removeTrackPublication.call(this,t);return n?(this.emit("trackUnpublished",n),n):null},RemoteParticipant}(n(8948));e.exports=h},7081:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},p=this&&this.__spreadArray||function(e,t){for(var n=0,a=t.length,l=e.length;n<a;n++,l++)e[l]=t[n];return e},h=n(3029),m=n(8690),g=n(2340),v=n(6971).valueToJSON,y=0,_=function(e){function Room(t,n,a){var l=e.call(this)||this,f=a.log.createLog("default",l),p=new Map;return Object.defineProperties(l,{_log:{value:f},_clientTrackSwitchOffControl:{value:a.clientTrackSwitchOffControl||"disabled"},_contentPreferencesMode:{value:a.contentPreferencesMode||"disabled"},_instanceId:{value:++y},_options:{value:a},_participants:{value:p},_signaling:{value:n},dominantSpeaker:{enumerable:!0,get:function(){return this.participants.get(n.dominantSpeakerSid)||null}},isRecording:{enumerable:!0,get:function(){return n.recording.isEnabled||!1}},localParticipant:{enumerable:!0,value:t},name:{enumerable:!0,value:n.name},participants:{enumerable:!0,value:p},sid:{enumerable:!0,value:n.sid},state:{enumerable:!0,get:function(){return n.state}},mediaRegion:{enumerable:!0,value:n.mediaRegion}}),function handleRecordingEvents(e,t){t.on("updated",(function updated(){var n=t.isEnabled;e._log.info("Recording "+(n?"started":"stopped")),e.emit("recording"+(n?"Started":"Stopped"))}))}(l,n.recording),function handleSignalingEvents(e,t){var n=e._log;n.debug("Creating a new RemoteParticipant for each ParticipantSignaling in the RoomSignaling"),t.participants.forEach(connectParticipant.bind(null,e)),n.debug("Setting up RemoteParticipant creation for all subsequent ParticipantSignalings that connect to the RoomSignaling"),t.on("participantConnected",connectParticipant.bind(null,e)),t.on("dominantSpeakerChanged",(function(){return e.emit("dominantSpeakerChanged",e.dominantSpeaker)})),t.on("stateChanged",(function stateChanged(a,l){switch(n.info("Transitioned to state:",a),a){case"disconnected":e.participants.forEach((function(e){e._unsubscribeTracks()})),e.emit(a,e,l),e.localParticipant.tracks.forEach((function(e){e.unpublish()})),t.removeListener("stateChanged",stateChanged);break;case"reconnecting":setTimeout((function(){return e.emit("reconnecting",l)}),0);break;default:setTimeout((function(){return e.emit("reconnected")}),0)}}))}(l,n),f.info("Created a new Room:",l.name),f.debug("Initial RemoteParticipants:",Array.from(l._participants.values())),l}return l(Room,e),Room.prototype.toString=function(){return"[Room #"+this._instanceId+": "+this.sid+"]"},Room.prototype.disconnect=function(){return this._log.info("Disconnecting"),this._signaling.disconnect(),this},Room.prototype.getStats=function(){var e=this;return this._signaling.getStats().then((function(t){return Array.from(t).map((function(t){var n=f(t,2),a=n[0],l=n[1];return new g(a,Object.assign({},l,{localAudioTrackStats:rewriteLocalTrackIds(e,l.localAudioTrackStats),localVideoTrackStats:rewriteLocalTrackIds(e,l.localVideoTrackStats)}))}))}))},Room.prototype.toJSON=function(){return v(this)},Room}(h);function rewriteLocalTrackIds(e,t){var n=e.localParticipant._signaling;return t.reduce((function(e,t){var a=n.tracks.get(t.trackId),l=n.getSender(a);return l?[Object.assign({},t,{trackId:l.id})].concat(e):e}),[])}function connectParticipant(e,t){var n=e._log,a=e._clientTrackSwitchOffControl,l=e._contentPreferencesMode,h=new m(t,{log:n,clientTrackSwitchOffControl:a,contentPreferencesMode:l});n.info("A new RemoteParticipant connected:",h),e._participants.set(h.sid,h),e.emit("participantConnected",h);var g=[["reconnected","participantReconnected"],["reconnecting","participantReconnecting"],"trackDimensionsChanged","trackDisabled","trackEnabled","trackMessage","trackPublished","trackPublishPriorityChanged","trackStarted","trackSubscribed","trackSubscriptionFailed","trackSwitchedOff","trackSwitchedOn","trackUnpublished","trackUnsubscribed"].map((function(t){var n=f(Array.isArray(t)?t:[t,t],2),a=n[0],l=n[1];function reemit(){var t=[].slice.call(arguments);t.unshift(l),t.push(h),e.emit.apply(e,p([],f(t)))}return h.on(a,reemit),[a,reemit]}));h.once("disconnected",(function participantDisconnected(){var t=e.dominantSpeaker;n.info("RemoteParticipant disconnected:",h),e._participants.delete(h.sid),g.forEach((function(e){h.removeListener(e[0],e[1])})),e.emit("participantDisconnected",h),h===t&&e.emit("dominantSpeakerChanged",e.dominantSpeaker)}))}e.exports=_},5743:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(7207),p=n(3178),h=n(3122),m={closed:["opening"],opening:["closed","open"],open:["closed","closing"],closing:["closed","open"]},g=function(e){function Signaling(){return e.call(this,"closed",m)||this}return l(Signaling,e),Signaling.prototype._close=function(e){return this.transition("closing",e),this.transition("closed",e),Promise.resolve(this)},Signaling.prototype._connect=function(e,t,n,a,l){e.connect("PA00000000000000000000000000000000","test");var f=Promise.resolve(new p(e,"RM00000000000000000000000000000000",l));return f.cancel=function cancel(){},f},Signaling.prototype._open=function(e){return this.transition("opening",e),this.transition("open",e),Promise.resolve(this)},Signaling.prototype.close=function(){var e=this;return this.bracket("close",(function(t){switch(e.state){case"closed":return e;case"open":return e._close(t);default:throw new Error('Unexpected Signaling state "'+e.state+'"')}}))},Signaling.prototype.connect=function(e,t,n,a,l){var f=this;return this.bracket("connect",(function transition(p){switch(f.state){case"closed":return f._open(p).then(transition.bind(null,p));case"open":return f.releaseLockCompletely(p),f._connect(e,t,n,a,l);default:throw new Error('Unexpected Signaling state "'+f.state+'"')}}))},Signaling.prototype.createLocalParticipantSignaling=function(){return new f},Signaling.prototype.open=function(){var e=this;return this.bracket("open",(function(t){switch(e.state){case"closed":return e._open(t);case"open":return e;default:throw new Error('Unexpected Signaling state "'+e.state+'"')}}))},Signaling}(h);e.exports=g},8881:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function LocalParticipantSignaling(){var t=e.call(this)||this;return Object.defineProperties(t,{_publicationsToTrackSenders:{value:new Map},_trackSendersToPublications:{value:new Map}}),t}return l(LocalParticipantSignaling,e),LocalParticipantSignaling.prototype.addTrack=function(t,n,a){var l=this._createLocalTrackPublicationSignaling(t,n,a);return this._trackSendersToPublications.set(t,l),this._publicationsToTrackSenders.set(l,t),e.prototype.addTrack.call(this,l),this},LocalParticipantSignaling.prototype.getPublication=function(e){return this._trackSendersToPublications.get(e)||null},LocalParticipantSignaling.prototype.getSender=function(e){return this._publicationsToTrackSenders.get(e)||null},LocalParticipantSignaling.prototype.removeTrack=function(t){var n=this._trackSendersToPublications.get(t);return n?(this._trackSendersToPublications.delete(t),this._publicationsToTrackSenders.delete(n),e.prototype.removeTrack.call(this,n)&&n.stop(),n):null},LocalParticipantSignaling}(n(7207));e.exports=f},617:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function LocalTrackPublicationSignaling(t,n,a){var l=this,f="data"===(t=t.clone()).kind||t.track.enabled;return(l=e.call(this,n,t.kind,f,a)||this).setTrackTransceiver(t),Object.defineProperties(l,{_updatedPriority:{value:a,writable:!0},id:{enumerable:!0,value:t.id}}),l}return l(LocalTrackPublicationSignaling,e),Object.defineProperty(LocalTrackPublicationSignaling.prototype,"updatedPriority",{get:function(){return this._updatedPriority},enumerable:!1,configurable:!0}),LocalTrackPublicationSignaling.prototype.enable=function(t){return t="boolean"!=typeof t||t,this.trackTransceiver.track.enabled=t,e.prototype.enable.call(this,t)},LocalTrackPublicationSignaling.prototype.publishFailed=function(e){return function setError(e,t){if(null!==e._sid||e._error)return!1;return e._error=t,!0}(this,e)&&this.emit("updated"),this},LocalTrackPublicationSignaling.prototype.setPriority=function(e){return this._updatedPriority!==e&&(this._updatedPriority=e,this.emit("updated")),this},LocalTrackPublicationSignaling.prototype.setSid=function(t){return this._error?this:e.prototype.setSid.call(this,t)},LocalTrackPublicationSignaling.prototype.stop=function(){this.trackTransceiver.stop()},LocalTrackPublicationSignaling}(n(8239));e.exports=f},7207:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(3122),p=n(7837),h={connecting:["connected"],connected:["disconnected","reconnecting"],reconnecting:["connected","disconnected"],disconnected:[]},m=function(e){function ParticipantSignaling(){var t=e.call(this,"connecting",h)||this;return Object.defineProperties(t,{_identity:{writable:!0,value:null},_networkQualityLevel:{value:null,writable:!0},_networkQualityStats:{value:null,writable:!0},_sid:{writable:!0,value:null},identity:{enumerable:!0,get:function(){return this._identity}},sid:{enumerable:!0,get:function(){return this._sid}},tracks:{enumerable:!0,value:new Map}}),t}return l(ParticipantSignaling,e),Object.defineProperty(ParticipantSignaling.prototype,"networkQualityLevel",{get:function(){return this._networkQualityLevel},enumerable:!1,configurable:!0}),Object.defineProperty(ParticipantSignaling.prototype,"networkQualityStats",{get:function(){return this._networkQualityStats},enumerable:!1,configurable:!0}),ParticipantSignaling.prototype.addTrack=function(e){return this.tracks.set(e.id||e.sid,e),this.emit("trackAdded",e),this},ParticipantSignaling.prototype.disconnect=function(){return"disconnected"!==this.state&&(this.preempt("disconnected"),!0)},ParticipantSignaling.prototype.removeTrack=function(e){var t=this.tracks.get(e.id||e.sid);return this.tracks.delete(e.id||e.sid),t&&this.emit("trackRemoved",e),t||null},ParticipantSignaling.prototype.setNetworkQualityLevel=function(e,t){this._networkQualityLevel!==e&&(this._networkQualityLevel=e,this._networkQualityStats=t&&(t.audio||t.video)?new p(t):null,this.emit("networkQualityLevelChanged"))},ParticipantSignaling.prototype.connect=function(e,t){return("connecting"===this.state||"reconnecting"===this.state)&&(this._sid||(this._sid=e),this._identity||(this._identity=t),this.preempt("connected"),!0)},ParticipantSignaling.prototype.reconnecting=function(){return("connecting"===this.state||"connected"===this.state)&&(this.preempt("reconnecting"),!0)},ParticipantSignaling}(f);e.exports=m},631:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function RecordingSignaling(){var t=e.call(this)||this;return Object.defineProperties(t,{_isEnabled:{value:null,writable:!0},isEnabled:{enumerable:!0,get:function(){return this._isEnabled}}}),t}return l(RecordingSignaling,e),RecordingSignaling.prototype.disable=function(){return this.enable(!1)},RecordingSignaling.prototype.enable=function(e){return e="boolean"!=typeof e||e,this.isEnabled!==e&&(this._isEnabled=e,this.emit("updated")),this},RecordingSignaling}(n(7187).EventEmitter);e.exports=f},8090:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function RemoteParticipantSignaling(t,n){var a=e.call(this)||this;return a.connect(t,n),a}return l(RemoteParticipantSignaling,e),RemoteParticipantSignaling}(n(7207));e.exports=f},5055:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function RemoteTrackPublicationSignaling(t,n,a,l,f,p){var h=e.call(this,n,a,l,f)||this;return Object.defineProperties(h,{_isSwitchedOff:{value:p,writable:!0}}),h.setSid(t),h}return l(RemoteTrackPublicationSignaling,e),Object.defineProperty(RemoteTrackPublicationSignaling.prototype,"isSubscribed",{get:function(){return!!this.trackTransceiver},enumerable:!1,configurable:!0}),Object.defineProperty(RemoteTrackPublicationSignaling.prototype,"isSwitchedOff",{get:function(){return this._isSwitchedOff},enumerable:!1,configurable:!0}),RemoteTrackPublicationSignaling.prototype.subscribeFailed=function(e){return this.error||(this._error=e,this.emit("updated")),this},RemoteTrackPublicationSignaling.prototype.setPriority=function(e){return this._priority!==e&&(this._priority=e,this.emit("updated")),this},RemoteTrackPublicationSignaling.prototype.setSwitchedOff=function(e){return this._isSwitchedOff!==e&&(this._isSwitchedOff=e,this.emit("updated")),this},RemoteTrackPublicationSignaling}(n(8239));e.exports=f},3178:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(631),p=n(3122),h=n(5317),m=n(6971).buildLogLevels,g=n(2097).DEFAULT_LOG_LEVEL,v=n(6372),y=n(8144),_=y.MediaConnectionError,b=y.MediaDTLSTransportFailedError,C=y.SignalingConnectionDisconnectedError,S=0,k={connected:["reconnecting","disconnected"],reconnecting:["connected","disconnected"],disconnected:[]},w=function(e){function RoomSignaling(t,n,a,l){var p=this;l=Object.assign({logLevel:g,RecordingSignaling:f,Timeout:h},l);var y=m(l.logLevel);p=e.call(this,"connected",k)||this;var _=l.RecordingSignaling,C=new l.Timeout((function(){p._disconnect(p._reconnectingError)}),l.sessionTimeout,!1);return Object.defineProperties(p,{_instanceId:{value:S++},_log:{value:l.log?l.log.createLog("default",p):new v("default",p,y,l.loggerName)},_mediaConnectionIsReconnecting:{writable:!0,value:!1},_options:{value:l},_reconnectingError:{value:null,writable:!0},_sessionTimeout:{value:C},dominantSpeakerSid:{enumerable:!0,value:null,writable:!0},localParticipant:{enumerable:!0,value:t},name:{enumerable:!0,value:a},participants:{enumerable:!0,value:new Map},recording:{enumerable:!0,value:new _},sid:{enumerable:!0,value:n}}),p.on("connectionStateChanged",(function(){"failed"!==p.connectionState||["disconnected","failed"].includes(p.iceConnectionState)||p._disconnect(new b)})),p.on("iceConnectionStateChanged",(function(){return maybeUpdateState(p)})),p.on("signalingConnectionStateChanged",(function(){return maybeUpdateState(p)})),setTimeout((function(){return maybeUpdateState(p)})),p}return l(RoomSignaling,e),RoomSignaling.prototype._disconnect=function(e){return"disconnected"!==this.state&&(this.preempt("disconnected",null,[e]),!0)},RoomSignaling.prototype.toString=function(){return"[RoomSignaling #"+this._instanceId+": "+(this.localParticipant?this.localParticipant.sid:"null")+"]"},RoomSignaling.prototype.connectParticipant=function(e){var t=this;return"disconnected"!==e.state&&(!this.participants.has(e.sid)&&(this.participants.set(e.sid,e),e.on("stateChanged",(function stateChanged(n){"disconnected"===n&&(e.removeListener("stateChanged",stateChanged),t.participants.delete(e.sid),t.emit("participantDisconnected",e))})),this.emit("participantConnected",e),!0))},RoomSignaling.prototype.disconnect=function(){return this._disconnect()},RoomSignaling.prototype.setDominantSpeaker=function(e){this.dominantSpeakerSid=e,this.emit("dominantSpeakerChanged")},RoomSignaling}(p);function maybeUpdateState(e){var t;"disconnected"!==e.state&&"disconnected"!==e.signalingConnectionState?("reconnecting"===e.signalingConnectionState?t=e.signalingConnectionState:"failed"===e.iceConnectionState?(e._mediaConnectionIsReconnecting=!0,t="reconnecting"):"new"===e.iceConnectionState||"checking"===e.iceConnectionState?t=e._mediaConnectionIsReconnecting?"reconnecting":"connected":(e._mediaConnectionIsReconnecting=!1,e._reconnectingError=null,e._sessionTimeout.clear(),t="connected"),t!==e.state&&("reconnecting"===t?(e._reconnectingError="reconnecting"===e.signalingConnectionState?new C:new _,e._sessionTimeout.start(),e.preempt(t,null,[e._reconnectingError])):e.preempt(t))):e._sessionTimeout.clear()}e.exports=w},8239:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function TrackSignaling(t,n,a,l){var f=e.call(this)||this,p=null;return Object.defineProperties(f,{_error:{value:null,writable:!0},_isEnabled:{value:a,writable:!0},_priority:{value:l,writable:!0},_trackTransceiver:{value:null,writable:!0},_sid:{get:function(){return p},set:function(e){null===p&&(p=e)}},kind:{enumerable:!0,value:n},name:{enumerable:!0,value:t}}),f}return l(TrackSignaling,e),Object.defineProperty(TrackSignaling.prototype,"error",{get:function(){return this._error},enumerable:!1,configurable:!0}),Object.defineProperty(TrackSignaling.prototype,"isEnabled",{get:function(){return this._isEnabled},enumerable:!1,configurable:!0}),Object.defineProperty(TrackSignaling.prototype,"priority",{get:function(){return this._priority},enumerable:!1,configurable:!0}),Object.defineProperty(TrackSignaling.prototype,"sid",{get:function(){return this._sid},enumerable:!1,configurable:!0}),Object.defineProperty(TrackSignaling.prototype,"trackTransceiver",{get:function(){return this._trackTransceiver},enumerable:!1,configurable:!0}),TrackSignaling.prototype.disable=function(){return this.enable(!1)},TrackSignaling.prototype.enable=function(e){return e="boolean"!=typeof e||e,this.isEnabled!==e&&(this._isEnabled=e,this.emit("updated")),this},TrackSignaling.prototype.setTrackTransceiver=function(e){return e=e||null,this.trackTransceiver!==e&&(this._trackTransceiver=e,this.emit("updated")),this},TrackSignaling.prototype.setSid=function(e){return null===this.sid&&(this._sid=e,this.emit("updated")),this},TrackSignaling}(n(7187).EventEmitter);e.exports=f},4904:function(e,t,n){"use strict";var a=n(7422),l=n(6503),f=n(4803),p=n(1722),h=n(8144),m=h.SignalingConnectionDisconnectedError,g=h.SignalingIncomingMessageInvalidError,v=n(6971),y=v.flatMap,_=v.createRoomConnectEventPayload;e.exports=function createCancelableRoomSignalingPromise(e,t,n,h,v,b){var C=(b=Object.assign({PeerConnectionManager:l,RoomV2:f,Transport:p},b)).PeerConnectionManager,S=b.RoomV2,k=b.Transport,w=b.iceServers,T=b.log,P=new C(h,v,b),A=y(n.tracks,(function(e){return[e.trackTransceiver]}));P.setTrackSenders(A);var M,x=new Error("Canceled"),O=new a((function(a,l,f){var p=b.automaticSubscription,h=b.bandwidthProfile,v=b.dominantSpeaker,y=b.environment,C=b.eventObserver,A=b.loggerName,O=b.logLevel,R=b.name,I=b.networkMonitor,L=b.networkQuality,N=b.realm,D=b.sdpSemantics,B=!!h,F=!!h,j=!!h&&("disabled"!==b.clientTrackSwitchOffControl||"disabled"!==b.contentPreferencesMode),$=Object.assign({automaticSubscription:p,dominantSpeaker:v,environment:y,eventObserver:C,loggerName:A,logLevel:O,networkMonitor:I,networkQuality:L,iceServers:w,onIced:function(e){return f()?(l(x),Promise.reject(x)):(T.debug("Got ICE servers:",e),b.iceServers=e,P.setConfiguration(b),P.createAndOffer().then((function(){if(f())throw l(x),x;T.debug("createAndOffer() succeeded."),P.dequeue("description")})).catch((function(e){throw T.error("createAndOffer() failed:",e),l(e),e})))},realm:N,renderHints:j,sdpSemantics:D,trackPriority:B,trackSwitchOff:F},h?{bandwidthProfile:h}:{});M=new k(R,e,n,P,t,$);var H=_(b);C.emit("event",H),M.once("connected",(function(e){if(T.debug("Transport connected:",e),f())l(x);else if(e.participant){var t=e.options.signaling_region;n.setSignalingRegion(t),a(new S(n,e,M,P,b))}else l(new g)})),M.once("stateChanged",(function(e,t){"disconnected"===e?(M=null,l(t||new m)):T.debug("Transport state changed:",e)}))}),(function(){M&&(M.disconnect(),M=null)}));return O.catch((function(){M&&(M.disconnect(),M=null),P.close()})),O}},8869:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function DominantSpeakerSignaling(t,n){var a=e.call(this,t,"active_speaker",n)||this;return Object.defineProperties(a,{_loudestParticipantSid:{value:null,writable:!0}}),a.on("ready",(function(e){e.on("message",(function(e){if("active_speaker"===e.type)a._setLoudestParticipantSid(e.participant)}))})),a}return l(DominantSpeakerSignaling,e),Object.defineProperty(DominantSpeakerSignaling.prototype,"loudestParticipantSid",{get:function(){return this._loudestParticipantSid},enumerable:!1,configurable:!0}),DominantSpeakerSignaling.prototype._setLoudestParticipantSid=function(e){this.loudestParticipantSid!==e&&(this._loudestParticipantSid=e,this.emit("updated"))},DominantSpeakerSignaling}(n(1014));e.exports=f},5177:function(e,t,n){"use strict";var a=n(5115),l=function(){function IceBox(){Object.defineProperties(this,{_filter:{value:new a({getKey:function getKey(e){return e.ufrag},isLessThanOrEqualTo:function isLessThanOrEqualTo(e,t){return e.revision<=t.revision}})},_ufrag:{writable:!0,value:null},ufrag:{enumerable:!0,get:function(){return this._ufrag}}})}return IceBox.prototype.setUfrag=function(e){this._ufrag=e;var t=this._filter.toMap().get(e);return t?t.candidates:[]},IceBox.prototype.update=function(e){e.candidates=e.candidates||[];var t=this._filter.toMap().get(e.ufrag),n=t?t.candidates:[];return this._filter.update(e)&&this._ufrag===e.ufrag?e.candidates.slice(n.length):[]},IceBox}();e.exports=l},8581:function(e,t,n){"use strict";var a=n(2097),l=a.ICE_ACTIVITY_CHECK_PERIOD_MS,f=a.ICE_INACTIVITY_THRESHOLD_MS,p=function(){function IceConnectionMonitor(e,t){t=Object.assign({activityCheckPeriodMs:l,inactivityThresholdMs:f},t),Object.defineProperties(this,{_activityCheckPeriodMs:{value:t.activityCheckPeriodMs},_inactivityThresholdMs:{value:t.inactivityThresholdMs},_lastActivity:{value:null,writable:!0},_peerConnection:{value:e},_timer:{value:null,writable:!0},_onIceConnectionStateChanged:{value:null,writable:!0}})}return IceConnectionMonitor.prototype._getActivePairStat=function(e){var t=Array.from(e.values());return t.find((function(e){return"inbound-rtp"===e.type}))?t.find((function(e){return"candidate-pair"===e.type&&e.nominated}))||{bytesReceived:0,timestamp:Math.round((new Date).getTime())}:null},IceConnectionMonitor.prototype._getIceConnectionStats=function(){var e=this;return this._peerConnection.getStats().then((function(t){return e._getActivePairStat(t)})).catch((function(){return null}))},IceConnectionMonitor.prototype._scheduleInactivityCallback=function(e){var t=this;e&&null===this._onIceConnectionStateChanged?(this._onIceConnectionStateChanged=function(){"disconnected"===t._peerConnection.iceConnectionState&&e()},this._peerConnection.addEventListener("iceconnectionstatechange",this._onIceConnectionStateChanged)):!e&&this._onIceConnectionStateChanged&&(this._peerConnection.removeEventListener("iceconnectionstatechange",this._onIceConnectionStateChanged),this._onIceConnectionStateChanged=null)},IceConnectionMonitor.prototype.start=function(e){var t=this;this.stop(),this._timer=setInterval((function(){t._getIceConnectionStats().then((function(n){n&&(t._lastActivity&&t._lastActivity.bytesReceived===n.bytesReceived||(t._lastActivity=n,t._scheduleInactivityCallback(null)),n.timestamp-t._lastActivity.timestamp>=t._inactivityThresholdMs&&("disconnected"===t._peerConnection.iceConnectionState?e():null===t._onIceConnectionStateChanged&&t._scheduleInactivityCallback(e)))}))}),this._activityCheckPeriodMs)},IceConnectionMonitor.prototype.stop=function(){this._scheduleInactivityCallback(null),null!==this._timer&&(clearInterval(this._timer),this._timer=null,this._lastActivity=null)},IceConnectionMonitor}();e.exports=p},9528:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(4904),p=n(671),h=function(e){function SignalingV2(t,n){var a;return n=Object.assign({createCancelableRoomSignalingPromise:f},n),a=e.call(this)||this,Object.defineProperties(a,{_createCancelableRoomSignalingPromise:{value:n.createCancelableRoomSignalingPromise},_options:{value:n},_wsServer:{value:t}}),a}return l(SignalingV2,e),SignalingV2.prototype._connect=function(e,t,n,a,l){return l=Object.assign({},this._options,l),this._createCancelableRoomSignalingPromise.bind(null,t,this._wsServer,e,n,a,l)},SignalingV2.prototype.createLocalParticipantSignaling=function(e,t){return new p(e,t)},SignalingV2}(n(5743));e.exports=h},671:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(8881),p=n(8876),h=n(6971).isDeepEqual,m=function(e){function LocalParticipantV2(t,n,a){var l;return a=Object.assign({LocalTrackPublicationV2:p},a),l=e.call(this)||this,Object.defineProperties(l,{_bandwidthProfile:{value:null,writable:!0},_bandwidthProfileRevision:{value:0,writable:!0},_encodingParameters:{value:t},_removeListeners:{value:new Map},_LocalTrackPublicationV2:{value:a.LocalTrackPublicationV2},_publishedRevision:{writable:!0,value:0},_revision:{writable:!0,value:1},_signalingRegion:{value:null,writable:!0},bandwidthProfile:{enumerable:!0,get:function(){return this._bandwidthProfile}},bandwidthProfileRevision:{enumerable:!0,get:function(){return this._bandwidthProfileRevision}},networkQualityConfiguration:{enumerable:!0,value:n},revision:{enumerable:!0,get:function(){return this._revision}},signalingRegion:{enumerable:!0,get:function(){return this._signalingRegion}}}),l}return l(LocalParticipantV2,e),LocalParticipantV2.prototype.setSignalingRegion=function(e){this._signalingRegion||(this._signalingRegion=e)},LocalParticipantV2.prototype.setBandwidthProfile=function(e){h(this._bandwidthProfile,e)||(this._bandwidthProfile=JSON.parse(JSON.stringify(e)),this._bandwidthProfileRevision++,this.didUpdate())},LocalParticipantV2.prototype.setParameters=function(e){return this._encodingParameters.update(e),this},LocalParticipantV2.prototype.update=function(e){return this._publishedRevision>=e.revision||(this._publishedRevision=e.revision,e.tracks.forEach((function(e){var t=this.tracks.get(e.id);t&&t.update(e)}),this)),this},LocalParticipantV2.prototype._createLocalTrackPublicationSignaling=function(e,t,n){return new this._LocalTrackPublicationV2(e,t,n)},LocalParticipantV2.prototype.addTrack=function(t,n,a){var l=this;e.prototype.addTrack.call(this,t,n,a);var f=this.getPublication(t),p=f.isEnabled,h=f.updatedPriority,updated=function(){p===f.isEnabled&&h===f.updatedPriority||(l.didUpdate(),p=f.isEnabled,h=f.updatedPriority)};return f.on("updated",updated),this._removeListener(f),this._removeListeners.set(f,(function(){return f.removeListener("updated",updated)})),this.didUpdate(),this},LocalParticipantV2.prototype._removeListener=function(e){var t=this._removeListeners.get(e);t&&t()},LocalParticipantV2.prototype.getState=function(){return{revision:this.revision,tracks:Array.from(this.tracks.values()).map((function(e){return e.getState()}))}},LocalParticipantV2.prototype.didUpdate=function(){this._revision++,this.emit("updated")},LocalParticipantV2.prototype.removeTrack=function(t){var n=e.prototype.removeTrack.call(this,t);return n&&(t.removeClone(n.trackTransceiver),this._removeListener(n),this.didUpdate()),n},LocalParticipantV2.prototype.setNetworkQualityConfiguration=function(e){this.networkQualityConfiguration.update(e)},LocalParticipantV2}(f);e.exports=m},8876:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(617),p=n(8144).createTwilioError,h=function(e){function LocalTrackPublicationV2(t,n,a){return e.call(this,t,n,a)||this}return l(LocalTrackPublicationV2,e),LocalTrackPublicationV2.prototype.getState=function(){return{enabled:this.isEnabled,id:this.id,kind:this.kind,name:this.name,priority:this.updatedPriority}},LocalTrackPublicationV2.prototype.update=function(e){switch(e.state){case"ready":this.setSid(e.sid);break;case"failed":var t=e.error;this.publishFailed(p(t.code,t.message))}return this},LocalTrackPublicationV2}(f);e.exports=h},1014:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(7187),p=0,h=function(e){function MediaSignaling(t,n,a){var l=e.call(this)||this;return Object.defineProperties(l,{_instanceId:{value:p++},channel:{value:n},_log:{value:a.log.createLog("default",l)},_getReceiver:{value:t},_receiverPromise:{value:null,writable:!0},_transport:{value:null,writable:!0}}),l}return l(MediaSignaling,e),Object.defineProperty(MediaSignaling.prototype,"isSetup",{get:function(){return!!this._receiverPromise},enumerable:!1,configurable:!0}),MediaSignaling.prototype.toString=function(){return"[MediaSignaling #"+this._instanceId+":"+this.channel+"]"},MediaSignaling.prototype.setup=function(e){var t=this;this._teardown(),this._log.info("setting up msp transport for id:",e);var n=this._getReceiver(e).then((function(e){if("data"!==e.kind&&t._log.error("Expected a DataTrackReceiver"),t._receiverPromise===n){try{t._transport=e.toDataTransport(),t.emit("ready",t._transport)}catch(a){t._log.error("Failed to toDataTransport: "+a.message)}e.once("close",(function(){return t._teardown()}))}}));this._receiverPromise=n},MediaSignaling.prototype._teardown=function(){this._transport&&(this._log.info("Tearing down"),this._transport=null,this._receiverPromise=null,this.emit("teardown"))},MediaSignaling}(f);e.exports=h},6202:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},p=n(7187),h=n(7396),m=function(e){function NetworkQualityMonitor(t,n){var a=e.call(this)||this;return Object.defineProperties(a,{_factories:{value:new WeakMap},_manager:{value:t},_signaling:{value:n}}),n.on("updated",(function(){return a.emit("updated")})),a}return l(NetworkQualityMonitor,e),Object.defineProperty(NetworkQualityMonitor.prototype,"level",{get:function(){return this._signaling.level},enumerable:!1,configurable:!0}),Object.defineProperty(NetworkQualityMonitor.prototype,"levels",{get:function(){return this._signaling.levels},enumerable:!1,configurable:!0}),Object.defineProperty(NetworkQualityMonitor.prototype,"remoteLevels",{get:function(){return this._signaling.remoteLevels},enumerable:!1,configurable:!0}),NetworkQualityMonitor.prototype.start=function(){var e=this;this.stop();var t=setTimeout((function(){e._timeout===t&&function next(e){var t=(e._manager._peerConnections?Array.from(e._manager._peerConnections.values()):[]).map((function(e){return e._peerConnection})).filter((function(e){return"closed"!==e.signalingState})).map((function(t){if(e._factories.has(t))return e._factories.get(t);var n=new h(t);return e._factories.set(t,n),n})).map((function(e){return e.next().catch((function(){return null}))}));return Promise.all(t).then((function(e){return e.filter((function(e){return e})).map((function(e){return e.summarize()}))}))}(e).then((function(n){if(e._timeout===t){if(n.length){var a=f(n,1)[0];e._signaling.put(a)}e.start()}}))}),200);this._timeout=t},NetworkQualityMonitor.prototype.stop=function(){clearTimeout(this._timeout),this._timeout=null},NetworkQualityMonitor}(p);e.exports=m},597:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(1014),p=n(7206),h=function(e){function NetworkQualitySignaling(t,n,a){var l=e.call(this,t,"network_quality",a)||this;return Object.defineProperties(l,{_level:{value:null,writable:!0},_levels:{value:null,writable:!0},_remoteLevels:{value:new Map,writable:!0},_networkQualityInputs:{value:new p},_networkQualityReportLevels:{get:function(){return{reportLevel:n.local,remoteReportLevel:n.remote}}}}),l.on("ready",(function(e){e.on("message",(function(e){if("network_quality"===e.type)l._handleNetworkQualityMessage(e)}))})),l._sendNetworkQualityInputs(),l}return l(NetworkQualitySignaling,e),Object.defineProperty(NetworkQualitySignaling.prototype,"level",{get:function(){return this._level},enumerable:!1,configurable:!0}),Object.defineProperty(NetworkQualitySignaling.prototype,"levels",{get:function(){return this._levels},enumerable:!1,configurable:!0}),Object.defineProperty(NetworkQualitySignaling.prototype,"remoteLevels",{get:function(){return this._remoteLevels},enumerable:!1,configurable:!0}),NetworkQualitySignaling.prototype._handleNetworkQualityMessage=function(e){var t=this,n=!1,a=null,l=e?e.local:null;"number"==typeof l?(a=l,this._levels=null):"object"==typeof l&&l&&(this._levels=l,a="number"==typeof l.level?l.level:Math.min(l.audio.send,l.audio.recv,l.video.send,l.video.recv)),null!==a&&this.level!==a&&(this._level=a,n=!0),this._remoteLevels=e&&e.remotes?e.remotes.reduce((function(e,a){return(t._remoteLevels.get(a.sid)||{}).level!==a.level&&(n=!0),e.set(a.sid,a)}),new Map):this._remoteLevels,n&&this.emit("updated"),setTimeout((function(){return t._sendNetworkQualityInputs()}),1e3)},NetworkQualitySignaling.prototype._sendNetworkQualityInputs=function(){var e=this;return this._networkQualityInputs.take().then((function(t){e._transport&&e._transport.publish(function createNetworkQualityInputsMessage(e,t){return Object.assign({type:"network_quality"},e,t)}(t,e._networkQualityReportLevels))}))},NetworkQualitySignaling.prototype.put=function(e){this._networkQualityInputs.put(e)},NetworkQualitySignaling}(f);e.exports=h},5773:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},p=this&&this.__spreadArray||function(e,t){for(var n=0,a=t.length,l=e.length;n<a;n++,l++)e[l]=t[n];return e},h=n(5144),m=n(3819),g=m.MediaStream,v=m.RTCIceCandidate,y=m.RTCPeerConnection,_=m.RTCSessionDescription,b=m.getStats,C=n(2939).guessBrowser,S=n(1406).getSdpFormat,k=n(2097),w=k.DEFAULT_ICE_GATHERING_TIMEOUT_MS,T=k.DEFAULT_LOG_LEVEL,P=k.DEFAULT_SESSION_TIMEOUT_SEC,A=k.iceRestartBackoffConfig,M=n(1062),x=M.createCodecMapForMediaSection,O=M.disableRtx,R=M.enableDtxForOpus,I=M.getMediaSections,L=M.removeSSRCAttributes,N=M.revertSimulcastForNonVP8MediaSections,D=M.setBitrateParameters,B=M.setCodecPreferences,F=M.setSimulcast,j=M.unifiedPlanAddOrRewriteNewTrackIds,$=M.unifiedPlanAddOrRewriteTrackIds,H=M.unifiedPlanFilterLocalCodecs,V=n(5317),U=n(8144),G=U.MediaClientLocalDescFailedError,q=U.MediaClientRemoteDescFailedError,W=n(6971),z=W.buildLogLevels,K=W.getPlatform,Z=W.isChromeScreenShareTrack,Q=W.oncePerTick,X=n(5177),Y=n(8581),J=n(9538),ee=n(8960),te=n(3122),ne=n(6372),re=n(6723),oe=n(3226),ie=n(3284),ae=n(4799),se=C(),ce=K(),le=/android/.test(ce),ue="chrome"===se,de="firefox"===se,fe="safari"===se,pe="undefined"!=typeof RTCRtpSender&&"function"==typeof RTCRtpSender.prototype.getParameters&&"function"==typeof RTCRtpSender.prototype.setParameters,he=0,me={open:["closed","updating"],updating:["closed","open"],closed:[]},ge=function(e){function PeerConnectionV2(t,n,a,l){var f=e.call(this,"open",me)||this,p=getConfiguration(l=Object.assign({enableDscp:!1,dummyAudioMediaStreamTrack:null,isChromeScreenShareTrack:Z,iceServers:[],isRTCRtpSenderParamsSupported:pe,logLevel:T,offerOptions:{},revertSimulcastForNonVP8MediaSections:N,sessionTimeout:1e3*P,setBitrateParameters:D,setCodecPreferences:B,setSimulcast:F,Backoff:h,IceConnectionMonitor:Y,MediaStream:g,RTCIceCandidate:v,RTCPeerConnection:y,RTCSessionDescription:_,Timeout:V},l)),m=S(p.sdpSemantics),b="unified"===m,C=b?null:new l.MediaStream,k=z(l.logLevel),M=l.RTCPeerConnection;!0===l.enableDscp&&(l.chromeSpecificConstraints=l.chromeSpecificConstraints||{},l.chromeSpecificConstraints.optional=l.chromeSpecificConstraints.optional||[],l.chromeSpecificConstraints.optional.push({googDscp:!0}));var x=l.log?l.log.createLog("webrtc",f):new ne("webrtc",f,k,l.loggerName),O=new M(p,l.chromeSpecificConstraints);l.dummyAudioMediaStreamTrack&&O.addTrack(l.dummyAudioMediaStreamTrack,C||new l.MediaStream),Object.defineProperties(f,{_appliedTrackIdsToAttributes:{value:new Map,writable:!0},_dataChannels:{value:new Map},_dataTrackReceivers:{value:new Set},_descriptionRevision:{writable:!0,value:0},_didGenerateLocalCandidates:{writable:!0,value:!1},_enableDscp:{value:l.enableDscp},_encodingParameters:{value:n},_isChromeScreenShareTrack:{value:l.isChromeScreenShareTrack},_iceGatheringFailed:{value:!1,writable:!0},_iceGatheringTimeout:{value:new l.Timeout((function(){return f._handleIceGatheringTimeout()}),w,!1)},_iceRestartBackoff:{value:l.Backoff.exponential(A)},_instanceId:{value:++he},_isIceConnectionInactive:{writable:!0,value:!1},_isIceLite:{writable:!0,value:!1},_isIceRestartBackoffInProgress:{writable:!0,value:!1},_isRestartingIce:{writable:!0,value:!1},_isUnifiedPlan:{value:b},_isRTCRtpSenderParamsSupported:{value:l.isRTCRtpSenderParamsSupported},_lastIceConnectionState:{writable:!0,value:null},_lastStableDescriptionRevision:{writable:!0,value:0},_localCandidates:{writable:!0,value:[]},_localCodecs:{value:new Set},_localCandidatesRevision:{writable:!0,value:1},_localDescriptionWithoutSimulcast:{writable:!0,value:null},_localDescription:{writable:!0,value:null},_localMediaStream:{value:C},_localUfrag:{writable:!0,value:null},_log:{value:x},_eventObserver:{value:l.eventObserver},_remoteCodecMaps:{value:new Map},_rtpSenders:{value:new Map},_iceConnectionMonitor:{value:new l.IceConnectionMonitor(O)},_mediaTrackReceivers:{value:new Set},_needsAnswer:{writable:!0,value:!1},_negotiationRole:{writable:!0,value:null},_offerOptions:{writable:!0,value:l.offerOptions},_onEncodingParametersChanged:{value:Q((function(){f._isRTCRtpSenderParamsSupported?f._needsAnswer||updateEncodingParameters(f):f.offer()}))},_peerConnection:{value:O},_preferredAudioCodecs:{value:a.audio},_preferredVideoCodecs:{value:a.video},_shouldApplyDtx:{value:a.audio.every((function(e){return"opus"!==e.codec}))||a.audio.some((function(e){var t=e.codec,n=e.dtx;return"opus"===t&&n}))},_shouldApplySimulcast:{value:(ue||fe)&&a.video.some((function(e){return"vp8"===e.codec.toLowerCase()&&e.simulcast}))},_queuedDescription:{writable:!0,value:null},_iceReconnectTimeout:{value:new l.Timeout((function(){x.debug("ICE reconnect timed out"),f.close()}),l.sessionTimeout,!1)},_recycledTransceivers:{value:{audio:[],video:[]}},_replaceTrackPromises:{value:new Map},_remoteCandidates:{writable:!0,value:new X},_sdpFormat:{value:m},_setBitrateParameters:{value:l.setBitrateParameters},_setCodecPreferences:{value:de&&le&&a.video[0]&&"h264"!==a.video[0].codec.toLowerCase()?function(e){return e}:l.setCodecPreferences},_setSimulcast:{value:l.setSimulcast},_revertSimulcastForNonVP8MediaSections:{value:l.revertSimulcastForNonVP8MediaSections},_RTCIceCandidate:{value:l.RTCIceCandidate},_RTCPeerConnection:{value:l.RTCPeerConnection},_RTCSessionDescription:{value:l.RTCSessionDescription},_shouldOffer:{writable:!0,value:!1},_shouldRestartIce:{writable:!0,value:!1},_trackIdsToAttributes:{value:new Map,writable:!0},_trackMatcher:{writable:!0,value:null},id:{enumerable:!0,value:t}}),n.on("changed",f._onEncodingParametersChanged),O.addEventListener("connectionstatechange",f._handleConnectionStateChange.bind(f)),O.addEventListener("datachannel",f._handleDataChannelEvent.bind(f)),O.addEventListener("icecandidate",f._handleIceCandidateEvent.bind(f)),O.addEventListener("iceconnectionstatechange",f._handleIceConnectionStateChange.bind(f)),O.addEventListener("icegatheringstatechange",f._handleIceGatheringStateChange.bind(f)),O.addEventListener("signalingstatechange",f._handleSignalingStateChange.bind(f)),O.addEventListener("track",f._handleTrackEvent.bind(f)),f._iceRestartBackoff.on("ready",(function(){return f._initiateIceRestart()}));var R=f;return f.on("stateChanged",(function stateChanged(e){"closed"===e&&(R.removeListener("stateChanged",stateChanged),R._dataChannels.forEach((function(e,t){R.removeDataTrackSender(t)})))})),f}return l(PeerConnectionV2,e),PeerConnectionV2.prototype.toString=function(){return"[PeerConnectionV2 #"+this._instanceId+": "+this.id+"]"},Object.defineProperty(PeerConnectionV2.prototype,"connectionState",{get:function(){return"failed"===this.iceConnectionState?"failed":this._peerConnection.connectionState||this.iceConnectionState},enumerable:!1,configurable:!0}),Object.defineProperty(PeerConnectionV2.prototype,"iceConnectionState",{get:function(){return this._isIceConnectionInactive&&"disconnected"===this._peerConnection.iceConnectionState||this._iceGatheringFailed?"failed":this._peerConnection.iceConnectionState},enumerable:!1,configurable:!0}),Object.defineProperty(PeerConnectionV2.prototype,"isApplicationSectionNegotiated",{get:function(){return"closed"===this._peerConnection.signalingState||!!this._peerConnection.localDescription&&I(this._peerConnection.localDescription.sdp,"application").length>0},enumerable:!1,configurable:!0}),PeerConnectionV2.prototype._updateEncodings=function(e,t,n){var a=this,l=e*t,f=[{pixels:518400,maxActiveLayers:3},{pixels:129600,maxActiveLayers:2},{pixels:0,maxActiveLayers:1}].find((function(e){return l>=e.pixels})),p=Math.min(n.length,f.maxActiveLayers);n.forEach((function(e,t){e.active=t<p,e.active?e.scaleResolutionDownBy=1<<p-t-1:delete e.scaleResolutionDownBy,a._log.debug("setting up simulcast layer "+t+" with active = "+e.active+", scaleResolutionDownBy = "+e.scaleResolutionDownBy)}))},PeerConnectionV2.prototype._addIceCandidate=function(e){var t=this;return Promise.resolve().then((function(){return e=new t._RTCIceCandidate(e),t._peerConnection.addIceCandidate(e)})).catch((function(n){t._log.warn("Failed to add RTCIceCandidate "+(e?'"'+e.candidate+'"':"null")+": "+n.message)}))},PeerConnectionV2.prototype._addIceCandidates=function(e){return Promise.all(e.map(this._addIceCandidate,this)).then((function(){}))},PeerConnectionV2.prototype._addOrUpdateTransceiver=function(e){var t=this,n=function takeRecycledTransceiver(e,t){var n={audio:e._preferredAudioCodecs.map((function(e){return e.codec.toLowerCase()})),video:e._preferredVideoCodecs.map((function(e){return e.codec.toLowerCase()}))}[t],a=e._recycledTransceivers[t],l=n.find((function(t){return e._localCodecs.has(t)}));if(!l)return a.shift();var f=a.find((function(t){var n=e._remoteCodecMaps.get(t.mid);return n&&n.has(l)}));f&&a.splice(a.indexOf(f),1);return f}(this,e.kind);if(n&&n.sender){var a=n.sender.track?n.sender.track.id:null;return a&&this._log.warn("Reusing transceiver: "+n.mid+"] "+a+" => "+e.id),this._replaceTrackPromises.set(n,n.sender.replaceTrack(e).then((function(){n.direction="sendrecv"}),(function(){})).finally((function(){t._replaceTrackPromises.delete(n)}))),n}return this._peerConnection.addTransceiver(e)},PeerConnectionV2.prototype._checkIceBox=function(e){var t=getUfrag(e);if(!t)return Promise.resolve();var n=this._remoteCandidates.setUfrag(t);return this._addIceCandidates(n)},PeerConnectionV2.prototype._answer=function(e){var t=this;return Promise.resolve().then((function(){return t._negotiationRole||(t._negotiationRole="answerer"),t._setRemoteDescription(e)})).catch((function(){throw new q})).then((function(){return t._peerConnection.createAnswer()})).then((function(n){n=de?new t._RTCSessionDescription({sdp:O(n.sdp),type:n.type}):ae(n);var a=L(n.sdp,["mslabel","label"]);if(t._shouldApplySimulcast){var l=a;a=t._setSimulcast(l,t._sdpFormat,t._trackIdsToAttributes),a=t._revertSimulcastForNonVP8MediaSections(a,l,e.sdp)}return a=a.replace(/42e015/g,"42e01f"),t._setLocalDescription({type:n.type,sdp:a})})).then((function(){return t._checkIceBox(e)})).then((function(){return t._queuedDescription&&t._updateDescription(t._queuedDescription)})).then((function(){return t._queuedDescription=null,t._maybeReoffer(t._peerConnection.localDescription)})).catch((function(e){var n=e instanceof q?e:new G;throw t._publishMediaWarning({message:"Failed to _answer",code:n.code,error:e}),n}))},PeerConnectionV2.prototype._close=function(){return this._iceConnectionMonitor.stop(),"closed"!==this._peerConnection.signalingState&&(this._peerConnection.close(),this.preempt("closed"),this._encodingParameters.removeListener("changed",this._onEncodingParametersChanged),!0)},PeerConnectionV2.prototype._handleConnectionStateChange=function(){this.emit("connectionStateChanged")},PeerConnectionV2.prototype._handleDataChannelEvent=function(e){var t=this,n=e.channel,a=new J(n);this._dataTrackReceivers.add(a),n.addEventListener("close",(function(){t._dataTrackReceivers.delete(a)})),this.emit("trackAdded",a)},PeerConnectionV2.prototype._handleGlare=function(e){var t=this;return this._log.debug("Glare detected; rolling back"),this._isRestartingIce&&(this._log.debug("An ICE restart was in progress; we'll need to restart ICE again after rolling back"),this._isRestartingIce=!1,this._shouldRestartIce=!0),Promise.resolve().then((function(){return t._trackIdsToAttributes=new Map(t._appliedTrackIdsToAttributes),t._setLocalDescription({type:"rollback"})})).then((function(){return t._needsAnswer=!1,t._answer(e)})).then((function(e){return e?Promise.resolve():t._offer()}))},PeerConnectionV2.prototype._publishMediaWarning=function(e){var t=e.message,n=e.code,a=e.error,l=e.sdp;this._eventObserver.emit("event",{level:"warning",name:"error",group:"media",payload:{message:t,code:n,context:JSON.stringify({error:a.message,sdp:l})}})},PeerConnectionV2.prototype._handleIceCandidateEvent=function(e){e.candidate&&(this._log.debug("Clearing ICE gathering timeout"),this._didGenerateLocalCandidates=!0,this._iceGatheringTimeout.clear(),this._localCandidates.push(e.candidate));var t={ice:{candidates:this._isIceLite?[]:this._localCandidates.slice(),ufrag:this._localUfrag},id:this.id};e.candidate||(t.ice.complete=!0),this._isIceLite&&e.candidate||(t.ice.revision=this._localCandidatesRevision++,this.emit("candidates",t))},PeerConnectionV2.prototype._handleIceConnectionStateChange=function(){var e=this,t=this._peerConnection.iceConnectionState,n=["connected","completed"].includes(t),a=this._log;a.debug('ICE connection state is "'+t+'"'),n&&(this._iceReconnectTimeout.clear(),this._iceRestartBackoff.reset()),"failed"===this._lastIceConnectionState||"failed"!==t||this._shouldRestartIce||this._isRestartingIce?["disconnected","failed"].includes(this._lastIceConnectionState)&&n&&a.debug("ICE reconnected"):(a.warn("ICE failed"),this._initiateIceRestartBackoff()),"connected"===t?(this._isIceConnectionInactive=!1,this._iceConnectionMonitor.start((function(){e._iceConnectionMonitor.stop(),e._shouldRestartIce||e._isRestartingIce||(a.warn("ICE Connection Monitor detected inactivity"),e._isIceConnectionInactive=!0,e._initiateIceRestartBackoff(),e.emit("iceConnectionStateChanged"),e.emit("connectionStateChanged"))}))):["disconnected","completed"].includes(t)||(this._iceConnectionMonitor.stop(),this._isIceConnectionInactive=!1),this._lastIceConnectionState=t,this.emit("iceConnectionStateChanged")},PeerConnectionV2.prototype._handleIceGatheringTimeout=function(){this._log.warn("ICE failed to gather any local candidates"),this._iceGatheringFailed=!0,this._initiateIceRestartBackoff(),this.emit("iceConnectionStateChanged"),this.emit("connectionStateChanged")},PeerConnectionV2.prototype._handleIceGatheringStateChange=function(){var e=this._peerConnection.iceGatheringState,t=this._log;t.debug('ICE gathering state is "'+e+'"');var n=this._iceGatheringTimeout,a=n.delay,l=n.isSet;"gathering"!==e||this._didGenerateLocalCandidates||l||(t.debug("Starting ICE gathering timeout: "+a),this._iceGatheringFailed=!1,this._iceGatheringTimeout.start())},PeerConnectionV2.prototype._handleSignalingStateChange=function(){"stable"===this._peerConnection.signalingState&&(this._appliedTrackIdsToAttributes=new Map(this._trackIdsToAttributes))},PeerConnectionV2.prototype._handleTrackEvent=function(e){var t=this,n=this._peerConnection.remoteDescription?this._peerConnection.remoteDescription.sdp:null;this._trackMatcher||(this._trackMatcher=e.transceiver&&e.transceiver.mid?new ie:fe||this._isUnifiedPlan?new oe:new re),this._trackMatcher.update(n);var a=e.track,l=this._trackMatcher.match(e)||a.id,f=new ee(l,a);this._mediaTrackReceivers.forEach((function(e){e.track.id===f.track.id&&t._mediaTrackReceivers.delete(e)})),this._mediaTrackReceivers.add(f),a.addEventListener("ended",(function(){return t._mediaTrackReceivers.delete(f)})),this.emit("trackAdded",f)},PeerConnectionV2.prototype._initiateIceRestart=function(){if("closed"!==this._peerConnection.signalingState){var e=this._log;e.warn("Attempting to restart ICE"),this._didGenerateLocalCandidates=!1,this._isIceRestartBackoffInProgress=!1,this._shouldRestartIce=!0;var t=this._iceReconnectTimeout,n=t.delay;t.isSet||(e.debug("Starting ICE reconnect timeout: "+n),this._iceReconnectTimeout.start()),this.offer().catch((function(t){e.error("offer failed in _initiateIceRestart with: "+t.message)}))}},PeerConnectionV2.prototype._initiateIceRestartBackoff=function(){"closed"===this._peerConnection.signalingState||this._isIceRestartBackoffInProgress||(this._log.warn("An ICE restart has been scheduled"),this._isIceRestartBackoffInProgress=!0,this._iceRestartBackoff.backoff())},PeerConnectionV2.prototype._maybeReoffer=function(e){var t=this._shouldOffer;if(e&&e.sdp){if(this._isUnifiedPlan){var n=this._peerConnection.getSenders().filter((function(e){return e.track}));t=["audio","video"].reduce((function(t,a){var l=I(e.sdp,a,"(sendrecv|sendonly)"),f=n.filter(isSenderOfKind.bind(null,a));return t||l.length<f.length}),t)}var a=this._dataChannels.size>0,l=I(e.sdp,"application").length>0;t=t||a&&!l}return(t?this._offer():Promise.resolve()).then((function(){return t}))},PeerConnectionV2.prototype._offer=function(){var e=this,t=Object.assign({},this._offerOptions);return this._needsAnswer=!0,this._shouldRestartIce&&(this._shouldRestartIce=!1,this._isRestartingIce=!0,t.iceRestart=!0),Promise.all(this._replaceTrackPromises.values()).then((function(){return e._peerConnection.createOffer(t)})).catch((function(t){var n=new G;throw e._publishMediaWarning({message:"Failed to create offer",code:n.code,error:t}),n})).then((function(t){t=de?new e._RTCSessionDescription({sdp:O(t.sdp),type:t.type}):ae(t);var n=L(t.sdp,["mslabel","label"]);n=e._isUnifiedPlan&&e._peerConnection.remoteDescription?H(n,e._peerConnection.remoteDescription.sdp):n;var a=e._setCodecPreferences(n,e._preferredAudioCodecs,e._preferredVideoCodecs);return e._shouldOffer=!1,e._negotiationRole||(e._negotiationRole="offerer"),e._shouldApplySimulcast&&(e._localDescriptionWithoutSimulcast={type:"offer",sdp:a},a=e._setSimulcast(a,e._sdpFormat,e._trackIdsToAttributes)),e._setLocalDescription({type:"offer",sdp:a})}))},PeerConnectionV2.prototype._getMediaTrackSenderId=function(e){var t=Array.from(this._rtpSenders.keys()).find((function(t){return t.track.id===e}));return t?t.id:e},PeerConnectionV2.prototype._addOrRewriteLocalTrackIds=function(e){var t=this,n=this._peerConnection.getTransceivers().filter((function(e){var t=e.sender;return!e.stopped&&t&&t.track})),a=n.filter((function(e){return e.mid})),l=new Map(a.map((function(e){var n=e.mid,a=e.sender;return[n,t._getMediaTrackSenderId(a.track.id)]}))),f=$(e.sdp,l),p=n.filter((function(e){return!e.mid})),h=new Map(["audio","video"].map((function(e){return[e,p.filter((function(t){return t.sender.track.kind===e})).map((function(e){var n=e.sender;return t._getMediaTrackSenderId(n.track.id)}))]}))),m=j(f,l,h);return new this._RTCSessionDescription({sdp:m,type:e.type})},PeerConnectionV2.prototype._rollbackAndApplyOffer=function(e){var t=this;return this._setLocalDescription({type:"rollback"}).then((function(){return t._setLocalDescription(e)}))},PeerConnectionV2.prototype._setLocalDescription=function(e){var t=this;return"rollback"!==e.type&&this._shouldApplyDtx&&(e=new this._RTCSessionDescription({sdp:R(e.sdp),type:e.type})),this._peerConnection.setLocalDescription(e).catch((function(n){t._log.warn('Calling setLocalDescription with an RTCSessionDescription of type "'+e.type+'" failed with the error "'+n.message+'".');var a=new G,l={message:'Calling setLocalDescription with an RTCSessionDescription of type "'+e.type+'" failed',code:a.code,error:n};throw e.sdp&&(t._log.warn("The SDP was "+e.sdp),l.sdp=e.sdp),t._publishMediaWarning(l),a})).then((function(){"rollback"!==e.type&&(t._localDescription=t._isUnifiedPlan?t._addOrRewriteLocalTrackIds(e):e,t._shouldApplyDtx&&(t._localDescription=new t._RTCSessionDescription({sdp:R(t._localDescription.sdp,[]),type:t._localDescription.type})),t._localCandidates=[],"offer"===e.type?t._descriptionRevision++:"answer"===e.type&&(t._lastStableDescriptionRevision=t._descriptionRevision,negotiationCompleted(t)),t._localUfrag=getUfrag(e),t.emit("description",t.getState()))}))},PeerConnectionV2.prototype._setRemoteDescription=function(e){var t=this;return e.sdp&&(this._isRTCRtpSenderParamsSupported||(e.sdp=this._setBitrateParameters(e.sdp,de?"TIAS":"AS",this._encodingParameters.maxAudioBitrate,this._encodingParameters.maxVideoBitrate)),e.sdp=this._setCodecPreferences(e.sdp,this._preferredAudioCodecs,this._preferredVideoCodecs),this._shouldApplyDtx?e.sdp=R(e.sdp):e.sdp=R(e.sdp,[]),de&&(e.sdp=function filterOutMediaStreamIds(e){return e.replace(/a=msid:[^ ]+ /g,"a=msid:- ")}(e.sdp)),this._peerConnection.remoteDescription||(this._isIceLite=/a=ice-lite/.test(e.sdp))),e=new this._RTCSessionDescription(e),Promise.resolve().then((function(){if("answer"===e.type&&t._shouldApplySimulcast){var n=t._revertSimulcastForNonVP8MediaSections(t._localDescription.sdp,t._localDescriptionWithoutSimulcast.sdp,e.sdp);if(n!==t._localDescription.sdp)return t._rollbackAndApplyOffer({type:t._localDescription.type,sdp:n})}})).then((function(){return t._peerConnection.setRemoteDescription(e)})).then((function(){"answer"===e.type&&(t._isRestartingIce&&(t._log.debug("An ICE restart was in-progress and is now completed"),t._isRestartingIce=!1),negotiationCompleted(t))}),(function(n){throw t._log.warn('Calling setRemoteDescription with an RTCSessionDescription of type "'+e.type+'" failed with the error "'+n.message+'".'),e.sdp&&t._log.warn("The SDP was "+e.sdp),n}))},PeerConnectionV2.prototype._updateDescription=function(e){var t=this;switch(e.type){case"answer":case"pranswer":if(e.revision!==this._descriptionRevision||"have-local-offer"!==this._peerConnection.signalingState)return Promise.resolve();this._descriptionRevision=e.revision;break;case"close":return this._close();case"create-offer":return e.revision<=this._lastStableDescriptionRevision?Promise.resolve():this._needsAnswer?(this._queuedDescription=e,Promise.resolve()):(this._descriptionRevision=e.revision,this._offer());case"offer":return e.revision<=this._lastStableDescriptionRevision||"closed"===this._peerConnection.signalingState?Promise.resolve():"have-local-offer"===this._peerConnection.signalingState?this._needsAnswer&&0===this._lastStableDescriptionRevision?(this._queuedDescription=e,Promise.resolve()):(this._descriptionRevision=e.revision,this._handleGlare(e)):(this._descriptionRevision=e.revision,this._answer(e).then((function(){})))}var n=e.revision;return Promise.resolve().then((function(){return t._setRemoteDescription(e)})).catch((function(n){var a=new q;throw t._publishMediaWarning({message:'Calling setRemoteDescription with an RTCSessionDescription of type "'+e.type+'" failed',code:a.code,error:n,sdp:e.sdp}),a})).then((function(){return t._lastStableDescriptionRevision=n,t._needsAnswer=!1,t._checkIceBox(e)})).then((function(){return t._queuedDescription&&t._updateDescription(t._queuedDescription)})).then((function(){return t._queuedDescription=null,t._maybeReoffer(t._peerConnection.localDescription).then((function(){}))}))},PeerConnectionV2.prototype._updateIce=function(e){var t=this._remoteCandidates.update(e);return this._addIceCandidates(t)},PeerConnectionV2.prototype.addDataTrackSender=function(e){if(!this._dataChannels.has(e))try{var t={ordered:e.ordered};null!==e.maxPacketLifeTime&&(t.maxPacketLifeTime=e.maxPacketLifeTime),null!==e.maxRetransmits&&(t.maxRetransmits=e.maxRetransmits);var n=this._peerConnection.createDataChannel(e.id,t);e.addDataChannel(n),this._dataChannels.set(e,n)}catch(a){this._log.warn('Error creating an RTCDataChannel for DataTrack "'+e.id+'": '+a.message)}},PeerConnectionV2.prototype.addMediaTrackSender=function(e){if("closed"!==this._peerConnection.signalingState&&!this._rtpSenders.has(e)){var t;if(this._localMediaStream)this._localMediaStream.addTrack(e.track),t=this._peerConnection.addTrack(e.track,this._localMediaStream);else t=this._addOrUpdateTransceiver(e.track).sender;e.addSender(t),this._rtpSenders.set(e,t)}},PeerConnectionV2.prototype.close=function(){this._close()&&(this._descriptionRevision++,this._localDescription={type:"close"},this.emit("description",this.getState()))},PeerConnectionV2.prototype.getTrackReceivers=function(){return Array.from(this._dataTrackReceivers).concat(Array.from(this._mediaTrackReceivers))},PeerConnectionV2.prototype.getState=function(){if(!this._localDescription)return null;var e="answer"===this._localDescription.type?this._lastStableDescriptionRevision:this._descriptionRevision,t={type:this._localDescription.type,revision:e};return this._localDescription.sdp&&(t.sdp=this._localDescription.sdp),{description:t,id:this.id}},PeerConnectionV2.prototype.offer=function(){var e=this;return this._needsAnswer||this._isRestartingIce?(this._shouldOffer=!0,Promise.resolve()):this.bracket("offering",(function(t){return e.transition("updating",t),(e._needsAnswer||e._isRestartingIce?Promise.resolve():e._offer()).then((function(){e.tryTransition("open",t)}),(function(n){throw e.tryTransition("open",t),n}))}))},PeerConnectionV2.prototype.removeDataTrackSender=function(e){var t=this._dataChannels.get(e);t&&(e.removeDataChannel(t),this._dataChannels.delete(e),t.close())},PeerConnectionV2.prototype.removeMediaTrackSender=function(e){var t=this._rtpSenders.get(e);t&&("closed"!==this._peerConnection.signalingState&&this._peerConnection.removeTrack(t),this._localMediaStream&&this._localMediaStream.removeTrack(e.track),e.removeSender(t),this._rtpSenders.delete(e))},PeerConnectionV2.prototype.setConfiguration=function(e){"function"==typeof this._peerConnection.setConfiguration&&this._peerConnection.setConfiguration(getConfiguration(e))},PeerConnectionV2.prototype.setIceReconnectTimeout=function(e){return this._iceReconnectTimeout.setDelay(e),this._log.debug("Updated ICE reconnection timeout period:",this._iceReconnectTimeout.delay),this},PeerConnectionV2.prototype.update=function(e){var t=this;return this.bracket("updating",(function(n){if("closed"===t.state)return Promise.resolve();t.transition("updating",n);var a=[];return e.ice&&a.push(t._updateIce(e.ice)),e.description&&a.push(t._updateDescription(e.description)),Promise.all(a).then((function(){t.tryTransition("open",n)}),(function(e){throw t.tryTransition("open",n),e}))}))},PeerConnectionV2.prototype.getStats=function(){var e=this;return b(this._peerConnection).then((function(t){return function rewriteTrackIds(e,t){return Object.assign(t,{remoteAudioTrackStats:t.remoteAudioTrackStats.map((function(t){return rewriteTrackId(e,t)})),remoteVideoTrackStats:t.remoteVideoTrackStats.map((function(t){return rewriteTrackId(e,t)})),localAudioTrackStats:t.localAudioTrackStats.map((function(t){return rewriteLocalTrackId(e,t)})),localVideoTrackStats:t.localVideoTrackStats.map((function(t){return rewriteLocalTrackId(e,t)}))})}(e,t)}))},PeerConnectionV2}(te);function rewriteLocalTrackId(e,t){var n=e._getMediaTrackSenderId(t.trackId);return Object.assign(t,{trackId:n})}function rewriteTrackId(e,t){var n=p([],f(e._mediaTrackReceivers)).find((function(e){return e.track.id===t.trackId})),a=n?n.id:null;return Object.assign(t,{trackId:a})}function getUfrag(e){if(e.sdp){var t=e.sdp.match(/^a=ice-ufrag:([a-zA-Z0-9+/]+)/m);if(t)return t[1]}return null}function getConfiguration(e){return Object.assign({bundlePolicy:"max-bundle",rtcpMuxPolicy:"require"},e)}function isSenderOfKind(e,t){var n=t.track;return n&&n.kind===e&&"ended"!==n.readyState}function negotiationCompleted(e){e._isUnifiedPlan&&(!function updateRecycledTransceivers(e){e._recycledTransceivers.audio=[],e._recycledTransceivers.video=[],e._peerConnection.getTransceivers().forEach((function(t){if(function shouldRecycleTransceiver(e,t){return!e.stopped&&!t._replaceTrackPromises.has(e)&&["inactive","recvonly"].includes(e.direction)}(t,e)){var n=t.receiver.track;e._recycledTransceivers[n.kind].push(t)}}))}(e),function updateLocalCodecs(e){var t=e._peerConnection.localDescription;t&&I(t.sdp).forEach((function(t){x(t).forEach((function(t,n){return e._localCodecs.add(n)}))}))}(e),function updateRemoteCodecMaps(e){var t=e._peerConnection.remoteDescription;t&&I(t.sdp).forEach((function(t){var n=t.match(/^a=mid:(.+)$/m)[1],a=x(t);e._remoteCodecMaps.set(n,a)}))}(e)),e._isRTCRtpSenderParamsSupported&&updateEncodingParameters(e)}function updateEncodingParameters(e){var t=e._encodingParameters,n=t.maxAudioBitrate,a=t.maxVideoBitrate,l=new Map([["audio",n],["video",a]]);e._peerConnection.getSenders().filter((function(e){return e.track})).forEach((function(t){var n=l.get(t.track.kind),a=t.getParameters();if(null===n||0===n?function removeMaxBitrate(e){Array.isArray(e.encodings)&&e.encodings.forEach((function(e){return delete e.maxBitrate}))}(a):e._isChromeScreenShareTrack(t.track)?e._log.warn("Not setting maxBitrate for "+t.track.kind+" Track "+t.track.id+" because it appears to be screen share track: "+t.track.label):function setMaxBitrate(e,t){de?e.encodings=[{maxBitrate:t}]:e.encodings.forEach((function(e){e.maxBitrate=t}))}(a,n),!de&&e._enableDscp&&a.encodings.length>0&&(a.encodings[0].networkPriority="high"),fe&&"video"===t.track.kind){var f=t.track.getSettings(),p=f.width,h=f.height;e._updateEncodings(p,h,a.encodings)}t.setParameters(a).catch((function(n){e._log.warn("Error while setting encodings parameters for "+t.track.kind+" Track "+t.track.id+": "+(n.message||n.name))}))}))}e.exports=ge},6503:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},p=this&&this.__spreadArray||function(e,t){for(var n=0,a=t.length,l=e.length;n<a;n++,l++)e[l]=t[n];return e},h=n(2939).guessBrowser,m=n(5773),g=n(2259),v=n(3172),y=n(6971),_=n(8144).MediaConnectionError,b="firefox"===h(),C=function(e){function PeerConnectionManager(t,a,l){var f=e.call(this)||this,p=(l=Object.assign({audioContextFactory:b?n(3585):null,PeerConnectionV2:m},l)).audioContextFactory?l.audioContextFactory.getOrCreate(f):null,h=p?{offerToReceiveVideo:!0}:{offerToReceiveAudio:!0,offerToReceiveVideo:!0};return Object.defineProperties(f,{_audioContextFactory:{value:l.audioContextFactory},_closedPeerConnectionIds:{value:new Set},_configuration:{writable:!0,value:null},_configurationDeferred:{writable:!0,value:y.defer()},_connectionState:{value:"new",writable:!0},_dummyAudioTrackSender:{value:p?new g(createDummyAudioMediaStreamTrack(p)):null},_encodingParameters:{value:t},_iceConnectionState:{writable:!0,value:"new"},_dataTrackSenders:{writable:!0,value:new Set},_lastConnectionState:{value:"new",writable:!0},_lastIceConnectionState:{writable:!0,value:"new"},_mediaTrackSenders:{writable:!0,value:new Set},_offerOptions:{value:h},_peerConnections:{value:new Map},_preferredCodecs:{value:a},_sessionTimeout:{value:null,writable:!0},_PeerConnectionV2:{value:l.PeerConnectionV2}}),f}return l(PeerConnectionManager,e),Object.defineProperty(PeerConnectionManager.prototype,"connectionState",{get:function(){return this._connectionState},enumerable:!1,configurable:!0}),Object.defineProperty(PeerConnectionManager.prototype,"iceConnectionState",{get:function(){return this._iceConnectionState},enumerable:!1,configurable:!0}),PeerConnectionManager.prototype._closeAbsentPeerConnections=function(e){var t=new Set(e.map((function(e){return e.id})));return this._peerConnections.forEach((function(e){t.has(e.id)||e._close()})),this},PeerConnectionManager.prototype._getConfiguration=function(){return this._configurationDeferred.promise},PeerConnectionManager.prototype._getOrCreate=function(e,t){var n=this,a=this,l=this._peerConnections.get(e);if(!l){var f=this._PeerConnectionV2,p=Object.assign({dummyAudioMediaStreamTrack:this._dummyAudioTrackSender?this._dummyAudioTrackSender.track:null,offerOptions:this._offerOptions},this._sessionTimeout?{sessionTimeout:this._sessionTimeout}:{},t);try{l=new f(e,this._encodingParameters,this._preferredCodecs,p)}catch(h){throw new _}this._peerConnections.set(l.id,l),l.on("candidates",this.queue.bind(this,"candidates")),l.on("description",this.queue.bind(this,"description")),l.on("trackAdded",this.queue.bind(this,"trackAdded")),l.on("stateChanged",(function stateChanged(e){"closed"===e&&(l.removeListener("stateChanged",stateChanged),a._dataTrackSenders.forEach((function(e){return l.removeDataTrackSender(e)})),a._mediaTrackSenders.forEach((function(e){return l.removeMediaTrackSender(e)})),a._peerConnections.delete(l.id),a._closedPeerConnectionIds.add(l.id),updateConnectionState(a),updateIceConnectionState(a))})),l.on("connectionStateChanged",(function(){return updateConnectionState(n)})),l.on("iceConnectionStateChanged",(function(){return updateIceConnectionState(n)})),this._dataTrackSenders.forEach(l.addDataTrackSender,l),this._mediaTrackSenders.forEach(l.addMediaTrackSender,l),updateIceConnectionState(this)}return l},PeerConnectionManager.prototype.close=function(){return this._peerConnections.forEach((function(e){e.close()})),this._dummyAudioTrackSender&&this._dummyAudioTrackSender.stop(),this._audioContextFactory&&this._audioContextFactory.release(this),updateIceConnectionState(this),this},PeerConnectionManager.prototype.createAndOffer=function(){var e=this;return this._getConfiguration().then((function(t){var n;do{n=y.makeUUID()}while(e._peerConnections.has(n));return e._getOrCreate(n,t)})).then((function(e){return e.offer()})).then((function(){return e}))},PeerConnectionManager.prototype.getTrackReceivers=function(){return y.flatMap(this._peerConnections,(function(e){return e.getTrackReceivers()}))},PeerConnectionManager.prototype.getStates=function(){var e=[];return this._peerConnections.forEach((function(t){var n=t.getState();n&&e.push(n)})),e},PeerConnectionManager.prototype.setConfiguration=function(e){return this._configuration&&(this._configurationDeferred=y.defer(),this._peerConnections.forEach((function(t){t.setConfiguration(e)}))),this._configuration=e,this._configurationDeferred.resolve(e),this},PeerConnectionManager.prototype.setIceReconnectTimeout=function(e){return null===this._sessionTimeout&&(this._peerConnections.forEach((function(t){t.setIceReconnectTimeout(e)})),this._sessionTimeout=e),this},PeerConnectionManager.prototype.setTrackSenders=function(e){var t=new Set(e.filter((function(e){return"data"===e.kind}))),n=new Set(e.filter((function(e){return e&&("audio"===e.kind||"video"===e.kind)}))),a=function getTrackSenderChanges(e,t,n){return{data:getDataTrackSenderChanges(e,t),media:getMediaTrackSenderChanges(e,n)}}(this,t,n);return this._dataTrackSenders=t,this._mediaTrackSenders=n,function applyTrackSenderChanges(e,t){(t.data.add.size||t.data.remove.size||t.media.add.size||t.media.remove.size)&&e._peerConnections.forEach((function(e){t.data.remove.forEach(e.removeDataTrackSender,e),t.media.remove.forEach(e.removeMediaTrackSender,e),t.data.add.forEach(e.addDataTrackSender,e),t.media.add.forEach(e.addMediaTrackSender,e),(t.media.add.size||t.media.remove.size||t.data.add.size&&!e.isApplicationSectionNegotiated)&&e.offer()}))}(this,a),this},PeerConnectionManager.prototype.update=function(e,t){var n=this;return void 0===t&&(t=!1),t&&this._closeAbsentPeerConnections(e),this._getConfiguration().then((function(t){return Promise.all(e.map((function(e){return n._closedPeerConnectionIds.has(e.id)?null:n._getOrCreate(e.id,t).update(e)})))})).then((function(){return n}))},PeerConnectionManager.prototype.getStats=function(){var e=Array.from(this._peerConnections.values());return Promise.all(e.map((function(e){return e.getStats().then((function(t){return[e.id,t]}))}))).then((function(e){return new Map(e)}))},PeerConnectionManager}(v);function createDummyAudioMediaStreamTrack(e){return e.createMediaStreamDestination().stream.getAudioTracks()[0]}function getDataTrackSenderChanges(e,t){return{add:y.difference(t,e._dataTrackSenders),remove:y.difference(e._dataTrackSenders,t)}}function getMediaTrackSenderChanges(e,t){return{add:y.difference(t,e._mediaTrackSenders),remove:y.difference(e._mediaTrackSenders,t)}}var S,k={new:0,checking:1,connecting:2,connected:3,completed:4,disconnected:-1,failed:-2,closed:-3};function summarizeIceOrPeerConnectionStates(e){return e.length?(S=S||function createFromRank(){return Object.keys(k).reduce((function(e,t){var n;return Object.assign(e,((n={})[k[t]]=t,n))}),{})}(),e.reduce((function(e,t){return S[Math.max(k[e],k[t])]}))):"new"}function updateIceConnectionState(e){e._lastIceConnectionState=e.iceConnectionState,e._iceConnectionState=summarizeIceOrPeerConnectionStates(p([],f(e._peerConnections.values())).map((function(e){return e.iceConnectionState}))),e.iceConnectionState!==e._lastIceConnectionState&&e.emit("iceConnectionStateChanged")}function updateConnectionState(e){e._lastConnectionState=e.connectionState,e._connectionState=summarizeIceOrPeerConnectionStates(p([],f(e._peerConnections.values())).map((function(e){return e.connectionState}))),e.connectionState!==e._lastConnectionState&&e.emit("connectionStateChanged")}e.exports=C},8022:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function RecordingV2(){var t=e.call(this)||this;return Object.defineProperties(t,{_revision:{value:1,writable:!0}}),t}return l(RecordingV2,e),RecordingV2.prototype.update=function(e){return e.revision<this._revision?this:(this._revision=e.revision,this.enable(e.is_recording))},RecordingV2}(n(631));e.exports=f},4273:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(8090),p=n(5858),h=function(e){function RemoteParticipantV2(t,n,a,l,f,h){var m=e.call(this,t.sid,t.identity)||this;return h=Object.assign({RemoteTrackPublicationV2:p},h),Object.defineProperties(m,{_revision:{writable:!0,value:null},_RemoteTrackPublicationV2:{value:h.RemoteTrackPublicationV2},_getInitialTrackSwitchOffState:{value:n},updateSubscriberTrackPriority:{value:function(e,t){return a(e,t)}},updateTrackRenderHint:{value:function(e,t){return l(e,t)}},clearTrackHint:{value:function(e){return f(e)}},revision:{enumerable:!0,get:function(){return this._revision}}}),m.update(t)}return l(RemoteParticipantV2,e),RemoteParticipantV2.prototype._getOrCreateTrack=function(e){var t=this._RemoteTrackPublicationV2,n=this.tracks.get(e.sid);n||(n=new t(e,this._getInitialTrackSwitchOffState(e.sid)),this.addTrack(n));return n},RemoteParticipantV2.prototype.update=function(e){var t=this;if(null!==this.revision&&e.revision<=this.revision)return this;this._revision=e.revision;var n=new Set;switch(e.tracks.forEach((function(e){var a=t._getOrCreateTrack(e);a.update(e),n.add(a)})),this.tracks.forEach((function(e){n.has(e)||t.removeTrack(e)})),e.state){case"disconnected":this.disconnect();break;case"reconnecting":this.reconnecting();break;case"connected":this.connect(this.sid,this.identity)}return this},RemoteParticipantV2}(f);e.exports=h},5858:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function RemoteTrackPublicationV2(t,n){return e.call(this,t.sid,t.name,t.kind,t.enabled,t.priority,n)||this}return l(RemoteTrackPublicationV2,e),RemoteTrackPublicationV2.prototype.update=function(e){return this.enable(e.enabled),this.setPriority(e.priority),this},RemoteTrackPublicationV2}(n(5055));e.exports=f},6714:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(1014),p=n(6971).isDeepEqual,h=1,m=function(e){function RenderHintsSignaling(t,n){var a=e.call(this,t,"render_hints",n)||this;return Object.defineProperties(a,{_trackSidsToRenderHints:{value:new Map},_isResponsePending:{value:!1,writable:!0}}),a.on("ready",(function(e){e.on("message",(function(e){if(a._log.debug("Incoming: ",e),"render_hints"===e.type)a._processHintResults(e&&e.subscriber&&e.subscriber.hints||[]);else a._log.warn("Unknown message type: ",e.type)})),Array.from(a._trackSidsToRenderHints.keys()).forEach((function(e){var t=a._trackSidsToRenderHints.get(e);t.renderDimensions&&(t.isDimensionDirty=!0),"enabled"in t&&(t.isEnabledDirty=!0)})),a._sendHints()})),a}return l(RenderHintsSignaling,e),RenderHintsSignaling.prototype._processHintResults=function(e){var t=this;this._isResponsePending=!1,e.forEach((function(e){"OK"!==e.result&&t._log.debug("Server error processing hint:",e)})),this._sendHints()},RenderHintsSignaling.prototype._sendHints=function(){var e=this;if(this._transport&&!this._isResponsePending){var t=[];if(Array.from(this._trackSidsToRenderHints.keys()).forEach((function(n){var a=e._trackSidsToRenderHints.get(n);if(a.isEnabledDirty||a.isDimensionDirty){var l={track:n};a.isEnabledDirty&&(l.enabled=a.enabled,a.isEnabledDirty=!1),a.isDimensionDirty&&(l.render_dimensions=a.renderDimensions,a.isDimensionDirty=!1),t.push(l)}})),t.length>0){var n={type:"render_hints",subscriber:{id:h++,hints:t}};this._log.debug("Outgoing: ",n),this._transport.publish(n),this._isResponsePending=!0}}},RenderHintsSignaling.prototype.setTrackHint=function(e,t){var n=this._trackSidsToRenderHints.get(e)||{isEnabledDirty:!1,isDimensionDirty:!1};"enabled"in t&&n.enabled!==t.enabled&&(n.enabled=!!t.enabled,n.isEnabledDirty=!0),t.renderDimensions&&!p(t.renderDimensions,n.renderDimensions)&&(n.renderDimensions=t.renderDimensions,n.isDimensionDirty=!0),this._trackSidsToRenderHints.set(e,n),this._sendHints()},RenderHintsSignaling.prototype.clearTrackHint=function(e){this._trackSidsToRenderHints.delete(e)},RenderHintsSignaling}(f);e.exports=m},4803:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},p=n(8869),h=n(6202),m=n(597),g=n(8022),v=n(3178),y=n(4273),_=n(2340),b=n(799),C=n(8054),S=n(6714),k=n(6971),w=k.constants.DEFAULT_SESSION_TIMEOUT_SEC,T=k.createBandwidthProfilePayload,P=k.defer,A=k.difference,M=k.filterObject,x=k.flatMap,O=k.oncePerTick,R=n(9576),I=n(8144).createTwilioError,L=function(e){function RoomV2(t,n,a,l,f){var v=this;n.options=Object.assign({session_timeout:w},n.options),f=Object.assign({DominantSpeakerSignaling:p,NetworkQualityMonitor:h,NetworkQualitySignaling:m,RecordingSignaling:g,RemoteParticipantV2:y,TrackPrioritySignaling:b,TrackSwitchOffSignaling:C,bandwidthProfile:null,sessionTimeout:1e3*n.options.session_timeout,statsPublishIntervalMs:1e4},f),t.setBandwidthProfile(f.bandwidthProfile),l.setIceReconnectTimeout(f.sessionTimeout);var getTrackReceiver=function(e){return v._getTrackReceiver(e)},k=(v=e.call(this,t,n.sid,n.name,f)||this)._log;return Object.defineProperties(v,{_disconnectedParticipantRevisions:{value:new Map},_NetworkQualityMonitor:{value:f.NetworkQualityMonitor},_lastBandwidthProfileRevision:{value:t.bandwidthProfileRevision,writable:!0},_networkQualityMonitor:{value:null,writable:!0},_networkQualityConfiguration:{value:t.networkQualityConfiguration},_peerConnectionManager:{value:l},_published:{value:new Map},_publishedRevision:{value:0,writable:!0},_RemoteParticipantV2:{value:f.RemoteParticipantV2},_subscribed:{value:new Map},_subscribedRevision:{value:0,writable:!0},_subscriptionFailures:{value:new Map},_dominantSpeakerSignaling:{value:new f.DominantSpeakerSignaling(getTrackReceiver,{log:k})},_networkQualitySignaling:{value:new f.NetworkQualitySignaling(getTrackReceiver,t.networkQualityConfiguration,{log:k})},_renderHintsSignaling:{value:new S(getTrackReceiver,{log:k})},_trackPrioritySignaling:{value:new f.TrackPrioritySignaling(getTrackReceiver,{log:k})},_trackSwitchOffSignaling:{value:new f.TrackSwitchOffSignaling(getTrackReceiver,{log:k})},_pendingSwitchOffStates:{value:new Map},_transport:{value:a},_trackReceiverDeferreds:{value:new Map},mediaRegion:{enumerable:!0,value:n.options.media_region||null}}),v._initTrackSwitchOffSignaling(),v._initDominantSpeakerSignaling(),v._initNetworkQualityMonitorSignaling(),function handleLocalParticipantEvents(e,t){var n=O((function(){e._publishNewLocalParticipantState()})),a=O((function(){var n=x(t.tracks,(function(e){return e.trackTransceiver}));e._peerConnectionManager.setTrackSenders(n)}));t.on("trackAdded",a),t.on("trackRemoved",a),t.on("updated",n),e.on("stateChanged",(function stateChanged(l){"disconnected"===l&&(t.removeListener("trackAdded",a),t.removeListener("trackRemoved",a),t.removeListener("updated",n),e.removeListener("stateChanged",stateChanged),t.disconnect())})),e.on("signalingConnectionStateChanged",(function(){var t=e.localParticipant,n=e.signalingConnectionState,a=t.identity,l=t.sid;switch(n){case"connected":t.connect(l,a);break;case"reconnecting":t.reconnecting()}}))}(v,t),function handlePeerConnectionEvents(e,t){t.on("description",(function onDescription(t){e._publishPeerConnectionState(t)})),t.dequeue("description"),t.on("candidates",(function onCandidates(t){e._publishPeerConnectionState(t)})),t.dequeue("candidates"),t.on("trackAdded",e._addTrackReceiver.bind(e)),t.dequeue("trackAdded"),t.getTrackReceivers().forEach(e._addTrackReceiver,e),t.on("connectionStateChanged",(function(){e.emit("connectionStateChanged")})),t.on("iceConnectionStateChanged",(function(){e.emit("iceConnectionStateChanged"),"failed"===e.iceConnectionState&&(null!==e.localParticipant.networkQualityLevel&&e.localParticipant.setNetworkQualityLevel(0),e.participants.forEach((function(e){null!==e.networkQualityLevel&&e.setNetworkQualityLevel(0)})))}))}(v,l),function handleTransportEvents(e,t){t.on("message",e._update.bind(e)),t.on("stateChanged",(function stateChanged(n,a){"disconnected"===n&&("disconnected"!==e.state&&e._disconnect(a),t.removeListener("stateChanged",stateChanged)),e.emit("signalingConnectionStateChanged")}))}(v,a),function periodicallyPublishStats(e,t,n){var a=new Map,l=!1,f=setInterval((function(){e.getStats().then((function(e){l=!l,e.forEach((function(e,n){var f=new _(n,e,!0);t.publishEvent("quality","stats-report","info",{audioTrackStats:f.remoteAudioTrackStats.map((function(t,n){return addAVSyncMetricsToRemoteTrackStats(t,e.remoteAudioTrackStats[n],a)})),localAudioTrackStats:f.localAudioTrackStats.map((function(t,n){return addAVSyncMetricsToLocalTrackStats(t,e.localAudioTrackStats[n],a)})),localVideoTrackStats:f.localVideoTrackStats.map((function(t,n){return addAVSyncMetricsToLocalTrackStats(t,e.localVideoTrackStats[n],a)})),peerConnectionId:f.peerConnectionId,videoTrackStats:f.remoteVideoTrackStats.map((function(t,n){return addAVSyncMetricsToRemoteTrackStats(t,e.remoteVideoTrackStats[n],a)}))});var p=x(["localAudioTrackStats","localVideoTrackStats","remoteAudioTrackStats","remoteVideoTrackStats"],(function(e){return f[e].map((function(e){var t=e.ssrc;return e.trackSid+"+"+t}))}));if(A(Array.from(a.keys()),p).forEach((function(e){return a.delete(e)})),l){var h=function replaceNullsWithDefaults(e,t){return(e=Object.assign({availableIncomingBitrate:0,availableOutgoingBitrate:0,bytesReceived:0,bytesSent:0,consentRequestsSent:0,currentRoundTripTime:0,lastPacketReceivedTimestamp:0,lastPacketSentTimestamp:0,nominated:!1,peerConnectionId:t,priority:0,readable:!1,requestsReceived:0,requestsSent:0,responsesReceived:0,responsesSent:0,retransmissionsReceived:0,retransmissionsSent:0,state:"failed",totalRoundTripTime:0,transportId:"",writable:!1},M(e||{},null))).localCandidate=Object.assign({candidateType:"host",deleted:!1,ip:"",port:0,priority:0,protocol:"udp",url:""},M(e.localCandidate||{},null)),e.remoteCandidate=Object.assign({candidateType:"host",ip:"",port:0,priority:0,protocol:"udp",url:""},M(e.remoteCandidate||{},null)),e}(e.activeIceCandidatePair,f.peerConnectionId);t.publishEvent("quality","active-ice-candidate-pair","info",h)}}))}),(function(){}))}),n);e.on("stateChanged",(function onStateChanged(t){"disconnected"===t&&(clearInterval(f),e.removeListener("stateChanged",onStateChanged))}))}(v,a,f.statsPublishIntervalMs),v._update(n),v}return l(RoomV2,e),Object.defineProperty(RoomV2.prototype,"connectionState",{get:function(){return this._peerConnectionManager.connectionState},enumerable:!1,configurable:!0}),Object.defineProperty(RoomV2.prototype,"signalingConnectionState",{get:function(){return"syncing"===this._transport.state?"reconnecting":this._transport.state},enumerable:!1,configurable:!0}),Object.defineProperty(RoomV2.prototype,"iceConnectionState",{get:function(){return this._peerConnectionManager.iceConnectionState},enumerable:!1,configurable:!0}),RoomV2.prototype._deleteTrackReceiverDeferred=function(e){return this._trackReceiverDeferreds.delete(e)},RoomV2.prototype._getOrCreateTrackReceiverDeferred=function(e){var t=this._trackReceiverDeferreds.get(e)||P(),n=this._peerConnectionManager.getTrackReceivers().find((function(t){return t.id===e&&"ended"!==t.readyState}));return n?t.resolve(n):this._trackReceiverDeferreds.set(e,t),t},RoomV2.prototype._addTrackReceiver=function(e){return this._getOrCreateTrackReceiverDeferred(e.id).resolve(e),this},RoomV2.prototype._disconnect=function(t){var n=e.prototype._disconnect.call(this,t);return n&&(this._teardownNetworkQualityMonitor(),this._transport.disconnect(),this._peerConnectionManager.close()),this.localParticipant.tracks.forEach((function(e){e.publishFailed(t||new Error("LocalParticipant disconnected"))})),n},RoomV2.prototype._getTrackReceiver=function(e){var t=this;return this._getOrCreateTrackReceiverDeferred(e).promise.then((function(n){return t._deleteTrackReceiverDeferred(e),n}))},RoomV2.prototype._getInitialTrackSwitchOffState=function(e){var t=this._pendingSwitchOffStates.get(e)||!1;return this._pendingSwitchOffStates.delete(e),t&&this._log.warn("["+e+"] was initially switched off! "),t},RoomV2.prototype._getTrackSidsToTrackSignalings=function(){var e=x(this.participants,(function(e){return Array.from(e.tracks)}));return new Map(e)},RoomV2.prototype._getOrCreateRemoteParticipant=function(e){var t=this,n=this._RemoteParticipantV2,a=this.participants.get(e.sid),l=this;return a||((a=new n(e,(function(e){return t._getInitialTrackSwitchOffState(e)}),(function(e,n){return t._trackPrioritySignaling.sendTrackPriorityUpdate(e,"subscribe",n)}),(function(e,n){return t._renderHintsSignaling.setTrackHint(e,n)}),(function(e){return t._renderHintsSignaling.clearTrackHint(e)}))).on("stateChanged",(function stateChanged(e){"disconnected"===e&&(a.removeListener("stateChanged",stateChanged),l.participants.delete(a.sid),l._disconnectedParticipantRevisions.set(a.sid,a.revision))})),this.connectParticipant(a)),a},RoomV2.prototype._getState=function(){return{participant:this.localParticipant.getState()}},RoomV2.prototype._maybeAddBandwidthProfile=function(e){var t=this.localParticipant,n=t.bandwidthProfile,a=t.bandwidthProfileRevision;return n&&this._lastBandwidthProfileRevision<a?(this._lastBandwidthProfileRevision=a,Object.assign({bandwidth_profile:T(n)},e)):e},RoomV2.prototype._publishNewLocalParticipantState=function(){this._transport.publish(this._maybeAddBandwidthProfile(this._getState()))},RoomV2.prototype._publishPeerConnectionState=function(e){this._transport.publish(Object.assign({peer_connections:[e]},this._getState()))},RoomV2.prototype._update=function(e){var t=this;if(e.subscribed&&e.subscribed.revision>this._subscribedRevision){this._subscribedRevision=e.subscribed.revision,e.subscribed.tracks.forEach((function(e){e.id?(t._subscriptionFailures.delete(e.sid),t._subscribed.set(e.sid,e.id)):e.error&&!t._subscriptionFailures.has(e.sid)&&t._subscriptionFailures.set(e.sid,e.error)}));var n=new Set(e.subscribed.tracks.filter((function(e){return!!e.id})).map((function(e){return e.sid})));this._subscribed.forEach((function(e,a){n.has(a)||t._subscribed.delete(a)}))}var a=new Set;return(e.participants||[]).forEach((function(e){if(e.sid!==t.localParticipant.sid){var n=t._disconnectedParticipantRevisions.get(e.sid);if(!(n&&e.revision<=n)){n&&t._disconnectedParticipantRevisions.delete(e.sid);var l=t._getOrCreateRemoteParticipant(e);l.update(e),a.add(l)}}})),"synced"===e.type&&this.participants.forEach((function(e){a.has(e)||e.disconnect()})),function handleSubscriptions(e){var t=e._getTrackSidsToTrackSignalings();e._subscriptionFailures.forEach((function(n,a){var l=t.get(a);l&&(e._subscriptionFailures.delete(a),l.subscribeFailed(I(n.code,n.message)))})),t.forEach((function(t){var n=e._subscribed.get(t.sid);(!n||t.isSubscribed&&t.trackTransceiver.id!==n)&&t.setTrackTransceiver(null),n&&e._getTrackReceiver(n).then((function(e){return t.setTrackTransceiver(e)}))}))}(this),e.peer_connections&&this._peerConnectionManager.update(e.peer_connections,"synced"===e.type),e.recording&&this.recording.update(e.recording),e.published&&e.published.revision>this._publishedRevision&&(this._publishedRevision=e.published.revision,e.published.tracks.forEach((function(e){e.sid&&t._published.set(e.id,e.sid)})),this.localParticipant.update(e.published)),e.participant&&this.localParticipant.connect(e.participant.sid,e.participant.identity),[this._dominantSpeakerSignaling,this._networkQualitySignaling,this._trackPrioritySignaling,this._trackSwitchOffSignaling,this._renderHintsSignaling].forEach((function(t){var n=t.channel;!t.isSetup&&e.media_signaling&&e.media_signaling[n]&&e.media_signaling[n].transport&&"data-channel"===e.media_signaling[n].transport.type&&t.setup(e.media_signaling[n].transport.label)})),this},RoomV2.prototype._initTrackSwitchOffSignaling=function(){var e=this;this._trackSwitchOffSignaling.on("updated",(function(t,n){try{e._log.debug("received trackSwitch: ",{tracksOn:n,tracksOff:t});var a=new Map;n.forEach((function(e){return a.set(e,!0)})),t.forEach((function(t){a.get(t)&&e._log.warn(t+" is DUPLICATED in both tracksOff and tracksOn list"),a.set(t,!1)})),e.participants.forEach((function(e){e.tracks.forEach((function(e){var t=a.get(e.sid);void 0!==t&&(e.setSwitchedOff(!t),a.delete(e.sid))}))})),a.forEach((function(t,n){return e._pendingSwitchOffStates.set(n,!t)}))}catch(l){e._log.error("error processing track switch off:",l)}}))},RoomV2.prototype._initDominantSpeakerSignaling=function(){var e=this;this._dominantSpeakerSignaling.on("updated",(function(){return e.setDominantSpeaker(e._dominantSpeakerSignaling.loudestParticipantSid)}))},RoomV2.prototype._initNetworkQualityMonitorSignaling=function(){var e=this;this._networkQualitySignaling.on("ready",(function(){var t=new e._NetworkQualityMonitor(e._peerConnectionManager,e._networkQualitySignaling);e._networkQualityMonitor=t,t.on("updated",(function(){"failed"!==e.iceConnectionState&&(e.localParticipant.setNetworkQualityLevel(t.level,t.levels),e.participants.forEach((function(e){var n=t.remoteLevels.get(e.sid);n&&e.setNetworkQualityLevel(n.level,n)})))})),t.start()})),this._networkQualitySignaling.on("teardown",(function(){return e._teardownNetworkQualityMonitor()}))},RoomV2.prototype._teardownNetworkQualityMonitor=function(){this._networkQualityMonitor&&(this._networkQualityMonitor.stop(),this._networkQualityMonitor=null)},RoomV2.prototype.getStats=function(){var e=this;return this._peerConnectionManager.getStats().then((function(t){return new Map(Array.from(t).map((function(t){var n=f(t,2),a=n[0],l=n[1];return[a,Object.assign({},l,{localAudioTrackStats:filterAndAddLocalTrackSids(e,l.localAudioTrackStats),localVideoTrackStats:filterAndAddLocalTrackSids(e,l.localVideoTrackStats),remoteAudioTrackStats:filterAndAddRemoteTrackSids(e,l.remoteAudioTrackStats),remoteVideoTrackStats:filterAndAddRemoteTrackSids(e,l.remoteVideoTrackStats)})]})))}))},RoomV2}(v);function filterAndAddTrackSids(e,t){return t.reduce((function(t,n){var a=e.get(n.trackId);return a?[Object.assign({},n,{trackSid:a})].concat(t):t}),[])}function filterAndAddLocalTrackSids(e,t){return filterAndAddTrackSids(e._published,t)}function filterAndAddRemoteTrackSids(e,t){var n=new Map(Array.from(e._subscribed.entries()).map((function(e){var t=f(e,2),n=t[0];return[t[1],n]})));return filterAndAddTrackSids(n,t)}function addAVSyncMetricsToLocalTrackStats(e,t,n){var a=t.framesEncoded,l=t.packetsSent,f=t.totalEncodeTime,p=t.totalPacketSendDelay,h=Object.assign({},e),m=e.trackSid+"+"+e.ssrc,g=n.get(m)||new Map;if("number"==typeof f&&"number"==typeof a){var v=g.get("avgEncodeDelay")||new R;v.putSample(1e3*f,a),h.avgEncodeDelay=Math.round(v.get()),g.set("avgEncodeDelay",v)}if("number"==typeof p&&"number"==typeof l){var y=g.get("avgPacketSendDelay")||new R;y.putSample(1e3*p,l),h.avgPacketSendDelay=Math.round(y.get()),g.set("avgPacketSendDelay",y)}return n.set(m,g),h}function addAVSyncMetricsToRemoteTrackStats(e,t,n){var a=t.estimatedPlayoutTimestamp,l=t.framesDecoded,f=t.jitterBufferDelay,p=t.jitterBufferEmittedCount,h=t.totalDecodeTime,m=Object.assign({},e),g=e.trackSid+"+"+e.ssrc,v=n.get(g)||new Map;if("number"==typeof a&&(m.estimatedPlayoutTimestamp=a),"number"==typeof l&&"number"==typeof h){var y=v.get("avgDecodeDelay")||new R;y.putSample(1e3*h,l),m.avgDecodeDelay=Math.round(y.get()),v.set("avgDecodeDelay",y)}if("number"==typeof f&&"number"==typeof p){var _=v.get("avgJitterBufferDelay")||new R;_.putSample(1e3*f,p),m.avgJitterBufferDelay=Math.round(_.get()),v.set("avgJitterBufferDelay",_)}return n.set(g,v),m}e.exports=L},799:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function TrackPrioritySignaling(t,n){var a=e.call(this,t,"track_priority",n)||this;return Object.defineProperties(a,{_enqueuedPriorityUpdates:{value:new Map}}),a.on("ready",(function(e){Array.from(a._enqueuedPriorityUpdates.keys()).forEach((function(t){e.publish({type:"track_priority",track:t,subscribe:a._enqueuedPriorityUpdates.get(t)})}))})),a}return l(TrackPrioritySignaling,e),TrackPrioritySignaling.prototype.sendTrackPriorityUpdate=function(e,t,n){if("subscribe"!==t)throw new Error("only subscribe priorities are supported, found: "+t);this._enqueuedPriorityUpdates.set(e,n),this._transport&&this._transport.publish({type:"track_priority",track:e,subscribe:n})},TrackPrioritySignaling}(n(1014));e.exports=f},8054:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function TrackSwitchOffSignaling(t,n){var a=e.call(this,t,"track_switch_off",n)||this;return a.on("ready",(function(e){e.on("message",(function(e){if("track_switch_off"===e.type)a._setTrackSwitchOffUpdates(e.off||[],e.on||[])}))})),a}return l(TrackSwitchOffSignaling,e),TrackSwitchOffSignaling.prototype._setTrackSwitchOffUpdates=function(e,t){this.emit("updated",e,t)},TrackSwitchOffSignaling}(n(1014));e.exports=f},1722:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(1406).getSdpFormat,p=n(3122),h=n(4670),m=n(5144),g=n(2097).reconnectBackoffConfig,v=n(5317),y=n(2097),_=y.SDK_NAME,b=y.SDK_VERSION,C=n(6971),S=C.createBandwidthProfilePayload,k=C.createMediaSignalingPayload,w=C.createSubscribePayload,T=C.getUserAgent,P=C.isNonArrayObject,A=n(8144),M=A.createTwilioError,x=A.RoomCompletedError,O=A.SignalingConnectionError,R=A.SignalingServerBusyError,I={connecting:["connected","disconnected"],connected:["disconnected","syncing"],syncing:["connected","disconnected"],disconnected:[]},L=function(e){function TwilioConnectionTransport(t,n,a,l,p,v){var y;return v=Object.assign({Backoff:m,TwilioConnection:h,iceServers:null,sdpFormat:f(v.sdpSemantics),trackPriority:!0,trackSwitchOff:!0,renderHints:!0,userAgent:T()},v),y=e.call(this,"connecting",I)||this,Object.defineProperties(y,{_accessToken:{value:n},_automaticSubscription:{value:v.automaticSubscription},_bandwidthProfile:{value:v.bandwidthProfile},_dominantSpeaker:{value:v.dominantSpeaker},_eventObserver:{value:v.eventObserver,writable:!1},_renderHints:{value:v.renderHints},_iceServersStatus:{value:Array.isArray(v.iceServers)?"overrode":"acquire"},_localParticipant:{value:a},_name:{value:t},_networkQuality:{value:P(v.networkQuality)||v.networkQuality},_options:{value:v},_peerConnectionManager:{value:l},_sessionTimer:{value:null,writable:!0},_sessionTimeoutMS:{value:0,writable:!0},_reconnectBackoff:{value:v.Backoff.exponential(g)},_session:{value:null,writable:!0},_trackPriority:{value:v.trackPriority},_trackSwitchOff:{value:v.trackSwitchOff},_twilioConnection:{value:null,writable:!0},_updatesReceived:{value:[]},_updatesToSend:{value:[]},_userAgent:{value:v.userAgent},_wsServer:{value:p}}),function setupTransport(e){function createOrResetTwilioConnection(){if("disconnected"!==e.state){e._twilioConnection&&e._twilioConnection.removeListener("message",handleMessage);var t=e._iceServersStatus,n=e._options,a=e._wsServer,l=e.state,f=n.TwilioConnection,p=new f(a,Object.assign({helloBody:"connecting"===l&&"acquire"===t?e._createIceMessage():e._createConnectOrSyncOrDisconnectMessage()},n));p.once("close",(function(e){e===f.CloseReason.LOCAL?disconnect():disconnect(new Error(e))})),p.on("message",handleMessage),e._twilioConnection=p}}function disconnect(t){if("disconnected"!==e.state)if(t){var n=e._getReconnectTimer();if(n)"connected"===e.state&&e.preempt("syncing"),n.then(createOrResetTwilioConnection);else{var a=t.message===h.CloseReason.BUSY?new R:new O;e.disconnect(a)}}else e.disconnect()}function handleMessage(t){if("disconnected"!==e.state)if("error"!==t.type)switch(e.state){case"connected":switch(t.type){case"connected":case"synced":case"update":return void e.emit("message",t);case"disconnected":return void e.disconnect("completed"===t.status?new x:null);default:return}case"connecting":switch(t.type){case"iced":return void e._options.onIced(t.ice_servers).then((function(){e._sendConnectOrSyncOrDisconnectMessage()}));case"connected":return e._setSession(t.session,t.options.session_timeout),e.emit("connected",t),void e.preempt("connected");case"synced":case"update":return void e._updatesReceived.push(t);case"disconnected":return void e.disconnect("completed"===t.status?new x:null);default:return}case"syncing":switch(t.type){case"connected":case"update":return void e._updatesReceived.push(t);case"synced":return e._clearReconnectTimer(),e.emit("message",t),void e.preempt("connected");case"disconnected":return void e.disconnect("completed"===t.status?new x:null);default:return}default:return}else e.disconnect(M(t.code,t.message))}e.on("stateChanged",(function stateChanged(t){switch(t){case"connected":var n=e._updatesToSend.splice(0);return n.length&&e.publish(function reduceUpdates(e){return e.reduce((function(e,t){return(!e.participant&&t.participant||e.participant&&t.participant&&t.participant.revision>e.participant.revision)&&(e.participant=t.participant),!e.peer_connections&&t.peer_connections?e.peer_connections=reducePeerConnections(t.peer_connections):e.peer_connections&&t.peer_connections&&(e.peer_connections=reducePeerConnections(e.peer_connections.concat(t.peer_connections))),e}),{})}(n)),void e._updatesReceived.splice(0).forEach((function(t){return e.emit("message",t)}));case"disconnected":return e._twilioConnection.removeListener("message",handleMessage),void e.removeListener("stateChanged",stateChanged);default:return}}));var t=e._options,n=e._iceServersStatus,a=t.iceServers,l=t.onIced;"overrode"===n?l(a).then(createOrResetTwilioConnection):createOrResetTwilioConnection()}(y),y}return l(TwilioConnectionTransport,e),TwilioConnectionTransport.prototype._createConnectOrSyncOrDisconnectMessage=function(){if("connected"===this.state)return null;if("disconnected"===this.state)return{session:this._session,type:"disconnect",version:2};var e={connecting:"connect",syncing:"sync"}[this.state],t={name:this._name,participant:this._localParticipant.getState(),peer_connections:this._peerConnectionManager.getStates(),type:e,version:2};if("connect"===t.type){t.ice_servers=this._iceServersStatus,t.publisher={name:_,sdk_version:b,user_agent:this._userAgent},this._bandwidthProfile&&(t.bandwidth_profile=S(this._bandwidthProfile)),t.media_signaling=k(this._dominantSpeaker,this._networkQuality,this._trackPriority,this._trackSwitchOff,this._renderHints),t.subscribe=w(this._automaticSubscription);var n=this._options.sdpFormat;n&&(t.format=n),t.token=this._accessToken}else"sync"===t.type?(t.session=this._session,t.token=this._accessToken):"update"===t.type&&(t.session=this._session);return t},TwilioConnectionTransport.prototype._createIceMessage=function(){return{edge:"roaming",token:this._accessToken,type:"ice",version:1}},TwilioConnectionTransport.prototype._sendConnectOrSyncOrDisconnectMessage=function(){var e=this._createConnectOrSyncOrDisconnectMessage();e&&this._twilioConnection.sendMessage(e)},TwilioConnectionTransport.prototype.disconnect=function(e){return"disconnected"!==this.state&&(this.preempt("disconnected",null,[e]),this._sendConnectOrSyncOrDisconnectMessage(),this._twilioConnection.close(),!0)},TwilioConnectionTransport.prototype.publish=function(e){switch(this.state){case"connected":return this._twilioConnection.sendMessage(Object.assign({session:this._session,type:"update",version:2},e)),!0;case"connecting":case"syncing":return this._updatesToSend.push(e),!0;default:return!1}},TwilioConnectionTransport.prototype.publishEvent=function(e,t,n,a){this._eventObserver.emit("event",{group:e,name:t,level:n,payload:a})},TwilioConnectionTransport.prototype.sync=function(){return"connected"===this.state&&(this.preempt("syncing"),this._sendConnectOrSyncOrDisconnectMessage(),!0)},TwilioConnectionTransport.prototype._setSession=function(e,t){this._session=e,this._sessionTimeoutMS=1e3*t},TwilioConnectionTransport.prototype._getReconnectTimer=function(){var e=this;return 0===this._sessionTimeoutMS?null:(this._sessionTimer||(this._sessionTimer=new v((function(){e._sessionTimer&&(e._sessionTimeoutMS=0)}),this._sessionTimeoutMS)),new Promise((function(t){e._reconnectBackoff.once("ready",t),e._reconnectBackoff.backoff()})))},TwilioConnectionTransport.prototype._clearReconnectTimer=function(){this._reconnectBackoff.reset(),this._sessionTimer&&(this._sessionTimer.clear(),this._sessionTimer=null)},TwilioConnectionTransport}(p);function reducePeerConnections(e){return Array.from(e.reduce((function(e,t){var n=e.get(t.id)||t;return(!n.description&&t.description||n.description&&t.description&&t.description.revision>n.description.revision)&&(n.description=t.description),(!n.ice&&t.ice||n.ice&&t.ice&&t.ice.revision>n.ice.revision)&&(n.ice=t.ice),e.set(n.id,n),e}),new Map).values())}e.exports=L},3122:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},p=this&&this.__spreadArray||function(e,t){for(var n=0,a=t.length,l=e.length;n<a;n++,l++)e[l]=t[n];return e},h=n(7187).EventEmitter,m=n(6971),g=function(e){function StateMachine(t,n){var a,l=e.call(this)||this,f=null,p=t;return n=function transformStates(e){var t=new Map;for(var n in e)t.set(n,new Set(e[n]));return t}(n),Object.defineProperties(l,{_lock:{get:function(){return f},set:function(e){f=e}},_reachableStates:{value:(a=n,Array.from(a.keys()).reduce((function(e,t){return e.set(t,reachableFrom(a,t))}),new Map))},_state:{get:function(){return p},set:function(e){p=e}},_states:{value:n},_whenDeferreds:{value:new Set},isLocked:{enumerable:!0,get:function(){return null!==f}},state:{enumerable:!0,get:function(){return p}}}),l.on("stateChanged",(function(e){l._whenDeferreds.forEach((function(t){t.when(e,t.resolve,t.reject)}))})),l}return l(StateMachine,e),StateMachine.prototype._whenPromise=function(e){var t=this;if("function"!=typeof e)return Promise.reject(new Error("when() executor must be a function"));var n=m.defer();return n.when=e,this._whenDeferreds.add(n),n.promise.then((function(e){return t._whenDeferreds.delete(n),e}),(function(e){throw t._whenDeferreds.delete(n),e}))},StateMachine.prototype.bracket=function(e,t){var n,a=this;function releaseLock(e){if(a.hasLock(n)&&a.releaseLockCompletely(n),e)throw e}return this.takeLock(e).then((function gotKey(e){return t(n=e)})).then((function success(e){return releaseLock(),e}),releaseLock)},StateMachine.prototype.hasLock=function(e){return this._lock===e},StateMachine.prototype.preempt=function(e,t,n){if(!isValidTransition(this._states,this.state,e))throw new Error('Cannot transition from "'+this.state+'" to "'+e+'"');var a;this.isLocked&&(a=this._lock,this._lock=null);var l=null;t&&(l=this.takeLockSync(t));var f=l?null:this.takeLockSync("preemption");return this.transition(e,l||f,n),a&&a.resolve(),f&&this.releaseLock(f),l},StateMachine.prototype.releaseLock=function(e){if(!this.isLocked)throw new Error("Could not release the lock for "+e.name+" because the StateMachine is not locked");if(!this.hasLock(e))throw new Error("Could not release the lock for "+e.name+" because "+this._lock.name+" has the lock");0===e.depth?(this._lock=null,e.resolve()):e.depth--},StateMachine.prototype.releaseLockCompletely=function(e){if(!this.isLocked)throw new Error("Could not release the lock for "+e.name+" because the StateMachine is not locked");if(!this.hasLock(e))throw new Error("Could not release the lock for "+e.name+" because "+this._lock.name+" has the lock");e.depth=0,this._lock=null,e.resolve()},StateMachine.prototype.takeLock=function(e){var t=this;if("object"==typeof e){var n=e;return new Promise((function(e){e(t.takeLockSync(n))}))}var a=e;if(this.isLocked){var l=this.takeLock.bind(this,a);return this._lock.promise.then(l)}return Promise.resolve(this.takeLockSync(a))},StateMachine.prototype.takeLockSync=function(e){var t="string"==typeof e?null:e,n=t?t.name:e;if(t&&!this.hasLock(t)||!t&&this.isLocked)throw new Error("Could not take the lock for "+n+" because the lock for "+this._lock.name+" was not released");if(t)return t.depth++,t;var a=function makeLock(e){var t=m.defer();return t.name=e,t.depth=0,t}(n);return this._lock=a,a},StateMachine.prototype.transition=function(e,t,n){if(n=n||[],this.isLocked){if(!t)throw new Error("You must provide the key in order to transition");if(!this.hasLock(t))throw new Error("Could not transition using the key for "+t.name+" because "+this._lock.name+" has the lock")}else if(t)throw new Error("Key provided for "+t.name+", but the StateMachine was not locked (possibly due to preemption)");if(!isValidTransition(this._states,this.state,e))throw new Error('Cannot transition from "'+this.state+'" to "'+e+'"');this._state=e,this.emit.apply(this,p([],f(["stateChanged",e].concat(n))))},StateMachine.prototype.tryTransition=function(e,t,n){try{this.transition(e,t,n)}catch(a){return!1}return!0},StateMachine.prototype.when=function(e){var t=this;return this.state===e?Promise.resolve(this):isValidTransition(this._reachableStates,this.state,e)?this._whenPromise((function(n,a,l){n===e?a(t):isValidTransition(t._reachableStates,n,e)||l(createUnreachableError(n,e))})):Promise.reject(createUnreachableError(this.state,e))},StateMachine}(h);function isValidTransition(e,t,n){return e.get(t).has(n)}function reachableFrom(e,t,n){return n=n||new Set,e.get(t).forEach((function(t){n.has(t)||(n.add(t),reachableFrom(e,t,n).forEach(n.add,n))})),n}function createUnreachableError(e,t){return new Error('"'+t+'" cannot be reached from "'+e+'"')}e.exports=g},9462:function(e){"use strict";e.exports=function average(e){return(e=e.filter((function(e){return"number"==typeof e}))).length<1?void 0:e.reduce((function(e,t){return t+e}))/e.length}},6054:function(e){"use strict";var t=function(){function IceReport(e,t,n,a){Object.defineProperties(this,{availableSend:{enumerable:!0,value:n},recv:{enumerable:!0,value:t},rtt:{enumerable:!0,value:a},send:{enumerable:!0,value:e}})}return IceReport.of=function(e,t){var n=(t.timestamp-e.timestamp)/1e3,a=t.bytesSent-e.bytesSent,l=t.bytesReceived-e.bytesReceived;return new IceReport(n>0?a/n*8:0,n>0?l/n*8:0,t.availableOutgoingBitrate,t.currentRoundTripTime)},IceReport}();e.exports=t},1409:function(e,t,n){"use strict";var a=n(6054),l=function(){function IceReportFactory(){Object.defineProperties(this,{lastReport:{enumerable:!0,value:new a(0,0),writable:!0},lastStats:{enumerable:!0,value:null,writable:!0}})}return IceReportFactory.prototype.next=function(e){var t=this.lastStats;if(this.lastStats=e,t){var n=t.id===e.id?a.of(t,e):new a(0,0);this.lastReport=n}return this.lastReport},IceReportFactory}();e.exports=l},741:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function LocalAudioTrackStats(t,n,a){var l=e.call(this,t,n,a)||this;return Object.defineProperties(l,{audioLevel:{value:"number"==typeof n.audioInputLevel?n.audioInputLevel:null,enumerable:!0},jitter:{value:"number"==typeof n.jitter?n.jitter:null,enumerable:!0}}),l}return l(LocalAudioTrackStats,e),LocalAudioTrackStats}(n(6643));e.exports=f},6643:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function LocalTrackStats(t,n,a){var l=e.call(this,t,n)||this;return Object.defineProperties(l,{bytesSent:{value:"number"==typeof n.bytesSent?n.bytesSent:a?0:null,enumerable:!0},packetsSent:{value:"number"==typeof n.packetsSent?n.packetsSent:a?0:null,enumerable:!0},roundTripTime:{value:"number"==typeof n.roundTripTime?n.roundTripTime:a?0:null,enumerable:!0}}),l}return l(LocalTrackStats,e),LocalTrackStats}(n(6498));e.exports=f},6872:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function LocalVideoTrackStats(t,n,a){var l=e.call(this,t,n,a)||this,f=null;"number"==typeof n.frameWidthInput&&"number"==typeof n.frameHeightInput&&(f={},Object.defineProperties(f,{width:{value:n.frameWidthInput,enumerable:!0},height:{value:n.frameHeightInput,enumerable:!0}}));var p=null;return"number"==typeof n.frameWidthSent&&"number"==typeof n.frameHeightSent&&(p={},Object.defineProperties(p,{width:{value:n.frameWidthSent,enumerable:!0},height:{value:n.frameHeightSent,enumerable:!0}})),Object.defineProperties(l,{captureDimensions:{value:f,enumerable:!0},dimensions:{value:p,enumerable:!0},captureFrameRate:{value:"number"==typeof n.frameRateInput?n.frameRateInput:null,enumerable:!0},frameRate:{value:"number"==typeof n.frameRateSent?n.frameRateSent:null,enumerable:!0}}),l}return l(LocalVideoTrackStats,e),LocalVideoTrackStats}(n(6643));e.exports=f},9521:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function NetworkQualityAudioStats(t){return e.call(this,t)||this}return l(NetworkQualityAudioStats,e),NetworkQualityAudioStats}(n(8310));e.exports=f},6095:function(e){"use strict";var t=function t(e){var t=e.actual,n=void 0===t?null:t,a=e.available,l=void 0===a?null:a,f=e.level,p=void 0===f?null:f;Object.defineProperties(this,{actual:{value:n,enumerable:!0},available:{value:l,enumerable:!0},level:{value:p,enumerable:!0}})};e.exports=t},9249:function(e){"use strict";var t=function t(e){var t=e.fractionLost,n=void 0===t?null:t,a=e.level,l=void 0===a?null:a;Object.defineProperties(this,{fractionLost:{value:n,enumerable:!0},level:{value:l,enumerable:!0}})};e.exports=t},7689:function(e){"use strict";var t=function t(e){var t=e.jitter,n=void 0===t?null:t,a=e.rtt,l=void 0===a?null:a,f=e.level,p=void 0===f?null:f;Object.defineProperties(this,{jitter:{value:n,enumerable:!0},rtt:{value:l,enumerable:!0},level:{value:p,enumerable:!0}})};e.exports=t},8310:function(e,t,n){"use strict";var a=n(2870),l=n(5047),f=function f(e){var t=e.send,n=e.recv,f=e.sendStats,p=void 0===f?null:f,h=e.recvStats,m=void 0===h?null:h;Object.defineProperties(this,{send:{value:t,enumerable:!0},recv:{value:n,enumerable:!0},sendStats:{value:p?new a(p):null,enumerable:!0},recvStats:{value:m?new l(m):null,enumerable:!0}})};e.exports=f},5047:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function NetworkQualityRecvStats(t){return e.call(this,t)||this}return l(NetworkQualityRecvStats,e),NetworkQualityRecvStats}(n(9302));e.exports=f},9302:function(e,t,n){"use strict";var a=n(6095),l=n(9249),f=n(7689),p=function p(e){var t=e.bandwidth,n=void 0===t?null:t,p=e.fractionLost,h=void 0===p?null:p,m=e.latency,g=void 0===m?null:m;Object.defineProperties(this,{bandwidth:{value:n?new a(n):null,enumerable:!0},fractionLost:{value:h?new l(h):null,enumerable:!0},latency:{value:g?new f(g):null,enumerable:!0}})};e.exports=p},2870:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function NetworkQualitySendStats(t){return e.call(this,t)||this}return l(NetworkQualitySendStats,e),NetworkQualitySendStats}(n(9302));e.exports=f},7837:function(e,t,n){"use strict";var a=n(9521),l=n(2893),f=function f(e){var t=e.level,n=e.audio,f=e.video;Object.defineProperties(this,{level:{value:t,enumerable:!0},audio:{value:n?new a(n):null,enumerable:!0},video:{value:f?new l(f):null,enumerable:!0}})};e.exports=f},2893:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function NetworkQualityVideoStats(t){return e.call(this,t)||this}return l(NetworkQualityVideoStats,e),NetworkQualityVideoStats}(n(8310));e.exports=f},7559:function(e,t,n){"use strict";var a=n(334),l=n(1414),f=function(){function PeerConnectionReport(e,t,n){Object.defineProperties(this,{ice:{enumerable:!0,value:e},audio:{enumerable:!0,value:t},video:{enumerable:!0,value:n}})}return PeerConnectionReport.prototype.summarize=function(){var e=this.audio.send.concat(this.video.send),t=l.summarize(e),n=this.audio.recv.concat(this.video.recv),f=a.summarize(n);return{ice:this.ice,send:t,recv:f,audio:{send:l.summarize(this.audio.send),recv:a.summarize(this.audio.recv)},video:{send:l.summarize(this.video.send),recv:a.summarize(this.video.recv)}}},PeerConnectionReport}();e.exports=f},7396:function(e,t,n){"use strict";var a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},l=this&&this.__spreadArray||function(e,t){for(var n=0,a=t.length,l=e.length;n<a;n++,l++)e[l]=t[n];return e},f=this&&this.__values||function(e){var t="function"==typeof Symbol&&Symbol.iterator,n=t&&e[t],a=0;if(n)return n.call(e);if(e&&"number"==typeof e.length)return{next:function(){return e&&a>=e.length&&(e=void 0),{value:e&&e[a++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")},p=n(2939).guessBrowser,h=n(1409),m=n(7559),g=n(8454),v=n(9164),y=function(){function PeerConnectionReportFactory(e){Object.defineProperties(this,{pc:{enumerable:!0,value:e},ice:{enumerable:!0,value:new h},audio:{enumerable:!0,value:{send:new Map,recv:new Map}},video:{enumerable:!0,value:{send:new Map,recv:new Map}},lastReport:{enumerable:!0,value:null,writable:!0}})}return PeerConnectionReportFactory.prototype.next=function(){var e=this;return("firefox"===p()?function updateFirefox(e){var t=e.pc.getTransceivers().filter((function(e){return e.currentDirection&&e.currentDirection.match(/send/)&&e.sender.track})).map((function(e){return e.sender})),n=e.pc.getTransceivers().filter((function(e){return e.currentDirection&&e.currentDirection.match(/recv/)})).map((function(e){return e.receiver}));return Promise.all([getSenderOrReceiverReports(t),getSenderOrReceiverReports(n),e.pc.getStats()]).then((function(t){var n=a(t,3),l=n[0],f=n[1],p=n[2],h=getSenderReportFactoriesByMediaType(e),m=getSenderReportFactoryIdsByMediaType(e);l.forEach((function(t,n){return updateSenderReports(e,t,m,n)})),deleteSenderOrReceiverReportFactories(h,m);var g=getReceiverReportFactoriesByMediaType(e),v=getReceiverReportFactoryIdsByMediaType(e);f.forEach((function(t,n){return updateReceiverReports(e,t,v,n)})),deleteSenderOrReceiverReportFactories(g,v),updateIceReport(e.ice,p)}))}(this):function updateChrome(e){return e.pc.getStats().then((function(t){var n=getSenderReportFactoriesByMediaType(e),a=getSenderReportFactoryIdsByMediaType(e);updateSenderReports(e,t,a),deleteSenderOrReceiverReportFactories(n,a);var l=getReceiverReportFactoriesByMediaType(e),f=getReceiverReportFactoryIdsByMediaType(e);updateReceiverReports(e,t,f),deleteSenderOrReceiverReportFactories(l,f),updateIceReport(e.ice,t)}))}(this)).then((function(){var t=l([],a(e.audio.send.values())),n=l([],a(e.video.send.values())),f=l([],a(e.audio.recv.values())),p=l([],a(e.video.recv.values())),h=new m(e.ice.lastReport,{send:t.map((function(e){return e.lastReport})).filter((function(e){return e})),recv:f.map((function(e){return e.lastReport})).filter((function(e){return e}))},{send:n.map((function(e){return e.lastReport})).filter((function(e){return e})),recv:p.map((function(e){return e.lastReport})).filter((function(e){return e}))});return e.lastReport=h,h}))},PeerConnectionReportFactory}();function getSenderOrReceiverReports(e){return Promise.all(e.map((function(e){var t=e.track.id;return e.getStats().then((function(e){var n,a;try{for(var l=f(e.values()),p=l.next();!p.done;p=l.next()){var h=p.value;"inbound-rtp"===h.type&&(h.id=t+"-"+h.id)}}catch(m){n={error:m}}finally{try{p&&!p.done&&(a=l.return)&&a.call(l)}finally{if(n)throw n.error}}return[t,e]}))}))).then((function(e){return new Map(e)}))}function getOrCreateSenderOrReceiverReportFactory(e,t,n,a,l){var f=t[a.mediaType];if(!l){var p=n.get(a.trackId);p&&(l=p.trackIdentifier)}if(f&&l){if(f.has(a.id))return f.get(a.id);var h=new e(l,a);f.set(a.id,h)}return null}function getSenderReportFactoriesByMediaType(e){return{audio:e.audio.send,video:e.video.send}}function getReceiverReportFactoriesByMediaType(e){return{audio:e.audio.recv,video:e.video.recv}}function getOrCreateSenderReportFactory(e,t,n,a){return getOrCreateSenderOrReceiverReportFactory(v,getSenderReportFactoriesByMediaType(e),t,n,a)}function getOrCreateReceiverReportFactory(e,t,n,a){return getOrCreateSenderOrReceiverReportFactory(g,getReceiverReportFactoriesByMediaType(e),t,n,a)}function getSenderReportFactoryIdsByMediaType(e){return{audio:new Set(e.audio.send.keys()),video:new Set(e.video.send.keys())}}function getReceiverReportFactoryIdsByMediaType(e){return{audio:new Set(e.audio.recv.keys()),video:new Set(e.video.recv.keys())}}function updateSenderReports(e,t,n,a){var l,h;try{for(var m=f(t.values()),g=m.next();!g.done;g=m.next()){var v=g.value;if("outbound-rtp"===v.type&&!v.isRemote){if("firefox"!==p()&&!v.trackId)continue;var y=n[v.mediaType];y&&y.delete(v.id);var _=getOrCreateSenderReportFactory(e,t,v,a);if(_){var b=t.get(v.remoteId);_.next(a||_.trackId,v,b)}}}}catch(C){l={error:C}}finally{try{g&&!g.done&&(h=m.return)&&h.call(m)}finally{if(l)throw l.error}}}function updateReceiverReports(e,t,n,a){var l,p;try{for(var h=f(t.values()),m=h.next();!m.done;m=h.next()){var g=m.value;if("inbound-rtp"===g.type&&!g.isRemote){var v=n[g.mediaType];v&&v.delete(g.id);var y=getOrCreateReceiverReportFactory(e,t,g,a);y&&y.next(a||y.trackId,g)}}}catch(_){l={error:_}}finally{try{m&&!m.done&&(p=h.return)&&p.call(h)}finally{if(l)throw l.error}}}function deleteSenderOrReceiverReportFactories(e,t){var _loop_1=function(n){var a=e[n];t[n].forEach((function(e){return a.delete(e)}))};for(var n in t)_loop_1(n)}function updateIceReport(e,t){var n,a,l,p,h;try{for(var m=f(t.values()),g=m.next();!g.done;g=m.next()){"transport"===(_=g.value).type&&(h=t.get(_.selectedCandidatePairId))}}catch(b){n={error:b}}finally{try{g&&!g.done&&(a=m.return)&&a.call(m)}finally{if(n)throw n.error}}if(h)e.next(h);else try{for(var v=f(t.values()),y=v.next();!y.done;y=v.next()){var _;"candidate-pair"!==(_=y.value).type||!_.nominated||"selected"in _&&!_.selected||e.next(_)}}catch(C){l={error:C}}finally{try{y&&!y.done&&(p=v.return)&&p.call(v)}finally{if(l)throw l.error}}}e.exports=y},334:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(9462),p=n(8044),h=n(5811),m=function(e){function ReceiverReport(t,n,a,l,f,p,h){var m=e.call(this,t,n,a)||this,g=f>0?l/f:0;return Object.defineProperties(m,{deltaPacketsLost:{enumerable:!0,value:l},deltaPacketsReceived:{enumerable:!0,value:f},fractionLost:{enumerable:!0,value:p},jitter:{enumerable:!0,value:h},phonyFractionLost:{enumerable:!0,value:g}}),m}return l(ReceiverReport,e),ReceiverReport.of=function(e,t,n){if(t.id!==n.id)throw new Error("RTCStats IDs must match");var a=(n.timestamp-t.timestamp)/1e3,l=n.bytesReceived-t.bytesReceived,f=a>0?l/a*8:0,p=Math.max(n.packetsLost-t.packetsLost,0),h=n.packetsReceived-t.packetsReceived,m=n.fractionLost,g=n.jitter;return new ReceiverReport(t.id,e,f,p,h,m,g)},ReceiverReport.summarize=function(e){var t=e.map((function(e){return e.summarize()}));return{bitrate:h(t.map((function(e){return e.bitrate}))),fractionLost:f(t.map((function(e){return e.fractionLost}))),jitter:f(t.map((function(e){return e.jitter})))}},ReceiverReport.prototype.summarize=function(){return{bitrate:this.bitrate,fractionLost:"number"==typeof this.fractionLost?this.fractionLost:this.phonyFractionLost,jitter:this.jitter}},ReceiverReport}(p);e.exports=m},8454:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(334),p=function(e){function ReceiverReportFactory(t,n){var a=e.call(this,n.id,t,n)||this;return Object.defineProperties(a,{lastReport:{enumerable:!0,value:null,writable:!0}}),a}return l(ReceiverReportFactory,e),ReceiverReportFactory.prototype.next=function(e,t){var n=this.lastStats;this.lastStats=t,this.trackId=e;var a=f.of(e,n,t);return this.lastReport=a,a},ReceiverReportFactory}(n(6035));e.exports=p},8633:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function RemoteAudioTrackStats(t,n){var a=e.call(this,t,n)||this;return Object.defineProperties(a,{audioLevel:{value:"number"==typeof n.audioOutputLevel?n.audioOutputLevel:null,enumerable:!0},jitter:{value:"number"==typeof n.jitter?n.jitter:null,enumerable:!0}}),a}return l(RemoteAudioTrackStats,e),RemoteAudioTrackStats}(n(4861));e.exports=f},4861:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function RemoteTrackStats(t,n){var a=e.call(this,t,n)||this;return Object.defineProperties(a,{bytesReceived:{value:"number"==typeof n.bytesReceived?n.bytesReceived:null,enumerable:!0},packetsReceived:{value:"number"==typeof n.packetsReceived?n.packetsReceived:null,enumerable:!0}}),a}return l(RemoteTrackStats,e),RemoteTrackStats}(n(6498));e.exports=f},1675:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function RemoteVideoTrackStats(t,n){var a=e.call(this,t,n)||this,l=null;return"number"==typeof n.frameWidthReceived&&"number"==typeof n.frameHeightReceived&&(l={},Object.defineProperties(l,{width:{value:n.frameWidthReceived,enumerable:!0},height:{value:n.frameHeightReceived,enumerable:!0}})),Object.defineProperties(a,{dimensions:{value:l,enumerable:!0},frameRate:{value:"number"==typeof n.frameRateReceived?n.frameRateReceived:null,enumerable:!0}}),a}return l(RemoteVideoTrackStats,e),RemoteVideoTrackStats}(n(4861));e.exports=f},8044:function(e){"use strict";var t=function t(e,n,a){Object.defineProperties(this,{id:{enumerable:!0,value:e},trackId:{enumerable:!0,value:n},bitrate:{enumerable:!0,value:a}})};e.exports=t},6035:function(e){"use strict";var t=function t(e,n,a){Object.defineProperties(this,{id:{enumerable:!0,value:e,writable:!0},trackId:{enumerable:!0,value:n,writable:!0},lastStats:{enumerable:!0,value:a,writable:!0}})};e.exports=t},1414:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(9462),p=n(8044),h=n(5811),m=function(e){function SenderReport(t,n,a,l){var f=e.call(this,t,n,a)||this;return Object.defineProperties(f,{rtt:{enumerable:!0,value:l}}),f}return l(SenderReport,e),SenderReport.of=function(e,t,n,a){if(t.id!==n.id)throw new Error("RTCStats IDs must match");var l=(n.timestamp-t.timestamp)/1e3,f=n.bytesSent-t.bytesSent,p=l>0?f/l*8:0,h=a&&"number"==typeof a.roundTripTime?a.roundTripTime/1e3:void 0;return new SenderReport(t.id,e,p,h)},SenderReport.summarize=function(e){return{bitrate:h(e.map((function(e){return e.bitrate}))),rtt:f(e.map((function(e){return e.rtt})))}},SenderReport}(p);e.exports=m},9164:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(6035),p=n(1414),h=function(e){function SenderReportFactory(t,n){var a=e.call(this,n.id,t,n)||this;return Object.defineProperties(a,{lastReport:{enumerable:!0,value:null,writable:!0}}),a}return l(SenderReportFactory,e),SenderReportFactory.prototype.next=function(e,t,n){var a=this.lastStats;this.lastStats=t,this.trackId=e;var l=p.of(e,a,t,n);return this.lastReport=l,l},SenderReportFactory}(f);e.exports=h},2340:function(e,t,n){"use strict";var a=n(741),l=n(6872),f=n(8633),p=n(1675),h=function h(e,t,n){if("string"!=typeof e)throw new Error("RTCPeerConnection id must be a string");Object.defineProperties(this,{peerConnectionId:{value:e,enumerable:!0},localAudioTrackStats:{value:t.localAudioTrackStats.map((function(e){return new a(e.trackId,e,n)})),enumerable:!0},localVideoTrackStats:{value:t.localVideoTrackStats.map((function(e){return new l(e.trackId,e,n)})),enumerable:!0},remoteAudioTrackStats:{value:t.remoteAudioTrackStats.map((function(e){return new f(e.trackId,e)})),enumerable:!0},remoteVideoTrackStats:{value:t.remoteVideoTrackStats.map((function(e){return new p(e.trackId,e)})),enumerable:!0}})};e.exports=h},5811:function(e){"use strict";e.exports=function sum(e){return e.reduce((function(e,t){return"number"==typeof t?t+e:e}),0)}},6498:function(e){"use strict";var t=function t(e,n){if("string"!=typeof e)throw new Error("Track id must be a string");Object.defineProperties(this,{trackId:{value:e,enumerable:!0},trackSid:{value:n.trackSid,enumerable:!0},timestamp:{value:n.timestamp,enumerable:!0},ssrc:{value:n.ssrc,enumerable:!0},packetsLost:{value:"number"==typeof n.packetsLost?n.packetsLost:null,enumerable:!0},codec:{value:"string"==typeof n.codecName?n.codecName:null,enumerable:!0}})};e.exports=t},9430:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=function(e){function TrackTransceiver(t,n){var a=e.call(this)||this;return Object.defineProperties(a,{id:{enumerable:!0,value:t},kind:{enumerable:!0,value:n}}),a}return l(TrackTransceiver,e),TrackTransceiver.prototype.stop=function(){this.emit("stopped")},TrackTransceiver}(n(7187).EventEmitter);e.exports=f},4670:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},p=this&&this.__spreadArray||function(e,t){for(var n=0,a=t.length,l=e.length;n<a;n++,l++)e[l]=t[n];return e},h=n(3122),m=n(6971),g=m.buildLogLevels,v=m.makeUUID,y=n(6372),_=n(5481),b=n(5317),C=0,S={closed:[],connecting:["closed","open","waiting"],early:["closed","connecting"],open:["closed"],waiting:["closed","connecting","early","open"]},k={closed:"close",open:"open",waiting:"waiting"},w=3e3,T=3001,P=3002,A=3003,M=3005,x=3006,O=n.g.window||n.g,R=O.WebSocket?O.WebSocket:n(9990),I={BUSY:"busy",FAILED:"failed",LOCAL:"local",REMOTE:"remote",TIMEOUT:"timeout"},L=new Map([[w,I.TIMEOUT],[T,I.TIMEOUT],[P,I.FAILED],[A,I.FAILED],[3004,I.TIMEOUT],[x,I.BUSY],[3007,I.TIMEOUT]]),N=function(e){function TwilioConnection(t,n){var a=e.call(this,"early",S)||this;n=Object.assign({helloBody:null,maxConsecutiveFailedHellos:3,maxConsecutiveMissedHeartbeats:3,requestedHeartbeatTimeout:5e3,openTimeout:15e3,welcomeTimeout:5e3,Log:y,WebSocket:R},n);var l=g(n.logLevel),h=new n.Log("default",a,l,n.loggerName),m=n.networkMonitor?new _((function(){var e=m.type,t="Network changed"+(e?" to "+e:"");h.debug(t),a._close({code:3004,reason:t})})):null;Object.defineProperties(a,{_busyWaitTimeout:{value:null,writable:!0},_consecutiveHeartbeatsMissed:{value:0,writable:!0},_cookie:{value:null,writable:!0},_eventObserver:{value:n.eventObserver},_heartbeatTimeout:{value:null,writable:!0},_hellosLeft:{value:n.maxConsecutiveFailedHellos,writable:!0},_instanceId:{value:++C},_log:{value:h},_messageQueue:{value:[]},_networkMonitor:{value:m},_options:{value:n},_openTimeout:{value:null,writable:!0},_sendHeartbeatTimeout:{value:null,writable:!0},_serverUrl:{value:t},_welcomeTimeout:{value:null,writable:!0},_ws:{value:null,writable:!0}});var v={connecting:"info",early:"info",open:"info",waiting:"warning",closed:"info"};return a.on("stateChanged",(function(e){for(var t=[],n=1;n<arguments.length;n++)t[n-1]=arguments[n];e in k&&a.emit.apply(a,p([k[e]],f(t)));var l={name:e,group:"signaling",level:v[a.state]};if("closed"===e){var h=f(t,1),m=h[0];l.payload={reason:m},l.level=m===I.LOCAL?"info":"error"}a._eventObserver.emit("event",l)})),a._eventObserver.emit("event",{name:a.state,group:"signaling",level:v[a.state]}),a._connect(),a}return l(TwilioConnection,e),TwilioConnection.prototype.toString=function(){return"[TwilioConnection #"+this._instanceId+": "+this._ws.url+"]"},TwilioConnection.prototype._close=function(e){var t=e.code,n=e.reason;if("closed"!==this.state){this._openTimeout&&this._openTimeout.clear(),this._welcomeTimeout&&this._welcomeTimeout.clear(),this._heartbeatTimeout&&this._heartbeatTimeout.clear(),this._sendHeartbeatTimeout&&this._sendHeartbeatTimeout.clear(),this._networkMonitor&&this._networkMonitor.stop(),this._busyWaitTimeout&&t!==M&&this._busyWaitTimeout.clear(),this._messageQueue.splice(0);var a=this._log;1e3===t?(a.debug("Closed"),this.transition("closed",null,[I.LOCAL])):(a.warn("Closed: "+t+" - "+n),t!==M&&this.transition("closed",null,[L.get(t)||I.REMOTE]));var l=this._ws.readyState,f=this._options.WebSocket;l!==f.CLOSING&&l!==f.CLOSED&&this._ws.close(t,n)}},TwilioConnection.prototype._connect=function(){var e=this,t=this._log;if("waiting"===this.state)this.transition("early");else if("early"!==this.state)return void t.warn('Unexpected state "'+this.state+'" for connecting to the TCMP server.');this._ws=new this._options.WebSocket(this._serverUrl);var n=this._ws;t.debug("Created a new WebSocket:",n),n.addEventListener("close",(function(t){return e._close(t)}));var a=this._options.openTimeout;this._openTimeout=new b((function(){var t="Failed to open in "+a+" ms";e._close({code:3007,reason:t})}),a),n.addEventListener("open",(function(){t.debug("WebSocket opened:",n),e._openTimeout.clear(),e._startHandshake(),e._networkMonitor&&e._networkMonitor.start()})),n.addEventListener("message",(function(n){t.debug("Incoming: "+n.data);try{n=JSON.parse(n.data)}catch(a){return void e.emit("error",a)}switch(n.type){case"bad":e._handleBad(n);break;case"busy":e._handleBusy(n);break;case"bye":break;case"msg":e._handleMessage(n);case"heartbeat":e._handleHeartbeat();break;case"welcome":e._handleWelcome(n);break;default:e._log.debug("Unknown message type: "+n.type),e.emit("error",new Error("Unknown message type: "+n.type))}}))},TwilioConnection.prototype._handleBad=function(e){var t=e.reason,n=this._log;if(["connecting","open"].includes(this.state)){if("connecting"===this.state)return n.warn("Closing: 3002 - "+t),void this._close({code:P,reason:t});n.debug("Error: "+t),this.emit("error",new Error(t))}else n.warn('Unexpected state "'+this.state+'" for handling a "bad" message from the TCMP server.')},TwilioConnection.prototype._handleBusy=function(e){var t=this,n=e.cookie,a=e.keepAlive,l=e.retryAfter,f=this._log;if(["connecting","waiting"].includes(this.state)){this._busyWaitTimeout&&this._busyWaitTimeout.clear(),this._welcomeTimeout&&this._welcomeTimeout.clear();var p=l<0?'Received terminal "busy" message':'Received "busy" message, retrying after '+l+" ms";if(l<0)return f.warn("Closing: 3006 - "+p),void this._close({code:x,reason:p});var h=this._options.maxConsecutiveFailedHellos;this._hellosLeft=h,this._cookie=n||null,a?(f.warn(p),this._busyWaitTimeout=new b((function(){return t._startHandshake()}),l)):(f.warn("Closing: 3005 - "+p),this._close({code:M,reason:p}),this._busyWaitTimeout=new b((function(){return t._connect()}),l)),this.transition("waiting",null,[a,l])}else f.warn('Unexpected state "'+this.state+'" for handling a "busy" message from the TCMP server.')},TwilioConnection.prototype._handleHeartbeat=function(){"open"===this.state?this._heartbeatTimeout.reset():this._log.warn('Unexpected state "'+this.state+'" for handling a "heartbeat" message from the TCMP server.')},TwilioConnection.prototype._handleHeartbeatTimeout=function(){if("open"===this.state){var e=this._log,t=this._options.maxConsecutiveMissedHeartbeats;e.debug("Consecutive heartbeats missed: "+t);var n="Missed "+t+' "heartbeat" messages';e.warn("Closing: 3001 - "+n),this._close({code:T,reason:n})}},TwilioConnection.prototype._handleMessage=function(e){var t=e.body;"open"===this.state?this.emit("message",t):this._log.warn('Unexpected state "'+this.state+'" for handling a "msg" message from the TCMP server.')},TwilioConnection.prototype._handleWelcome=function(e){var t=this,n=e.negotiatedTimeout,a=this._log;if(["connecting","waiting"].includes(this.state)){"waiting"===this.state&&(a.debug('Received "welcome" message, no need to retry connection.'),this._busyWaitTimeout.clear());var l=n*this._options.maxConsecutiveMissedHeartbeats,f=n-200;this._welcomeTimeout.clear(),this._heartbeatTimeout=new b((function(){return t._handleHeartbeatTimeout()}),l),this._messageQueue.splice(0).forEach((function(e){return t._send(e)})),this._sendHeartbeatTimeout=new b((function(){return t._sendHeartbeat()}),f),this.transition("open")}else a.warn('Unexpected state "'+this.state+'" for handling a "welcome" message from the TCMP server.')},TwilioConnection.prototype._handleWelcomeTimeout=function(){if("connecting"===this.state){var e=this._log;if(this._hellosLeft<=0){var t="All handshake attempts failed";return e.warn("Closing: 3000 - "+t),void this._close({code:w,reason:t})}var n=this._options.maxConsecutiveFailedHellos;e.warn("Handshake attempt "+(n-this._hellosLeft)+" failed"),this._startHandshake()}},TwilioConnection.prototype._send=function(e){if(this._ws.readyState===this._options.WebSocket.OPEN){var t=JSON.stringify(e);this._log.debug("Outgoing: "+t);try{this._ws.send(t),this._sendHeartbeatTimeout&&this._sendHeartbeatTimeout.reset()}catch(a){var n="Failed to send message";this._log.warn("Closing: 3003 - "+n),this._close({code:A,reason:n})}}},TwilioConnection.prototype._sendHeartbeat=function(){"closed"!==this.state&&this._send({type:"heartbeat"})},TwilioConnection.prototype._sendHello=function(){var e=this._options,t=e.helloBody,n=e.requestedHeartbeatTimeout,a={id:v(),timeout:n,type:"hello",version:2};this._cookie&&(a.cookie=this._cookie),t&&(a.body=t),this._send(a)},TwilioConnection.prototype._sendOrEnqueue=function(e){var t=this;if("closed"!==this.state){var n="open"===this.state?function(e){return t._send(e)}:function(e){return t._messageQueue.push(e)};n(e)}},TwilioConnection.prototype._startHandshake=function(){var e=this;if(["early","waiting"].includes(this.state)&&this.transition("connecting"),"connecting"===this.state){this._hellosLeft--,this._sendHello();var t=this._options.welcomeTimeout;this._welcomeTimeout=new b((function(){return e._handleWelcomeTimeout()}),t)}},TwilioConnection.prototype.close=function(){"closed"!==this.state&&(this._sendOrEnqueue({type:"bye"}),this._close({code:1e3,reason:"Normal"}))},TwilioConnection.prototype.sendMessage=function(e){this._sendOrEnqueue({body:e,type:"msg"})},TwilioConnection}(h);N.CloseReason=I,e.exports=N},7206:function(e,t,n){"use strict";var a=n(6971).defer,l=function(){function AsyncVar(){Object.defineProperties(this,{_deferreds:{value:[]},_hasValue:{value:!1,writable:!0},_value:{value:null,writable:!0}})}return AsyncVar.prototype.put=function(e){this._hasValue=!0,this._value=e;var t=this._deferreds.shift();return t&&t.resolve(e),this},AsyncVar.prototype.take=function(){var e=this;if(this._hasValue&&!this._deferreds.length)return this._hasValue=!1,Promise.resolve(this._value);var t=a();return this._deferreds.push(t),t.promise.then((function(t){return e._hasValue=!1,t}))},AsyncVar}();e.exports=l},9943:function(e){"use strict";var t=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p};e.exports={isAndroid:function isAndroid(){return/Android/.test(navigator.userAgent)},isIOS:function isIOS(){return/iPad|iPhone|iPod/.test(navigator.userAgent)},isMobile:function isMobile(){return/Mobi/.test(navigator.userAgent)},isNonChromiumEdge:function isNonChromiumEdge(e){return"chrome"===e&&/Edge/.test(navigator.userAgent)&&("undefined"==typeof chrome||void 0===chrome.runtime)},mobileWebKitBrowser:function mobileWebKitBrowser(e){return"safari"!==e?null:"brave"in navigator?"brave":["edge","edg"].find((function(e){return navigator.userAgent.toLowerCase().includes(e)}))||null},rebrandedChromeBrowser:function rebrandedChromeBrowser(e){if("chrome"!==e)return null;if("brave"in navigator)return"brave";var n=function getParenthesizedSubstrings(e){for(var t=[],n=[],a=0;a<e.length;a++)if("("===e[a])t.push(a);else if(")"===e[a]&&t.length>0){var l=t.pop();0===t.length&&n.push(e.substring(l,a+1))}return n}(navigator.userAgent).reduce((function(e,t){return e.replace(t,"")}),navigator.userAgent).match(/[^\s]+/g)||[];return t(n.map((function(e){return e.split("/")[0].toLowerCase()}))).slice(2).find((function(e){return!["chrome","mobile","safari"].includes(e)}))||null}}},7422:function(e){"use strict";var t=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},n=this&&this.__spreadArray||function(e,t){for(var n=0,a=t.length,l=e.length;n<a;n++,l++)e[l]=t[n];return e},a=function(){function CancelablePromise(e,t){var n=this;Object.defineProperties(this,{_isCancelable:{writable:!0,value:!0},_isCanceled:{writable:!0,value:!1},_onCancel:{value:t}}),Object.defineProperty(this,"_promise",{value:new Promise((function(t,a){e((function(e){n._isCancelable=!1,t(e)}),(function(e){n._isCancelable=!1,a(e)}),(function(){return n._isCanceled}))}))})}return CancelablePromise.reject=function(e){return new CancelablePromise((function rejected(t,n){n(e)}),(function onCancel(){}))},CancelablePromise.resolve=function(e){return new CancelablePromise((function resolved(t){t(e)}),(function onCancel(){}))},CancelablePromise.prototype.cancel=function(){return this._isCancelable&&(this._isCanceled=!0,this._onCancel()),this},CancelablePromise.prototype.catch=function(){var e=[].slice.call(arguments),a=this._promise;return new CancelablePromise((function onCreate(l,f){a.catch.apply(a,n([],t(e))).then(l,f)}),this._onCancel)},CancelablePromise.prototype.then=function(){var e=[].slice.call(arguments),a=this._promise;return new CancelablePromise((function onCreate(l,f){a.then.apply(a,n([],t(e))).then(l,f)}),this._onCancel)},CancelablePromise}();e.exports=a},2097:function(e,t,n){"use strict";var a=n(1730);e.exports.SDK_NAME=a.name+".js",e.exports.SDK_VERSION=a.version,e.exports.DEFAULT_ENVIRONMENT="prod",e.exports.DEFAULT_REALM="us1",e.exports.DEFAULT_REGION="gll",e.exports.DEFAULT_LOG_LEVEL="warn",e.exports.DEFAULT_LOGGER_NAME="twilio-video",e.exports.WS_SERVER=function(e,t){return t="gll"===t?"global":encodeURIComponent(t),"prod"===e?"wss://"+t+".vss.twilio.com/signaling":"wss://"+t+".vss."+e+".twilio.com/signaling"},e.exports.PUBLISH_MAX_ATTEMPTS=5,e.exports.PUBLISH_BACKOFF_JITTER=10,e.exports.PUBLISH_BACKOFF_MS=20,e.exports.typeErrors={ILLEGAL_INVOKE:function(e,t){return new TypeError("Illegal call to "+e+": "+t)},INVALID_TYPE:function(e,t){return new TypeError(e+" must be "+function article(e){return["a","e","i","o","u"].includes(e.toLowerCase()[0])?"an":"a"}(t)+" "+t)},INVALID_VALUE:function(e,t){return new RangeError(e+" must be one of "+t.join(", "))},REQUIRED_ARGUMENT:function(e){return new TypeError(e+" must be specified")}},e.exports.DEFAULT_FRAME_RATE=24,e.exports.DEFAULT_VIDEO_PROCESSOR_STATS_INTERVAL_MS=1e4,e.exports.DEFAULT_ICE_GATHERING_TIMEOUT_MS=15e3,e.exports.DEFAULT_SESSION_TIMEOUT_SEC=30,e.exports.DEFAULT_NQ_LEVEL_LOCAL=1,e.exports.DEFAULT_NQ_LEVEL_REMOTE=0,e.exports.MAX_NQ_LEVEL=3,e.exports.ICE_ACTIVITY_CHECK_PERIOD_MS=1e3,e.exports.ICE_INACTIVITY_THRESHOLD_MS=3e3,e.exports.iceRestartBackoffConfig={factor:1.1,initialDelay:1,maxDelay:1e3*e.exports.DEFAULT_SESSION_TIMEOUT_SEC,randomisationFactor:.5},e.exports.reconnectBackoffConfig={factor:1.5,initialDelay:80,randomisationFactor:.5},e.exports.subscriptionMode={MODE_COLLABORATION:"collaboration",MODE_GRID:"grid",MODE_PRESENTATION:"presentation"},e.exports.trackSwitchOffMode={MODE_DISABLED:"disabled",MODE_DETECTED:"detected",MODE_PREDICTED:"predicted"},e.exports.trackPriority={PRIORITY_HIGH:"high",PRIORITY_LOW:"low",PRIORITY_STANDARD:"standard"},e.exports.clientTrackSwitchOffControl={MODE_AUTO:"auto",MODE_MANUAL:"manual"},e.exports.videoContentPreferencesMode={MODE_AUTO:"auto",MODE_MANUAL:"manual"}},8685:function(e,t,n){"use strict";var a=n(905);e.exports=function detectSilentAudio(e){var t=n(3585),l={},f=t.getOrCreate(l),p=3;return function doCheckSilence(){return p--,a(f,e.srcObject,250).then((function(e){return!!e&&(!(p>0)||doCheckSilence())})).catch((function(){return!0}))}().finally((function(){t.release(l)}))}},8815:function(e){"use strict";var t=null;e.exports=function detectSilentVideo(e){return t=t||document.createElement("canvas"),new Promise((function(n){var a=3;setTimeout((function doCheckSilence(){return a--,function checkSilence(e){try{var n=t.getContext("2d");n.drawImage(e,0,0,50,50);var a=n.getImageData(0,0,50,50).data.filter((function(e,t){return(t+1)%4}));return 0===Math.max.apply(Math,a)}catch(l){return console.log("Error checking silence: ",l),!1}}(e)?a>0?setTimeout(doCheckSilence,250):n(!0):n(!1)}),250)}))}},8379:function(e){"use strict";var t=function(){function DocumentVisibilityMonitor(e){var t=this;void 0===e&&(e=1),Object.defineProperties(this,{_listeners:{value:[]},_onVisibilityChange:{value:function(){t._emitVisible("visible"===document.visibilityState)}}});for(var n=0;n<e;n++)this._listeners.push([])}return DocumentVisibilityMonitor.prototype.clear=function(){for(var e=this._listeners.length,t=0;t<e;t++)this._listeners[t]=[]},DocumentVisibilityMonitor.prototype._listenerCount=function(){return this._listeners.reduce((function(e,t){return e+t.length}),0)},DocumentVisibilityMonitor.prototype._emitVisible=function(e){for(var t=this,n=Promise.resolve(),_loop_1=function(a){n=n.then((function(){return t._emitVisiblePhase(a,e)}))},a=1;a<=this._listeners.length;a++)_loop_1(a);return n},DocumentVisibilityMonitor.prototype._emitVisiblePhase=function(e,t){var n=this._listeners[e-1];return Promise.all(n.map((function(e){var n=e(t);return n instanceof Promise?n:Promise.resolve(n)})))},DocumentVisibilityMonitor.prototype._start=function(){document.addEventListener("visibilitychange",this._onVisibilityChange)},DocumentVisibilityMonitor.prototype._stop=function(){document.removeEventListener("visibilitychange",this._onVisibilityChange)},DocumentVisibilityMonitor.prototype.onVisibilityChange=function(e,t){if("number"!=typeof e||e<=0||e>this._listeners.length)throw new Error("invalid phase: ",e);return this._listeners[e-1].push(t),1===this._listenerCount()&&this._start(),this},DocumentVisibilityMonitor.prototype.offVisibilityChange=function(e,t){if("number"!=typeof e||e<=0||e>this._listeners.length)throw new Error("invalid phase: ",e);var n=this._listeners[e-1],a=n.indexOf(t);return-1!==a&&(n.splice(a,1),0===this._listenerCount()&&this._stop()),this},DocumentVisibilityMonitor}();e.exports=new t(2)},3451:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(7187).EventEmitter,p=["signaling","room","media","quality","video-processor","preflight"],h=["debug","error","info","warning"],m=function(e){function EventObserver(t,n,a,l){void 0===l&&(l=null);var f=e.call(this)||this;return f.on("event",(function(e){var f=e.name,m=e.group,g=e.level,v=e.payload;if("string"!=typeof f)throw a.error("Unexpected name: ",f),new Error("Unexpected name: ",f);if(!p.includes(m))throw a.error("Unexpected group: ",m),new Error("Unexpected group: ",m);if(!h.includes(g))throw a.error("Unexpected level: ",g),new Error("Unexpected level: ",g);var y=Date.now(),_=y-n,b=Object.assign({elapsedTime:_,level:g},v||{});t.publish(m,f,b);var C=Object.assign({elapsedTime:_,group:m,level:g,name:f,timestamp:y},v?{payload:v}:{});a[{debug:"debug",error:"error",info:"info",warning:"warn"}[g]]("event",C),l&&"signaling"===m&&l.emit("event",C)})),f}return l(EventObserver,e),EventObserver}(f);e.exports=m},5115:function(e){"use strict";var t=function(){function Filter(e){e=Object.assign({getKey:function defaultGetKey(e){return e},getValue:function defaultGetValue(e){return e},isLessThanOrEqualTo:function defaultIsLessThanOrEqualTo(e,t){return e<=t}},e),Object.defineProperties(this,{_getKey:{value:e.getKey},_getValue:{value:e.getValue},_isLessThanOrEqualTo:{value:e.isLessThanOrEqualTo},_map:{value:new Map}})}return Filter.prototype.toMap=function(){return new Map(this._map)},Filter.prototype.updateAndFilter=function(e){return e.filter(this.update,this)},Filter.prototype.update=function(e){var t=this._getKey(e),n=this._getValue(e);return(!this._map.has(t)||!this._isLessThanOrEqualTo(n,this._map.get(t)))&&(this._map.set(t,n),!0)},Filter}();e.exports=t},6971:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},p=this&&this.__spreadArray||function(e,t){for(var n=0,a=t.length,l=e.length;n<a;n++,l++)e[l]=t[n];return e},h=n(2097),m=h.typeErrors,g=h.trackPriority,v=n(2939),y=n(7480).sessionSID;function getUserAgent(){return"undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent:"Unknown"}function delegateMethod(e,t,n,a){if(!(a in t)&&!a.match(/^on[a-z]+$/)){var l;try{l=typeof e[a]}catch(h){}"function"===l&&(t[a]=function(){for(var e,t=[],l=0;l<arguments.length;l++)t[l]=arguments[l];return(e=this[n])[a].apply(e,p([],f(t)))})}}function isNonArrayObject(e){return"object"==typeof e&&!Array.isArray(e)}function hidePrivateProperties(e){Object.getOwnPropertyNames(e).forEach((function(t){t.startsWith("_")&&hideProperty(e,t)}))}function hideProperty(e,t){var n=Object.getOwnPropertyDescriptor(e,t);n.enumerable=!1,Object.defineProperty(e,t,n)}function hidePublicProperties(e,t){void 0===t&&(t=[]),t.forEach((function(t){e.hasOwnProperty(t)&&hideProperty(e,t)}))}function arrayToJSON(e){return e.map(valueToJSON)}function valueToJSON(e){return Array.isArray(e)?arrayToJSON(e):e instanceof Set?function setToJSON(e){return arrayToJSON(p([],f(e)))}(e):e instanceof Map?function mapToJSON(e){return p([],f(e.entries())).reduce((function(e,t){var n,a=f(t,2),l=a[0],p=a[1];return Object.assign(((n={})[l]=valueToJSON(p),n),e)}),{})}(e):e&&"object"==typeof e?function objectToJSON(e){return Object.entries(e).reduce((function(e,t){var n,a=f(t,2),l=a[0],p=a[1];return Object.assign(((n={})[l]=valueToJSON(p),n),e)}),{})}(e):e}function createBandwidthProfileVideoPayload(e){return createRSPPayload(e,[{prop:"dominantSpeakerPriority",type:"string",payloadProp:"active_speaker_priority"},{prop:"maxSubscriptionBitrate",type:"number",payloadProp:"max_subscription_bandwidth"},{prop:"maxTracks",type:"number",payloadProp:"max_tracks"},{prop:"mode",type:"string"},{prop:"renderDimensions",type:"object",payloadProp:"render_dimensions",transform:createRenderDimensionsPayload},{prop:"trackSwitchOffMode",type:"string",payloadProp:"track_switch_off"}])}function createDimensionsPayload(e){return createRSPPayload(e,[{prop:"height",type:"number"},{prop:"width",type:"number"}])}function createRenderDimensionsPayload(e){return createRSPPayload(e,[{prop:g.PRIORITY_HIGH,type:"object",transform:createDimensionsPayload},{prop:g.PRIORITY_LOW,type:"object",transform:createDimensionsPayload},{prop:g.PRIORITY_STANDARD,type:"object",transform:createDimensionsPayload}])}function createRSPPayload(e,t){return t.reduce((function(t,n){var a,l=n.prop,f=n.type,p=n.payloadProp,h=void 0===p?l:p,m=n.transform,g=void 0===m?function(e){return e}:m;return typeof e[l]===f?Object.assign(((a={})[h]=g(e[l]),a),t):t}),{})}t.constants=h,t.createBandwidthProfilePayload=function createBandwidthProfilePayload(e){return createRSPPayload(e,[{prop:"video",type:"object",transform:createBandwidthProfileVideoPayload}])},t.createMediaSignalingPayload=function createMediaSignalingPayload(e,t,n,a,l){var f={transports:[{type:"data-channel"}]};return Object.assign(e?{active_speaker:f}:{},t?{network_quality:f}:{},l?{render_hints:f}:{},n?{track_priority:f}:{},a?{track_switch_off:f}:{})},t.createRoomConnectEventPayload=function createRoomConnectEventPayload(e){function boolToString(e){return e?"true":"false"}var t={sessionSID:y,iceServers:(e.iceServers||[]).length,audioTracks:(e.tracks||[]).filter((function(e){return"audio"===e.kind})).length,videoTracks:(e.tracks||[]).filter((function(e){return"video"===e.kind})).length,dataTracks:(e.tracks||[]).filter((function(e){return"data"===e.kind})).length};if([["audio"],["automaticSubscription"],["enableDscp"],["eventListener"],["preflight"],["video"],["dominantSpeaker","enableDominantSpeaker"]].forEach((function(n){var a=f(n,2),l=a[0],p=a[1];t[p=p||l]=boolToString(!!e[l])})),[["maxVideoBitrate"],["maxAudioBitrate"],["iceTransportPolicy"],["region"],["name","roomName"]].forEach((function(n){var a=f(n,2),l=a[0],p=a[1];p=p||l,"number"!=typeof e[l]&&"string"!=typeof e[l]||(t[p]=e[l])})),["preferredAudioCodecs","preferredVideoCodecs"].forEach((function(n){n in e&&(t[n]=JSON.stringify(e[n]))})),"networkQuality"in e&&(t.networkQualityConfiguration={},isNonArrayObject(e.networkQuality)?["local","remote"].forEach((function(n){"number"==typeof e.networkQuality[n]&&(t.networkQualityConfiguration[n]=e.networkQuality[n])})):(t.networkQualityConfiguration.remote=0,t.networkQualityConfiguration.local=e.networkQuality?1:0)),e.bandwidthProfile&&e.bandwidthProfile.video){var n=e.bandwidthProfile.video||{};t.bandwidthProfileOptions={},["mode","maxTracks","trackSwitchOffMode","dominantSpeakerPriority","maxSubscriptionBitrate","renderDimensions","contentPreferencesMode","clientTrackSwitchOffControl"].forEach((function(e){"number"==typeof n[e]||"string"==typeof n[e]?t.bandwidthProfileOptions[e]=n[e]:"boolean"==typeof n[e]?t.bandwidthProfileOptions[e]=boolToString(n[e]):"object"==typeof n[e]&&(t.bandwidthProfileOptions[e]=JSON.stringify(n[e]))}))}return{group:"room",name:"connect",level:"info",payload:t}},t.createSubscribePayload=function createSubscribePayload(e){return{rules:[{type:e?"include":"exclude",all:!0}],revision:1}},t.asLocalTrack=function asLocalTrack(e,t){if(e instanceof t.LocalAudioTrack||e instanceof t.LocalVideoTrack||e instanceof t.LocalDataTrack)return e;if(e instanceof t.MediaStreamTrack)return"audio"===e.kind?new t.LocalAudioTrack(e,t):new t.LocalVideoTrack(e,t);throw m.INVALID_TYPE("track","LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack")},t.asLocalTrackPublication=function asLocalTrackPublication(e,t,n,a){return new(0,{audio:a.LocalAudioTrackPublication,video:a.LocalVideoTrackPublication,data:a.LocalDataTrackPublication}[e.kind])(t,e,n,a)},t.capitalize=function capitalize(e){return e[0].toUpperCase()+e.slice(1)},t.deprecateEvents=function deprecateEvents(e,t,n,a){var l=new Set;t.on("newListener",(function newListener(f){n.has(f)&&!l.has(f)&&(a.deprecated(e+"#"+f+" has been deprecated and scheduled for removal in twilio-video.js@2.0.0."+(n.get(f)?" Use "+e+"#"+n.get(f)+" instead.":"")),l.add(f)),l.size>=n.size&&t.removeListener("newListener",newListener)}))},t.difference=function difference(e,t){e=Array.isArray(e)?new Set(e):new Set(e.values()),t=Array.isArray(t)?new Set(t):new Set(t.values());var n=new Set;return e.forEach((function(e){t.has(e)||n.add(e)})),n},t.filterObject=function filterObject(e,t){return Object.keys(e).reduce((function(n,a){return e[a]!==t&&(n[a]=e[a]),n}),{})},t.flatMap=function flatMap(e,t){var n=e instanceof Map||e instanceof Set?Array.from(e.values()):e;return t=t||function mapFn(e){return e},n.reduce((function(e,n){var a=t(n);return e.concat(a)}),[])},t.getPlatform=function getPlatform(){var e=getUserAgent(),t=f(e.match(/\(([^)]+)\)/)||[],2)[1];return f((void 0===t?"unknown":t).split(";").map((function(e){return e.trim()})),1)[0].toLowerCase()},t.getUserAgent=getUserAgent,t.hidePrivateProperties=hidePrivateProperties,t.hidePrivateAndCertainPublicPropertiesInClass=function hidePrivateAndCertainPublicPropertiesInClass(e,t){return function(e){function class_1(){for(var n=[],a=0;a<arguments.length;a++)n[a]=arguments[a];var l=e.apply(this,p([],f(n)))||this;return hidePrivateProperties(l),hidePublicProperties(l,t),l}return l(class_1,e),class_1}(e)},t.isDeepEqual=function isDeepEqual(e,t){if(e===t)return!0;if(typeof e!=typeof t)return!1;if(null===e)return null===t;if(null===t)return!1;if(Array.isArray(e))return Array.isArray(t)&&e.length===t.length&&e.every((function(e,n){return isDeepEqual(e,t[n])}));if("object"==typeof e){var n=Object.keys(e).sort(),a=Object.keys(t).sort();return!Array.isArray(t)&&isDeepEqual(n,a)&&n.every((function(n){return isDeepEqual(e[n],t[n])}))}return!1},t.isNonArrayObject=isNonArrayObject,t.inRange=function inRange(e,t,n){return t<=e&&e<=n},t.makeUUID=function makeUUID(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,(function(e){var t=16*Math.random()|0;return("x"===e?t:3&t|8).toString(16)}))},t.oncePerTick=function oncePerTick(e){var t=null;function nextTick(){t=null,e()}return function scheduleNextTick(){t&&clearTimeout(t),t=setTimeout(nextTick)}},t.promiseFromEvents=function promiseFromEvents(e,t,n,a){return new Promise((function(l,h){function onSuccess(){var e=[].slice.call(arguments);a&&t.removeListener(a,onFailure),l.apply(void 0,p([],f(e)))}function onFailure(){var e=[].slice.call(arguments);t.removeListener(n,onSuccess),h.apply(void 0,p([],f(e)))}t.once(n,onSuccess),a&&t.once(a,onFailure),e()}))},t.getOrNull=function getOrNull(e,t){return t.split(".").reduce((function(e,t){return e?e[t]:null}),e)},t.defer=function defer(){var e={};return e.promise=new Promise((function(t,n){e.resolve=t,e.reject=n})),e},t.delegateMethods=function delegateMethods(e,t,n){for(var a in e)delegateMethod(e,t,n,a)},t.proxyProperties=function proxyProperties(e,t,n){Object.getOwnPropertyNames(e).forEach((function(e){!function proxyProperty(e,t,n,a){if(a in t)return;if(a.match(/^on[a-z]+$/))return Object.defineProperty(t,a,{value:null,writable:!0}),void n.addEventListener(a.slice(2),(function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];t.dispatchEvent.apply(t,p([],f(e)))}));Object.defineProperty(t,a,{enumerable:!0,get:function(){return n[a]}})}(0,t,n,e)}))},t.legacyPromise=function legacyPromise(e,t,n){return t?e.then((function(e){t(e)}),(function(e){n(e)})):e},t.buildLogLevels=function buildLogLevels(e){return"string"==typeof e?{default:e,media:e,signaling:e,webrtc:e}:e},t.trackClass=function trackClass(e,t){return(t=t?"Local":"")+(e.kind||"").replace(/\w{1}/,(function(e){return e.toUpperCase()}))+"Track"},t.trackPublicationClass=function trackPublicationClass(e,t){return(t=t?"Local":"")+(e.kind||"").replace(/\w{1}/,(function(e){return e.toUpperCase()}))+"TrackPublication"},t.valueToJSON=valueToJSON,t.withJitter=function withJitter(e,t){var n=Math.random();return e-t+Math.floor(2*t*n+.5)},t.isChromeScreenShareTrack=function isChromeScreenShareTrack(e){return"chrome"===v.guessBrowser()&&"video"===e.kind&&e.label&&(/^screen:[0-9]+/.test(e.label)||/^web-contents-media-stream:[0-9/]+/.test(e.label)||/^window:[0-9]+/.test(e.label))},t.isUserMediaTrack=function isUserMediaTrack(e){return"string"==typeof e.getSettings().deviceId},t.waitForSometime=function waitForSometime(e){return void 0===e&&(e=10),new Promise((function(t){return setTimeout(t,e)}))},t.waitForEvent=function waitForEvent(e,t){return new Promise((function(n){e.addEventListener(t,(function onevent(a){e.removeEventListener(t,onevent),n(a)}))}))}},9849:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(7187).EventEmitter,p=n(6971).getUserAgent,h=n.g.window||n.g,m=h.WebSocket?h.WebSocket:n(9990),g=n(6971),v=function(e){function InsightsPublisher(t,n,a,l,f,h){var v=e.call(this)||this;return h=Object.assign({gateway:createGateway(l,f)+"/v1/VideoEvents",maxReconnectAttempts:5,reconnectIntervalMs:50,userAgent:p(),WebSocket:m},h),Object.defineProperties(v,{_connectTimestamp:{value:0,writable:!0},_eventQueue:{value:[]},_readyToConnect:{value:g.defer()},_reconnectAttemptsLeft:{value:h.maxReconnectAttempts,writable:!0},_ws:{value:null,writable:!0},_WebSocket:{value:h.WebSocket}}),v._readyToConnect.promise.then((function(e){var l=e.roomSid,f=e.participantSid,p=v;v.on("disconnected",(function maybeReconnect(e){if(p._session=null,e&&p._reconnectAttemptsLeft>0)return p.emit("reconnecting"),void function reconnect(e,t,n,a,l,f,p){var h=Date.now()-e._connectTimestamp,m=p.reconnectIntervalMs-h;if(m>0)return void setTimeout((function(){connect(e,t,n,a,l,f,p)}),m);connect(e,t,n,a,l,f,p)}(p,t,n,a,l,f,h);p.removeListener("disconnected",maybeReconnect)})),connect(v,t,n,a,l,f,h)})).catch((function(){})),v}return l(InsightsPublisher,e),InsightsPublisher.prototype.connect=function(e,t){this._readyToConnect.resolve({roomSid:e,participantSid:t})},InsightsPublisher.prototype._publish=function(e){e.session=this._session,this._ws.send(JSON.stringify(e))},InsightsPublisher.prototype.disconnect=function(){if(null===this._ws||this._ws.readyState===this._WebSocket.CLOSING||this._ws.readyState===this._WebSocket.CLOSED)return!1;try{this._ws.close()}catch(e){}return this.emit("disconnected"),!0},InsightsPublisher.prototype.publish=function(e,t,n){return(null===this._ws||this._ws.readyState!==this._WebSocket.CLOSING&&this._ws.readyState!==this._WebSocket.CLOSED)&&(("string"==typeof this._session?this._publish.bind(this):this._eventQueue.push.bind(this._eventQueue))({group:e,name:t,payload:n,timestamp:Date.now(),type:"event",version:1}),!0)},InsightsPublisher}(f);function connect(e,t,n,a,l,f,p){e._connectTimestamp=Date.now(),e._reconnectAttemptsLeft--,e._ws=new p.WebSocket(p.gateway);var h=e._ws;h.addEventListener("close",(function(t){1e3!==t.code?e.emit("disconnected",new Error("WebSocket Error "+t.code+": "+t.reason)):e.emit("disconnected")})),h.addEventListener("message",(function(t){!function handleConnectResponse(e,t,n){switch(t.type){case"connected":e._session=t.session,e._reconnectAttemptsLeft=n.maxReconnectAttempts,e._eventQueue.splice(0).forEach(e._publish,e),e.emit("connected");break;case"error":e._ws.close(),e.emit("disconnected",new Error(t.message))}}(e,JSON.parse(t.data),p)})),h.addEventListener("open",(function(){var e={type:"connect",token:t,version:1};e.publisher={name:n,sdkVersion:a,userAgent:p.userAgent,participantSid:f,roomSid:l},h.send(JSON.stringify(e))}))}function createGateway(e,t){return"prod"===e?"wss://sdkgw."+t+".twilio.com":"wss://sdkgw."+e+"-"+t+".twilio.com"}e.exports=v},8363:function(e){"use strict";var t=function(){function InsightsPublisher(){Object.defineProperties(this,{_connected:{writable:!0,value:!0}})}return InsightsPublisher.prototype.connect=function(){},InsightsPublisher.prototype.disconnect=function(){return!!this._connected&&(this._connected=!1,!0)},InsightsPublisher.prototype.publish=function(){return this._connected},InsightsPublisher}();e.exports=t},4919:function(e,t,n){"use strict";var a=n(6971).defer,l=function(){function LocalMediaRestartDeferreds(){Object.defineProperties(this,{_audio:{value:a(),writable:!0},_video:{value:a(),writable:!0}}),this._audio.resolve(),this._video.resolve()}return LocalMediaRestartDeferreds.prototype.resolveDeferred=function(e){"audio"===e?this._audio.resolve():this._video.resolve()},LocalMediaRestartDeferreds.prototype.startDeferred=function(e){"audio"===e?this._audio=a():this._video=a()},LocalMediaRestartDeferreds.prototype.whenResolved=function(e){return"audio"===e?this._audio.promise:this._video.promise},LocalMediaRestartDeferreds}();e.exports=new l},6372:function(e,t,n){"use strict";var a,l=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},f=this&&this.__spreadArray||function(e,t){for(var n=0,a=t.length,l=e.length;n<a;n++,l++)e[l]=t[n];return e},p=n(5021).getLogger,h=n(2097),m=h.DEFAULT_LOG_LEVEL,g=h.DEFAULT_LOGGER_NAME,v=n(2097).typeErrors;var y=function(){function Log(e,t,n,a,l){if("string"!=typeof e)throw v.INVALID_TYPE("moduleName","string");if(!t)throw v.REQUIRED_ARGUMENT("component");"object"!=typeof n&&(n={}),l=l||p,validateLogLevels(n),Object.defineProperties(this,{_component:{value:t},_logLevels:{value:n},_warnings:{value:new Set},_loggerName:{get:function get(){var t=a&&"string"==typeof a?a:g;return this._logLevelsEqual||(t=t+"-"+e),t}},_logger:{get:function get(){var t=l(this._loggerName),n=this._logLevels[e]||m;return n="off"===n?"silent":n,t.setDefaultLevel(n),t}},_logLevelsEqual:{get:function get(){return 1===new Set(Object.values(this._logLevels)).size}},logLevel:{get:function get(){return Log.getLevelByName(n[e]||m)}},name:{get:t.toString.bind(t)}})}return Log.getLevelByName=function(e){return isNaN(e)?(validateLogLevel(e=e.toUpperCase()),Log[e]):parseInt(e,10)},Log.prototype.createLog=function(e,t){var n=this._loggerName;return this._logLevelsEqual||(n=n.substring(0,n.lastIndexOf("-"))),new Log(e,t,this._logLevels,n)},Log.prototype.setLevels=function(e){return validateLogLevels(e),Object.assign(this._logLevels,e),this},Log.prototype.log=function(e,t){var n=Log._levels[e];if(!n)throw v.INVALID_VALUE("logLevel",b);n=n.toLowerCase();var a=[(new Date).toISOString(),n,this.name];return(this._logger[n]||function noop(){}).apply(void 0,f([],l(a.concat(t)))),this},Log.prototype.debug=function(){return this.log(Log.DEBUG,[].slice.call(arguments))},Log.prototype.deprecated=function(e){var t=function getDeprecationWarnings(e){if((a=a||new Map).has(e))return a.get(e);var t=new Set;return a.set(e,t),t}(this._component.constructor);return t.has(e)?this:(t.add(e),this.warn(e))},Log.prototype.info=function(){return this.log(Log.INFO,[].slice.call(arguments))},Log.prototype.warn=function(){return this.log(Log.WARN,[].slice.call(arguments))},Log.prototype.warnOnce=function(e){return this._warnings.has(e)?this:(this._warnings.add(e),this.warn(e))},Log.prototype.error=function(){return this.log(Log.ERROR,[].slice.call(arguments))},Log.prototype.throw=function(e,t){throw e.clone&&(e=e.clone(t)),this.log(Log.ERROR,e),e},Log}();Object.defineProperties(y,{DEBUG:{value:0},INFO:{value:1},WARN:{value:2},ERROR:{value:3},OFF:{value:4},_levels:{value:["DEBUG","INFO","WARN","ERROR","OFF"]}});var _={},b=[],C=y._levels.map((function(e,t){return _[e]=!0,b.push(t),e}));function validateLogLevel(e){if(!(e in _))throw v.INVALID_VALUE("level",C)}function validateLogLevels(e){Object.keys(e).forEach((function(t){validateLogLevel(e[t].toUpperCase())}))}e.exports=y},9576:function(e){"use strict";var t=function(){function MovingAverageDelta(){Object.defineProperties(this,{_samples:{value:[{denominator:0,numerator:0},{denominator:0,numerator:0}]}})}return MovingAverageDelta.prototype.get=function(){var e=this._samples,t=e[1].denominator-e[0].denominator||1/0;return(e[1].numerator-e[0].numerator)/t},MovingAverageDelta.prototype.putSample=function(e,t){var n=this._samples;n.shift(),n.push({denominator:t,numerator:e})},MovingAverageDelta}();e.exports=t},5481:function(e){"use strict";var t=function(){function NetworkMonitor(e,t){var n=this,a=(t=Object.assign({navigator:navigator,window:window},t)).navigator,l=a.connection||{type:null},f=l.type,p=l.type?{_events:{value:["change","typechange"]},_listener:{value:function(){var t=f!==n.type&&n.isOnline;f=n.type,t&&e()}},_target:{value:l}}:{_events:{value:["online"]},_listener:{value:e},_target:{value:t.window}},h=p._events,m=p._listener,g=p._target;Object.defineProperties(this,{isOnline:{enumerable:!0,get:function(){return"boolean"!=typeof a.onLine||a.onLine}},type:{enumerable:!0,get:function(){return l.type||null}},_listener:m,_events:h,_target:g})}return NetworkMonitor.prototype.start=function(){var e=this;this._events.forEach((function(t){e._target.addEventListener(t,e._listener)}))},NetworkMonitor.prototype.stop=function(){var e=this;this._events.forEach((function(t){e._target.removeEventListener(t,e._listener)}))},NetworkMonitor}();e.exports=t},8537:function(e){"use strict";var t,n=this&&this.__extends||(t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},t(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}),a=function(){function NullObserver(e){Object.defineProperties(this,{_callback:{value:e}})}return NullObserver.prototype.observe=function(){},NullObserver.prototype.unobserve=function(){},NullObserver.prototype.makeVisible=function(e){var t=this._makeFakeEntry(e,!0);this._callback([t])},NullObserver.prototype.makeInvisible=function(e){var t=this._makeFakeEntry(e,!1);this._callback([t])},NullObserver.prototype._makeFakeEntry=function(e,t){return{target:e,isIntersecting:t}},NullObserver}(),l=function(e){function NullIntersectionObserver(){return null!==e&&e.apply(this,arguments)||this}return n(NullIntersectionObserver,e),NullIntersectionObserver}(a),f=function(e){function NullResizeObserver(){return null!==e&&e.apply(this,arguments)||this}return n(NullResizeObserver,e),NullResizeObserver.prototype.resize=function(e){var t=this._makeFakeEntry(e,!0);this._callback([t])},NullResizeObserver}(a);e.exports={NullIntersectionObserver:l,NullResizeObserver:f,NullObserver:a}},1062:function(e,t,n){"use strict";var a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},l=n(6971),f=l.difference,p=l.flatMap,h=n(5524),m={0:"PCMU",8:"PCMA"};function createBLine(e,t){return t?"\r\nb="+e+":"+("AS"===e?Math.round((t+16e3)/950):t):null}function createCodecMapForMediaSection(e){return Array.from(createPtToCodecName(e)).reduce((function(e,t){var n=t[0],a=t[1],l=e.get(a)||[];return e.set(a,l.concat(n))}),new Map)}function createMidToMediaSectionMap(e){return getMediaSections(e).reduce((function(e,t){var n=getMidForMediaSection(t);return n?e.set(n,t):e}),new Map)}function createPtToCodecName(e){return getPayloadTypesInMediaSection(e).reduce((function(t,n){var a=new RegExp("a=rtpmap:"+n+" ([^/]+)"),l=e.match(a),f=l?l[1].toLowerCase():m[n]?m[n].toLowerCase():"";return t.set(n,f)}),new Map)}function getFmtpAttributesForPt(e,t){var n=new RegExp("^a=fmtp:"+e+" (.+)$","m"),l=t.match(n);return l&&l[1].split(";").reduce((function(e,t){var n=a(t.split("="),2),l=n[0],f=n[1];return e[l]=isNaN(f)?f:parseInt(f,10),e}),{})}function getMidForMediaSection(e){var t=e.match(/^a=mid:(.+)$/m);return t&&t[1]}function getMediaSections(e,t,n){return e.replace(/\r\n\r\n$/,"\r\n").split("\r\nm=").slice(1).map((function(e){return"m="+e})).filter((function(e){var a=new RegExp("m="+(t||".*"),"gm"),l=new RegExp("a="+(n||".*"),"gm");return a.test(e)&&l.test(e)}))}function getPayloadTypesInMediaSection(e){var t=e.split("\r\n")[0].match(/([0-9]+)/g);return t?t.slice(1).map((function(e){return parseInt(e,10)})):[]}function setPayloadTypesInMediaSection(e,t){var n=t.split("\r\n"),a=n[0],l=n.slice(1);return[a=a.replace(/([0-9]+\s?)+$/,e.join(" "))].concat(l).join("\r\n")}function unifiedPlanFilterCodecsInMediaSection(e,t,n){if(!/^m=(audio|video)/.test(e))return e;var l=getMidForMediaSection(e),f=l&&t.get(l);if(!f)return e;var h=createPtToCodecName(f),m=createCodecMapForMediaSection(e),g=p(Array.from(h),(function(t){var l=a(t,2),p=l[0],h=l[1];return"rtx"===h||n.includes(h)?[]:function unifiedPlanGetMatchingPayloadTypes(e,t,n,a,l){var f=n.get(e)||[];if(f.length<=1)return f;var p=getFmtpAttributesForPt(t,l);if(!p)return f;var h=f.find((function(e){var t=getFmtpAttributesForPt(e,a);return t&&Object.keys(p).every((function(e){return p[e]===t[e]}))}));return"number"==typeof h?[h]:f}(h,p,m,e,f)})),v=m.get("rtx")||[];g=g.concat(v.filter((function(t){var n=getFmtpAttributesForPt(t,e);return n&&g.includes(n.apt)})));var y=e.split("\r\n").filter((function(e){var t=e.match(/^a=(rtpmap|fmtp|rtcp-fb):(.+) .+$/),n=t&&t[2];return!t||n&&g.includes(parseInt(n,10))}));return setPayloadTypesInMediaSection(getPayloadTypesInMediaSection(e).filter((function(e){return g.includes(e)})),y.join("\r\n"))}function unifiedPlanAddOrRewriteTrackIds(e,t){var n=getMediaSections(e);return[e.split("\r\nm=")[0]].concat(n.map((function(e){if(!/^m=(audio|video)/.test(e))return e;var n=getMidForMediaSection(e);if(!n)return e;var l=t.get(n);if(!l)return e;var f=(e.match(/^a=msid:(.+)$/m)||[])[1];if(!f)return e;var p=a(f.split(" "),2),h=p[0],m=p[1],g=new RegExp("msid:"+h+(m?" "+m:"")+"$","gm");return e.replace(g,"msid:"+h+" "+l)}))).join("\r\n")}function generateFmtpLineFromPtAndAttributes(e,t){var n=Object.entries(t).map((function(e){var t=a(e,2);return t[0]+"="+t[1]})).join(";");return"a=fmtp:"+e+" "+n}t.createCodecMapForMediaSection=createCodecMapForMediaSection,t.createPtToCodecName=createPtToCodecName,t.disableRtx=function disableRtx(e){var t=getMediaSections(e);return[e.split("\r\nm=")[0]].concat(t.map((function(e){if(!/^m=video/.test(e))return e;var t=createCodecMapForMediaSection(e).get("rtx");if(!t)return e;var n=new Set(getPayloadTypesInMediaSection(e));t.forEach((function(e){return n.delete(e)}));var a=e.match(/a=ssrc-group:FID [0-9]+ ([0-9]+)/),l=a&&a[1],f=[/^a=fmtp:.+ apt=.+$/,/^a=rtpmap:.+ rtx\/.+$/,/^a=ssrc-group:.+$/].concat(l?[new RegExp("^a=ssrc:"+l+" .+$")]:[]);return e=e.split("\r\n").filter((function(e){return f.every((function(t){return!t.test(e)}))})).join("\r\n"),setPayloadTypesInMediaSection(Array.from(n),e)}))).join("\r\n")},t.enableDtxForOpus=function enableDtxForOpus(e,t){var n=getMediaSections(e),a=e.split("\r\nm=")[0];return t=t||n.filter((function(e){return/^m=audio/.test(e)})).map(getMidForMediaSection),[a].concat(n.map((function(e){if(!/^m=audio/.test(e))return e;var n=createCodecMapForMediaSection(e).get("opus");if(!n)return e;var a=getFmtpAttributesForPt(n,e);if(!a)return e;var l=generateFmtpLineFromPtAndAttributes(n,a),f=new RegExp(l),p=getMidForMediaSection(e);t.includes(p)?a.usedtx=1:delete a.usedtx;var h=generateFmtpLineFromPtAndAttributes(n,a);return e.replace(f,h)}))).join("\r\n")},t.getMediaSections=getMediaSections,t.removeSSRCAttributes=function removeSSRCAttributes(e,t){return e.split("\r\n").filter((function(e){return!t.find((function(t){return new RegExp("a=ssrc:.*"+t+":","g").test(e)}))})).join("\r\n")},t.revertSimulcastForNonVP8MediaSections=function revertSimulcastForNonVP8MediaSections(e,t,n){var a=createMidToMediaSectionMap(n),l=createMidToMediaSectionMap(t),f=getMediaSections(e);return[e.split("\r\nm=")[0]].concat(f.map((function(e){if(e=e.replace(/\r\n$/,""),!/^m=video/.test(e))return e;var t=e.match(/^a=mid:(.+)$/m),n=t&&t[1];if(!n)return e;var f=a.get(n),p=createPtToCodecName(f),h=getPayloadTypesInMediaSection(f);return h.length&&"vp8"===p.get(h[0])?e:l.get(n).replace(/\r\n$/,"")}))).concat("").join("\r\n")},t.setBitrateParameters=function setBitrateParameters(e,t,n,a){var l=getMediaSections(e);return[e.split("\r\nm=")[0]].concat(l.map((function(e){if(!/^m=(audio|video)/.test(e)||!/a=(recvonly|sendrecv)/.test(e))return e;var l=e.match(/^m=(audio|video)/)[1];return function setBitrateInMediaSection(e,t,n){var a=createBLine(e,t)||"",l=/\r\nb=(AS|TIAS):([0-9]+)/,f=n.match(l);if(!f)return n.replace(/(\r\n)?$/,a+"$1");var p=parseInt(f[2],10);return t=t||1/0,a=createBLine(e,Math.min(p,t)),n.replace(l,a)}(t,"audio"===l?n:a,e)}))).join("\r\n")},t.setCodecPreferences=function setCodecPreferences(e,t,n){var a=getMediaSections(e);return[e.split("\r\nm=")[0]].concat(a.map((function(e){if(!/^m=(audio|video)/.test(e))return e;var a=e.match(/^m=(audio|video)/)[1],l=createCodecMapForMediaSection(e),h=function getReorderedPayloadTypes(e,t){t=t.map((function(e){return e.codec.toLowerCase()}));var n=p(t,(function(t){return e.get(t)||[]})),a=f(Array.from(e.keys()),t),l=p(a,(function(t){return e.get(t)}));return n.concat(l)}(l,"audio"===a?t:n),m=setPayloadTypesInMediaSection(h,e),g=l.get("pcma")||[],v=l.get("pcmu")||[];return("audio"===a?new Set(g.concat(v)):new Set).has(h[0])?m.replace(/\r\nb=(AS|TIAS):([0-9]+)/g,""):m}))).join("\r\n")},t.setSimulcast=function setSimulcast(e,t,n){var a=getMediaSections(e);return[e.split("\r\nm=")[0]].concat(a.map((function(e){if(e=e.replace(/\r\n$/,""),!/^m=video/.test(e))return e;var a=createCodecMapForMediaSection(e),l=getPayloadTypesInMediaSection(e),f=new Set(a.get("vp8")||[]);return l.some((function(e){return f.has(e)}))?h(e,t,n):e}))).concat("").join("\r\n")},t.unifiedPlanFilterLocalCodecs=function unifiedPlanFilterLocalCodecs(e,t){var n=getMediaSections(e),a=e.split("\r\nm=")[0],l=createMidToMediaSectionMap(t);return[a].concat(n.map((function(e){return unifiedPlanFilterCodecsInMediaSection(e,l,[])}))).join("\r\n")},t.unifiedPlanAddOrRewriteNewTrackIds=function unifiedPlanAddOrRewriteNewTrackIds(e,t,n){var l=Array.from(n).reduce((function(n,l){var f=a(l,2),p=f[0],h=f[1];return getMediaSections(e,p,"send(only|recv)").map(getMidForMediaSection).filter((function(e){return!t.has(e)})).forEach((function(e,t){return n.set(e,h[t])})),n}),new Map);return unifiedPlanAddOrRewriteTrackIds(e,l)},t.unifiedPlanAddOrRewriteTrackIds=unifiedPlanAddOrRewriteTrackIds},4799:function(e,t,n){"use strict";var a=n(3819).RTCSessionDescription,l=n(1062).createPtToCodecName,f=n(1062).getMediaSections;function mediaSectionWorkaround(e){var t=l(e);e=function deleteDuplicateRtxPts(e,t){return Array.from(t.keys()).reduce((function(e,n){var a=new RegExp("^a=rtpmap:"+n+" rtx.+$","gm");return(e.match(a)||[]).slice("rtx"===t.get(n)?1:0).reduce((function(e,t){var a=new RegExp("\r\n"+t),l=new RegExp("\r\na=fmtp:"+n+" apt=[0-9]+");return e.replace(a,"").replace(l,"")}),e)}),e)}(e,t);var n=function createCodecNameToPts(e){var t=new Map;return e.forEach((function(e,n){var a=t.get(e)||new Set;return t.set(e,a.add(n))})),t}(t),a=n.get("rtx")||new Set,f=new Set,p=function createRtxPtToAssociatedPt(e,t,n,a){return Array.from(n).reduce((function(n,l){var f=new RegExp("a=fmtp:"+l+" apt=(\\d+)"),p=e.match(f);if(!p)return a.add(l),n;var h=Number.parseInt(p[1]);return t.has(h)?"rtx"===t.get(h)?(a.add(l),n):n.set(l,h):(a.add(l),n)}),new Map)}(e,t,a,f),h=function createAssociatedPtToRtxPt(e,t){var n=Array.from(e).reduce((function(e,t){var n=t[0],a=t[1],l=e.get(a)||new Set;return e.set(a,l.add(n))}),new Map);return Array.from(n).reduce((function(e,n){var a=n[0],l=Array.from(n[1]);return l.length>1?(l.forEach((function(e){t.add(e)})),e):e.set(a,l[0])}),new Map)}(p,f),m=Array.from(f);return["h264","vp8","vp9"].reduce((function(e,t){var a=n.get(t)||new Set;return Array.from(a).reduce((function(e,t){return h.has(t)?e:e.add(t)}),e)}),new Set).forEach((function(t){if(m.length){var n=m.shift();e=function addFmtpAttributeForRtxPt(e,t,n){return e.endsWith("\r\n")?e+"a=fmtp:"+t+" apt="+n+"\r\n":e+"\r\na=fmtp:"+t+" apt="+n}(e=deleteFmtpAttributesForRtxPt(e,n),n,t)}})),m.forEach((function(t){e=function deleteRtpmapAttributesForRtxPt(e,t){var n=new RegExp("a=rtpmap:"+t+".*\r\n","gm");return e.replace(n,"")}(e=deleteFmtpAttributesForRtxPt(e,t),t)})),e}function deleteFmtpAttributesForRtxPt(e,t){var n=new RegExp("a=fmtp:"+t+".*\r\n","gm");return e.replace(n,"")}e.exports=function workaround(e){var t={type:e.type};return"rollback"!==e.type&&(t.sdp=function sdpWorkaround(e){var t=f(e);return[e.split("\r\nm=")[0]].concat(t.map(mediaSectionWorkaround)).join("\r\n")}(e.sdp)),new a(t)}},5524:function(e,t,n){"use strict";var a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},l=n(6971).difference,f=n(6971).flatMap;function createSSRC(){return String(Math.floor(4294967295*Math.random()))}var p=function(){function TrackAttributes(e,t,n){Object.defineProperties(this,{cName:{enumerable:!0,value:n},isSimulcastEnabled:{enumerable:!0,value:!1,writable:!0},primarySSRCs:{enumerable:!0,value:new Set},rtxPairs:{enumerable:!0,value:new Map},streamId:{enumerable:!0,value:t},trackId:{enumerable:!0,value:e}})}return TrackAttributes.prototype.addSimulcastSSRCs=function(){if(!this.isSimulcastEnabled){var e=[createSSRC(),createSSRC()];e.forEach((function(e){this.primarySSRCs.add(e)}),this),this.rtxPairs.size&&e.forEach((function(e){this.rtxPairs.set(createSSRC(),e)}),this)}},TrackAttributes.prototype.addSSRC=function(e,t,n){t?this.rtxPairs.set(e,t):this.primarySSRCs.add(e),this.isSimulcastEnabled=this.isSimulcastEnabled||n},TrackAttributes.prototype.toSdpLines=function(e){var t=this,n=e?[]:Array.from(this.rtxPairs.entries()).map((function(e){return e.reverse()})),a=Array.from(this.primarySSRCs.values()),l=n.length?f(n):a,p=f(l,(function(e){return["a=ssrc:"+e+" cname:"+t.cName,"a=ssrc:"+e+" msid:"+t.streamId+" "+t.trackId]})),h=n.map((function(e){return"a=ssrc-group:FID "+e.join(" ")})),m=["a=ssrc-group:SIM "+a.join(" ")];return h.concat(p).concat(m)},TrackAttributes}();function getMatches(e,t){return(e.match(new RegExp(t,"gm"))||[]).map((function(e){return(e.match(new RegExp(t))||[]).slice(1)}))}function createPlanBSSRCAttributeTuples(e){return getMatches(e,"^a=ssrc:([0-9]+) msid:([^\\s]+) ([^\\s]+)$")}function createUnifiedPlanSSRCAttributeTuples(e){var t=a(f(getMatches(e,"^a=msid:(.+) (.+)$")),2),n=t[0],l=t[1];return f(getMatches(e,"^a=ssrc:(.+) cname:.+$")).map((function(e){return[e,n,l]}))}function createTrackIdsToAttributes(e,t){var n=function getSimulcastSSRCs(e){return new Set(f(getMatches(e,"^a=ssrc-group:SIM ([0-9]+) ([0-9]+) ([0-9]+)$")))}(e),a=function getSSRCRtxPairs(e){return new Map(getMatches(e,"^a=ssrc-group:FID ([0-9]+) ([0-9]+)$").map((function(e){return e.reverse()})))}(e),l=function createSSRCAttributeTuples(e,t){return{planb:createPlanBSSRCAttributeTuples,unified:createUnifiedPlanSSRCAttributeTuples}[t](e)}(e,t);return l.reduce((function(t,l){var f=l[0],h=l[1],m=l[2],g=t.get(m)||new p(m,h,function getSSRCAttribute(e,t,n){var a="a=ssrc:"+t+" "+n+":(.+)";return e.match(new RegExp(a))[1]}(e,f,"cname")),v=a.get(f)||null;return g.addSSRC(f,v,n.has(f)),t.set(m,g)}),new Map)}e.exports=function setSimulcastInMediaSection(e,t,n){var a=createTrackIdsToAttributes(e,t),p=Array.from(a.keys()),h=Array.from(n.keys()),m=l(p,h),g=l(h,p);f(m,(function(e){return a.get(e)})).forEach((function(e){e.addSimulcastSSRCs(),n.set(e.trackId,e)})),h=Array.from(n.keys());var v=l(h,g),y=f(v,(function(e){return n.get(e)})),_=!e.match(/a=rtpmap:[0-9]+ rtx/),b=f(y,(function(e){return e.toSdpLines(_)})),C=f(new Set(e.split("\r\n").concat(b))),S="a=x-google-flag:conference";return e.match(S)||C.push(S),C.join("\r\n")}},6723:function(e){"use strict";var t=function(){function IdentityTrackMatcher(){}return IdentityTrackMatcher.prototype.match=function(e){return e.track.id},IdentityTrackMatcher.prototype.update=function(){},IdentityTrackMatcher}();e.exports=t},3284:function(e,t,n){"use strict";var a=n(1062).getMediaSections,l=function(){function MIDTrackMatcher(){Object.defineProperties(this,{_midsToTrackIds:{value:new Map,writable:!0}})}return MIDTrackMatcher.prototype.match=function(e){return this._midsToTrackIds.get(e.transceiver.mid)||null},MIDTrackMatcher.prototype.update=function(e){var t=a(e,"(audio|video)");this._midsToTrackIds=t.reduce((function(e,t){var n=t.match(/^a=mid:(.+)$/m)||[],a=t.match(/^a=msid:.+ (.+)$/m)||[],l=n[1],f=a[1];return l&&f?e.set(l,f):e}),this._midsToTrackIds)},MIDTrackMatcher}();e.exports=l},3226:function(e,t,n){"use strict";var a=n(6971),l=n(1062).getMediaSections;function create(){return{matched:new Set,unmatched:new Set}}var f=function(){function OrderedTrackMatcher(){if(!(this instanceof OrderedTrackMatcher))return new OrderedTrackMatcher;Object.defineProperties(this,{audio:{enumerable:!0,value:create()},video:{enumerable:!0,value:create()}})}return OrderedTrackMatcher.prototype.match=function(e){return function match(e){var t=Array.from(e.unmatched);if(!t.length)return null;var n=t[0];return e.matched.add(n),e.unmatched.delete(n),n}(this[e.track.kind])},OrderedTrackMatcher.prototype.update=function(e){["audio","video"].forEach((function(t){!function update(e,t){t=new Set(t),a.difference(e.matched,t).forEach(e.matched.delete,e.matched),e.unmatched=a.difference(t,e.matched)}(this[t],function parse(e,t){var n=l(t,e),f="msid: ?(.+) +(.+) ?$";return new Set(a.flatMap(n,(function(e){return e.match(new RegExp(f,"mg"))||[]})).map((function(e){return e.match(new RegExp(f))[2]})))}(t,e))}),this)},OrderedTrackMatcher}();e.exports=f},7480:function(e,t){var n="1234567890abcdef";function createSID(e){for(var t="",a=0;a<32;a++)t+=n.charAt(Math.floor(Math.random()*n.length));return""+e+t}t.sessionSID=createSID("SS"),t.createSID=createSID},1345:function(e,t,n){"use strict";var a=n(2939),l=a.guessBrowser,f=a.support,p=n(9943),h=p.isAndroid,m=p.isMobile,g=p.isNonChromiumEdge,v=p.rebrandedChromeBrowser,y=p.mobileWebKitBrowser,_=["crios","edg","edge","electron","headlesschrome"],b=["chrome","firefox"],C=["chrome","safari"],S=[];e.exports=function isSupported(){var e=l();if(!e)return!1;var t=v(e),n=y(e),a=h()?b:C;return!!e&&f()&&(!t||_.includes(t))&&!g(e)&&(!n||S.includes(n))&&(!m()||a.includes(e))}},5317:function(e){"use strict";var t=function(){function Timeout(e,t,n){void 0===n&&(n=!0),Object.defineProperties(this,{_delay:{value:t,writable:!0},_fn:{value:e},_timeout:{value:null,writable:!0}}),n&&this.start()}return Object.defineProperty(Timeout.prototype,"delay",{get:function(){return this._delay},enumerable:!1,configurable:!0}),Object.defineProperty(Timeout.prototype,"isSet",{get:function(){return!!this._timeout},enumerable:!1,configurable:!0}),Timeout.prototype.setDelay=function(e){this._delay=e},Timeout.prototype.start=function(){var e=this;this.isSet||(this._timeout=setTimeout((function(){var t=e._fn;e.clear(),t()}),this._delay))},Timeout.prototype.clear=function(){clearTimeout(this._timeout),this._timeout=null},Timeout.prototype.reset=function(){this.clear(),this.start()},Timeout}();e.exports=t},8144:function(e,t,n){"use strict";var a,l=this&&this.__extends||(a=function(e,t){return a=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},a(e,t)},function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Class extends value "+String(t)+" is not a constructor or null");function __(){this.constructor=e}a(e,t),e.prototype=null===t?Object.create(t):(__.prototype=t.prototype,new __)}),f=n(6196),p={};t.createTwilioError=function createTwilioError(e,t){return t="string"==typeof t&&t?t:"Unknown error",p[e="number"==typeof e?e:0]?new p[e]:new f(e,t)};var h=function(e){function AccessTokenInvalidError(){var t=e.call(this,20101,"Invalid Access Token")||this;return Object.setPrototypeOf(t,AccessTokenInvalidError.prototype),t}return l(AccessTokenInvalidError,e),AccessTokenInvalidError}(f);t.AccessTokenInvalidError=h,Object.defineProperty(p,20101,{value:h});var m=function(e){function AccessTokenHeaderInvalidError(){var t=e.call(this,20102,"Invalid Access Token header")||this;return Object.setPrototypeOf(t,AccessTokenHeaderInvalidError.prototype),t}return l(AccessTokenHeaderInvalidError,e),AccessTokenHeaderInvalidError}(f);t.AccessTokenHeaderInvalidError=m,Object.defineProperty(p,20102,{value:m});var g=function(e){function AccessTokenIssuerInvalidError(){var t=e.call(this,20103,"Invalid Access Token issuer/subject")||this;return Object.setPrototypeOf(t,AccessTokenIssuerInvalidError.prototype),t}return l(AccessTokenIssuerInvalidError,e),AccessTokenIssuerInvalidError}(f);t.AccessTokenIssuerInvalidError=g,Object.defineProperty(p,20103,{value:g});var v=function(e){function AccessTokenExpiredError(){var t=e.call(this,20104,"Access Token expired or expiration date invalid")||this;return Object.setPrototypeOf(t,AccessTokenExpiredError.prototype),t}return l(AccessTokenExpiredError,e),AccessTokenExpiredError}(f);t.AccessTokenExpiredError=v,Object.defineProperty(p,20104,{value:v});var y=function(e){function AccessTokenNotYetValidError(){var t=e.call(this,20105,"Access Token not yet valid")||this;return Object.setPrototypeOf(t,AccessTokenNotYetValidError.prototype),t}return l(AccessTokenNotYetValidError,e),AccessTokenNotYetValidError}(f);t.AccessTokenNotYetValidError=y,Object.defineProperty(p,20105,{value:y});var _=function(e){function AccessTokenGrantsInvalidError(){var t=e.call(this,20106,"Invalid Access Token grants")||this;return Object.setPrototypeOf(t,AccessTokenGrantsInvalidError.prototype),t}return l(AccessTokenGrantsInvalidError,e),AccessTokenGrantsInvalidError}(f);t.AccessTokenGrantsInvalidError=_,Object.defineProperty(p,20106,{value:_});var b=function(e){function AccessTokenSignatureInvalidError(){var t=e.call(this,20107,"Invalid Access Token signature")||this;return Object.setPrototypeOf(t,AccessTokenSignatureInvalidError.prototype),t}return l(AccessTokenSignatureInvalidError,e),AccessTokenSignatureInvalidError}(f);t.AccessTokenSignatureInvalidError=b,Object.defineProperty(p,20107,{value:b});var C=function(e){function SignalingConnectionError(){var t=e.call(this,53e3,"Signaling connection error")||this;return Object.setPrototypeOf(t,SignalingConnectionError.prototype),t}return l(SignalingConnectionError,e),SignalingConnectionError}(f);t.SignalingConnectionError=C,Object.defineProperty(p,53e3,{value:C});var S=function(e){function SignalingConnectionDisconnectedError(){var t=e.call(this,53001,"Signaling connection disconnected")||this;return Object.setPrototypeOf(t,SignalingConnectionDisconnectedError.prototype),t}return l(SignalingConnectionDisconnectedError,e),SignalingConnectionDisconnectedError}(f);t.SignalingConnectionDisconnectedError=S,Object.defineProperty(p,53001,{value:S});var k=function(e){function SignalingConnectionTimeoutError(){var t=e.call(this,53002,"Signaling connection timed out")||this;return Object.setPrototypeOf(t,SignalingConnectionTimeoutError.prototype),t}return l(SignalingConnectionTimeoutError,e),SignalingConnectionTimeoutError}(f);t.SignalingConnectionTimeoutError=k,Object.defineProperty(p,53002,{value:k});var w=function(e){function SignalingIncomingMessageInvalidError(){var t=e.call(this,53003,"Client received an invalid signaling message")||this;return Object.setPrototypeOf(t,SignalingIncomingMessageInvalidError.prototype),t}return l(SignalingIncomingMessageInvalidError,e),SignalingIncomingMessageInvalidError}(f);t.SignalingIncomingMessageInvalidError=w,Object.defineProperty(p,53003,{value:w});var T=function(e){function SignalingOutgoingMessageInvalidError(){var t=e.call(this,53004,"Client sent an invalid signaling message")||this;return Object.setPrototypeOf(t,SignalingOutgoingMessageInvalidError.prototype),t}return l(SignalingOutgoingMessageInvalidError,e),SignalingOutgoingMessageInvalidError}(f);t.SignalingOutgoingMessageInvalidError=T,Object.defineProperty(p,53004,{value:T});var P=function(e){function SignalingServerBusyError(){var t=e.call(this,53006,"Video server is busy")||this;return Object.setPrototypeOf(t,SignalingServerBusyError.prototype),t}return l(SignalingServerBusyError,e),SignalingServerBusyError}(f);t.SignalingServerBusyError=P,Object.defineProperty(p,53006,{value:P});var A=function(e){function RoomNameInvalidError(){var t=e.call(this,53100,"Room name is invalid")||this;return Object.setPrototypeOf(t,RoomNameInvalidError.prototype),t}return l(RoomNameInvalidError,e),RoomNameInvalidError}(f);t.RoomNameInvalidError=A,Object.defineProperty(p,53100,{value:A});var M=function(e){function RoomNameTooLongError(){var t=e.call(this,53101,"Room name is too long")||this;return Object.setPrototypeOf(t,RoomNameTooLongError.prototype),t}return l(RoomNameTooLongError,e),RoomNameTooLongError}(f);t.RoomNameTooLongError=M,Object.defineProperty(p,53101,{value:M});var x=function(e){function RoomNameCharsInvalidError(){var t=e.call(this,53102,"Room name contains invalid characters")||this;return Object.setPrototypeOf(t,RoomNameCharsInvalidError.prototype),t}return l(RoomNameCharsInvalidError,e),RoomNameCharsInvalidError}(f);t.RoomNameCharsInvalidError=x,Object.defineProperty(p,53102,{value:x});var O=function(e){function RoomCreateFailedError(){var t=e.call(this,53103,"Unable to create Room")||this;return Object.setPrototypeOf(t,RoomCreateFailedError.prototype),t}return l(RoomCreateFailedError,e),RoomCreateFailedError}(f);t.RoomCreateFailedError=O,Object.defineProperty(p,53103,{value:O});var R=function(e){function RoomConnectFailedError(){var t=e.call(this,53104,"Unable to connect to Room")||this;return Object.setPrototypeOf(t,RoomConnectFailedError.prototype),t}return l(RoomConnectFailedError,e),RoomConnectFailedError}(f);t.RoomConnectFailedError=R,Object.defineProperty(p,53104,{value:R});var I=function(e){function RoomMaxParticipantsExceededError(){var t=e.call(this,53105,"Room contains too many Participants")||this;return Object.setPrototypeOf(t,RoomMaxParticipantsExceededError.prototype),t}return l(RoomMaxParticipantsExceededError,e),RoomMaxParticipantsExceededError}(f);t.RoomMaxParticipantsExceededError=I,Object.defineProperty(p,53105,{value:I});var L=function(e){function RoomNotFoundError(){var t=e.call(this,53106,"Room not found")||this;return Object.setPrototypeOf(t,RoomNotFoundError.prototype),t}return l(RoomNotFoundError,e),RoomNotFoundError}(f);t.RoomNotFoundError=L,Object.defineProperty(p,53106,{value:L});var N=function(e){function RoomMaxParticipantsOutOfRangeError(){var t=e.call(this,53107,"MaxParticipants is out of range")||this;return Object.setPrototypeOf(t,RoomMaxParticipantsOutOfRangeError.prototype),t}return l(RoomMaxParticipantsOutOfRangeError,e),RoomMaxParticipantsOutOfRangeError}(f);t.RoomMaxParticipantsOutOfRangeError=N,Object.defineProperty(p,53107,{value:N});var D=function(e){function RoomTypeInvalidError(){var t=e.call(this,53108,"RoomType is not valid")||this;return Object.setPrototypeOf(t,RoomTypeInvalidError.prototype),t}return l(RoomTypeInvalidError,e),RoomTypeInvalidError}(f);t.RoomTypeInvalidError=D,Object.defineProperty(p,53108,{value:D});var B=function(e){function RoomTimeoutOutOfRangeError(){var t=e.call(this,53109,"Timeout is out of range")||this;return Object.setPrototypeOf(t,RoomTimeoutOutOfRangeError.prototype),t}return l(RoomTimeoutOutOfRangeError,e),RoomTimeoutOutOfRangeError}(f);t.RoomTimeoutOutOfRangeError=B,Object.defineProperty(p,53109,{value:B});var F=function(e){function RoomStatusCallbackMethodInvalidError(){var t=e.call(this,53110,"StatusCallbackMethod is invalid")||this;return Object.setPrototypeOf(t,RoomStatusCallbackMethodInvalidError.prototype),t}return l(RoomStatusCallbackMethodInvalidError,e),RoomStatusCallbackMethodInvalidError}(f);t.RoomStatusCallbackMethodInvalidError=F,Object.defineProperty(p,53110,{value:F});var j=function(e){function RoomStatusCallbackInvalidError(){var t=e.call(this,53111,"StatusCallback is invalid")||this;return Object.setPrototypeOf(t,RoomStatusCallbackInvalidError.prototype),t}return l(RoomStatusCallbackInvalidError,e),RoomStatusCallbackInvalidError}(f);t.RoomStatusCallbackInvalidError=j,Object.defineProperty(p,53111,{value:j});var $=function(e){function RoomStatusInvalidError(){var t=e.call(this,53112,"Status is invalid")||this;return Object.setPrototypeOf(t,RoomStatusInvalidError.prototype),t}return l(RoomStatusInvalidError,e),RoomStatusInvalidError}(f);t.RoomStatusInvalidError=$,Object.defineProperty(p,53112,{value:$});var H=function(e){function RoomRoomExistsError(){var t=e.call(this,53113,"Room exists")||this;return Object.setPrototypeOf(t,RoomRoomExistsError.prototype),t}return l(RoomRoomExistsError,e),RoomRoomExistsError}(f);t.RoomRoomExistsError=H,Object.defineProperty(p,53113,{value:H});var V=function(e){function RoomInvalidParametersError(){var t=e.call(this,53114,"Room creation parameter(s) incompatible with the Room type")||this;return Object.setPrototypeOf(t,RoomInvalidParametersError.prototype),t}return l(RoomInvalidParametersError,e),RoomInvalidParametersError}(f);t.RoomInvalidParametersError=V,Object.defineProperty(p,53114,{value:V});var U=function(e){function RoomMediaRegionInvalidError(){var t=e.call(this,53115,"MediaRegion is invalid")||this;return Object.setPrototypeOf(t,RoomMediaRegionInvalidError.prototype),t}return l(RoomMediaRegionInvalidError,e),RoomMediaRegionInvalidError}(f);t.RoomMediaRegionInvalidError=U,Object.defineProperty(p,53115,{value:U});var G=function(e){function RoomMediaRegionUnavailableError(){var t=e.call(this,53116,"There are no media servers available in the MediaRegion")||this;return Object.setPrototypeOf(t,RoomMediaRegionUnavailableError.prototype),t}return l(RoomMediaRegionUnavailableError,e),RoomMediaRegionUnavailableError}(f);t.RoomMediaRegionUnavailableError=G,Object.defineProperty(p,53116,{value:G});var q=function(e){function RoomSubscriptionOperationNotSupportedError(){var t=e.call(this,53117,"The subscription operation requested is not supported for the Room type")||this;return Object.setPrototypeOf(t,RoomSubscriptionOperationNotSupportedError.prototype),t}return l(RoomSubscriptionOperationNotSupportedError,e),RoomSubscriptionOperationNotSupportedError}(f);t.RoomSubscriptionOperationNotSupportedError=q,Object.defineProperty(p,53117,{value:q});var W=function(e){function RoomCompletedError(){var t=e.call(this,53118,"Room completed")||this;return Object.setPrototypeOf(t,RoomCompletedError.prototype),t}return l(RoomCompletedError,e),RoomCompletedError}(f);t.RoomCompletedError=W,Object.defineProperty(p,53118,{value:W});var z=function(e){function RoomAudioOnlyFlagNotSupportedError(){var t=e.call(this,53124,"The AudioOnly flag is not supported for the Room type")||this;return Object.setPrototypeOf(t,RoomAudioOnlyFlagNotSupportedError.prototype),t}return l(RoomAudioOnlyFlagNotSupportedError,e),RoomAudioOnlyFlagNotSupportedError}(f);t.RoomAudioOnlyFlagNotSupportedError=z,Object.defineProperty(p,53124,{value:z});var K=function(e){function RoomTrackKindNotSupportedError(){var t=e.call(this,53125,"The track kind is not supported by the Room")||this;return Object.setPrototypeOf(t,RoomTrackKindNotSupportedError.prototype),t}return l(RoomTrackKindNotSupportedError,e),RoomTrackKindNotSupportedError}(f);t.RoomTrackKindNotSupportedError=K,Object.defineProperty(p,53125,{value:K});var Z=function(e){function ParticipantIdentityInvalidError(){var t=e.call(this,53200,"Participant identity is invalid")||this;return Object.setPrototypeOf(t,ParticipantIdentityInvalidError.prototype),t}return l(ParticipantIdentityInvalidError,e),ParticipantIdentityInvalidError}(f);t.ParticipantIdentityInvalidError=Z,Object.defineProperty(p,53200,{value:Z});var Q=function(e){function ParticipantIdentityTooLongError(){var t=e.call(this,53201,"Participant identity is too long")||this;return Object.setPrototypeOf(t,ParticipantIdentityTooLongError.prototype),t}return l(ParticipantIdentityTooLongError,e),ParticipantIdentityTooLongError}(f);t.ParticipantIdentityTooLongError=Q,Object.defineProperty(p,53201,{value:Q});var X=function(e){function ParticipantIdentityCharsInvalidError(){var t=e.call(this,53202,"Participant identity contains invalid characters")||this;return Object.setPrototypeOf(t,ParticipantIdentityCharsInvalidError.prototype),t}return l(ParticipantIdentityCharsInvalidError,e),ParticipantIdentityCharsInvalidError}(f);t.ParticipantIdentityCharsInvalidError=X,Object.defineProperty(p,53202,{value:X});var Y=function(e){function ParticipantMaxTracksExceededError(){var t=e.call(this,53203,"The maximum number of published tracks allowed in the Room at the same time has been reached")||this;return Object.setPrototypeOf(t,ParticipantMaxTracksExceededError.prototype),t}return l(ParticipantMaxTracksExceededError,e),ParticipantMaxTracksExceededError}(f);t.ParticipantMaxTracksExceededError=Y,Object.defineProperty(p,53203,{value:Y});var J=function(e){function ParticipantNotFoundError(){var t=e.call(this,53204,"Participant not found")||this;return Object.setPrototypeOf(t,ParticipantNotFoundError.prototype),t}return l(ParticipantNotFoundError,e),ParticipantNotFoundError}(f);t.ParticipantNotFoundError=J,Object.defineProperty(p,53204,{value:J});var ee=function(e){function ParticipantDuplicateIdentityError(){var t=e.call(this,53205,"Participant disconnected because of duplicate identity")||this;return Object.setPrototypeOf(t,ParticipantDuplicateIdentityError.prototype),t}return l(ParticipantDuplicateIdentityError,e),ParticipantDuplicateIdentityError}(f);t.ParticipantDuplicateIdentityError=ee,Object.defineProperty(p,53205,{value:ee});var te=function(e){function TrackInvalidError(){var t=e.call(this,53300,"Track is invalid")||this;return Object.setPrototypeOf(t,TrackInvalidError.prototype),t}return l(TrackInvalidError,e),TrackInvalidError}(f);t.TrackInvalidError=te,Object.defineProperty(p,53300,{value:te});var ne=function(e){function TrackNameInvalidError(){var t=e.call(this,53301,"Track name is invalid")||this;return Object.setPrototypeOf(t,TrackNameInvalidError.prototype),t}return l(TrackNameInvalidError,e),TrackNameInvalidError}(f);t.TrackNameInvalidError=ne,Object.defineProperty(p,53301,{value:ne});var re=function(e){function TrackNameTooLongError(){var t=e.call(this,53302,"Track name is too long")||this;return Object.setPrototypeOf(t,TrackNameTooLongError.prototype),t}return l(TrackNameTooLongError,e),TrackNameTooLongError}(f);t.TrackNameTooLongError=re,Object.defineProperty(p,53302,{value:re});var oe=function(e){function TrackNameCharsInvalidError(){var t=e.call(this,53303,"Track name contains invalid characters")||this;return Object.setPrototypeOf(t,TrackNameCharsInvalidError.prototype),t}return l(TrackNameCharsInvalidError,e),TrackNameCharsInvalidError}(f);t.TrackNameCharsInvalidError=oe,Object.defineProperty(p,53303,{value:oe});var ie=function(e){function TrackNameIsDuplicatedError(){var t=e.call(this,53304,"Track name is duplicated")||this;return Object.setPrototypeOf(t,TrackNameIsDuplicatedError.prototype),t}return l(TrackNameIsDuplicatedError,e),TrackNameIsDuplicatedError}(f);t.TrackNameIsDuplicatedError=ie,Object.defineProperty(p,53304,{value:ie});var ae=function(e){function TrackServerTrackCapacityReachedError(){var t=e.call(this,53305,"The server has reached capacity and cannot fulfill this request")||this;return Object.setPrototypeOf(t,TrackServerTrackCapacityReachedError.prototype),t}return l(TrackServerTrackCapacityReachedError,e),TrackServerTrackCapacityReachedError}(f);t.TrackServerTrackCapacityReachedError=ae,Object.defineProperty(p,53305,{value:ae});var se=function(e){function MediaClientLocalDescFailedError(){var t=e.call(this,53400,"Client is unable to create or apply a local media description")||this;return Object.setPrototypeOf(t,MediaClientLocalDescFailedError.prototype),t}return l(MediaClientLocalDescFailedError,e),MediaClientLocalDescFailedError}(f);t.MediaClientLocalDescFailedError=se,Object.defineProperty(p,53400,{value:se});var ce=function(e){function MediaServerLocalDescFailedError(){var t=e.call(this,53401,"Server is unable to create or apply a local media description")||this;return Object.setPrototypeOf(t,MediaServerLocalDescFailedError.prototype),t}return l(MediaServerLocalDescFailedError,e),MediaServerLocalDescFailedError}(f);t.MediaServerLocalDescFailedError=ce,Object.defineProperty(p,53401,{value:ce});var le=function(e){function MediaClientRemoteDescFailedError(){var t=e.call(this,53402,"Client is unable to apply a remote media description")||this;return Object.setPrototypeOf(t,MediaClientRemoteDescFailedError.prototype),t}return l(MediaClientRemoteDescFailedError,e),MediaClientRemoteDescFailedError}(f);t.MediaClientRemoteDescFailedError=le,Object.defineProperty(p,53402,{value:le});var ue=function(e){function MediaServerRemoteDescFailedError(){var t=e.call(this,53403,"Server is unable to apply a remote media description")||this;return Object.setPrototypeOf(t,MediaServerRemoteDescFailedError.prototype),t}return l(MediaServerRemoteDescFailedError,e),MediaServerRemoteDescFailedError}(f);t.MediaServerRemoteDescFailedError=ue,Object.defineProperty(p,53403,{value:ue});var de=function(e){function MediaNoSupportedCodecError(){var t=e.call(this,53404,"No supported codec")||this;return Object.setPrototypeOf(t,MediaNoSupportedCodecError.prototype),t}return l(MediaNoSupportedCodecError,e),MediaNoSupportedCodecError}(f);t.MediaNoSupportedCodecError=de,Object.defineProperty(p,53404,{value:de});var fe=function(e){function MediaConnectionError(){var t=e.call(this,53405,"Media connection failed or Media activity ceased")||this;return Object.setPrototypeOf(t,MediaConnectionError.prototype),t}return l(MediaConnectionError,e),MediaConnectionError}(f);t.MediaConnectionError=fe,Object.defineProperty(p,53405,{value:fe});var pe=function(e){function MediaDTLSTransportFailedError(){var t=e.call(this,53407,"Media connection failed due to DTLS handshake failure")||this;return Object.setPrototypeOf(t,MediaDTLSTransportFailedError.prototype),t}return l(MediaDTLSTransportFailedError,e),MediaDTLSTransportFailedError}(f);t.MediaDTLSTransportFailedError=pe,Object.defineProperty(p,53407,{value:pe});var he=function(e){function ConfigurationAcquireFailedError(){var t=e.call(this,53500,"Unable to acquire configuration")||this;return Object.setPrototypeOf(t,ConfigurationAcquireFailedError.prototype),t}return l(ConfigurationAcquireFailedError,e),ConfigurationAcquireFailedError}(f);t.ConfigurationAcquireFailedError=he,Object.defineProperty(p,53500,{value:he});var me=function(e){function ConfigurationAcquireTurnFailedError(){var t=e.call(this,53501,"Unable to acquire TURN credentials")||this;return Object.setPrototypeOf(t,ConfigurationAcquireTurnFailedError.prototype),t}return l(ConfigurationAcquireTurnFailedError,e),ConfigurationAcquireTurnFailedError}(f);t.ConfigurationAcquireTurnFailedError=me,Object.defineProperty(p,53501,{value:me})},6196:function(e){"use strict";var t,n=this&&this.__extends||(t=function(e,n){return t=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])},t(e,n)},function(e,n){if("function"!=typeof n&&null!==n)throw new TypeError("Class extends value "+String(n)+" is not a constructor or null");function __(){this.constructor=e}t(e,n),e.prototype=null===n?Object.create(n):(__.prototype=n.prototype,new __)}),a=this&&this.__read||function(e,t){var n="function"==typeof Symbol&&e[Symbol.iterator];if(!n)return e;var a,l,f=n.call(e),p=[];try{for(;(void 0===t||t-- >0)&&!(a=f.next()).done;)p.push(a.value)}catch(h){l={error:h}}finally{try{a&&!a.done&&(n=f.return)&&n.call(f)}finally{if(l)throw l.error}}return p},l=this&&this.__spreadArray||function(e,t){for(var n=0,a=t.length,l=e.length;n<a;n++,l++)e[l]=t[n];return e},f=function(e){function TwilioError(t){var n=this,f=[].slice.call(arguments,1);n=e.apply(this,l([],a(f)))||this,Object.setPrototypeOf(n,TwilioError.prototype);var p=Error.apply(n,f);return p.name="TwilioError",Object.defineProperty(n,"code",{value:t,enumerable:!0}),Object.getOwnPropertyNames(p).forEach((function(e){Object.defineProperty(this,e,{value:p[e],enumerable:!0})}),n),n}return n(TwilioError,e),TwilioError.prototype.toString=function(){var e=this.message?": "+this.message:"";return this.name+" "+this.code+e},TwilioError}(Error);e.exports=f},324:function(e,t,n){"use strict";var a=n(6971).isNonArrayObject,l=n(2097),f=l.typeErrors,p=l.clientTrackSwitchOffControl,h=l.videoContentPreferencesMode,m=l.subscriptionMode,g=l.trackPriority,v=l.trackSwitchOffMode;function validateObject(e,t,n){return void 0===n&&(n=[]),void 0===e?null:null!==e&&a(e)?n.reduce((function(n,a){var l=a.prop,p=a.type,h=a.values;if(n||!(l in e))return n;var m=e[l];return p&&typeof m!==p||"number"===p&&isNaN(m)?f.INVALID_TYPE(t+"."+l,p):Array.isArray(h)&&!h.includes(m)?f.INVALID_VALUE(t+"."+l,h):n}),null):f.INVALID_TYPE(t,"object")}t.kG=function validateBandwidthProfile(e){var t=validateObject(e,"options.bandwidthProfile");return!e||t?t:(t=validateObject(e.video,"options.bandwidthProfile.video",[{prop:"contentPreferencesMode",values:Object.values(h)},{prop:"dominantSpeakerPriority",values:Object.values(g)},{prop:"maxSubscriptionBitrate",type:"number"},{prop:"maxTracks",type:"number"},{prop:"mode",values:Object.values(m)},{prop:"clientTrackSwitchOffControl",values:Object.values(p)},{prop:"trackSwitchOffMode",values:Object.values(v)}]))||(e.video?"maxTracks"in e.video&&"clientTrackSwitchOffControl"in e.video?new TypeError("options.bandwidthProfile.video.maxTracks is deprecated. Use options.bandwidthProfile.video.clientTrackSwitchOffControl instead."):"renderDimensions"in e.video&&"contentPreferencesMode"in e.video?new TypeError("options.bandwidthProfile.video.renderDimensions is deprecated. Use options.bandwidthProfile.video.contentPreferencesMode instead."):function validateRenderDimensions(e){var t="options.bandwidthProfile.video.renderDimensions",n=validateObject(e,t);return e?n||Object.values(g).reduce((function(n,a){return n||validateObject(e[a],t+"."+a,[{prop:"height",type:"number"},{prop:"width",type:"number"}])}),null):n}(e.video.renderDimensions):null)},t.Wv=function validateLocalTrack(e,t){if(!(e instanceof t.LocalAudioTrack||e instanceof t.LocalDataTrack||e instanceof t.LocalVideoTrack||e instanceof t.MediaStreamTrack))throw f.INVALID_TYPE("track","LocalAudioTrack, LocalVideoTrack, LocalDataTrack, or MediaStreamTrack")}},5021:function(e){var noop=function(){},t="undefined",n=typeof window!==t&&typeof window.navigator!==t&&/Trident\/|MSIE /.test(window.navigator.userAgent),a=["trace","debug","info","warn","error"];function bindMethod(e,t){var n=e[t];if("function"==typeof n.bind)return n.bind(e);try{return Function.prototype.bind.call(n,e)}catch(a){return function(){return Function.prototype.apply.apply(n,[e,arguments])}}}function traceForIE(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function realMethod(e){return"debug"===e&&(e="log"),typeof console!==t&&("trace"===e&&n?traceForIE:void 0!==console[e]?bindMethod(console,e):void 0!==console.log?bindMethod(console,"log"):noop)}function replaceLoggingMethods(e,t){for(var n=0;n<a.length;n++){var l=a[n];this[l]=n<e?noop:this.methodFactory(l,e,t)}this.log=this.debug}function enableLoggingWhenConsoleArrives(e,n,a){return function(){typeof console!==t&&(replaceLoggingMethods.call(this,n,a),this[e].apply(this,arguments))}}function defaultMethodFactory(e,t,n){return realMethod(e)||enableLoggingWhenConsoleArrives.apply(this,arguments)}function Logger(e,n,l){var f,p=this,h="loglevel";function getPersistedLevel(){var e;if(typeof window!==t&&h){try{e=window.localStorage[h]}catch(l){}if(typeof e===t)try{var n=window.document.cookie,a=n.indexOf(encodeURIComponent(h)+"=");-1!==a&&(e=/^([^;]+)/.exec(n.slice(a))[1])}catch(l){}return void 0===p.levels[e]&&(e=void 0),e}}"string"==typeof e?h+=":"+e:"symbol"==typeof e&&(h=void 0),p.name=e,p.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},p.methodFactory=l||defaultMethodFactory,p.getLevel=function(){return f},p.setLevel=function(n,l){if("string"==typeof n&&void 0!==p.levels[n.toUpperCase()]&&(n=p.levels[n.toUpperCase()]),!("number"==typeof n&&n>=0&&n<=p.levels.SILENT))throw"log.setLevel() called with invalid level: "+n;if(f=n,!1!==l&&function persistLevelIfPossible(e){var n=(a[e]||"silent").toUpperCase();if(typeof window!==t&&h){try{return void(window.localStorage[h]=n)}catch(l){}try{window.document.cookie=encodeURIComponent(h)+"="+n+";"}catch(l){}}}(n),replaceLoggingMethods.call(p,n,e),typeof console===t&&n<p.levels.SILENT)return"No console available for logging"},p.setDefaultLevel=function(e){getPersistedLevel()||p.setLevel(e,!1)},p.enableAll=function(e){p.setLevel(p.levels.TRACE,e)},p.disableAll=function(e){p.setLevel(p.levels.SILENT,e)};var m=getPersistedLevel();null==m&&(m=null==n?"WARN":n),p.setLevel(m,!1)}var l=new Logger,f={};l.getLogger=function getLogger(e){if("symbol"!=typeof e&&"string"!=typeof e||""===e)throw new TypeError("You must supply a name when creating a logger.");var t=f[e];return t||(t=f[e]=new Logger(e,l.getLevel(),l.methodFactory)),t};var p=typeof window!==t?window.log:void 0;l.noConflict=function(){return typeof window!==t&&window.log===l&&(window.log=p),l},l.getLoggers=function getLoggers(){return f},l.default=l,e.exports=l},3585:function(e){"use strict";var t="undefined"!=typeof AudioContext?AudioContext:"undefined"!=typeof webkitAudioContext?webkitAudioContext:null,n=function(){function AudioContextFactory(e){e=Object.assign({AudioContext:t},e),Object.defineProperties(this,{_AudioContext:{value:e.AudioContext},_audioContext:{value:null,writable:!0},_holders:{value:new Set},AudioContextFactory:{enumerable:!0,value:AudioContextFactory}})}return AudioContextFactory.prototype.getOrCreate=function(e){if(!this._holders.has(e)&&(this._holders.add(e),this._AudioContext&&!this._audioContext))try{this._audioContext=new this._AudioContext}catch(t){}return this._audioContext},AudioContextFactory.prototype.release=function(e){this._holders.has(e)&&(this._holders.delete(e),!this._holders.size&&this._audioContext&&(this._audioContext.close(),this._audioContext=null))},AudioContextFactory}();e.exports=new n},905:function(e){"use strict";e.exports=function detectSilence(e,t,n){n="number"==typeof n?n:250;var a=e.createMediaStreamSource(t),l=e.createAnalyser();l.fftSize=2048,a.connect(l);var f=new Uint8Array(l.fftSize),p=!1;return setTimeout((function(){p=!0}),n),function doDetectSilence(){return p?Promise.resolve(!0):(l.getByteTimeDomainData(f),f.some((function(e){return 128!==e&&0!==e}))?Promise.resolve(!1):function delay(e){return e="number"==typeof e?e:0,new Promise((function(t){return setTimeout(t,e)}))}().then(doDetectSilence))}().then((function(e){return a.disconnect(),e}),(function(e){throw a.disconnect(),e}))}},6245:function(e,t,n){"use strict";var a=n(905);e.exports=function workaround(e,t,l,f,p){f="number"==typeof f?f:3;var h=0,m=n(3585),g={},v=m.getOrCreate(g);return function doWorkaround(){return t(l).then((function(t){return(l.audio?a(v,t,p).catch((function(t){return e.warn("Encountered an error while detecting silence",t),!0})):Promise.resolve(!1)).then((function(n){return n?f<=0?(e.warn("Got a silent audio MediaStreamTrack. Normally we would try to get a new one, but we've run out of retries; returning it anyway."),t):(e.warn("Got a silent audio MediaStreamTrack. Stopping all MediaStreamTracks and calling getUserMedia again. This is retry #"+ ++h+"."),t.getTracks().forEach((function(e){return e.stop()})),f--,doWorkaround()):(e.info("Got a non-silent audio MediaStreamTrack; returning it."),t)}))}))}().then((function(e){return m.release(g),e}),(function(e){throw m.release(g),e}))}},9990:function(e){e.exports=WebSocket},4752:function(e){e.exports=function uid(e){return e=e||7,Math.random().toString(35).substr(2,e)}},384:function(e){e.exports=function isBuffer(e){return e&&"object"==typeof e&&"function"==typeof e.copy&&"function"==typeof e.fill&&"function"==typeof e.readUInt8}},5955:function(e,t,n){"use strict";var a=n(2584),l=n(8662),f=n(6430),p=n(5692);function uncurryThis(e){return e.call.bind(e)}var h="undefined"!=typeof BigInt,m="undefined"!=typeof Symbol,g=uncurryThis(Object.prototype.toString),v=uncurryThis(Number.prototype.valueOf),y=uncurryThis(String.prototype.valueOf),_=uncurryThis(Boolean.prototype.valueOf);if(h)var b=uncurryThis(BigInt.prototype.valueOf);if(m)var C=uncurryThis(Symbol.prototype.valueOf);function checkBoxedPrimitive(e,t){if("object"!=typeof e)return!1;try{return t(e),!0}catch(n){return!1}}function isMapToString(e){return"[object Map]"===g(e)}function isSetToString(e){return"[object Set]"===g(e)}function isWeakMapToString(e){return"[object WeakMap]"===g(e)}function isWeakSetToString(e){return"[object WeakSet]"===g(e)}function isArrayBufferToString(e){return"[object ArrayBuffer]"===g(e)}function isArrayBuffer(e){return"undefined"!=typeof ArrayBuffer&&(isArrayBufferToString.working?isArrayBufferToString(e):e instanceof ArrayBuffer)}function isDataViewToString(e){return"[object DataView]"===g(e)}function isDataView(e){return"undefined"!=typeof DataView&&(isDataViewToString.working?isDataViewToString(e):e instanceof DataView)}t.isArgumentsObject=a,t.isGeneratorFunction=l,t.isTypedArray=p,t.isPromise=function isPromise(e){return"undefined"!=typeof Promise&&e instanceof Promise||null!==e&&"object"==typeof e&&"function"==typeof e.then&&"function"==typeof e.catch},t.isArrayBufferView=function isArrayBufferView(e){return"undefined"!=typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):p(e)||isDataView(e)},t.isUint8Array=function isUint8Array(e){return"Uint8Array"===f(e)},t.isUint8ClampedArray=function isUint8ClampedArray(e){return"Uint8ClampedArray"===f(e)},t.isUint16Array=function isUint16Array(e){return"Uint16Array"===f(e)},t.isUint32Array=function isUint32Array(e){return"Uint32Array"===f(e)},t.isInt8Array=function isInt8Array(e){return"Int8Array"===f(e)},t.isInt16Array=function isInt16Array(e){return"Int16Array"===f(e)},t.isInt32Array=function isInt32Array(e){return"Int32Array"===f(e)},t.isFloat32Array=function isFloat32Array(e){return"Float32Array"===f(e)},t.isFloat64Array=function isFloat64Array(e){return"Float64Array"===f(e)},t.isBigInt64Array=function isBigInt64Array(e){return"BigInt64Array"===f(e)},t.isBigUint64Array=function isBigUint64Array(e){return"BigUint64Array"===f(e)},isMapToString.working="undefined"!=typeof Map&&isMapToString(new Map),t.isMap=function isMap(e){return"undefined"!=typeof Map&&(isMapToString.working?isMapToString(e):e instanceof Map)},isSetToString.working="undefined"!=typeof Set&&isSetToString(new Set),t.isSet=function isSet(e){return"undefined"!=typeof Set&&(isSetToString.working?isSetToString(e):e instanceof Set)},isWeakMapToString.working="undefined"!=typeof WeakMap&&isWeakMapToString(new WeakMap),t.isWeakMap=function isWeakMap(e){return"undefined"!=typeof WeakMap&&(isWeakMapToString.working?isWeakMapToString(e):e instanceof WeakMap)},isWeakSetToString.working="undefined"!=typeof WeakSet&&isWeakSetToString(new WeakSet),t.isWeakSet=function isWeakSet(e){return isWeakSetToString(e)},isArrayBufferToString.working="undefined"!=typeof ArrayBuffer&&isArrayBufferToString(new ArrayBuffer),t.isArrayBuffer=isArrayBuffer,isDataViewToString.working="undefined"!=typeof ArrayBuffer&&"undefined"!=typeof DataView&&isDataViewToString(new DataView(new ArrayBuffer(1),0,1)),t.isDataView=isDataView;var S="undefined"!=typeof SharedArrayBuffer?SharedArrayBuffer:void 0;function isSharedArrayBufferToString(e){return"[object SharedArrayBuffer]"===g(e)}function isSharedArrayBuffer(e){return void 0!==S&&(void 0===isSharedArrayBufferToString.working&&(isSharedArrayBufferToString.working=isSharedArrayBufferToString(new S)),isSharedArrayBufferToString.working?isSharedArrayBufferToString(e):e instanceof S)}function isNumberObject(e){return checkBoxedPrimitive(e,v)}function isStringObject(e){return checkBoxedPrimitive(e,y)}function isBooleanObject(e){return checkBoxedPrimitive(e,_)}function isBigIntObject(e){return h&&checkBoxedPrimitive(e,b)}function isSymbolObject(e){return m&&checkBoxedPrimitive(e,C)}t.isSharedArrayBuffer=isSharedArrayBuffer,t.isAsyncFunction=function isAsyncFunction(e){return"[object AsyncFunction]"===g(e)},t.isMapIterator=function isMapIterator(e){return"[object Map Iterator]"===g(e)},t.isSetIterator=function isSetIterator(e){return"[object Set Iterator]"===g(e)},t.isGeneratorObject=function isGeneratorObject(e){return"[object Generator]"===g(e)},t.isWebAssemblyCompiledModule=function isWebAssemblyCompiledModule(e){return"[object WebAssembly.Module]"===g(e)},t.isNumberObject=isNumberObject,t.isStringObject=isStringObject,t.isBooleanObject=isBooleanObject,t.isBigIntObject=isBigIntObject,t.isSymbolObject=isSymbolObject,t.isBoxedPrimitive=function isBoxedPrimitive(e){return isNumberObject(e)||isStringObject(e)||isBooleanObject(e)||isBigIntObject(e)||isSymbolObject(e)},t.isAnyArrayBuffer=function isAnyArrayBuffer(e){return"undefined"!=typeof Uint8Array&&(isArrayBuffer(e)||isSharedArrayBuffer(e))},["isProxy","isExternal","isModuleNamespaceObject"].forEach((function(e){Object.defineProperty(t,e,{enumerable:!1,value:function(){throw new Error(e+" is not supported in userland")}})}))},9539:function(e,t,n){var a=n(4155),l=Object.getOwnPropertyDescriptors||function getOwnPropertyDescriptors(e){for(var t=Object.keys(e),n={},a=0;a<t.length;a++)n[t[a]]=Object.getOwnPropertyDescriptor(e,t[a]);return n},f=/%[sdj%]/g;t.format=function(e){if(!isString(e)){for(var t=[],n=0;n<arguments.length;n++)t.push(inspect(arguments[n]));return t.join(" ")}n=1;for(var a=arguments,l=a.length,p=String(e).replace(f,(function(e){if("%%"===e)return"%";if(n>=l)return e;switch(e){case"%s":return String(a[n++]);case"%d":return Number(a[n++]);case"%j":try{return JSON.stringify(a[n++])}catch(t){return"[Circular]"}default:return e}})),h=a[n];n<l;h=a[++n])isNull(h)||!isObject(h)?p+=" "+h:p+=" "+inspect(h);return p},t.deprecate=function(e,n){if(void 0!==a&&!0===a.noDeprecation)return e;if(void 0===a)return function(){return t.deprecate(e,n).apply(this,arguments)};var l=!1;return function deprecated(){if(!l){if(a.throwDeprecation)throw new Error(n);a.traceDeprecation?console.trace(n):console.error(n),l=!0}return e.apply(this,arguments)}};var p={},h=/^$/;if(a.env.NODE_DEBUG){var m=a.env.NODE_DEBUG;m=m.replace(/[|\\{}()[\]^$+?.]/g,"\\$&").replace(/\*/g,".*").replace(/,/g,"$|^").toUpperCase(),h=new RegExp("^"+m+"$","i")}function inspect(e,n){var a={seen:[],stylize:stylizeNoColor};return arguments.length>=3&&(a.depth=arguments[2]),arguments.length>=4&&(a.colors=arguments[3]),isBoolean(n)?a.showHidden=n:n&&t._extend(a,n),isUndefined(a.showHidden)&&(a.showHidden=!1),isUndefined(a.depth)&&(a.depth=2),isUndefined(a.colors)&&(a.colors=!1),isUndefined(a.customInspect)&&(a.customInspect=!0),a.colors&&(a.stylize=stylizeWithColor),formatValue(a,e,a.depth)}function stylizeWithColor(e,t){var n=inspect.styles[t];return n?"["+inspect.colors[n][0]+"m"+e+"["+inspect.colors[n][1]+"m":e}function stylizeNoColor(e,t){return e}function formatValue(e,n,a){if(e.customInspect&&n&&isFunction(n.inspect)&&n.inspect!==t.inspect&&(!n.constructor||n.constructor.prototype!==n)){var l=n.inspect(a,e);return isString(l)||(l=formatValue(e,l,a)),l}var f=function formatPrimitive(e,t){if(isUndefined(t))return e.stylize("undefined","undefined");if(isString(t)){var n="'"+JSON.stringify(t).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return e.stylize(n,"string")}if(isNumber(t))return e.stylize(""+t,"number");if(isBoolean(t))return e.stylize(""+t,"boolean");if(isNull(t))return e.stylize("null","null")}(e,n);if(f)return f;var p=Object.keys(n),h=function arrayToHash(e){var t={};return e.forEach((function(e,n){t[e]=!0})),t}(p);if(e.showHidden&&(p=Object.getOwnPropertyNames(n)),isError(n)&&(p.indexOf("message")>=0||p.indexOf("description")>=0))return formatError(n);if(0===p.length){if(isFunction(n)){var m=n.name?": "+n.name:"";return e.stylize("[Function"+m+"]","special")}if(isRegExp(n))return e.stylize(RegExp.prototype.toString.call(n),"regexp");if(isDate(n))return e.stylize(Date.prototype.toString.call(n),"date");if(isError(n))return formatError(n)}var g,v="",y=!1,_=["{","}"];(isArray(n)&&(y=!0,_=["[","]"]),isFunction(n))&&(v=" [Function"+(n.name?": "+n.name:"")+"]");return isRegExp(n)&&(v=" "+RegExp.prototype.toString.call(n)),isDate(n)&&(v=" "+Date.prototype.toUTCString.call(n)),isError(n)&&(v=" "+formatError(n)),0!==p.length||y&&0!=n.length?a<0?isRegExp(n)?e.stylize(RegExp.prototype.toString.call(n),"regexp"):e.stylize("[Object]","special"):(e.seen.push(n),g=y?function formatArray(e,t,n,a,l){for(var f=[],p=0,h=t.length;p<h;++p)hasOwnProperty(t,String(p))?f.push(formatProperty(e,t,n,a,String(p),!0)):f.push("");return l.forEach((function(l){l.match(/^\d+$/)||f.push(formatProperty(e,t,n,a,l,!0))})),f}(e,n,a,h,p):p.map((function(t){return formatProperty(e,n,a,h,t,y)})),e.seen.pop(),function reduceToSingleString(e,t,n){if(e.reduce((function(e,t){return t.indexOf("\n")>=0&&0,e+t.replace(/\u001b\[\d\d?m/g,"").length+1}),0)>60)return n[0]+(""===t?"":t+"\n ")+" "+e.join(",\n  ")+" "+n[1];return n[0]+t+" "+e.join(", ")+" "+n[1]}(g,v,_)):_[0]+v+_[1]}function formatError(e){return"["+Error.prototype.toString.call(e)+"]"}function formatProperty(e,t,n,a,l,f){var p,h,m;if((m=Object.getOwnPropertyDescriptor(t,l)||{value:t[l]}).get?h=m.set?e.stylize("[Getter/Setter]","special"):e.stylize("[Getter]","special"):m.set&&(h=e.stylize("[Setter]","special")),hasOwnProperty(a,l)||(p="["+l+"]"),h||(e.seen.indexOf(m.value)<0?(h=isNull(n)?formatValue(e,m.value,null):formatValue(e,m.value,n-1)).indexOf("\n")>-1&&(h=f?h.split("\n").map((function(e){return"  "+e})).join("\n").substr(2):"\n"+h.split("\n").map((function(e){return"   "+e})).join("\n")):h=e.stylize("[Circular]","special")),isUndefined(p)){if(f&&l.match(/^\d+$/))return h;(p=JSON.stringify(""+l)).match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(p=p.substr(1,p.length-2),p=e.stylize(p,"name")):(p=p.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),p=e.stylize(p,"string"))}return p+": "+h}function isArray(e){return Array.isArray(e)}function isBoolean(e){return"boolean"==typeof e}function isNull(e){return null===e}function isNumber(e){return"number"==typeof e}function isString(e){return"string"==typeof e}function isUndefined(e){return void 0===e}function isRegExp(e){return isObject(e)&&"[object RegExp]"===objectToString(e)}function isObject(e){return"object"==typeof e&&null!==e}function isDate(e){return isObject(e)&&"[object Date]"===objectToString(e)}function isError(e){return isObject(e)&&("[object Error]"===objectToString(e)||e instanceof Error)}function isFunction(e){return"function"==typeof e}function objectToString(e){return Object.prototype.toString.call(e)}function pad(e){return e<10?"0"+e.toString(10):e.toString(10)}t.debuglog=function(e){if(e=e.toUpperCase(),!p[e])if(h.test(e)){var n=a.pid;p[e]=function(){var a=t.format.apply(t,arguments);console.error("%s %d: %s",e,n,a)}}else p[e]=function(){};return p[e]},t.inspect=inspect,inspect.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},inspect.styles={special:"cyan",number:"yellow",boolean:"yellow",undefined:"grey",null:"bold",string:"green",date:"magenta",regexp:"red"},t.types=n(5955),t.isArray=isArray,t.isBoolean=isBoolean,t.isNull=isNull,t.isNullOrUndefined=function isNullOrUndefined(e){return null==e},t.isNumber=isNumber,t.isString=isString,t.isSymbol=function isSymbol(e){return"symbol"==typeof e},t.isUndefined=isUndefined,t.isRegExp=isRegExp,t.types.isRegExp=isRegExp,t.isObject=isObject,t.isDate=isDate,t.types.isDate=isDate,t.isError=isError,t.types.isNativeError=isError,t.isFunction=isFunction,t.isPrimitive=function isPrimitive(e){return null===e||"boolean"==typeof e||"number"==typeof e||"string"==typeof e||"symbol"==typeof e||void 0===e},t.isBuffer=n(384);var g=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];function timestamp(){var e=new Date,t=[pad(e.getHours()),pad(e.getMinutes()),pad(e.getSeconds())].join(":");return[e.getDate(),g[e.getMonth()],t].join(" ")}function hasOwnProperty(e,t){return Object.prototype.hasOwnProperty.call(e,t)}t.log=function(){console.log("%s - %s",timestamp(),t.format.apply(t,arguments))},t.inherits=n(5717),t._extend=function(e,t){if(!t||!isObject(t))return e;for(var n=Object.keys(t),a=n.length;a--;)e[n[a]]=t[n[a]];return e};var v="undefined"!=typeof Symbol?Symbol("util.promisify.custom"):void 0;function callbackifyOnRejected(e,t){if(!e){var n=new Error("Promise was rejected with a falsy value");n.reason=e,e=n}return t(e)}t.promisify=function promisify(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');if(v&&e[v]){var t;if("function"!=typeof(t=e[v]))throw new TypeError('The "util.promisify.custom" argument must be of type Function');return Object.defineProperty(t,v,{value:t,enumerable:!1,writable:!1,configurable:!0}),t}function t(){for(var t,n,a=new Promise((function(e,a){t=e,n=a})),l=[],f=0;f<arguments.length;f++)l.push(arguments[f]);l.push((function(e,a){e?n(e):t(a)}));try{e.apply(this,l)}catch(p){n(p)}return a}return Object.setPrototypeOf(t,Object.getPrototypeOf(e)),v&&Object.defineProperty(t,v,{value:t,enumerable:!1,writable:!1,configurable:!0}),Object.defineProperties(t,l(e))},t.promisify.custom=v,t.callbackify=function callbackify(e){if("function"!=typeof e)throw new TypeError('The "original" argument must be of type Function');function callbackified(){for(var t=[],n=0;n<arguments.length;n++)t.push(arguments[n]);var l=t.pop();if("function"!=typeof l)throw new TypeError("The last argument must be of type Function");var f=this,cb=function(){return l.apply(f,arguments)};e.apply(this,t).then((function(e){a.nextTick(cb.bind(null,null,e))}),(function(e){a.nextTick(callbackifyOnRejected.bind(null,e,cb))}))}return Object.setPrototypeOf(callbackified,Object.getPrototypeOf(e)),Object.defineProperties(callbackified,l(e)),callbackified}},5934:function(e,t,n){"use strict";var a;n.d(t,{Z:function(){return v}});var l=new Uint8Array(16);function rng(){if(!a&&!(a="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto)))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return a(l)}var f=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-5][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000)$/i;for(var p=function validate(e){return"string"==typeof e&&f.test(e)},h=[],m=0;m<256;++m)h.push((m+256).toString(16).substr(1));var g=function stringify(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,n=(h[e[t+0]]+h[e[t+1]]+h[e[t+2]]+h[e[t+3]]+"-"+h[e[t+4]]+h[e[t+5]]+"-"+h[e[t+6]]+h[e[t+7]]+"-"+h[e[t+8]]+h[e[t+9]]+"-"+h[e[t+10]]+h[e[t+11]]+h[e[t+12]]+h[e[t+13]]+h[e[t+14]]+h[e[t+15]]).toLowerCase();if(!p(n))throw TypeError("Stringified UUID is invalid");return n};var v=function v4(e,t,n){var a=(e=e||{}).random||(e.rng||rng)();if(a[6]=15&a[6]|64,a[8]=63&a[8]|128,t){n=n||0;for(var l=0;l<16;++l)t[n+l]=a[l];return t}return g(a)}},1900:function(e,t,n){"use strict";function normalizeComponent(e,t,n,a,l,f,p,h){var m,g="function"==typeof e?e.options:e;if(t&&(g.render=t,g.staticRenderFns=n,g._compiled=!0),a&&(g.functional=!0),f&&(g._scopeId="data-v-"+f),p?(m=function(e){(e=e||this.$vnode&&this.$vnode.ssrContext||this.parent&&this.parent.$vnode&&this.parent.$vnode.ssrContext)||"undefined"==typeof __VUE_SSR_CONTEXT__||(e=__VUE_SSR_CONTEXT__),l&&l.call(this,e),e&&e._registeredComponents&&e._registeredComponents.add(p)},g._ssrRegister=m):l&&(m=h?function(){l.call(this,(g.functional?this.parent:this).$root.$options.shadowRoot)}:l),m)if(g.functional){g._injectStyles=m;var v=g.render;g.render=function renderWithStyleInjection(e,t){return m.call(t),v(e,t)}}else{var y=g.beforeCreate;g.beforeCreate=y?[].concat(y,m):[m]}return{exports:e,options:g}}n.d(t,{Z:function(){return normalizeComponent}})},538:function(e,t,n){"use strict";
/*!
 * Vue.js v2.6.14
 * (c) 2014-2021 Evan You
 * Released under the MIT License.
 */var a=Object.freeze({});function isUndef(e){return null==e}function isDef(e){return null!=e}function isTrue(e){return!0===e}function isPrimitive(e){return"string"==typeof e||"number"==typeof e||"symbol"==typeof e||"boolean"==typeof e}function isObject(e){return null!==e&&"object"==typeof e}var l=Object.prototype.toString;function isPlainObject(e){return"[object Object]"===l.call(e)}function isRegExp(e){return"[object RegExp]"===l.call(e)}function isValidArrayIndex(e){var t=parseFloat(String(e));return t>=0&&Math.floor(t)===t&&isFinite(e)}function isPromise(e){return isDef(e)&&"function"==typeof e.then&&"function"==typeof e.catch}function toString(e){return null==e?"":Array.isArray(e)||isPlainObject(e)&&e.toString===l?JSON.stringify(e,null,2):String(e)}function toNumber(e){var t=parseFloat(e);return isNaN(t)?e:t}function makeMap(e,t){for(var n=Object.create(null),a=e.split(","),l=0;l<a.length;l++)n[a[l]]=!0;return t?function(e){return n[e.toLowerCase()]}:function(e){return n[e]}}var f=makeMap("slot,component",!0),p=makeMap("key,ref,slot,slot-scope,is");function remove(e,t){if(e.length){var n=e.indexOf(t);if(n>-1)return e.splice(n,1)}}var h=Object.prototype.hasOwnProperty;function hasOwn(e,t){return h.call(e,t)}function cached(e){var t=Object.create(null);return function cachedFn(n){return t[n]||(t[n]=e(n))}}var m=/-(\w)/g,g=cached((function(e){return e.replace(m,(function(e,t){return t?t.toUpperCase():""}))})),v=cached((function(e){return e.charAt(0).toUpperCase()+e.slice(1)})),y=/\B([A-Z])/g,_=cached((function(e){return e.replace(y,"-$1").toLowerCase()}));var b=Function.prototype.bind?function nativeBind(e,t){return e.bind(t)}:function polyfillBind(e,t){function boundFn(n){var a=arguments.length;return a?a>1?e.apply(t,arguments):e.call(t,n):e.call(t)}return boundFn._length=e.length,boundFn};function toArray(e,t){t=t||0;for(var n=e.length-t,a=new Array(n);n--;)a[n]=e[n+t];return a}function extend(e,t){for(var n in t)e[n]=t[n];return e}function toObject(e){for(var t={},n=0;n<e.length;n++)e[n]&&extend(t,e[n]);return t}function noop(e,t,n){}var no=function(e,t,n){return!1},identity=function(e){return e};function looseEqual(e,t){if(e===t)return!0;var n=isObject(e),a=isObject(t);if(!n||!a)return!n&&!a&&String(e)===String(t);try{var l=Array.isArray(e),f=Array.isArray(t);if(l&&f)return e.length===t.length&&e.every((function(e,n){return looseEqual(e,t[n])}));if(e instanceof Date&&t instanceof Date)return e.getTime()===t.getTime();if(l||f)return!1;var p=Object.keys(e),h=Object.keys(t);return p.length===h.length&&p.every((function(n){return looseEqual(e[n],t[n])}))}catch(m){return!1}}function looseIndexOf(e,t){for(var n=0;n<e.length;n++)if(looseEqual(e[n],t))return n;return-1}function once(e){var t=!1;return function(){t||(t=!0,e.apply(this,arguments))}}var C="data-server-rendered",S=["component","directive","filter"],k=["beforeCreate","created","beforeMount","mounted","beforeUpdate","updated","beforeDestroy","destroyed","activated","deactivated","errorCaptured","serverPrefetch"],w={optionMergeStrategies:Object.create(null),silent:!1,productionTip:!1,devtools:!1,performance:!1,errorHandler:null,warnHandler:null,ignoredElements:[],keyCodes:Object.create(null),isReservedTag:no,isReservedAttr:no,isUnknownElement:no,getTagNamespace:noop,parsePlatformTagName:identity,mustUseProp:no,async:!0,_lifecycleHooks:k},T=/a-zA-Z\u00B7\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u037D\u037F-\u1FFF\u200C-\u200D\u203F-\u2040\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD/;function isReserved(e){var t=(e+"").charCodeAt(0);return 36===t||95===t}function def(e,t,n,a){Object.defineProperty(e,t,{value:n,enumerable:!!a,writable:!0,configurable:!0})}var P=new RegExp("[^"+T.source+".$_\\d]");var A,M="__proto__"in{},x="undefined"!=typeof window,O="undefined"!=typeof WXEnvironment&&!!WXEnvironment.platform,R=O&&WXEnvironment.platform.toLowerCase(),I=x&&window.navigator.userAgent.toLowerCase(),L=I&&/msie|trident/.test(I),N=I&&I.indexOf("msie 9.0")>0,D=I&&I.indexOf("edge/")>0,B=(I&&I.indexOf("android"),I&&/iphone|ipad|ipod|ios/.test(I)||"ios"===R),F=(I&&/chrome\/\d+/.test(I),I&&/phantomjs/.test(I),I&&I.match(/firefox\/(\d+)/)),j={}.watch,$=!1;if(x)try{var H={};Object.defineProperty(H,"passive",{get:function get(){$=!0}}),window.addEventListener("test-passive",null,H)}catch(cr){}var isServerRendering=function(){return void 0===A&&(A=!x&&!O&&void 0!==n.g&&(n.g.process&&"server"===n.g.process.env.VUE_ENV)),A},V=x&&window.__VUE_DEVTOOLS_GLOBAL_HOOK__;function isNative(e){return"function"==typeof e&&/native code/.test(e.toString())}var U,G="undefined"!=typeof Symbol&&isNative(Symbol)&&"undefined"!=typeof Reflect&&isNative(Reflect.ownKeys);U="undefined"!=typeof Set&&isNative(Set)?Set:function(){function Set(){this.set=Object.create(null)}return Set.prototype.has=function has(e){return!0===this.set[e]},Set.prototype.add=function add(e){this.set[e]=!0},Set.prototype.clear=function clear(){this.set=Object.create(null)},Set}();var q=noop,W=0,z=function Dep(){this.id=W++,this.subs=[]};z.prototype.addSub=function addSub(e){this.subs.push(e)},z.prototype.removeSub=function removeSub(e){remove(this.subs,e)},z.prototype.depend=function depend(){z.target&&z.target.addDep(this)},z.prototype.notify=function notify(){var e=this.subs.slice();for(var t=0,n=e.length;t<n;t++)e[t].update()},z.target=null;var K=[];function pushTarget(e){K.push(e),z.target=e}function popTarget(){K.pop(),z.target=K[K.length-1]}var Z=function VNode(e,t,n,a,l,f,p,h){this.tag=e,this.data=t,this.children=n,this.text=a,this.elm=l,this.ns=void 0,this.context=f,this.fnContext=void 0,this.fnOptions=void 0,this.fnScopeId=void 0,this.key=t&&t.key,this.componentOptions=p,this.componentInstance=void 0,this.parent=void 0,this.raw=!1,this.isStatic=!1,this.isRootInsert=!0,this.isComment=!1,this.isCloned=!1,this.isOnce=!1,this.asyncFactory=h,this.asyncMeta=void 0,this.isAsyncPlaceholder=!1},Q={child:{configurable:!0}};Q.child.get=function(){return this.componentInstance},Object.defineProperties(Z.prototype,Q);var createEmptyVNode=function(e){void 0===e&&(e="");var t=new Z;return t.text=e,t.isComment=!0,t};function createTextVNode(e){return new Z(void 0,void 0,void 0,String(e))}function cloneVNode(e){var t=new Z(e.tag,e.data,e.children&&e.children.slice(),e.text,e.elm,e.context,e.componentOptions,e.asyncFactory);return t.ns=e.ns,t.isStatic=e.isStatic,t.key=e.key,t.isComment=e.isComment,t.fnContext=e.fnContext,t.fnOptions=e.fnOptions,t.fnScopeId=e.fnScopeId,t.asyncMeta=e.asyncMeta,t.isCloned=!0,t}var X=Array.prototype,Y=Object.create(X);["push","pop","shift","unshift","splice","sort","reverse"].forEach((function(e){var t=X[e];def(Y,e,(function mutator(){for(var n=[],a=arguments.length;a--;)n[a]=arguments[a];var l,f=t.apply(this,n),p=this.__ob__;switch(e){case"push":case"unshift":l=n;break;case"splice":l=n.slice(2)}return l&&p.observeArray(l),p.dep.notify(),f}))}));var J=Object.getOwnPropertyNames(Y),ee=!0;function toggleObserving(e){ee=e}var te=function Observer(e){this.value=e,this.dep=new z,this.vmCount=0,def(e,"__ob__",this),Array.isArray(e)?(M?function protoAugment(e,t){e.__proto__=t}(e,Y):function copyAugment(e,t,n){for(var a=0,l=n.length;a<l;a++){var f=n[a];def(e,f,t[f])}}(e,Y,J),this.observeArray(e)):this.walk(e)};function observe(e,t){var n;if(isObject(e)&&!(e instanceof Z))return hasOwn(e,"__ob__")&&e.__ob__ instanceof te?n=e.__ob__:ee&&!isServerRendering()&&(Array.isArray(e)||isPlainObject(e))&&Object.isExtensible(e)&&!e._isVue&&(n=new te(e)),t&&n&&n.vmCount++,n}function defineReactive$$1(e,t,n,a,l){var f=new z,p=Object.getOwnPropertyDescriptor(e,t);if(!p||!1!==p.configurable){var h=p&&p.get,m=p&&p.set;h&&!m||2!==arguments.length||(n=e[t]);var g=!l&&observe(n);Object.defineProperty(e,t,{enumerable:!0,configurable:!0,get:function reactiveGetter(){var t=h?h.call(e):n;return z.target&&(f.depend(),g&&(g.dep.depend(),Array.isArray(t)&&dependArray(t))),t},set:function reactiveSetter(t){var a=h?h.call(e):n;t===a||t!=t&&a!=a||h&&!m||(m?m.call(e,t):n=t,g=!l&&observe(t),f.notify())}})}}function set(e,t,n){if(Array.isArray(e)&&isValidArrayIndex(t))return e.length=Math.max(e.length,t),e.splice(t,1,n),n;if(t in e&&!(t in Object.prototype))return e[t]=n,n;var a=e.__ob__;return e._isVue||a&&a.vmCount?n:a?(defineReactive$$1(a.value,t,n),a.dep.notify(),n):(e[t]=n,n)}function del(e,t){if(Array.isArray(e)&&isValidArrayIndex(t))e.splice(t,1);else{var n=e.__ob__;e._isVue||n&&n.vmCount||hasOwn(e,t)&&(delete e[t],n&&n.dep.notify())}}function dependArray(e){for(var t=void 0,n=0,a=e.length;n<a;n++)(t=e[n])&&t.__ob__&&t.__ob__.dep.depend(),Array.isArray(t)&&dependArray(t)}te.prototype.walk=function walk(e){for(var t=Object.keys(e),n=0;n<t.length;n++)defineReactive$$1(e,t[n])},te.prototype.observeArray=function observeArray(e){for(var t=0,n=e.length;t<n;t++)observe(e[t])};var ne=w.optionMergeStrategies;function mergeData(e,t){if(!t)return e;for(var n,a,l,f=G?Reflect.ownKeys(t):Object.keys(t),p=0;p<f.length;p++)"__ob__"!==(n=f[p])&&(a=e[n],l=t[n],hasOwn(e,n)?a!==l&&isPlainObject(a)&&isPlainObject(l)&&mergeData(a,l):set(e,n,l));return e}function mergeDataOrFn(e,t,n){return n?function mergedInstanceDataFn(){var a="function"==typeof t?t.call(n,n):t,l="function"==typeof e?e.call(n,n):e;return a?mergeData(a,l):l}:t?e?function mergedDataFn(){return mergeData("function"==typeof t?t.call(this,this):t,"function"==typeof e?e.call(this,this):e)}:t:e}function mergeHook(e,t){var n=t?e?e.concat(t):Array.isArray(t)?t:[t]:e;return n?function dedupeHooks(e){for(var t=[],n=0;n<e.length;n++)-1===t.indexOf(e[n])&&t.push(e[n]);return t}(n):n}function mergeAssets(e,t,n,a){var l=Object.create(e||null);return t?extend(l,t):l}ne.data=function(e,t,n){return n?mergeDataOrFn(e,t,n):t&&"function"!=typeof t?e:mergeDataOrFn(e,t)},k.forEach((function(e){ne[e]=mergeHook})),S.forEach((function(e){ne[e+"s"]=mergeAssets})),ne.watch=function(e,t,n,a){if(e===j&&(e=void 0),t===j&&(t=void 0),!t)return Object.create(e||null);if(!e)return t;var l={};for(var f in extend(l,e),t){var p=l[f],h=t[f];p&&!Array.isArray(p)&&(p=[p]),l[f]=p?p.concat(h):Array.isArray(h)?h:[h]}return l},ne.props=ne.methods=ne.inject=ne.computed=function(e,t,n,a){if(!e)return t;var l=Object.create(null);return extend(l,e),t&&extend(l,t),l},ne.provide=mergeDataOrFn;var defaultStrat=function(e,t){return void 0===t?e:t};function mergeOptions(e,t,n){if("function"==typeof t&&(t=t.options),function normalizeProps(e,t){var n=e.props;if(n){var a,l,f={};if(Array.isArray(n))for(a=n.length;a--;)"string"==typeof(l=n[a])&&(f[g(l)]={type:null});else if(isPlainObject(n))for(var p in n)l=n[p],f[g(p)]=isPlainObject(l)?l:{type:l};e.props=f}}(t),function normalizeInject(e,t){var n=e.inject;if(n){var a=e.inject={};if(Array.isArray(n))for(var l=0;l<n.length;l++)a[n[l]]={from:n[l]};else if(isPlainObject(n))for(var f in n){var p=n[f];a[f]=isPlainObject(p)?extend({from:f},p):{from:p}}}}(t),function normalizeDirectives(e){var t=e.directives;if(t)for(var n in t){var a=t[n];"function"==typeof a&&(t[n]={bind:a,update:a})}}(t),!t._base&&(t.extends&&(e=mergeOptions(e,t.extends,n)),t.mixins))for(var a=0,l=t.mixins.length;a<l;a++)e=mergeOptions(e,t.mixins[a],n);var f,p={};for(f in e)mergeField(f);for(f in t)hasOwn(e,f)||mergeField(f);function mergeField(a){var l=ne[a]||defaultStrat;p[a]=l(e[a],t[a],n,a)}return p}function resolveAsset(e,t,n,a){if("string"==typeof n){var l=e[t];if(hasOwn(l,n))return l[n];var f=g(n);if(hasOwn(l,f))return l[f];var p=v(f);return hasOwn(l,p)?l[p]:l[n]||l[f]||l[p]}}function validateProp(e,t,n,a){var l=t[e],f=!hasOwn(n,e),p=n[e],h=getTypeIndex(Boolean,l.type);if(h>-1)if(f&&!hasOwn(l,"default"))p=!1;else if(""===p||p===_(e)){var m=getTypeIndex(String,l.type);(m<0||h<m)&&(p=!0)}if(void 0===p){p=function getPropDefaultValue(e,t,n){if(!hasOwn(t,"default"))return;var a=t.default;0;if(e&&e.$options.propsData&&void 0===e.$options.propsData[n]&&void 0!==e._props[n])return e._props[n];return"function"==typeof a&&"Function"!==getType(t.type)?a.call(e):a}(a,l,e);var g=ee;toggleObserving(!0),observe(p),toggleObserving(g)}return p}var re=/^\s*function (\w+)/;function getType(e){var t=e&&e.toString().match(re);return t?t[1]:""}function isSameType(e,t){return getType(e)===getType(t)}function getTypeIndex(e,t){if(!Array.isArray(t))return isSameType(t,e)?0:-1;for(var n=0,a=t.length;n<a;n++)if(isSameType(t[n],e))return n;return-1}function handleError(e,t,n){pushTarget();try{if(t)for(var a=t;a=a.$parent;){var l=a.$options.errorCaptured;if(l)for(var f=0;f<l.length;f++)try{if(!1===l[f].call(a,e,t,n))return}catch(cr){globalHandleError(cr,a,"errorCaptured hook")}}globalHandleError(e,t,n)}finally{popTarget()}}function invokeWithErrorHandling(e,t,n,a,l){var f;try{(f=n?e.apply(t,n):e.call(t))&&!f._isVue&&isPromise(f)&&!f._handled&&(f.catch((function(e){return handleError(e,a,l+" (Promise/async)")})),f._handled=!0)}catch(cr){handleError(cr,a,l)}return f}function globalHandleError(e,t,n){if(w.errorHandler)try{return w.errorHandler.call(null,e,t,n)}catch(cr){cr!==e&&logError(cr,null,"config.errorHandler")}logError(e,t,n)}function logError(e,t,n){if(!x&&!O||"undefined"==typeof console)throw e;console.error(e)}var oe,ie=!1,ae=[],se=!1;function flushCallbacks(){se=!1;var e=ae.slice(0);ae.length=0;for(var t=0;t<e.length;t++)e[t]()}if("undefined"!=typeof Promise&&isNative(Promise)){var ce=Promise.resolve();oe=function(){ce.then(flushCallbacks),B&&setTimeout(noop)},ie=!0}else if(L||"undefined"==typeof MutationObserver||!isNative(MutationObserver)&&"[object MutationObserverConstructor]"!==MutationObserver.toString())oe="undefined"!=typeof setImmediate&&isNative(setImmediate)?function(){setImmediate(flushCallbacks)}:function(){setTimeout(flushCallbacks,0)};else{var le=1,ue=new MutationObserver(flushCallbacks),de=document.createTextNode(String(le));ue.observe(de,{characterData:!0}),oe=function(){le=(le+1)%2,de.data=String(le)},ie=!0}function nextTick(e,t){var n;if(ae.push((function(){if(e)try{e.call(t)}catch(cr){handleError(cr,t,"nextTick")}else n&&n(t)})),se||(se=!0,oe()),!e&&"undefined"!=typeof Promise)return new Promise((function(e){n=e}))}var fe=new U;function traverse(e){_traverse(e,fe),fe.clear()}function _traverse(e,t){var n,a,l=Array.isArray(e);if(!(!l&&!isObject(e)||Object.isFrozen(e)||e instanceof Z)){if(e.__ob__){var f=e.__ob__.dep.id;if(t.has(f))return;t.add(f)}if(l)for(n=e.length;n--;)_traverse(e[n],t);else for(n=(a=Object.keys(e)).length;n--;)_traverse(e[a[n]],t)}}var pe=cached((function(e){var t="&"===e.charAt(0),n="~"===(e=t?e.slice(1):e).charAt(0),a="!"===(e=n?e.slice(1):e).charAt(0);return{name:e=a?e.slice(1):e,once:n,capture:a,passive:t}}));function createFnInvoker(e,t){function invoker(){var e=arguments,n=invoker.fns;if(!Array.isArray(n))return invokeWithErrorHandling(n,null,arguments,t,"v-on handler");for(var a=n.slice(),l=0;l<a.length;l++)invokeWithErrorHandling(a[l],null,e,t,"v-on handler")}return invoker.fns=e,invoker}function updateListeners(e,t,n,a,l,f){var p,h,m,g;for(p in e)h=e[p],m=t[p],g=pe(p),isUndef(h)||(isUndef(m)?(isUndef(h.fns)&&(h=e[p]=createFnInvoker(h,f)),isTrue(g.once)&&(h=e[p]=l(g.name,h,g.capture)),n(g.name,h,g.capture,g.passive,g.params)):h!==m&&(m.fns=h,e[p]=m));for(p in t)isUndef(e[p])&&a((g=pe(p)).name,t[p],g.capture)}function mergeVNodeHook(e,t,n){var a;e instanceof Z&&(e=e.data.hook||(e.data.hook={}));var l=e[t];function wrappedHook(){n.apply(this,arguments),remove(a.fns,wrappedHook)}isUndef(l)?a=createFnInvoker([wrappedHook]):isDef(l.fns)&&isTrue(l.merged)?(a=l).fns.push(wrappedHook):a=createFnInvoker([l,wrappedHook]),a.merged=!0,e[t]=a}function checkProp(e,t,n,a,l){if(isDef(t)){if(hasOwn(t,n))return e[n]=t[n],l||delete t[n],!0;if(hasOwn(t,a))return e[n]=t[a],l||delete t[a],!0}return!1}function normalizeChildren(e){return isPrimitive(e)?[createTextVNode(e)]:Array.isArray(e)?normalizeArrayChildren(e):void 0}function isTextNode(e){return isDef(e)&&isDef(e.text)&&function isFalse(e){return!1===e}(e.isComment)}function normalizeArrayChildren(e,t){var n,a,l,f,p=[];for(n=0;n<e.length;n++)isUndef(a=e[n])||"boolean"==typeof a||(f=p[l=p.length-1],Array.isArray(a)?a.length>0&&(isTextNode((a=normalizeArrayChildren(a,(t||"")+"_"+n))[0])&&isTextNode(f)&&(p[l]=createTextVNode(f.text+a[0].text),a.shift()),p.push.apply(p,a)):isPrimitive(a)?isTextNode(f)?p[l]=createTextVNode(f.text+a):""!==a&&p.push(createTextVNode(a)):isTextNode(a)&&isTextNode(f)?p[l]=createTextVNode(f.text+a.text):(isTrue(e._isVList)&&isDef(a.tag)&&isUndef(a.key)&&isDef(t)&&(a.key="__vlist"+t+"_"+n+"__"),p.push(a)));return p}function resolveInject(e,t){if(e){for(var n=Object.create(null),a=G?Reflect.ownKeys(e):Object.keys(e),l=0;l<a.length;l++){var f=a[l];if("__ob__"!==f){for(var p=e[f].from,h=t;h;){if(h._provided&&hasOwn(h._provided,p)){n[f]=h._provided[p];break}h=h.$parent}if(!h)if("default"in e[f]){var m=e[f].default;n[f]="function"==typeof m?m.call(t):m}else 0}}return n}}function resolveSlots(e,t){if(!e||!e.length)return{};for(var n={},a=0,l=e.length;a<l;a++){var f=e[a],p=f.data;if(p&&p.attrs&&p.attrs.slot&&delete p.attrs.slot,f.context!==t&&f.fnContext!==t||!p||null==p.slot)(n.default||(n.default=[])).push(f);else{var h=p.slot,m=n[h]||(n[h]=[]);"template"===f.tag?m.push.apply(m,f.children||[]):m.push(f)}}for(var g in n)n[g].every(isWhitespace)&&delete n[g];return n}function isWhitespace(e){return e.isComment&&!e.asyncFactory||" "===e.text}function isAsyncPlaceholder(e){return e.isComment&&e.asyncFactory}function normalizeScopedSlots(e,t,n){var l,f=Object.keys(t).length>0,p=e?!!e.$stable:!f,h=e&&e.$key;if(e){if(e._normalized)return e._normalized;if(p&&n&&n!==a&&h===n.$key&&!f&&!n.$hasNormal)return n;for(var m in l={},e)e[m]&&"$"!==m[0]&&(l[m]=normalizeScopedSlot(t,m,e[m]))}else l={};for(var g in t)g in l||(l[g]=proxyNormalSlot(t,g));return e&&Object.isExtensible(e)&&(e._normalized=l),def(l,"$stable",p),def(l,"$key",h),def(l,"$hasNormal",f),l}function normalizeScopedSlot(e,t,n){var normalized=function(){var e=arguments.length?n.apply(null,arguments):n({}),t=(e=e&&"object"==typeof e&&!Array.isArray(e)?[e]:normalizeChildren(e))&&e[0];return e&&(!t||1===e.length&&t.isComment&&!isAsyncPlaceholder(t))?void 0:e};return n.proxy&&Object.defineProperty(e,t,{get:normalized,enumerable:!0,configurable:!0}),normalized}function proxyNormalSlot(e,t){return function(){return e[t]}}function renderList(e,t){var n,a,l,f,p;if(Array.isArray(e)||"string"==typeof e)for(n=new Array(e.length),a=0,l=e.length;a<l;a++)n[a]=t(e[a],a);else if("number"==typeof e)for(n=new Array(e),a=0;a<e;a++)n[a]=t(a+1,a);else if(isObject(e))if(G&&e[Symbol.iterator]){n=[];for(var h=e[Symbol.iterator](),m=h.next();!m.done;)n.push(t(m.value,n.length)),m=h.next()}else for(f=Object.keys(e),n=new Array(f.length),a=0,l=f.length;a<l;a++)p=f[a],n[a]=t(e[p],p,a);return isDef(n)||(n=[]),n._isVList=!0,n}function renderSlot(e,t,n,a){var l,f=this.$scopedSlots[e];f?(n=n||{},a&&(n=extend(extend({},a),n)),l=f(n)||("function"==typeof t?t():t)):l=this.$slots[e]||("function"==typeof t?t():t);var p=n&&n.slot;return p?this.$createElement("template",{slot:p},l):l}function resolveFilter(e){return resolveAsset(this.$options,"filters",e)||identity}function isKeyNotMatch(e,t){return Array.isArray(e)?-1===e.indexOf(t):e!==t}function checkKeyCodes(e,t,n,a,l){var f=w.keyCodes[t]||n;return l&&a&&!w.keyCodes[t]?isKeyNotMatch(l,a):f?isKeyNotMatch(f,e):a?_(a)!==t:void 0===e}function bindObjectProps(e,t,n,a,l){if(n)if(isObject(n)){var f;Array.isArray(n)&&(n=toObject(n));var loop=function(h){if("class"===h||"style"===h||p(h))f=e;else{var m=e.attrs&&e.attrs.type;f=a||w.mustUseProp(t,m,h)?e.domProps||(e.domProps={}):e.attrs||(e.attrs={})}var v=g(h),y=_(h);v in f||y in f||(f[h]=n[h],l&&((e.on||(e.on={}))["update:"+h]=function(e){n[h]=e}))};for(var h in n)loop(h)}else;return e}function renderStatic(e,t){var n=this._staticTrees||(this._staticTrees=[]),a=n[e];return a&&!t||markStatic(a=n[e]=this.$options.staticRenderFns[e].call(this._renderProxy,null,this),"__static__"+e,!1),a}function markOnce(e,t,n){return markStatic(e,"__once__"+t+(n?"_"+n:""),!0),e}function markStatic(e,t,n){if(Array.isArray(e))for(var a=0;a<e.length;a++)e[a]&&"string"!=typeof e[a]&&markStaticNode(e[a],t+"_"+a,n);else markStaticNode(e,t,n)}function markStaticNode(e,t,n){e.isStatic=!0,e.key=t,e.isOnce=n}function bindObjectListeners(e,t){if(t)if(isPlainObject(t)){var n=e.on=e.on?extend({},e.on):{};for(var a in t){var l=n[a],f=t[a];n[a]=l?[].concat(l,f):f}}else;return e}function resolveScopedSlots(e,t,n,a){t=t||{$stable:!n};for(var l=0;l<e.length;l++){var f=e[l];Array.isArray(f)?resolveScopedSlots(f,t,n):f&&(f.proxy&&(f.fn.proxy=!0),t[f.key]=f.fn)}return a&&(t.$key=a),t}function bindDynamicKeys(e,t){for(var n=0;n<t.length;n+=2){var a=t[n];"string"==typeof a&&a&&(e[t[n]]=t[n+1])}return e}function prependModifier(e,t){return"string"==typeof e?t+e:e}function installRenderHelpers(e){e._o=markOnce,e._n=toNumber,e._s=toString,e._l=renderList,e._t=renderSlot,e._q=looseEqual,e._i=looseIndexOf,e._m=renderStatic,e._f=resolveFilter,e._k=checkKeyCodes,e._b=bindObjectProps,e._v=createTextVNode,e._e=createEmptyVNode,e._u=resolveScopedSlots,e._g=bindObjectListeners,e._d=bindDynamicKeys,e._p=prependModifier}function FunctionalRenderContext(e,t,n,l,f){var p,h=this,m=f.options;hasOwn(l,"_uid")?(p=Object.create(l))._original=l:(p=l,l=l._original);var g=isTrue(m._compiled),v=!g;this.data=e,this.props=t,this.children=n,this.parent=l,this.listeners=e.on||a,this.injections=resolveInject(m.inject,l),this.slots=function(){return h.$slots||normalizeScopedSlots(e.scopedSlots,h.$slots=resolveSlots(n,l)),h.$slots},Object.defineProperty(this,"scopedSlots",{enumerable:!0,get:function get(){return normalizeScopedSlots(e.scopedSlots,this.slots())}}),g&&(this.$options=m,this.$slots=this.slots(),this.$scopedSlots=normalizeScopedSlots(e.scopedSlots,this.$slots)),m._scopeId?this._c=function(e,t,n,a){var f=createElement(p,e,t,n,a,v);return f&&!Array.isArray(f)&&(f.fnScopeId=m._scopeId,f.fnContext=l),f}:this._c=function(e,t,n,a){return createElement(p,e,t,n,a,v)}}function cloneAndMarkFunctionalResult(e,t,n,a,l){var f=cloneVNode(e);return f.fnContext=n,f.fnOptions=a,t.slot&&((f.data||(f.data={})).slot=t.slot),f}function mergeProps(e,t){for(var n in t)e[g(n)]=t[n]}installRenderHelpers(FunctionalRenderContext.prototype);var he={init:function init(e,t){if(e.componentInstance&&!e.componentInstance._isDestroyed&&e.data.keepAlive){var n=e;he.prepatch(n,n)}else{(e.componentInstance=function createComponentInstanceForVnode(e,t){var n={_isComponent:!0,_parentVnode:e,parent:t},a=e.data.inlineTemplate;isDef(a)&&(n.render=a.render,n.staticRenderFns=a.staticRenderFns);return new e.componentOptions.Ctor(n)}(e,ye)).$mount(t?e.elm:void 0,t)}},prepatch:function prepatch(e,t){var n=t.componentOptions;!function updateChildComponent(e,t,n,l,f){0;var p=l.data.scopedSlots,h=e.$scopedSlots,m=!!(p&&!p.$stable||h!==a&&!h.$stable||p&&e.$scopedSlots.$key!==p.$key||!p&&e.$scopedSlots.$key),g=!!(f||e.$options._renderChildren||m);e.$options._parentVnode=l,e.$vnode=l,e._vnode&&(e._vnode.parent=l);if(e.$options._renderChildren=f,e.$attrs=l.data.attrs||a,e.$listeners=n||a,t&&e.$options.props){toggleObserving(!1);for(var v=e._props,y=e.$options._propKeys||[],_=0;_<y.length;_++){var b=y[_],C=e.$options.props;v[b]=validateProp(b,C,t,e)}toggleObserving(!0),e.$options.propsData=t}n=n||a;var S=e.$options._parentListeners;e.$options._parentListeners=n,updateComponentListeners(e,n,S),g&&(e.$slots=resolveSlots(f,l.context),e.$forceUpdate());0}(t.componentInstance=e.componentInstance,n.propsData,n.listeners,t,n.children)},insert:function insert(e){var t=e.context,n=e.componentInstance;n._isMounted||(n._isMounted=!0,callHook(n,"mounted")),e.data.keepAlive&&(t._isMounted?function queueActivatedComponent(e){e._inactive=!1,be.push(e)}(n):activateChildComponent(n,!0))},destroy:function destroy(e){var t=e.componentInstance;t._isDestroyed||(e.data.keepAlive?deactivateChildComponent(t,!0):t.$destroy())}},me=Object.keys(he);function createComponent(e,t,n,l,f){if(!isUndef(e)){var p=n.$options._base;if(isObject(e)&&(e=p.extend(e)),"function"==typeof e){var h;if(isUndef(e.cid)&&(e=function resolveAsyncComponent(e,t){if(isTrue(e.error)&&isDef(e.errorComp))return e.errorComp;if(isDef(e.resolved))return e.resolved;var n=ve;n&&isDef(e.owners)&&-1===e.owners.indexOf(n)&&e.owners.push(n);if(isTrue(e.loading)&&isDef(e.loadingComp))return e.loadingComp;if(n&&!isDef(e.owners)){var a=e.owners=[n],l=!0,f=null,p=null;n.$on("hook:destroyed",(function(){return remove(a,n)}));var forceRender=function(e){for(var t=0,n=a.length;t<n;t++)a[t].$forceUpdate();e&&(a.length=0,null!==f&&(clearTimeout(f),f=null),null!==p&&(clearTimeout(p),p=null))},h=once((function(n){e.resolved=ensureCtor(n,t),l?a.length=0:forceRender(!0)})),m=once((function(t){isDef(e.errorComp)&&(e.error=!0,forceRender(!0))})),g=e(h,m);return isObject(g)&&(isPromise(g)?isUndef(e.resolved)&&g.then(h,m):isPromise(g.component)&&(g.component.then(h,m),isDef(g.error)&&(e.errorComp=ensureCtor(g.error,t)),isDef(g.loading)&&(e.loadingComp=ensureCtor(g.loading,t),0===g.delay?e.loading=!0:f=setTimeout((function(){f=null,isUndef(e.resolved)&&isUndef(e.error)&&(e.loading=!0,forceRender(!1))}),g.delay||200)),isDef(g.timeout)&&(p=setTimeout((function(){p=null,isUndef(e.resolved)&&m(null)}),g.timeout)))),l=!1,e.loading?e.loadingComp:e.resolved}}(h=e,p),void 0===e))return function createAsyncPlaceholder(e,t,n,a,l){var f=createEmptyVNode();return f.asyncFactory=e,f.asyncMeta={data:t,context:n,children:a,tag:l},f}(h,t,n,l,f);t=t||{},resolveConstructorOptions(e),isDef(t.model)&&function transformModel(e,t){var n=e.model&&e.model.prop||"value",a=e.model&&e.model.event||"input";(t.attrs||(t.attrs={}))[n]=t.model.value;var l=t.on||(t.on={}),f=l[a],p=t.model.callback;isDef(f)?(Array.isArray(f)?-1===f.indexOf(p):f!==p)&&(l[a]=[p].concat(f)):l[a]=p}(e.options,t);var m=function extractPropsFromVNodeData(e,t,n){var a=t.options.props;if(!isUndef(a)){var l={},f=e.attrs,p=e.props;if(isDef(f)||isDef(p))for(var h in a){var m=_(h);checkProp(l,p,h,m,!0)||checkProp(l,f,h,m,!1)}return l}}(t,e);if(isTrue(e.options.functional))return function createFunctionalComponent(e,t,n,l,f){var p=e.options,h={},m=p.props;if(isDef(m))for(var g in m)h[g]=validateProp(g,m,t||a);else isDef(n.attrs)&&mergeProps(h,n.attrs),isDef(n.props)&&mergeProps(h,n.props);var v=new FunctionalRenderContext(n,h,f,l,e),y=p.render.call(null,v._c,v);if(y instanceof Z)return cloneAndMarkFunctionalResult(y,n,v.parent,p);if(Array.isArray(y)){for(var _=normalizeChildren(y)||[],b=new Array(_.length),C=0;C<_.length;C++)b[C]=cloneAndMarkFunctionalResult(_[C],n,v.parent,p);return b}}(e,m,t,n,l);var g=t.on;if(t.on=t.nativeOn,isTrue(e.options.abstract)){var v=t.slot;t={},v&&(t.slot=v)}!function installComponentHooks(e){for(var t=e.hook||(e.hook={}),n=0;n<me.length;n++){var a=me[n],l=t[a],f=he[a];l===f||l&&l._merged||(t[a]=l?mergeHook$1(f,l):f)}}(t);var y=e.options.name||f;return new Z("vue-component-"+e.cid+(y?"-"+y:""),t,void 0,void 0,void 0,n,{Ctor:e,propsData:m,listeners:g,tag:f,children:l},h)}}}function mergeHook$1(e,t){var merged=function(n,a){e(n,a),t(n,a)};return merged._merged=!0,merged}function createElement(e,t,n,a,l,f){return(Array.isArray(n)||isPrimitive(n))&&(l=a,a=n,n=void 0),isTrue(f)&&(l=2),function _createElement(e,t,n,a,l){if(isDef(n)&&isDef(n.__ob__))return createEmptyVNode();isDef(n)&&isDef(n.is)&&(t=n.is);if(!t)return createEmptyVNode();0;Array.isArray(a)&&"function"==typeof a[0]&&((n=n||{}).scopedSlots={default:a[0]},a.length=0);2===l?a=normalizeChildren(a):1===l&&(a=function simpleNormalizeChildren(e){for(var t=0;t<e.length;t++)if(Array.isArray(e[t]))return Array.prototype.concat.apply([],e);return e}(a));var f,p;if("string"==typeof t){var h;p=e.$vnode&&e.$vnode.ns||w.getTagNamespace(t),f=w.isReservedTag(t)?new Z(w.parsePlatformTagName(t),n,a,void 0,void 0,e):n&&n.pre||!isDef(h=resolveAsset(e.$options,"components",t))?new Z(t,n,a,void 0,void 0,e):createComponent(h,n,e,a,t)}else f=createComponent(t,n,e,a);return Array.isArray(f)?f:isDef(f)?(isDef(p)&&applyNS(f,p),isDef(n)&&function registerDeepBindings(e){isObject(e.style)&&traverse(e.style);isObject(e.class)&&traverse(e.class)}(n),f):createEmptyVNode()}(e,t,n,a,l)}function applyNS(e,t,n){if(e.ns=t,"foreignObject"===e.tag&&(t=void 0,n=!0),isDef(e.children))for(var a=0,l=e.children.length;a<l;a++){var f=e.children[a];isDef(f.tag)&&(isUndef(f.ns)||isTrue(n)&&"svg"!==f.tag)&&applyNS(f,t,n)}}var ge,ve=null;function ensureCtor(e,t){return(e.__esModule||G&&"Module"===e[Symbol.toStringTag])&&(e=e.default),isObject(e)?t.extend(e):e}function getFirstComponentChild(e){if(Array.isArray(e))for(var t=0;t<e.length;t++){var n=e[t];if(isDef(n)&&(isDef(n.componentOptions)||isAsyncPlaceholder(n)))return n}}function add(e,t){ge.$on(e,t)}function remove$1(e,t){ge.$off(e,t)}function createOnceHandler(e,t){var n=ge;return function onceHandler(){var a=t.apply(null,arguments);null!==a&&n.$off(e,onceHandler)}}function updateComponentListeners(e,t,n){ge=e,updateListeners(t,n||{},add,remove$1,createOnceHandler,e),ge=void 0}var ye=null;function setActiveInstance(e){var t=ye;return ye=e,function(){ye=t}}function isInInactiveTree(e){for(;e&&(e=e.$parent);)if(e._inactive)return!0;return!1}function activateChildComponent(e,t){if(t){if(e._directInactive=!1,isInInactiveTree(e))return}else if(e._directInactive)return;if(e._inactive||null===e._inactive){e._inactive=!1;for(var n=0;n<e.$children.length;n++)activateChildComponent(e.$children[n]);callHook(e,"activated")}}function deactivateChildComponent(e,t){if(!(t&&(e._directInactive=!0,isInInactiveTree(e))||e._inactive)){e._inactive=!0;for(var n=0;n<e.$children.length;n++)deactivateChildComponent(e.$children[n]);callHook(e,"deactivated")}}function callHook(e,t){pushTarget();var n=e.$options[t],a=t+" hook";if(n)for(var l=0,f=n.length;l<f;l++)invokeWithErrorHandling(n[l],e,null,e,a);e._hasHookEvent&&e.$emit("hook:"+t),popTarget()}var _e=[],be=[],Ce={},Se=!1,ke=!1,we=0;var Te=0,Pe=Date.now;if(x&&!L){var Ee=window.performance;Ee&&"function"==typeof Ee.now&&Pe()>document.createEvent("Event").timeStamp&&(Pe=function(){return Ee.now()})}function flushSchedulerQueue(){var e,t;for(Te=Pe(),ke=!0,_e.sort((function(e,t){return e.id-t.id})),we=0;we<_e.length;we++)(e=_e[we]).before&&e.before(),t=e.id,Ce[t]=null,e.run();var n=be.slice(),a=_e.slice();!function resetSchedulerState(){we=_e.length=be.length=0,Ce={},Se=ke=!1}(),function callActivatedHooks(e){for(var t=0;t<e.length;t++)e[t]._inactive=!0,activateChildComponent(e[t],!0)}(n),function callUpdatedHooks(e){var t=e.length;for(;t--;){var n=e[t],a=n.vm;a._watcher===n&&a._isMounted&&!a._isDestroyed&&callHook(a,"updated")}}(a),V&&w.devtools&&V.emit("flush")}var Ae=0,Me=function Watcher(e,t,n,a,l){this.vm=e,l&&(e._watcher=this),e._watchers.push(this),a?(this.deep=!!a.deep,this.user=!!a.user,this.lazy=!!a.lazy,this.sync=!!a.sync,this.before=a.before):this.deep=this.user=this.lazy=this.sync=!1,this.cb=n,this.id=++Ae,this.active=!0,this.dirty=this.lazy,this.deps=[],this.newDeps=[],this.depIds=new U,this.newDepIds=new U,this.expression="","function"==typeof t?this.getter=t:(this.getter=function parsePath(e){if(!P.test(e)){var t=e.split(".");return function(e){for(var n=0;n<t.length;n++){if(!e)return;e=e[t[n]]}return e}}}(t),this.getter||(this.getter=noop)),this.value=this.lazy?void 0:this.get()};Me.prototype.get=function get(){var e;pushTarget(this);var t=this.vm;try{e=this.getter.call(t,t)}catch(cr){if(!this.user)throw cr;handleError(cr,t,'getter for watcher "'+this.expression+'"')}finally{this.deep&&traverse(e),popTarget(),this.cleanupDeps()}return e},Me.prototype.addDep=function addDep(e){var t=e.id;this.newDepIds.has(t)||(this.newDepIds.add(t),this.newDeps.push(e),this.depIds.has(t)||e.addSub(this))},Me.prototype.cleanupDeps=function cleanupDeps(){for(var e=this.deps.length;e--;){var t=this.deps[e];this.newDepIds.has(t.id)||t.removeSub(this)}var n=this.depIds;this.depIds=this.newDepIds,this.newDepIds=n,this.newDepIds.clear(),n=this.deps,this.deps=this.newDeps,this.newDeps=n,this.newDeps.length=0},Me.prototype.update=function update(){this.lazy?this.dirty=!0:this.sync?this.run():function queueWatcher(e){var t=e.id;if(null==Ce[t]){if(Ce[t]=!0,ke){for(var n=_e.length-1;n>we&&_e[n].id>e.id;)n--;_e.splice(n+1,0,e)}else _e.push(e);Se||(Se=!0,nextTick(flushSchedulerQueue))}}(this)},Me.prototype.run=function run(){if(this.active){var e=this.get();if(e!==this.value||isObject(e)||this.deep){var t=this.value;if(this.value=e,this.user){var n='callback for watcher "'+this.expression+'"';invokeWithErrorHandling(this.cb,this.vm,[e,t],this.vm,n)}else this.cb.call(this.vm,e,t)}}},Me.prototype.evaluate=function evaluate(){this.value=this.get(),this.dirty=!1},Me.prototype.depend=function depend(){for(var e=this.deps.length;e--;)this.deps[e].depend()},Me.prototype.teardown=function teardown(){if(this.active){this.vm._isBeingDestroyed||remove(this.vm._watchers,this);for(var e=this.deps.length;e--;)this.deps[e].removeSub(this);this.active=!1}};var xe={enumerable:!0,configurable:!0,get:noop,set:noop};function proxy(e,t,n){xe.get=function proxyGetter(){return this[t][n]},xe.set=function proxySetter(e){this[t][n]=e},Object.defineProperty(e,n,xe)}function initState(e){e._watchers=[];var t=e.$options;t.props&&function initProps(e,t){var n=e.$options.propsData||{},a=e._props={},l=e.$options._propKeys=[];e.$parent&&toggleObserving(!1);var loop=function(f){l.push(f);var p=validateProp(f,t,n,e);defineReactive$$1(a,f,p),f in e||proxy(e,"_props",f)};for(var f in t)loop(f);toggleObserving(!0)}(e,t.props),t.methods&&function initMethods(e,t){e.$options.props;for(var n in t)e[n]="function"!=typeof t[n]?noop:b(t[n],e)}(e,t.methods),t.data?function initData(e){var t=e.$options.data;isPlainObject(t=e._data="function"==typeof t?function getData(e,t){pushTarget();try{return e.call(t,t)}catch(cr){return handleError(cr,t,"data()"),{}}finally{popTarget()}}(t,e):t||{})||(t={});var n=Object.keys(t),a=e.$options.props,l=(e.$options.methods,n.length);for(;l--;){var f=n[l];0,a&&hasOwn(a,f)||isReserved(f)||proxy(e,"_data",f)}observe(t,!0)}(e):observe(e._data={},!0),t.computed&&function initComputed(e,t){var n=e._computedWatchers=Object.create(null),a=isServerRendering();for(var l in t){var f=t[l],p="function"==typeof f?f:f.get;0,a||(n[l]=new Me(e,p||noop,noop,Oe)),l in e||defineComputed(e,l,f)}}(e,t.computed),t.watch&&t.watch!==j&&function initWatch(e,t){for(var n in t){var a=t[n];if(Array.isArray(a))for(var l=0;l<a.length;l++)createWatcher(e,n,a[l]);else createWatcher(e,n,a)}}(e,t.watch)}var Oe={lazy:!0};function defineComputed(e,t,n){var a=!isServerRendering();"function"==typeof n?(xe.get=a?createComputedGetter(t):createGetterInvoker(n),xe.set=noop):(xe.get=n.get?a&&!1!==n.cache?createComputedGetter(t):createGetterInvoker(n.get):noop,xe.set=n.set||noop),Object.defineProperty(e,t,xe)}function createComputedGetter(e){return function computedGetter(){var t=this._computedWatchers&&this._computedWatchers[e];if(t)return t.dirty&&t.evaluate(),z.target&&t.depend(),t.value}}function createGetterInvoker(e){return function computedGetter(){return e.call(this,this)}}function createWatcher(e,t,n,a){return isPlainObject(n)&&(a=n,n=n.handler),"string"==typeof n&&(n=e[n]),e.$watch(t,n,a)}var Re=0;function resolveConstructorOptions(e){var t=e.options;if(e.super){var n=resolveConstructorOptions(e.super);if(n!==e.superOptions){e.superOptions=n;var a=function resolveModifiedOptions(e){var t,n=e.options,a=e.sealedOptions;for(var l in n)n[l]!==a[l]&&(t||(t={}),t[l]=n[l]);return t}(e);a&&extend(e.extendOptions,a),(t=e.options=mergeOptions(n,e.extendOptions)).name&&(t.components[t.name]=e)}}return t}function Vue(e){this._init(e)}function initExtend(e){e.cid=0;var t=1;e.extend=function(e){e=e||{};var n=this,a=n.cid,l=e._Ctor||(e._Ctor={});if(l[a])return l[a];var f=e.name||n.options.name;var p=function VueComponent(e){this._init(e)};return(p.prototype=Object.create(n.prototype)).constructor=p,p.cid=t++,p.options=mergeOptions(n.options,e),p.super=n,p.options.props&&function initProps$1(e){var t=e.options.props;for(var n in t)proxy(e.prototype,"_props",n)}(p),p.options.computed&&function initComputed$1(e){var t=e.options.computed;for(var n in t)defineComputed(e.prototype,n,t[n])}(p),p.extend=n.extend,p.mixin=n.mixin,p.use=n.use,S.forEach((function(e){p[e]=n[e]})),f&&(p.options.components[f]=p),p.superOptions=n.options,p.extendOptions=e,p.sealedOptions=extend({},p.options),l[a]=p,p}}function getComponentName(e){return e&&(e.Ctor.options.name||e.tag)}function matches(e,t){return Array.isArray(e)?e.indexOf(t)>-1:"string"==typeof e?e.split(",").indexOf(t)>-1:!!isRegExp(e)&&e.test(t)}function pruneCache(e,t){var n=e.cache,a=e.keys,l=e._vnode;for(var f in n){var p=n[f];if(p){var h=p.name;h&&!t(h)&&pruneCacheEntry(n,f,a,l)}}}function pruneCacheEntry(e,t,n,a){var l=e[t];!l||a&&l.tag===a.tag||l.componentInstance.$destroy(),e[t]=null,remove(n,t)}!function initMixin(e){e.prototype._init=function(e){var t=this;t._uid=Re++,t._isVue=!0,e&&e._isComponent?function initInternalComponent(e,t){var n=e.$options=Object.create(e.constructor.options),a=t._parentVnode;n.parent=t.parent,n._parentVnode=a;var l=a.componentOptions;n.propsData=l.propsData,n._parentListeners=l.listeners,n._renderChildren=l.children,n._componentTag=l.tag,t.render&&(n.render=t.render,n.staticRenderFns=t.staticRenderFns)}(t,e):t.$options=mergeOptions(resolveConstructorOptions(t.constructor),e||{},t),t._renderProxy=t,t._self=t,function initLifecycle(e){var t=e.$options,n=t.parent;if(n&&!t.abstract){for(;n.$options.abstract&&n.$parent;)n=n.$parent;n.$children.push(e)}e.$parent=n,e.$root=n?n.$root:e,e.$children=[],e.$refs={},e._watcher=null,e._inactive=null,e._directInactive=!1,e._isMounted=!1,e._isDestroyed=!1,e._isBeingDestroyed=!1}(t),function initEvents(e){e._events=Object.create(null),e._hasHookEvent=!1;var t=e.$options._parentListeners;t&&updateComponentListeners(e,t)}(t),function initRender(e){e._vnode=null,e._staticTrees=null;var t=e.$options,n=e.$vnode=t._parentVnode,l=n&&n.context;e.$slots=resolveSlots(t._renderChildren,l),e.$scopedSlots=a,e._c=function(t,n,a,l){return createElement(e,t,n,a,l,!1)},e.$createElement=function(t,n,a,l){return createElement(e,t,n,a,l,!0)};var f=n&&n.data;defineReactive$$1(e,"$attrs",f&&f.attrs||a,null,!0),defineReactive$$1(e,"$listeners",t._parentListeners||a,null,!0)}(t),callHook(t,"beforeCreate"),function initInjections(e){var t=resolveInject(e.$options.inject,e);t&&(toggleObserving(!1),Object.keys(t).forEach((function(n){defineReactive$$1(e,n,t[n])})),toggleObserving(!0))}(t),initState(t),function initProvide(e){var t=e.$options.provide;t&&(e._provided="function"==typeof t?t.call(e):t)}(t),callHook(t,"created"),t.$options.el&&t.$mount(t.$options.el)}}(Vue),function stateMixin(e){var t={get:function(){return this._data}},n={get:function(){return this._props}};Object.defineProperty(e.prototype,"$data",t),Object.defineProperty(e.prototype,"$props",n),e.prototype.$set=set,e.prototype.$delete=del,e.prototype.$watch=function(e,t,n){var a=this;if(isPlainObject(t))return createWatcher(a,e,t,n);(n=n||{}).user=!0;var l=new Me(a,e,t,n);if(n.immediate){var f='callback for immediate watcher "'+l.expression+'"';pushTarget(),invokeWithErrorHandling(t,a,[l.value],a,f),popTarget()}return function unwatchFn(){l.teardown()}}}(Vue),function eventsMixin(e){var t=/^hook:/;e.prototype.$on=function(e,n){var a=this;if(Array.isArray(e))for(var l=0,f=e.length;l<f;l++)a.$on(e[l],n);else(a._events[e]||(a._events[e]=[])).push(n),t.test(e)&&(a._hasHookEvent=!0);return a},e.prototype.$once=function(e,t){var n=this;function on(){n.$off(e,on),t.apply(n,arguments)}return on.fn=t,n.$on(e,on),n},e.prototype.$off=function(e,t){var n=this;if(!arguments.length)return n._events=Object.create(null),n;if(Array.isArray(e)){for(var a=0,l=e.length;a<l;a++)n.$off(e[a],t);return n}var f,p=n._events[e];if(!p)return n;if(!t)return n._events[e]=null,n;for(var h=p.length;h--;)if((f=p[h])===t||f.fn===t){p.splice(h,1);break}return n},e.prototype.$emit=function(e){var t=this,n=t._events[e];if(n){n=n.length>1?toArray(n):n;for(var a=toArray(arguments,1),l='event handler for "'+e+'"',f=0,p=n.length;f<p;f++)invokeWithErrorHandling(n[f],t,a,t,l)}return t}}(Vue),function lifecycleMixin(e){e.prototype._update=function(e,t){var n=this,a=n.$el,l=n._vnode,f=setActiveInstance(n);n._vnode=e,n.$el=l?n.__patch__(l,e):n.__patch__(n.$el,e,t,!1),f(),a&&(a.__vue__=null),n.$el&&(n.$el.__vue__=n),n.$vnode&&n.$parent&&n.$vnode===n.$parent._vnode&&(n.$parent.$el=n.$el)},e.prototype.$forceUpdate=function(){this._watcher&&this._watcher.update()},e.prototype.$destroy=function(){var e=this;if(!e._isBeingDestroyed){callHook(e,"beforeDestroy"),e._isBeingDestroyed=!0;var t=e.$parent;!t||t._isBeingDestroyed||e.$options.abstract||remove(t.$children,e),e._watcher&&e._watcher.teardown();for(var n=e._watchers.length;n--;)e._watchers[n].teardown();e._data.__ob__&&e._data.__ob__.vmCount--,e._isDestroyed=!0,e.__patch__(e._vnode,null),callHook(e,"destroyed"),e.$off(),e.$el&&(e.$el.__vue__=null),e.$vnode&&(e.$vnode.parent=null)}}}(Vue),function renderMixin(e){installRenderHelpers(e.prototype),e.prototype.$nextTick=function(e){return nextTick(e,this)},e.prototype._render=function(){var e,t=this,n=t.$options,a=n.render,l=n._parentVnode;l&&(t.$scopedSlots=normalizeScopedSlots(l.data.scopedSlots,t.$slots,t.$scopedSlots)),t.$vnode=l;try{ve=t,e=a.call(t._renderProxy,t.$createElement)}catch(cr){handleError(cr,t,"render"),e=t._vnode}finally{ve=null}return Array.isArray(e)&&1===e.length&&(e=e[0]),e instanceof Z||(e=createEmptyVNode()),e.parent=l,e}}(Vue);var Ie=[String,RegExp,Array],Le={name:"keep-alive",abstract:!0,props:{include:Ie,exclude:Ie,max:[String,Number]},methods:{cacheVNode:function cacheVNode(){var e=this,t=e.cache,n=e.keys,a=e.vnodeToCache,l=e.keyToCache;if(a){var f=a.tag,p=a.componentInstance,h=a.componentOptions;t[l]={name:getComponentName(h),tag:f,componentInstance:p},n.push(l),this.max&&n.length>parseInt(this.max)&&pruneCacheEntry(t,n[0],n,this._vnode),this.vnodeToCache=null}}},created:function created(){this.cache=Object.create(null),this.keys=[]},destroyed:function destroyed(){for(var e in this.cache)pruneCacheEntry(this.cache,e,this.keys)},mounted:function mounted(){var e=this;this.cacheVNode(),this.$watch("include",(function(t){pruneCache(e,(function(e){return matches(t,e)}))})),this.$watch("exclude",(function(t){pruneCache(e,(function(e){return!matches(t,e)}))}))},updated:function updated(){this.cacheVNode()},render:function render(){var e=this.$slots.default,t=getFirstComponentChild(e),n=t&&t.componentOptions;if(n){var a=getComponentName(n),l=this.include,f=this.exclude;if(l&&(!a||!matches(l,a))||f&&a&&matches(f,a))return t;var p=this.cache,h=this.keys,m=null==t.key?n.Ctor.cid+(n.tag?"::"+n.tag:""):t.key;p[m]?(t.componentInstance=p[m].componentInstance,remove(h,m),h.push(m)):(this.vnodeToCache=t,this.keyToCache=m),t.data.keepAlive=!0}return t||e&&e[0]}},Ne={KeepAlive:Le};!function initGlobalAPI(e){var t={get:function(){return w}};Object.defineProperty(e,"config",t),e.util={warn:q,extend:extend,mergeOptions:mergeOptions,defineReactive:defineReactive$$1},e.set=set,e.delete=del,e.nextTick=nextTick,e.observable=function(e){return observe(e),e},e.options=Object.create(null),S.forEach((function(t){e.options[t+"s"]=Object.create(null)})),e.options._base=e,extend(e.options.components,Ne),function initUse(e){e.use=function(e){var t=this._installedPlugins||(this._installedPlugins=[]);if(t.indexOf(e)>-1)return this;var n=toArray(arguments,1);return n.unshift(this),"function"==typeof e.install?e.install.apply(e,n):"function"==typeof e&&e.apply(null,n),t.push(e),this}}(e),function initMixin$1(e){e.mixin=function(e){return this.options=mergeOptions(this.options,e),this}}(e),initExtend(e),function initAssetRegisters(e){S.forEach((function(t){e[t]=function(e,n){return n?("component"===t&&isPlainObject(n)&&(n.name=n.name||e,n=this.options._base.extend(n)),"directive"===t&&"function"==typeof n&&(n={bind:n,update:n}),this.options[t+"s"][e]=n,n):this.options[t+"s"][e]}}))}(e)}(Vue),Object.defineProperty(Vue.prototype,"$isServer",{get:isServerRendering}),Object.defineProperty(Vue.prototype,"$ssrContext",{get:function get(){return this.$vnode&&this.$vnode.ssrContext}}),Object.defineProperty(Vue,"FunctionalRenderContext",{value:FunctionalRenderContext}),Vue.version="2.6.14";var De=makeMap("style,class"),Be=makeMap("input,textarea,option,select,progress"),mustUseProp=function(e,t,n){return"value"===n&&Be(e)&&"button"!==t||"selected"===n&&"option"===e||"checked"===n&&"input"===e||"muted"===n&&"video"===e},Fe=makeMap("contenteditable,draggable,spellcheck"),je=makeMap("events,caret,typing,plaintext-only"),$e=makeMap("allowfullscreen,async,autofocus,autoplay,checked,compact,controls,declare,default,defaultchecked,defaultmuted,defaultselected,defer,disabled,enabled,formnovalidate,hidden,indeterminate,inert,ismap,itemscope,loop,multiple,muted,nohref,noresize,noshade,novalidate,nowrap,open,pauseonexit,readonly,required,reversed,scoped,seamless,selected,sortable,truespeed,typemustmatch,visible"),He="http://www.w3.org/1999/xlink",isXlink=function(e){return":"===e.charAt(5)&&"xlink"===e.slice(0,5)},getXlinkProp=function(e){return isXlink(e)?e.slice(6,e.length):""},isFalsyAttrValue=function(e){return null==e||!1===e};function genClassForVnode(e){for(var t=e.data,n=e,a=e;isDef(a.componentInstance);)(a=a.componentInstance._vnode)&&a.data&&(t=mergeClassData(a.data,t));for(;isDef(n=n.parent);)n&&n.data&&(t=mergeClassData(t,n.data));return function renderClass(e,t){if(isDef(e)||isDef(t))return concat(e,stringifyClass(t));return""}(t.staticClass,t.class)}function mergeClassData(e,t){return{staticClass:concat(e.staticClass,t.staticClass),class:isDef(e.class)?[e.class,t.class]:t.class}}function concat(e,t){return e?t?e+" "+t:e:t||""}function stringifyClass(e){return Array.isArray(e)?function stringifyArray(e){for(var t,n="",a=0,l=e.length;a<l;a++)isDef(t=stringifyClass(e[a]))&&""!==t&&(n&&(n+=" "),n+=t);return n}(e):isObject(e)?function stringifyObject(e){var t="";for(var n in e)e[n]&&(t&&(t+=" "),t+=n);return t}(e):"string"==typeof e?e:""}var Ve={svg:"http://www.w3.org/2000/svg",math:"http://www.w3.org/1998/Math/MathML"},Ue=makeMap("html,body,base,head,link,meta,style,title,address,article,aside,footer,header,h1,h2,h3,h4,h5,h6,hgroup,nav,section,div,dd,dl,dt,figcaption,figure,picture,hr,img,li,main,ol,p,pre,ul,a,b,abbr,bdi,bdo,br,cite,code,data,dfn,em,i,kbd,mark,q,rp,rt,rtc,ruby,s,samp,small,span,strong,sub,sup,time,u,var,wbr,area,audio,map,track,video,embed,object,param,source,canvas,script,noscript,del,ins,caption,col,colgroup,table,thead,tbody,td,th,tr,button,datalist,fieldset,form,input,label,legend,meter,optgroup,option,output,progress,select,textarea,details,dialog,menu,menuitem,summary,content,element,shadow,template,blockquote,iframe,tfoot"),Ge=makeMap("svg,animate,circle,clippath,cursor,defs,desc,ellipse,filter,font-face,foreignobject,g,glyph,image,line,marker,mask,missing-glyph,path,pattern,polygon,polyline,rect,switch,symbol,text,textpath,tspan,use,view",!0),isReservedTag=function(e){return Ue(e)||Ge(e)};function getTagNamespace(e){return Ge(e)?"svg":"math"===e?"math":void 0}var qe=Object.create(null);var We=makeMap("text,number,password,search,email,tel,url");function query(e){if("string"==typeof e){var t=document.querySelector(e);return t||document.createElement("div")}return e}var ze=Object.freeze({createElement:function createElement$1(e,t){var n=document.createElement(e);return"select"!==e||t.data&&t.data.attrs&&void 0!==t.data.attrs.multiple&&n.setAttribute("multiple","multiple"),n},createElementNS:function createElementNS(e,t){return document.createElementNS(Ve[e],t)},createTextNode:function createTextNode(e){return document.createTextNode(e)},createComment:function createComment(e){return document.createComment(e)},insertBefore:function insertBefore(e,t,n){e.insertBefore(t,n)},removeChild:function removeChild(e,t){e.removeChild(t)},appendChild:function appendChild(e,t){e.appendChild(t)},parentNode:function parentNode(e){return e.parentNode},nextSibling:function nextSibling(e){return e.nextSibling},tagName:function tagName(e){return e.tagName},setTextContent:function setTextContent(e,t){e.textContent=t},setStyleScope:function setStyleScope(e,t){e.setAttribute(t,"")}}),Ke={create:function create(e,t){registerRef(t)},update:function update(e,t){e.data.ref!==t.data.ref&&(registerRef(e,!0),registerRef(t))},destroy:function destroy(e){registerRef(e,!0)}};function registerRef(e,t){var n=e.data.ref;if(isDef(n)){var a=e.context,l=e.componentInstance||e.elm,f=a.$refs;t?Array.isArray(f[n])?remove(f[n],l):f[n]===l&&(f[n]=void 0):e.data.refInFor?Array.isArray(f[n])?f[n].indexOf(l)<0&&f[n].push(l):f[n]=[l]:f[n]=l}}var Ze=new Z("",{},[]),Qe=["create","activate","update","remove","destroy"];function sameVnode(e,t){return e.key===t.key&&e.asyncFactory===t.asyncFactory&&(e.tag===t.tag&&e.isComment===t.isComment&&isDef(e.data)===isDef(t.data)&&function sameInputType(e,t){if("input"!==e.tag)return!0;var n,a=isDef(n=e.data)&&isDef(n=n.attrs)&&n.type,l=isDef(n=t.data)&&isDef(n=n.attrs)&&n.type;return a===l||We(a)&&We(l)}(e,t)||isTrue(e.isAsyncPlaceholder)&&isUndef(t.asyncFactory.error))}function createKeyToOldIdx(e,t,n){var a,l,f={};for(a=t;a<=n;++a)isDef(l=e[a].key)&&(f[l]=a);return f}var Xe={create:updateDirectives,update:updateDirectives,destroy:function unbindDirectives(e){updateDirectives(e,Ze)}};function updateDirectives(e,t){(e.data.directives||t.data.directives)&&function _update(e,t){var n,a,l,f=e===Ze,p=t===Ze,h=normalizeDirectives$1(e.data.directives,e.context),m=normalizeDirectives$1(t.data.directives,t.context),g=[],v=[];for(n in m)a=h[n],l=m[n],a?(l.oldValue=a.value,l.oldArg=a.arg,callHook$1(l,"update",t,e),l.def&&l.def.componentUpdated&&v.push(l)):(callHook$1(l,"bind",t,e),l.def&&l.def.inserted&&g.push(l));if(g.length){var callInsert=function(){for(var n=0;n<g.length;n++)callHook$1(g[n],"inserted",t,e)};f?mergeVNodeHook(t,"insert",callInsert):callInsert()}v.length&&mergeVNodeHook(t,"postpatch",(function(){for(var n=0;n<v.length;n++)callHook$1(v[n],"componentUpdated",t,e)}));if(!f)for(n in h)m[n]||callHook$1(h[n],"unbind",e,e,p)}(e,t)}var Ye=Object.create(null);function normalizeDirectives$1(e,t){var n,a,l=Object.create(null);if(!e)return l;for(n=0;n<e.length;n++)(a=e[n]).modifiers||(a.modifiers=Ye),l[getRawDirName(a)]=a,a.def=resolveAsset(t.$options,"directives",a.name);return l}function getRawDirName(e){return e.rawName||e.name+"."+Object.keys(e.modifiers||{}).join(".")}function callHook$1(e,t,n,a,l){var f=e.def&&e.def[t];if(f)try{f(n.elm,e,n,a,l)}catch(cr){handleError(cr,n.context,"directive "+e.name+" "+t+" hook")}}var Je=[Ke,Xe];function updateAttrs(e,t){var n=t.componentOptions;if(!(isDef(n)&&!1===n.Ctor.options.inheritAttrs||isUndef(e.data.attrs)&&isUndef(t.data.attrs))){var a,l,f=t.elm,p=e.data.attrs||{},h=t.data.attrs||{};for(a in isDef(h.__ob__)&&(h=t.data.attrs=extend({},h)),h)l=h[a],p[a]!==l&&setAttr(f,a,l,t.data.pre);for(a in(L||D)&&h.value!==p.value&&setAttr(f,"value",h.value),p)isUndef(h[a])&&(isXlink(a)?f.removeAttributeNS(He,getXlinkProp(a)):Fe(a)||f.removeAttribute(a))}}function setAttr(e,t,n,a){a||e.tagName.indexOf("-")>-1?baseSetAttr(e,t,n):$e(t)?isFalsyAttrValue(n)?e.removeAttribute(t):(n="allowfullscreen"===t&&"EMBED"===e.tagName?"true":t,e.setAttribute(t,n)):Fe(t)?e.setAttribute(t,function(e,t){return isFalsyAttrValue(t)||"false"===t?"false":"contenteditable"===e&&je(t)?t:"true"}(t,n)):isXlink(t)?isFalsyAttrValue(n)?e.removeAttributeNS(He,getXlinkProp(t)):e.setAttributeNS(He,t,n):baseSetAttr(e,t,n)}function baseSetAttr(e,t,n){if(isFalsyAttrValue(n))e.removeAttribute(t);else{if(L&&!N&&"TEXTAREA"===e.tagName&&"placeholder"===t&&""!==n&&!e.__ieph){var blocker=function(t){t.stopImmediatePropagation(),e.removeEventListener("input",blocker)};e.addEventListener("input",blocker),e.__ieph=!0}e.setAttribute(t,n)}}var et={create:updateAttrs,update:updateAttrs};function updateClass(e,t){var n=t.elm,a=t.data,l=e.data;if(!(isUndef(a.staticClass)&&isUndef(a.class)&&(isUndef(l)||isUndef(l.staticClass)&&isUndef(l.class)))){var f=genClassForVnode(t),p=n._transitionClasses;isDef(p)&&(f=concat(f,stringifyClass(p))),f!==n._prevClass&&(n.setAttribute("class",f),n._prevClass=f)}}var tt,nt,rt,ot,it,at,st={create:updateClass,update:updateClass},ct=/[\w).+\-_$\]]/;function parseFilters(e){var t,n,a,l,f,p=!1,h=!1,m=!1,g=!1,v=0,y=0,_=0,b=0;for(a=0;a<e.length;a++)if(n=t,t=e.charCodeAt(a),p)39===t&&92!==n&&(p=!1);else if(h)34===t&&92!==n&&(h=!1);else if(m)96===t&&92!==n&&(m=!1);else if(g)47===t&&92!==n&&(g=!1);else if(124!==t||124===e.charCodeAt(a+1)||124===e.charCodeAt(a-1)||v||y||_){switch(t){case 34:h=!0;break;case 39:p=!0;break;case 96:m=!0;break;case 40:_++;break;case 41:_--;break;case 91:y++;break;case 93:y--;break;case 123:v++;break;case 125:v--}if(47===t){for(var C=a-1,S=void 0;C>=0&&" "===(S=e.charAt(C));C--);S&&ct.test(S)||(g=!0)}}else void 0===l?(b=a+1,l=e.slice(0,a).trim()):pushFilter();function pushFilter(){(f||(f=[])).push(e.slice(b,a).trim()),b=a+1}if(void 0===l?l=e.slice(0,a).trim():0!==b&&pushFilter(),f)for(a=0;a<f.length;a++)l=wrapFilter(l,f[a]);return l}function wrapFilter(e,t){var n=t.indexOf("(");if(n<0)return'_f("'+t+'")('+e+")";var a=t.slice(0,n),l=t.slice(n+1);return'_f("'+a+'")('+e+(")"!==l?","+l:l)}function baseWarn(e,t){console.error("[Vue compiler]: "+e)}function pluckModuleFunction(e,t){return e?e.map((function(e){return e[t]})).filter((function(e){return e})):[]}function addProp(e,t,n,a,l){(e.props||(e.props=[])).push(rangeSetItem({name:t,value:n,dynamic:l},a)),e.plain=!1}function addAttr(e,t,n,a,l){(l?e.dynamicAttrs||(e.dynamicAttrs=[]):e.attrs||(e.attrs=[])).push(rangeSetItem({name:t,value:n,dynamic:l},a)),e.plain=!1}function addRawAttr(e,t,n,a){e.attrsMap[t]=n,e.attrsList.push(rangeSetItem({name:t,value:n},a))}function addDirective(e,t,n,a,l,f,p,h){(e.directives||(e.directives=[])).push(rangeSetItem({name:t,rawName:n,value:a,arg:l,isDynamicArg:f,modifiers:p},h)),e.plain=!1}function prependModifierMarker(e,t,n){return n?"_p("+t+',"'+e+'")':e+t}function addHandler(e,t,n,l,f,p,h,m){var g;(l=l||a).right?m?t="("+t+")==='click'?'contextmenu':("+t+")":"click"===t&&(t="contextmenu",delete l.right):l.middle&&(m?t="("+t+")==='click'?'mouseup':("+t+")":"click"===t&&(t="mouseup")),l.capture&&(delete l.capture,t=prependModifierMarker("!",t,m)),l.once&&(delete l.once,t=prependModifierMarker("~",t,m)),l.passive&&(delete l.passive,t=prependModifierMarker("&",t,m)),l.native?(delete l.native,g=e.nativeEvents||(e.nativeEvents={})):g=e.events||(e.events={});var v=rangeSetItem({value:n.trim(),dynamic:m},h);l!==a&&(v.modifiers=l);var y=g[t];Array.isArray(y)?f?y.unshift(v):y.push(v):g[t]=y?f?[v,y]:[y,v]:v,e.plain=!1}function getBindingAttr(e,t,n){var a=getAndRemoveAttr(e,":"+t)||getAndRemoveAttr(e,"v-bind:"+t);if(null!=a)return parseFilters(a);if(!1!==n){var l=getAndRemoveAttr(e,t);if(null!=l)return JSON.stringify(l)}}function getAndRemoveAttr(e,t,n){var a;if(null!=(a=e.attrsMap[t]))for(var l=e.attrsList,f=0,p=l.length;f<p;f++)if(l[f].name===t){l.splice(f,1);break}return n&&delete e.attrsMap[t],a}function getAndRemoveAttrByRegex(e,t){for(var n=e.attrsList,a=0,l=n.length;a<l;a++){var f=n[a];if(t.test(f.name))return n.splice(a,1),f}}function rangeSetItem(e,t){return t&&(null!=t.start&&(e.start=t.start),null!=t.end&&(e.end=t.end)),e}function genComponentModel(e,t,n){var a=n||{},l=a.number,f="$$v",p=f;a.trim&&(p="(typeof $$v === 'string'? $$v.trim(): $$v)"),l&&(p="_n("+p+")");var h=genAssignmentCode(t,p);e.model={value:"("+t+")",expression:JSON.stringify(t),callback:"function ($$v) {"+h+"}"}}function genAssignmentCode(e,t){var n=function parseModel(e){if(e=e.trim(),tt=e.length,e.indexOf("[")<0||e.lastIndexOf("]")<tt-1)return(ot=e.lastIndexOf("."))>-1?{exp:e.slice(0,ot),key:'"'+e.slice(ot+1)+'"'}:{exp:e,key:null};nt=e,ot=it=at=0;for(;!eof();)isStringStart(rt=next())?parseString(rt):91===rt&&parseBracket(rt);return{exp:e.slice(0,it),key:e.slice(it+1,at)}}(e);return null===n.key?e+"="+t:"$set("+n.exp+", "+n.key+", "+t+")"}function next(){return nt.charCodeAt(++ot)}function eof(){return ot>=tt}function isStringStart(e){return 34===e||39===e}function parseBracket(e){var t=1;for(it=ot;!eof();)if(isStringStart(e=next()))parseString(e);else if(91===e&&t++,93===e&&t--,0===t){at=ot;break}}function parseString(e){for(var t=e;!eof()&&(e=next())!==t;);}var lt,ut="__r";function createOnceHandler$1(e,t,n){var a=lt;return function onceHandler(){var l=t.apply(null,arguments);null!==l&&remove$2(e,onceHandler,n,a)}}var dt=ie&&!(F&&Number(F[1])<=53);function add$1(e,t,n,a){if(dt){var l=Te,f=t;t=f._wrapper=function(e){if(e.target===e.currentTarget||e.timeStamp>=l||e.timeStamp<=0||e.target.ownerDocument!==document)return f.apply(this,arguments)}}lt.addEventListener(e,t,$?{capture:n,passive:a}:n)}function remove$2(e,t,n,a){(a||lt).removeEventListener(e,t._wrapper||t,n)}function updateDOMListeners(e,t){if(!isUndef(e.data.on)||!isUndef(t.data.on)){var n=t.data.on||{},a=e.data.on||{};lt=t.elm,function normalizeEvents(e){if(isDef(e.__r)){var t=L?"change":"input";e[t]=[].concat(e.__r,e[t]||[]),delete e.__r}isDef(e.__c)&&(e.change=[].concat(e.__c,e.change||[]),delete e.__c)}(n),updateListeners(n,a,add$1,remove$2,createOnceHandler$1,t.context),lt=void 0}}var ft,pt={create:updateDOMListeners,update:updateDOMListeners};function updateDOMProps(e,t){if(!isUndef(e.data.domProps)||!isUndef(t.data.domProps)){var n,a,l=t.elm,f=e.data.domProps||{},p=t.data.domProps||{};for(n in isDef(p.__ob__)&&(p=t.data.domProps=extend({},p)),f)n in p||(l[n]="");for(n in p){if(a=p[n],"textContent"===n||"innerHTML"===n){if(t.children&&(t.children.length=0),a===f[n])continue;1===l.childNodes.length&&l.removeChild(l.childNodes[0])}if("value"===n&&"PROGRESS"!==l.tagName){l._value=a;var h=isUndef(a)?"":String(a);shouldUpdateValue(l,h)&&(l.value=h)}else if("innerHTML"===n&&Ge(l.tagName)&&isUndef(l.innerHTML)){(ft=ft||document.createElement("div")).innerHTML="<svg>"+a+"</svg>";for(var m=ft.firstChild;l.firstChild;)l.removeChild(l.firstChild);for(;m.firstChild;)l.appendChild(m.firstChild)}else if(a!==f[n])try{l[n]=a}catch(cr){}}}}function shouldUpdateValue(e,t){return!e.composing&&("OPTION"===e.tagName||function isNotInFocusAndDirty(e,t){var n=!0;try{n=document.activeElement!==e}catch(cr){}return n&&e.value!==t}(e,t)||function isDirtyWithModifiers(e,t){var n=e.value,a=e._vModifiers;if(isDef(a)){if(a.number)return toNumber(n)!==toNumber(t);if(a.trim)return n.trim()!==t.trim()}return n!==t}(e,t))}var ht={create:updateDOMProps,update:updateDOMProps},mt=cached((function(e){var t={},n=/:(.+)/;return e.split(/;(?![^(]*\))/g).forEach((function(e){if(e){var a=e.split(n);a.length>1&&(t[a[0].trim()]=a[1].trim())}})),t}));function normalizeStyleData(e){var t=normalizeStyleBinding(e.style);return e.staticStyle?extend(e.staticStyle,t):t}function normalizeStyleBinding(e){return Array.isArray(e)?toObject(e):"string"==typeof e?mt(e):e}var gt,vt=/^--/,yt=/\s*!important$/,setProp=function(e,t,n){if(vt.test(t))e.style.setProperty(t,n);else if(yt.test(n))e.style.setProperty(_(t),n.replace(yt,""),"important");else{var a=bt(t);if(Array.isArray(n))for(var l=0,f=n.length;l<f;l++)e.style[a]=n[l];else e.style[a]=n}},_t=["Webkit","Moz","ms"],bt=cached((function(e){if(gt=gt||document.createElement("div").style,"filter"!==(e=g(e))&&e in gt)return e;for(var t=e.charAt(0).toUpperCase()+e.slice(1),n=0;n<_t.length;n++){var a=_t[n]+t;if(a in gt)return a}}));function updateStyle(e,t){var n=t.data,a=e.data;if(!(isUndef(n.staticStyle)&&isUndef(n.style)&&isUndef(a.staticStyle)&&isUndef(a.style))){var l,f,p=t.elm,h=a.staticStyle,m=a.normalizedStyle||a.style||{},g=h||m,v=normalizeStyleBinding(t.data.style)||{};t.data.normalizedStyle=isDef(v.__ob__)?extend({},v):v;var y=function getStyle(e,t){var n,a={};if(t)for(var l=e;l.componentInstance;)(l=l.componentInstance._vnode)&&l.data&&(n=normalizeStyleData(l.data))&&extend(a,n);(n=normalizeStyleData(e.data))&&extend(a,n);for(var f=e;f=f.parent;)f.data&&(n=normalizeStyleData(f.data))&&extend(a,n);return a}(t,!0);for(f in g)isUndef(y[f])&&setProp(p,f,"");for(f in y)(l=y[f])!==g[f]&&setProp(p,f,null==l?"":l)}}var Ct={create:updateStyle,update:updateStyle},St=/\s+/;function addClass(e,t){if(t&&(t=t.trim()))if(e.classList)t.indexOf(" ")>-1?t.split(St).forEach((function(t){return e.classList.add(t)})):e.classList.add(t);else{var n=" "+(e.getAttribute("class")||"")+" ";n.indexOf(" "+t+" ")<0&&e.setAttribute("class",(n+t).trim())}}function removeClass(e,t){if(t&&(t=t.trim()))if(e.classList)t.indexOf(" ")>-1?t.split(St).forEach((function(t){return e.classList.remove(t)})):e.classList.remove(t),e.classList.length||e.removeAttribute("class");else{for(var n=" "+(e.getAttribute("class")||"")+" ",a=" "+t+" ";n.indexOf(a)>=0;)n=n.replace(a," ");(n=n.trim())?e.setAttribute("class",n):e.removeAttribute("class")}}function resolveTransition(e){if(e){if("object"==typeof e){var t={};return!1!==e.css&&extend(t,kt(e.name||"v")),extend(t,e),t}return"string"==typeof e?kt(e):void 0}}var kt=cached((function(e){return{enterClass:e+"-enter",enterToClass:e+"-enter-to",enterActiveClass:e+"-enter-active",leaveClass:e+"-leave",leaveToClass:e+"-leave-to",leaveActiveClass:e+"-leave-active"}})),wt=x&&!N,Tt="transition",Pt="animation",Et="transition",At="transitionend",Mt="animation",xt="animationend";wt&&(void 0===window.ontransitionend&&void 0!==window.onwebkittransitionend&&(Et="WebkitTransition",At="webkitTransitionEnd"),void 0===window.onanimationend&&void 0!==window.onwebkitanimationend&&(Mt="WebkitAnimation",xt="webkitAnimationEnd"));var Ot=x?window.requestAnimationFrame?window.requestAnimationFrame.bind(window):setTimeout:function(e){return e()};function nextFrame(e){Ot((function(){Ot(e)}))}function addTransitionClass(e,t){var n=e._transitionClasses||(e._transitionClasses=[]);n.indexOf(t)<0&&(n.push(t),addClass(e,t))}function removeTransitionClass(e,t){e._transitionClasses&&remove(e._transitionClasses,t),removeClass(e,t)}function whenTransitionEnds(e,t,n){var a=getTransitionInfo(e,t),l=a.type,f=a.timeout,p=a.propCount;if(!l)return n();var h=l===Tt?At:xt,m=0,end=function(){e.removeEventListener(h,onEnd),n()},onEnd=function(t){t.target===e&&++m>=p&&end()};setTimeout((function(){m<p&&end()}),f+1),e.addEventListener(h,onEnd)}var Rt=/\b(transform|all)(,|$)/;function getTransitionInfo(e,t){var n,a=window.getComputedStyle(e),l=(a[Et+"Delay"]||"").split(", "),f=(a[Et+"Duration"]||"").split(", "),p=getTimeout(l,f),h=(a[Mt+"Delay"]||"").split(", "),m=(a[Mt+"Duration"]||"").split(", "),g=getTimeout(h,m),v=0,y=0;return t===Tt?p>0&&(n=Tt,v=p,y=f.length):t===Pt?g>0&&(n=Pt,v=g,y=m.length):y=(n=(v=Math.max(p,g))>0?p>g?Tt:Pt:null)?n===Tt?f.length:m.length:0,{type:n,timeout:v,propCount:y,hasTransform:n===Tt&&Rt.test(a[Et+"Property"])}}function getTimeout(e,t){for(;e.length<t.length;)e=e.concat(e);return Math.max.apply(null,t.map((function(t,n){return toMs(t)+toMs(e[n])})))}function toMs(e){return 1e3*Number(e.slice(0,-1).replace(",","."))}function enter(e,t){var n=e.elm;isDef(n._leaveCb)&&(n._leaveCb.cancelled=!0,n._leaveCb());var a=resolveTransition(e.data.transition);if(!isUndef(a)&&!isDef(n._enterCb)&&1===n.nodeType){for(var l=a.css,f=a.type,p=a.enterClass,h=a.enterToClass,m=a.enterActiveClass,g=a.appearClass,v=a.appearToClass,y=a.appearActiveClass,_=a.beforeEnter,b=a.enter,C=a.afterEnter,S=a.enterCancelled,k=a.beforeAppear,w=a.appear,T=a.afterAppear,P=a.appearCancelled,A=a.duration,M=ye,x=ye.$vnode;x&&x.parent;)M=x.context,x=x.parent;var O=!M._isMounted||!e.isRootInsert;if(!O||w||""===w){var R=O&&g?g:p,I=O&&y?y:m,L=O&&v?v:h,D=O&&k||_,B=O&&"function"==typeof w?w:b,F=O&&T||C,j=O&&P||S,$=toNumber(isObject(A)?A.enter:A);0;var H=!1!==l&&!N,V=getHookArgumentsLength(B),U=n._enterCb=once((function(){H&&(removeTransitionClass(n,L),removeTransitionClass(n,I)),U.cancelled?(H&&removeTransitionClass(n,R),j&&j(n)):F&&F(n),n._enterCb=null}));e.data.show||mergeVNodeHook(e,"insert",(function(){var t=n.parentNode,a=t&&t._pending&&t._pending[e.key];a&&a.tag===e.tag&&a.elm._leaveCb&&a.elm._leaveCb(),B&&B(n,U)})),D&&D(n),H&&(addTransitionClass(n,R),addTransitionClass(n,I),nextFrame((function(){removeTransitionClass(n,R),U.cancelled||(addTransitionClass(n,L),V||(isValidDuration($)?setTimeout(U,$):whenTransitionEnds(n,f,U)))}))),e.data.show&&(t&&t(),B&&B(n,U)),H||V||U()}}}function leave(e,t){var n=e.elm;isDef(n._enterCb)&&(n._enterCb.cancelled=!0,n._enterCb());var a=resolveTransition(e.data.transition);if(isUndef(a)||1!==n.nodeType)return t();if(!isDef(n._leaveCb)){var l=a.css,f=a.type,p=a.leaveClass,h=a.leaveToClass,m=a.leaveActiveClass,g=a.beforeLeave,v=a.leave,y=a.afterLeave,_=a.leaveCancelled,b=a.delayLeave,C=a.duration,S=!1!==l&&!N,k=getHookArgumentsLength(v),w=toNumber(isObject(C)?C.leave:C);0;var T=n._leaveCb=once((function(){n.parentNode&&n.parentNode._pending&&(n.parentNode._pending[e.key]=null),S&&(removeTransitionClass(n,h),removeTransitionClass(n,m)),T.cancelled?(S&&removeTransitionClass(n,p),_&&_(n)):(t(),y&&y(n)),n._leaveCb=null}));b?b(performLeave):performLeave()}function performLeave(){T.cancelled||(!e.data.show&&n.parentNode&&((n.parentNode._pending||(n.parentNode._pending={}))[e.key]=e),g&&g(n),S&&(addTransitionClass(n,p),addTransitionClass(n,m),nextFrame((function(){removeTransitionClass(n,p),T.cancelled||(addTransitionClass(n,h),k||(isValidDuration(w)?setTimeout(T,w):whenTransitionEnds(n,f,T)))}))),v&&v(n,T),S||k||T())}}function isValidDuration(e){return"number"==typeof e&&!isNaN(e)}function getHookArgumentsLength(e){if(isUndef(e))return!1;var t=e.fns;return isDef(t)?getHookArgumentsLength(Array.isArray(t)?t[0]:t):(e._length||e.length)>1}function _enter(e,t){!0!==t.data.show&&enter(t)}var It=function createPatchFunction(e){var t,n,a={},l=e.modules,f=e.nodeOps;for(t=0;t<Qe.length;++t)for(a[Qe[t]]=[],n=0;n<l.length;++n)isDef(l[n][Qe[t]])&&a[Qe[t]].push(l[n][Qe[t]]);function removeNode(e){var t=f.parentNode(e);isDef(t)&&f.removeChild(t,e)}function createElm(e,t,n,l,p,h,m){if(isDef(e.elm)&&isDef(h)&&(e=h[m]=cloneVNode(e)),e.isRootInsert=!p,!function createComponent(e,t,n,l){var f=e.data;if(isDef(f)){var p=isDef(e.componentInstance)&&f.keepAlive;if(isDef(f=f.hook)&&isDef(f=f.init)&&f(e,!1),isDef(e.componentInstance))return initComponent(e,t),insert(n,e.elm,l),isTrue(p)&&function reactivateComponent(e,t,n,l){var f,p=e;for(;p.componentInstance;)if(isDef(f=(p=p.componentInstance._vnode).data)&&isDef(f=f.transition)){for(f=0;f<a.activate.length;++f)a.activate[f](Ze,p);t.push(p);break}insert(n,e.elm,l)}(e,t,n,l),!0}}(e,t,n,l)){var g=e.data,v=e.children,y=e.tag;isDef(y)?(e.elm=e.ns?f.createElementNS(e.ns,y):f.createElement(y,e),setScope(e),createChildren(e,v,t),isDef(g)&&invokeCreateHooks(e,t),insert(n,e.elm,l)):isTrue(e.isComment)?(e.elm=f.createComment(e.text),insert(n,e.elm,l)):(e.elm=f.createTextNode(e.text),insert(n,e.elm,l))}}function initComponent(e,t){isDef(e.data.pendingInsert)&&(t.push.apply(t,e.data.pendingInsert),e.data.pendingInsert=null),e.elm=e.componentInstance.$el,isPatchable(e)?(invokeCreateHooks(e,t),setScope(e)):(registerRef(e),t.push(e))}function insert(e,t,n){isDef(e)&&(isDef(n)?f.parentNode(n)===e&&f.insertBefore(e,t,n):f.appendChild(e,t))}function createChildren(e,t,n){if(Array.isArray(t)){0;for(var a=0;a<t.length;++a)createElm(t[a],n,e.elm,null,!0,t,a)}else isPrimitive(e.text)&&f.appendChild(e.elm,f.createTextNode(String(e.text)))}function isPatchable(e){for(;e.componentInstance;)e=e.componentInstance._vnode;return isDef(e.tag)}function invokeCreateHooks(e,n){for(var l=0;l<a.create.length;++l)a.create[l](Ze,e);isDef(t=e.data.hook)&&(isDef(t.create)&&t.create(Ze,e),isDef(t.insert)&&n.push(e))}function setScope(e){var t;if(isDef(t=e.fnScopeId))f.setStyleScope(e.elm,t);else for(var n=e;n;)isDef(t=n.context)&&isDef(t=t.$options._scopeId)&&f.setStyleScope(e.elm,t),n=n.parent;isDef(t=ye)&&t!==e.context&&t!==e.fnContext&&isDef(t=t.$options._scopeId)&&f.setStyleScope(e.elm,t)}function addVnodes(e,t,n,a,l,f){for(;a<=l;++a)createElm(n[a],f,e,t,!1,n,a)}function invokeDestroyHook(e){var t,n,l=e.data;if(isDef(l))for(isDef(t=l.hook)&&isDef(t=t.destroy)&&t(e),t=0;t<a.destroy.length;++t)a.destroy[t](e);if(isDef(t=e.children))for(n=0;n<e.children.length;++n)invokeDestroyHook(e.children[n])}function removeVnodes(e,t,n){for(;t<=n;++t){var a=e[t];isDef(a)&&(isDef(a.tag)?(removeAndInvokeRemoveHook(a),invokeDestroyHook(a)):removeNode(a.elm))}}function removeAndInvokeRemoveHook(e,t){if(isDef(t)||isDef(e.data)){var n,l=a.remove.length+1;for(isDef(t)?t.listeners+=l:t=function createRmCb(e,t){function remove$$1(){0==--remove$$1.listeners&&removeNode(e)}return remove$$1.listeners=t,remove$$1}(e.elm,l),isDef(n=e.componentInstance)&&isDef(n=n._vnode)&&isDef(n.data)&&removeAndInvokeRemoveHook(n,t),n=0;n<a.remove.length;++n)a.remove[n](e,t);isDef(n=e.data.hook)&&isDef(n=n.remove)?n(e,t):t()}else removeNode(e.elm)}function findIdxInOld(e,t,n,a){for(var l=n;l<a;l++){var f=t[l];if(isDef(f)&&sameVnode(e,f))return l}}function patchVnode(e,t,n,l,p,h){if(e!==t){isDef(t.elm)&&isDef(l)&&(t=l[p]=cloneVNode(t));var m=t.elm=e.elm;if(isTrue(e.isAsyncPlaceholder))isDef(t.asyncFactory.resolved)?hydrate(e.elm,t,n):t.isAsyncPlaceholder=!0;else if(isTrue(t.isStatic)&&isTrue(e.isStatic)&&t.key===e.key&&(isTrue(t.isCloned)||isTrue(t.isOnce)))t.componentInstance=e.componentInstance;else{var g,v=t.data;isDef(v)&&isDef(g=v.hook)&&isDef(g=g.prepatch)&&g(e,t);var y=e.children,_=t.children;if(isDef(v)&&isPatchable(t)){for(g=0;g<a.update.length;++g)a.update[g](e,t);isDef(g=v.hook)&&isDef(g=g.update)&&g(e,t)}isUndef(t.text)?isDef(y)&&isDef(_)?y!==_&&function updateChildren(e,t,n,a,l){var p,h,m,g=0,v=0,y=t.length-1,_=t[0],b=t[y],C=n.length-1,S=n[0],k=n[C],w=!l;for(;g<=y&&v<=C;)isUndef(_)?_=t[++g]:isUndef(b)?b=t[--y]:sameVnode(_,S)?(patchVnode(_,S,a,n,v),_=t[++g],S=n[++v]):sameVnode(b,k)?(patchVnode(b,k,a,n,C),b=t[--y],k=n[--C]):sameVnode(_,k)?(patchVnode(_,k,a,n,C),w&&f.insertBefore(e,_.elm,f.nextSibling(b.elm)),_=t[++g],k=n[--C]):sameVnode(b,S)?(patchVnode(b,S,a,n,v),w&&f.insertBefore(e,b.elm,_.elm),b=t[--y],S=n[++v]):(isUndef(p)&&(p=createKeyToOldIdx(t,g,y)),isUndef(h=isDef(S.key)?p[S.key]:findIdxInOld(S,t,g,y))?createElm(S,a,e,_.elm,!1,n,v):sameVnode(m=t[h],S)?(patchVnode(m,S,a,n,v),t[h]=void 0,w&&f.insertBefore(e,m.elm,_.elm)):createElm(S,a,e,_.elm,!1,n,v),S=n[++v]);g>y?addVnodes(e,isUndef(n[C+1])?null:n[C+1].elm,n,v,C,a):v>C&&removeVnodes(t,g,y)}(m,y,_,n,h):isDef(_)?(isDef(e.text)&&f.setTextContent(m,""),addVnodes(m,null,_,0,_.length-1,n)):isDef(y)?removeVnodes(y,0,y.length-1):isDef(e.text)&&f.setTextContent(m,""):e.text!==t.text&&f.setTextContent(m,t.text),isDef(v)&&isDef(g=v.hook)&&isDef(g=g.postpatch)&&g(e,t)}}}function invokeInsertHook(e,t,n){if(isTrue(n)&&isDef(e.parent))e.parent.data.pendingInsert=t;else for(var a=0;a<t.length;++a)t[a].data.hook.insert(t[a])}var p=makeMap("attrs,class,staticClass,staticStyle,key");function hydrate(e,t,n,a){var l,f=t.tag,h=t.data,m=t.children;if(a=a||h&&h.pre,t.elm=e,isTrue(t.isComment)&&isDef(t.asyncFactory))return t.isAsyncPlaceholder=!0,!0;if(isDef(h)&&(isDef(l=h.hook)&&isDef(l=l.init)&&l(t,!0),isDef(l=t.componentInstance)))return initComponent(t,n),!0;if(isDef(f)){if(isDef(m))if(e.hasChildNodes())if(isDef(l=h)&&isDef(l=l.domProps)&&isDef(l=l.innerHTML)){if(l!==e.innerHTML)return!1}else{for(var g=!0,v=e.firstChild,y=0;y<m.length;y++){if(!v||!hydrate(v,m[y],n,a)){g=!1;break}v=v.nextSibling}if(!g||v)return!1}else createChildren(t,m,n);if(isDef(h)){var _=!1;for(var b in h)if(!p(b)){_=!0,invokeCreateHooks(t,n);break}!_&&h.class&&traverse(h.class)}}else e.data!==t.text&&(e.data=t.text);return!0}return function patch(e,t,n,l){if(!isUndef(t)){var p=!1,h=[];if(isUndef(e))p=!0,createElm(t,h);else{var m=isDef(e.nodeType);if(!m&&sameVnode(e,t))patchVnode(e,t,h,null,null,l);else{if(m){if(1===e.nodeType&&e.hasAttribute(C)&&(e.removeAttribute(C),n=!0),isTrue(n)&&hydrate(e,t,h))return invokeInsertHook(t,h,!0),e;e=function emptyNodeAt(e){return new Z(f.tagName(e).toLowerCase(),{},[],void 0,e)}(e)}var g=e.elm,v=f.parentNode(g);if(createElm(t,h,g._leaveCb?null:v,f.nextSibling(g)),isDef(t.parent))for(var y=t.parent,_=isPatchable(t);y;){for(var b=0;b<a.destroy.length;++b)a.destroy[b](y);if(y.elm=t.elm,_){for(var S=0;S<a.create.length;++S)a.create[S](Ze,y);var k=y.data.hook.insert;if(k.merged)for(var w=1;w<k.fns.length;w++)k.fns[w]()}else registerRef(y);y=y.parent}isDef(v)?removeVnodes([e],0,0):isDef(e.tag)&&invokeDestroyHook(e)}}return invokeInsertHook(t,h,p),t.elm}isDef(e)&&invokeDestroyHook(e)}}({nodeOps:ze,modules:[et,st,pt,ht,Ct,x?{create:_enter,activate:_enter,remove:function remove$$1(e,t){!0!==e.data.show?leave(e,t):t()}}:{}].concat(Je)});N&&document.addEventListener("selectionchange",(function(){var e=document.activeElement;e&&e.vmodel&&trigger(e,"input")}));var Lt={inserted:function inserted(e,t,n,a){"select"===n.tag?(a.elm&&!a.elm._vOptions?mergeVNodeHook(n,"postpatch",(function(){Lt.componentUpdated(e,t,n)})):setSelected(e,t,n.context),e._vOptions=[].map.call(e.options,getValue)):("textarea"===n.tag||We(e.type))&&(e._vModifiers=t.modifiers,t.modifiers.lazy||(e.addEventListener("compositionstart",onCompositionStart),e.addEventListener("compositionend",onCompositionEnd),e.addEventListener("change",onCompositionEnd),N&&(e.vmodel=!0)))},componentUpdated:function componentUpdated(e,t,n){if("select"===n.tag){setSelected(e,t,n.context);var a=e._vOptions,l=e._vOptions=[].map.call(e.options,getValue);if(l.some((function(e,t){return!looseEqual(e,a[t])})))(e.multiple?t.value.some((function(e){return hasNoMatchingOption(e,l)})):t.value!==t.oldValue&&hasNoMatchingOption(t.value,l))&&trigger(e,"change")}}};function setSelected(e,t,n){actuallySetSelected(e,t,n),(L||D)&&setTimeout((function(){actuallySetSelected(e,t,n)}),0)}function actuallySetSelected(e,t,n){var a=t.value,l=e.multiple;if(!l||Array.isArray(a)){for(var f,p,h=0,m=e.options.length;h<m;h++)if(p=e.options[h],l)f=looseIndexOf(a,getValue(p))>-1,p.selected!==f&&(p.selected=f);else if(looseEqual(getValue(p),a))return void(e.selectedIndex!==h&&(e.selectedIndex=h));l||(e.selectedIndex=-1)}}function hasNoMatchingOption(e,t){return t.every((function(t){return!looseEqual(t,e)}))}function getValue(e){return"_value"in e?e._value:e.value}function onCompositionStart(e){e.target.composing=!0}function onCompositionEnd(e){e.target.composing&&(e.target.composing=!1,trigger(e.target,"input"))}function trigger(e,t){var n=document.createEvent("HTMLEvents");n.initEvent(t,!0,!0),e.dispatchEvent(n)}function locateNode(e){return!e.componentInstance||e.data&&e.data.transition?e:locateNode(e.componentInstance._vnode)}var Nt={bind:function bind(e,t,n){var a=t.value,l=(n=locateNode(n)).data&&n.data.transition,f=e.__vOriginalDisplay="none"===e.style.display?"":e.style.display;a&&l?(n.data.show=!0,enter(n,(function(){e.style.display=f}))):e.style.display=a?f:"none"},update:function update(e,t,n){var a=t.value;!a!=!t.oldValue&&((n=locateNode(n)).data&&n.data.transition?(n.data.show=!0,a?enter(n,(function(){e.style.display=e.__vOriginalDisplay})):leave(n,(function(){e.style.display="none"}))):e.style.display=a?e.__vOriginalDisplay:"none")},unbind:function unbind(e,t,n,a,l){l||(e.style.display=e.__vOriginalDisplay)}},Dt={model:Lt,show:Nt},Bt={name:String,appear:Boolean,css:Boolean,mode:String,type:String,enterClass:String,leaveClass:String,enterToClass:String,leaveToClass:String,enterActiveClass:String,leaveActiveClass:String,appearClass:String,appearActiveClass:String,appearToClass:String,duration:[Number,String,Object]};function getRealChild(e){var t=e&&e.componentOptions;return t&&t.Ctor.options.abstract?getRealChild(getFirstComponentChild(t.children)):e}function extractTransitionData(e){var t={},n=e.$options;for(var a in n.propsData)t[a]=e[a];var l=n._parentListeners;for(var f in l)t[g(f)]=l[f];return t}function placeholder(e,t){if(/\d-keep-alive$/.test(t.tag))return e("keep-alive",{props:t.componentOptions.propsData})}var isNotTextNode=function(e){return e.tag||isAsyncPlaceholder(e)},isVShowDirective=function(e){return"show"===e.name},Ft={name:"transition",props:Bt,abstract:!0,render:function render(e){var t=this,n=this.$slots.default;if(n&&(n=n.filter(isNotTextNode)).length){0;var a=this.mode;0;var l=n[0];if(function hasParentTransition(e){for(;e=e.parent;)if(e.data.transition)return!0}(this.$vnode))return l;var f=getRealChild(l);if(!f)return l;if(this._leaving)return placeholder(e,l);var p="__transition-"+this._uid+"-";f.key=null==f.key?f.isComment?p+"comment":p+f.tag:isPrimitive(f.key)?0===String(f.key).indexOf(p)?f.key:p+f.key:f.key;var h=(f.data||(f.data={})).transition=extractTransitionData(this),m=this._vnode,g=getRealChild(m);if(f.data.directives&&f.data.directives.some(isVShowDirective)&&(f.data.show=!0),g&&g.data&&!function isSameChild(e,t){return t.key===e.key&&t.tag===e.tag}(f,g)&&!isAsyncPlaceholder(g)&&(!g.componentInstance||!g.componentInstance._vnode.isComment)){var v=g.data.transition=extend({},h);if("out-in"===a)return this._leaving=!0,mergeVNodeHook(v,"afterLeave",(function(){t._leaving=!1,t.$forceUpdate()})),placeholder(e,l);if("in-out"===a){if(isAsyncPlaceholder(f))return m;var y,performLeave=function(){y()};mergeVNodeHook(h,"afterEnter",performLeave),mergeVNodeHook(h,"enterCancelled",performLeave),mergeVNodeHook(v,"delayLeave",(function(e){y=e}))}}return l}}},jt=extend({tag:String,moveClass:String},Bt);function callPendingCbs(e){e.elm._moveCb&&e.elm._moveCb(),e.elm._enterCb&&e.elm._enterCb()}function recordPosition(e){e.data.newPos=e.elm.getBoundingClientRect()}function applyTranslation(e){var t=e.data.pos,n=e.data.newPos,a=t.left-n.left,l=t.top-n.top;if(a||l){e.data.moved=!0;var f=e.elm.style;f.transform=f.WebkitTransform="translate("+a+"px,"+l+"px)",f.transitionDuration="0s"}}delete jt.mode;var $t={Transition:Ft,TransitionGroup:{props:jt,beforeMount:function beforeMount(){var e=this,t=this._update;this._update=function(n,a){var l=setActiveInstance(e);e.__patch__(e._vnode,e.kept,!1,!0),e._vnode=e.kept,l(),t.call(e,n,a)}},render:function render(e){for(var t=this.tag||this.$vnode.data.tag||"span",n=Object.create(null),a=this.prevChildren=this.children,l=this.$slots.default||[],f=this.children=[],p=extractTransitionData(this),h=0;h<l.length;h++){var m=l[h];if(m.tag)if(null!=m.key&&0!==String(m.key).indexOf("__vlist"))f.push(m),n[m.key]=m,(m.data||(m.data={})).transition=p;else;}if(a){for(var g=[],v=[],y=0;y<a.length;y++){var _=a[y];_.data.transition=p,_.data.pos=_.elm.getBoundingClientRect(),n[_.key]?g.push(_):v.push(_)}this.kept=e(t,null,g),this.removed=v}return e(t,null,f)},updated:function updated(){var e=this.prevChildren,t=this.moveClass||(this.name||"v")+"-move";e.length&&this.hasMove(e[0].elm,t)&&(e.forEach(callPendingCbs),e.forEach(recordPosition),e.forEach(applyTranslation),this._reflow=document.body.offsetHeight,e.forEach((function(e){if(e.data.moved){var n=e.elm,a=n.style;addTransitionClass(n,t),a.transform=a.WebkitTransform=a.transitionDuration="",n.addEventListener(At,n._moveCb=function cb(e){e&&e.target!==n||e&&!/transform$/.test(e.propertyName)||(n.removeEventListener(At,cb),n._moveCb=null,removeTransitionClass(n,t))})}})))},methods:{hasMove:function hasMove(e,t){if(!wt)return!1;if(this._hasMove)return this._hasMove;var n=e.cloneNode();e._transitionClasses&&e._transitionClasses.forEach((function(e){removeClass(n,e)})),addClass(n,t),n.style.display="none",this.$el.appendChild(n);var a=getTransitionInfo(n);return this.$el.removeChild(n),this._hasMove=a.hasTransform}}}};Vue.config.mustUseProp=mustUseProp,Vue.config.isReservedTag=isReservedTag,Vue.config.isReservedAttr=De,Vue.config.getTagNamespace=getTagNamespace,Vue.config.isUnknownElement=function isUnknownElement(e){if(!x)return!0;if(isReservedTag(e))return!1;if(e=e.toLowerCase(),null!=qe[e])return qe[e];var t=document.createElement(e);return e.indexOf("-")>-1?qe[e]=t.constructor===window.HTMLUnknownElement||t.constructor===window.HTMLElement:qe[e]=/HTMLUnknownElement/.test(t.toString())},extend(Vue.options.directives,Dt),extend(Vue.options.components,$t),Vue.prototype.__patch__=x?It:noop,Vue.prototype.$mount=function(e,t){return function mountComponent(e,t,n){var a;return e.$el=t,e.$options.render||(e.$options.render=createEmptyVNode),callHook(e,"beforeMount"),a=function(){e._update(e._render(),n)},new Me(e,a,noop,{before:function before(){e._isMounted&&!e._isDestroyed&&callHook(e,"beforeUpdate")}},!0),n=!1,null==e.$vnode&&(e._isMounted=!0,callHook(e,"mounted")),e}(this,e=e&&x?query(e):void 0,t)},x&&setTimeout((function(){w.devtools&&V&&V.emit("init",Vue)}),0);var Ht=/\{\{((?:.|\r?\n)+?)\}\}/g,Vt=/[-.*+?^${}()|[\]\/\\]/g,Ut=cached((function(e){var t=e[0].replace(Vt,"\\$&"),n=e[1].replace(Vt,"\\$&");return new RegExp(t+"((?:.|\\n)+?)"+n,"g")}));var Gt={staticKeys:["staticClass"],transformNode:function transformNode(e,t){t.warn;var n=getAndRemoveAttr(e,"class");n&&(e.staticClass=JSON.stringify(n));var a=getBindingAttr(e,"class",!1);a&&(e.classBinding=a)},genData:function genData(e){var t="";return e.staticClass&&(t+="staticClass:"+e.staticClass+","),e.classBinding&&(t+="class:"+e.classBinding+","),t}};var qt,Wt={staticKeys:["staticStyle"],transformNode:function transformNode$1(e,t){t.warn;var n=getAndRemoveAttr(e,"style");n&&(e.staticStyle=JSON.stringify(mt(n)));var a=getBindingAttr(e,"style",!1);a&&(e.styleBinding=a)},genData:function genData$1(e){var t="";return e.staticStyle&&(t+="staticStyle:"+e.staticStyle+","),e.styleBinding&&(t+="style:("+e.styleBinding+"),"),t}},zt=function decode(e){return(qt=qt||document.createElement("div")).innerHTML=e,qt.textContent},Kt=makeMap("area,base,br,col,embed,frame,hr,img,input,isindex,keygen,link,meta,param,source,track,wbr"),Zt=makeMap("colgroup,dd,dt,li,options,p,td,tfoot,th,thead,tr,source"),Qt=makeMap("address,article,aside,base,blockquote,body,caption,col,colgroup,dd,details,dialog,div,dl,dt,fieldset,figcaption,figure,footer,form,h1,h2,h3,h4,h5,h6,head,header,hgroup,hr,html,legend,li,menuitem,meta,optgroup,option,param,rp,rt,source,style,summary,tbody,td,tfoot,th,thead,title,tr,track"),Xt=/^\s*([^\s"'<>\/=]+)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,Yt=/^\s*((?:v-[\w-]+:|@|:|#)\[[^=]+?\][^\s"'<>\/=]*)(?:\s*(=)\s*(?:"([^"]*)"+|'([^']*)'+|([^\s"'=<>`]+)))?/,Jt="[a-zA-Z_][\\-\\.0-9_a-zA-Z"+T.source+"]*",en="((?:"+Jt+"\\:)?"+Jt+")",tn=new RegExp("^<"+en),nn=/^\s*(\/?)>/,rn=new RegExp("^<\\/"+en+"[^>]*>"),an=/^<!DOCTYPE [^>]+>/i,sn=/^<!\--/,cn=/^<!\[/,ln=makeMap("script,style,textarea",!0),un={},dn={"&lt;":"<","&gt;":">","&quot;":'"',"&amp;":"&","&#10;":"\n","&#9;":"\t","&#39;":"'"},fn=/&(?:lt|gt|quot|amp|#39);/g,pn=/&(?:lt|gt|quot|amp|#39|#10|#9);/g,hn=makeMap("pre,textarea",!0),shouldIgnoreFirstNewline=function(e,t){return e&&hn(e)&&"\n"===t[0]};function decodeAttr(e,t){var n=t?pn:fn;return e.replace(n,(function(e){return dn[e]}))}var mn,gn,vn,yn,_n,bn,Cn,Sn,kn=/^@|^v-on:/,wn=/^v-|^@|^:|^#/,Tn=/([\s\S]*?)\s+(?:in|of)\s+([\s\S]*)/,Pn=/,([^,\}\]]*)(?:,([^,\}\]]*))?$/,En=/^\(|\)$/g,An=/^\[.*\]$/,Mn=/:(.*)$/,xn=/^:|^\.|^v-bind:/,On=/\.[^.\]]+(?=[^\]]*$)/g,Rn=/^v-slot(:|$)|^#/,In=/[\r\n]/,Ln=/[ \f\t\r\n]+/g,Nn=cached(zt),Dn="_empty_";function createASTElement(e,t,n){return{type:1,tag:e,attrsList:t,attrsMap:makeAttrsMap(t),rawAttrsMap:{},parent:n,children:[]}}function parse(e,t){mn=t.warn||baseWarn,bn=t.isPreTag||no,Cn=t.mustUseProp||no,Sn=t.getTagNamespace||no;var n=t.isReservedTag||no;(function(e){return!(!(e.component||e.attrsMap[":is"]||e.attrsMap["v-bind:is"])&&(e.attrsMap.is?n(e.attrsMap.is):n(e.tag)))}),vn=pluckModuleFunction(t.modules,"transformNode"),yn=pluckModuleFunction(t.modules,"preTransformNode"),_n=pluckModuleFunction(t.modules,"postTransformNode"),gn=t.delimiters;var a,l,f=[],p=!1!==t.preserveWhitespace,h=t.whitespace,m=!1,g=!1;function closeElement(e){if(trimEndingWhitespace(e),m||e.processed||(e=processElement(e,t)),f.length||e===a||a.if&&(e.elseif||e.else)&&addIfCondition(a,{exp:e.elseif,block:e}),l&&!e.forbidden)if(e.elseif||e.else)!function processIfConditions(e,t){var n=function findPrevElement(e){var t=e.length;for(;t--;){if(1===e[t].type)return e[t];e.pop()}}(t.children);n&&n.if&&addIfCondition(n,{exp:e.elseif,block:e})}(e,l);else{if(e.slotScope){var n=e.slotTarget||'"default"';(l.scopedSlots||(l.scopedSlots={}))[n]=e}l.children.push(e),e.parent=l}e.children=e.children.filter((function(e){return!e.slotScope})),trimEndingWhitespace(e),e.pre&&(m=!1),bn(e.tag)&&(g=!1);for(var p=0;p<_n.length;p++)_n[p](e,t)}function trimEndingWhitespace(e){if(!g)for(var t;(t=e.children[e.children.length-1])&&3===t.type&&" "===t.text;)e.children.pop()}return function parseHTML(e,t){for(var n,a,l=[],f=t.expectHTML,p=t.isUnaryTag||no,h=t.canBeLeftOpenTag||no,m=0;e;){if(n=e,a&&ln(a)){var g=0,v=a.toLowerCase(),y=un[v]||(un[v]=new RegExp("([\\s\\S]*?)(</"+v+"[^>]*>)","i")),_=e.replace(y,(function(e,n,a){return g=a.length,ln(v)||"noscript"===v||(n=n.replace(/<!\--([\s\S]*?)-->/g,"$1").replace(/<!\[CDATA\[([\s\S]*?)]]>/g,"$1")),shouldIgnoreFirstNewline(v,n)&&(n=n.slice(1)),t.chars&&t.chars(n),""}));m+=e.length-_.length,e=_,parseEndTag(v,m-g,m)}else{var b=e.indexOf("<");if(0===b){if(sn.test(e)){var C=e.indexOf("--\x3e");if(C>=0){t.shouldKeepComment&&t.comment(e.substring(4,C),m,m+C+3),advance(C+3);continue}}if(cn.test(e)){var S=e.indexOf("]>");if(S>=0){advance(S+2);continue}}var k=e.match(an);if(k){advance(k[0].length);continue}var w=e.match(rn);if(w){var T=m;advance(w[0].length),parseEndTag(w[1],T,m);continue}var P=parseStartTag();if(P){handleStartTag(P),shouldIgnoreFirstNewline(P.tagName,e)&&advance(1);continue}}var A=void 0,M=void 0,x=void 0;if(b>=0){for(M=e.slice(b);!(rn.test(M)||tn.test(M)||sn.test(M)||cn.test(M)||(x=M.indexOf("<",1))<0);)b+=x,M=e.slice(b);A=e.substring(0,b)}b<0&&(A=e),A&&advance(A.length),t.chars&&A&&t.chars(A,m-A.length,m)}if(e===n){t.chars&&t.chars(e);break}}function advance(t){m+=t,e=e.substring(t)}function parseStartTag(){var t=e.match(tn);if(t){var n,a,l={tagName:t[1],attrs:[],start:m};for(advance(t[0].length);!(n=e.match(nn))&&(a=e.match(Yt)||e.match(Xt));)a.start=m,advance(a[0].length),a.end=m,l.attrs.push(a);if(n)return l.unarySlash=n[1],advance(n[0].length),l.end=m,l}}function handleStartTag(e){var n=e.tagName,m=e.unarySlash;f&&("p"===a&&Qt(n)&&parseEndTag(a),h(n)&&a===n&&parseEndTag(n));for(var g=p(n)||!!m,v=e.attrs.length,y=new Array(v),_=0;_<v;_++){var b=e.attrs[_],C=b[3]||b[4]||b[5]||"",S="a"===n&&"href"===b[1]?t.shouldDecodeNewlinesForHref:t.shouldDecodeNewlines;y[_]={name:b[1],value:decodeAttr(C,S)}}g||(l.push({tag:n,lowerCasedTag:n.toLowerCase(),attrs:y,start:e.start,end:e.end}),a=n),t.start&&t.start(n,y,g,e.start,e.end)}function parseEndTag(e,n,f){var p,h;if(null==n&&(n=m),null==f&&(f=m),e)for(h=e.toLowerCase(),p=l.length-1;p>=0&&l[p].lowerCasedTag!==h;p--);else p=0;if(p>=0){for(var g=l.length-1;g>=p;g--)t.end&&t.end(l[g].tag,n,f);l.length=p,a=p&&l[p-1].tag}else"br"===h?t.start&&t.start(e,[],!0,n,f):"p"===h&&(t.start&&t.start(e,[],!1,n,f),t.end&&t.end(e,n,f))}parseEndTag()}(e,{warn:mn,expectHTML:t.expectHTML,isUnaryTag:t.isUnaryTag,canBeLeftOpenTag:t.canBeLeftOpenTag,shouldDecodeNewlines:t.shouldDecodeNewlines,shouldDecodeNewlinesForHref:t.shouldDecodeNewlinesForHref,shouldKeepComment:t.comments,outputSourceRange:t.outputSourceRange,start:function start(e,n,p,h,v){var y=l&&l.ns||Sn(e);L&&"svg"===y&&(n=function guardIESVGBug(e){for(var t=[],n=0;n<e.length;n++){var a=e[n];Bn.test(a.name)||(a.name=a.name.replace(Fn,""),t.push(a))}return t}(n));var _=createASTElement(e,n,l);y&&(_.ns=y),function isForbiddenTag(e){return"style"===e.tag||"script"===e.tag&&(!e.attrsMap.type||"text/javascript"===e.attrsMap.type)}(_)&&!isServerRendering()&&(_.forbidden=!0);for(var b=0;b<yn.length;b++)_=yn[b](_,t)||_;m||(!function processPre(e){null!=getAndRemoveAttr(e,"v-pre")&&(e.pre=!0)}(_),_.pre&&(m=!0)),bn(_.tag)&&(g=!0),m?function processRawAttrs(e){var t=e.attrsList,n=t.length;if(n)for(var a=e.attrs=new Array(n),l=0;l<n;l++)a[l]={name:t[l].name,value:JSON.stringify(t[l].value)},null!=t[l].start&&(a[l].start=t[l].start,a[l].end=t[l].end);else e.pre||(e.plain=!0)}(_):_.processed||(processFor(_),function processIf(e){var t=getAndRemoveAttr(e,"v-if");if(t)e.if=t,addIfCondition(e,{exp:t,block:e});else{null!=getAndRemoveAttr(e,"v-else")&&(e.else=!0);var n=getAndRemoveAttr(e,"v-else-if");n&&(e.elseif=n)}}(_),function processOnce(e){null!=getAndRemoveAttr(e,"v-once")&&(e.once=!0)}(_)),a||(a=_),p?closeElement(_):(l=_,f.push(_))},end:function end(e,t,n){var a=f[f.length-1];f.length-=1,l=f[f.length-1],closeElement(a)},chars:function chars(e,t,n){if(l&&(!L||"textarea"!==l.tag||l.attrsMap.placeholder!==e)){var a,f,v=l.children;if(e=g||e.trim()?function isTextTag(e){return"script"===e.tag||"style"===e.tag}(l)?e:Nn(e):v.length?h?"condense"===h&&In.test(e)?"":" ":p?" ":"":"")g||"condense"!==h||(e=e.replace(Ln," ")),!m&&" "!==e&&(a=function parseText(e,t){var n=t?Ut(t):Ht;if(n.test(e)){for(var a,l,f,p=[],h=[],m=n.lastIndex=0;a=n.exec(e);){(l=a.index)>m&&(h.push(f=e.slice(m,l)),p.push(JSON.stringify(f)));var g=parseFilters(a[1].trim());p.push("_s("+g+")"),h.push({"@binding":g}),m=l+a[0].length}return m<e.length&&(h.push(f=e.slice(m)),p.push(JSON.stringify(f))),{expression:p.join("+"),tokens:h}}}(e,gn))?f={type:2,expression:a.expression,tokens:a.tokens,text:e}:" "===e&&v.length&&" "===v[v.length-1].text||(f={type:3,text:e}),f&&v.push(f)}},comment:function comment(e,t,n){if(l){var a={type:3,text:e,isComment:!0};0,l.children.push(a)}}}),a}function processElement(e,t){!function processKey(e){var t=getBindingAttr(e,"key");if(t){e.key=t}}(e),e.plain=!e.key&&!e.scopedSlots&&!e.attrsList.length,function processRef(e){var t=getBindingAttr(e,"ref");t&&(e.ref=t,e.refInFor=function checkInFor(e){var t=e;for(;t;){if(void 0!==t.for)return!0;t=t.parent}return!1}(e))}(e),function processSlotContent(e){var t;"template"===e.tag?(t=getAndRemoveAttr(e,"scope"),e.slotScope=t||getAndRemoveAttr(e,"slot-scope")):(t=getAndRemoveAttr(e,"slot-scope"))&&(e.slotScope=t);var n=getBindingAttr(e,"slot");n&&(e.slotTarget='""'===n?'"default"':n,e.slotTargetDynamic=!(!e.attrsMap[":slot"]&&!e.attrsMap["v-bind:slot"]),"template"===e.tag||e.slotScope||addAttr(e,"slot",n,function getRawBindingAttr(e,t){return e.rawAttrsMap[":"+t]||e.rawAttrsMap["v-bind:"+t]||e.rawAttrsMap[t]}(e,"slot")));if("template"===e.tag){var a=getAndRemoveAttrByRegex(e,Rn);if(a){0;var l=getSlotName(a),f=l.name,p=l.dynamic;e.slotTarget=f,e.slotTargetDynamic=p,e.slotScope=a.value||Dn}}else{var h=getAndRemoveAttrByRegex(e,Rn);if(h){0;var m=e.scopedSlots||(e.scopedSlots={}),g=getSlotName(h),v=g.name,y=g.dynamic,_=m[v]=createASTElement("template",[],e);_.slotTarget=v,_.slotTargetDynamic=y,_.children=e.children.filter((function(e){if(!e.slotScope)return e.parent=_,!0})),_.slotScope=h.value||Dn,e.children=[],e.plain=!1}}}(e),function processSlotOutlet(e){"slot"===e.tag&&(e.slotName=getBindingAttr(e,"name"))}(e),function processComponent(e){var t;(t=getBindingAttr(e,"is"))&&(e.component=t);null!=getAndRemoveAttr(e,"inline-template")&&(e.inlineTemplate=!0)}(e);for(var n=0;n<vn.length;n++)e=vn[n](e,t)||e;return function processAttrs(e){var t,n,a,l,f,p,h,m,v=e.attrsList;for(t=0,n=v.length;t<n;t++){if(a=l=v[t].name,f=v[t].value,wn.test(a))if(e.hasBindings=!0,(p=parseModifiers(a.replace(wn,"")))&&(a=a.replace(On,"")),xn.test(a))a=a.replace(xn,""),f=parseFilters(f),(m=An.test(a))&&(a=a.slice(1,-1)),p&&(p.prop&&!m&&"innerHtml"===(a=g(a))&&(a="innerHTML"),p.camel&&!m&&(a=g(a)),p.sync&&(h=genAssignmentCode(f,"$event"),m?addHandler(e,'"update:"+('+a+")",h,null,!1,0,v[t],!0):(addHandler(e,"update:"+g(a),h,null,!1,0,v[t]),_(a)!==g(a)&&addHandler(e,"update:"+_(a),h,null,!1,0,v[t])))),p&&p.prop||!e.component&&Cn(e.tag,e.attrsMap.type,a)?addProp(e,a,f,v[t],m):addAttr(e,a,f,v[t],m);else if(kn.test(a))a=a.replace(kn,""),(m=An.test(a))&&(a=a.slice(1,-1)),addHandler(e,a,f,p,!1,0,v[t],m);else{var y=(a=a.replace(wn,"")).match(Mn),b=y&&y[1];m=!1,b&&(a=a.slice(0,-(b.length+1)),An.test(b)&&(b=b.slice(1,-1),m=!0)),addDirective(e,a,l,f,b,m,p,v[t])}else addAttr(e,a,JSON.stringify(f),v[t]),!e.component&&"muted"===a&&Cn(e.tag,e.attrsMap.type,a)&&addProp(e,a,"true",v[t])}}(e),e}function processFor(e){var t;if(t=getAndRemoveAttr(e,"v-for")){var n=function parseFor(e){var t=e.match(Tn);if(!t)return;var n={};n.for=t[2].trim();var a=t[1].trim().replace(En,""),l=a.match(Pn);l?(n.alias=a.replace(Pn,"").trim(),n.iterator1=l[1].trim(),l[2]&&(n.iterator2=l[2].trim())):n.alias=a;return n}(t);n&&extend(e,n)}}function addIfCondition(e,t){e.ifConditions||(e.ifConditions=[]),e.ifConditions.push(t)}function getSlotName(e){var t=e.name.replace(Rn,"");return t||"#"!==e.name[0]&&(t="default"),An.test(t)?{name:t.slice(1,-1),dynamic:!0}:{name:'"'+t+'"',dynamic:!1}}function parseModifiers(e){var t=e.match(On);if(t){var n={};return t.forEach((function(e){n[e.slice(1)]=!0})),n}}function makeAttrsMap(e){for(var t={},n=0,a=e.length;n<a;n++)t[e[n].name]=e[n].value;return t}var Bn=/^xmlns:NS\d+/,Fn=/^NS\d+:/;function cloneASTElement(e){return createASTElement(e.tag,e.attrsList.slice(),e.parent)}var jn=[Gt,Wt,{preTransformNode:function preTransformNode(e,t){if("input"===e.tag){var n,a=e.attrsMap;if(!a["v-model"])return;if((a[":type"]||a["v-bind:type"])&&(n=getBindingAttr(e,"type")),a.type||n||!a["v-bind"]||(n="("+a["v-bind"]+").type"),n){var l=getAndRemoveAttr(e,"v-if",!0),f=l?"&&("+l+")":"",p=null!=getAndRemoveAttr(e,"v-else",!0),h=getAndRemoveAttr(e,"v-else-if",!0),m=cloneASTElement(e);processFor(m),addRawAttr(m,"type","checkbox"),processElement(m,t),m.processed=!0,m.if="("+n+")==='checkbox'"+f,addIfCondition(m,{exp:m.if,block:m});var g=cloneASTElement(e);getAndRemoveAttr(g,"v-for",!0),addRawAttr(g,"type","radio"),processElement(g,t),addIfCondition(m,{exp:"("+n+")==='radio'"+f,block:g});var v=cloneASTElement(e);return getAndRemoveAttr(v,"v-for",!0),addRawAttr(v,":type",n),processElement(v,t),addIfCondition(m,{exp:l,block:v}),p?m.else=!0:h&&(m.elseif=h),m}}}}];var $n,Hn,Vn={model:function model(e,t,n){n;var a=t.value,l=t.modifiers,f=e.tag,p=e.attrsMap.type;if(e.component)return genComponentModel(e,a,l),!1;if("select"===f)!function genSelect(e,t,n){var a='var $$selectedVal = Array.prototype.filter.call($event.target.options,function(o){return o.selected}).map(function(o){var val = "_value" in o ? o._value : o.value;return '+(n&&n.number?"_n(val)":"val")+"});";a=a+" "+genAssignmentCode(t,"$event.target.multiple ? $$selectedVal : $$selectedVal[0]"),addHandler(e,"change",a,null,!0)}(e,a,l);else if("input"===f&&"checkbox"===p)!function genCheckboxModel(e,t,n){var a=n&&n.number,l=getBindingAttr(e,"value")||"null",f=getBindingAttr(e,"true-value")||"true",p=getBindingAttr(e,"false-value")||"false";addProp(e,"checked","Array.isArray("+t+")?_i("+t+","+l+")>-1"+("true"===f?":("+t+")":":_q("+t+","+f+")")),addHandler(e,"change","var $$a="+t+",$$el=$event.target,$$c=$$el.checked?("+f+"):("+p+");if(Array.isArray($$a)){var $$v="+(a?"_n("+l+")":l)+",$$i=_i($$a,$$v);if($$el.checked){$$i<0&&("+genAssignmentCode(t,"$$a.concat([$$v])")+")}else{$$i>-1&&("+genAssignmentCode(t,"$$a.slice(0,$$i).concat($$a.slice($$i+1))")+")}}else{"+genAssignmentCode(t,"$$c")+"}",null,!0)}(e,a,l);else if("input"===f&&"radio"===p)!function genRadioModel(e,t,n){var a=n&&n.number,l=getBindingAttr(e,"value")||"null";addProp(e,"checked","_q("+t+","+(l=a?"_n("+l+")":l)+")"),addHandler(e,"change",genAssignmentCode(t,l),null,!0)}(e,a,l);else if("input"===f||"textarea"===f)!function genDefaultModel(e,t,n){var a=e.attrsMap.type;0;var l=n||{},f=l.lazy,p=l.number,h=l.trim,m=!f&&"range"!==a,g=f?"change":"range"===a?ut:"input",v="$event.target.value";h&&(v="$event.target.value.trim()");p&&(v="_n("+v+")");var y=genAssignmentCode(t,v);m&&(y="if($event.target.composing)return;"+y);addProp(e,"value","("+t+")"),addHandler(e,g,y,null,!0),(h||p)&&addHandler(e,"blur","$forceUpdate()")}(e,a,l);else{if(!w.isReservedTag(f))return genComponentModel(e,a,l),!1}return!0},text:function text(e,t){t.value&&addProp(e,"textContent","_s("+t.value+")",t)},html:function html(e,t){t.value&&addProp(e,"innerHTML","_s("+t.value+")",t)}},Un={expectHTML:!0,modules:jn,directives:Vn,isPreTag:function(e){return"pre"===e},isUnaryTag:Kt,mustUseProp:mustUseProp,canBeLeftOpenTag:Zt,isReservedTag:isReservedTag,getTagNamespace:getTagNamespace,staticKeys:function genStaticKeys(e){return e.reduce((function(e,t){return e.concat(t.staticKeys||[])}),[]).join(",")}(jn)},Gn=cached((function genStaticKeys$1(e){return makeMap("type,tag,attrsList,attrsMap,plain,parent,children,attrs,start,end,rawAttrsMap"+(e?","+e:""))}));function optimize(e,t){e&&($n=Gn(t.staticKeys||""),Hn=t.isReservedTag||no,markStatic$1(e),markStaticRoots(e,!1))}function markStatic$1(e){if(e.static=function isStatic(e){if(2===e.type)return!1;if(3===e.type)return!0;return!(!e.pre&&(e.hasBindings||e.if||e.for||f(e.tag)||!Hn(e.tag)||function isDirectChildOfTemplateFor(e){for(;e.parent;){if("template"!==(e=e.parent).tag)return!1;if(e.for)return!0}return!1}(e)||!Object.keys(e).every($n)))}(e),1===e.type){if(!Hn(e.tag)&&"slot"!==e.tag&&null==e.attrsMap["inline-template"])return;for(var t=0,n=e.children.length;t<n;t++){var a=e.children[t];markStatic$1(a),a.static||(e.static=!1)}if(e.ifConditions)for(var l=1,p=e.ifConditions.length;l<p;l++){var h=e.ifConditions[l].block;markStatic$1(h),h.static||(e.static=!1)}}}function markStaticRoots(e,t){if(1===e.type){if((e.static||e.once)&&(e.staticInFor=t),e.static&&e.children.length&&(1!==e.children.length||3!==e.children[0].type))return void(e.staticRoot=!0);if(e.staticRoot=!1,e.children)for(var n=0,a=e.children.length;n<a;n++)markStaticRoots(e.children[n],t||!!e.for);if(e.ifConditions)for(var l=1,f=e.ifConditions.length;l<f;l++)markStaticRoots(e.ifConditions[l].block,t)}}var qn=/^([\w$_]+|\([^)]*?\))\s*=>|^function(?:\s+[\w$]+)?\s*\(/,Wn=/\([^)]*?\);*$/,zn=/^[A-Za-z_$][\w$]*(?:\.[A-Za-z_$][\w$]*|\['[^']*?']|\["[^"]*?"]|\[\d+]|\[[A-Za-z_$][\w$]*])*$/,Kn={esc:27,tab:9,enter:13,space:32,up:38,left:37,right:39,down:40,delete:[8,46]},Zn={esc:["Esc","Escape"],tab:"Tab",enter:"Enter",space:[" ","Spacebar"],up:["Up","ArrowUp"],left:["Left","ArrowLeft"],right:["Right","ArrowRight"],down:["Down","ArrowDown"],delete:["Backspace","Delete","Del"]},genGuard=function(e){return"if("+e+")return null;"},Qn={stop:"$event.stopPropagation();",prevent:"$event.preventDefault();",self:genGuard("$event.target !== $event.currentTarget"),ctrl:genGuard("!$event.ctrlKey"),shift:genGuard("!$event.shiftKey"),alt:genGuard("!$event.altKey"),meta:genGuard("!$event.metaKey"),left:genGuard("'button' in $event && $event.button !== 0"),middle:genGuard("'button' in $event && $event.button !== 1"),right:genGuard("'button' in $event && $event.button !== 2")};function genHandlers(e,t){var n=t?"nativeOn:":"on:",a="",l="";for(var f in e){var p=genHandler(e[f]);e[f]&&e[f].dynamic?l+=f+","+p+",":a+='"'+f+'":'+p+","}return a="{"+a.slice(0,-1)+"}",l?n+"_d("+a+",["+l.slice(0,-1)+"])":n+a}function genHandler(e){if(!e)return"function(){}";if(Array.isArray(e))return"["+e.map((function(e){return genHandler(e)})).join(",")+"]";var t=zn.test(e.value),n=qn.test(e.value),a=zn.test(e.value.replace(Wn,""));if(e.modifiers){var l="",f="",p=[];for(var h in e.modifiers)if(Qn[h])f+=Qn[h],Kn[h]&&p.push(h);else if("exact"===h){var m=e.modifiers;f+=genGuard(["ctrl","shift","alt","meta"].filter((function(e){return!m[e]})).map((function(e){return"$event."+e+"Key"})).join("||"))}else p.push(h);return p.length&&(l+=function genKeyFilter(e){return"if(!$event.type.indexOf('key')&&"+e.map(genFilterCode).join("&&")+")return null;"}(p)),f&&(l+=f),"function($event){"+l+(t?"return "+e.value+".apply(null, arguments)":n?"return ("+e.value+").apply(null, arguments)":a?"return "+e.value:e.value)+"}"}return t||n?e.value:"function($event){"+(a?"return "+e.value:e.value)+"}"}function genFilterCode(e){var t=parseInt(e,10);if(t)return"$event.keyCode!=="+t;var n=Kn[e],a=Zn[e];return"_k($event.keyCode,"+JSON.stringify(e)+","+JSON.stringify(n)+",$event.key,"+JSON.stringify(a)+")"}var Xn={on:function on(e,t){e.wrapListeners=function(e){return"_g("+e+","+t.value+")"}},bind:function bind$1(e,t){e.wrapData=function(n){return"_b("+n+",'"+e.tag+"',"+t.value+","+(t.modifiers&&t.modifiers.prop?"true":"false")+(t.modifiers&&t.modifiers.sync?",true":"")+")"}},cloak:noop},Yn=function CodegenState(e){this.options=e,this.warn=e.warn||baseWarn,this.transforms=pluckModuleFunction(e.modules,"transformCode"),this.dataGenFns=pluckModuleFunction(e.modules,"genData"),this.directives=extend(extend({},Xn),e.directives);var t=e.isReservedTag||no;this.maybeComponent=function(e){return!!e.component||!t(e.tag)},this.onceId=0,this.staticRenderFns=[],this.pre=!1};function generate(e,t){var n=new Yn(t);return{render:"with(this){return "+(e?"script"===e.tag?"null":genElement(e,n):'_c("div")')+"}",staticRenderFns:n.staticRenderFns}}function genElement(e,t){if(e.parent&&(e.pre=e.pre||e.parent.pre),e.staticRoot&&!e.staticProcessed)return genStatic(e,t);if(e.once&&!e.onceProcessed)return genOnce(e,t);if(e.for&&!e.forProcessed)return genFor(e,t);if(e.if&&!e.ifProcessed)return genIf(e,t);if("template"!==e.tag||e.slotTarget||t.pre){if("slot"===e.tag)return function genSlot(e,t){var n=e.slotName||'"default"',a=genChildren(e,t),l="_t("+n+(a?",function(){return "+a+"}":""),f=e.attrs||e.dynamicAttrs?genProps((e.attrs||[]).concat(e.dynamicAttrs||[]).map((function(e){return{name:g(e.name),value:e.value,dynamic:e.dynamic}}))):null,p=e.attrsMap["v-bind"];!f&&!p||a||(l+=",null");f&&(l+=","+f);p&&(l+=(f?"":",null")+","+p);return l+")"}(e,t);var n;if(e.component)n=function genComponent(e,t,n){var a=t.inlineTemplate?null:genChildren(t,n,!0);return"_c("+e+","+genData$2(t,n)+(a?","+a:"")+")"}(e.component,e,t);else{var a;(!e.plain||e.pre&&t.maybeComponent(e))&&(a=genData$2(e,t));var l=e.inlineTemplate?null:genChildren(e,t,!0);n="_c('"+e.tag+"'"+(a?","+a:"")+(l?","+l:"")+")"}for(var f=0;f<t.transforms.length;f++)n=t.transforms[f](e,n);return n}return genChildren(e,t)||"void 0"}function genStatic(e,t){e.staticProcessed=!0;var n=t.pre;return e.pre&&(t.pre=e.pre),t.staticRenderFns.push("with(this){return "+genElement(e,t)+"}"),t.pre=n,"_m("+(t.staticRenderFns.length-1)+(e.staticInFor?",true":"")+")"}function genOnce(e,t){if(e.onceProcessed=!0,e.if&&!e.ifProcessed)return genIf(e,t);if(e.staticInFor){for(var n="",a=e.parent;a;){if(a.for){n=a.key;break}a=a.parent}return n?"_o("+genElement(e,t)+","+t.onceId+++","+n+")":genElement(e,t)}return genStatic(e,t)}function genIf(e,t,n,a){return e.ifProcessed=!0,genIfConditions(e.ifConditions.slice(),t,n,a)}function genIfConditions(e,t,n,a){if(!e.length)return a||"_e()";var l=e.shift();return l.exp?"("+l.exp+")?"+genTernaryExp(l.block)+":"+genIfConditions(e,t,n,a):""+genTernaryExp(l.block);function genTernaryExp(e){return n?n(e,t):e.once?genOnce(e,t):genElement(e,t)}}function genFor(e,t,n,a){var l=e.for,f=e.alias,p=e.iterator1?","+e.iterator1:"",h=e.iterator2?","+e.iterator2:"";return e.forProcessed=!0,(a||"_l")+"(("+l+"),function("+f+p+h+"){return "+(n||genElement)(e,t)+"})"}function genData$2(e,t){var n="{",a=function genDirectives(e,t){var n=e.directives;if(!n)return;var a,l,f,p,h="directives:[",m=!1;for(a=0,l=n.length;a<l;a++){f=n[a],p=!0;var g=t.directives[f.name];g&&(p=!!g(e,f,t.warn)),p&&(m=!0,h+='{name:"'+f.name+'",rawName:"'+f.rawName+'"'+(f.value?",value:("+f.value+"),expression:"+JSON.stringify(f.value):"")+(f.arg?",arg:"+(f.isDynamicArg?f.arg:'"'+f.arg+'"'):"")+(f.modifiers?",modifiers:"+JSON.stringify(f.modifiers):"")+"},")}if(m)return h.slice(0,-1)+"]"}(e,t);a&&(n+=a+","),e.key&&(n+="key:"+e.key+","),e.ref&&(n+="ref:"+e.ref+","),e.refInFor&&(n+="refInFor:true,"),e.pre&&(n+="pre:true,"),e.component&&(n+='tag:"'+e.tag+'",');for(var l=0;l<t.dataGenFns.length;l++)n+=t.dataGenFns[l](e);if(e.attrs&&(n+="attrs:"+genProps(e.attrs)+","),e.props&&(n+="domProps:"+genProps(e.props)+","),e.events&&(n+=genHandlers(e.events,!1)+","),e.nativeEvents&&(n+=genHandlers(e.nativeEvents,!0)+","),e.slotTarget&&!e.slotScope&&(n+="slot:"+e.slotTarget+","),e.scopedSlots&&(n+=function genScopedSlots(e,t,n){var a=e.for||Object.keys(t).some((function(e){var n=t[e];return n.slotTargetDynamic||n.if||n.for||containsSlotChild(n)})),l=!!e.if;if(!a)for(var f=e.parent;f;){if(f.slotScope&&f.slotScope!==Dn||f.for){a=!0;break}f.if&&(l=!0),f=f.parent}var p=Object.keys(t).map((function(e){return genScopedSlot(t[e],n)})).join(",");return"scopedSlots:_u(["+p+"]"+(a?",null,true":"")+(!a&&l?",null,false,"+function hash(e){var t=5381,n=e.length;for(;n;)t=33*t^e.charCodeAt(--n);return t>>>0}(p):"")+")"}(e,e.scopedSlots,t)+","),e.model&&(n+="model:{value:"+e.model.value+",callback:"+e.model.callback+",expression:"+e.model.expression+"},"),e.inlineTemplate){var f=function genInlineTemplate(e,t){var n=e.children[0];0;if(n&&1===n.type){var a=generate(n,t.options);return"inlineTemplate:{render:function(){"+a.render+"},staticRenderFns:["+a.staticRenderFns.map((function(e){return"function(){"+e+"}"})).join(",")+"]}"}}(e,t);f&&(n+=f+",")}return n=n.replace(/,$/,"")+"}",e.dynamicAttrs&&(n="_b("+n+',"'+e.tag+'",'+genProps(e.dynamicAttrs)+")"),e.wrapData&&(n=e.wrapData(n)),e.wrapListeners&&(n=e.wrapListeners(n)),n}function containsSlotChild(e){return 1===e.type&&("slot"===e.tag||e.children.some(containsSlotChild))}function genScopedSlot(e,t){var n=e.attrsMap["slot-scope"];if(e.if&&!e.ifProcessed&&!n)return genIf(e,t,genScopedSlot,"null");if(e.for&&!e.forProcessed)return genFor(e,t,genScopedSlot);var a=e.slotScope===Dn?"":String(e.slotScope),l="function("+a+"){return "+("template"===e.tag?e.if&&n?"("+e.if+")?"+(genChildren(e,t)||"undefined")+":undefined":genChildren(e,t)||"undefined":genElement(e,t))+"}",f=a?"":",proxy:true";return"{key:"+(e.slotTarget||'"default"')+",fn:"+l+f+"}"}function genChildren(e,t,n,a,l){var f=e.children;if(f.length){var p=f[0];if(1===f.length&&p.for&&"template"!==p.tag&&"slot"!==p.tag){var h=n?t.maybeComponent(p)?",1":",0":"";return""+(a||genElement)(p,t)+h}var m=n?function getNormalizationType(e,t){for(var n=0,a=0;a<e.length;a++){var l=e[a];if(1===l.type){if(needsNormalization(l)||l.ifConditions&&l.ifConditions.some((function(e){return needsNormalization(e.block)}))){n=2;break}(t(l)||l.ifConditions&&l.ifConditions.some((function(e){return t(e.block)})))&&(n=1)}}return n}(f,t.maybeComponent):0,g=l||genNode;return"["+f.map((function(e){return g(e,t)})).join(",")+"]"+(m?","+m:"")}}function needsNormalization(e){return void 0!==e.for||"template"===e.tag||"slot"===e.tag}function genNode(e,t){return 1===e.type?genElement(e,t):3===e.type&&e.isComment?function genComment(e){return"_e("+JSON.stringify(e.text)+")"}(e):function genText(e){return"_v("+(2===e.type?e.expression:transformSpecialNewlines(JSON.stringify(e.text)))+")"}(e)}function genProps(e){for(var t="",n="",a=0;a<e.length;a++){var l=e[a],f=transformSpecialNewlines(l.value);l.dynamic?n+=l.name+","+f+",":t+='"'+l.name+'":'+f+","}return t="{"+t.slice(0,-1)+"}",n?"_d("+t+",["+n.slice(0,-1)+"])":t}function transformSpecialNewlines(e){return e.replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}new RegExp("\\b"+"do,if,for,let,new,try,var,case,else,with,await,break,catch,class,const,super,throw,while,yield,delete,export,import,return,switch,default,extends,finally,continue,debugger,function,arguments".split(",").join("\\b|\\b")+"\\b"),new RegExp("\\b"+"delete,typeof,void".split(",").join("\\s*\\([^\\)]*\\)|\\b")+"\\s*\\([^\\)]*\\)");function createFunction(e,t){try{return new Function(e)}catch(n){return t.push({err:n,code:e}),noop}}function createCompileToFunctionFn(e){var t=Object.create(null);return function compileToFunctions(n,a,l){(a=extend({},a)).warn;delete a.warn;var f=a.delimiters?String(a.delimiters)+n:n;if(t[f])return t[f];var p=e(n,a);var h={},m=[];return h.render=createFunction(p.render,m),h.staticRenderFns=p.staticRenderFns.map((function(e){return createFunction(e,m)})),t[f]=h}}var Jn,er=function createCompilerCreator(e){return function createCompiler(t){function compile(n,a){var l=Object.create(t),f=[],p=[];if(a)for(var h in a.modules&&(l.modules=(t.modules||[]).concat(a.modules)),a.directives&&(l.directives=extend(Object.create(t.directives||null),a.directives)),a)"modules"!==h&&"directives"!==h&&(l[h]=a[h]);l.warn=function(e,t,n){(n?p:f).push(e)};var m=e(n.trim(),l);return m.errors=f,m.tips=p,m}return{compile:compile,compileToFunctions:createCompileToFunctionFn(compile)}}}((function baseCompile(e,t){var n=parse(e.trim(),t);!1!==t.optimize&&optimize(n,t);var a=generate(n,t);return{ast:n,render:a.render,staticRenderFns:a.staticRenderFns}})),tr=er(Un),nr=(tr.compile,tr.compileToFunctions);function getShouldDecode(e){return(Jn=Jn||document.createElement("div")).innerHTML=e?'<a href="\n"/>':'<div a="\n"/>',Jn.innerHTML.indexOf("&#10;")>0}var rr=!!x&&getShouldDecode(!1),ir=!!x&&getShouldDecode(!0),ar=cached((function(e){var t=query(e);return t&&t.innerHTML})),sr=Vue.prototype.$mount;Vue.prototype.$mount=function(e,t){if((e=e&&query(e))===document.body||e===document.documentElement)return this;var n=this.$options;if(!n.render){var a=n.template;if(a)if("string"==typeof a)"#"===a.charAt(0)&&(a=ar(a));else{if(!a.nodeType)return this;a=a.innerHTML}else e&&(a=function getOuterHTML(e){if(e.outerHTML)return e.outerHTML;var t=document.createElement("div");return t.appendChild(e.cloneNode(!0)),t.innerHTML}(e));if(a){0;var l=nr(a,{outputSourceRange:!1,shouldDecodeNewlines:rr,shouldDecodeNewlinesForHref:ir,delimiters:n.delimiters,comments:n.comments},this),f=l.render,p=l.staticRenderFns;n.render=f,n.staticRenderFns=p}}return sr.call(this,e,t)},Vue.compile=nr,t.Z=Vue},629:function(e,t,n){"use strict";n.d(t,{OI:function(){return y},rn:function(){return v}});var a=("undefined"!=typeof window?window:void 0!==n.g?n.g:{}).__VUE_DEVTOOLS_GLOBAL_HOOK__;function deepCopy(e,t){if(void 0===t&&(t=[]),null===e||"object"!=typeof e)return e;var n=function find(e,t){return e.filter(t)[0]}(t,(function(t){return t.original===e}));if(n)return n.copy;var a=Array.isArray(e)?[]:{};return t.push({original:e,copy:a}),Object.keys(e).forEach((function(n){a[n]=deepCopy(e[n],t)})),a}function forEachValue(e,t){Object.keys(e).forEach((function(n){return t(e[n],n)}))}function isObject(e){return null!==e&&"object"==typeof e}var l=function Module(e,t){this.runtime=t,this._children=Object.create(null),this._rawModule=e;var n=e.state;this.state=("function"==typeof n?n():n)||{}},f={namespaced:{configurable:!0}};f.namespaced.get=function(){return!!this._rawModule.namespaced},l.prototype.addChild=function addChild(e,t){this._children[e]=t},l.prototype.removeChild=function removeChild(e){delete this._children[e]},l.prototype.getChild=function getChild(e){return this._children[e]},l.prototype.hasChild=function hasChild(e){return e in this._children},l.prototype.update=function update(e){this._rawModule.namespaced=e.namespaced,e.actions&&(this._rawModule.actions=e.actions),e.mutations&&(this._rawModule.mutations=e.mutations),e.getters&&(this._rawModule.getters=e.getters)},l.prototype.forEachChild=function forEachChild(e){forEachValue(this._children,e)},l.prototype.forEachGetter=function forEachGetter(e){this._rawModule.getters&&forEachValue(this._rawModule.getters,e)},l.prototype.forEachAction=function forEachAction(e){this._rawModule.actions&&forEachValue(this._rawModule.actions,e)},l.prototype.forEachMutation=function forEachMutation(e){this._rawModule.mutations&&forEachValue(this._rawModule.mutations,e)},Object.defineProperties(l.prototype,f);var p=function ModuleCollection(e){this.register([],e,!1)};function update(e,t,n){if(t.update(n),n.modules)for(var a in n.modules){if(!t.getChild(a))return void 0;update(e.concat(a),t.getChild(a),n.modules[a])}}p.prototype.get=function get(e){return e.reduce((function(e,t){return e.getChild(t)}),this.root)},p.prototype.getNamespace=function getNamespace(e){var t=this.root;return e.reduce((function(e,n){return e+((t=t.getChild(n)).namespaced?n+"/":"")}),"")},p.prototype.update=function update$1(e){update([],this.root,e)},p.prototype.register=function register(e,t,n){var a=this;void 0===n&&(n=!0);var f=new l(t,n);0===e.length?this.root=f:this.get(e.slice(0,-1)).addChild(e[e.length-1],f);t.modules&&forEachValue(t.modules,(function(t,l){a.register(e.concat(l),t,n)}))},p.prototype.unregister=function unregister(e){var t=this.get(e.slice(0,-1)),n=e[e.length-1],a=t.getChild(n);a&&a.runtime&&t.removeChild(n)},p.prototype.isRegistered=function isRegistered(e){var t=this.get(e.slice(0,-1)),n=e[e.length-1];return!!t&&t.hasChild(n)};var h;var m=function Store(e){var t=this;void 0===e&&(e={}),!h&&"undefined"!=typeof window&&window.Vue&&install(window.Vue);var n=e.plugins;void 0===n&&(n=[]);var l=e.strict;void 0===l&&(l=!1),this._committing=!1,this._actions=Object.create(null),this._actionSubscribers=[],this._mutations=Object.create(null),this._wrappedGetters=Object.create(null),this._modules=new p(e),this._modulesNamespaceMap=Object.create(null),this._subscribers=[],this._watcherVM=new h,this._makeLocalGettersCache=Object.create(null);var f=this,m=this.dispatch,g=this.commit;this.dispatch=function boundDispatch(e,t){return m.call(f,e,t)},this.commit=function boundCommit(e,t,n){return g.call(f,e,t,n)},this.strict=l;var v=this._modules.root.state;installModule(this,v,[],this._modules.root),resetStoreVM(this,v),n.forEach((function(e){return e(t)})),(void 0!==e.devtools?e.devtools:h.config.devtools)&&function devtoolPlugin(e){a&&(e._devtoolHook=a,a.emit("vuex:init",e),a.on("vuex:travel-to-state",(function(t){e.replaceState(t)})),e.subscribe((function(e,t){a.emit("vuex:mutation",e,t)}),{prepend:!0}),e.subscribeAction((function(e,t){a.emit("vuex:action",e,t)}),{prepend:!0}))}(this)},g={state:{configurable:!0}};function genericSubscribe(e,t,n){return t.indexOf(e)<0&&(n&&n.prepend?t.unshift(e):t.push(e)),function(){var n=t.indexOf(e);n>-1&&t.splice(n,1)}}function resetStore(e,t){e._actions=Object.create(null),e._mutations=Object.create(null),e._wrappedGetters=Object.create(null),e._modulesNamespaceMap=Object.create(null);var n=e.state;installModule(e,n,[],e._modules.root,!0),resetStoreVM(e,n,t)}function resetStoreVM(e,t,n){var a=e._vm;e.getters={},e._makeLocalGettersCache=Object.create(null);var l=e._wrappedGetters,f={};forEachValue(l,(function(t,n){f[n]=function partial(e,t){return function(){return e(t)}}(t,e),Object.defineProperty(e.getters,n,{get:function(){return e._vm[n]},enumerable:!0})}));var p=h.config.silent;h.config.silent=!0,e._vm=new h({data:{$$state:t},computed:f}),h.config.silent=p,e.strict&&function enableStrictMode(e){e._vm.$watch((function(){return this._data.$$state}),(function(){0}),{deep:!0,sync:!0})}(e),a&&(n&&e._withCommit((function(){a._data.$$state=null})),h.nextTick((function(){return a.$destroy()})))}function installModule(e,t,n,a,l){var f=!n.length,p=e._modules.getNamespace(n);if(a.namespaced&&(e._modulesNamespaceMap[p],e._modulesNamespaceMap[p]=a),!f&&!l){var m=getNestedState(t,n.slice(0,-1)),g=n[n.length-1];e._withCommit((function(){h.set(m,g,a.state)}))}var v=a.context=function makeLocalContext(e,t,n){var a=""===t,l={dispatch:a?e.dispatch:function(n,a,l){var f=unifyObjectStyle(n,a,l),p=f.payload,h=f.options,m=f.type;return h&&h.root||(m=t+m),e.dispatch(m,p)},commit:a?e.commit:function(n,a,l){var f=unifyObjectStyle(n,a,l),p=f.payload,h=f.options,m=f.type;h&&h.root||(m=t+m),e.commit(m,p,h)}};return Object.defineProperties(l,{getters:{get:a?function(){return e.getters}:function(){return function makeLocalGetters(e,t){if(!e._makeLocalGettersCache[t]){var n={},a=t.length;Object.keys(e.getters).forEach((function(l){if(l.slice(0,a)===t){var f=l.slice(a);Object.defineProperty(n,f,{get:function(){return e.getters[l]},enumerable:!0})}})),e._makeLocalGettersCache[t]=n}return e._makeLocalGettersCache[t]}(e,t)}},state:{get:function(){return getNestedState(e.state,n)}}}),l}(e,p,n);a.forEachMutation((function(t,n){!function registerMutation(e,t,n,a){(e._mutations[t]||(e._mutations[t]=[])).push((function wrappedMutationHandler(t){n.call(e,a.state,t)}))}(e,p+n,t,v)})),a.forEachAction((function(t,n){var a=t.root?n:p+n,l=t.handler||t;!function registerAction(e,t,n,a){(e._actions[t]||(e._actions[t]=[])).push((function wrappedActionHandler(t){var l=n.call(e,{dispatch:a.dispatch,commit:a.commit,getters:a.getters,state:a.state,rootGetters:e.getters,rootState:e.state},t);return function isPromise(e){return e&&"function"==typeof e.then}(l)||(l=Promise.resolve(l)),e._devtoolHook?l.catch((function(t){throw e._devtoolHook.emit("vuex:error",t),t})):l}))}(e,a,l,v)})),a.forEachGetter((function(t,n){!function registerGetter(e,t,n,a){if(e._wrappedGetters[t])return void 0;e._wrappedGetters[t]=function wrappedGetter(e){return n(a.state,a.getters,e.state,e.getters)}}(e,p+n,t,v)})),a.forEachChild((function(a,f){installModule(e,t,n.concat(f),a,l)}))}function getNestedState(e,t){return t.reduce((function(e,t){return e[t]}),e)}function unifyObjectStyle(e,t,n){return isObject(e)&&e.type&&(n=t,t=e,e=e.type),{type:e,payload:t,options:n}}function install(e){h&&e===h||
/*!
 * vuex v3.6.2
 * (c) 2021 Evan You
 * @license MIT
 */
function applyMixin(e){if(Number(e.version.split(".")[0])>=2)e.mixin({beforeCreate:vuexInit});else{var t=e.prototype._init;e.prototype._init=function(e){void 0===e&&(e={}),e.init=e.init?[vuexInit].concat(e.init):vuexInit,t.call(this,e)}}function vuexInit(){var e=this.$options;e.store?this.$store="function"==typeof e.store?e.store():e.store:e.parent&&e.parent.$store&&(this.$store=e.parent.$store)}}(h=e)}g.state.get=function(){return this._vm._data.$$state},g.state.set=function(e){0},m.prototype.commit=function commit(e,t,n){var a=this,l=unifyObjectStyle(e,t,n),f=l.type,p=l.payload,h=(l.options,{type:f,payload:p}),m=this._mutations[f];m&&(this._withCommit((function(){m.forEach((function commitIterator(e){e(p)}))})),this._subscribers.slice().forEach((function(e){return e(h,a.state)})))},m.prototype.dispatch=function dispatch(e,t){var n=this,a=unifyObjectStyle(e,t),l=a.type,f=a.payload,p={type:l,payload:f},h=this._actions[l];if(h){try{this._actionSubscribers.slice().filter((function(e){return e.before})).forEach((function(e){return e.before(p,n.state)}))}catch(g){0}var m=h.length>1?Promise.all(h.map((function(e){return e(f)}))):h[0](f);return new Promise((function(e,t){m.then((function(t){try{n._actionSubscribers.filter((function(e){return e.after})).forEach((function(e){return e.after(p,n.state)}))}catch(g){0}e(t)}),(function(e){try{n._actionSubscribers.filter((function(e){return e.error})).forEach((function(t){return t.error(p,n.state,e)}))}catch(g){0}t(e)}))}))}},m.prototype.subscribe=function subscribe(e,t){return genericSubscribe(e,this._subscribers,t)},m.prototype.subscribeAction=function subscribeAction(e,t){return genericSubscribe("function"==typeof e?{before:e}:e,this._actionSubscribers,t)},m.prototype.watch=function watch(e,t,n){var a=this;return this._watcherVM.$watch((function(){return e(a.state,a.getters)}),t,n)},m.prototype.replaceState=function replaceState(e){var t=this;this._withCommit((function(){t._vm._data.$$state=e}))},m.prototype.registerModule=function registerModule(e,t,n){void 0===n&&(n={}),"string"==typeof e&&(e=[e]),this._modules.register(e,t),installModule(this,this.state,e,this._modules.get(e),n.preserveState),resetStoreVM(this,this.state)},m.prototype.unregisterModule=function unregisterModule(e){var t=this;"string"==typeof e&&(e=[e]),this._modules.unregister(e),this._withCommit((function(){var n=getNestedState(t.state,e.slice(0,-1));h.delete(n,e[e.length-1])})),resetStore(this)},m.prototype.hasModule=function hasModule(e){return"string"==typeof e&&(e=[e]),this._modules.isRegistered(e)},m.prototype.hotUpdate=function hotUpdate(e){this._modules.update(e),resetStore(this,!0)},m.prototype._withCommit=function _withCommit(e){var t=this._committing;this._committing=!0,e(),this._committing=t},Object.defineProperties(m.prototype,g);var v=normalizeNamespace((function(e,t){var n={};return normalizeMap(t).forEach((function(t){var a=t.key,l=t.val;n[a]=function mappedState(){var t=this.$store.state,n=this.$store.getters;if(e){var a=getModuleByNamespace(this.$store,"mapState",e);if(!a)return;t=a.context.state,n=a.context.getters}return"function"==typeof l?l.call(this,t,n):t[l]},n[a].vuex=!0})),n})),y=normalizeNamespace((function(e,t){var n={};return normalizeMap(t).forEach((function(t){var a=t.key,l=t.val;n[a]=function mappedMutation(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];var a=this.$store.commit;if(e){var f=getModuleByNamespace(this.$store,"mapMutations",e);if(!f)return;a=f.context.commit}return"function"==typeof l?l.apply(this,[a].concat(t)):a.apply(this.$store,[l].concat(t))}})),n})),_=normalizeNamespace((function(e,t){var n={};return normalizeMap(t).forEach((function(t){var a=t.key,l=t.val;l=e+l,n[a]=function mappedGetter(){if(!e||getModuleByNamespace(this.$store,"mapGetters",e))return this.$store.getters[l]},n[a].vuex=!0})),n})),b=normalizeNamespace((function(e,t){var n={};return normalizeMap(t).forEach((function(t){var a=t.key,l=t.val;n[a]=function mappedAction(){for(var t=[],n=arguments.length;n--;)t[n]=arguments[n];var a=this.$store.dispatch;if(e){var f=getModuleByNamespace(this.$store,"mapActions",e);if(!f)return;a=f.context.dispatch}return"function"==typeof l?l.apply(this,[a].concat(t)):a.apply(this.$store,[l].concat(t))}})),n}));function normalizeMap(e){return function isValidMap(e){return Array.isArray(e)||isObject(e)}(e)?Array.isArray(e)?e.map((function(e){return{key:e,val:e}})):Object.keys(e).map((function(t){return{key:t,val:e[t]}})):[]}function normalizeNamespace(e){return function(t,n){return"string"!=typeof t?(n=t,t=""):"/"!==t.charAt(t.length-1)&&(t+="/"),e(t,n)}}function getModuleByNamespace(e,t,n){return e._modulesNamespaceMap[n]}function startMessage(e,t,n){var a=n?e.groupCollapsed:e.group;try{a.call(e,t)}catch(l){e.log(t)}}function endMessage(e){try{e.groupEnd()}catch(t){e.log(" log end ")}}function getFormattedTime(){var e=new Date;return" @ "+pad(e.getHours(),2)+":"+pad(e.getMinutes(),2)+":"+pad(e.getSeconds(),2)+"."+pad(e.getMilliseconds(),3)}function pad(e,t){return function repeat(e,t){return new Array(t+1).join(e)}("0",t-e.toString().length)+e}var C={Store:m,install:install,version:"3.6.2",mapState:v,mapMutations:y,mapGetters:_,mapActions:b,createNamespacedHelpers:function(e){return{mapState:v.bind(null,e),mapGetters:_.bind(null,e),mapMutations:y.bind(null,e),mapActions:b.bind(null,e)}},createLogger:function createLogger(e){void 0===e&&(e={});var t=e.collapsed;void 0===t&&(t=!0);var n=e.filter;void 0===n&&(n=function(e,t,n){return!0});var a=e.transformer;void 0===a&&(a=function(e){return e});var l=e.mutationTransformer;void 0===l&&(l=function(e){return e});var f=e.actionFilter;void 0===f&&(f=function(e,t){return!0});var p=e.actionTransformer;void 0===p&&(p=function(e){return e});var h=e.logMutations;void 0===h&&(h=!0);var m=e.logActions;void 0===m&&(m=!0);var g=e.logger;return void 0===g&&(g=console),function(e){var v=deepCopy(e.state);void 0!==g&&(h&&e.subscribe((function(e,f){var p=deepCopy(f);if(n(e,v,p)){var h=getFormattedTime(),m=l(e),y="mutation "+e.type+h;startMessage(g,y,t),g.log("%c prev state","color: #9E9E9E; font-weight: bold",a(v)),g.log("%c mutation","color: #03A9F4; font-weight: bold",m),g.log("%c next state","color: #4CAF50; font-weight: bold",a(p)),endMessage(g)}v=p})),m&&e.subscribeAction((function(e,n){if(f(e,n)){var a=getFormattedTime(),l=p(e),h="action "+e.type+a;startMessage(g,h,t),g.log("%c action","color: #03A9F4; font-weight: bold",l),endMessage(g)}})))}}};t.ZP=C},6430:function(e,t,n){"use strict";var a=n(9804),l=n(3083),f=n(1924),p=f("Object.prototype.toString"),h=n(6410)(),m="undefined"==typeof globalThis?n.g:globalThis,g=l(),v=f("String.prototype.slice"),y={},_=n(882),b=Object.getPrototypeOf;h&&_&&b&&a(g,(function(e){if("function"==typeof m[e]){var t=new m[e];if(Symbol.toStringTag in t){var n=b(t),a=_(n,Symbol.toStringTag);if(!a){var l=b(n);a=_(l,Symbol.toStringTag)}y[e]=a.get}}}));var C=n(5692);e.exports=function whichTypedArray(e){return!!C(e)&&(h&&Symbol.toStringTag in e?function tryAllTypedArrays(e){var t=!1;return a(y,(function(n,a){if(!t)try{var l=n.call(e);l===a&&(t=l)}catch(f){}})),t}(e):v(p(e),8,-1))}},3083:function(e,t,n){"use strict";var a=["BigInt64Array","BigUint64Array","Float32Array","Float64Array","Int16Array","Int32Array","Int8Array","Uint16Array","Uint32Array","Uint8Array","Uint8ClampedArray"],l="undefined"==typeof globalThis?n.g:globalThis;e.exports=function availableTypedArrays(){for(var e=[],t=0;t<a.length;t++)"function"==typeof l[a[t]]&&(e[e.length]=a[t]);return e}},882:function(e,t,n){"use strict";var a=n(210)("%Object.getOwnPropertyDescriptor%",!0);if(a)try{a([],"length")}catch(l){a=null}e.exports=a},2780:function(e,t,n){"use strict";n.d(t,{Z:function(){return _}});var a=n(6092).Z.Symbol,l=Object.prototype,f=l.hasOwnProperty,p=l.toString,h=a?a.toStringTag:void 0;var m=function getRawTag(e){var t=f.call(e,h),n=e[h];try{e[h]=void 0;var a=!0}catch(m){}var l=p.call(e);return a&&(t?e[h]=n:delete e[h]),l},g=Object.prototype.toString;var v=function objectToString(e){return g.call(e)},y=a?a.toStringTag:void 0;var _=function baseGetTag(e){return null==e?void 0===e?"[object Undefined]":"[object Null]":y&&y in Object(e)?m(e):v(e)}},3413:function(e,t){"use strict";var n="object"==typeof global&&global&&global.Object===Object&&global;t.Z=n},6092:function(e,t,n){"use strict";var a=n(3413),l="object"==typeof self&&self&&self.Object===Object&&self,f=a.Z||l||Function("return this")();t.Z=f},2599:function(e,t,n){"use strict";n.d(t,{Z:function(){return k}});var a=n(7226),l=n(6092),lodash_es_now=function(){return l.Z.Date.now()},f=n(2780),p=n(8533);var h=function isSymbol(e){return"symbol"==typeof e||(0,p.Z)(e)&&"[object Symbol]"==(0,f.Z)(e)},m=/^\s+|\s+$/g,g=/^[-+]0x[0-9a-f]+$/i,v=/^0b[01]+$/i,y=/^0o[0-7]+$/i,_=parseInt;var b=function toNumber(e){if("number"==typeof e)return e;if(h(e))return NaN;if((0,a.Z)(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=(0,a.Z)(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(m,"");var n=v.test(e);return n||y.test(e)?_(e.slice(2),n?2:8):g.test(e)?NaN:+e},C=Math.max,S=Math.min;var k=function debounce(e,t,n){var l,f,p,h,m,g,v=0,y=!1,_=!1,k=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function invokeFunc(t){var n=l,a=f;return l=f=void 0,v=t,h=e.apply(a,n)}function leadingEdge(e){return v=e,m=setTimeout(timerExpired,t),y?invokeFunc(e):h}function shouldInvoke(e){var n=e-g;return void 0===g||n>=t||n<0||_&&e-v>=p}function timerExpired(){var e=lodash_es_now();if(shouldInvoke(e))return trailingEdge(e);m=setTimeout(timerExpired,function remainingWait(e){var n=t-(e-g);return _?S(n,p-(e-v)):n}(e))}function trailingEdge(e){return m=void 0,k&&l?invokeFunc(e):(l=f=void 0,h)}function debounced(){var e=lodash_es_now(),n=shouldInvoke(e);if(l=arguments,f=this,g=e,n){if(void 0===m)return leadingEdge(g);if(_)return clearTimeout(m),m=setTimeout(timerExpired,t),invokeFunc(g)}return void 0===m&&(m=setTimeout(timerExpired,t)),h}return t=b(t)||0,(0,a.Z)(n)&&(y=!!n.leading,p=(_="maxWait"in n)?C(b(n.maxWait)||0,t):p,k="trailing"in n?!!n.trailing:k),debounced.cancel=function cancel(){void 0!==m&&clearTimeout(m),v=0,l=g=f=m=void 0},debounced.flush=function flush(){return void 0===m?h:trailingEdge(lodash_es_now())},debounced}},844:function(e,t,n){"use strict";n.d(t,{Z:function(){return te}});var a=function createBaseFor(e){return function(t,n,a){for(var l=-1,f=Object(t),p=a(t),h=p.length;h--;){var m=p[e?h:++l];if(!1===n(f[m],m,f))break}return t}}();var l=function baseTimes(e,t){for(var n=-1,a=Array(e);++n<e;)a[n]=t(n);return a},f=n(2780),p=n(8533);var h=function baseIsArguments(e){return(0,p.Z)(e)&&"[object Arguments]"==(0,f.Z)(e)},m=Object.prototype,g=m.hasOwnProperty,v=m.propertyIsEnumerable,y=h(function(){return arguments}())?h:function(e){return(0,p.Z)(e)&&g.call(e,"callee")&&!v.call(e,"callee")},_=y,b=Array.isArray,C=n(6092);var S=function stubFalse(){return!1},k="object"==typeof exports&&exports&&!exports.nodeType&&exports,w=k&&"object"==typeof module&&module&&!module.nodeType&&module,T=w&&w.exports===k?C.Z.Buffer:void 0,P=(T?T.isBuffer:void 0)||S,A=/^(?:0|[1-9]\d*)$/;var M=function isIndex(e,t){var n=typeof e;return!!(t=null==t?9007199254740991:t)&&("number"==n||"symbol"!=n&&A.test(e))&&e>-1&&e%1==0&&e<t};var x=function isLength(e){return"number"==typeof e&&e>-1&&e%1==0&&e<=9007199254740991},O={};O["[object Float32Array]"]=O["[object Float64Array]"]=O["[object Int8Array]"]=O["[object Int16Array]"]=O["[object Int32Array]"]=O["[object Uint8Array]"]=O["[object Uint8ClampedArray]"]=O["[object Uint16Array]"]=O["[object Uint32Array]"]=!0,O["[object Arguments]"]=O["[object Array]"]=O["[object ArrayBuffer]"]=O["[object Boolean]"]=O["[object DataView]"]=O["[object Date]"]=O["[object Error]"]=O["[object Function]"]=O["[object Map]"]=O["[object Number]"]=O["[object Object]"]=O["[object RegExp]"]=O["[object Set]"]=O["[object String]"]=O["[object WeakMap]"]=!1;var R=function baseIsTypedArray(e){return(0,p.Z)(e)&&x(e.length)&&!!O[(0,f.Z)(e)]};var I=function baseUnary(e){return function(t){return e(t)}},L=n(3413),N="object"==typeof exports&&exports&&!exports.nodeType&&exports,D=N&&"object"==typeof module&&module&&!module.nodeType&&module,B=D&&D.exports===N&&L.Z.process,F=function(){try{var e=D&&D.require&&D.require("util").types;return e||B&&B.binding&&B.binding("util")}catch(t){}}(),j=F&&F.isTypedArray,$=j?I(j):R,H=Object.prototype.hasOwnProperty;var V=function arrayLikeKeys(e,t){var n=b(e),a=!n&&_(e),f=!n&&!a&&P(e),p=!n&&!a&&!f&&$(e),h=n||a||f||p,m=h?l(e.length,String):[],g=m.length;for(var v in e)!t&&!H.call(e,v)||h&&("length"==v||f&&("offset"==v||"parent"==v)||p&&("buffer"==v||"byteLength"==v||"byteOffset"==v)||M(v,g))||m.push(v);return m},U=Object.prototype;var G=function isPrototype(e){var t=e&&e.constructor;return e===("function"==typeof t&&t.prototype||U)};var q=function overArg(e,t){return function(n){return e(t(n))}}(Object.keys,Object),W=Object.prototype.hasOwnProperty;var z=function baseKeys(e){if(!G(e))return q(e);var t=[];for(var n in Object(e))W.call(e,n)&&"constructor"!=n&&t.push(n);return t},K=n(7226);var Z=function isFunction(e){if(!(0,K.Z)(e))return!1;var t=(0,f.Z)(e);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t};var Q=function isArrayLike(e){return null!=e&&x(e.length)&&!Z(e)};var X=function keys(e){return Q(e)?V(e):z(e)};var Y=function baseForOwn(e,t){return e&&a(e,t,X)};var J=function identity(e){return e};var ee=function castFunction(e){return"function"==typeof e?e:J};var te=function forOwn(e,t){return e&&Y(e,ee(t))}},7226:function(e,t){"use strict";t.Z=function isObject(e){var t=typeof e;return null!=e&&("object"==t||"function"==t)}},8533:function(e,t){"use strict";t.Z=function isObjectLike(e){return null!=e&&"object"==typeof e}},8720:function(e){"use strict";e.exports={i8:"4.5.1"}},1730:function(e){"use strict";e.exports=JSON.parse('{"name":"twilio-video","title":"Twilio Video","description":"Twilio Video JavaScript Library","version":"2.18.2","homepage":"https://twilio.com","author":"Mark Andrus Roberts <mroberts@twilio.com>","contributors":["Ryan Rowland <rrowland@twilio.com>","Manjesh Malavalli <mmalavalli@twilio.com>","Makarand Patwardhan <mpatwardhan@twilio.com>"],"keywords":["twilio","webrtc","library","javascript","video","rooms"],"repository":{"type":"git","url":"https://github.com/twilio/twilio-video.js.git"},"devDependencies":{"@babel/core":"^7.14.2","@babel/preset-env":"^7.14.2","@babel/preset-typescript":"^7.13.0","@types/express":"^4.11.0","@types/node":"^8.5.1","@types/selenium-webdriver":"^3.0.8","@types/ws":"^3.2.1","@typescript-eslint/eslint-plugin":"^4.13.0","@typescript-eslint/parser":"^4.0.0","babel-cli":"^6.26.0","babel-preset-es2015":"^6.24.1","browserify":"^17.0.0","cheerio":"^0.22.0","cors":"^2.8.5","electron":"^9.1.0","envify":"^4.0.0","eslint":"^6.2.1","eslint-config-standard":"^14.0.0","eslint-plugin-import":"^2.18.2","eslint-plugin-node":"^9.1.0","eslint-plugin-promise":"^4.2.1","eslint-plugin-standard":"^4.0.1","express":"^4.16.2","glob":"^7.1.7","ink-docstrap":"^1.3.2","inquirer":"^7.0.0","is-docker":"^2.0.0","jsdoc":"^3.5.5","jsdoc-babel":"^0.5.0","json-loader":"^0.5.7","karma":"^5.0.2","karma-browserify":"^8.0.0","karma-chrome-launcher":"^2.0.0","karma-edgium-launcher":"^4.0.0-0","karma-electron":"^6.1.0","karma-firefox-launcher":"^1.3.0","karma-htmlfile-reporter":"^0.3.8","karma-junit-reporter":"^1.2.0","karma-mocha":"^1.3.0","karma-safari-launcher":"^1.0.0","karma-spec-reporter":"0.0.32","karma-typescript":"^5.5.1","karma-typescript-es6-transform":"^5.5.1","mocha":"^3.2.0","mock-require":"^3.0.3","ncp":"^2.0.0","node-http-server":"^8.1.2","npm-run-all":"^4.0.2","nyc":"^15.1.0","requirejs":"^2.3.3","rimraf":"^2.6.1","simple-git":"^1.126.0","sinon":"^4.0.1","ts-node":"4.0.1","tslint":"5.8.0","twilio":"^3.49.0","twilio-release-tool":"^1.0.2","typescript":"4.2.2","uglify-js":"^2.8.22","vinyl-fs":"^2.4.4","vinyl-source-stream":"^1.1.0","watchify":"^3.11.1","webrtc-adapter":"^7.7.1"},"engines":{"node":">=0.12"},"license":"BSD-3-Clause","main":"./es5/index.js","types":"./tsdef/index.d.ts","scripts":{"lint:js":"eslint ./lib ./test/*.js ./docker/**/*.js ./test/framework/*.js ./test/lib/*.js ./test/integration/** ./test/unit/** ","lint:ts":"eslint ./tsdef/*.ts ./lib/**/*.ts","lint":"npm-run-all lint:js lint:ts","printVersion":"node --version && npm --version","test:unit":"npm-run-all printVersion build:es5 test:unit:js test:unit:ts","test:unit:js":"nyc --report-dir=./coverage/js --extension=.js --include=lib/**/* --reporter=html --reporter=lcov --reporter=text mocha ./test/unit/index.js","test:unit:ts":"nyc --report-dir=./coverage/ts --extension=.ts --include=lib/**/* --reporter=html --reporter=lcov --reporter=text mocha -r ts-node/register ./test/unit/index.ts","test:serversiderender":"mocha ./test/serversiderender/index.js","test:integration:adapter":"node ./scripts/karma.js karma/integration.adapter.conf.js","test:integration":"npm run build:es5 && node ./scripts/karma.js karma/integration.conf.js","test:umd:install":"npm install puppeteer@5.5.0","test:umd":"mocha ./test/umd/index.js","test:crossbrowser:build:clean":"rimraf ./test/crossbrowser/lib ./test/crossbrowser/src/browser/index.js","test:crossbrowser:build:lint":"cd ./test/crossbrowser && tslint --project tsconfig.json","test:crossbrowser:build:tsc":"cd ./test/crossbrowser && tsc","test:crossbrowser:build:browser":"cd ./test/crossbrowser && browserify lib/crossbrowser/src/browser/index.js > src/browser/index.js","test:crossbrowser:build":"npm-run-all test:crossbrowser:build:*","test:crossbrowser:test":"cd ./test/crossbrowser && mocha --compilers ts:ts-node/register test/integration/spec/**/*.ts","test:crossbrowser":"npm-run-all test:crossbrowser:*","test:sdkdriver:build:clean":"rimraf ./test/lib/sdkdriver/lib ./test/lib/sdkdriver/test/integration/browser/index.js","test:sdkdriver:build:lint":"cd ./test/lib/sdkdriver && tslint --project tsconfig.json","test:sdkdriver:build:tsc":"cd ./test/lib/sdkdriver && tsc --rootDir src","test:sdkdriver:build":"npm-run-all test:sdkdriver:build:*","test:sdkdriver:test:unit":"cd ./test/lib/sdkdriver && mocha --compilers ts:ts-node/register test/unit/spec/**/*.ts","test:sdkdriver:test:integration:browser":"cd ./test/lib/sdkdriver/test/integration && browserify browser/browser.js > browser/index.js","test:sdkdriver:test:integration:run":"cd ./test/lib/sdkdriver && mocha --compilers ts:ts-node/register test/integration/spec/**/*.ts","test:sdkdriver:test:integration":"npm-run-all test:sdkdriver:test:integration:*","test:sdkdriver:test":"npm-run-all test:sdkdriver:test:*","test:sdkdriver":"npm-run-all test:sdkdriver:*","test:framework:angular:install":"cd ./test/framework/twilio-video-angular && rimraf ./node_modules package-lock.json && npm install","test:framework:angular:run":"mocha ./test/framework/twilio-video-angular.js","test:framework:angular":"npm-run-all test:framework:angular:*","test:framework:no-framework:run":"mocha ./test/framework/twilio-video-no-framework.js","test:framework:no-framework":"npm-run-all test:framework:no-framework:*","test:framework:react:install":"cd ./test/framework/twilio-video-react && rimraf ./node_modules package-lock.json && npm install","test:framework:react:test":"node ./scripts/framework.js twilio-video-react","test:framework:react:build":"cd ./test/framework/twilio-video-react && npm run build","test:framework:react:run":"mocha ./test/framework/twilio-video-react.js","test:framework:react":"npm-run-all test:framework:react:*","test:framework:install":"npm install chromedriver && npm install selenium-webdriver && npm install geckodriver && npm install puppeteer","test:framework":"npm-run-all test:framework:install test:framework:no-framework test:framework:react","test":"npm-run-all test:unit test:integration","build:es5":"rimraf ./es5 && tsc tsdef/twilio-video-tests.ts --noEmit && tsc","build:js":"node ./scripts/build.js ./src/twilio-video.js ./LICENSE.md ./dist/twilio-video.js","build:min.js":"uglifyjs ./dist/twilio-video.js -o ./dist/twilio-video.min.js --comments \\"/^! twilio-video.js/\\" -b beautify=false,ascii_only=true","build":"npm-run-all clean lint docs test:unit test:integration build:es5 build:js build:min.js test:umd","build:quick":"npm-run-all clean lint docs build:es5 build:js build:min.js","docs":"node ./scripts/docs.js ./dist/docs","watch":"tsc -w","clean":"rimraf ./coverage ./es5 ./dist"},"dependencies":{"@twilio/webrtc":"4.5.1","backoff":"^2.5.0","ws":"^7.4.6","xmlhttprequest":"^1.8.0"},"browser":{"ws":"./src/ws.js","xmlhttprequest":"./src/xmlhttprequest.js"}}')}}]);